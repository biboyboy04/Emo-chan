function cT(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();var gn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function A1(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function hT(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var dT={exports:{}},og={},fT={exports:{}},wt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var od=Symbol.for("react.element"),hP=Symbol.for("react.portal"),dP=Symbol.for("react.fragment"),fP=Symbol.for("react.strict_mode"),pP=Symbol.for("react.profiler"),mP=Symbol.for("react.provider"),gP=Symbol.for("react.context"),vP=Symbol.for("react.forward_ref"),yP=Symbol.for("react.suspense"),xP=Symbol.for("react.memo"),wP=Symbol.for("react.lazy"),qC=Symbol.iterator;function bP(n){return n===null||typeof n!="object"?null:(n=qC&&n[qC]||n["@@iterator"],typeof n=="function"?n:null)}var pT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mT=Object.assign,gT={};function rc(n,e,t){this.props=n,this.context=e,this.refs=gT,this.updater=t||pT}rc.prototype.isReactComponent={};rc.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};rc.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function vT(){}vT.prototype=rc.prototype;function R1(n,e,t){this.props=n,this.context=e,this.refs=gT,this.updater=t||pT}var O1=R1.prototype=new vT;O1.constructor=R1;mT(O1,rc.prototype);O1.isPureReactComponent=!0;var KC=Array.isArray,yT=Object.prototype.hasOwnProperty,F1={current:null},xT={key:!0,ref:!0,__self:!0,__source:!0};function wT(n,e,t){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)yT.call(e,r)&&!xT.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:od,type:n,key:i,ref:o,props:s,_owner:F1.current}}function CP(n,e){return{$$typeof:od,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function L1(n){return typeof n=="object"&&n!==null&&n.$$typeof===od}function SP(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var XC=/\/+/g;function Av(n,e){return typeof n=="object"&&n!==null&&n.key!=null?SP(""+n.key):e.toString(36)}function Rp(n,e,t,r,s){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case od:case hP:o=!0}}if(o)return o=n,s=s(o),n=r===""?"."+Av(o,0):r,KC(s)?(t="",n!=null&&(t=n.replace(XC,"$&/")+"/"),Rp(s,e,t,"",function(u){return u})):s!=null&&(L1(s)&&(s=CP(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(XC,"$&/")+"/")+n)),e.push(s)),1;if(o=0,r=r===""?".":r+":",KC(n))for(var a=0;a<n.length;a++){i=n[a];var l=r+Av(i,a);o+=Rp(i,e,t,l,s)}else if(l=bP(n),typeof l=="function")for(n=l.call(n),a=0;!(i=n.next()).done;)i=i.value,l=r+Av(i,a++),o+=Rp(i,e,t,l,s);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Yf(n,e,t){if(n==null)return n;var r=[],s=0;return Rp(n,r,"","",function(i){return e.call(t,i,s++)}),r}function kP(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Ur={current:null},Op={transition:null},EP={ReactCurrentDispatcher:Ur,ReactCurrentBatchConfig:Op,ReactCurrentOwner:F1};wt.Children={map:Yf,forEach:function(n,e,t){Yf(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Yf(n,function(){e++}),e},toArray:function(n){return Yf(n,function(e){return e})||[]},only:function(n){if(!L1(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};wt.Component=rc;wt.Fragment=dP;wt.Profiler=pP;wt.PureComponent=R1;wt.StrictMode=fP;wt.Suspense=yP;wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EP;wt.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=mT({},n.props),s=n.key,i=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=F1.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)yT.call(e,l)&&!xT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:od,type:n.type,key:s,ref:i,props:r,_owner:o}};wt.createContext=function(n){return n={$$typeof:gP,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:mP,_context:n},n.Consumer=n};wt.createElement=wT;wt.createFactory=function(n){var e=wT.bind(null,n);return e.type=n,e};wt.createRef=function(){return{current:null}};wt.forwardRef=function(n){return{$$typeof:vP,render:n}};wt.isValidElement=L1;wt.lazy=function(n){return{$$typeof:wP,_payload:{_status:-1,_result:n},_init:kP}};wt.memo=function(n,e){return{$$typeof:xP,type:n,compare:e===void 0?null:e}};wt.startTransition=function(n){var e=Op.transition;Op.transition={};try{n()}finally{Op.transition=e}};wt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};wt.useCallback=function(n,e){return Ur.current.useCallback(n,e)};wt.useContext=function(n){return Ur.current.useContext(n)};wt.useDebugValue=function(){};wt.useDeferredValue=function(n){return Ur.current.useDeferredValue(n)};wt.useEffect=function(n,e){return Ur.current.useEffect(n,e)};wt.useId=function(){return Ur.current.useId()};wt.useImperativeHandle=function(n,e,t){return Ur.current.useImperativeHandle(n,e,t)};wt.useInsertionEffect=function(n,e){return Ur.current.useInsertionEffect(n,e)};wt.useLayoutEffect=function(n,e){return Ur.current.useLayoutEffect(n,e)};wt.useMemo=function(n,e){return Ur.current.useMemo(n,e)};wt.useReducer=function(n,e,t){return Ur.current.useReducer(n,e,t)};wt.useRef=function(n){return Ur.current.useRef(n)};wt.useState=function(n){return Ur.current.useState(n)};wt.useSyncExternalStore=function(n,e,t){return Ur.current.useSyncExternalStore(n,e,t)};wt.useTransition=function(){return Ur.current.useTransition()};wt.version="18.2.0";fT.exports=wt;var Re=fT.exports;const bT=A1(Re),IP=cT({__proto__:null,default:bT},[Re]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TP=Re,_P=Symbol.for("react.element"),NP=Symbol.for("react.fragment"),$P=Object.prototype.hasOwnProperty,DP=TP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,AP={key:!0,ref:!0,__self:!0,__source:!0};function CT(n,e,t){var r,s={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)$P.call(e,r)&&!AP.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:_P,type:n,key:i,ref:o,props:s,_owner:DP.current}}og.Fragment=NP;og.jsx=CT;og.jsxs=CT;dT.exports=og;var at=dT.exports,Uy={},ST={exports:{}},ws={},kT={exports:{}},ET={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(D,z){var K=D.length;D.push(z);e:for(;0<K;){var ie=K-1>>>1,V=D[ie];if(0<s(V,z))D[ie]=z,D[K]=V,K=ie;else break e}}function t(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var z=D[0],K=D.pop();if(K!==z){D[0]=K;e:for(var ie=0,V=D.length,Z=V>>>1;ie<Z;){var de=2*(ie+1)-1,ge=D[de],ye=de+1,G=D[ye];if(0>s(ge,K))ye<V&&0>s(G,ge)?(D[ie]=G,D[ye]=K,ie=ye):(D[ie]=ge,D[de]=K,ie=de);else if(ye<V&&0>s(G,K))D[ie]=G,D[ye]=K,ie=ye;else break e}}return z}function s(D,z){var K=D.sortIndex-z.sortIndex;return K!==0?K:D.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,d=3,f=!1,p=!1,v=!1,g=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(D){for(var z=t(u);z!==null;){if(z.callback===null)r(u);else if(z.startTime<=D)r(u),z.sortIndex=z.expirationTime,e(l,z);else break;z=t(u)}}function x(D){if(v=!1,w(D),!p)if(t(l)!==null)p=!0,M(b);else{var z=t(u);z!==null&&W(x,z.startTime-D)}}function b(D,z){p=!1,v&&(v=!1,m(E),E=-1),f=!0;var K=d;try{for(w(z),h=t(l);h!==null&&(!(h.expirationTime>z)||D&&!A());){var ie=h.callback;if(typeof ie=="function"){h.callback=null,d=h.priorityLevel;var V=ie(h.expirationTime<=z);z=n.unstable_now(),typeof V=="function"?h.callback=V:h===t(l)&&r(l),w(z)}else r(l);h=t(l)}if(h!==null)var Z=!0;else{var de=t(u);de!==null&&W(x,de.startTime-z),Z=!1}return Z}finally{h=null,d=K,f=!1}}var C=!1,k=null,E=-1,T=5,_=-1;function A(){return!(n.unstable_now()-_<T)}function P(){if(k!==null){var D=n.unstable_now();_=D;var z=!0;try{z=k(!0,D)}finally{z?j():(C=!1,k=null)}}else C=!1}var j;if(typeof y=="function")j=function(){y(P)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,F=X.port2;X.port1.onmessage=P,j=function(){F.postMessage(null)}}else j=function(){g(P,0)};function M(D){k=D,C||(C=!0,j())}function W(D,z){E=g(function(){D(n.unstable_now())},z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(D){D.callback=null},n.unstable_continueExecution=function(){p||f||(p=!0,M(b))},n.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<D?Math.floor(1e3/D):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(D){switch(d){case 1:case 2:case 3:var z=3;break;default:z=d}var K=d;d=z;try{return D()}finally{d=K}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(D,z){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var K=d;d=D;try{return z()}finally{d=K}},n.unstable_scheduleCallback=function(D,z,K){var ie=n.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?ie+K:ie):K=ie,D){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=K+V,D={id:c++,callback:z,priorityLevel:D,startTime:K,expirationTime:V,sortIndex:-1},K>ie?(D.sortIndex=K,e(u,D),t(l)===null&&D===t(u)&&(v?(m(E),E=-1):v=!0,W(x,K-ie))):(D.sortIndex=V,e(l,D),p||f||(p=!0,M(b))),D},n.unstable_shouldYield=A,n.unstable_wrapCallback=function(D){var z=d;return function(){var K=d;d=z;try{return D.apply(this,arguments)}finally{d=K}}}})(ET);kT.exports=ET;var RP=kT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IT=Re,ys=RP;function Ae(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var TT=new Set,Eh={};function kl(n,e){Fu(n,e),Fu(n+"Capture",e)}function Fu(n,e){for(Eh[n]=e,n=0;n<e.length;n++)TT.add(e[n])}var fo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vy=Object.prototype.hasOwnProperty,OP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,YC={},ZC={};function FP(n){return Vy.call(ZC,n)?!0:Vy.call(YC,n)?!1:OP.test(n)?ZC[n]=!0:(YC[n]=!0,!1)}function LP(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function PP(n,e,t,r){if(e===null||typeof e>"u"||LP(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Vr(n,e,t,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var fr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){fr[n]=new Vr(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];fr[e]=new Vr(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){fr[n]=new Vr(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){fr[n]=new Vr(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){fr[n]=new Vr(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){fr[n]=new Vr(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){fr[n]=new Vr(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){fr[n]=new Vr(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){fr[n]=new Vr(n,5,!1,n.toLowerCase(),null,!1,!1)});var P1=/[\-:]([a-z])/g;function M1(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(P1,M1);fr[e]=new Vr(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(P1,M1);fr[e]=new Vr(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(P1,M1);fr[e]=new Vr(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){fr[n]=new Vr(n,1,!1,n.toLowerCase(),null,!1,!1)});fr.xlinkHref=new Vr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){fr[n]=new Vr(n,1,!1,n.toLowerCase(),null,!0,!0)});function B1(n,e,t,r){var s=fr.hasOwnProperty(e)?fr[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(PP(e,t,s,r)&&(t=null),r||s===null?FP(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,r=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var So=IT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zf=Symbol.for("react.element"),au=Symbol.for("react.portal"),lu=Symbol.for("react.fragment"),z1=Symbol.for("react.strict_mode"),Wy=Symbol.for("react.profiler"),_T=Symbol.for("react.provider"),NT=Symbol.for("react.context"),U1=Symbol.for("react.forward_ref"),Gy=Symbol.for("react.suspense"),jy=Symbol.for("react.suspense_list"),V1=Symbol.for("react.memo"),Po=Symbol.for("react.lazy"),$T=Symbol.for("react.offscreen"),QC=Symbol.iterator;function $c(n){return n===null||typeof n!="object"?null:(n=QC&&n[QC]||n["@@iterator"],typeof n=="function"?n:null)}var fn=Object.assign,Rv;function eh(n){if(Rv===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Rv=e&&e[1]||""}return`
`+Rv+n}var Ov=!1;function Fv(n,e){if(!n||Ov)return"";Ov=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){r=u}n.call(e.prototype)}else{try{throw Error()}catch(u){r=u}n()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{Ov=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?eh(n):""}function MP(n){switch(n.tag){case 5:return eh(n.type);case 16:return eh("Lazy");case 13:return eh("Suspense");case 19:return eh("SuspenseList");case 0:case 2:case 15:return n=Fv(n.type,!1),n;case 11:return n=Fv(n.type.render,!1),n;case 1:return n=Fv(n.type,!0),n;default:return""}}function Hy(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case lu:return"Fragment";case au:return"Portal";case Wy:return"Profiler";case z1:return"StrictMode";case Gy:return"Suspense";case jy:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case NT:return(n.displayName||"Context")+".Consumer";case _T:return(n._context.displayName||"Context")+".Provider";case U1:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case V1:return e=n.displayName||null,e!==null?e:Hy(n.type)||"Memo";case Po:e=n._payload,n=n._init;try{return Hy(n(e))}catch{}}return null}function BP(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hy(e);case 8:return e===z1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function aa(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function DT(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function zP(n){var e=DT(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Qf(n){n._valueTracker||(n._valueTracker=zP(n))}function AT(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=DT(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Yp(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function qy(n,e){var t=e.checked;return fn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function JC(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=aa(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function RT(n,e){e=e.checked,e!=null&&B1(n,"checked",e,!1)}function Ky(n,e){RT(n,e);var t=aa(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Xy(n,e.type,t):e.hasOwnProperty("defaultValue")&&Xy(n,e.type,aa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function eS(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Xy(n,e,t){(e!=="number"||Yp(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var th=Array.isArray;function Su(n,e,t,r){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&r&&(n[t].defaultSelected=!0)}else{for(t=""+aa(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,r&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function Yy(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ae(91));return fn({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function tS(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(Ae(92));if(th(t)){if(1<t.length)throw Error(Ae(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:aa(t)}}function OT(n,e){var t=aa(e.value),r=aa(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function nS(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function FT(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zy(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?FT(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Jf,LT=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Jf=Jf||document.createElement("div"),Jf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Jf.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Ih(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var ch={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},UP=["Webkit","ms","Moz","O"];Object.keys(ch).forEach(function(n){UP.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),ch[e]=ch[n]})});function PT(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||ch.hasOwnProperty(n)&&ch[n]?(""+e).trim():e+"px"}function MT(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,s=PT(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,s):n[t]=s}}var VP=fn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qy(n,e){if(e){if(VP[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ae(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ae(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ae(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ae(62))}}function Jy(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ex=null;function W1(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var tx=null,ku=null,Eu=null;function rS(n){if(n=ud(n)){if(typeof tx!="function")throw Error(Ae(280));var e=n.stateNode;e&&(e=hg(e),tx(n.stateNode,n.type,e))}}function BT(n){ku?Eu?Eu.push(n):Eu=[n]:ku=n}function zT(){if(ku){var n=ku,e=Eu;if(Eu=ku=null,rS(n),e)for(n=0;n<e.length;n++)rS(e[n])}}function UT(n,e){return n(e)}function VT(){}var Lv=!1;function WT(n,e,t){if(Lv)return n(e,t);Lv=!0;try{return UT(n,e,t)}finally{Lv=!1,(ku!==null||Eu!==null)&&(VT(),zT())}}function Th(n,e){var t=n.stateNode;if(t===null)return null;var r=hg(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(Ae(231,e,typeof t));return t}var nx=!1;if(fo)try{var Dc={};Object.defineProperty(Dc,"passive",{get:function(){nx=!0}}),window.addEventListener("test",Dc,Dc),window.removeEventListener("test",Dc,Dc)}catch{nx=!1}function WP(n,e,t,r,s,i,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var hh=!1,Zp=null,Qp=!1,rx=null,GP={onError:function(n){hh=!0,Zp=n}};function jP(n,e,t,r,s,i,o,a,l){hh=!1,Zp=null,WP.apply(GP,arguments)}function HP(n,e,t,r,s,i,o,a,l){if(jP.apply(this,arguments),hh){if(hh){var u=Zp;hh=!1,Zp=null}else throw Error(Ae(198));Qp||(Qp=!0,rx=u)}}function El(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function GT(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function sS(n){if(El(n)!==n)throw Error(Ae(188))}function qP(n){var e=n.alternate;if(!e){if(e=El(n),e===null)throw Error(Ae(188));return e!==n?null:n}for(var t=n,r=e;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return sS(s),n;if(i===r)return sS(s),e;i=i.sibling}throw Error(Ae(188))}if(t.return!==r.return)t=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o)throw Error(Ae(189))}}if(t.alternate!==r)throw Error(Ae(190))}if(t.tag!==3)throw Error(Ae(188));return t.stateNode.current===t?n:e}function jT(n){return n=qP(n),n!==null?HT(n):null}function HT(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=HT(n);if(e!==null)return e;n=n.sibling}return null}var qT=ys.unstable_scheduleCallback,iS=ys.unstable_cancelCallback,KP=ys.unstable_shouldYield,XP=ys.unstable_requestPaint,Nn=ys.unstable_now,YP=ys.unstable_getCurrentPriorityLevel,G1=ys.unstable_ImmediatePriority,KT=ys.unstable_UserBlockingPriority,Jp=ys.unstable_NormalPriority,ZP=ys.unstable_LowPriority,XT=ys.unstable_IdlePriority,ag=null,Mi=null;function QP(n){if(Mi&&typeof Mi.onCommitFiberRoot=="function")try{Mi.onCommitFiberRoot(ag,n,void 0,(n.current.flags&128)===128)}catch{}}var ci=Math.clz32?Math.clz32:tM,JP=Math.log,eM=Math.LN2;function tM(n){return n>>>=0,n===0?32:31-(JP(n)/eM|0)|0}var ep=64,tp=4194304;function nh(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function em(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,s=n.suspendedLanes,i=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?r=nh(a):(i&=o,i!==0&&(r=nh(i)))}else o=t&~s,o!==0?r=nh(o):i!==0&&(r=nh(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-ci(e),s=1<<t,r|=n[t],e&=~s;return r}function nM(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rM(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,s=n.expirationTimes,i=n.pendingLanes;0<i;){var o=31-ci(i),a=1<<o,l=s[o];l===-1?(!(a&t)||a&r)&&(s[o]=nM(a,e)):l<=e&&(n.expiredLanes|=a),i&=~a}}function sx(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function YT(){var n=ep;return ep<<=1,!(ep&4194240)&&(ep=64),n}function Pv(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function ad(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-ci(e),n[e]=t}function sM(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-ci(t),i=1<<s;e[s]=0,r[s]=-1,n[s]=-1,t&=~i}}function j1(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-ci(t),s=1<<r;s&e|n[r]&e&&(n[r]|=e),t&=~s}}var Bt=0;function ZT(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var QT,H1,JT,e_,t_,ix=!1,np=[],Ko=null,Xo=null,Yo=null,_h=new Map,Nh=new Map,zo=[],iM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function oS(n,e){switch(n){case"focusin":case"focusout":Ko=null;break;case"dragenter":case"dragleave":Xo=null;break;case"mouseover":case"mouseout":Yo=null;break;case"pointerover":case"pointerout":_h.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nh.delete(e.pointerId)}}function Ac(n,e,t,r,s,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=ud(e),e!==null&&H1(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function oM(n,e,t,r,s){switch(e){case"focusin":return Ko=Ac(Ko,n,e,t,r,s),!0;case"dragenter":return Xo=Ac(Xo,n,e,t,r,s),!0;case"mouseover":return Yo=Ac(Yo,n,e,t,r,s),!0;case"pointerover":var i=s.pointerId;return _h.set(i,Ac(_h.get(i)||null,n,e,t,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Nh.set(i,Ac(Nh.get(i)||null,n,e,t,r,s)),!0}return!1}function n_(n){var e=Wa(n.target);if(e!==null){var t=El(e);if(t!==null){if(e=t.tag,e===13){if(e=GT(t),e!==null){n.blockedOn=e,t_(n.priority,function(){JT(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Fp(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=ox(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);ex=r,t.target.dispatchEvent(r),ex=null}else return e=ud(t),e!==null&&H1(e),n.blockedOn=t,!1;e.shift()}return!0}function aS(n,e,t){Fp(n)&&t.delete(e)}function aM(){ix=!1,Ko!==null&&Fp(Ko)&&(Ko=null),Xo!==null&&Fp(Xo)&&(Xo=null),Yo!==null&&Fp(Yo)&&(Yo=null),_h.forEach(aS),Nh.forEach(aS)}function Rc(n,e){n.blockedOn===e&&(n.blockedOn=null,ix||(ix=!0,ys.unstable_scheduleCallback(ys.unstable_NormalPriority,aM)))}function $h(n){function e(s){return Rc(s,n)}if(0<np.length){Rc(np[0],n);for(var t=1;t<np.length;t++){var r=np[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Ko!==null&&Rc(Ko,n),Xo!==null&&Rc(Xo,n),Yo!==null&&Rc(Yo,n),_h.forEach(e),Nh.forEach(e),t=0;t<zo.length;t++)r=zo[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<zo.length&&(t=zo[0],t.blockedOn===null);)n_(t),t.blockedOn===null&&zo.shift()}var Iu=So.ReactCurrentBatchConfig,tm=!0;function lM(n,e,t,r){var s=Bt,i=Iu.transition;Iu.transition=null;try{Bt=1,q1(n,e,t,r)}finally{Bt=s,Iu.transition=i}}function uM(n,e,t,r){var s=Bt,i=Iu.transition;Iu.transition=null;try{Bt=4,q1(n,e,t,r)}finally{Bt=s,Iu.transition=i}}function q1(n,e,t,r){if(tm){var s=ox(n,e,t,r);if(s===null)qv(n,e,r,nm,t),oS(n,r);else if(oM(s,n,e,t,r))r.stopPropagation();else if(oS(n,r),e&4&&-1<iM.indexOf(n)){for(;s!==null;){var i=ud(s);if(i!==null&&QT(i),i=ox(n,e,t,r),i===null&&qv(n,e,r,nm,t),i===s)break;s=i}s!==null&&r.stopPropagation()}else qv(n,e,r,null,t)}}var nm=null;function ox(n,e,t,r){if(nm=null,n=W1(r),n=Wa(n),n!==null)if(e=El(n),e===null)n=null;else if(t=e.tag,t===13){if(n=GT(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return nm=n,null}function r_(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(YP()){case G1:return 1;case KT:return 4;case Jp:case ZP:return 16;case XT:return 536870912;default:return 16}default:return 16}}var Vo=null,K1=null,Lp=null;function s_(){if(Lp)return Lp;var n,e=K1,t=e.length,r,s="value"in Vo?Vo.value:Vo.textContent,i=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===s[i-r];r++);return Lp=s.slice(n,1<r?1-r:void 0)}function Pp(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function rp(){return!0}function lS(){return!1}function bs(n){function e(t,r,s,i,o){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?rp:lS,this.isPropagationStopped=lS,this}return fn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=rp)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=rp)},persist:function(){},isPersistent:rp}),e}var sc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},X1=bs(sc),ld=fn({},sc,{view:0,detail:0}),cM=bs(ld),Mv,Bv,Oc,lg=fn({},ld,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Y1,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Oc&&(Oc&&n.type==="mousemove"?(Mv=n.screenX-Oc.screenX,Bv=n.screenY-Oc.screenY):Bv=Mv=0,Oc=n),Mv)},movementY:function(n){return"movementY"in n?n.movementY:Bv}}),uS=bs(lg),hM=fn({},lg,{dataTransfer:0}),dM=bs(hM),fM=fn({},ld,{relatedTarget:0}),zv=bs(fM),pM=fn({},sc,{animationName:0,elapsedTime:0,pseudoElement:0}),mM=bs(pM),gM=fn({},sc,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),vM=bs(gM),yM=fn({},sc,{data:0}),cS=bs(yM),xM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function CM(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=bM[n])?!!e[n]:!1}function Y1(){return CM}var SM=fn({},ld,{key:function(n){if(n.key){var e=xM[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Pp(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?wM[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Y1,charCode:function(n){return n.type==="keypress"?Pp(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Pp(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),kM=bs(SM),EM=fn({},lg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hS=bs(EM),IM=fn({},ld,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Y1}),TM=bs(IM),_M=fn({},sc,{propertyName:0,elapsedTime:0,pseudoElement:0}),NM=bs(_M),$M=fn({},lg,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),DM=bs($M),AM=[9,13,27,32],Z1=fo&&"CompositionEvent"in window,dh=null;fo&&"documentMode"in document&&(dh=document.documentMode);var RM=fo&&"TextEvent"in window&&!dh,i_=fo&&(!Z1||dh&&8<dh&&11>=dh),dS=String.fromCharCode(32),fS=!1;function o_(n,e){switch(n){case"keyup":return AM.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function a_(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var uu=!1;function OM(n,e){switch(n){case"compositionend":return a_(e);case"keypress":return e.which!==32?null:(fS=!0,dS);case"textInput":return n=e.data,n===dS&&fS?null:n;default:return null}}function FM(n,e){if(uu)return n==="compositionend"||!Z1&&o_(n,e)?(n=s_(),Lp=K1=Vo=null,uu=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return i_&&e.locale!=="ko"?null:e.data;default:return null}}var LM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pS(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!LM[n.type]:e==="textarea"}function l_(n,e,t,r){BT(r),e=rm(e,"onChange"),0<e.length&&(t=new X1("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var fh=null,Dh=null;function PM(n){x_(n,0)}function ug(n){var e=du(n);if(AT(e))return n}function MM(n,e){if(n==="change")return e}var u_=!1;if(fo){var Uv;if(fo){var Vv="oninput"in document;if(!Vv){var mS=document.createElement("div");mS.setAttribute("oninput","return;"),Vv=typeof mS.oninput=="function"}Uv=Vv}else Uv=!1;u_=Uv&&(!document.documentMode||9<document.documentMode)}function gS(){fh&&(fh.detachEvent("onpropertychange",c_),Dh=fh=null)}function c_(n){if(n.propertyName==="value"&&ug(Dh)){var e=[];l_(e,Dh,n,W1(n)),WT(PM,e)}}function BM(n,e,t){n==="focusin"?(gS(),fh=e,Dh=t,fh.attachEvent("onpropertychange",c_)):n==="focusout"&&gS()}function zM(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return ug(Dh)}function UM(n,e){if(n==="click")return ug(e)}function VM(n,e){if(n==="input"||n==="change")return ug(e)}function WM(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var gi=typeof Object.is=="function"?Object.is:WM;function Ah(n,e){if(gi(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!Vy.call(e,s)||!gi(n[s],e[s]))return!1}return!0}function vS(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function yS(n,e){var t=vS(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=vS(t)}}function h_(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?h_(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function d_(){for(var n=window,e=Yp();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Yp(n.document)}return e}function Q1(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function GM(n){var e=d_(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&h_(t.ownerDocument.documentElement,t)){if(r!==null&&Q1(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!n.extend&&i>r&&(s=r,r=i,i=s),s=yS(t,i);var o=yS(t,r);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var jM=fo&&"documentMode"in document&&11>=document.documentMode,cu=null,ax=null,ph=null,lx=!1;function xS(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;lx||cu==null||cu!==Yp(r)||(r=cu,"selectionStart"in r&&Q1(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ph&&Ah(ph,r)||(ph=r,r=rm(ax,"onSelect"),0<r.length&&(e=new X1("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=cu)))}function sp(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var hu={animationend:sp("Animation","AnimationEnd"),animationiteration:sp("Animation","AnimationIteration"),animationstart:sp("Animation","AnimationStart"),transitionend:sp("Transition","TransitionEnd")},Wv={},f_={};fo&&(f_=document.createElement("div").style,"AnimationEvent"in window||(delete hu.animationend.animation,delete hu.animationiteration.animation,delete hu.animationstart.animation),"TransitionEvent"in window||delete hu.transitionend.transition);function cg(n){if(Wv[n])return Wv[n];if(!hu[n])return n;var e=hu[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in f_)return Wv[n]=e[t];return n}var p_=cg("animationend"),m_=cg("animationiteration"),g_=cg("animationstart"),v_=cg("transitionend"),y_=new Map,wS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function va(n,e){y_.set(n,e),kl(e,[n])}for(var Gv=0;Gv<wS.length;Gv++){var jv=wS[Gv],HM=jv.toLowerCase(),qM=jv[0].toUpperCase()+jv.slice(1);va(HM,"on"+qM)}va(p_,"onAnimationEnd");va(m_,"onAnimationIteration");va(g_,"onAnimationStart");va("dblclick","onDoubleClick");va("focusin","onFocus");va("focusout","onBlur");va(v_,"onTransitionEnd");Fu("onMouseEnter",["mouseout","mouseover"]);Fu("onMouseLeave",["mouseout","mouseover"]);Fu("onPointerEnter",["pointerout","pointerover"]);Fu("onPointerLeave",["pointerout","pointerover"]);kl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));kl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));kl("onBeforeInput",["compositionend","keypress","textInput","paste"]);kl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));kl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));kl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KM=new Set("cancel close invalid load scroll toggle".split(" ").concat(rh));function bS(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,HP(r,e,void 0,n),n.currentTarget=null}function x_(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;bS(s,a,u),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;bS(s,a,u),i=l}}}if(Qp)throw n=rx,Qp=!1,rx=null,n}function nn(n,e){var t=e[fx];t===void 0&&(t=e[fx]=new Set);var r=n+"__bubble";t.has(r)||(w_(e,n,2,!1),t.add(r))}function Hv(n,e,t){var r=0;e&&(r|=4),w_(t,n,r,e)}var ip="_reactListening"+Math.random().toString(36).slice(2);function Rh(n){if(!n[ip]){n[ip]=!0,TT.forEach(function(t){t!=="selectionchange"&&(KM.has(t)||Hv(t,!1,n),Hv(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[ip]||(e[ip]=!0,Hv("selectionchange",!1,e))}}function w_(n,e,t,r){switch(r_(e)){case 1:var s=lM;break;case 4:s=uM;break;default:s=q1}t=s.bind(null,e,t,n),s=void 0,!nx||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function qv(n,e,t,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Wa(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}WT(function(){var u=i,c=W1(t),h=[];e:{var d=y_.get(n);if(d!==void 0){var f=X1,p=n;switch(n){case"keypress":if(Pp(t)===0)break e;case"keydown":case"keyup":f=kM;break;case"focusin":p="focus",f=zv;break;case"focusout":p="blur",f=zv;break;case"beforeblur":case"afterblur":f=zv;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=uS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=dM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=TM;break;case p_:case m_:case g_:f=mM;break;case v_:f=NM;break;case"scroll":f=cM;break;case"wheel":f=DM;break;case"copy":case"cut":case"paste":f=vM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=hS}var v=(e&4)!==0,g=!v&&n==="scroll",m=v?d!==null?d+"Capture":null:d;v=[];for(var y=u,w;y!==null;){w=y;var x=w.stateNode;if(w.tag===5&&x!==null&&(w=x,m!==null&&(x=Th(y,m),x!=null&&v.push(Oh(y,x,w)))),g)break;y=y.return}0<v.length&&(d=new f(d,p,null,t,c),h.push({event:d,listeners:v}))}}if(!(e&7)){e:{if(d=n==="mouseover"||n==="pointerover",f=n==="mouseout"||n==="pointerout",d&&t!==ex&&(p=t.relatedTarget||t.fromElement)&&(Wa(p)||p[po]))break e;if((f||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=t.relatedTarget||t.toElement,f=u,p=p?Wa(p):null,p!==null&&(g=El(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=u),f!==p)){if(v=uS,x="onMouseLeave",m="onMouseEnter",y="mouse",(n==="pointerout"||n==="pointerover")&&(v=hS,x="onPointerLeave",m="onPointerEnter",y="pointer"),g=f==null?d:du(f),w=p==null?d:du(p),d=new v(x,y+"leave",f,t,c),d.target=g,d.relatedTarget=w,x=null,Wa(c)===u&&(v=new v(m,y+"enter",p,t,c),v.target=w,v.relatedTarget=g,x=v),g=x,f&&p)t:{for(v=f,m=p,y=0,w=v;w;w=jl(w))y++;for(w=0,x=m;x;x=jl(x))w++;for(;0<y-w;)v=jl(v),y--;for(;0<w-y;)m=jl(m),w--;for(;y--;){if(v===m||m!==null&&v===m.alternate)break t;v=jl(v),m=jl(m)}v=null}else v=null;f!==null&&CS(h,d,f,v,!1),p!==null&&g!==null&&CS(h,g,p,v,!0)}}e:{if(d=u?du(u):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var b=MM;else if(pS(d))if(u_)b=VM;else{b=zM;var C=BM}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(b=UM);if(b&&(b=b(n,u))){l_(h,b,t,c);break e}C&&C(n,d,u),n==="focusout"&&(C=d._wrapperState)&&C.controlled&&d.type==="number"&&Xy(d,"number",d.value)}switch(C=u?du(u):window,n){case"focusin":(pS(C)||C.contentEditable==="true")&&(cu=C,ax=u,ph=null);break;case"focusout":ph=ax=cu=null;break;case"mousedown":lx=!0;break;case"contextmenu":case"mouseup":case"dragend":lx=!1,xS(h,t,c);break;case"selectionchange":if(jM)break;case"keydown":case"keyup":xS(h,t,c)}var k;if(Z1)e:{switch(n){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else uu?o_(n,t)&&(E="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(E="onCompositionStart");E&&(i_&&t.locale!=="ko"&&(uu||E!=="onCompositionStart"?E==="onCompositionEnd"&&uu&&(k=s_()):(Vo=c,K1="value"in Vo?Vo.value:Vo.textContent,uu=!0)),C=rm(u,E),0<C.length&&(E=new cS(E,n,null,t,c),h.push({event:E,listeners:C}),k?E.data=k:(k=a_(t),k!==null&&(E.data=k)))),(k=RM?OM(n,t):FM(n,t))&&(u=rm(u,"onBeforeInput"),0<u.length&&(c=new cS("onBeforeInput","beforeinput",null,t,c),h.push({event:c,listeners:u}),c.data=k))}x_(h,e)})}function Oh(n,e,t){return{instance:n,listener:e,currentTarget:t}}function rm(n,e){for(var t=e+"Capture",r=[];n!==null;){var s=n,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Th(n,t),i!=null&&r.unshift(Oh(n,i,s)),i=Th(n,e),i!=null&&r.push(Oh(n,i,s))),n=n.return}return r}function jl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function CS(n,e,t,r,s){for(var i=e._reactName,o=[];t!==null&&t!==r;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,s?(l=Th(t,i),l!=null&&o.unshift(Oh(t,l,a))):s||(l=Th(t,i),l!=null&&o.push(Oh(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var XM=/\r\n?/g,YM=/\u0000|\uFFFD/g;function SS(n){return(typeof n=="string"?n:""+n).replace(XM,`
`).replace(YM,"")}function op(n,e,t){if(e=SS(e),SS(n)!==e&&t)throw Error(Ae(425))}function sm(){}var ux=null,cx=null;function hx(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var dx=typeof setTimeout=="function"?setTimeout:void 0,ZM=typeof clearTimeout=="function"?clearTimeout:void 0,kS=typeof Promise=="function"?Promise:void 0,QM=typeof queueMicrotask=="function"?queueMicrotask:typeof kS<"u"?function(n){return kS.resolve(null).then(n).catch(JM)}:dx;function JM(n){setTimeout(function(){throw n})}function Kv(n,e){var t=e,r=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(r===0){n.removeChild(s),$h(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=s}while(t);$h(e)}function Zo(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function ES(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var ic=Math.random().toString(36).slice(2),Oi="__reactFiber$"+ic,Fh="__reactProps$"+ic,po="__reactContainer$"+ic,fx="__reactEvents$"+ic,eB="__reactListeners$"+ic,tB="__reactHandles$"+ic;function Wa(n){var e=n[Oi];if(e)return e;for(var t=n.parentNode;t;){if(e=t[po]||t[Oi]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=ES(n);n!==null;){if(t=n[Oi])return t;n=ES(n)}return e}n=t,t=n.parentNode}return null}function ud(n){return n=n[Oi]||n[po],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function du(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(Ae(33))}function hg(n){return n[Fh]||null}var px=[],fu=-1;function ya(n){return{current:n}}function rn(n){0>fu||(n.current=px[fu],px[fu]=null,fu--)}function Qt(n,e){fu++,px[fu]=n.current,n.current=e}var la={},Ir=ya(la),Jr=ya(!1),tl=la;function Lu(n,e){var t=n.type.contextTypes;if(!t)return la;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in t)s[i]=e[i];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function es(n){return n=n.childContextTypes,n!=null}function im(){rn(Jr),rn(Ir)}function IS(n,e,t){if(Ir.current!==la)throw Error(Ae(168));Qt(Ir,e),Qt(Jr,t)}function b_(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Ae(108,BP(n)||"Unknown",s));return fn({},t,r)}function om(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||la,tl=Ir.current,Qt(Ir,n),Qt(Jr,Jr.current),!0}function TS(n,e,t){var r=n.stateNode;if(!r)throw Error(Ae(169));t?(n=b_(n,e,tl),r.__reactInternalMemoizedMergedChildContext=n,rn(Jr),rn(Ir),Qt(Ir,n)):rn(Jr),Qt(Jr,t)}var so=null,dg=!1,Xv=!1;function C_(n){so===null?so=[n]:so.push(n)}function nB(n){dg=!0,C_(n)}function xa(){if(!Xv&&so!==null){Xv=!0;var n=0,e=Bt;try{var t=so;for(Bt=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}so=null,dg=!1}catch(s){throw so!==null&&(so=so.slice(n+1)),qT(G1,xa),s}finally{Bt=e,Xv=!1}}return null}var pu=[],mu=0,am=null,lm=0,Os=[],Fs=0,nl=null,ao=1,lo="";function La(n,e){pu[mu++]=lm,pu[mu++]=am,am=n,lm=e}function S_(n,e,t){Os[Fs++]=ao,Os[Fs++]=lo,Os[Fs++]=nl,nl=n;var r=ao;n=lo;var s=32-ci(r)-1;r&=~(1<<s),t+=1;var i=32-ci(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ao=1<<32-ci(e)+s|t<<s|r,lo=i+n}else ao=1<<i|t<<s|r,lo=n}function J1(n){n.return!==null&&(La(n,1),S_(n,1,0))}function ew(n){for(;n===am;)am=pu[--mu],pu[mu]=null,lm=pu[--mu],pu[mu]=null;for(;n===nl;)nl=Os[--Fs],Os[Fs]=null,lo=Os[--Fs],Os[Fs]=null,ao=Os[--Fs],Os[Fs]=null}var gs=null,ps=null,an=!1,oi=null;function k_(n,e){var t=Ps(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function _S(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,gs=n,ps=Zo(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,gs=n,ps=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=nl!==null?{id:ao,overflow:lo}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Ps(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,gs=n,ps=null,!0):!1;default:return!1}}function mx(n){return(n.mode&1)!==0&&(n.flags&128)===0}function gx(n){if(an){var e=ps;if(e){var t=e;if(!_S(n,e)){if(mx(n))throw Error(Ae(418));e=Zo(t.nextSibling);var r=gs;e&&_S(n,e)?k_(r,t):(n.flags=n.flags&-4097|2,an=!1,gs=n)}}else{if(mx(n))throw Error(Ae(418));n.flags=n.flags&-4097|2,an=!1,gs=n}}}function NS(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;gs=n}function ap(n){if(n!==gs)return!1;if(!an)return NS(n),an=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!hx(n.type,n.memoizedProps)),e&&(e=ps)){if(mx(n))throw E_(),Error(Ae(418));for(;e;)k_(n,e),e=Zo(e.nextSibling)}if(NS(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Ae(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){ps=Zo(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}ps=null}}else ps=gs?Zo(n.stateNode.nextSibling):null;return!0}function E_(){for(var n=ps;n;)n=Zo(n.nextSibling)}function Pu(){ps=gs=null,an=!1}function tw(n){oi===null?oi=[n]:oi.push(n)}var rB=So.ReactCurrentBatchConfig;function ri(n,e){if(n&&n.defaultProps){e=fn({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var um=ya(null),cm=null,gu=null,nw=null;function rw(){nw=gu=cm=null}function sw(n){var e=um.current;rn(um),n._currentValue=e}function vx(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Tu(n,e){cm=n,nw=gu=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Yr=!0),n.firstContext=null)}function Gs(n){var e=n._currentValue;if(nw!==n)if(n={context:n,memoizedValue:e,next:null},gu===null){if(cm===null)throw Error(Ae(308));gu=n,cm.dependencies={lanes:0,firstContext:n}}else gu=gu.next=n;return e}var Ga=null;function iw(n){Ga===null?Ga=[n]:Ga.push(n)}function I_(n,e,t,r){var s=e.interleaved;return s===null?(t.next=t,iw(e)):(t.next=s.next,s.next=t),e.interleaved=t,mo(n,r)}function mo(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Mo=!1;function ow(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function T_(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function co(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Qo(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,It&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,mo(n,t)}return s=r.interleaved,s===null?(e.next=e,iw(r)):(e.next=s.next,s.next=e),r.interleaved=e,mo(n,t)}function Mp(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,j1(n,t)}}function $S(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?s=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?s=i=e:i=i.next=e}else s=i=e;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function hm(n,e,t,r){var s=n.updateQueue;Mo=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var c=n.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;o=0,c=u=l=null,a=i;do{var d=a.lane,f=a.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=n,v=a;switch(d=e,f=t,v.tag){case 1:if(p=v.payload,typeof p=="function"){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=v.payload,d=typeof p=="function"?p.call(f,h,d):p,d==null)break e;h=fn({},h,d);break e;case 2:Mo=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,d=s.effects,d===null?s.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=f,l=h):c=c.next=f,o|=d;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;d=a,a=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(1);if(c===null&&(l=h),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=c,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);sl|=o,n.lanes=o,n.memoizedState=h}}function DS(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],s=r.callback;if(s!==null){if(r.callback=null,r=t,typeof s!="function")throw Error(Ae(191,s));s.call(r)}}}var __=new IT.Component().refs;function yx(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:fn({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var fg={isMounted:function(n){return(n=n._reactInternals)?El(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Pr(),s=ea(n),i=co(r,s);i.payload=e,t!=null&&(i.callback=t),e=Qo(n,i,s),e!==null&&(hi(e,n,s,r),Mp(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Pr(),s=ea(n),i=co(r,s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=Qo(n,i,s),e!==null&&(hi(e,n,s,r),Mp(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Pr(),r=ea(n),s=co(t,r);s.tag=2,e!=null&&(s.callback=e),e=Qo(n,s,r),e!==null&&(hi(e,n,r,t),Mp(e,n,r))}};function AS(n,e,t,r,s,i,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ah(t,r)||!Ah(s,i):!0}function N_(n,e,t){var r=!1,s=la,i=e.contextType;return typeof i=="object"&&i!==null?i=Gs(i):(s=es(e)?tl:Ir.current,r=e.contextTypes,i=(r=r!=null)?Lu(n,s):la),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=fg,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=i),e}function RS(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&fg.enqueueReplaceState(e,e.state,null)}function xx(n,e,t,r){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs=__,ow(n);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Gs(i):(i=es(e)?tl:Ir.current,s.context=Lu(n,i)),s.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(yx(n,e,i,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&fg.enqueueReplaceState(s,s.state,null),hm(n,t,s,r),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function Fc(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(Ae(309));var r=t.stateNode}if(!r)throw Error(Ae(147,n));var s=r,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;a===__&&(a=s.refs={}),o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof n!="string")throw Error(Ae(284));if(!t._owner)throw Error(Ae(290,n))}return n}function lp(n,e){throw n=Object.prototype.toString.call(e),Error(Ae(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function OS(n){var e=n._init;return e(n._payload)}function $_(n){function e(m,y){if(n){var w=m.deletions;w===null?(m.deletions=[y],m.flags|=16):w.push(y)}}function t(m,y){if(!n)return null;for(;y!==null;)e(m,y),y=y.sibling;return null}function r(m,y){for(m=new Map;y!==null;)y.key!==null?m.set(y.key,y):m.set(y.index,y),y=y.sibling;return m}function s(m,y){return m=ta(m,y),m.index=0,m.sibling=null,m}function i(m,y,w){return m.index=w,n?(w=m.alternate,w!==null?(w=w.index,w<y?(m.flags|=2,y):w):(m.flags|=2,y)):(m.flags|=1048576,y)}function o(m){return n&&m.alternate===null&&(m.flags|=2),m}function a(m,y,w,x){return y===null||y.tag!==6?(y=ny(w,m.mode,x),y.return=m,y):(y=s(y,w),y.return=m,y)}function l(m,y,w,x){var b=w.type;return b===lu?c(m,y,w.props.children,x,w.key):y!==null&&(y.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Po&&OS(b)===y.type)?(x=s(y,w.props),x.ref=Fc(m,y,w),x.return=m,x):(x=Gp(w.type,w.key,w.props,null,m.mode,x),x.ref=Fc(m,y,w),x.return=m,x)}function u(m,y,w,x){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=ry(w,m.mode,x),y.return=m,y):(y=s(y,w.children||[]),y.return=m,y)}function c(m,y,w,x,b){return y===null||y.tag!==7?(y=Za(w,m.mode,x,b),y.return=m,y):(y=s(y,w),y.return=m,y)}function h(m,y,w){if(typeof y=="string"&&y!==""||typeof y=="number")return y=ny(""+y,m.mode,w),y.return=m,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Zf:return w=Gp(y.type,y.key,y.props,null,m.mode,w),w.ref=Fc(m,null,y),w.return=m,w;case au:return y=ry(y,m.mode,w),y.return=m,y;case Po:var x=y._init;return h(m,x(y._payload),w)}if(th(y)||$c(y))return y=Za(y,m.mode,w,null),y.return=m,y;lp(m,y)}return null}function d(m,y,w,x){var b=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return b!==null?null:a(m,y,""+w,x);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Zf:return w.key===b?l(m,y,w,x):null;case au:return w.key===b?u(m,y,w,x):null;case Po:return b=w._init,d(m,y,b(w._payload),x)}if(th(w)||$c(w))return b!==null?null:c(m,y,w,x,null);lp(m,w)}return null}function f(m,y,w,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return m=m.get(w)||null,a(y,m,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Zf:return m=m.get(x.key===null?w:x.key)||null,l(y,m,x,b);case au:return m=m.get(x.key===null?w:x.key)||null,u(y,m,x,b);case Po:var C=x._init;return f(m,y,w,C(x._payload),b)}if(th(x)||$c(x))return m=m.get(w)||null,c(y,m,x,b,null);lp(y,x)}return null}function p(m,y,w,x){for(var b=null,C=null,k=y,E=y=0,T=null;k!==null&&E<w.length;E++){k.index>E?(T=k,k=null):T=k.sibling;var _=d(m,k,w[E],x);if(_===null){k===null&&(k=T);break}n&&k&&_.alternate===null&&e(m,k),y=i(_,y,E),C===null?b=_:C.sibling=_,C=_,k=T}if(E===w.length)return t(m,k),an&&La(m,E),b;if(k===null){for(;E<w.length;E++)k=h(m,w[E],x),k!==null&&(y=i(k,y,E),C===null?b=k:C.sibling=k,C=k);return an&&La(m,E),b}for(k=r(m,k);E<w.length;E++)T=f(k,m,E,w[E],x),T!==null&&(n&&T.alternate!==null&&k.delete(T.key===null?E:T.key),y=i(T,y,E),C===null?b=T:C.sibling=T,C=T);return n&&k.forEach(function(A){return e(m,A)}),an&&La(m,E),b}function v(m,y,w,x){var b=$c(w);if(typeof b!="function")throw Error(Ae(150));if(w=b.call(w),w==null)throw Error(Ae(151));for(var C=b=null,k=y,E=y=0,T=null,_=w.next();k!==null&&!_.done;E++,_=w.next()){k.index>E?(T=k,k=null):T=k.sibling;var A=d(m,k,_.value,x);if(A===null){k===null&&(k=T);break}n&&k&&A.alternate===null&&e(m,k),y=i(A,y,E),C===null?b=A:C.sibling=A,C=A,k=T}if(_.done)return t(m,k),an&&La(m,E),b;if(k===null){for(;!_.done;E++,_=w.next())_=h(m,_.value,x),_!==null&&(y=i(_,y,E),C===null?b=_:C.sibling=_,C=_);return an&&La(m,E),b}for(k=r(m,k);!_.done;E++,_=w.next())_=f(k,m,E,_.value,x),_!==null&&(n&&_.alternate!==null&&k.delete(_.key===null?E:_.key),y=i(_,y,E),C===null?b=_:C.sibling=_,C=_);return n&&k.forEach(function(P){return e(m,P)}),an&&La(m,E),b}function g(m,y,w,x){if(typeof w=="object"&&w!==null&&w.type===lu&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Zf:e:{for(var b=w.key,C=y;C!==null;){if(C.key===b){if(b=w.type,b===lu){if(C.tag===7){t(m,C.sibling),y=s(C,w.props.children),y.return=m,m=y;break e}}else if(C.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Po&&OS(b)===C.type){t(m,C.sibling),y=s(C,w.props),y.ref=Fc(m,C,w),y.return=m,m=y;break e}t(m,C);break}else e(m,C);C=C.sibling}w.type===lu?(y=Za(w.props.children,m.mode,x,w.key),y.return=m,m=y):(x=Gp(w.type,w.key,w.props,null,m.mode,x),x.ref=Fc(m,y,w),x.return=m,m=x)}return o(m);case au:e:{for(C=w.key;y!==null;){if(y.key===C)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){t(m,y.sibling),y=s(y,w.children||[]),y.return=m,m=y;break e}else{t(m,y);break}else e(m,y);y=y.sibling}y=ry(w,m.mode,x),y.return=m,m=y}return o(m);case Po:return C=w._init,g(m,y,C(w._payload),x)}if(th(w))return p(m,y,w,x);if($c(w))return v(m,y,w,x);lp(m,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,y!==null&&y.tag===6?(t(m,y.sibling),y=s(y,w),y.return=m,m=y):(t(m,y),y=ny(w,m.mode,x),y.return=m,m=y),o(m)):t(m,y)}return g}var Mu=$_(!0),D_=$_(!1),cd={},Bi=ya(cd),Lh=ya(cd),Ph=ya(cd);function ja(n){if(n===cd)throw Error(Ae(174));return n}function aw(n,e){switch(Qt(Ph,e),Qt(Lh,n),Qt(Bi,cd),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Zy(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Zy(e,n)}rn(Bi),Qt(Bi,e)}function Bu(){rn(Bi),rn(Lh),rn(Ph)}function A_(n){ja(Ph.current);var e=ja(Bi.current),t=Zy(e,n.type);e!==t&&(Qt(Lh,n),Qt(Bi,t))}function lw(n){Lh.current===n&&(rn(Bi),rn(Lh))}var hn=ya(0);function dm(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Yv=[];function uw(){for(var n=0;n<Yv.length;n++)Yv[n]._workInProgressVersionPrimary=null;Yv.length=0}var Bp=So.ReactCurrentDispatcher,Zv=So.ReactCurrentBatchConfig,rl=0,dn=null,Kn=null,tr=null,fm=!1,mh=!1,Mh=0,sB=0;function xr(){throw Error(Ae(321))}function cw(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!gi(n[t],e[t]))return!1;return!0}function hw(n,e,t,r,s,i){if(rl=i,dn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Bp.current=n===null||n.memoizedState===null?lB:uB,n=t(r,s),mh){i=0;do{if(mh=!1,Mh=0,25<=i)throw Error(Ae(301));i+=1,tr=Kn=null,e.updateQueue=null,Bp.current=cB,n=t(r,s)}while(mh)}if(Bp.current=pm,e=Kn!==null&&Kn.next!==null,rl=0,tr=Kn=dn=null,fm=!1,e)throw Error(Ae(300));return n}function dw(){var n=Mh!==0;return Mh=0,n}function _i(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return tr===null?dn.memoizedState=tr=n:tr=tr.next=n,tr}function js(){if(Kn===null){var n=dn.alternate;n=n!==null?n.memoizedState:null}else n=Kn.next;var e=tr===null?dn.memoizedState:tr.next;if(e!==null)tr=e,Kn=n;else{if(n===null)throw Error(Ae(310));Kn=n,n={memoizedState:Kn.memoizedState,baseState:Kn.baseState,baseQueue:Kn.baseQueue,queue:Kn.queue,next:null},tr===null?dn.memoizedState=tr=n:tr=tr.next=n}return tr}function Bh(n,e){return typeof e=="function"?e(n):e}function Qv(n){var e=js(),t=e.queue;if(t===null)throw Error(Ae(311));t.lastRenderedReducer=n;var r=Kn,s=r.baseQueue,i=t.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,t.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,u=i;do{var c=u.lane;if((rl&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:n(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,dn.lanes|=c,sl|=c}u=u.next}while(u!==null&&u!==i);l===null?o=r:l.next=a,gi(r,e.memoizedState)||(Yr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){s=n;do i=s.lane,dn.lanes|=i,sl|=i,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Jv(n){var e=js(),t=e.queue;if(t===null)throw Error(Ae(311));t.lastRenderedReducer=n;var r=t.dispatch,s=t.pending,i=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do i=n(i,o.action),o=o.next;while(o!==s);gi(i,e.memoizedState)||(Yr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function R_(){}function O_(n,e){var t=dn,r=js(),s=e(),i=!gi(r.memoizedState,s);if(i&&(r.memoizedState=s,Yr=!0),r=r.queue,fw(P_.bind(null,t,r,n),[n]),r.getSnapshot!==e||i||tr!==null&&tr.memoizedState.tag&1){if(t.flags|=2048,zh(9,L_.bind(null,t,r,s,e),void 0,null),rr===null)throw Error(Ae(349));rl&30||F_(t,e,s)}return s}function F_(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=dn.updateQueue,e===null?(e={lastEffect:null,stores:null},dn.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function L_(n,e,t,r){e.value=t,e.getSnapshot=r,M_(e)&&B_(n)}function P_(n,e,t){return t(function(){M_(e)&&B_(n)})}function M_(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!gi(n,t)}catch{return!0}}function B_(n){var e=mo(n,1);e!==null&&hi(e,n,1,-1)}function FS(n){var e=_i();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bh,lastRenderedState:n},e.queue=n,n=n.dispatch=aB.bind(null,dn,n),[e.memoizedState,n]}function zh(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=dn.updateQueue,e===null?(e={lastEffect:null,stores:null},dn.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function z_(){return js().memoizedState}function zp(n,e,t,r){var s=_i();dn.flags|=n,s.memoizedState=zh(1|e,t,void 0,r===void 0?null:r)}function pg(n,e,t,r){var s=js();r=r===void 0?null:r;var i=void 0;if(Kn!==null){var o=Kn.memoizedState;if(i=o.destroy,r!==null&&cw(r,o.deps)){s.memoizedState=zh(e,t,i,r);return}}dn.flags|=n,s.memoizedState=zh(1|e,t,i,r)}function LS(n,e){return zp(8390656,8,n,e)}function fw(n,e){return pg(2048,8,n,e)}function U_(n,e){return pg(4,2,n,e)}function V_(n,e){return pg(4,4,n,e)}function W_(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function G_(n,e,t){return t=t!=null?t.concat([n]):null,pg(4,4,W_.bind(null,e,n),t)}function pw(){}function j_(n,e){var t=js();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&cw(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function H_(n,e){var t=js();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&cw(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function q_(n,e,t){return rl&21?(gi(t,e)||(t=YT(),dn.lanes|=t,sl|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Yr=!0),n.memoizedState=t)}function iB(n,e){var t=Bt;Bt=t!==0&&4>t?t:4,n(!0);var r=Zv.transition;Zv.transition={};try{n(!1),e()}finally{Bt=t,Zv.transition=r}}function K_(){return js().memoizedState}function oB(n,e,t){var r=ea(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},X_(n))Y_(e,t);else if(t=I_(n,e,t,r),t!==null){var s=Pr();hi(t,n,r,s),Z_(t,e,r)}}function aB(n,e,t){var r=ea(n),s={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(X_(n))Y_(e,s);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,t);if(s.hasEagerState=!0,s.eagerState=a,gi(a,o)){var l=e.interleaved;l===null?(s.next=s,iw(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}t=I_(n,e,s,r),t!==null&&(s=Pr(),hi(t,n,r,s),Z_(t,e,r))}}function X_(n){var e=n.alternate;return n===dn||e!==null&&e===dn}function Y_(n,e){mh=fm=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function Z_(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,j1(n,t)}}var pm={readContext:Gs,useCallback:xr,useContext:xr,useEffect:xr,useImperativeHandle:xr,useInsertionEffect:xr,useLayoutEffect:xr,useMemo:xr,useReducer:xr,useRef:xr,useState:xr,useDebugValue:xr,useDeferredValue:xr,useTransition:xr,useMutableSource:xr,useSyncExternalStore:xr,useId:xr,unstable_isNewReconciler:!1},lB={readContext:Gs,useCallback:function(n,e){return _i().memoizedState=[n,e===void 0?null:e],n},useContext:Gs,useEffect:LS,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,zp(4194308,4,W_.bind(null,e,n),t)},useLayoutEffect:function(n,e){return zp(4194308,4,n,e)},useInsertionEffect:function(n,e){return zp(4,2,n,e)},useMemo:function(n,e){var t=_i();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=_i();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=oB.bind(null,dn,n),[r.memoizedState,n]},useRef:function(n){var e=_i();return n={current:n},e.memoizedState=n},useState:FS,useDebugValue:pw,useDeferredValue:function(n){return _i().memoizedState=n},useTransition:function(){var n=FS(!1),e=n[0];return n=iB.bind(null,n[1]),_i().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=dn,s=_i();if(an){if(t===void 0)throw Error(Ae(407));t=t()}else{if(t=e(),rr===null)throw Error(Ae(349));rl&30||F_(r,e,t)}s.memoizedState=t;var i={value:t,getSnapshot:e};return s.queue=i,LS(P_.bind(null,r,i,n),[n]),r.flags|=2048,zh(9,L_.bind(null,r,i,t,e),void 0,null),t},useId:function(){var n=_i(),e=rr.identifierPrefix;if(an){var t=lo,r=ao;t=(r&~(1<<32-ci(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Mh++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=sB++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},uB={readContext:Gs,useCallback:j_,useContext:Gs,useEffect:fw,useImperativeHandle:G_,useInsertionEffect:U_,useLayoutEffect:V_,useMemo:H_,useReducer:Qv,useRef:z_,useState:function(){return Qv(Bh)},useDebugValue:pw,useDeferredValue:function(n){var e=js();return q_(e,Kn.memoizedState,n)},useTransition:function(){var n=Qv(Bh)[0],e=js().memoizedState;return[n,e]},useMutableSource:R_,useSyncExternalStore:O_,useId:K_,unstable_isNewReconciler:!1},cB={readContext:Gs,useCallback:j_,useContext:Gs,useEffect:fw,useImperativeHandle:G_,useInsertionEffect:U_,useLayoutEffect:V_,useMemo:H_,useReducer:Jv,useRef:z_,useState:function(){return Jv(Bh)},useDebugValue:pw,useDeferredValue:function(n){var e=js();return Kn===null?e.memoizedState=n:q_(e,Kn.memoizedState,n)},useTransition:function(){var n=Jv(Bh)[0],e=js().memoizedState;return[n,e]},useMutableSource:R_,useSyncExternalStore:O_,useId:K_,unstable_isNewReconciler:!1};function zu(n,e){try{var t="",r=e;do t+=MP(r),r=r.return;while(r);var s=t}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:s,digest:null}}function ey(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function wx(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var hB=typeof WeakMap=="function"?WeakMap:Map;function Q_(n,e,t){t=co(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){gm||(gm=!0,$x=r),wx(n,e)},t}function J_(n,e,t){t=co(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;t.payload=function(){return r(s)},t.callback=function(){wx(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){wx(n,e),typeof r!="function"&&(Jo===null?Jo=new Set([this]):Jo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function PS(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new hB;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(t)||(s.add(t),n=EB.bind(null,n,e,t),e.then(n,n))}function MS(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function BS(n,e,t,r,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=co(-1,1),e.tag=2,Qo(t,e,1))),t.lanes|=1),n)}var dB=So.ReactCurrentOwner,Yr=!1;function Rr(n,e,t,r){e.child=n===null?D_(e,null,t,r):Mu(e,n.child,t,r)}function zS(n,e,t,r,s){t=t.render;var i=e.ref;return Tu(e,s),r=hw(n,e,t,r,i,s),t=dw(),n!==null&&!Yr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,go(n,e,s)):(an&&t&&J1(e),e.flags|=1,Rr(n,e,r,s),e.child)}function US(n,e,t,r,s){if(n===null){var i=t.type;return typeof i=="function"&&!Cw(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,eN(n,e,i,r,s)):(n=Gp(t.type,null,r,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&s)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:Ah,t(o,r)&&n.ref===e.ref)return go(n,e,s)}return e.flags|=1,n=ta(i,r),n.ref=e.ref,n.return=e,e.child=n}function eN(n,e,t,r,s){if(n!==null){var i=n.memoizedProps;if(Ah(i,r)&&n.ref===e.ref)if(Yr=!1,e.pendingProps=r=i,(n.lanes&s)!==0)n.flags&131072&&(Yr=!0);else return e.lanes=n.lanes,go(n,e,s)}return bx(n,e,t,r,s)}function tN(n,e,t){var r=e.pendingProps,s=r.children,i=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qt(yu,ds),ds|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Qt(yu,ds),ds|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,Qt(yu,ds),ds|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,Qt(yu,ds),ds|=r;return Rr(n,e,s,t),e.child}function nN(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function bx(n,e,t,r,s){var i=es(t)?tl:Ir.current;return i=Lu(e,i),Tu(e,s),t=hw(n,e,t,r,i,s),r=dw(),n!==null&&!Yr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,go(n,e,s)):(an&&r&&J1(e),e.flags|=1,Rr(n,e,t,s),e.child)}function VS(n,e,t,r,s){if(es(t)){var i=!0;om(e)}else i=!1;if(Tu(e,s),e.stateNode===null)Up(n,e),N_(e,t,r),xx(e,t,r,s),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Gs(u):(u=es(t)?tl:Ir.current,u=Lu(e,u));var c=t.getDerivedStateFromProps,h=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&RS(e,o,r,u),Mo=!1;var d=e.memoizedState;o.state=d,hm(e,r,o,s),l=e.memoizedState,a!==r||d!==l||Jr.current||Mo?(typeof c=="function"&&(yx(e,t,c,r),l=e.memoizedState),(a=Mo||AS(e,t,a,r,d,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,T_(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:ri(e.type,a),o.props=u,h=e.pendingProps,d=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Gs(l):(l=es(t)?tl:Ir.current,l=Lu(e,l));var f=t.getDerivedStateFromProps;(c=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&RS(e,o,r,l),Mo=!1,d=e.memoizedState,o.state=d,hm(e,r,o,s);var p=e.memoizedState;a!==h||d!==p||Jr.current||Mo?(typeof f=="function"&&(yx(e,t,f,r),p=e.memoizedState),(u=Mo||AS(e,t,u,r,d,p,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),r=!1)}return Cx(n,e,t,r,i,s)}function Cx(n,e,t,r,s,i){nN(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&TS(e,t,!1),go(n,e,i);r=e.stateNode,dB.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=Mu(e,n.child,null,i),e.child=Mu(e,null,a,i)):Rr(n,e,a,i),e.memoizedState=r.state,s&&TS(e,t,!0),e.child}function rN(n){var e=n.stateNode;e.pendingContext?IS(n,e.pendingContext,e.pendingContext!==e.context):e.context&&IS(n,e.context,!1),aw(n,e.containerInfo)}function WS(n,e,t,r,s){return Pu(),tw(s),e.flags|=256,Rr(n,e,t,r),e.child}var Sx={dehydrated:null,treeContext:null,retryLane:0};function kx(n){return{baseLanes:n,cachePool:null,transitions:null}}function sN(n,e,t){var r=e.pendingProps,s=hn.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),Qt(hn,s&1),n===null)return gx(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=vg(o,r,0,null),n=Za(n,r,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=kx(t),e.memoizedState=Sx,n):mw(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return fB(n,e,o,r,a,s,t);if(i){i=r.fallback,o=e.mode,s=n.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ta(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=ta(a,i):(i=Za(i,o,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=n.child.memoizedState,o=o===null?kx(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=n.childLanes&~t,e.memoizedState=Sx,r}return i=n.child,n=i.sibling,r=ta(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function mw(n,e){return e=vg({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function up(n,e,t,r){return r!==null&&tw(r),Mu(e,n.child,null,t),n=mw(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function fB(n,e,t,r,s,i,o){if(t)return e.flags&256?(e.flags&=-257,r=ey(Error(Ae(422))),up(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=vg({mode:"visible",children:r.children},s,0,null),i=Za(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Mu(e,n.child,null,o),e.child.memoizedState=kx(o),e.memoizedState=Sx,i);if(!(e.mode&1))return up(n,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(Ae(419)),r=ey(i,r,void 0),up(n,e,o,r)}if(a=(o&n.childLanes)!==0,Yr||a){if(r=rr,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,mo(n,s),hi(r,n,s,-1))}return bw(),r=ey(Error(Ae(421))),up(n,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=IB.bind(null,n),s._reactRetry=e,null):(n=i.treeContext,ps=Zo(s.nextSibling),gs=e,an=!0,oi=null,n!==null&&(Os[Fs++]=ao,Os[Fs++]=lo,Os[Fs++]=nl,ao=n.id,lo=n.overflow,nl=e),e=mw(e,r.children),e.flags|=4096,e)}function GS(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),vx(n.return,e,t)}function ty(n,e,t,r,s){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=s)}function iN(n,e,t){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Rr(n,e,r.children,t),r=hn.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&GS(n,t,e);else if(n.tag===19)GS(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Qt(hn,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&dm(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),ty(e,!1,s,t,i);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&dm(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}ty(e,!0,t,null,i);break;case"together":ty(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Up(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function go(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),sl|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(Ae(153));if(e.child!==null){for(n=e.child,t=ta(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=ta(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function pB(n,e,t){switch(e.tag){case 3:rN(e),Pu();break;case 5:A_(e);break;case 1:es(e.type)&&om(e);break;case 4:aw(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Qt(um,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Qt(hn,hn.current&1),e.flags|=128,null):t&e.child.childLanes?sN(n,e,t):(Qt(hn,hn.current&1),n=go(n,e,t),n!==null?n.sibling:null);Qt(hn,hn.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return iN(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Qt(hn,hn.current),r)break;return null;case 22:case 23:return e.lanes=0,tN(n,e,t)}return go(n,e,t)}var oN,Ex,aN,lN;oN=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Ex=function(){};aN=function(n,e,t,r){var s=n.memoizedProps;if(s!==r){n=e.stateNode,ja(Bi.current);var i=null;switch(t){case"input":s=qy(n,s),r=qy(n,r),i=[];break;case"select":s=fn({},s,{value:void 0}),r=fn({},r,{value:void 0}),i=[];break;case"textarea":s=Yy(n,s),r=Yy(n,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=sm)}Qy(t,r);var o;t=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Eh.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var l=r[u];if(a=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(i||(i=[]),i.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Eh.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&nn("scroll",n),i||a===l||(i=[])):(i=i||[]).push(u,l))}t&&(i=i||[]).push("style",t);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};lN=function(n,e,t,r){t!==r&&(e.flags|=4)};function Lc(n,e){if(!an)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function wr(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function mB(n,e,t){var r=e.pendingProps;switch(ew(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wr(e),null;case 1:return es(e.type)&&im(),wr(e),null;case 3:return r=e.stateNode,Bu(),rn(Jr),rn(Ir),uw(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(ap(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,oi!==null&&(Rx(oi),oi=null))),Ex(n,e),wr(e),null;case 5:lw(e);var s=ja(Ph.current);if(t=e.type,n!==null&&e.stateNode!=null)aN(n,e,t,r,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Ae(166));return wr(e),null}if(n=ja(Bi.current),ap(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[Oi]=e,r[Fh]=i,n=(e.mode&1)!==0,t){case"dialog":nn("cancel",r),nn("close",r);break;case"iframe":case"object":case"embed":nn("load",r);break;case"video":case"audio":for(s=0;s<rh.length;s++)nn(rh[s],r);break;case"source":nn("error",r);break;case"img":case"image":case"link":nn("error",r),nn("load",r);break;case"details":nn("toggle",r);break;case"input":JC(r,i),nn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},nn("invalid",r);break;case"textarea":tS(r,i),nn("invalid",r)}Qy(t,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&op(r.textContent,a,n),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&op(r.textContent,a,n),s=["children",""+a]):Eh.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&nn("scroll",r)}switch(t){case"input":Qf(r),eS(r,i,!0);break;case"textarea":Qf(r),nS(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=sm)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=FT(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Oi]=e,n[Fh]=r,oN(n,e,!1,!1),e.stateNode=n;e:{switch(o=Jy(t,r),t){case"dialog":nn("cancel",n),nn("close",n),s=r;break;case"iframe":case"object":case"embed":nn("load",n),s=r;break;case"video":case"audio":for(s=0;s<rh.length;s++)nn(rh[s],n);s=r;break;case"source":nn("error",n),s=r;break;case"img":case"image":case"link":nn("error",n),nn("load",n),s=r;break;case"details":nn("toggle",n),s=r;break;case"input":JC(n,r),s=qy(n,r),nn("invalid",n);break;case"option":s=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},s=fn({},r,{value:void 0}),nn("invalid",n);break;case"textarea":tS(n,r),s=Yy(n,r),nn("invalid",n);break;default:s=r}Qy(t,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?MT(n,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&LT(n,l)):i==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Ih(n,l):typeof l=="number"&&Ih(n,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Eh.hasOwnProperty(i)?l!=null&&i==="onScroll"&&nn("scroll",n):l!=null&&B1(n,i,l,o))}switch(t){case"input":Qf(n),eS(n,r,!1);break;case"textarea":Qf(n),nS(n);break;case"option":r.value!=null&&n.setAttribute("value",""+aa(r.value));break;case"select":n.multiple=!!r.multiple,i=r.value,i!=null?Su(n,!!r.multiple,i,!1):r.defaultValue!=null&&Su(n,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=sm)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return wr(e),null;case 6:if(n&&e.stateNode!=null)lN(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Ae(166));if(t=ja(Ph.current),ja(Bi.current),ap(e)){if(r=e.stateNode,t=e.memoizedProps,r[Oi]=e,(i=r.nodeValue!==t)&&(n=gs,n!==null))switch(n.tag){case 3:op(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&op(r.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Oi]=e,e.stateNode=r}return wr(e),null;case 13:if(rn(hn),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(an&&ps!==null&&e.mode&1&&!(e.flags&128))E_(),Pu(),e.flags|=98560,i=!1;else if(i=ap(e),r!==null&&r.dehydrated!==null){if(n===null){if(!i)throw Error(Ae(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ae(317));i[Oi]=e}else Pu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;wr(e),i=!1}else oi!==null&&(Rx(oi),oi=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||hn.current&1?Zn===0&&(Zn=3):bw())),e.updateQueue!==null&&(e.flags|=4),wr(e),null);case 4:return Bu(),Ex(n,e),n===null&&Rh(e.stateNode.containerInfo),wr(e),null;case 10:return sw(e.type._context),wr(e),null;case 17:return es(e.type)&&im(),wr(e),null;case 19:if(rn(hn),i=e.memoizedState,i===null)return wr(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Lc(i,!1);else{if(Zn!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=dm(n),o!==null){for(e.flags|=128,Lc(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,n=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Qt(hn,hn.current&1|2),e.child}n=n.sibling}i.tail!==null&&Nn()>Uu&&(e.flags|=128,r=!0,Lc(i,!1),e.lanes=4194304)}else{if(!r)if(n=dm(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Lc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!an)return wr(e),null}else 2*Nn()-i.renderingStartTime>Uu&&t!==1073741824&&(e.flags|=128,r=!0,Lc(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Nn(),e.sibling=null,t=hn.current,Qt(hn,r?t&1|2:t&1),e):(wr(e),null);case 22:case 23:return ww(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ds&1073741824&&(wr(e),e.subtreeFlags&6&&(e.flags|=8192)):wr(e),null;case 24:return null;case 25:return null}throw Error(Ae(156,e.tag))}function gB(n,e){switch(ew(e),e.tag){case 1:return es(e.type)&&im(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Bu(),rn(Jr),rn(Ir),uw(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return lw(e),null;case 13:if(rn(hn),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(Ae(340));Pu()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return rn(hn),null;case 4:return Bu(),null;case 10:return sw(e.type._context),null;case 22:case 23:return ww(),null;case 24:return null;default:return null}}var cp=!1,Cr=!1,vB=typeof WeakSet=="function"?WeakSet:Set,He=null;function vu(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){pn(n,e,r)}else t.current=null}function Ix(n,e,t){try{t()}catch(r){pn(n,e,r)}}var jS=!1;function yB(n,e){if(ux=tm,n=d_(),Q1(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,u=0,c=0,h=n,d=null;t:for(;;){for(var f;h!==t||s!==0&&h.nodeType!==3||(a=o+s),h!==i||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===n)break t;if(d===t&&++u===s&&(a=o),d===i&&++c===r&&(l=o),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(cx={focusedElem:n,selectionRange:t},tm=!1,He=e;He!==null;)if(e=He,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,He=n;else for(;He!==null;){e=He;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var v=p.memoizedProps,g=p.memoizedState,m=e.stateNode,y=m.getSnapshotBeforeUpdate(e.elementType===e.type?v:ri(e.type,v),g);m.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ae(163))}}catch(x){pn(e,e.return,x)}if(n=e.sibling,n!==null){n.return=e.return,He=n;break}He=e.return}return p=jS,jS=!1,p}function gh(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var i=s.destroy;s.destroy=void 0,i!==void 0&&Ix(e,t,i)}s=s.next}while(s!==r)}}function mg(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Tx(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function uN(n){var e=n.alternate;e!==null&&(n.alternate=null,uN(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Oi],delete e[Fh],delete e[fx],delete e[eB],delete e[tB])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function cN(n){return n.tag===5||n.tag===3||n.tag===4}function HS(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||cN(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function _x(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=sm));else if(r!==4&&(n=n.child,n!==null))for(_x(n,e,t),n=n.sibling;n!==null;)_x(n,e,t),n=n.sibling}function Nx(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(Nx(n,e,t),n=n.sibling;n!==null;)Nx(n,e,t),n=n.sibling}var hr=null,si=!1;function $o(n,e,t){for(t=t.child;t!==null;)hN(n,e,t),t=t.sibling}function hN(n,e,t){if(Mi&&typeof Mi.onCommitFiberUnmount=="function")try{Mi.onCommitFiberUnmount(ag,t)}catch{}switch(t.tag){case 5:Cr||vu(t,e);case 6:var r=hr,s=si;hr=null,$o(n,e,t),hr=r,si=s,hr!==null&&(si?(n=hr,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):hr.removeChild(t.stateNode));break;case 18:hr!==null&&(si?(n=hr,t=t.stateNode,n.nodeType===8?Kv(n.parentNode,t):n.nodeType===1&&Kv(n,t),$h(n)):Kv(hr,t.stateNode));break;case 4:r=hr,s=si,hr=t.stateNode.containerInfo,si=!0,$o(n,e,t),hr=r,si=s;break;case 0:case 11:case 14:case 15:if(!Cr&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Ix(t,e,o),s=s.next}while(s!==r)}$o(n,e,t);break;case 1:if(!Cr&&(vu(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){pn(t,e,a)}$o(n,e,t);break;case 21:$o(n,e,t);break;case 22:t.mode&1?(Cr=(r=Cr)||t.memoizedState!==null,$o(n,e,t),Cr=r):$o(n,e,t);break;default:$o(n,e,t)}}function qS(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new vB),e.forEach(function(r){var s=TB.bind(null,n,r);t.has(r)||(t.add(r),r.then(s,s))})}}function Zs(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r];try{var i=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:hr=a.stateNode,si=!1;break e;case 3:hr=a.stateNode.containerInfo,si=!0;break e;case 4:hr=a.stateNode.containerInfo,si=!0;break e}a=a.return}if(hr===null)throw Error(Ae(160));hN(i,o,s),hr=null,si=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){pn(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dN(e,n),e=e.sibling}function dN(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Zs(e,n),Ii(n),r&4){try{gh(3,n,n.return),mg(3,n)}catch(v){pn(n,n.return,v)}try{gh(5,n,n.return)}catch(v){pn(n,n.return,v)}}break;case 1:Zs(e,n),Ii(n),r&512&&t!==null&&vu(t,t.return);break;case 5:if(Zs(e,n),Ii(n),r&512&&t!==null&&vu(t,t.return),n.flags&32){var s=n.stateNode;try{Ih(s,"")}catch(v){pn(n,n.return,v)}}if(r&4&&(s=n.stateNode,s!=null)){var i=n.memoizedProps,o=t!==null?t.memoizedProps:i,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&RT(s,i),Jy(a,o);var u=Jy(a,i);for(o=0;o<l.length;o+=2){var c=l[o],h=l[o+1];c==="style"?MT(s,h):c==="dangerouslySetInnerHTML"?LT(s,h):c==="children"?Ih(s,h):B1(s,c,h,u)}switch(a){case"input":Ky(s,i);break;case"textarea":OT(s,i);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Su(s,!!i.multiple,f,!1):d!==!!i.multiple&&(i.defaultValue!=null?Su(s,!!i.multiple,i.defaultValue,!0):Su(s,!!i.multiple,i.multiple?[]:"",!1))}s[Fh]=i}catch(v){pn(n,n.return,v)}}break;case 6:if(Zs(e,n),Ii(n),r&4){if(n.stateNode===null)throw Error(Ae(162));s=n.stateNode,i=n.memoizedProps;try{s.nodeValue=i}catch(v){pn(n,n.return,v)}}break;case 3:if(Zs(e,n),Ii(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{$h(e.containerInfo)}catch(v){pn(n,n.return,v)}break;case 4:Zs(e,n),Ii(n);break;case 13:Zs(e,n),Ii(n),s=n.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(yw=Nn())),r&4&&qS(n);break;case 22:if(c=t!==null&&t.memoizedState!==null,n.mode&1?(Cr=(u=Cr)||c,Zs(e,n),Cr=u):Zs(e,n),Ii(n),r&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!c&&n.mode&1)for(He=n,c=n.child;c!==null;){for(h=He=c;He!==null;){switch(d=He,f=d.child,d.tag){case 0:case 11:case 14:case 15:gh(4,d,d.return);break;case 1:vu(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){r=d,t=d.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(v){pn(r,t,v)}}break;case 5:vu(d,d.return);break;case 22:if(d.memoizedState!==null){XS(h);continue}}f!==null?(f.return=d,He=f):XS(h)}c=c.sibling}e:for(c=null,h=n;;){if(h.tag===5){if(c===null){c=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=PT("display",o))}catch(v){pn(n,n.return,v)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(v){pn(n,n.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Zs(e,n),Ii(n),r&4&&qS(n);break;case 21:break;default:Zs(e,n),Ii(n)}}function Ii(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(cN(t)){var r=t;break e}t=t.return}throw Error(Ae(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Ih(s,""),r.flags&=-33);var i=HS(n);Nx(n,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=HS(n);_x(n,a,o);break;default:throw Error(Ae(161))}}catch(l){pn(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function xB(n,e,t){He=n,fN(n)}function fN(n,e,t){for(var r=(n.mode&1)!==0;He!==null;){var s=He,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||cp;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Cr;a=cp;var u=Cr;if(cp=o,(Cr=l)&&!u)for(He=s;He!==null;)o=He,l=o.child,o.tag===22&&o.memoizedState!==null?YS(s):l!==null?(l.return=o,He=l):YS(s);for(;i!==null;)He=i,fN(i),i=i.sibling;He=s,cp=a,Cr=u}KS(n)}else s.subtreeFlags&8772&&i!==null?(i.return=s,He=i):KS(n)}}function KS(n){for(;He!==null;){var e=He;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Cr||mg(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Cr)if(t===null)r.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:ri(e.type,t.memoizedProps);r.componentDidUpdate(s,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&DS(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}DS(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&$h(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ae(163))}Cr||e.flags&512&&Tx(e)}catch(d){pn(e,e.return,d)}}if(e===n){He=null;break}if(t=e.sibling,t!==null){t.return=e.return,He=t;break}He=e.return}}function XS(n){for(;He!==null;){var e=He;if(e===n){He=null;break}var t=e.sibling;if(t!==null){t.return=e.return,He=t;break}He=e.return}}function YS(n){for(;He!==null;){var e=He;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{mg(4,e)}catch(l){pn(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){pn(e,s,l)}}var i=e.return;try{Tx(e)}catch(l){pn(e,i,l)}break;case 5:var o=e.return;try{Tx(e)}catch(l){pn(e,o,l)}}}catch(l){pn(e,e.return,l)}if(e===n){He=null;break}var a=e.sibling;if(a!==null){a.return=e.return,He=a;break}He=e.return}}var wB=Math.ceil,mm=So.ReactCurrentDispatcher,gw=So.ReactCurrentOwner,Ws=So.ReactCurrentBatchConfig,It=0,rr=null,Bn=null,dr=0,ds=0,yu=ya(0),Zn=0,Uh=null,sl=0,gg=0,vw=0,vh=null,qr=null,yw=0,Uu=1/0,ro=null,gm=!1,$x=null,Jo=null,hp=!1,Wo=null,vm=0,yh=0,Dx=null,Vp=-1,Wp=0;function Pr(){return It&6?Nn():Vp!==-1?Vp:Vp=Nn()}function ea(n){return n.mode&1?It&2&&dr!==0?dr&-dr:rB.transition!==null?(Wp===0&&(Wp=YT()),Wp):(n=Bt,n!==0||(n=window.event,n=n===void 0?16:r_(n.type)),n):1}function hi(n,e,t,r){if(50<yh)throw yh=0,Dx=null,Error(Ae(185));ad(n,t,r),(!(It&2)||n!==rr)&&(n===rr&&(!(It&2)&&(gg|=t),Zn===4&&Uo(n,dr)),ts(n,r),t===1&&It===0&&!(e.mode&1)&&(Uu=Nn()+500,dg&&xa()))}function ts(n,e){var t=n.callbackNode;rM(n,e);var r=em(n,n===rr?dr:0);if(r===0)t!==null&&iS(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&iS(t),e===1)n.tag===0?nB(ZS.bind(null,n)):C_(ZS.bind(null,n)),QM(function(){!(It&6)&&xa()}),t=null;else{switch(ZT(r)){case 1:t=G1;break;case 4:t=KT;break;case 16:t=Jp;break;case 536870912:t=XT;break;default:t=Jp}t=bN(t,pN.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function pN(n,e){if(Vp=-1,Wp=0,It&6)throw Error(Ae(327));var t=n.callbackNode;if(_u()&&n.callbackNode!==t)return null;var r=em(n,n===rr?dr:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=ym(n,r);else{e=r;var s=It;It|=2;var i=gN();(rr!==n||dr!==e)&&(ro=null,Uu=Nn()+500,Ya(n,e));do try{SB();break}catch(a){mN(n,a)}while(1);rw(),mm.current=i,It=s,Bn!==null?e=0:(rr=null,dr=0,e=Zn)}if(e!==0){if(e===2&&(s=sx(n),s!==0&&(r=s,e=Ax(n,s))),e===1)throw t=Uh,Ya(n,0),Uo(n,r),ts(n,Nn()),t;if(e===6)Uo(n,r);else{if(s=n.current.alternate,!(r&30)&&!bB(s)&&(e=ym(n,r),e===2&&(i=sx(n),i!==0&&(r=i,e=Ax(n,i))),e===1))throw t=Uh,Ya(n,0),Uo(n,r),ts(n,Nn()),t;switch(n.finishedWork=s,n.finishedLanes=r,e){case 0:case 1:throw Error(Ae(345));case 2:Pa(n,qr,ro);break;case 3:if(Uo(n,r),(r&130023424)===r&&(e=yw+500-Nn(),10<e)){if(em(n,0)!==0)break;if(s=n.suspendedLanes,(s&r)!==r){Pr(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=dx(Pa.bind(null,n,qr,ro),e);break}Pa(n,qr,ro);break;case 4:if(Uo(n,r),(r&4194240)===r)break;for(e=n.eventTimes,s=-1;0<r;){var o=31-ci(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Nn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*wB(r/1960))-r,10<r){n.timeoutHandle=dx(Pa.bind(null,n,qr,ro),r);break}Pa(n,qr,ro);break;case 5:Pa(n,qr,ro);break;default:throw Error(Ae(329))}}}return ts(n,Nn()),n.callbackNode===t?pN.bind(null,n):null}function Ax(n,e){var t=vh;return n.current.memoizedState.isDehydrated&&(Ya(n,e).flags|=256),n=ym(n,e),n!==2&&(e=qr,qr=t,e!==null&&Rx(e)),n}function Rx(n){qr===null?qr=n:qr.push.apply(qr,n)}function bB(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var s=t[r],i=s.getSnapshot;s=s.value;try{if(!gi(i(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Uo(n,e){for(e&=~vw,e&=~gg,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-ci(e),r=1<<t;n[t]=-1,e&=~r}}function ZS(n){if(It&6)throw Error(Ae(327));_u();var e=em(n,0);if(!(e&1))return ts(n,Nn()),null;var t=ym(n,e);if(n.tag!==0&&t===2){var r=sx(n);r!==0&&(e=r,t=Ax(n,r))}if(t===1)throw t=Uh,Ya(n,0),Uo(n,e),ts(n,Nn()),t;if(t===6)throw Error(Ae(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Pa(n,qr,ro),ts(n,Nn()),null}function xw(n,e){var t=It;It|=1;try{return n(e)}finally{It=t,It===0&&(Uu=Nn()+500,dg&&xa())}}function il(n){Wo!==null&&Wo.tag===0&&!(It&6)&&_u();var e=It;It|=1;var t=Ws.transition,r=Bt;try{if(Ws.transition=null,Bt=1,n)return n()}finally{Bt=r,Ws.transition=t,It=e,!(It&6)&&xa()}}function ww(){ds=yu.current,rn(yu)}function Ya(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,ZM(t)),Bn!==null)for(t=Bn.return;t!==null;){var r=t;switch(ew(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&im();break;case 3:Bu(),rn(Jr),rn(Ir),uw();break;case 5:lw(r);break;case 4:Bu();break;case 13:rn(hn);break;case 19:rn(hn);break;case 10:sw(r.type._context);break;case 22:case 23:ww()}t=t.return}if(rr=n,Bn=n=ta(n.current,null),dr=ds=e,Zn=0,Uh=null,vw=gg=sl=0,qr=vh=null,Ga!==null){for(e=0;e<Ga.length;e++)if(t=Ga[e],r=t.interleaved,r!==null){t.interleaved=null;var s=r.next,i=t.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}t.pending=r}Ga=null}return n}function mN(n,e){do{var t=Bn;try{if(rw(),Bp.current=pm,fm){for(var r=dn.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}fm=!1}if(rl=0,tr=Kn=dn=null,mh=!1,Mh=0,gw.current=null,t===null||t.return===null){Zn=1,Uh=e,Bn=null;break}e:{var i=n,o=t.return,a=t,l=e;if(e=dr,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=MS(o);if(f!==null){f.flags&=-257,BS(f,o,a,i,e),f.mode&1&&PS(i,u,e),e=f,l=u;var p=e.updateQueue;if(p===null){var v=new Set;v.add(l),e.updateQueue=v}else p.add(l);break e}else{if(!(e&1)){PS(i,u,e),bw();break e}l=Error(Ae(426))}}else if(an&&a.mode&1){var g=MS(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),BS(g,o,a,i,e),tw(zu(l,a));break e}}i=l=zu(l,a),Zn!==4&&(Zn=2),vh===null?vh=[i]:vh.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var m=Q_(i,l,e);$S(i,m);break e;case 1:a=l;var y=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Jo===null||!Jo.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var x=J_(i,a,e);$S(i,x);break e}}i=i.return}while(i!==null)}yN(t)}catch(b){e=b,Bn===t&&t!==null&&(Bn=t=t.return);continue}break}while(1)}function gN(){var n=mm.current;return mm.current=pm,n===null?pm:n}function bw(){(Zn===0||Zn===3||Zn===2)&&(Zn=4),rr===null||!(sl&268435455)&&!(gg&268435455)||Uo(rr,dr)}function ym(n,e){var t=It;It|=2;var r=gN();(rr!==n||dr!==e)&&(ro=null,Ya(n,e));do try{CB();break}catch(s){mN(n,s)}while(1);if(rw(),It=t,mm.current=r,Bn!==null)throw Error(Ae(261));return rr=null,dr=0,Zn}function CB(){for(;Bn!==null;)vN(Bn)}function SB(){for(;Bn!==null&&!KP();)vN(Bn)}function vN(n){var e=wN(n.alternate,n,ds);n.memoizedProps=n.pendingProps,e===null?yN(n):Bn=e,gw.current=null}function yN(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=gB(t,e),t!==null){t.flags&=32767,Bn=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Zn=6,Bn=null;return}}else if(t=mB(t,e,ds),t!==null){Bn=t;return}if(e=e.sibling,e!==null){Bn=e;return}Bn=e=n}while(e!==null);Zn===0&&(Zn=5)}function Pa(n,e,t){var r=Bt,s=Ws.transition;try{Ws.transition=null,Bt=1,kB(n,e,t,r)}finally{Ws.transition=s,Bt=r}return null}function kB(n,e,t,r){do _u();while(Wo!==null);if(It&6)throw Error(Ae(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(Ae(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(sM(n,i),n===rr&&(Bn=rr=null,dr=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||hp||(hp=!0,bN(Jp,function(){return _u(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=Ws.transition,Ws.transition=null;var o=Bt;Bt=1;var a=It;It|=4,gw.current=null,yB(n,t),dN(t,n),GM(cx),tm=!!ux,cx=ux=null,n.current=t,xB(t),XP(),It=a,Bt=o,Ws.transition=i}else n.current=t;if(hp&&(hp=!1,Wo=n,vm=s),i=n.pendingLanes,i===0&&(Jo=null),QP(t.stateNode),ts(n,Nn()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],r(s.value,{componentStack:s.stack,digest:s.digest});if(gm)throw gm=!1,n=$x,$x=null,n;return vm&1&&n.tag!==0&&_u(),i=n.pendingLanes,i&1?n===Dx?yh++:(yh=0,Dx=n):yh=0,xa(),null}function _u(){if(Wo!==null){var n=ZT(vm),e=Ws.transition,t=Bt;try{if(Ws.transition=null,Bt=16>n?16:n,Wo===null)var r=!1;else{if(n=Wo,Wo=null,vm=0,It&6)throw Error(Ae(331));var s=It;for(It|=4,He=n.current;He!==null;){var i=He,o=i.child;if(He.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(He=u;He!==null;){var c=He;switch(c.tag){case 0:case 11:case 15:gh(8,c,i)}var h=c.child;if(h!==null)h.return=c,He=h;else for(;He!==null;){c=He;var d=c.sibling,f=c.return;if(uN(c),c===u){He=null;break}if(d!==null){d.return=f,He=d;break}He=f}}}var p=i.alternate;if(p!==null){var v=p.child;if(v!==null){p.child=null;do{var g=v.sibling;v.sibling=null,v=g}while(v!==null)}}He=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,He=o;else e:for(;He!==null;){if(i=He,i.flags&2048)switch(i.tag){case 0:case 11:case 15:gh(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,He=m;break e}He=i.return}}var y=n.current;for(He=y;He!==null;){o=He;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,He=w;else e:for(o=y;He!==null;){if(a=He,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:mg(9,a)}}catch(b){pn(a,a.return,b)}if(a===o){He=null;break e}var x=a.sibling;if(x!==null){x.return=a.return,He=x;break e}He=a.return}}if(It=s,xa(),Mi&&typeof Mi.onPostCommitFiberRoot=="function")try{Mi.onPostCommitFiberRoot(ag,n)}catch{}r=!0}return r}finally{Bt=t,Ws.transition=e}}return!1}function QS(n,e,t){e=zu(t,e),e=Q_(n,e,1),n=Qo(n,e,1),e=Pr(),n!==null&&(ad(n,1,e),ts(n,e))}function pn(n,e,t){if(n.tag===3)QS(n,n,t);else for(;e!==null;){if(e.tag===3){QS(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Jo===null||!Jo.has(r))){n=zu(t,n),n=J_(e,n,1),e=Qo(e,n,1),n=Pr(),e!==null&&(ad(e,1,n),ts(e,n));break}}e=e.return}}function EB(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Pr(),n.pingedLanes|=n.suspendedLanes&t,rr===n&&(dr&t)===t&&(Zn===4||Zn===3&&(dr&130023424)===dr&&500>Nn()-yw?Ya(n,0):vw|=t),ts(n,e)}function xN(n,e){e===0&&(n.mode&1?(e=tp,tp<<=1,!(tp&130023424)&&(tp=4194304)):e=1);var t=Pr();n=mo(n,e),n!==null&&(ad(n,e,t),ts(n,t))}function IB(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),xN(n,t)}function TB(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(Ae(314))}r!==null&&r.delete(e),xN(n,t)}var wN;wN=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Jr.current)Yr=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Yr=!1,pB(n,e,t);Yr=!!(n.flags&131072)}else Yr=!1,an&&e.flags&1048576&&S_(e,lm,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Up(n,e),n=e.pendingProps;var s=Lu(e,Ir.current);Tu(e,t),s=hw(null,e,r,n,s,t);var i=dw();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,es(r)?(i=!0,om(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,ow(e),s.updater=fg,e.stateNode=s,s._reactInternals=e,xx(e,r,n,t),e=Cx(null,e,r,!0,i,t)):(e.tag=0,an&&i&&J1(e),Rr(null,e,s,t),e=e.child),e;case 16:r=e.elementType;e:{switch(Up(n,e),n=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=NB(r),n=ri(r,n),s){case 0:e=bx(null,e,r,n,t);break e;case 1:e=VS(null,e,r,n,t);break e;case 11:e=zS(null,e,r,n,t);break e;case 14:e=US(null,e,r,ri(r.type,n),t);break e}throw Error(Ae(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ri(r,s),bx(n,e,r,s,t);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ri(r,s),VS(n,e,r,s,t);case 3:e:{if(rN(e),n===null)throw Error(Ae(387));r=e.pendingProps,i=e.memoizedState,s=i.element,T_(n,e),hm(e,r,null,t);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=zu(Error(Ae(423)),e),e=WS(n,e,r,t,s);break e}else if(r!==s){s=zu(Error(Ae(424)),e),e=WS(n,e,r,t,s);break e}else for(ps=Zo(e.stateNode.containerInfo.firstChild),gs=e,an=!0,oi=null,t=D_(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Pu(),r===s){e=go(n,e,t);break e}Rr(n,e,r,t)}e=e.child}return e;case 5:return A_(e),n===null&&gx(e),r=e.type,s=e.pendingProps,i=n!==null?n.memoizedProps:null,o=s.children,hx(r,s)?o=null:i!==null&&hx(r,i)&&(e.flags|=32),nN(n,e),Rr(n,e,o,t),e.child;case 6:return n===null&&gx(e),null;case 13:return sN(n,e,t);case 4:return aw(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Mu(e,null,r,t):Rr(n,e,r,t),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ri(r,s),zS(n,e,r,s,t);case 7:return Rr(n,e,e.pendingProps,t),e.child;case 8:return Rr(n,e,e.pendingProps.children,t),e.child;case 12:return Rr(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Qt(um,r._currentValue),r._currentValue=o,i!==null)if(gi(i.value,o)){if(i.children===s.children&&!Jr.current){e=go(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=co(-1,t&-t),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),vx(i.return,t,e),a.lanes|=t;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Ae(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),vx(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Rr(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Tu(e,t),s=Gs(s),r=r(s),e.flags|=1,Rr(n,e,r,t),e.child;case 14:return r=e.type,s=ri(r,e.pendingProps),s=ri(r.type,s),US(n,e,r,s,t);case 15:return eN(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ri(r,s),Up(n,e),e.tag=1,es(r)?(n=!0,om(e)):n=!1,Tu(e,t),N_(e,r,s),xx(e,r,s,t),Cx(null,e,r,!0,n,t);case 19:return iN(n,e,t);case 22:return tN(n,e,t)}throw Error(Ae(156,e.tag))};function bN(n,e){return qT(n,e)}function _B(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ps(n,e,t,r){return new _B(n,e,t,r)}function Cw(n){return n=n.prototype,!(!n||!n.isReactComponent)}function NB(n){if(typeof n=="function")return Cw(n)?1:0;if(n!=null){if(n=n.$$typeof,n===U1)return 11;if(n===V1)return 14}return 2}function ta(n,e){var t=n.alternate;return t===null?(t=Ps(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Gp(n,e,t,r,s,i){var o=2;if(r=n,typeof n=="function")Cw(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case lu:return Za(t.children,s,i,e);case z1:o=8,s|=8;break;case Wy:return n=Ps(12,t,e,s|2),n.elementType=Wy,n.lanes=i,n;case Gy:return n=Ps(13,t,e,s),n.elementType=Gy,n.lanes=i,n;case jy:return n=Ps(19,t,e,s),n.elementType=jy,n.lanes=i,n;case $T:return vg(t,s,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case _T:o=10;break e;case NT:o=9;break e;case U1:o=11;break e;case V1:o=14;break e;case Po:o=16,r=null;break e}throw Error(Ae(130,n==null?n:typeof n,""))}return e=Ps(o,t,e,s),e.elementType=n,e.type=r,e.lanes=i,e}function Za(n,e,t,r){return n=Ps(7,n,r,e),n.lanes=t,n}function vg(n,e,t,r){return n=Ps(22,n,r,e),n.elementType=$T,n.lanes=t,n.stateNode={isHidden:!1},n}function ny(n,e,t){return n=Ps(6,n,null,e),n.lanes=t,n}function ry(n,e,t){return e=Ps(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function $B(n,e,t,r,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Pv(0),this.expirationTimes=Pv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pv(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Sw(n,e,t,r,s,i,o,a,l){return n=new $B(n,e,t,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Ps(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},ow(i),n}function DB(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:au,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function CN(n){if(!n)return la;n=n._reactInternals;e:{if(El(n)!==n||n.tag!==1)throw Error(Ae(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(es(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ae(171))}if(n.tag===1){var t=n.type;if(es(t))return b_(n,t,e)}return e}function SN(n,e,t,r,s,i,o,a,l){return n=Sw(t,r,!0,n,s,i,o,a,l),n.context=CN(null),t=n.current,r=Pr(),s=ea(t),i=co(r,s),i.callback=e??null,Qo(t,i,s),n.current.lanes=s,ad(n,s,r),ts(n,r),n}function yg(n,e,t,r){var s=e.current,i=Pr(),o=ea(s);return t=CN(t),e.context===null?e.context=t:e.pendingContext=t,e=co(i,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Qo(s,e,o),n!==null&&(hi(n,s,o,i),Mp(n,s,o)),o}function xm(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function JS(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function kw(n,e){JS(n,e),(n=n.alternate)&&JS(n,e)}function AB(){return null}var kN=typeof reportError=="function"?reportError:function(n){console.error(n)};function Ew(n){this._internalRoot=n}xg.prototype.render=Ew.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(Ae(409));yg(n,e,null,null)};xg.prototype.unmount=Ew.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;il(function(){yg(null,n,null,null)}),e[po]=null}};function xg(n){this._internalRoot=n}xg.prototype.unstable_scheduleHydration=function(n){if(n){var e=e_();n={blockedOn:null,target:n,priority:e};for(var t=0;t<zo.length&&e!==0&&e<zo[t].priority;t++);zo.splice(t,0,n),t===0&&n_(n)}};function Iw(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function wg(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function ek(){}function RB(n,e,t,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=xm(o);i.call(u)}}var o=SN(e,r,n,0,null,!1,!1,"",ek);return n._reactRootContainer=o,n[po]=o.current,Rh(n.nodeType===8?n.parentNode:n),il(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var u=xm(l);a.call(u)}}var l=Sw(n,0,!1,null,null,!1,!1,"",ek);return n._reactRootContainer=l,n[po]=l.current,Rh(n.nodeType===8?n.parentNode:n),il(function(){yg(e,l,t,r)}),l}function bg(n,e,t,r,s){var i=t._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=xm(o);a.call(l)}}yg(e,o,n,s)}else o=RB(t,e,n,s,r);return xm(o)}QT=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=nh(e.pendingLanes);t!==0&&(j1(e,t|1),ts(e,Nn()),!(It&6)&&(Uu=Nn()+500,xa()))}break;case 13:il(function(){var r=mo(n,1);if(r!==null){var s=Pr();hi(r,n,1,s)}}),kw(n,1)}};H1=function(n){if(n.tag===13){var e=mo(n,134217728);if(e!==null){var t=Pr();hi(e,n,134217728,t)}kw(n,134217728)}};JT=function(n){if(n.tag===13){var e=ea(n),t=mo(n,e);if(t!==null){var r=Pr();hi(t,n,e,r)}kw(n,e)}};e_=function(){return Bt};t_=function(n,e){var t=Bt;try{return Bt=n,e()}finally{Bt=t}};tx=function(n,e,t){switch(e){case"input":if(Ky(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var s=hg(r);if(!s)throw Error(Ae(90));AT(r),Ky(r,s)}}}break;case"textarea":OT(n,t);break;case"select":e=t.value,e!=null&&Su(n,!!t.multiple,e,!1)}};UT=xw;VT=il;var OB={usingClientEntryPoint:!1,Events:[ud,du,hg,BT,zT,xw]},Pc={findFiberByHostInstance:Wa,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},FB={bundleType:Pc.bundleType,version:Pc.version,rendererPackageName:Pc.rendererPackageName,rendererConfig:Pc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:So.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=jT(n),n===null?null:n.stateNode},findFiberByHostInstance:Pc.findFiberByHostInstance||AB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dp.isDisabled&&dp.supportsFiber)try{ag=dp.inject(FB),Mi=dp}catch{}}ws.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OB;ws.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Iw(e))throw Error(Ae(200));return DB(n,e,null,t)};ws.createRoot=function(n,e){if(!Iw(n))throw Error(Ae(299));var t=!1,r="",s=kN;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Sw(n,1,!1,null,null,t,!1,r,s),n[po]=e.current,Rh(n.nodeType===8?n.parentNode:n),new Ew(e)};ws.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(Ae(188)):(n=Object.keys(n).join(","),Error(Ae(268,n)));return n=jT(e),n=n===null?null:n.stateNode,n};ws.flushSync=function(n){return il(n)};ws.hydrate=function(n,e,t){if(!wg(e))throw Error(Ae(200));return bg(null,n,e,!0,t)};ws.hydrateRoot=function(n,e,t){if(!Iw(n))throw Error(Ae(405));var r=t!=null&&t.hydratedSources||null,s=!1,i="",o=kN;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=SN(e,null,n,1,t??null,s,!1,i,o),n[po]=e.current,Rh(n),r)for(n=0;n<r.length;n++)t=r[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new xg(e)};ws.render=function(n,e,t){if(!wg(e))throw Error(Ae(200));return bg(null,n,e,!1,t)};ws.unmountComponentAtNode=function(n){if(!wg(n))throw Error(Ae(40));return n._reactRootContainer?(il(function(){bg(null,null,n,!1,function(){n._reactRootContainer=null,n[po]=null})}),!0):!1};ws.unstable_batchedUpdates=xw;ws.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!wg(t))throw Error(Ae(200));if(n==null||n._reactInternals===void 0)throw Error(Ae(38));return bg(n,e,t,!1,r)};ws.version="18.2.0-next-9e3b772b8-20220608";function EN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(EN)}catch(n){console.error(n)}}EN(),ST.exports=ws;var IN=ST.exports,tk=IN;Uy.createRoot=tk.createRoot,Uy.hydrateRoot=tk.hydrateRoot;var TN={};Object.defineProperty(TN,"__esModule",{value:!0});var LB=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},PB=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},MB=function(){function n(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),BB=Re,sy=WB(BB),zB=IN,UB=VB(zB);function VB(n){return n&&n.__esModule?n:{default:n}}function WB(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function GB(n,e){var t={};for(var r in n)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}function jB(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function HB(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n}function qB(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)}var KB=function(n){qB(e,n);function e(t){jB(this,e);var r=HB(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));r.handleChange=function(i){var o=Array.prototype.slice.call(i.target.files),a=(r.props.as||"url").toLowerCase();Promise.all(o.map(function(l){return new Promise(function(u,c){var h=new FileReader;switch(h.onload=function(d){u([d,l])},a){case"binary":{h.readAsBinaryString(l);break}case"buffer":{h.readAsArrayBuffer(l);break}case"text":{h.readAsText(l);break}case"url":{h.readAsDataURL(l);break}}})})).then(function(l){r.props.onChange(i,l)})},r.triggerInput=function(){var i=UB.default.findDOMNode(r._reactFileReaderInput);i&&i.click()};var s=(typeof window>"u"?"undefined":PB(window))==="object"?window:{};return(!s.File||!s.FileReader||!s.FileList||!s.Blob)&&console.warn("[react-file-reader-input] Some file APIs detected as not supported. File reader functionality may not fully work."),r}return MB(e,[{key:"render",value:function(){var r=this,s=this.props;s.as;var i=s.children,o=s.style,a=GB(s,["as","children","style"]),l=i?{position:"absolute",top:"-9999px"}:{};return sy.createElement("div",{className:"_react-file-reader-input",onClick:this.triggerInput,style:o},sy.createElement("input",LB({},a,{type:"file",ref:function(c){r._reactFileReaderInput=c},onChange:this.handleChange,onClick:function(){r._reactFileReaderInput.value=null},style:l})),i)}}]),e}(sy.Component),XB=TN.default=KB;/**
 * @remix-run/router v1.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function mn(){return mn=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},mn.apply(this,arguments)}var Tn;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Tn||(Tn={}));const nk="popstate";function YB(n){n===void 0&&(n={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Vh("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:hd(s)}return QB(e,t,null,n)}function xt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ol(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ZB(){return Math.random().toString(36).substr(2,8)}function rk(n,e){return{usr:n.state,key:n.key,idx:e}}function Vh(n,e,t,r){return t===void 0&&(t=null),mn({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?ko(e):e,{state:t,key:e&&e.key||r||ZB()})}function hd(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ko(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function QB(n,e,t,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=Tn.Pop,l=null,u=c();u==null&&(u=0,o.replaceState(mn({},o.state,{idx:u}),""));function c(){return(o.state||{idx:null}).idx}function h(){a=Tn.Pop;let g=c(),m=g==null?null:g-u;u=g,l&&l({action:a,location:v.location,delta:m})}function d(g,m){a=Tn.Push;let y=Vh(v.location,g,m);t&&t(y,g),u=c()+1;let w=rk(y,u),x=v.createHref(y);try{o.pushState(w,"",x)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;s.location.assign(x)}i&&l&&l({action:a,location:v.location,delta:1})}function f(g,m){a=Tn.Replace;let y=Vh(v.location,g,m);t&&t(y,g),u=c();let w=rk(y,u),x=v.createHref(y);o.replaceState(w,"",x),i&&l&&l({action:a,location:v.location,delta:0})}function p(g){let m=s.location.origin!=="null"?s.location.origin:s.location.href,y=typeof g=="string"?g:hd(g);return xt(m,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,m)}let v={get action(){return a},get location(){return n(s,o)},listen(g){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(nk,h),l=g,()=>{s.removeEventListener(nk,h),l=null}},createHref(g){return e(s,g)},createURL:p,encodeLocation(g){let m=p(g);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:d,replace:f,go(g){return o.go(g)}};return v}var _n;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(_n||(_n={}));const JB=new Set(["lazy","caseSensitive","path","id","index","children"]);function e4(n){return n.index===!0}function Ox(n,e,t,r){return t===void 0&&(t=[]),r===void 0&&(r={}),n.map((s,i)=>{let o=[...t,i],a=typeof s.id=="string"?s.id:o.join("-");if(xt(s.index!==!0||!s.children,"Cannot specify children on an index route"),xt(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),e4(s)){let l=mn({},s,e(s),{id:a});return r[a]=l,l}else{let l=mn({},s,e(s),{id:a,children:void 0});return r[a]=l,s.children&&(l.children=Ox(s.children,e,o,r)),l}})}function xu(n,e,t){t===void 0&&(t="/");let r=typeof e=="string"?ko(e):e,s=dd(r.pathname||"/",t);if(s==null)return null;let i=_N(n);n4(i);let o=null;for(let a=0;o==null&&a<i.length;++a)o=h4(i[a],p4(s));return o}function t4(n,e){let{route:t,pathname:r,params:s}=n;return{id:t.id,pathname:r,params:s,data:e[t.id],handle:t.handle}}function _N(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(xt(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=na([r,l.relativePath]),c=t.concat(l);i.children&&i.children.length>0&&(xt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),_N(i.children,e,c,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:u4(u,i.index),routesMeta:c})};return n.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of NN(i.path))s(i,o,l)}),e}function NN(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=NN(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function n4(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:c4(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const r4=/^:\w+$/,s4=3,i4=2,o4=1,a4=10,l4=-2,sk=n=>n==="*";function u4(n,e){let t=n.split("/"),r=t.length;return t.some(sk)&&(r+=l4),e&&(r+=i4),t.filter(s=>!sk(s)).reduce((s,i)=>s+(r4.test(i)?s4:i===""?o4:a4),r)}function c4(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function h4(n,e){let{routesMeta:t}=n,r={},s="/",i=[];for(let o=0;o<t.length;++o){let a=t[o],l=o===t.length-1,u=s==="/"?e:e.slice(s.length)||"/",c=d4({path:a.relativePath,caseSensitive:a.caseSensitive,end:l},u);if(!c)return null;Object.assign(r,c.params);let h=a.route;i.push({params:r,pathname:na([s,c.pathname]),pathnameBase:y4(na([s,c.pathnameBase])),route:h}),c.pathnameBase!=="/"&&(s=na([s,c.pathnameBase]))}return i}function d4(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=f4(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((u,c,h)=>{let{paramName:d,isOptional:f}=c;if(d==="*"){let v=a[h]||"";o=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const p=a[h];return f&&!p?u[d]=void 0:u[d]=m4(p||"",d),u},{}),pathname:i,pathnameBase:o,pattern:n}}function f4(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),ol(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function p4(n){try{return decodeURI(n)}catch(e){return ol(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function m4(n,e){try{return decodeURIComponent(n)}catch(t){return ol(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+n+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+t+").")),n}}function dd(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function g4(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?ko(n):n;return{pathname:t?t.startsWith("/")?t:v4(t,e):e,search:x4(r),hash:w4(s)}}function v4(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function iy(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Tw(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function $N(n,e,t,r){r===void 0&&(r=!1);let s;typeof n=="string"?s=ko(n):(s=mn({},n),xt(!s.pathname||!s.pathname.includes("?"),iy("?","pathname","search",s)),xt(!s.pathname||!s.pathname.includes("#"),iy("#","pathname","hash",s)),xt(!s.search||!s.search.includes("#"),iy("#","search","hash",s)));let i=n===""||s.pathname==="",o=i?"/":s.pathname,a;if(r||o==null)a=t;else{let h=e.length-1;if(o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;s.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=g4(s,a),u=o&&o!=="/"&&o.endsWith("/"),c=(i||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const na=n=>n.join("/").replace(/\/\/+/g,"/"),y4=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),x4=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,w4=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;class _w{constructor(e,t,r,s){s===void 0&&(s=!1),this.status=e,this.statusText=t||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function DN(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const AN=["post","put","patch","delete"],b4=new Set(AN),C4=["get",...AN],S4=new Set(C4),k4=new Set([301,302,303,307,308]),E4=new Set([307,308]),oy={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},I4={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Mc={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},RN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,T4=n=>({hasErrorBoundary:!!n.hasErrorBoundary}),ON="remix-router-transitions";function _4(n){const e=n.window?n.window:typeof window<"u"?window:void 0,t=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!t;xt(n.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(n.mapRouteProperties)s=n.mapRouteProperties;else if(n.detectErrorBoundary){let $=n.detectErrorBoundary;s=U=>({hasErrorBoundary:$(U)})}else s=T4;let i={},o=Ox(n.routes,s,void 0,i),a,l=n.basename||"/",u=mn({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_prependBasename:!1},n.future),c=null,h=new Set,d=null,f=null,p=null,v=n.hydrationData!=null,g=xu(o,n.history.location,l),m=null;if(g==null){let $=Rs(404,{pathname:n.history.location.pathname}),{matches:U,route:I}=dk(o);g=U,m={[I.id]:$}}let y=!g.some($=>$.route.lazy)&&(!g.some($=>$.route.loader)||n.hydrationData!=null),w,x={historyAction:n.history.action,location:n.history.location,matches:g,initialized:y,navigation:oy,restoreScrollPosition:n.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:n.hydrationData&&n.hydrationData.loaderData||{},actionData:n.hydrationData&&n.hydrationData.actionData||null,errors:n.hydrationData&&n.hydrationData.errors||m,fetchers:new Map,blockers:new Map},b=Tn.Pop,C=!1,k,E=!1,T=new Map,_=null,A=!1,P=!1,j=[],X=[],F=new Map,M=0,W=-1,D=new Map,z=new Set,K=new Map,ie=new Map,V=new Set,Z=new Map,de=new Map,ge=!1;function ye(){if(c=n.history.listen($=>{let{action:U,location:I,delta:ce}=$;if(ge){ge=!1;return}ol(de.size===0||ce!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ke=Gt({currentLocation:x.location,nextLocation:I,historyAction:U});if(ke&&ce!=null){ge=!0,n.history.go(ce*-1),er(ke,{state:"blocked",location:I,proceed(){er(ke,{state:"proceeding",proceed:void 0,reset:void 0,location:I}),n.history.go(ce)},reset(){let S=new Map(x.blockers);S.set(ke,Mc),fe({blockers:S})}});return}return Pe(U,I)}),t){B4(e,T);let $=()=>z4(e,T);e.addEventListener("pagehide",$),_=()=>e.removeEventListener("pagehide",$)}return x.initialized||Pe(Tn.Pop,x.location),w}function G(){c&&c(),_&&_(),h.clear(),k&&k.abort(),x.fetchers.forEach(($,U)=>Tt(U)),x.blockers.forEach(($,U)=>yr(U))}function J($){return h.add($),()=>h.delete($)}function fe($,U){x=mn({},x,$);let I=[],ce=[];u.v7_fetcherPersist&&x.fetchers.forEach((ke,S)=>{ke.state==="idle"&&(V.has(S)?ce.push(S):I.push(S))}),h.forEach(ke=>ke(x,{deletedFetchers:ce,unstable_viewTransitionOpts:U})),u.v7_fetcherPersist&&(I.forEach(ke=>x.fetchers.delete(ke)),ce.forEach(ke=>Tt(ke)))}function ve($,U){var I,ce;let ke=x.actionData!=null&&x.navigation.formMethod!=null&&ii(x.navigation.formMethod)&&x.navigation.state==="loading"&&((I=$.state)==null?void 0:I._isRedirect)!==!0,S;U.actionData?Object.keys(U.actionData).length>0?S=U.actionData:S=null:ke?S=x.actionData:S=null;let se=U.loaderData?hk(x.loaderData,U.loaderData,U.matches||[],U.errors):x.loaderData,re=x.blockers;re.size>0&&(re=new Map(re),re.forEach((ue,Ne)=>re.set(Ne,Mc)));let N=C===!0||x.navigation.formMethod!=null&&ii(x.navigation.formMethod)&&((ce=$.state)==null?void 0:ce._isRedirect)!==!0;a&&(o=a,a=void 0),A||b===Tn.Pop||(b===Tn.Push?n.history.push($,$.state):b===Tn.Replace&&n.history.replace($,$.state));let q;if(b===Tn.Pop){let ue=T.get(x.location.pathname);ue&&ue.has($.pathname)?q={currentLocation:x.location,nextLocation:$}:T.has($.pathname)&&(q={currentLocation:$,nextLocation:x.location})}else if(E){let ue=T.get(x.location.pathname);ue?ue.add($.pathname):(ue=new Set([$.pathname]),T.set(x.location.pathname,ue)),q={currentLocation:x.location,nextLocation:$}}fe(mn({},U,{actionData:S,loaderData:se,historyAction:b,location:$,initialized:!0,navigation:oy,revalidation:"idle",restoreScrollPosition:_e($,U.matches||x.matches),preventScrollReset:N,blockers:re}),q),b=Tn.Pop,C=!1,E=!1,A=!1,P=!1,j=[],X=[]}async function be($,U){if(typeof $=="number"){n.history.go($);return}let I=Fx(x.location,x.matches,l,u.v7_prependBasename,$,U==null?void 0:U.fromRouteId,U==null?void 0:U.relative),{path:ce,submission:ke,error:S}=ik(u.v7_normalizeFormMethod,!1,I,U),se=x.location,re=Vh(x.location,ce,U&&U.state);re=mn({},re,n.history.encodeLocation(re));let N=U&&U.replace!=null?U.replace:void 0,q=Tn.Push;N===!0?q=Tn.Replace:N===!1||ke!=null&&ii(ke.formMethod)&&ke.formAction===x.location.pathname+x.location.search&&(q=Tn.Replace);let ue=U&&"preventScrollReset"in U?U.preventScrollReset===!0:void 0,Ne=Gt({currentLocation:se,nextLocation:re,historyAction:q});if(Ne){er(Ne,{state:"blocked",location:re,proceed(){er(Ne,{state:"proceeding",proceed:void 0,reset:void 0,location:re}),be($,U)},reset(){let Ie=new Map(x.blockers);Ie.set(Ne,Mc),fe({blockers:Ie})}});return}return await Pe(q,re,{submission:ke,pendingError:S,preventScrollReset:ue,replace:U&&U.replace,enableViewTransition:U&&U.unstable_viewTransition})}function $e(){if(lt(),fe({revalidation:"loading"}),x.navigation.state!=="submitting"){if(x.navigation.state==="idle"){Pe(x.historyAction,x.location,{startUninterruptedRevalidation:!0});return}Pe(b||x.historyAction,x.navigation.location,{overrideNavigation:x.navigation})}}async function Pe($,U,I){k&&k.abort(),k=null,b=$,A=(I&&I.startUninterruptedRevalidation)===!0,Se(x.location,x.matches),C=(I&&I.preventScrollReset)===!0,E=(I&&I.enableViewTransition)===!0;let ce=a||o,ke=I&&I.overrideNavigation,S=xu(ce,U,l);if(!S){let Ie=Rs(404,{pathname:U.pathname}),{matches:Fe,route:ot}=dk(ce);Ln(),ve(U,{matches:Fe,loaderData:{},errors:{[ot.id]:Ie}});return}if(x.initialized&&!P&&R4(x.location,U)&&!(I&&I.submission&&ii(I.submission.formMethod))){ve(U,{matches:S});return}k=new AbortController;let se=zc(n.history,U,k.signal,I&&I.submission),re,N;if(I&&I.pendingError)N={[xh(S).route.id]:I.pendingError};else if(I&&I.submission&&ii(I.submission.formMethod)){let Ie=await Ge(se,U,I.submission,S,{replace:I.replace});if(Ie.shortCircuited)return;re=Ie.pendingActionData,N=Ie.pendingActionError,ke=ay(U,I.submission),se=new Request(se.url,{signal:se.signal})}let{shortCircuited:q,loaderData:ue,errors:Ne}=await Xe(se,U,S,ke,I&&I.submission,I&&I.fetcherSubmission,I&&I.replace,re,N);q||(k=null,ve(U,mn({matches:S},re?{actionData:re}:{},{loaderData:ue,errors:Ne})))}async function Ge($,U,I,ce,ke){ke===void 0&&(ke={}),lt();let S=P4(U,I);fe({navigation:S});let se,re=Px(ce,U);if(!re.route.action&&!re.route.lazy)se={type:_n.error,error:Rs(405,{method:$.method,pathname:U.pathname,routeId:re.route.id})};else if(se=await Bc("action",$,re,ce,i,s,l),$.signal.aborted)return{shortCircuited:!0};if(Nu(se)){let N;return ke&&ke.replace!=null?N=ke.replace:N=se.location===x.location.pathname+x.location.search,await dt(x,se,{submission:I,replace:N}),{shortCircuited:!0}}if(wh(se)){let N=xh(ce,re.route.id);return(ke&&ke.replace)!==!0&&(b=Tn.Push),{pendingActionData:{},pendingActionError:{[N.route.id]:se.error}}}if(Ha(se))throw Rs(400,{type:"defer-action"});return{pendingActionData:{[re.route.id]:se.data}}}async function Xe($,U,I,ce,ke,S,se,re,N){let q=ce||ay(U,ke),ue=ke||S||mk(q),Ne=a||o,[Ie,Fe]=ok(n.history,x,I,ue,U,P,j,X,K,z,Ne,l,re,N);if(Ln(ct=>!(I&&I.some(Dt=>Dt.route.id===ct))||Ie&&Ie.some(Dt=>Dt.route.id===ct)),W=++M,Ie.length===0&&Fe.length===0){let ct=kn();return ve(U,mn({matches:I,loaderData:{},errors:N||null},re?{actionData:re}:{},ct?{fetchers:new Map(x.fetchers)}:{})),{shortCircuited:!0}}if(!A){Fe.forEach(Dt=>{let Pn=x.fetchers.get(Dt.key),kt=Uc(void 0,Pn?Pn.data:void 0);x.fetchers.set(Dt.key,kt)});let ct=re||x.actionData;fe(mn({navigation:q},ct?Object.keys(ct).length===0?{actionData:null}:{actionData:ct}:{},Fe.length>0?{fetchers:new Map(x.fetchers)}:{}))}Fe.forEach(ct=>{F.has(ct.key)&&Pt(ct.key),ct.controller&&F.set(ct.key,ct.controller)});let ot=()=>Fe.forEach(ct=>Pt(ct.key));k&&k.signal.addEventListener("abort",ot);let{results:Hn,loaderResults:Rt,fetcherResults:vt}=await Lt(x.matches,I,Ie,Fe,$);if($.signal.aborted)return{shortCircuited:!0};k&&k.signal.removeEventListener("abort",ot),Fe.forEach(ct=>F.delete(ct.key));let $t=fk(Hn);if($t){if($t.idx>=Ie.length){let ct=Fe[$t.idx-Ie.length].key;z.add(ct)}return await dt(x,$t.result,{replace:se}),{shortCircuited:!0}}let{loaderData:jt,errors:En}=ck(x,I,Ie,Rt,N,Fe,vt,Z);Z.forEach((ct,Dt)=>{ct.subscribe(Pn=>{(Pn||ct.done)&&Z.delete(Dt)})});let Si=kn(),ki=On(W),Xt=Si||ki||Fe.length>0;return mn({loaderData:jt,errors:En},Xt?{fetchers:new Map(x.fetchers)}:{})}function Je($){return u.v7_fetcherPersist&&(ie.set($,(ie.get($)||0)+1),V.has($)&&V.delete($)),x.fetchers.get($)||I4}function Ze($,U,I,ce){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");F.has($)&&Pt($);let ke=a||o,S=Fx(x.location,x.matches,l,u.v7_prependBasename,I,U,ce==null?void 0:ce.relative),se=xu(ke,S,l);if(!se){tt($,U,Rs(404,{pathname:S}));return}let{path:re,submission:N,error:q}=ik(u.v7_normalizeFormMethod,!0,S,ce);if(q){tt($,U,q);return}let ue=Px(se,re);if(C=(ce&&ce.preventScrollReset)===!0,N&&ii(N.formMethod)){it($,U,re,ue,se,N);return}K.set($,{routeId:U,path:re}),cn($,U,re,ue,se,N)}async function it($,U,I,ce,ke,S){if(lt(),K.delete($),!ce.route.action&&!ce.route.lazy){let kt=Rs(405,{method:S.formMethod,pathname:I,routeId:U});tt($,U,kt);return}let se=x.fetchers.get($),re=M4(S,se);x.fetchers.set($,re),fe({fetchers:new Map(x.fetchers)});let N=new AbortController,q=zc(n.history,I,N.signal,S);F.set($,N);let ue=M,Ne=await Bc("action",q,ce,ke,i,s,l);if(q.signal.aborted){F.get($)===N&&F.delete($);return}if(V.has($)){x.fetchers.set($,Lo(void 0)),fe({fetchers:new Map(x.fetchers)});return}if(Nu(Ne))if(F.delete($),W>ue){let kt=Lo(void 0);x.fetchers.set($,kt),fe({fetchers:new Map(x.fetchers)});return}else{z.add($);let kt=Uc(S);return x.fetchers.set($,kt),fe({fetchers:new Map(x.fetchers)}),dt(x,Ne,{fetcherSubmission:S})}if(wh(Ne)){tt($,U,Ne.error);return}if(Ha(Ne))throw Rs(400,{type:"defer-action"});let Ie=x.navigation.location||x.location,Fe=zc(n.history,Ie,N.signal),ot=a||o,Hn=x.navigation.state!=="idle"?xu(ot,x.navigation.location,l):x.matches;xt(Hn,"Didn't find any matches after fetcher action");let Rt=++M;D.set($,Rt);let vt=Uc(S,Ne.data);x.fetchers.set($,vt);let[$t,jt]=ok(n.history,x,Hn,S,Ie,P,j,X,K,z,ot,l,{[ce.route.id]:Ne.data},void 0);jt.filter(kt=>kt.key!==$).forEach(kt=>{let Ei=kt.key,qf=x.fetchers.get(Ei),Kf=Uc(void 0,qf?qf.data:void 0);x.fetchers.set(Ei,Kf),F.has(Ei)&&Pt(Ei),kt.controller&&F.set(Ei,kt.controller)}),fe({fetchers:new Map(x.fetchers)});let En=()=>jt.forEach(kt=>Pt(kt.key));N.signal.addEventListener("abort",En);let{results:Si,loaderResults:ki,fetcherResults:Xt}=await Lt(x.matches,Hn,$t,jt,Fe);if(N.signal.aborted)return;N.signal.removeEventListener("abort",En),D.delete($),F.delete($),jt.forEach(kt=>F.delete(kt.key));let ct=fk(Si);if(ct){if(ct.idx>=$t.length){let kt=jt[ct.idx-$t.length].key;z.add(kt)}return dt(x,ct.result)}let{loaderData:Dt,errors:Pn}=ck(x,x.matches,$t,ki,void 0,jt,Xt,Z);if(x.fetchers.has($)){let kt=Lo(Ne.data);x.fetchers.set($,kt)}On(Rt),x.navigation.state==="loading"&&Rt>W?(xt(b,"Expected pending action"),k&&k.abort(),ve(x.navigation.location,{matches:Hn,loaderData:Dt,errors:Pn,fetchers:new Map(x.fetchers)})):(fe({errors:Pn,loaderData:hk(x.loaderData,Dt,Hn,Pn),fetchers:new Map(x.fetchers)}),P=!1)}async function cn($,U,I,ce,ke,S){let se=x.fetchers.get($),re=Uc(S,se?se.data:void 0);x.fetchers.set($,re),fe({fetchers:new Map(x.fetchers)});let N=new AbortController,q=zc(n.history,I,N.signal);F.set($,N);let ue=M,Ne=await Bc("loader",q,ce,ke,i,s,l);if(Ha(Ne)&&(Ne=await PN(Ne,q.signal,!0)||Ne),F.get($)===N&&F.delete($),q.signal.aborted)return;if(V.has($)){x.fetchers.set($,Lo(void 0)),fe({fetchers:new Map(x.fetchers)});return}if(Nu(Ne))if(W>ue){let Fe=Lo(void 0);x.fetchers.set($,Fe),fe({fetchers:new Map(x.fetchers)});return}else{z.add($),await dt(x,Ne);return}if(wh(Ne)){tt($,U,Ne.error);return}xt(!Ha(Ne),"Unhandled fetcher deferred data");let Ie=Lo(Ne.data);x.fetchers.set($,Ie),fe({fetchers:new Map(x.fetchers)})}async function dt($,U,I){let{submission:ce,fetcherSubmission:ke,replace:S}=I===void 0?{}:I;U.revalidate&&(P=!0);let se=Vh($.location,U.location,{_isRedirect:!0});if(xt(se,"Expected a location on the redirect navigation"),t){let Ie=!1;if(U.reloadDocument)Ie=!0;else if(RN.test(U.location)){const Fe=n.history.createURL(U.location);Ie=Fe.origin!==e.location.origin||dd(Fe.pathname,l)==null}if(Ie){S?e.location.replace(U.location):e.location.assign(U.location);return}}k=null;let re=S===!0?Tn.Replace:Tn.Push,{formMethod:N,formAction:q,formEncType:ue}=$.navigation;!ce&&!ke&&N&&q&&ue&&(ce=mk($.navigation));let Ne=ce||ke;if(E4.has(U.status)&&Ne&&ii(Ne.formMethod))await Pe(re,se,{submission:mn({},Ne,{formAction:U.location}),preventScrollReset:C});else{let Ie=ay(se,ce);await Pe(re,se,{overrideNavigation:Ie,fetcherSubmission:ke,preventScrollReset:C})}}async function Lt($,U,I,ce,ke){let S=await Promise.all([...I.map(N=>Bc("loader",ke,N,U,i,s,l)),...ce.map(N=>N.matches&&N.match&&N.controller?Bc("loader",zc(n.history,N.path,N.controller.signal),N.match,N.matches,i,s,l):{type:_n.error,error:Rs(404,{pathname:N.path})})]),se=S.slice(0,I.length),re=S.slice(I.length);return await Promise.all([pk($,I,se,se.map(()=>ke.signal),!1,x.loaderData),pk($,ce.map(N=>N.match),re,ce.map(N=>N.controller?N.controller.signal:null),!0)]),{results:S,loaderResults:se,fetcherResults:re}}function lt(){P=!0,j.push(...Ln()),K.forEach(($,U)=>{F.has(U)&&(X.push(U),Pt(U))})}function tt($,U,I){let ce=xh(x.matches,U);Tt($),fe({errors:{[ce.route.id]:I},fetchers:new Map(x.fetchers)})}function Tt($){let U=x.fetchers.get($);F.has($)&&!(U&&U.state==="loading"&&D.has($))&&Pt($),K.delete($),D.delete($),z.delete($),V.delete($),x.fetchers.delete($)}function Sn($){if(u.v7_fetcherPersist){let U=(ie.get($)||0)-1;U<=0?(ie.delete($),V.add($)):ie.set($,U)}else Tt($);fe({fetchers:new Map(x.fetchers)})}function Pt($){let U=F.get($);xt(U,"Expected fetch controller: "+$),U.abort(),F.delete($)}function Wt($){for(let U of $){let I=Je(U),ce=Lo(I.data);x.fetchers.set(U,ce)}}function kn(){let $=[],U=!1;for(let I of z){let ce=x.fetchers.get(I);xt(ce,"Expected fetcher: "+I),ce.state==="loading"&&(z.delete(I),$.push(I),U=!0)}return Wt($),U}function On($){let U=[];for(let[I,ce]of D)if(ce<$){let ke=x.fetchers.get(I);xt(ke,"Expected fetcher: "+I),ke.state==="loading"&&(Pt(I),D.delete(I),U.push(I))}return Wt(U),U.length>0}function Fn($,U){let I=x.blockers.get($)||Mc;return de.get($)!==U&&de.set($,U),I}function yr($){x.blockers.delete($),de.delete($)}function er($,U){let I=x.blockers.get($)||Mc;xt(I.state==="unblocked"&&U.state==="blocked"||I.state==="blocked"&&U.state==="blocked"||I.state==="blocked"&&U.state==="proceeding"||I.state==="blocked"&&U.state==="unblocked"||I.state==="proceeding"&&U.state==="unblocked","Invalid blocker state transition: "+I.state+" -> "+U.state);let ce=new Map(x.blockers);ce.set($,U),fe({blockers:ce})}function Gt($){let{currentLocation:U,nextLocation:I,historyAction:ce}=$;if(de.size===0)return;de.size>1&&ol(!1,"A router only supports one blocker at a time");let ke=Array.from(de.entries()),[S,se]=ke[ke.length-1],re=x.blockers.get(S);if(!(re&&re.state==="proceeding")&&se({currentLocation:U,nextLocation:I,historyAction:ce}))return S}function Ln($){let U=[];return Z.forEach((I,ce)=>{(!$||$(ce))&&(I.cancel(),U.push(ce),Z.delete(ce))}),U}function ks($,U,I){if(d=$,p=U,f=I||null,!v&&x.navigation===oy){v=!0;let ce=_e(x.location,x.matches);ce!=null&&fe({restoreScrollPosition:ce})}return()=>{d=null,p=null,f=null}}function L($,U){return f&&f($,U.map(ce=>t4(ce,x.loaderData)))||$.key}function Se($,U){if(d&&p){let I=L($,U);d[I]=p()}}function _e($,U){if(d){let I=L($,U),ce=d[I];if(typeof ce=="number")return ce}return null}function We($){i={},a=Ox($,s,void 0,i)}return w={get basename(){return l},get state(){return x},get routes(){return o},get window(){return e},initialize:ye,subscribe:J,enableScrollRestoration:ks,navigate:be,fetch:Ze,revalidate:$e,createHref:$=>n.history.createHref($),encodeLocation:$=>n.history.encodeLocation($),getFetcher:Je,deleteFetcher:Sn,dispose:G,getBlocker:Fn,deleteBlocker:yr,_internalFetchControllers:F,_internalActiveDeferreds:Z,_internalSetRoutes:We},w}function N4(n){return n!=null&&("formData"in n&&n.formData!=null||"body"in n&&n.body!==void 0)}function Fx(n,e,t,r,s,i,o){let a,l;if(i!=null&&o!=="path"){a=[];for(let c of e)if(a.push(c),c.route.id===i){l=c;break}}else a=e,l=e[e.length-1];let u=$N(s||".",Tw(a).map(c=>c.pathnameBase),dd(n.pathname,t)||n.pathname,o==="path");return s==null&&(u.search=n.search,u.hash=n.hash),(s==null||s===""||s===".")&&l&&l.route.index&&!Nw(u.search)&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),r&&t!=="/"&&(u.pathname=u.pathname==="/"?t:na([t,u.pathname])),hd(u)}function ik(n,e,t,r){if(!r||!N4(r))return{path:t};if(r.formMethod&&!L4(r.formMethod))return{path:t,error:Rs(405,{method:r.formMethod})};let s=()=>({path:t,error:Rs(400,{type:"invalid-body"})}),i=r.formMethod||"get",o=n?i.toUpperCase():i.toLowerCase(),a=LN(t);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!ii(o))return s();let d=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((f,p)=>{let[v,g]=p;return""+f+v+"="+g+`
`},""):String(r.body);return{path:t,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:d}}}else if(r.formEncType==="application/json"){if(!ii(o))return s();try{let d=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:t,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:d,text:void 0}}}catch{return s()}}}xt(typeof FormData=="function","FormData is not available in this environment");let l,u;if(r.formData)l=Lx(r.formData),u=r.formData;else if(r.body instanceof FormData)l=Lx(r.body),u=r.body;else if(r.body instanceof URLSearchParams)l=r.body,u=uk(l);else if(r.body==null)l=new URLSearchParams,u=new FormData;else try{l=new URLSearchParams(r.body),u=uk(l)}catch{return s()}let c={formMethod:o,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:u,json:void 0,text:void 0};if(ii(c.formMethod))return{path:t,submission:c};let h=ko(t);return e&&h.search&&Nw(h.search)&&l.append("index",""),h.search="?"+l,{path:hd(h),submission:c}}function $4(n,e){let t=n;if(e){let r=n.findIndex(s=>s.route.id===e);r>=0&&(t=n.slice(0,r))}return t}function ok(n,e,t,r,s,i,o,a,l,u,c,h,d,f){let p=f?Object.values(f)[0]:d?Object.values(d)[0]:void 0,v=n.createURL(e.location),g=n.createURL(s),m=f?Object.keys(f)[0]:void 0,w=$4(t,m).filter((b,C)=>{if(b.route.lazy)return!0;if(b.route.loader==null)return!1;if(D4(e.loaderData,e.matches[C],b)||o.some(T=>T===b.route.id))return!0;let k=e.matches[C],E=b;return ak(b,mn({currentUrl:v,currentParams:k.params,nextUrl:g,nextParams:E.params},r,{actionResult:p,defaultShouldRevalidate:i||v.pathname+v.search===g.pathname+g.search||v.search!==g.search||FN(k,E)}))}),x=[];return l.forEach((b,C)=>{if(!t.some(A=>A.route.id===b.routeId))return;let k=xu(c,b.path,h);if(!k){x.push({key:C,routeId:b.routeId,path:b.path,matches:null,match:null,controller:null});return}let E=e.fetchers.get(C),T=Px(k,b.path),_=!1;u.has(C)?_=!1:a.includes(C)?_=!0:E&&E.state!=="idle"&&E.data===void 0?_=i:_=ak(T,mn({currentUrl:v,currentParams:e.matches[e.matches.length-1].params,nextUrl:g,nextParams:t[t.length-1].params},r,{actionResult:p,defaultShouldRevalidate:i})),_&&x.push({key:C,routeId:b.routeId,path:b.path,matches:k,match:T,controller:new AbortController})}),[w,x]}function D4(n,e,t){let r=!e||t.route.id!==e.route.id,s=n[t.route.id]===void 0;return r||s}function FN(n,e){let t=n.route.path;return n.pathname!==e.pathname||t!=null&&t.endsWith("*")&&n.params["*"]!==e.params["*"]}function ak(n,e){if(n.route.shouldRevalidate){let t=n.route.shouldRevalidate(e);if(typeof t=="boolean")return t}return e.defaultShouldRevalidate}async function lk(n,e,t){if(!n.lazy)return;let r=await n.lazy();if(!n.lazy)return;let s=t[n.id];xt(s,"No route found in manifest");let i={};for(let o in r){let l=s[o]!==void 0&&o!=="hasErrorBoundary";ol(!l,'Route "'+s.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!l&&!JB.has(o)&&(i[o]=r[o])}Object.assign(s,i),Object.assign(s,mn({},e(s),{lazy:void 0}))}async function Bc(n,e,t,r,s,i,o,a){a===void 0&&(a={});let l,u,c,h=p=>{let v,g=new Promise((m,y)=>v=y);return c=()=>v(),e.signal.addEventListener("abort",c),Promise.race([p({request:e,params:t.params,context:a.requestContext}),g])};try{let p=t.route[n];if(t.route.lazy)if(p){let v,g=await Promise.all([h(p).catch(m=>{v=m}),lk(t.route,i,s)]);if(v)throw v;u=g[0]}else if(await lk(t.route,i,s),p=t.route[n],p)u=await h(p);else if(n==="action"){let v=new URL(e.url),g=v.pathname+v.search;throw Rs(405,{method:e.method,pathname:g,routeId:t.route.id})}else return{type:_n.data,data:void 0};else if(p)u=await h(p);else{let v=new URL(e.url),g=v.pathname+v.search;throw Rs(404,{pathname:g})}xt(u!==void 0,"You defined "+(n==="action"?"an action":"a loader")+" for route "+('"'+t.route.id+"\" but didn't return anything from your `"+n+"` ")+"function. Please return a value or `null`.")}catch(p){l=_n.error,u=p}finally{c&&e.signal.removeEventListener("abort",c)}if(F4(u)){let p=u.status;if(k4.has(p)){let m=u.headers.get("Location");if(xt(m,"Redirects returned/thrown from loaders/actions must have a Location header"),!RN.test(m))m=Fx(new URL(e.url),r.slice(0,r.indexOf(t)+1),o,!0,m);else if(!a.isStaticRequest){let y=new URL(e.url),w=m.startsWith("//")?new URL(y.protocol+m):new URL(m),x=dd(w.pathname,o)!=null;w.origin===y.origin&&x&&(m=w.pathname+w.search+w.hash)}if(a.isStaticRequest)throw u.headers.set("Location",m),u;return{type:_n.redirect,status:p,location:m,revalidate:u.headers.get("X-Remix-Revalidate")!==null,reloadDocument:u.headers.get("X-Remix-Reload-Document")!==null}}if(a.isRouteRequest)throw{type:l===_n.error?_n.error:_n.data,response:u};let v,g=u.headers.get("Content-Type");return g&&/\bapplication\/json\b/.test(g)?v=await u.json():v=await u.text(),l===_n.error?{type:l,error:new _w(p,u.statusText,v),headers:u.headers}:{type:_n.data,data:v,statusCode:u.status,headers:u.headers}}if(l===_n.error)return{type:l,error:u};if(O4(u)){var d,f;return{type:_n.deferred,deferredData:u,statusCode:(d=u.init)==null?void 0:d.status,headers:((f=u.init)==null?void 0:f.headers)&&new Headers(u.init.headers)}}return{type:_n.data,data:u}}function zc(n,e,t,r){let s=n.createURL(LN(e)).toString(),i={signal:t};if(r&&ii(r.formMethod)){let{formMethod:o,formEncType:a}=r;i.method=o.toUpperCase(),a==="application/json"?(i.headers=new Headers({"Content-Type":a}),i.body=JSON.stringify(r.json)):a==="text/plain"?i.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?i.body=Lx(r.formData):i.body=r.formData}return new Request(s,i)}function Lx(n){let e=new URLSearchParams;for(let[t,r]of n.entries())e.append(t,typeof r=="string"?r:r.name);return e}function uk(n){let e=new FormData;for(let[t,r]of n.entries())e.append(t,r);return e}function A4(n,e,t,r,s){let i={},o=null,a,l=!1,u={};return t.forEach((c,h)=>{let d=e[h].route.id;if(xt(!Nu(c),"Cannot handle redirect results in processLoaderData"),wh(c)){let f=xh(n,d),p=c.error;r&&(p=Object.values(r)[0],r=void 0),o=o||{},o[f.route.id]==null&&(o[f.route.id]=p),i[d]=void 0,l||(l=!0,a=DN(c.error)?c.error.status:500),c.headers&&(u[d]=c.headers)}else Ha(c)?(s.set(d,c.deferredData),i[d]=c.deferredData.data):i[d]=c.data,c.statusCode!=null&&c.statusCode!==200&&!l&&(a=c.statusCode),c.headers&&(u[d]=c.headers)}),r&&(o=r,i[Object.keys(r)[0]]=void 0),{loaderData:i,errors:o,statusCode:a||200,loaderHeaders:u}}function ck(n,e,t,r,s,i,o,a){let{loaderData:l,errors:u}=A4(e,t,r,s,a);for(let c=0;c<i.length;c++){let{key:h,match:d,controller:f}=i[c];xt(o!==void 0&&o[c]!==void 0,"Did not find corresponding fetcher result");let p=o[c];if(!(f&&f.signal.aborted))if(wh(p)){let v=xh(n.matches,d==null?void 0:d.route.id);u&&u[v.route.id]||(u=mn({},u,{[v.route.id]:p.error})),n.fetchers.delete(h)}else if(Nu(p))xt(!1,"Unhandled fetcher revalidation redirect");else if(Ha(p))xt(!1,"Unhandled fetcher deferred data");else{let v=Lo(p.data);n.fetchers.set(h,v)}}return{loaderData:l,errors:u}}function hk(n,e,t,r){let s=mn({},e);for(let i of t){let o=i.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(s[o]=e[o]):n[o]!==void 0&&i.route.loader&&(s[o]=n[o]),r&&r.hasOwnProperty(o))break}return s}function xh(n,e){return(e?n.slice(0,n.findIndex(r=>r.route.id===e)+1):[...n]).reverse().find(r=>r.route.hasErrorBoundary===!0)||n[0]}function dk(n){let e=n.length===1?n[0]:n.find(t=>t.index||!t.path||t.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Rs(n,e){let{pathname:t,routeId:r,method:s,type:i}=e===void 0?{}:e,o="Unknown Server Error",a="Unknown @remix-run/router error";return n===400?(o="Bad Request",s&&t&&r?a="You made a "+s+' request to "'+t+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":i==="defer-action"?a="defer() is not supported in actions":i==="invalid-body"&&(a="Unable to encode submission body")):n===403?(o="Forbidden",a='Route "'+r+'" does not match URL "'+t+'"'):n===404?(o="Not Found",a='No route matches URL "'+t+'"'):n===405&&(o="Method Not Allowed",s&&t&&r?a="You made a "+s.toUpperCase()+' request to "'+t+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":s&&(a='Invalid request method "'+s.toUpperCase()+'"')),new _w(n||500,o,new Error(a),!0)}function fk(n){for(let e=n.length-1;e>=0;e--){let t=n[e];if(Nu(t))return{result:t,idx:e}}}function LN(n){let e=typeof n=="string"?ko(n):n;return hd(mn({},e,{hash:""}))}function R4(n,e){return n.pathname!==e.pathname||n.search!==e.search?!1:n.hash===""?e.hash!=="":n.hash===e.hash?!0:e.hash!==""}function Ha(n){return n.type===_n.deferred}function wh(n){return n.type===_n.error}function Nu(n){return(n&&n.type)===_n.redirect}function O4(n){let e=n;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function F4(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.headers=="object"&&typeof n.body<"u"}function L4(n){return S4.has(n.toLowerCase())}function ii(n){return b4.has(n.toLowerCase())}async function pk(n,e,t,r,s,i){for(let o=0;o<t.length;o++){let a=t[o],l=e[o];if(!l)continue;let u=n.find(h=>h.route.id===l.route.id),c=u!=null&&!FN(u,l)&&(i&&i[l.route.id])!==void 0;if(Ha(a)&&(s||c)){let h=r[o];xt(h,"Expected an AbortSignal for revalidating fetcher deferred result"),await PN(a,h,s).then(d=>{d&&(t[o]=d||t[o])})}}}async function PN(n,e,t){if(t===void 0&&(t=!1),!await n.deferredData.resolveData(e)){if(t)try{return{type:_n.data,data:n.deferredData.unwrappedData}}catch(s){return{type:_n.error,error:s}}return{type:_n.data,data:n.deferredData.data}}}function Nw(n){return new URLSearchParams(n).getAll("index").some(e=>e==="")}function Px(n,e){let t=typeof e=="string"?ko(e).search:e.search;if(n[n.length-1].route.index&&Nw(t||""))return n[n.length-1];let r=Tw(n);return r[r.length-1]}function mk(n){let{formMethod:e,formAction:t,formEncType:r,text:s,formData:i,json:o}=n;if(!(!e||!t||!r)){if(s!=null)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:e,formAction:t,formEncType:r,formData:i,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:o,text:void 0}}}function ay(n,e){return e?{state:"loading",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:n,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function P4(n,e){return{state:"submitting",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Uc(n,e){return n?{state:"loading",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function M4(n,e){return{state:"submitting",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e?e.data:void 0}}function Lo(n){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:n}}function B4(n,e){try{let t=n.sessionStorage.getItem(ON);if(t){let r=JSON.parse(t);for(let[s,i]of Object.entries(r||{}))i&&Array.isArray(i)&&e.set(s,new Set(i||[]))}}catch{}}function z4(n,e){if(e.size>0){let t={};for(let[r,s]of e)t[r]=[...s];try{n.sessionStorage.setItem(ON,JSON.stringify(t))}catch(r){ol(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.18.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wm(){return wm=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},wm.apply(this,arguments)}const Cg=Re.createContext(null),MN=Re.createContext(null),Sg=Re.createContext(null),kg=Re.createContext(null),oc=Re.createContext({outlet:null,matches:[],isDataRoute:!1}),BN=Re.createContext(null);function Eg(){return Re.useContext(kg)!=null}function $w(){return Eg()||xt(!1),Re.useContext(kg).location}function zN(n){Re.useContext(Sg).static||Re.useLayoutEffect(n)}function UN(){let{isDataRoute:n}=Re.useContext(oc);return n?Q4():U4()}function U4(){Eg()||xt(!1);let n=Re.useContext(Cg),{basename:e,navigator:t}=Re.useContext(Sg),{matches:r}=Re.useContext(oc),{pathname:s}=$w(),i=JSON.stringify(Tw(r).map(l=>l.pathnameBase)),o=Re.useRef(!1);return zN(()=>{o.current=!0}),Re.useCallback(function(l,u){if(u===void 0&&(u={}),!o.current)return;if(typeof l=="number"){t.go(l);return}let c=$N(l,JSON.parse(i),s,u.relative==="path");n==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:na([e,c.pathname])),(u.replace?t.replace:t.push)(c,u.state,u)},[e,t,i,s,n])}function V4(n,e,t){Eg()||xt(!1);let{navigator:r}=Re.useContext(Sg),{matches:s}=Re.useContext(oc),i=s[s.length-1],o=i?i.params:{};i&&i.pathname;let a=i?i.pathnameBase:"/";i&&i.route;let l=$w(),u;if(e){var c;let v=typeof e=="string"?ko(e):e;a==="/"||(c=v.pathname)!=null&&c.startsWith(a)||xt(!1),u=v}else u=l;let h=u.pathname||"/",d=a==="/"?h:h.slice(a.length)||"/",f=xu(n,{pathname:d}),p=q4(f&&f.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:na([a,r.encodeLocation?r.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?a:na([a,r.encodeLocation?r.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),s,t);return e&&p?Re.createElement(kg.Provider,{value:{location:wm({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Tn.Pop}},p):p}function W4(){let n=Z4(),e=DN(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return Re.createElement(Re.Fragment,null,Re.createElement("h2",null,"Unexpected Application Error!"),Re.createElement("h3",{style:{fontStyle:"italic"}},e),t?Re.createElement("pre",{style:s},t):null,i)}const G4=Re.createElement(W4,null);class j4 extends Re.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error?Re.createElement(oc.Provider,{value:this.props.routeContext},Re.createElement(BN.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function H4(n){let{routeContext:e,match:t,children:r}=n,s=Re.useContext(Cg);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),Re.createElement(oc.Provider,{value:e},r)}function q4(n,e,t){var r;if(e===void 0&&(e=[]),t===void 0&&(t=null),n==null){var s;if((s=t)!=null&&s.errors)n=t.matches;else return null}let i=n,o=(r=t)==null?void 0:r.errors;if(o!=null){let a=i.findIndex(l=>l.route.id&&(o==null?void 0:o[l.route.id]));a>=0||xt(!1),i=i.slice(0,Math.min(i.length,a+1))}return i.reduceRight((a,l,u)=>{let c=l.route.id?o==null?void 0:o[l.route.id]:null,h=null;t&&(h=l.route.errorElement||G4);let d=e.concat(i.slice(0,u+1)),f=()=>{let p;return c?p=h:l.route.Component?p=Re.createElement(l.route.Component,null):l.route.element?p=l.route.element:p=a,Re.createElement(H4,{match:l,routeContext:{outlet:a,matches:d,isDataRoute:t!=null},children:p})};return t&&(l.route.ErrorBoundary||l.route.errorElement||u===0)?Re.createElement(j4,{location:t.location,revalidation:t.revalidation,component:h,error:c,children:f(),routeContext:{outlet:null,matches:d,isDataRoute:!0}}):f()},null)}var VN=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(VN||{}),bm=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(bm||{});function K4(n){let e=Re.useContext(Cg);return e||xt(!1),e}function X4(n){let e=Re.useContext(MN);return e||xt(!1),e}function Y4(n){let e=Re.useContext(oc);return e||xt(!1),e}function WN(n){let e=Y4(),t=e.matches[e.matches.length-1];return t.route.id||xt(!1),t.route.id}function Z4(){var n;let e=Re.useContext(BN),t=X4(bm.UseRouteError),r=WN(bm.UseRouteError);return e||((n=t.errors)==null?void 0:n[r])}function Q4(){let{router:n}=K4(VN.UseNavigateStable),e=WN(bm.UseNavigateStable),t=Re.useRef(!1);return zN(()=>{t.current=!0}),Re.useCallback(function(s,i){i===void 0&&(i={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,wm({fromRouteId:e},i)))},[n,e])}function J4(n){let{basename:e="/",children:t=null,location:r,navigationType:s=Tn.Pop,navigator:i,static:o=!1}=n;Eg()&&xt(!1);let a=e.replace(/^\/*/,"/"),l=Re.useMemo(()=>({basename:a,navigator:i,static:o}),[a,i,o]);typeof r=="string"&&(r=ko(r));let{pathname:u="/",search:c="",hash:h="",state:d=null,key:f="default"}=r,p=Re.useMemo(()=>{let v=dd(u,a);return v==null?null:{location:{pathname:v,search:c,hash:h,state:d,key:f},navigationType:s}},[a,u,c,h,d,f,s]);return p==null?null:Re.createElement(Sg.Provider,{value:l},Re.createElement(kg.Provider,{children:t,value:p}))}new Promise(()=>{});function ez(n){let e={hasErrorBoundary:n.ErrorBoundary!=null||n.errorElement!=null};return n.Component&&Object.assign(e,{element:Re.createElement(n.Component),Component:void 0}),n.ErrorBoundary&&Object.assign(e,{errorElement:Re.createElement(n.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.18.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cm(){return Cm=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Cm.apply(this,arguments)}function tz(n,e){return _4({basename:e==null?void 0:e.basename,future:Cm({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:YB({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||nz(),routes:n,mapRouteProperties:ez,window:e==null?void 0:e.window}).initialize()}function nz(){var n;let e=(n=window)==null?void 0:n.__staticRouterHydrationData;return e&&e.errors&&(e=Cm({},e,{errors:rz(e.errors)})),e}function rz(n){if(!n)return null;let e=Object.entries(n),t={};for(let[r,s]of e)if(s&&s.__type==="RouteErrorResponse")t[r]=new _w(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let o=new i(s.message);o.stack="",t[r]=o}catch{}}if(t[r]==null){let i=new Error(s.message);i.stack="",t[r]=i}}else t[r]=s;return t}const sz=Re.createContext({isTransitioning:!1}),iz=Re.createContext(new Map),oz="startTransition",gk=IP[oz];function az(n){gk?gk(n):n()}class lz{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",t(r))}})}}function uz(n){let{fallbackElement:e,router:t,future:r}=n,[s,i]=Re.useState(t.state),[o,a]=Re.useState(),[l,u]=Re.useState({isTransitioning:!1}),[c,h]=Re.useState(),[d,f]=Re.useState(),[p,v]=Re.useState(),g=Re.useRef(new Map),{v7_startTransition:m}=r||{},y=Re.useCallback(k=>{m?az(k):k()},[m]),w=Re.useCallback((k,E)=>{let{deletedFetchers:T,unstable_viewTransitionOpts:_}=E;T.forEach(A=>g.current.delete(A)),k.fetchers.forEach((A,P)=>{A.data!==void 0&&g.current.set(P,A.data)}),!_||t.window==null||typeof t.window.document.startViewTransition!="function"?y(()=>i(k)):d&&c?(c.resolve(),d.skipTransition(),v({state:k,currentLocation:_.currentLocation,nextLocation:_.nextLocation})):(a(k),u({isTransitioning:!0,currentLocation:_.currentLocation,nextLocation:_.nextLocation}))},[t.window,d,c,g,y]);Re.useLayoutEffect(()=>t.subscribe(w),[t,w]),Re.useEffect(()=>{l.isTransitioning&&h(new lz)},[l.isTransitioning]),Re.useEffect(()=>{if(c&&o&&t.window){let k=o,E=c.promise,T=t.window.document.startViewTransition(async()=>{y(()=>i(k)),await E});T.finished.finally(()=>{h(void 0),f(void 0),a(void 0),u({isTransitioning:!1})}),f(T)}},[y,o,c,t.window]),Re.useEffect(()=>{c&&o&&s.location.key===o.location.key&&c.resolve()},[c,d,s.location,o]),Re.useEffect(()=>{!l.isTransitioning&&p&&(a(p.state),u({isTransitioning:!0,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),v(void 0))},[l.isTransitioning,p]);let x=Re.useMemo(()=>({createHref:t.createHref,encodeLocation:t.encodeLocation,go:k=>t.navigate(k),push:(k,E,T)=>t.navigate(k,{state:E,preventScrollReset:T==null?void 0:T.preventScrollReset}),replace:(k,E,T)=>t.navigate(k,{replace:!0,state:E,preventScrollReset:T==null?void 0:T.preventScrollReset})}),[t]),b=t.basename||"/",C=Re.useMemo(()=>({router:t,navigator:x,static:!1,basename:b}),[t,x,b]);return Re.createElement(Re.Fragment,null,Re.createElement(Cg.Provider,{value:C},Re.createElement(MN.Provider,{value:s},Re.createElement(iz.Provider,{value:g.current},Re.createElement(sz.Provider,{value:l},Re.createElement(J4,{basename:b,location:s.location,navigationType:s.historyAction,navigator:x},s.initialized?Re.createElement(cz,{routes:t.routes,state:s}):e))))),null)}function cz(n){let{routes:e,state:t}=n;return V4(e,void 0,t)}var vk;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(vk||(vk={}));var yk;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(yk||(yk={}));const hz=()=>{const n=UN(),e=[{id:1,title:"Alice's Adventures in Wonderland",author:"Lewis Carroll",cover:"e-books/alice.jpg",url:"e-books/alice.epub"},{id:2,title:"Grimms' Fairy Tales",author:"Jacob Grimm and Wilhelm Grimm",cover:"e-books/grimms.png",url:"e-books/grimms.epub"},{id:3,title:"The Happy Prince and Other Tales",author:"Oscar Wilde",cover:"e-books/happy_prince.jpg",url:"e-books/happy_prince.epub"},{id:4,title:"The Jungle Book",author:"Rudyard Kipling",cover:"e-books/jungle_book.jpg",url:"e-books/jungle_book.epub"}],t=(s,i)=>{if(i.length>0){const[o,a]=i[0];if(a.type!=="application/epub+zip")return alert("Unsupported type. Please upload an epub file.");console.log(a),console.log(o),n("/Emo-chan/App",{state:{book:o.target.result}})}},r=s=>{n("/Emo-chan/App",{state:{book:s}})};return at.jsxs("div",{className:"home-page",children:[at.jsx("div",{className:"navbar-header",children:at.jsxs("div",{className:"logo",children:[" ",at.jsx("span",{role:"img","aria-label":"Emo-chan",className:"default-text",children:"(•ᴗ•❁)Emo-chan"}),at.jsx("span",{role:"img","aria-label":"Emo-chan",className:"hover-text",children:"(˃̵ᴗ˂̵❁)Emo-chan"})]})}),at.jsxs("div",{className:"home-page-header",children:[at.jsx("p",{style:{fontSize:"3rem",marginBottom:"10px"},children:"Transform your reading experience"}),at.jsx("p",{style:{fontSize:"1.5rem",margin:"10px 0",fontWeight:"350"},children:"Emo-chan analyzes your E-book texts and plays emotionally relevant instrumental music based on the current chapter"}),at.jsx("p",{style:{fontSize:"1.25rem",fontWeight:"350"},children:"Immerse yourself in a noise-free, emotion-enhanced literary journey"})]}),at.jsxs("div",{className:"upload",children:[at.jsx("div",{className:"upload-header-title",children:"Have your own E-book?"}),at.jsx("br",{}),at.jsx(XB,{as:"buffer",onChange:t,children:at.jsx("button",{className:"upload-button",children:"Upload E-book"})})]}),at.jsxs("div",{className:"books",children:[at.jsx("div",{className:"books-header",children:at.jsx("div",{className:"books-header-title",children:"Choose a book"})}),at.jsx("div",{className:"book-list",children:e.map(s=>at.jsxs("div",{className:"book cover",onClick:()=>r(s.url),children:[at.jsx("img",{src:`${s.cover}`,alt:s.title}),at.jsxs("div",{className:"book-details",children:[at.jsx("h3",{children:s.title}),at.jsx("p",{children:s.author})]})]},s.id))})]}),at.jsx("footer",{className:"copyright",children:"© 2023 CSRPITOY. All Rights Reserved."})]})};var ly={},Ig={},GN={exports:{}},dz="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",fz=dz,pz=fz;function jN(){}function HN(){}HN.resetWarningCache=jN;var mz=function(){function n(r,s,i,o,a,l){if(l!==pz){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:HN,resetWarningCache:jN};return t.PropTypes=t,t};GN.exports=mz();var qN=GN.exports,KN={},fd={},Mx={exports:{}},XN={exports:{}},gz=void 0,YN=function(n){return n!==gz&&n!==null},vz=YN,yz={object:!0,function:!0,undefined:!0},xz=function(n){return vz(n)?hasOwnProperty.call(yz,typeof n):!1},wz=xz,bz=function(n){if(!wz(n))return!1;try{return n.constructor?n.constructor.prototype===n:!1}catch{return!1}},Cz=bz,Sz=function(n){if(typeof n!="function"||!hasOwnProperty.call(n,"length"))return!1;try{if(typeof n.length!="number"||typeof n.call!="function"||typeof n.apply!="function")return!1}catch{return!1}return!Cz(n)},kz=Sz,Ez=/^\s*class[\s{/}]/,Iz=Function.prototype.toString,Tz=function(n){return!(!kz(n)||Ez.test(Iz.call(n)))},_z=function(){var n=Object.assign,e;return typeof n!="function"?!1:(e={foo:"raz"},n(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")},uy,xk;function Nz(){return xk||(xk=1,uy=function(){try{return Object.keys("primitive"),!0}catch{return!1}}),uy}var $z=function(){},Dz=$z(),Dw=function(n){return n!==Dz&&n!==null},cy,wk;function Az(){if(wk)return cy;wk=1;var n=Dw,e=Object.keys;return cy=function(t){return e(n(t)?Object(t):t)},cy}var hy,bk;function Rz(){return bk||(bk=1,hy=Nz()()?Object.keys:Az()),hy}var dy,Ck;function Oz(){if(Ck)return dy;Ck=1;var n=Dw;return dy=function(e){if(!n(e))throw new TypeError("Cannot use null or undefined");return e},dy}var fy,Sk;function Fz(){if(Sk)return fy;Sk=1;var n=Rz(),e=Oz(),t=Math.max;return fy=function(r,s){var i,o,a=t(arguments.length,2),l;for(r=Object(e(r)),l=function(u){try{r[u]=s[u]}catch(c){i||(i=c)}},o=1;o<a;++o)s=arguments[o],n(s).forEach(l);if(i!==void 0)throw i;return r},fy}var Lz=_z()?Object.assign:Fz(),Pz=Dw,Mz=Array.prototype.forEach,Bz=Object.create,zz=function(n,e){var t;for(t in n)e[t]=n[t]},Uz=function(n){var e=Bz(null);return Mz.call(arguments,function(t){Pz(t)&&zz(Object(t),e)}),e},py="razdwatrzy",Vz=function(){return typeof py.contains!="function"?!1:py.contains("dwa")===!0&&py.contains("foo")===!1},my,kk;function Wz(){if(kk)return my;kk=1;var n=String.prototype.indexOf;return my=function(e){return n.call(this,e,arguments[1])>-1},my}var Gz=Vz()?String.prototype.contains:Wz(),jp=YN,Ek=Tz,ZN=Lz,QN=Uz,bh=Gz,jz=XN.exports=function(n,e){var t,r,s,i,o;return arguments.length<2||typeof n!="string"?(i=e,e=n,n=null):i=arguments[2],jp(n)?(t=bh.call(n,"c"),r=bh.call(n,"e"),s=bh.call(n,"w")):(t=s=!0,r=!1),o={value:e,configurable:t,enumerable:r,writable:s},i?ZN(QN(i),o):o};jz.gs=function(n,e,t){var r,s,i,o;return typeof n!="string"?(i=t,t=e,e=n,n=null):i=arguments[3],jp(e)?Ek(e)?jp(t)?Ek(t)||(i=t,t=void 0):t=void 0:(i=e,e=t=void 0):e=void 0,jp(n)?(r=bh.call(n,"c"),s=bh.call(n,"e")):(r=!0,s=!1),o={get:e,set:t,configurable:r,enumerable:s},i?ZN(QN(i),o):o};var Hz=XN.exports,qz=function(n){if(typeof n!="function")throw new TypeError(n+" is not a function");return n};(function(n,e){var t=Hz,r=qz,s=Function.prototype.apply,i=Function.prototype.call,o=Object.create,a=Object.defineProperty,l=Object.defineProperties,u=Object.prototype.hasOwnProperty,c={configurable:!0,enumerable:!1,writable:!0},h,d,f,p,v,g,m;h=function(y,w){var x;return r(w),u.call(this,"__ee__")?x=this.__ee__:(x=c.value=o(null),a(this,"__ee__",c),c.value=null),x[y]?typeof x[y]=="object"?x[y].push(w):x[y]=[x[y],w]:x[y]=w,this},d=function(y,w){var x,b;return r(w),b=this,h.call(this,y,x=function(){f.call(b,y,x),s.call(w,this,arguments)}),x.__eeOnceListener__=w,this},f=function(y,w){var x,b,C,k;if(r(w),!u.call(this,"__ee__"))return this;if(x=this.__ee__,!x[y])return this;if(b=x[y],typeof b=="object")for(k=0;C=b[k];++k)(C===w||C.__eeOnceListener__===w)&&(b.length===2?x[y]=b[k?0:1]:b.splice(k,1));else(b===w||b.__eeOnceListener__===w)&&delete x[y];return this},p=function(y){var w,x,b,C,k;if(u.call(this,"__ee__")&&(C=this.__ee__[y],!!C))if(typeof C=="object"){for(x=arguments.length,k=new Array(x-1),w=1;w<x;++w)k[w-1]=arguments[w];for(C=C.slice(),w=0;b=C[w];++w)s.call(b,this,k)}else switch(arguments.length){case 1:i.call(C,this);break;case 2:i.call(C,this,arguments[1]);break;case 3:i.call(C,this,arguments[1],arguments[2]);break;default:for(x=arguments.length,k=new Array(x-1),w=1;w<x;++w)k[w-1]=arguments[w];s.call(C,this,k)}},v={on:h,once:d,off:f,emit:p},g={on:t(h),once:t(d),off:t(f),emit:t(p)},m=l({},g),n.exports=e=function(y){return y==null?o(m):l(Object(y),g)},e.methods=v})(Mx,Mx.exports);var Zi=Mx.exports,je={},pd={},Eo={},wa={};function Kz(n,e,t){if(t===void 0&&(t=Array.prototype),n&&typeof t.find=="function")return t.find.call(n,e);for(var r=0;r<n.length;r++)if(Object.prototype.hasOwnProperty.call(n,r)){var s=n[r];if(e.call(void 0,s,r,n))return s}}function Aw(n,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(n):n}var JN=Aw({HTML:"text/html",isHTML:function(n){return n===JN.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),e$=Aw({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(n){return n===e$.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});wa.find=Kz;wa.freeze=Aw;wa.MIME_TYPE=JN;wa.NAMESPACE=e$;var t$=wa,zi=t$.find,Wh=t$.NAMESPACE;function Xz(n){return n!==""}function Yz(n){return n?n.split(/[\t\n\f\r ]+/).filter(Xz):[]}function Zz(n,e){return n.hasOwnProperty(e)||(n[e]=!0),n}function Ik(n){if(!n)return[];var e=Yz(n);return Object.keys(e.reduce(Zz,{}))}function Qz(n){return function(e){return n&&n.indexOf(e)!==-1}}function md(n,e){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}function is(n,e){var t=n.prototype;if(!(t instanceof e)){let s=function(){};var r=s;s.prototype=e.prototype,s=new s,md(t,s),n.prototype=t=s}t.constructor!=n&&(typeof n!="function"&&console.error("unknown Class:"+n),t.constructor=n)}var os={},di=os.ELEMENT_NODE=1,Vu=os.ATTRIBUTE_NODE=2,Sm=os.TEXT_NODE=3,n$=os.CDATA_SECTION_NODE=4,r$=os.ENTITY_REFERENCE_NODE=5,Jz=os.ENTITY_NODE=6,s$=os.PROCESSING_INSTRUCTION_NODE=7,i$=os.COMMENT_NODE=8,o$=os.DOCUMENT_NODE=9,a$=os.DOCUMENT_TYPE_NODE=10,vo=os.DOCUMENT_FRAGMENT_NODE=11,eU=os.NOTATION_NODE=12,Nr={},or={};Nr.INDEX_SIZE_ERR=(or[1]="Index size error",1);Nr.DOMSTRING_SIZE_ERR=(or[2]="DOMString size error",2);var Kr=Nr.HIERARCHY_REQUEST_ERR=(or[3]="Hierarchy request error",3);Nr.WRONG_DOCUMENT_ERR=(or[4]="Wrong document",4);Nr.INVALID_CHARACTER_ERR=(or[5]="Invalid character",5);Nr.NO_DATA_ALLOWED_ERR=(or[6]="No data allowed",6);Nr.NO_MODIFICATION_ALLOWED_ERR=(or[7]="No modification allowed",7);var l$=Nr.NOT_FOUND_ERR=(or[8]="Not found",8);Nr.NOT_SUPPORTED_ERR=(or[9]="Not supported",9);var Tk=Nr.INUSE_ATTRIBUTE_ERR=(or[10]="Attribute in use",10);Nr.INVALID_STATE_ERR=(or[11]="Invalid state",11);Nr.SYNTAX_ERR=(or[12]="Syntax error",12);Nr.INVALID_MODIFICATION_ERR=(or[13]="Invalid modification",13);Nr.NAMESPACE_ERR=(or[14]="Invalid namespace",14);Nr.INVALID_ACCESS_ERR=(or[15]="Invalid access",15);function $n(n,e){if(e instanceof Error)var t=e;else t=this,Error.call(this,or[n]),this.message=or[n],Error.captureStackTrace&&Error.captureStackTrace(this,$n);return t.code=n,e&&(this.message=this.message+": "+e),t}$n.prototype=Error.prototype;md(Nr,$n);function ho(){}ho.prototype={length:0,item:function(n){return n>=0&&n<this.length?this[n]:null},toString:function(n,e){for(var t=[],r=0;r<this.length;r++)wu(this[r],t,n,e);return t.join("")},filter:function(n){return Array.prototype.filter.call(this,n)},indexOf:function(n){return Array.prototype.indexOf.call(this,n)}};function Wu(n,e){this._node=n,this._refresh=e,Rw(this)}function Rw(n){var e=n._node._inc||n._node.ownerDocument._inc;if(n._inc!==e){var t=n._refresh(n._node);if(w$(n,"length",t.length),!n.$$length||t.length<n.$$length)for(var r=t.length;r in n;r++)Object.prototype.hasOwnProperty.call(n,r)&&delete n[r];md(t,n),n._inc=e}}Wu.prototype.item=function(n){return Rw(this),this[n]||null};is(Wu,ho);function km(){}function u$(n,e){for(var t=n.length;t--;)if(n[t]===e)return t}function _k(n,e,t,r){if(r?e[u$(e,r)]=t:e[e.length++]=t,n){t.ownerElement=n;var s=n.ownerDocument;s&&(r&&d$(s,n,r),tU(s,n,t))}}function Nk(n,e,t){var r=u$(e,t);if(r>=0){for(var s=e.length-1;r<s;)e[r]=e[++r];if(e.length=s,n){var i=n.ownerDocument;i&&(d$(i,n,t),t.ownerElement=null)}}else throw new $n(l$,new Error(n.tagName+"@"+t))}km.prototype={length:0,item:ho.prototype.item,getNamedItem:function(n){for(var e=this.length;e--;){var t=this[e];if(t.nodeName==n)return t}},setNamedItem:function(n){var e=n.ownerElement;if(e&&e!=this._ownerElement)throw new $n(Tk);var t=this.getNamedItem(n.nodeName);return _k(this._ownerElement,this,n,t),t},setNamedItemNS:function(n){var e=n.ownerElement,t;if(e&&e!=this._ownerElement)throw new $n(Tk);return t=this.getNamedItemNS(n.namespaceURI,n.localName),_k(this._ownerElement,this,n,t),t},removeNamedItem:function(n){var e=this.getNamedItem(n);return Nk(this._ownerElement,this,e),e},removeNamedItemNS:function(n,e){var t=this.getNamedItemNS(n,e);return Nk(this._ownerElement,this,t),t},getNamedItemNS:function(n,e){for(var t=this.length;t--;){var r=this[t];if(r.localName==e&&r.namespaceURI==n)return r}return null}};function c$(){}c$.prototype={hasFeature:function(n,e){return!0},createDocument:function(n,e,t){var r=new gd;if(r.implementation=this,r.childNodes=new ho,r.doctype=t||null,t&&r.appendChild(t),e){var s=r.createElementNS(n,e);r.appendChild(s)}return r},createDocumentType:function(n,e,t){var r=new Tg;return r.name=n,r.nodeName=n,r.publicId=e||"",r.systemId=t||"",r}};function zt(){}zt.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(n,e){return Em(this,n,e)},replaceChild:function(n,e){Em(this,n,e,p$),e&&this.removeChild(e)},removeChild:function(n){return f$(this,n)},appendChild:function(n){return this.insertBefore(n,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(n){return Bx(this.ownerDocument||this,this,n)},normalize:function(){for(var n=this.firstChild;n;){var e=n.nextSibling;e&&e.nodeType==Sm&&n.nodeType==Sm?(this.removeChild(e),n.appendData(e.data)):(n.normalize(),n=e)}},isSupported:function(n,e){return this.ownerDocument.implementation.hasFeature(n,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(n){for(var e=this;e;){var t=e._nsMap;if(t){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&t[r]===n)return r}e=e.nodeType==Vu?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(n){for(var e=this;e;){var t=e._nsMap;if(t&&n in t&&Object.prototype.hasOwnProperty.call(t,n))return t[n];e=e.nodeType==Vu?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(n){var e=this.lookupPrefix(n);return e==null}};function h$(n){return n=="<"&&"&lt;"||n==">"&&"&gt;"||n=="&"&&"&amp;"||n=='"'&&"&quot;"||"&#"+n.charCodeAt()+";"}md(os,zt);md(os,zt.prototype);function Gh(n,e){if(e(n))return!0;if(n=n.firstChild)do if(Gh(n,e))return!0;while(n=n.nextSibling)}function gd(){this.ownerDocument=this}function tU(n,e,t){n&&n._inc++;var r=t.namespaceURI;r===Wh.XMLNS&&(e._nsMap[t.prefix?t.localName:""]=t.value)}function d$(n,e,t,r){n&&n._inc++;var s=t.namespaceURI;s===Wh.XMLNS&&delete e._nsMap[t.prefix?t.localName:""]}function Ow(n,e,t){if(n&&n._inc){n._inc++;var r=e.childNodes;if(t)r[r.length++]=t;else{for(var s=e.firstChild,i=0;s;)r[i++]=s,s=s.nextSibling;r.length=i,delete r[r.length]}}}function f$(n,e){var t=e.previousSibling,r=e.nextSibling;return t?t.nextSibling=r:n.firstChild=r,r?r.previousSibling=t:n.lastChild=t,e.parentNode=null,e.previousSibling=null,e.nextSibling=null,Ow(n.ownerDocument,n),e}function nU(n){return n&&(n.nodeType===zt.DOCUMENT_NODE||n.nodeType===zt.DOCUMENT_FRAGMENT_NODE||n.nodeType===zt.ELEMENT_NODE)}function rU(n){return n&&(Ui(n)||Fw(n)||yo(n)||n.nodeType===zt.DOCUMENT_FRAGMENT_NODE||n.nodeType===zt.COMMENT_NODE||n.nodeType===zt.PROCESSING_INSTRUCTION_NODE)}function yo(n){return n&&n.nodeType===zt.DOCUMENT_TYPE_NODE}function Ui(n){return n&&n.nodeType===zt.ELEMENT_NODE}function Fw(n){return n&&n.nodeType===zt.TEXT_NODE}function $k(n,e){var t=n.childNodes||[];if(zi(t,Ui)||yo(e))return!1;var r=zi(t,yo);return!(e&&r&&t.indexOf(r)>t.indexOf(e))}function Dk(n,e){var t=n.childNodes||[];function r(i){return Ui(i)&&i!==e}if(zi(t,r))return!1;var s=zi(t,yo);return!(e&&s&&t.indexOf(s)>t.indexOf(e))}function sU(n,e,t){if(!nU(n))throw new $n(Kr,"Unexpected parent node type "+n.nodeType);if(t&&t.parentNode!==n)throw new $n(l$,"child not in parent");if(!rU(e)||yo(e)&&n.nodeType!==zt.DOCUMENT_NODE)throw new $n(Kr,"Unexpected node type "+e.nodeType+" for parent node type "+n.nodeType)}function iU(n,e,t){var r=n.childNodes||[],s=e.childNodes||[];if(e.nodeType===zt.DOCUMENT_FRAGMENT_NODE){var i=s.filter(Ui);if(i.length>1||zi(s,Fw))throw new $n(Kr,"More than one element or text in fragment");if(i.length===1&&!$k(n,t))throw new $n(Kr,"Element in fragment can not be inserted before doctype")}if(Ui(e)&&!$k(n,t))throw new $n(Kr,"Only one element can be added and only after doctype");if(yo(e)){if(zi(r,yo))throw new $n(Kr,"Only one doctype is allowed");var o=zi(r,Ui);if(t&&r.indexOf(o)<r.indexOf(t))throw new $n(Kr,"Doctype can only be inserted before an element");if(!t&&o)throw new $n(Kr,"Doctype can not be appended since element is present")}}function p$(n,e,t){var r=n.childNodes||[],s=e.childNodes||[];if(e.nodeType===zt.DOCUMENT_FRAGMENT_NODE){var i=s.filter(Ui);if(i.length>1||zi(s,Fw))throw new $n(Kr,"More than one element or text in fragment");if(i.length===1&&!Dk(n,t))throw new $n(Kr,"Element in fragment can not be inserted before doctype")}if(Ui(e)&&!Dk(n,t))throw new $n(Kr,"Only one element can be added and only after doctype");if(yo(e)){let l=function(u){return yo(u)&&u!==t};var a=l;if(zi(r,l))throw new $n(Kr,"Only one doctype is allowed");var o=zi(r,Ui);if(t&&r.indexOf(o)<r.indexOf(t))throw new $n(Kr,"Doctype can only be inserted before an element")}}function Em(n,e,t,r){sU(n,e,t),n.nodeType===zt.DOCUMENT_NODE&&(r||iU)(n,e,t);var s=e.parentNode;if(s&&s.removeChild(e),e.nodeType===vo){var i=e.firstChild;if(i==null)return e;var o=e.lastChild}else i=o=e;var a=t?t.previousSibling:n.lastChild;i.previousSibling=a,o.nextSibling=t,a?a.nextSibling=i:n.firstChild=i,t==null?n.lastChild=o:t.previousSibling=o;do i.parentNode=n;while(i!==o&&(i=i.nextSibling));return Ow(n.ownerDocument||n,n),e.nodeType==vo&&(e.firstChild=e.lastChild=null),e}function oU(n,e){return e.parentNode&&e.parentNode.removeChild(e),e.parentNode=n,e.previousSibling=n.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:n.firstChild=e,n.lastChild=e,Ow(n.ownerDocument,n,e),e}gd.prototype={nodeName:"#document",nodeType:o$,doctype:null,documentElement:null,_inc:1,insertBefore:function(n,e){if(n.nodeType==vo){for(var t=n.firstChild;t;){var r=t.nextSibling;this.insertBefore(t,e),t=r}return n}return Em(this,n,e),n.ownerDocument=this,this.documentElement===null&&n.nodeType===di&&(this.documentElement=n),n},removeChild:function(n){return this.documentElement==n&&(this.documentElement=null),f$(this,n)},replaceChild:function(n,e){Em(this,n,e,p$),n.ownerDocument=this,e&&this.removeChild(e),Ui(n)&&(this.documentElement=n)},importNode:function(n,e){return x$(this,n,e)},getElementById:function(n){var e=null;return Gh(this.documentElement,function(t){if(t.nodeType==di&&t.getAttribute("id")==n)return e=t,!0}),e},getElementsByClassName:function(n){var e=Ik(n);return new Wu(this,function(t){var r=[];return e.length>0&&Gh(t.documentElement,function(s){if(s!==t&&s.nodeType===di){var i=s.getAttribute("class");if(i){var o=n===i;if(!o){var a=Ik(i);o=e.every(Qz(a))}o&&r.push(s)}}}),r})},createElement:function(n){var e=new al;e.ownerDocument=this,e.nodeName=n,e.tagName=n,e.localName=n,e.childNodes=new ho;var t=e.attributes=new km;return t._ownerElement=e,e},createDocumentFragment:function(){var n=new _g;return n.ownerDocument=this,n.childNodes=new ho,n},createTextNode:function(n){var e=new Lw;return e.ownerDocument=this,e.appendData(n),e},createComment:function(n){var e=new Pw;return e.ownerDocument=this,e.appendData(n),e},createCDATASection:function(n){var e=new Mw;return e.ownerDocument=this,e.appendData(n),e},createProcessingInstruction:function(n,e){var t=new zw;return t.ownerDocument=this,t.tagName=t.nodeName=t.target=n,t.nodeValue=t.data=e,t},createAttribute:function(n){var e=new Im;return e.ownerDocument=this,e.name=n,e.nodeName=n,e.localName=n,e.specified=!0,e},createEntityReference:function(n){var e=new Bw;return e.ownerDocument=this,e.nodeName=n,e},createElementNS:function(n,e){var t=new al,r=e.split(":"),s=t.attributes=new km;return t.childNodes=new ho,t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.namespaceURI=n,r.length==2?(t.prefix=r[0],t.localName=r[1]):t.localName=e,s._ownerElement=t,t},createAttributeNS:function(n,e){var t=new Im,r=e.split(":");return t.ownerDocument=this,t.nodeName=e,t.name=e,t.namespaceURI=n,t.specified=!0,r.length==2?(t.prefix=r[0],t.localName=r[1]):t.localName=e,t}};is(gd,zt);function al(){this._nsMap={}}al.prototype={nodeType:di,hasAttribute:function(n){return this.getAttributeNode(n)!=null},getAttribute:function(n){var e=this.getAttributeNode(n);return e&&e.value||""},getAttributeNode:function(n){return this.attributes.getNamedItem(n)},setAttribute:function(n,e){var t=this.ownerDocument.createAttribute(n);t.value=t.nodeValue=""+e,this.setAttributeNode(t)},removeAttribute:function(n){var e=this.getAttributeNode(n);e&&this.removeAttributeNode(e)},appendChild:function(n){return n.nodeType===vo?this.insertBefore(n,null):oU(this,n)},setAttributeNode:function(n){return this.attributes.setNamedItem(n)},setAttributeNodeNS:function(n){return this.attributes.setNamedItemNS(n)},removeAttributeNode:function(n){return this.attributes.removeNamedItem(n.nodeName)},removeAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);t&&this.removeAttributeNode(t)},hasAttributeNS:function(n,e){return this.getAttributeNodeNS(n,e)!=null},getAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);return t&&t.value||""},setAttributeNS:function(n,e,t){var r=this.ownerDocument.createAttributeNS(n,e);r.value=r.nodeValue=""+t,this.setAttributeNode(r)},getAttributeNodeNS:function(n,e){return this.attributes.getNamedItemNS(n,e)},getElementsByTagName:function(n){return new Wu(this,function(e){var t=[];return Gh(e,function(r){r!==e&&r.nodeType==di&&(n==="*"||r.tagName==n)&&t.push(r)}),t})},getElementsByTagNameNS:function(n,e){return new Wu(this,function(t){var r=[];return Gh(t,function(s){s!==t&&s.nodeType===di&&(n==="*"||s.namespaceURI===n)&&(e==="*"||s.localName==e)&&r.push(s)}),r})}};gd.prototype.getElementsByTagName=al.prototype.getElementsByTagName;gd.prototype.getElementsByTagNameNS=al.prototype.getElementsByTagNameNS;is(al,zt);function Im(){}Im.prototype.nodeType=Vu;is(Im,zt);function vd(){}vd.prototype={data:"",substringData:function(n,e){return this.data.substring(n,n+e)},appendData:function(n){n=this.data+n,this.nodeValue=this.data=n,this.length=n.length},insertData:function(n,e){this.replaceData(n,0,e)},appendChild:function(n){throw new Error(or[Kr])},deleteData:function(n,e){this.replaceData(n,e,"")},replaceData:function(n,e,t){var r=this.data.substring(0,n),s=this.data.substring(n+e);t=r+t+s,this.nodeValue=this.data=t,this.length=t.length}};is(vd,zt);function Lw(){}Lw.prototype={nodeName:"#text",nodeType:Sm,splitText:function(n){var e=this.data,t=e.substring(n);e=e.substring(0,n),this.data=this.nodeValue=e,this.length=e.length;var r=this.ownerDocument.createTextNode(t);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}};is(Lw,vd);function Pw(){}Pw.prototype={nodeName:"#comment",nodeType:i$};is(Pw,vd);function Mw(){}Mw.prototype={nodeName:"#cdata-section",nodeType:n$};is(Mw,vd);function Tg(){}Tg.prototype.nodeType=a$;is(Tg,zt);function m$(){}m$.prototype.nodeType=eU;is(m$,zt);function g$(){}g$.prototype.nodeType=Jz;is(g$,zt);function Bw(){}Bw.prototype.nodeType=r$;is(Bw,zt);function _g(){}_g.prototype.nodeName="#document-fragment";_g.prototype.nodeType=vo;is(_g,zt);function zw(){}zw.prototype.nodeType=s$;is(zw,zt);function v$(){}v$.prototype.serializeToString=function(n,e,t){return y$.call(n,e,t)};zt.prototype.toString=y$;function y$(n,e){var t=[],r=this.nodeType==9&&this.documentElement||this,s=r.prefix,i=r.namespaceURI;if(i&&s==null){var s=r.lookupPrefix(i);if(s==null)var o=[{namespace:i,prefix:null}]}return wu(this,t,n,e,o),t.join("")}function Ak(n,e,t){var r=n.prefix||"",s=n.namespaceURI;if(!s||r==="xml"&&s===Wh.XML||s===Wh.XMLNS)return!1;for(var i=t.length;i--;){var o=t[i];if(o.prefix===r)return o.namespace!==s}return!0}function gy(n,e,t){n.push(" ",e,'="',t.replace(/[<&"]/g,h$),'"')}function wu(n,e,t,r,s){if(s||(s=[]),r)if(n=r(n),n){if(typeof n=="string"){e.push(n);return}}else return;switch(n.nodeType){case di:var i=n.attributes,o=i.length,m=n.firstChild,a=n.tagName;t=Wh.isHTML(n.namespaceURI)||t;var l=a;if(!t&&!n.prefix&&n.namespaceURI){for(var u,c=0;c<i.length;c++)if(i.item(c).name==="xmlns"){u=i.item(c).value;break}if(!u)for(var h=s.length-1;h>=0;h--){var d=s[h];if(d.prefix===""&&d.namespace===n.namespaceURI){u=d.namespace;break}}if(u!==n.namespaceURI)for(var h=s.length-1;h>=0;h--){var d=s[h];if(d.namespace===n.namespaceURI){d.prefix&&(l=d.prefix+":"+a);break}}}e.push("<",l);for(var f=0;f<o;f++){var p=i.item(f);p.prefix=="xmlns"?s.push({prefix:p.localName,namespace:p.value}):p.nodeName=="xmlns"&&s.push({prefix:"",namespace:p.value})}for(var f=0;f<o;f++){var p=i.item(f);if(Ak(p,t,s)){var v=p.prefix||"",g=p.namespaceURI;gy(e,v?"xmlns:"+v:"xmlns",g),s.push({prefix:v,namespace:g})}wu(p,e,t,r,s)}if(a===l&&Ak(n,t,s)){var v=n.prefix||"",g=n.namespaceURI;gy(e,v?"xmlns:"+v:"xmlns",g),s.push({prefix:v,namespace:g})}if(m||t&&!/^(?:meta|link|img|br|hr|input)$/i.test(a)){if(e.push(">"),t&&/^script$/i.test(a))for(;m;)m.data?e.push(m.data):wu(m,e,t,r,s.slice()),m=m.nextSibling;else for(;m;)wu(m,e,t,r,s.slice()),m=m.nextSibling;e.push("</",l,">")}else e.push("/>");return;case o$:case vo:for(var m=n.firstChild;m;)wu(m,e,t,r,s.slice()),m=m.nextSibling;return;case Vu:return gy(e,n.name,n.value);case Sm:return e.push(n.data.replace(/[<&]/g,h$).replace(/]]>/g,"]]&gt;"));case n$:return e.push("<![CDATA[",n.data,"]]>");case i$:return e.push("<!--",n.data,"-->");case a$:var y=n.publicId,w=n.systemId;if(e.push("<!DOCTYPE ",n.name),y)e.push(" PUBLIC ",y),w&&w!="."&&e.push(" ",w),e.push(">");else if(w&&w!=".")e.push(" SYSTEM ",w,">");else{var x=n.internalSubset;x&&e.push(" [",x,"]"),e.push(">")}return;case s$:return e.push("<?",n.target," ",n.data,"?>");case r$:return e.push("&",n.nodeName,";");default:e.push("??",n.nodeName)}}function x$(n,e,t){var r;switch(e.nodeType){case di:r=e.cloneNode(!1),r.ownerDocument=n;case vo:break;case Vu:t=!0;break}if(r||(r=e.cloneNode(!1)),r.ownerDocument=n,r.parentNode=null,t)for(var s=e.firstChild;s;)r.appendChild(x$(n,s,t)),s=s.nextSibling;return r}function Bx(n,e,t){var r=new e.constructor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var i=e[s];typeof i!="object"&&i!=r[s]&&(r[s]=i)}switch(e.childNodes&&(r.childNodes=new ho),r.ownerDocument=n,r.nodeType){case di:var o=e.attributes,a=r.attributes=new km,l=o.length;a._ownerElement=r;for(var u=0;u<l;u++)r.setAttributeNode(Bx(n,o.item(u),!0));break;case Vu:t=!0}if(t)for(var c=e.firstChild;c;)r.appendChild(Bx(n,c,t)),c=c.nextSibling;return r}function w$(n,e,t){n[e]=t}try{if(Object.defineProperty){let n=function(e){switch(e.nodeType){case di:case vo:var t=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&t.push(n(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}};var r0e=n;Object.defineProperty(Wu.prototype,"length",{get:function(){return Rw(this),this.$$length}}),Object.defineProperty(zt.prototype,"textContent",{get:function(){return n(this)},set:function(e){switch(this.nodeType){case di:case vo:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),w$=function(e,t,r){e["$$"+t]=r}}}catch{}Eo.DocumentType=Tg;Eo.DOMException=$n;Eo.DOMImplementation=c$;Eo.Element=al;Eo.Node=zt;Eo.NodeList=ho;Eo.XMLSerializer=v$;var yd={},b$={};(function(n){var e=wa.freeze;n.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),n.HTML_ENTITIES=e({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"	",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),n.entityMap=n.HTML_ENTITIES})(b$);var Uw={},jh=wa.NAMESPACE,zx=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Rk=new RegExp("[\\-\\.0-9"+zx.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),Ok=new RegExp("^"+zx.source+Rk.source+"*(?::"+zx.source+Rk.source+"*)?$"),Vc=0,Do=1,Hl=2,Wc=3,ql=4,Kl=5,Gc=6,fp=7;function Gu(n,e){this.message=n,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,Gu)}Gu.prototype=new Error;Gu.prototype.name=Gu.name;function C$(){}C$.prototype={parse:function(n,e,t){var r=this.domBuilder;r.startDocument(),S$(e,e={}),aU(n,e,t,r,this.errorHandler),r.endDocument()}};function aU(n,e,t,r,s){function i(M){if(M>65535){M-=65536;var W=55296+(M>>10),D=56320+(M&1023);return String.fromCharCode(W,D)}else return String.fromCharCode(M)}function o(M){var W=M.slice(1,-1);return W in t?t[W]:W.charAt(0)==="#"?i(parseInt(W.substr(1).replace("x","0x"))):(s.error("entity not found:"+M),M)}function a(M){if(M>v){var W=n.substring(v,M).replace(/&#?\w+;/g,o);d&&l(v),r.characters(W,0,M-v),v=M}}function l(M,W){for(;M>=c&&(W=h.exec(n));)u=W.index,c=u+W[0].length,d.lineNumber++;d.columnNumber=M-u+1}for(var u=0,c=0,h=/.*(?:\r\n?|\n)|.*$/g,d=r.locator,f=[{currentNSMap:e}],p={},v=0;;){try{var g=n.indexOf("<",v);if(g<0){if(!n.substr(v).match(/^\s*$/)){var m=r.doc,y=m.createTextNode(n.substr(v));m.appendChild(y),r.currentElement=y}return}switch(g>v&&a(g),n.charAt(g+1)){case"/":var A=n.indexOf(">",g+3),w=n.substring(g+2,A).replace(/[ \t\n\r]+$/g,""),x=f.pop();A<0?(w=n.substring(g+2).replace(/[\s<].*/,""),s.error("end tag name: "+w+" is not complete:"+x.tagName),A=g+1+w.length):w.match(/\s</)&&(w=w.replace(/[\s<].*/,""),s.error("end tag name: "+w+" maybe not complete"),A=g+1+w.length);var b=x.localNSMap,C=x.tagName==w,k=C||x.tagName&&x.tagName.toLowerCase()==w.toLowerCase();if(k){if(r.endElement(x.uri,x.localName,w),b)for(var E in b)Object.prototype.hasOwnProperty.call(b,E)&&r.endPrefixMapping(E);C||s.fatalError("end tag name: "+w+" is not match the current start tagName:"+x.tagName)}else f.push(x);A++;break;case"?":d&&l(g),A=dU(n,g,r);break;case"!":d&&l(g),A=hU(n,g,r,s);break;default:d&&l(g);var T=new k$,_=f[f.length-1].currentNSMap,A=lU(n,g,T,_,o,s),P=T.length;if(!T.closed&&cU(n,A,T.tagName,p)&&(T.closed=!0,t.nbsp||s.warning("unclosed xml attribute")),d&&P){for(var j=Fk(d,{}),X=0;X<P;X++){var F=T[X];l(F.offset),F.locator=Fk(d,{})}r.locator=j,Lk(T,r,_)&&f.push(T),r.locator=d}else Lk(T,r,_)&&f.push(T);jh.isHTML(T.uri)&&!T.closed?A=uU(n,A,T.tagName,o,r):A++}}catch(M){if(M instanceof Gu)throw M;s.error("element parse error: "+M),A=-1}A>v?v=A:a(Math.max(g,v)+1)}}function Fk(n,e){return e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber,e}function lU(n,e,t,r,s,i){function o(d,f,p){t.attributeNames.hasOwnProperty(d)&&i.fatalError("Attribute "+d+" redefined"),t.addValue(d,f,p)}for(var a,l,u=++e,c=Vc;;){var h=n.charAt(u);switch(h){case"=":if(c===Do)a=n.slice(e,u),c=Wc;else if(c===Hl)c=Wc;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(c===Wc||c===Do)if(c===Do&&(i.warning('attribute value must after "="'),a=n.slice(e,u)),e=u+1,u=n.indexOf(h,e),u>0)l=n.slice(e,u).replace(/&#?\w+;/g,s),o(a,l,e-1),c=Kl;else throw new Error("attribute value no end '"+h+"' match");else if(c==ql)l=n.slice(e,u).replace(/&#?\w+;/g,s),o(a,l,e),i.warning('attribute "'+a+'" missed start quot('+h+")!!"),e=u+1,c=Kl;else throw new Error('attribute value must after "="');break;case"/":switch(c){case Vc:t.setTagName(n.slice(e,u));case Kl:case Gc:case fp:c=fp,t.closed=!0;case ql:case Do:break;case Hl:t.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return i.error("unexpected end of input"),c==Vc&&t.setTagName(n.slice(e,u)),u;case">":switch(c){case Vc:t.setTagName(n.slice(e,u));case Kl:case Gc:case fp:break;case ql:case Do:l=n.slice(e,u),l.slice(-1)==="/"&&(t.closed=!0,l=l.slice(0,-1));case Hl:c===Hl&&(l=a),c==ql?(i.warning('attribute "'+l+'" missed quot(")!'),o(a,l.replace(/&#?\w+;/g,s),e)):((!jh.isHTML(r[""])||!l.match(/^(?:disabled|checked|selected)$/i))&&i.warning('attribute "'+l+'" missed value!! "'+l+'" instead!!'),o(l,l,e));break;case Wc:throw new Error("attribute value missed!!")}return u;case"":h=" ";default:if(h<=" ")switch(c){case Vc:t.setTagName(n.slice(e,u)),c=Gc;break;case Do:a=n.slice(e,u),c=Hl;break;case ql:var l=n.slice(e,u).replace(/&#?\w+;/g,s);i.warning('attribute "'+l+'" missed quot(")!!'),o(a,l,e);case Kl:c=Gc;break}else switch(c){case Hl:t.tagName,(!jh.isHTML(r[""])||!a.match(/^(?:disabled|checked|selected)$/i))&&i.warning('attribute "'+a+'" missed value!! "'+a+'" instead2!!'),o(a,a,e),e=u,c=Do;break;case Kl:i.warning('attribute space is required"'+a+'"!!');case Gc:c=Do,e=u;break;case Wc:c=ql,e=u;break;case fp:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function Lk(n,e,t){for(var r=n.tagName,s=null,h=n.length;h--;){var i=n[h],o=i.qName,a=i.value,d=o.indexOf(":");if(d>0)var l=i.prefix=o.slice(0,d),u=o.slice(d+1),c=l==="xmlns"&&u;else u=o,l=null,c=o==="xmlns"&&"";i.localName=u,c!==!1&&(s==null&&(s={},S$(t,t={})),t[c]=s[c]=a,i.uri=jh.XMLNS,e.startPrefixMapping(c,a))}for(var h=n.length;h--;){i=n[h];var l=i.prefix;l&&(l==="xml"&&(i.uri=jh.XML),l!=="xmlns"&&(i.uri=t[l||""]))}var d=r.indexOf(":");d>0?(l=n.prefix=r.slice(0,d),u=n.localName=r.slice(d+1)):(l=null,u=n.localName=r);var f=n.uri=t[l||""];if(e.startElement(f,u,r,n),n.closed){if(e.endElement(f,u,r),s)for(l in s)Object.prototype.hasOwnProperty.call(s,l)&&e.endPrefixMapping(l)}else return n.currentNSMap=t,n.localNSMap=s,!0}function uU(n,e,t,r,s){if(/^(?:script|textarea)$/i.test(t)){var i=n.indexOf("</"+t+">",e),o=n.substring(e+1,i);if(/[&<]/.test(o))return/^script$/i.test(t)?(s.characters(o,0,o.length),i):(o=o.replace(/&#?\w+;/g,r),s.characters(o,0,o.length),i)}return e+1}function cU(n,e,t,r){var s=r[t];return s==null&&(s=n.lastIndexOf("</"+t+">"),s<e&&(s=n.lastIndexOf("</"+t)),r[t]=s),s<e}function S$(n,e){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}function hU(n,e,t,r){var s=n.charAt(e+2);switch(s){case"-":if(n.charAt(e+3)==="-"){var i=n.indexOf("-->",e+4);return i>e?(t.comment(n,e+4,i-e-4),i+3):(r.error("Unclosed comment"),-1)}else return-1;default:if(n.substr(e+3,6)=="CDATA["){var i=n.indexOf("]]>",e+9);return t.startCDATA(),t.characters(n,e+9,i-e-9),t.endCDATA(),i+3}var o=fU(n,e),a=o.length;if(a>1&&/!doctype/i.test(o[0][0])){var l=o[1][0],u=!1,c=!1;a>3&&(/^public$/i.test(o[2][0])?(u=o[3][0],c=a>4&&o[4][0]):/^system$/i.test(o[2][0])&&(c=o[3][0]));var h=o[a-1];return t.startDTD(l,u,c),t.endDTD(),h.index+h[0].length}}return-1}function dU(n,e,t){var r=n.indexOf("?>",e);if(r){var s=n.substring(e,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return s?(s[0].length,t.processingInstruction(s[1],s[2]),r+2):-1}return-1}function k$(){this.attributeNames={}}k$.prototype={setTagName:function(n){if(!Ok.test(n))throw new Error("invalid tagName:"+n);this.tagName=n},addValue:function(n,e,t){if(!Ok.test(n))throw new Error("invalid attribute:"+n);this.attributeNames[n]=this.length,this[this.length++]={qName:n,value:e,offset:t}},length:0,getLocalName:function(n){return this[n].localName},getLocator:function(n){return this[n].locator},getQName:function(n){return this[n].qName},getURI:function(n){return this[n].uri},getValue:function(n){return this[n].value}};function fU(n,e){var t,r=[],s=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(s.lastIndex=e,s.exec(n);t=s.exec(n);)if(r.push(t),t[1])return r}Uw.XMLReader=C$;Uw.ParseError=Gu;var pU=wa,Vw=Eo,Pk=b$,E$=Uw,mU=Vw.DOMImplementation,Mk=pU.NAMESPACE,gU=E$.ParseError,vU=E$.XMLReader;function I$(n){this.options=n||{locator:{}}}I$.prototype.parseFromString=function(n,e){var t=this.options,r=new vU,s=t.domBuilder||new xd,i=t.errorHandler,o=t.locator,a=t.xmlns||{},l=/\/x?html?$/.test(e),u=l?Pk.HTML_ENTITIES:Pk.XML_ENTITIES;return o&&s.setDocumentLocator(o),r.errorHandler=yU(i,s,o),r.domBuilder=t.domBuilder||s,l&&(a[""]=Mk.HTML),a.xml=a.xml||Mk.XML,n&&typeof n=="string"?r.parse(n,a,u):r.errorHandler.error("invalid doc source"),s.doc};function yU(n,e,t){if(!n){if(e instanceof xd)return e;n=e}var r={},s=n instanceof Function;t=t||{};function i(o){var a=n[o];!a&&s&&(a=n.length==2?function(l){n(o,l)}:n),r[o]=a&&function(l){a("[xmldom "+o+"]	"+l+Ux(t))}||function(){}}return i("warning"),i("error"),i("fatalError"),r}function xd(){this.cdata=!1}function Xl(n,e){e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber}xd.prototype={startDocument:function(){this.doc=new mU().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(n,e,t,r){var s=this.doc,i=s.createElementNS(n,t||e),o=r.length;pp(this,i),this.currentElement=i,this.locator&&Xl(this.locator,i);for(var a=0;a<o;a++){var n=r.getURI(a),l=r.getValue(a),t=r.getQName(a),u=s.createAttributeNS(n,t);this.locator&&Xl(r.getLocator(a),u),u.value=u.nodeValue=l,i.setAttributeNode(u)}},endElement:function(n,e,t){var r=this.currentElement;r.tagName,this.currentElement=r.parentNode},startPrefixMapping:function(n,e){},endPrefixMapping:function(n){},processingInstruction:function(n,e){var t=this.doc.createProcessingInstruction(n,e);this.locator&&Xl(this.locator,t),pp(this,t)},ignorableWhitespace:function(n,e,t){},characters:function(n,e,t){if(n=Bk.apply(this,arguments),n){if(this.cdata)var r=this.doc.createCDATASection(n);else var r=this.doc.createTextNode(n);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(n)&&this.doc.appendChild(r),this.locator&&Xl(this.locator,r)}},skippedEntity:function(n){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(n){(this.locator=n)&&(n.lineNumber=0)},comment:function(n,e,t){n=Bk.apply(this,arguments);var r=this.doc.createComment(n);this.locator&&Xl(this.locator,r),pp(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(n,e,t){var r=this.doc.implementation;if(r&&r.createDocumentType){var s=r.createDocumentType(n,e,t);this.locator&&Xl(this.locator,s),pp(this,s),this.doc.doctype=s}},warning:function(n){console.warn("[xmldom warning]	"+n,Ux(this.locator))},error:function(n){console.error("[xmldom error]	"+n,Ux(this.locator))},fatalError:function(n){throw new gU(n,this.locator)}};function Ux(n){if(n)return`
@`+(n.systemId||"")+"#[line:"+n.lineNumber+",col:"+n.columnNumber+"]"}function Bk(n,e,t){return typeof n=="string"?n.substr(e,t):n.length>=e+t||e?new java.lang.String(n,e,t)+"":n}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(n){xd.prototype[n]=function(){return null}});function pp(n,e){n.currentElement?n.currentElement.appendChild(e):n.doc.appendChild(e)}yd.__DOMHandler=xd;yd.DOMParser=I$;yd.DOMImplementation=Vw.DOMImplementation;yd.XMLSerializer=Vw.XMLSerializer;var T$=Eo;pd.DOMImplementation=T$.DOMImplementation;pd.XMLSerializer=T$.XMLSerializer;pd.DOMParser=yd.DOMParser;Object.defineProperty(je,"__esModule",{value:!0});je.RangeObject=void 0;je.blob2base64=jU;je.borders=DU;je.bounds=$U;je.createBase64Url=BU;je.createBlob=D$;je.createBlobUrl=PU;je.defaults=TU;je.defer=HU;je.documentHeight=SU;je.extend=_U;je.filterChildren=XU;je.findChildren=KU;je.getParentByTagName=YU;je.indexOfElementNode=FU;je.indexOfNode=Ww;je.indexOfSorted=Vx;je.indexOfTextNode=OU;je.insert=NU;je.isElement=kU;je.isFloat=EU;je.isNumber=$$;je.isXml=LU;je.locationOf=Tm;je.nodeBounds=AU;je.parents=Wx;je.parse=UU;je.prefixed=IU;je.qs=VU;je.qsa=A$;je.qsp=WU;je.querySelectorByType=qU;je.requestAnimationFrame=void 0;je.revokeBlobUrl=MU;je.sprint=GU;je.treeWalker=R$;je.type=zU;je.uuid=N$;je.walk=Gw;je.windowBounds=RU;var xU=pd;const wU=typeof window<"u"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1;je.requestAnimationFrame=wU;const bU=1,CU=3,_$=typeof URL<"u"?URL:typeof window<"u"?window.URL||window.webkitURL||window.mozURL:void 0;function N$(){var n=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(t=="x"?r:r&7|8).toString(16)});return e}function SU(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function kU(n){return!!(n&&n.nodeType==1)}function $$(n){return!isNaN(parseFloat(n))&&isFinite(n)}function EU(n){let e=parseFloat(n);return $$(n)===!1?!1:typeof n=="string"&&n.indexOf(".")>-1?!0:Math.floor(e)!==e}function IU(n){var e=["Webkit","webkit","Moz","O","ms"],t=["-webkit-","-webkit-","-moz-","-o-","-ms-"],r=n.toLowerCase(),s=e.length;if(typeof document>"u"||typeof document.body.style[r]<"u")return n;for(var i=0;i<s;i++)if(typeof document.body.style[t[i]+r]<"u")return t[i]+r;return n}function TU(n){for(var e=1,t=arguments.length;e<t;e++){var r=arguments[e];for(var s in r)n[s]===void 0&&(n[s]=r[s])}return n}function _U(n){var e=[].slice.call(arguments,1);return e.forEach(function(t){t&&Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}),n}function NU(n,e,t){var r=Tm(n,e,t);return e.splice(r,0,n),r}function Tm(n,e,t,r,s){var i=r||0,o=s||e.length,a=parseInt(i+(o-i)/2),l;return t||(t=function(u,c){if(u>c)return 1;if(u<c)return-1;if(u==c)return 0}),o-i<=0?a:(l=t(e[a],n),o-i===1?l>=0?a:a+1:l===0?a:l===-1?Tm(n,e,t,a,o):Tm(n,e,t,i,a))}function Vx(n,e,t,r,s){var i=r||0,o=s||e.length,a=parseInt(i+(o-i)/2),l;return t||(t=function(u,c){if(u>c)return 1;if(u<c)return-1;if(u==c)return 0}),o-i<=0?-1:(l=t(e[a],n),o-i===1?l===0?a:-1:l===0?a:l===-1?Vx(n,e,t,a,o):Vx(n,e,t,i,a))}function $U(n){var e=window.getComputedStyle(n),t=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],s=0,i=0;return t.forEach(function(o){s+=parseFloat(e[o])||0}),r.forEach(function(o){i+=parseFloat(e[o])||0}),{height:i,width:s}}function DU(n){var e=window.getComputedStyle(n),t=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],s=0,i=0;return t.forEach(function(o){s+=parseFloat(e[o])||0}),r.forEach(function(o){i+=parseFloat(e[o])||0}),{height:i,width:s}}function AU(n){let e,t=n.ownerDocument;if(n.nodeType==Node.TEXT_NODE){let r=t.createRange();r.selectNodeContents(n),e=r.getBoundingClientRect()}else e=n.getBoundingClientRect();return e}function RU(){var n=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:n,bottom:e,width:n,height:e}}function Ww(n,e){for(var t=n.parentNode,r=t.childNodes,s,i=-1,o=0;o<r.length&&(s=r[o],s.nodeType===e&&i++,s!=n);o++);return i}function OU(n){return Ww(n,CU)}function FU(n){return Ww(n,bU)}function LU(n){return["xml","opf","ncx"].indexOf(n)>-1}function D$(n,e){return new Blob([n],{type:e})}function PU(n,e){var t,r=D$(n,e);return t=_$.createObjectURL(r),t}function MU(n){return _$.revokeObjectURL(n)}function BU(n,e){var t,r;if(typeof n=="string")return t=btoa(n),r="data:"+e+";base64,"+t,r}function zU(n){return Object.prototype.toString.call(n).slice(8,-1)}function UU(n,e,t){var r,s;return typeof DOMParser>"u"||t?s=xU.DOMParser:s=DOMParser,n.charCodeAt(0)===65279&&(n=n.slice(1)),r=new s().parseFromString(n,e),r}function VU(n,e){var t;if(!n)throw new Error("No Element Provided");if(typeof n.querySelector<"u")return n.querySelector(e);if(t=n.getElementsByTagName(e),t.length)return t[0]}function A$(n,e){return typeof n.querySelector<"u"?n.querySelectorAll(e):n.getElementsByTagName(e)}function WU(n,e,t){var r,s;if(typeof n.querySelector<"u"){e+="[";for(var i in t)e+=i+"~='"+t[i]+"'";return e+="]",n.querySelector(e)}else if(r=n.getElementsByTagName(e),s=Array.prototype.slice.call(r,0).filter(function(o){for(var a in t)if(o.getAttribute(a)===t[a])return!0;return!1}),s)return s[0]}function GU(n,e){var t=n.ownerDocument||n;typeof t.createTreeWalker<"u"?R$(n,e,NodeFilter.SHOW_TEXT):Gw(n,function(r){r&&r.nodeType===3&&e(r)})}function R$(n,e,t){var r=document.createTreeWalker(n,t,null,!1);let s;for(;s=r.nextNode();)e(s)}function Gw(n,e){if(e(n))return!0;if(n=n.firstChild,n)do{if(Gw(n,e))return!0;n=n.nextSibling}while(n)}function jU(n){return new Promise(function(e,t){var r=new FileReader;r.readAsDataURL(n),r.onloadend=function(){e(r.result)}})}function HU(){this.resolve=null,this.reject=null,this.id=N$(),this.promise=new Promise((n,e)=>{this.resolve=n,this.reject=e}),Object.freeze(this)}function qU(n,e,t){var r;if(typeof n.querySelector<"u"&&(r=n.querySelector(`${e}[*|type="${t}"]`)),!r||r.length===0){r=A$(n,e);for(var s=0;s<r.length;s++)if(r[s].getAttributeNS("http://www.idpf.org/2007/ops","type")===t||r[s].getAttribute("epub:type")===t)return r[s]}else return r}function KU(n){for(var e=[],t=n.childNodes,r=0;r<t.length;r++){let s=t[r];s.nodeType===1&&e.push(s)}return e}function Wx(n){for(var e=[n];n;n=n.parentNode)e.unshift(n);return e}function XU(n,e,t){for(var r=[],s=n.childNodes,i=0;i<s.length;i++){let o=s[i];if(o.nodeType===1&&o.nodeName.toLowerCase()===e){if(t)return o;r.push(o)}}if(!t)return r}function YU(n,e){let t;if(!(n===null||e===""))for(t=n.parentNode;t.nodeType===1;){if(t.tagName.toLowerCase()===e)return t;t=t.parentNode}}class ZU{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,t){this.startContainer=e,this.startOffset=t,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,t){this.endContainer=e,this.endOffset=t,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let t=e.parentNode,r=Array.prototype.indexOf.call(t.childNodes,e);this.setStart(t,r),this.setEnd(t,r+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let t=e.nodeType===3?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,t)}_commonAncestorContainer(e,t){var r=Wx(e||this.startContainer),s=Wx(t||this.endContainer);if(r[0]==s[0]){for(var i=0;i<r.length;i++)if(r[i]!=s[i])return r[i-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}je.RangeObject=ZU;var Il={},Qi={};if(!O$)var O$={cwd:function(){return"/"}};function Ti(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+n)}function zk(n,e){for(var t="",r=-1,s=0,i,o=0;o<=n.length;++o){if(o<n.length)i=n.charCodeAt(o);else{if(i===47)break;i=47}if(i===47){if(!(r===o-1||s===1))if(r!==o-1&&s===2){if(t.length<2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){for(var a=t.length-1,l=a;l>=0&&t.charCodeAt(l)!==47;--l);if(l!==a){l===-1?t="":t=t.slice(0,l),r=o,s=0;continue}}else if(t.length===2||t.length===1){t="",r=o,s=0;continue}}e&&(t.length>0?t+="/..":t="..")}else t.length>0?t+="/"+n.slice(r+1,o):t=n.slice(r+1,o);r=o,s=0}else i===46&&s!==-1?++s:s=-1}return t}function QU(n,e){var t=e.dir||e.root,r=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+r:t+n+r:r}var Hp={resolve:function(){for(var e="",t=!1,r,s=arguments.length-1;s>=-1&&!t;s--){var i;s>=0?i=arguments[s]:(r===void 0&&(r=O$.cwd()),i=r),Ti(i),i.length!==0&&(e=i+"/"+e,t=i.charCodeAt(0)===47)}return e=zk(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Ti(e),e.length===0)return".";var t=e.charCodeAt(0)===47,r=e.charCodeAt(e.length-1)===47;return e=zk(e,!t),e.length===0&&!t&&(e="."),e.length>0&&r&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return Ti(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];Ti(r),r.length>0&&(e===void 0?e=r:e+="/"+r)}return e===void 0?".":Hp.normalize(e)},relative:function(e,t){if(Ti(e),Ti(t),e===t||(e=Hp.resolve(e),t=Hp.resolve(t),e===t))return"";for(var r=1;r<e.length&&e.charCodeAt(r)===47;++r);for(var s=e.length,i=s-r,o=1;o<t.length&&t.charCodeAt(o)===47;++o);for(var a=t.length,l=a-o,u=i<l?i:l,c=-1,h=0;h<=u;++h){if(h===u){if(l>u){if(t.charCodeAt(o+h)===47)return t.slice(o+h+1);if(h===0)return t.slice(o+h)}else i>u&&(e.charCodeAt(r+h)===47?c=h:h===0&&(c=0));break}var d=e.charCodeAt(r+h),f=t.charCodeAt(o+h);if(d!==f)break;d===47&&(c=h)}var p="";for(h=r+c+1;h<=s;++h)(h===s||e.charCodeAt(h)===47)&&(p.length===0?p+="..":p+="/..");return p.length>0?p+t.slice(o+c):(o+=c,t.charCodeAt(o)===47&&++o,t.slice(o))},_makeLong:function(e){return e},dirname:function(e){if(Ti(e),e.length===0)return".";for(var t=e.charCodeAt(0),r=t===47,s=-1,i=!0,o=e.length-1;o>=1;--o)if(t=e.charCodeAt(o),t===47){if(!i){s=o;break}}else i=!1;return s===-1?r?"/":".":r&&s===1?"//":e.slice(0,s)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Ti(e);var r=0,s=-1,i=!0,o;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,l=-1;for(o=e.length-1;o>=0;--o){var u=e.charCodeAt(o);if(u===47){if(!i){r=o+1;break}}else l===-1&&(i=!1,l=o+1),a>=0&&(u===t.charCodeAt(a)?--a===-1&&(s=o):(a=-1,s=l))}return r===s?s=l:s===-1&&(s=e.length),e.slice(r,s)}else{for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!i){r=o+1;break}}else s===-1&&(i=!1,s=o+1);return s===-1?"":e.slice(r,s)}},extname:function(e){Ti(e);for(var t=-1,r=0,s=-1,i=!0,o=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!i){r=a+1;break}continue}s===-1&&(i=!1,s=a+1),l===46?t===-1?t=a:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||s===-1||o===0||o===1&&t===s-1&&t===r+1?"":e.slice(t,s)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof e);return QU("/",e)},parse:function(e){Ti(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var r=e.charCodeAt(0),s=r===47,i;s?(t.root="/",i=1):i=0;for(var o=-1,a=0,l=-1,u=!0,c=e.length-1,h=0;c>=i;--c){if(r=e.charCodeAt(c),r===47){if(!u){a=c+1;break}continue}l===-1&&(u=!1,l=c+1),r===46?o===-1?o=c:h!==1&&(h=1):o!==-1&&(h=-1)}return o===-1||l===-1||h===0||h===1&&o===l-1&&o===a+1?l!==-1&&(a===0&&s?t.base=t.name=e.slice(1,l):t.base=t.name=e.slice(a,l)):(a===0&&s?(t.name=e.slice(1,o),t.base=e.slice(1,l)):(t.name=e.slice(a,o),t.base=e.slice(a,l)),t.ext=e.slice(o,l)),a>0?t.dir=e.slice(0,a-1):s&&(t.dir="/"),t},sep:"/",delimiter:":",posix:null},Ng=Hp;Object.defineProperty(Qi,"__esModule",{value:!0});Qi.default=void 0;var mp=JU(Ng);function JU(n){return n&&n.__esModule?n:{default:n}}class eV{constructor(e){var t,r;t=e.indexOf("://"),t>-1&&(e=new URL(e).pathname),r=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=r.dir+"/",this.filename=r.base,this.extension=r.ext.slice(1)}parse(e){return mp.default.parse(e)}isAbsolute(e){return mp.default.isAbsolute(e||this.path)}isDirectory(e){return e.charAt(e.length-1)==="/"}resolve(e){return mp.default.resolve(this.directory,e)}relative(e){var t=e&&e.indexOf("://")>-1;return t?e:mp.default.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}var tV=eV;Qi.default=tV;Object.defineProperty(Il,"__esModule",{value:!0});Il.default=void 0;var Uk=F$(Qi),Vk=F$(Ng);function F$(n){return n&&n.__esModule?n:{default:n}}class nV{constructor(e,t){var r=e.indexOf("://")>-1,s=e,i;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=t,!r&&t!==!1&&typeof t!="string"&&window&&window.location&&(this.base=window.location.href),r||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,s=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch{this.Url=void 0,this.base&&(i=new Uk.default(this.base),s=i.resolve(s))}this.Path=new Uk.default(s),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var t=e.indexOf("://")>-1,r;return t?e:(r=Vk.default.resolve(this.directory,e),this.origin+r)}relative(e){return Vk.default.relative(e,this.directory)}toString(){return this.href}}var rV=nV;Il.default=rV;var $g={},Wr={};Object.defineProperty(Wr,"__esModule",{value:!0});Wr.default=void 0;var Ao=je;const Yl=1,Is=3,sV=9;class Ba{constructor(e,t,r){var s;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof Ba))return new Ba(e,t,r);if(typeof t=="string"?this.base=this.parseComponent(t):typeof t=="object"&&t.steps&&(this.base=t),s=this.checkType(e),s==="string")return this.str=e,(0,Ao.extend)(this,this.parse(e));if(s==="range")return(0,Ao.extend)(this,this.fromRange(e,this.base,r));if(s==="node")return(0,Ao.extend)(this,this.fromNode(e,this.base,r));if(s==="EpubCFI"&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":e&&typeof e=="object"&&((0,Ao.type)(e)==="Range"||typeof e.startContainer<"u")?"range":e&&typeof e=="object"&&typeof e.nodeType<"u"?"node":e&&typeof e=="object"&&e instanceof Ba?"EpubCFI":!1}parse(e){var t={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},r,s,i;return typeof e!="string"?{spinePos:-1}:(e.indexOf("epubcfi(")===0&&e[e.length-1]===")"&&(e=e.slice(8,e.length-1)),r=this.getChapterComponent(e),r?(t.base=this.parseComponent(r),s=this.getPathComponent(e),t.path=this.parseComponent(s),i=this.getRange(e),i&&(t.range=!0,t.start=this.parseComponent(i[0]),t.end=this.parseComponent(i[1])),t.spinePos=t.base.steps[1].index,t):{spinePos:-1})}parseComponent(e){var t={steps:[],terminal:{offset:null,assertion:null}},r=e.split(":"),s=r[0].split("/"),i;return r.length>1&&(i=r[1],t.terminal=this.parseTerminal(i)),s[0]===""&&s.shift(),t.steps=s.map((function(o){return this.parseStep(o)}).bind(this)),t}parseStep(e){var t,r,s,i,o;if(i=e.match(/\[(.*)\]/),i&&i[1]&&(o=i[1]),r=parseInt(e),!isNaN(r))return r%2===0?(t="element",s=r/2-1):(t="text",s=(r-1)/2),{type:t,index:s,id:o||null}}parseTerminal(e){var t,r,s=e.match(/\[(.*)\]/);return s&&s[1]?(t=parseInt(e.split("[")[0]),r=s[1]):t=parseInt(e),(0,Ao.isNumber)(t)||(t=null),{offset:t,assertion:r}}getChapterComponent(e){var t=e.split("!");return t[0]}getPathComponent(e){var t=e.split("!");if(t[1])return t[1].split(",")[0]}getRange(e){var t=e.split(",");return t.length===3?[t[1],t[2]]:!1}getCharecterOffsetComponent(e){var t=e.split(":");return t[1]||""}joinSteps(e){return e?e.map(function(t){var r="";return t.type==="element"&&(r+=(t.index+1)*2),t.type==="text"&&(r+=1+2*t.index),t.id&&(r+="["+t.id+"]"),r}).join("/"):""}segmentString(e){var t="/";return t+=this.joinSteps(e.steps),e.terminal&&e.terminal.offset!=null&&(t+=":"+e.terminal.offset),e.terminal&&e.terminal.assertion!=null&&(t+="["+e.terminal.assertion+"]"),t}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+=")",e}compare(e,t){var r,s,i,o;if(typeof e=="string"&&(e=new Ba(e)),typeof t=="string"&&(t=new Ba(t)),e.spinePos>t.spinePos)return 1;if(e.spinePos<t.spinePos)return-1;e.range?(r=e.path.steps.concat(e.start.steps),i=e.start.terminal):(r=e.path.steps,i=e.path.terminal),t.range?(s=t.path.steps.concat(t.start.steps),o=t.start.terminal):(s=t.path.steps,o=t.path.terminal);for(var a=0;a<r.length;a++){if(!r[a])return-1;if(!s[a]||r[a].index>s[a].index)return 1;if(r[a].index<s[a].index)return-1}return r.length<s.length?-1:i.offset>o.offset?1:i.offset<o.offset?-1:0}step(e){var t=e.nodeType===Is?"text":"element";return{id:e.id,tagName:e.tagName,type:t,index:this.position(e)}}filteredStep(e,t){var r=this.filter(e,t),s;if(r)return s=r.nodeType===Is?"text":"element",{id:r.id,tagName:r.tagName,type:s,index:this.filteredPosition(r,t)}}pathTo(e,t,r){for(var s={steps:[],terminal:{offset:null,assertion:null}},i=e,o;i&&i.parentNode&&i.parentNode.nodeType!=sV;)r?o=this.filteredStep(i,r):o=this.step(i),o&&s.steps.unshift(o),i=i.parentNode;return t!=null&&t>=0&&(s.terminal.offset=t,s.steps[s.steps.length-1].type!="text"&&s.steps.push({type:"text",index:0})),s}equalStep(e,t){return!e||!t?!1:e.index===t.index&&e.id===t.id&&e.type===t.type}fromRange(e,t,r){var s={range:!1,base:{},path:{},start:null,end:null},i=e.startContainer,o=e.endContainer,a=e.startOffset,l=e.endOffset,u=!1;if(r&&(u=i.ownerDocument.querySelector("."+r)!=null),typeof t=="string"?(s.base=this.parseComponent(t),s.spinePos=s.base.steps[1].index):typeof t=="object"&&(s.base=t),e.collapsed)u&&(a=this.patchOffset(i,a,r)),s.path=this.pathTo(i,a,r);else{s.range=!0,u&&(a=this.patchOffset(i,a,r)),s.start=this.pathTo(i,a,r),u&&(l=this.patchOffset(o,l,r)),s.end=this.pathTo(o,l,r),s.path={steps:[],terminal:null};var c=s.start.steps.length,h;for(h=0;h<c&&this.equalStep(s.start.steps[h],s.end.steps[h]);h++)h===c-1?s.start.terminal===s.end.terminal&&(s.path.steps.push(s.start.steps[h]),s.range=!1):s.path.steps.push(s.start.steps[h]);s.start.steps=s.start.steps.slice(s.path.steps.length),s.end.steps=s.end.steps.slice(s.path.steps.length)}return s}fromNode(e,t,r){var s={range:!1,base:{},path:{},start:null,end:null};return typeof t=="string"?(s.base=this.parseComponent(t),s.spinePos=s.base.steps[1].index):typeof t=="object"&&(s.base=t),s.path=this.pathTo(e,null,r),s}filter(e,t){var r,s,i,o,a,l=!1;return e.nodeType===Is?(l=!0,i=e.parentNode,r=e.parentNode.classList.contains(t)):(l=!1,r=e.classList.contains(t)),r&&l?(o=i.previousSibling,a=i.nextSibling,o&&o.nodeType===Is?s=o:a&&a.nodeType===Is&&(s=a),s||e):r&&!l?!1:e}patchOffset(e,t,r){if(e.nodeType!=Is)throw new Error("Anchor must be a text node");var s=e,i=t;for(e.parentNode.classList.contains(r)&&(s=e.parentNode);s.previousSibling;){if(s.previousSibling.nodeType===Yl)if(s.previousSibling.classList.contains(r))i+=s.previousSibling.textContent.length;else break;else i+=s.previousSibling.textContent.length;s=s.previousSibling}return i}normalizedMap(e,t,r){var s={},i=-1,o,a=e.length,l,u;for(o=0;o<a;o++)l=e[o].nodeType,l===Yl&&e[o].classList.contains(r)&&(l=Is),o>0&&l===Is&&u===Is?s[o]=i:t===l&&(i=i+1,s[o]=i),u=l;return s}position(e){var t,r;return e.nodeType===Yl?(t=e.parentNode.children,t||(t=(0,Ao.findChildren)(e.parentNode)),r=Array.prototype.indexOf.call(t,e)):(t=this.textNodes(e.parentNode),r=t.indexOf(e)),r}filteredPosition(e,t){var r,s,i;return e.nodeType===Yl?(r=e.parentNode.children,i=this.normalizedMap(r,Yl,t)):(r=e.parentNode.childNodes,e.parentNode.classList.contains(t)&&(e=e.parentNode,r=e.parentNode.childNodes),i=this.normalizedMap(r,Is,t)),s=Array.prototype.indexOf.call(r,e),i[s]}stepsToXpath(e){var t=[".","*"];return e.forEach(function(r){var s=r.index+1;r.id?t.push("*[position()="+s+" and @id='"+r.id+"']"):r.type==="text"?t.push("text()["+s+"]"):t.push("*["+s+"]")}),t.join("/")}stepsToQuerySelector(e){var t=["html"];return e.forEach(function(r){var s=r.index+1;r.id?t.push("#"+r.id):r.type==="text"||t.push("*:nth-child("+s+")")}),t.join(">")}textNodes(e,t){return Array.prototype.slice.call(e.childNodes).filter(function(r){return r.nodeType===Is?!0:!!(t&&r.classList.contains(t))})}walkToNode(e,t,r){var s=t||document,i=s.documentElement,o,a,l=e.length,u;for(u=0;u<l&&(a=e[u],a.type==="element"?a.id?i=s.getElementById(a.id):(o=i.children||(0,Ao.findChildren)(i),i=o[a.index]):a.type==="text"&&(i=this.textNodes(i,r)[a.index]),!!i);u++);return i}findNode(e,t,r){var s=t||document,i,o;return!r&&typeof s.evaluate<"u"?(o=this.stepsToXpath(e),i=s.evaluate(o,s,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):r?i=this.walkToNode(e,s,r):i=this.walkToNode(e,s),i}fixMiss(e,t,r,s){var i=this.findNode(e.slice(0,-1),r,s),o=i.childNodes,a=this.normalizedMap(o,Is,s),l,u,c=e[e.length-1].index;for(let h in a){if(!a.hasOwnProperty(h))return;if(a[h]===c)if(l=o[h],u=l.textContent.length,t>u)t=t-u;else{l.nodeType===Yl?i=l.childNodes[0]:i=l;break}}return{container:i,offset:t}}toRange(e,t){var r=e||document,s,i,o,a,l,u=this,c,h,d=t?r.querySelector("."+t)!=null:!1,f;if(typeof r.createRange<"u"?s=r.createRange():s=new Ao.RangeObject,u.range?(i=u.start,c=u.path.steps.concat(i.steps),a=this.findNode(c,r,d?t:null),o=u.end,h=u.path.steps.concat(o.steps),l=this.findNode(h,r,d?t:null)):(i=u.path,c=u.path.steps,a=this.findNode(u.path.steps,r,d?t:null)),a)try{i.terminal.offset!=null?s.setStart(a,i.terminal.offset):s.setStart(a,0)}catch{f=this.fixMiss(c,i.terminal.offset,r,d?t:null),s.setStart(f.container,f.offset)}else return console.log("No startContainer found for",this.toString()),null;if(l)try{o.terminal.offset!=null?s.setEnd(l,o.terminal.offset):s.setEnd(l,0)}catch{f=this.fixMiss(h,u.end.terminal.offset,r,d?t:null),s.setEnd(f.container,f.offset)}return s}isCfiString(e){return typeof e=="string"&&e.indexOf("epubcfi(")===0&&e[e.length-1]===")"}generateChapterComponent(e,t,r){var s=parseInt(t),i=(e+1)*2,o="/"+i+"/";return o+=(s+1)*2,r&&(o+="["+r+"]"),o}collapse(e){this.range&&(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}var iV=Ba;Wr.default=iV;var ac={};Object.defineProperty(ac,"__esModule",{value:!0});ac.default=void 0;class oV{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if(typeof arguments[e]=="function")this.hooks.push(arguments[e]);else for(var t=0;t<arguments[e].length;++t)this.hooks.push(arguments[e][t])}deregister(e){let t;for(let r=0;r<this.hooks.length;r++)if(t=this.hooks[r],t===e){this.hooks.splice(r,1);break}}trigger(){var e=arguments,t=this.context,r=[];return this.hooks.forEach(function(s){try{var i=s.apply(t,e)}catch(o){console.log(o)}i&&typeof i.then=="function"&&r.push(i)}),Promise.all(r)}list(){return this.hooks}clear(){return this.hooks=[]}}var aV=oV;ac.default=aV;var Dg={},Ji={};Object.defineProperty(Ji,"__esModule",{value:!0});Ji.replaceBase=uV;Ji.replaceCanonical=cV;Ji.replaceLinks=dV;Ji.replaceMeta=hV;Ji.substitute=fV;var ll=je,lV=L$(Il);L$(Qi);function L$(n){return n&&n.__esModule?n:{default:n}}function uV(n,e){var t,r,s=e.url,i=s.indexOf("://")>-1;n&&(r=(0,ll.qs)(n,"head"),t=(0,ll.qs)(r,"base"),t||(t=n.createElement("base"),r.insertBefore(t,r.firstChild)),!i&&window&&window.location&&(s=window.location.origin+s),t.setAttribute("href",s))}function cV(n,e){var t,r,s=e.canonical;n&&(t=(0,ll.qs)(n,"head"),r=(0,ll.qs)(t,"link[rel='canonical']"),r?r.setAttribute("href",s):(r=n.createElement("link"),r.setAttribute("rel","canonical"),r.setAttribute("href",s),t.appendChild(r)))}function hV(n,e){var t,r,s=e.idref;n&&(t=(0,ll.qs)(n,"head"),r=(0,ll.qs)(t,"link[property='dc.identifier']"),r?r.setAttribute("content",s):(r=n.createElement("meta"),r.setAttribute("name","dc.identifier"),r.setAttribute("content",s),t.appendChild(r)))}function dV(n,e){var t=n.querySelectorAll("a[href]");if(t.length)for(var r=(0,ll.qs)(n.ownerDocument,"base"),s=r?r.getAttribute("href"):void 0,i=(function(a){var l=a.getAttribute("href");if(l.indexOf("mailto:")!==0){var u=l.indexOf("://")>-1;if(u)a.setAttribute("target","_blank");else{var c;try{c=new lV.default(l,s)}catch{}a.onclick=function(){return c&&c.hash?e(c.Path.path+c.hash):e(c?c.Path.path:l),!1}}}}).bind(this),o=0;o<t.length;o++)i(t[o])}function fV(n,e,t){return e.forEach(function(r,s){r&&t[s]&&(r=r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),n=n.replace(new RegExp(r,"g"),t[s]))}),n}var Tl={};Object.defineProperty(Tl,"__esModule",{value:!0});Tl.default=void 0;var Zl=je,pV=mV(Qi);function mV(n){return n&&n.__esModule?n:{default:n}}function gV(n,e,t,r){var s=typeof window<"u"?window.URL:!1,i=s?"blob":"arraybuffer",o=new Zl.defer,a=new XMLHttpRequest,l=XMLHttpRequest.prototype,u;"overrideMimeType"in l||Object.defineProperty(l,"overrideMimeType",{value:function(){}}),t&&(a.withCredentials=!0),a.onreadystatechange=h,a.onerror=c,a.open("GET",n,!0);for(u in r)a.setRequestHeader(u,r[u]);e=="json"&&a.setRequestHeader("Accept","application/json"),e||(e=new pV.default(n).extension),e=="blob"&&(a.responseType=i),(0,Zl.isXml)(e)&&a.overrideMimeType("text/xml"),e=="binary"&&(a.responseType="arraybuffer"),a.send();function c(d){o.reject(d)}function h(){if(this.readyState===XMLHttpRequest.DONE){var d=!1;if((this.responseType===""||this.responseType==="document")&&(d=this.responseXML),this.status===200||this.status===0||d){var f;if(!this.response&&!d)return o.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),o.promise;if(this.status===403)return o.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),o.promise;d?f=this.responseXML:(0,Zl.isXml)(e)?f=(0,Zl.parse)(this.response,"text/xml"):e=="xhtml"?f=(0,Zl.parse)(this.response,"application/xhtml+xml"):e=="html"||e=="htm"?f=(0,Zl.parse)(this.response,"text/html"):e=="json"?f=JSON.parse(this.response):e=="blob"?s?f=this.response:f=new Blob([this.response]):f=this.response,o.resolve(f)}else o.reject({status:this.status,message:this.response,stack:new Error().stack})}}return o.promise}var vV=gV;Tl.default=vV;Object.defineProperty(Dg,"__esModule",{value:!0});Dg.default=void 0;var vy=je,Wk=jw(Wr),Gk=jw(ac),yV=Ji,xV=jw(Tl),wV=pd;function jw(n){return n&&n.__esModule?n:{default:n}}class bV{constructor(e,t){this.idref=e.idref,this.linear=e.linear==="yes",this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,t?this.hooks=t:(this.hooks={},this.hooks.serialize=new Gk.default(this),this.hooks.content=new Gk.default(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var t=e||this.request||xV.default,r=new vy.defer,s=r.promise;return this.contents?r.resolve(this.contents):t(this.url).then((function(i){return this.document=i,this.contents=i.documentElement,this.hooks.content.trigger(this.document,this)}).bind(this)).then((function(){r.resolve(this.contents)}).bind(this)).catch(function(i){r.reject(i)}),s}base(){return(0,yV.replaceBase)(this.document,this)}render(e){var t=new vy.defer,r=t.promise;return this.output,this.load(e).then((function(s){var i=typeof navigator<"u"&&navigator.userAgent||"",o=i.indexOf("Trident")>=0,a;typeof XMLSerializer>"u"||o?a=wV.DOMParser:a=XMLSerializer;var l=new a;return this.output=l.serializeToString(s),this.output}).bind(this)).then((function(){return this.hooks.serialize.trigger(this.output,this)}).bind(this)).then((function(){t.resolve(this.output)}).bind(this)).catch(function(s){t.reject(s)}),r}find(e){var t=this,r=[],s=e.toLowerCase(),i=function(o){for(var a=o.textContent.toLowerCase(),l=t.document.createRange(),u,c,h=-1,d,f=150;c!=-1;)c=a.indexOf(s,h+1),c!=-1&&(l=t.document.createRange(),l.setStart(o,c),l.setEnd(o,c+s.length),u=t.cfiFromRange(l),o.textContent.length<f?d=o.textContent:(d=o.textContent.substring(c-f/2,c+f/2),d="..."+d+"..."),r.push({cfi:u,excerpt:d})),h=c};return(0,vy.sprint)(t.document,function(o){i(o)}),r}search(e,t=5){if(typeof document.createTreeWalker>"u")return this.find(e);let r=[];const s=150,i=this,o=e.toLowerCase(),a=function(h){const p=h.reduce((v,g)=>v+g.textContent,"").toLowerCase().indexOf(o);if(p!=-1){const g=p+o.length;let m=0,y=0;if(p<h[0].length){let w;for(;m<h.length-1&&(y+=h[m].length,!(g<=y));)m+=1;let x=h[0],b=h[m],C=i.document.createRange();C.setStart(x,p);let k=h.slice(0,m).reduce((T,_)=>T+_.textContent.length,0);C.setEnd(b,k>g?g:g-k),w=i.cfiFromRange(C);let E=h.slice(0,m+1).reduce((T,_)=>T+_.textContent,"");E.length>s&&(E=E.substring(p-s/2,p+s/2),E="..."+E+"..."),r.push({cfi:w,excerpt:E})}}},l=document.createTreeWalker(i.document,NodeFilter.SHOW_TEXT,null,!1);let u,c=[];for(;u=l.nextNode();)c.push(u),c.length==t&&(a(c.slice(0,t)),c=c.slice(1,t));return c.length>0&&a(c),r}reconcileLayoutSettings(e){var t={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(r){var s=r.replace("rendition:",""),i=s.indexOf("-"),o,a;i!=-1&&(o=s.slice(0,i),a=s.slice(i+1),t[o]=a)}),t}cfiFromRange(e){return new Wk.default(e,this.cfiBase).toString()}cfiFromElement(e){return new Wk.default(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}var CV=bV;Dg.default=CV;Object.defineProperty($g,"__esModule",{value:!0});$g.default=void 0;var jk=Hw(Wr),Hk=Hw(ac),SV=Hw(Dg),yy=Ji;function Hw(n){return n&&n.__esModule?n:{default:n}}class kV{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new Hk.default,this.hooks.content=new Hk.default,this.hooks.content.register(yy.replaceBase),this.hooks.content.register(yy.replaceCanonical),this.hooks.content.register(yy.replaceMeta),this.epubcfi=new jk.default,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,t,r){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((s,i)=>{var o=this.manifest[s.idref],a;s.index=i,s.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,s.index,s.id),s.href&&(s.url=t(s.href,!0),s.canonical=r(s.href)),o&&(s.href=o.href,s.url=t(s.href,!0),s.canonical=r(s.href),o.properties.length&&s.properties.push.apply(s.properties,o.properties)),s.linear==="yes"?(s.prev=(function(){let l=s.index;for(;l>0;){let u=this.get(l-1);if(u&&u.linear)return u;l-=1}}).bind(this),s.next=(function(){let l=s.index;for(;l<this.spineItems.length-1;){let u=this.get(l+1);if(u&&u.linear)return u;l+=1}}).bind(this)):(s.prev=function(){},s.next=function(){}),a=new SV.default(s,this.hooks),this.append(a)}),this.loaded=!0}get(e){var t=0;if(typeof e>"u")for(;t<this.spineItems.length;){let r=this.spineItems[t];if(r&&r.linear)break;t+=1}else this.epubcfi.isCfiString(e)?t=new jk.default(e).spinePos:typeof e=="number"||isNaN(e)===!1?t=e:typeof e=="string"&&e.indexOf("#")===0?t=this.spineById[e.substring(1)]:typeof e=="string"&&(e=e.split("#")[0],t=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[t]||null}append(e){var t=this.spineItems.length;return e.index=t,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=t,this.spineByHref[encodeURI(e.href)]=t,this.spineByHref[e.href]=t,this.spineById[e.idref]=t,t}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(t,r){t.index=r}),0}remove(e){var t=this.spineItems.indexOf(e);if(t>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(t,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let t=this.get(e);if(t&&t.linear)return t;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let t=this.get(e);if(t&&t.linear)return t;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}var EV=kV;$g.default=EV;var Ag={},ua={};Object.defineProperty(ua,"__esModule",{value:!0});ua.default=ua.Task=void 0;var gp=je;class IV{constructor(e){this._q=[],this.context=e,this.tick=gp.requestAnimationFrame,this.running=!1,this.paused=!1}enqueue(){var e,t,r,s=[].shift.call(arguments),i=arguments;if(!s)throw new Error("No Task Provided");return typeof s=="function"?(e=new gp.defer,t=e.promise,r={task:s,args:i,deferred:e,promise:t}):r={promise:s},this._q.push(r),this.paused==!1&&!this.running&&this.run(),r.promise}dequeue(){var e,t,r;if(this._q.length&&!this.paused){if(e=this._q.shift(),t=e.task,t)return r=t.apply(this.context,e.args),r&&typeof r.then=="function"?r.then((function(){e.deferred.resolve.apply(this.context,arguments)}).bind(this),(function(){e.deferred.reject.apply(this.context,arguments)}).bind(this)):(e.deferred.resolve.apply(this.context,r),e.promise);if(e.promise)return e.promise}else return e=new gp.defer,e.deferred.resolve(),e.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new gp.defer),this.tick.call(window,()=>{this._q.length?this.dequeue().then((function(){this.run()}).bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then((function(){return this.running=void 0,this.flush()}).bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}class TV{constructor(e,t,r){return function(){var s=arguments||[];return new Promise((i,o)=>{var a=function(l,u){!l&&u?o(u):i(l)};s.push(a),e.apply(r||this,s)})}}}ua.Task=TV;var _V=IV;ua.default=_V;var sr={};Object.defineProperty(sr,"__esModule",{value:!0});sr.EVENTS=sr.EPUBJS_VERSION=sr.DOM_EVENTS=void 0;const NV="0.3";sr.EPUBJS_VERSION=NV;const $V=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"];sr.DOM_EVENTS=$V;const DV={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};sr.EVENTS=DV;Object.defineProperty(Ag,"__esModule",{value:!0});Ag.default=void 0;var Da=je,AV=qw(ua),Ro=qw(Wr),RV=sr,OV=qw(Zi);function qw(n){return n&&n.__esModule?n:{default:n}}class P${constructor(e,t,r){this.spine=e,this.request=t,this.pause=r||100,this.q=new AV.default(this),this.epubcfi=new Ro.default,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each((function(t){t.linear&&this.q.enqueue(this.process.bind(this),t)}).bind(this)),this.q.run().then((function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}).bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then((function(t){var r=new Da.defer,s=this.parse(t,e.cfiBase);return this._locations=this._locations.concat(s),e.unload(),this.processingTimeout=setTimeout(()=>r.resolve(s),this.pause),r.promise}).bind(this))}parse(e,t,r){var s=[],i,o=e.ownerDocument,a=(0,Da.qs)(o,"body"),l=0,u,c=r||this.break,h=function(d){var f=d.length,p,v=0;if(d.textContent.trim().length===0)return!1;for(l==0&&(i=this.createRange(),i.startContainer=d,i.startOffset=0),p=c-l,p>f&&(l+=f,v=f);v<f;)if(p=c-l,l===0&&(v+=1,i=this.createRange(),i.startContainer=d,i.startOffset=v),v+p>=f)l+=f-v,v=f;else{v+=p,i.endContainer=d,i.endOffset=v;let g=new Ro.default(i,t).toString();s.push(g),l=0}u=d};if((0,Da.sprint)(a,h.bind(this)),i&&i.startContainer&&u){i.endContainer=u,i.endOffset=u.length;let d=new Ro.default(i,t).toString();s.push(d),l=0}return s}generateFromWords(e,t,r){var s=e?new Ro.default(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each((function(i){i.linear&&(s?i.index>=s.spinePos&&this.q.enqueue(this.processWords.bind(this),i,t,s,r):this.q.enqueue(this.processWords.bind(this),i,t,s,r))}).bind(this)),this.q.run().then((function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}).bind(this))}processWords(e,t,r,s){return s&&this._locationsWords.length>=s?Promise.resolve():e.load(this.request).then((function(i){var o=new Da.defer,a=this.parseWords(i,e,t,r),l=s-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(a.length>=s?a.slice(0,l):a),e.unload(),this.processingTimeout=setTimeout(()=>o.resolve(a),this.pause),o.promise}).bind(this))}countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,""),e=e.replace(/[ ]{2,}/gi," "),e=e.replace(/\n /,`
`),e.split(" ").length}parseWords(e,t,r,s){var i=t.cfiBase,o=[],a=e.ownerDocument,l=(0,Da.qs)(a,"body"),u=r,c=s?s.spinePos!==t.index:!0,h;s&&t.index===s.spinePos&&(h=s.findNode(s.range?s.path.steps.concat(s.start.steps):s.path.steps,e.ownerDocument));var d=function(f){if(!c)if(f===h)c=!0;else return!1;if(f.textContent.length<10&&f.textContent.trim().length===0)return!1;var p=this.countWords(f.textContent),v,g=0;if(p===0)return!1;for(v=u-this._wordCounter,v>p&&(this._wordCounter+=p,g=p);g<p;)if(v=u-this._wordCounter,g+v>=p)this._wordCounter+=p-g,g=p;else{g+=v;let m=new Ro.default(f,i);o.push({cfi:m.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return(0,Da.sprint)(l,d.bind(this)),o}locationFromCfi(e){let t;return Ro.default.prototype.isCfiString(e)&&(e=new Ro.default(e)),this._locations.length===0?-1:(t=(0,Da.locationOf)(e,this._locations,this.epubcfi.compare),t>this.total?this.total:t)}percentageFromCfi(e){if(this._locations.length===0)return null;var t=this.locationFromCfi(e);return this.percentageFromLocation(t)}percentageFromLocation(e){return!e||!this.total?0:e/this.total}cfiFromLocation(e){var t=-1;return typeof e!="number"&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(t=this._locations[e]),t}cfiFromPercentage(e){let t;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let r=new Ro.default(this._locations[this.total]);return r.collapse(),r.toString()}return t=Math.ceil(this.total*e),this.cfiFromLocation(t)}load(e){return typeof e=="string"?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var t;if(typeof e=="string")this._currentCfi=e;else if(typeof e=="number")this._current=e;else return;this._locations.length!==0&&(typeof e=="string"?(t=this.locationFromCfi(e),this._current=t):t=e,this.emit(RV.EVENTS.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(t)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}(0,OV.default)(P$.prototype);var FV=P$;Ag.default=FV;var Rg={};Object.defineProperty(Rg,"__esModule",{value:!0});Rg.default=void 0;var LV=MV(Ng),PV=je;function MV(n){return n&&n.__esModule?n:{default:n}}let BV=class{constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var t;if(!e)throw new Error("Container File Not Found");if(t=(0,PV.qs)(e,"rootfile"),!t)throw new Error("No RootFile Found");this.packagePath=t.getAttribute("full-path"),this.directory=LV.default.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}};var zV=BV;Rg.default=zV;var Og={};Object.defineProperty(Og,"__esModule",{value:!0});Og.default=void 0;var Ts=je;class UV{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var t,r,s;if(!e)throw new Error("Package File Not Found");if(t=(0,Ts.qs)(e,"metadata"),!t)throw new Error("No Metadata Found");if(r=(0,Ts.qs)(e,"manifest"),!r)throw new Error("No Manifest Found");if(s=(0,Ts.qs)(e,"spine"),!s)throw new Error("No Spine Found");return this.manifest=this.parseManifest(r),this.navPath=this.findNavPath(r),this.ncxPath=this.findNcxPath(r,s),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=(0,Ts.indexOfElementNode)(s),this.spine=this.parseSpine(s,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(t),this.metadata.direction=s.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var t={};return t.title=this.getElementText(e,"title"),t.creator=this.getElementText(e,"creator"),t.description=this.getElementText(e,"description"),t.pubdate=this.getElementText(e,"date"),t.publisher=this.getElementText(e,"publisher"),t.identifier=this.getElementText(e,"identifier"),t.language=this.getElementText(e,"language"),t.rights=this.getElementText(e,"rights"),t.modified_date=this.getPropertyText(e,"dcterms:modified"),t.layout=this.getPropertyText(e,"rendition:layout"),t.orientation=this.getPropertyText(e,"rendition:orientation"),t.flow=this.getPropertyText(e,"rendition:flow"),t.viewport=this.getPropertyText(e,"rendition:viewport"),t.media_active_class=this.getPropertyText(e,"media:active-class"),t.spread=this.getPropertyText(e,"rendition:spread"),t}parseManifest(e){var t={},r=(0,Ts.qsa)(e,"item"),s=Array.prototype.slice.call(r);return s.forEach(function(i){var o=i.getAttribute("id"),a=i.getAttribute("href")||"",l=i.getAttribute("media-type")||"",u=i.getAttribute("media-overlay")||"",c=i.getAttribute("properties")||"";t[o]={href:a,type:l,overlay:u,properties:c.length?c.split(" "):[]}}),t}parseSpine(e,t){var r=[],s=(0,Ts.qsa)(e,"itemref"),i=Array.prototype.slice.call(s);return i.forEach(function(o,a){var l=o.getAttribute("idref"),u=o.getAttribute("properties")||"",c=u.length?u.split(" "):[],h={id:o.getAttribute("id"),idref:l,linear:o.getAttribute("linear")||"yes",properties:c,index:a};r.push(h)}),r}findUniqueIdentifier(e){var t=e.documentElement.getAttribute("unique-identifier");if(!t)return"";var r=e.getElementById(t);return r&&r.localName==="identifier"&&r.namespaceURI==="http://purl.org/dc/elements/1.1/"&&r.childNodes.length>0?r.childNodes[0].nodeValue.trim():""}findNavPath(e){var t=(0,Ts.qsp)(e,"item",{properties:"nav"});return t?t.getAttribute("href"):!1}findNcxPath(e,t){var r=(0,Ts.qsp)(e,"item",{"media-type":"application/x-dtbncx+xml"}),s;return r||(s=t.getAttribute("toc"),s&&(r=e.querySelector(`#${s}`))),r?r.getAttribute("href"):!1}findCoverPath(e){var t=(0,Ts.qs)(e,"package");t.getAttribute("version");var r=(0,Ts.qsp)(e,"item",{properties:"cover-image"});if(r)return r.getAttribute("href");var s=(0,Ts.qsp)(e,"meta",{name:"cover"});if(s){var i=s.getAttribute("content"),o=e.getElementById(i);return o?o.getAttribute("href"):""}else return!1}getElementText(e,t){var r=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",t),s;return!r||r.length===0?"":(s=r[0],s.childNodes.length?s.childNodes[0].nodeValue:"")}getPropertyText(e,t){var r=(0,Ts.qsp)(e,"meta",{property:t});return r&&r.childNodes.length?r.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let t=e.readingOrder||e.spine;return this.spine=t.map((r,s)=>(r.index=s,r.linear=r.linear||"yes",r)),e.resources.forEach((r,s)=>{this.manifest[s]=r,r.rel&&r.rel[0]==="cover"&&(this.coverPath=r.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((r,s)=>(r.label=r.title,r)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}var VV=UV;Og.default=VV;var Fg={};Object.defineProperty(Fg,"__esModule",{value:!0});Fg.default=void 0;var ls=je;class WV{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let t=e.nodeType,r,s;t&&(r=(0,ls.qs)(e,"html"),s=(0,ls.qs)(e,"ncx")),t?r?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):s&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var t,r=0;r<e.length;r++)t=e[r],t.href&&(this.tocByHref[t.href]=r),t.id&&(this.tocById[t.id]=r),this.length++,t.subitems.length&&this.unpack(t.subitems)}get(e){var t;return e?(e.indexOf("#")===0?t=this.tocById[e.substring(1)]:e in this.tocByHref&&(t=this.tocByHref[e]),this.getByIndex(e,t,this.toc)):this.toc}getByIndex(e,t,r){if(r.length===0)return;const s=r[t];if(s&&(e===s.id||e===s.href))return s;{let i;for(let o=0;o<r.length&&(i=this.getByIndex(e,t,r[o].subitems),!i);++o);return i}}landmark(e){var t;return e?(t=this.landmarksByType[e],this.landmarks[t]):this.landmarks}parseNav(e){var t=(0,ls.querySelectorByType)(e,"nav","toc"),r=[];if(!t)return r;let s=(0,ls.filterChildren)(t,"ol",!0);return s&&(r=this.parseNavList(s)),r}parseNavList(e,t){const r=[];if(!e||!e.children)return r;for(let s=0;s<e.children.length;s++){const i=this.navItem(e.children[s],t);i&&r.push(i)}return r}navItem(e,t){let r=e.getAttribute("id")||void 0,s=(0,ls.filterChildren)(e,"a",!0)||(0,ls.filterChildren)(e,"span",!0);if(!s)return;let i=s.getAttribute("href")||"";r||(r=i);let o=s.textContent||"",a=[],l=(0,ls.filterChildren)(e,"ol",!0);return l&&(a=this.parseNavList(l,r)),{id:r,href:i,label:o,subitems:a,parent:t}}parseLandmarks(e){var t=(0,ls.querySelectorByType)(e,"nav","landmarks"),r=t?(0,ls.qsa)(t,"li"):[],s=r.length,i,o=[],a;if(!r||s===0)return o;for(i=0;i<s;++i)a=this.landmarkItem(r[i]),a&&(o.push(a),this.landmarksByType[a.type]=i);return o}landmarkItem(e){let t=(0,ls.filterChildren)(e,"a",!0);if(!t)return;let r=t.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,s=t.getAttribute("href")||"",i=t.textContent||"";return{href:s,label:i,type:r}}parseNcx(e){var t=(0,ls.qsa)(e,"navPoint"),r=t.length,s,i={},o=[],a,l;if(!t||r===0)return o;for(s=0;s<r;++s)a=this.ncxItem(t[s]),i[a.id]=a,a.parent?(l=i[a.parent],l.subitems.push(a)):o.push(a);return o}ncxItem(e){var t=e.getAttribute("id")||!1,r=(0,ls.qs)(e,"content"),s=r.getAttribute("src"),i=(0,ls.qs)(e,"navLabel"),o=i.textContent?i.textContent:"",a=[],l=e.parentNode,u;return l&&(l.nodeName==="navPoint"||l.nodeName.split(":").slice(-1)[0]==="navPoint")&&(u=l.getAttribute("id")),{id:t,href:s,label:o,subitems:a,parent:u}}load(e){return e.map(t=>(t.label=t.title,t.subitems=t.children?this.load(t.children):[],t))}forEach(e){return this.toc.forEach(e)}}var GV=WV;Fg.default=GV;var Lg={},lc={};Object.defineProperty(lc,"__esModule",{value:!0});lc.default=void 0;var jc={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},jV=function(){var n,e,t,r,s={};for(n in jc)if(jc.hasOwnProperty(n)){for(e in jc[n])if(jc[n].hasOwnProperty(e))if(t=jc[n][e],typeof t=="string")s[t]=n+"/"+e;else for(r=0;r<t.length;r++)s[t[r]]=n+"/"+e}return s}(),HV="text/plain";function qV(n){return n&&jV[n.split(".").pop().toLowerCase()]||HV}var KV={lookup:qV};lc.default=KV;Object.defineProperty(Lg,"__esModule",{value:!0});Lg.default=void 0;var qk=Ji,Hc=je,XV=Pg(Il),YV=Pg(lc),Kk=Pg(Qi),ZV=Pg(Ng);function Pg(n){return n&&n.__esModule?n:{default:n}}class QV{constructor(e,t){this.settings={replacements:t&&t.replacements||"base64",archive:t&&t.archive,resolver:t&&t.resolver,request:t&&t.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(t){return e[t]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if(e.type==="application/xhtml+xml"||e.type==="text/html")return!0}),this.assets=this.resources.filter(function(e){if(e.type!=="application/xhtml+xml"&&e.type!=="text/html")return!0}),this.css=this.resources.filter(function(e){if(e.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map((function(e){return e.href}).bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var t=new XV.default(e),r=YV.default.lookup(t.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(e,"blob").then(s=>(0,Hc.blob2base64)(s)).then(s=>(0,Hc.createBase64Url)(s,r)):this.settings.request(e,"blob").then(s=>(0,Hc.createBlobUrl)(s,r))}replacements(){if(this.settings.replacements==="none")return new Promise((function(t){t(this.urls)}).bind(this));var e=this.urls.map(t=>{var r=this.settings.resolver(t);return this.createUrl(r).catch(s=>(console.error(s),null))});return Promise.all(e).then(t=>(this.replacementUrls=t.filter(r=>typeof r=="string"),t))}replaceCss(e,t){var r=[];return e=e||this.settings.archive,t=t||this.settings.resolver,this.cssUrls.forEach((function(s){var i=this.createCssFile(s,e,t).then((function(o){var a=this.urls.indexOf(s);a>-1&&(this.replacementUrls[a]=o)}).bind(this));r.push(i)}).bind(this)),Promise.all(r)}createCssFile(e){var t;if(ZV.default.isAbsolute(e))return new Promise(function(o){o()});var r=this.settings.resolver(e),s;this.settings.archive?s=this.settings.archive.getText(r):s=this.settings.request(r,"text");var i=this.urls.map(o=>{var a=this.settings.resolver(o),l=new Kk.default(r).relative(a);return l});return s?s.then(o=>(o=(0,qk.substitute)(o,i,this.replacementUrls),this.settings.replacements==="base64"?t=(0,Hc.createBase64Url)(o,"text/css"):t=(0,Hc.createBlobUrl)(o,"text/css"),t),o=>new Promise(function(a){a()})):new Promise(function(o){o()})}relativeTo(e,t){return t=t||this.settings.resolver,this.urls.map((function(r){var s=t(r),i=new Kk.default(e).relative(s);return i}).bind(this))}get(e){var t=this.urls.indexOf(e);if(t!==-1)return this.replacementUrls.length?new Promise((function(r,s){r(this.replacementUrls[t])}).bind(this)):this.createUrl(e)}substitute(e,t){var r;return t?r=this.relativeTo(t):r=this.urls,(0,qk.substitute)(e,r,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}var JV=QV;Lg.default=JV;var Mg={};Object.defineProperty(Mg,"__esModule",{value:!0});Mg.default=void 0;var eW=tW(Wr),_s=je;function tW(n){return n&&n.__esModule?n:{default:n}}class nW{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new eW.default,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var t=(0,_s.qs)(e,"html"),r=(0,_s.qs)(e,"ncx");if(t)return this.parseNav(e);if(r)return this.parseNcx(e)}parseNav(e){var t=(0,_s.querySelectorByType)(e,"nav","page-list"),r=t?(0,_s.qsa)(t,"li"):[],s=r.length,i,o=[],a;if(!r||s===0)return o;for(i=0;i<s;++i)a=this.item(r[i]),o.push(a);return o}parseNcx(e){var t=[],r=0,s,i,o,a=0;if(i=(0,_s.qs)(e,"pageList"),!i||(o=(0,_s.qsa)(i,"pageTarget"),a=o.length,!o||o.length===0))return t;for(r=0;r<a;++r)s=this.ncxItem(o[r]),t.push(s);return t}ncxItem(e){var t=(0,_s.qs)(e,"navLabel"),r=(0,_s.qs)(t,"text"),s=r.textContent,i=(0,_s.qs)(e,"content"),o=i.getAttribute("src"),a=parseInt(s,10);return{href:o,page:a}}item(e){var t=(0,_s.qs)(e,"a"),r=t.getAttribute("href")||"",s=t.textContent||"",i=parseInt(s),o=r.indexOf("epubcfi"),a,l,u;return o!=-1?(a=r.split("#"),l=a[0],u=a.length>1?a[1]:!1,{cfi:u,href:r,packageUrl:l,page:i}):{href:r,page:i}}process(e){e.forEach(function(t){this.pages.push(t.page),t.cfi&&this.locations.push(t.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var t=-1;if(this.locations.length===0)return-1;var r=(0,_s.indexOfSorted)(e,this.locations,this.epubcfi.compare);return r!=-1?t=this.pages[r]:(r=(0,_s.locationOf)(e,this.locations,this.epubcfi.compare),t=r-1>=0?this.pages[r-1]:this.pages[0],t!==void 0||(t=-1)),t}cfiFromPage(e){var t=-1;typeof e!="number"&&(e=parseInt(e));var r=this.pages.indexOf(e);return r!=-1&&(t=this.locations[r]),t}pageFromPercentage(e){var t=Math.round(this.totalPages*e);return t}percentageFromPage(e){var t=(e-this.firstPage)/this.totalPages;return Math.round(t*1e3)/1e3}percentageFromCfi(e){var t=this.pageFromCfi(e),r=this.percentageFromPage(t);return r}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}var rW=nW;Mg.default=rW;var uc={},wd={};Object.defineProperty(wd,"__esModule",{value:!0});wd.default=void 0;var sW=je,iW=sr,oW=aW(Zi);function aW(n){return n&&n.__esModule?n:{default:n}}class M${constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread=e.spread!=="none",this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,e.flow==="scrolled"||e.flow==="scrolled-continuous"||e.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return typeof e<"u"&&(e==="scrolled"||e==="scrolled-continuous"||e==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(e,t){return e&&(this._spread=e!=="none",this.update({spread:this._spread})),t>=0&&(this._minSpreadWidth=t),this._spread}calculate(e,t,r){var s=1,i=r||0,o=e,a=t,l=Math.floor(o/12),u,c,h,d;this._spread&&o>=this._minSpreadWidth?s=2:s=1,this.name==="reflowable"&&this._flow==="paginated"&&!(r>=0)&&(i=l%2===0?l:l-1),this.name==="pre-paginated"&&(i=0),s>1?(u=o/s-i,h=u+i):(u=o,h=o),this.name==="pre-paginated"&&s>1&&(o=u),c=u*s+i,d=o,this.width=o,this.height=a,this.spreadWidth=c,this.pageWidth=h,this.delta=d,this.columnWidth=u,this.gap=i,this.divisor=s,this.update({width:o,height:a,spreadWidth:c,pageWidth:h,delta:d,columnWidth:u,gap:i,divisor:s})}format(e,t,r){var s;return this.name==="pre-paginated"?s=e.fit(this.columnWidth,this.height,t):this._flow==="paginated"?s=e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):r&&r==="horizontal"?s=e.size(null,this.height):s=e.size(this.width,null),s}count(e,t){let r,s;return this.name==="pre-paginated"?(r=1,s=1):this._flow==="paginated"?(t=t||this.delta,r=Math.ceil(e/t),s=r*this.divisor):(t=t||this.height,r=Math.ceil(e/t),s=r),{spreads:r,pages:s}}update(e){if(Object.keys(e).forEach(t=>{this.props[t]===e[t]&&delete e[t]}),Object.keys(e).length>0){let t=(0,sW.extend)(this.props,e);this.emit(iW.EVENTS.LAYOUT.UPDATED,t,e)}}}(0,oW.default)(M$.prototype);var lW=M$;wd.default=lW;var Bg={};Object.defineProperty(Bg,"__esModule",{value:!0});Bg.default=void 0;var uW=cW(Il);function cW(n){return n&&n.__esModule?n:{default:n}}class hW{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(e){if(e){if(typeof e=="string")return this.registerUrl("default",e);if(typeof e=="object")return this.registerRules("default",e)}}registerThemes(e){for(var t in e)e.hasOwnProperty(t)&&(typeof e[t]=="string"?this.registerUrl(t,e[t]):this.registerRules(t,e[t]))}registerCss(e,t){this._themes[e]={serialized:t},(this._injected[e]||e=="default")&&this.update(e)}registerUrl(e,t){var r=new uW.default(t);this._themes[e]={url:r.toString()},(this._injected[e]||e=="default")&&this.update(e)}registerRules(e,t){this._themes[e]={rules:t},(this._injected[e]||e=="default")&&this.update(e)}select(e){var t=this._current,r;this._current=e,this.update(e),r=this.rendition.getContents(),r.forEach(s=>{s.removeClass(t),s.addClass(e)})}update(e){var t=this.rendition.getContents();t.forEach(r=>{this.add(e,r)})}inject(e){var t=[],r=this._themes,s;for(var i in r)r.hasOwnProperty(i)&&(i===this._current||i==="default")&&(s=r[i],(s.rules&&Object.keys(s.rules).length>0||s.url&&t.indexOf(s.url)===-1)&&this.add(i,e),this._injected.push(i));this._current!="default"&&e.addClass(this._current)}add(e,t){var r=this._themes[e];!r||!t||(r.url?t.addStylesheet(r.url):r.serialized?(t.addStylesheetCss(r.serialized,e),r.injected=!0):r.rules&&(t.addStylesheetRules(r.rules,e),r.injected=!0))}override(e,t,r){var s=this.rendition.getContents();this._overrides[e]={value:t,priority:r===!0},s.forEach(i=>{i.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var t=this.rendition.getContents();delete this._overrides[e],t.forEach(r=>{r.css(e)})}overrides(e){var t=this._overrides;for(var r in t)t.hasOwnProperty(r)&&e.css(r,t[r].value,t[r].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}var dW=hW;Bg.default=dW;var _l={},bd={};Object.defineProperty(bd,"__esModule",{value:!0});bd.default=void 0;var vp=fW(Wr),Xk=je;function fW(n){return n&&n.__esModule?n:{default:n}}class pW{constructor(e,t,r,s=!1){this.layout=e,this.horizontal=r==="horizontal",this.direction=t||"ltr",this._dev=s}section(e){var t=this.findRanges(e),r=this.rangeListToCfiList(e.section.cfiBase,t);return r}page(e,t,r,s){var i=e&&e.document?e.document.body:!1,o;if(i){if(o=this.rangePairToCfiPair(t,{start:this.findStart(i,r,s),end:this.findEnd(i,r,s)}),this._dev===!0){let a=e.document,l=new vp.default(o.start).toRange(a),u=new vp.default(o.end).toRange(a),c=a.defaultView.getSelection(),h=a.createRange();c.removeAllRanges(),h.setStart(l.startContainer,l.startOffset),h.setEnd(u.endContainer,u.endOffset),c.addRange(h)}return o}}walk(e,t){if(!(e&&e.nodeType===Node.TEXT_NODE)){var r={acceptNode:function(l){return l.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},s=r.acceptNode;s.acceptNode=r.acceptNode;for(var i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,s,!1),o,a;(o=i.nextNode())&&(a=t(o),!a););return a}}findRanges(e){for(var t=[],r=e.contents.scrollWidth(),s=Math.ceil(r/this.layout.spreadWidth),i=s*this.layout.divisor,o=this.layout.columnWidth,a=this.layout.gap,l,u,c=0;c<i.pages;c++)l=(o+a)*c,u=o*(c+1)+a*c,t.push({start:this.findStart(e.document.body,l,u),end:this.findEnd(e.document.body,l,u)});return t}findStart(e,t,r){for(var s=[e],i,o,a=e;s.length;)if(i=s.shift(),o=this.walk(i,l=>{var u,c,h,d,f;if(f=(0,Xk.nodeBounds)(l),this.horizontal&&this.direction==="ltr"){if(u=this.horizontal?f.left:f.top,c=this.horizontal?f.right:f.bottom,u>=t&&u<=r)return l;if(c>t)return l;a=l,s.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(u=f.left,c=f.right,c<=r&&c>=t)return l;if(u<r)return l;a=l,s.push(l)}else{if(h=f.top,d=f.bottom,h>=t&&h<=r)return l;if(d>t)return l;a=l,s.push(l)}}),o)return this.findTextStartRange(o,t,r);return this.findTextStartRange(a,t,r)}findEnd(e,t,r){for(var s=[e],i,o=e,a;s.length;)if(i=s.shift(),a=this.walk(i,l=>{var u,c,h,d,f;if(f=(0,Xk.nodeBounds)(l),this.horizontal&&this.direction==="ltr"){if(u=Math.round(f.left),c=Math.round(f.right),u>r&&o)return o;if(c>r)return l;o=l,s.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(u=Math.round(this.horizontal?f.left:f.top),c=Math.round(this.horizontal?f.right:f.bottom),c<t&&o)return o;if(u<t)return l;o=l,s.push(l)}else{if(h=Math.round(f.top),d=Math.round(f.bottom),h>r&&o)return o;if(d>r)return l;o=l,s.push(l)}}),a)return this.findTextEndRange(a,t,r);return this.findTextEndRange(o,t,r)}findTextStartRange(e,t,r){for(var s=this.splitTextNodeIntoRanges(e),i,o,a,l,u,c=0;c<s.length;c++)if(i=s[c],o=i.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(a=o.left,a>=t)return i}else if(this.horizontal&&this.direction==="rtl"){if(u=o.right,u<=r)return i}else if(l=o.top,l>=t)return i;return s[0]}findTextEndRange(e,t,r){for(var s=this.splitTextNodeIntoRanges(e),i,o,a,l,u,c,h,d=0;d<s.length;d++){if(o=s[d],a=o.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(l=a.left,u=a.right,l>r&&i)return i;if(u>r)return o}else if(this.horizontal&&this.direction==="rtl"){if(l=a.left,u=a.right,u<t&&i)return i;if(l<t)return o}else{if(c=a.top,h=a.bottom,c>r&&i)return i;if(h>r)return o}i=o}return s[s.length-1]}splitTextNodeIntoRanges(e,t){var r=[],s=e.textContent||"",i=s.trim(),o,a=e.ownerDocument,l=t||" ",u=i.indexOf(l);if(u===-1||e.nodeType!=Node.TEXT_NODE)return o=a.createRange(),o.selectNodeContents(e),[o];for(o=a.createRange(),o.setStart(e,0),o.setEnd(e,u),r.push(o),o=!1;u!=-1;)u=i.indexOf(l,u+1),u>0&&(o&&(o.setEnd(e,u),r.push(o)),o=a.createRange(),o.setStart(e,u+1));return o&&(o.setEnd(e,i.length),r.push(o)),r}rangePairToCfiPair(e,t){var r=t.start,s=t.end;r.collapse(!0),s.collapse(!1);let i=new vp.default(r,e).toString(),o=new vp.default(s,e).toString();return{start:i,end:o}}rangeListToCfiList(e,t){for(var r=[],s,i=0;i<t.length;i++)s=this.rangePairToCfiPair(e,t[i]),r.push(s);return r}axis(e){return e&&(this.horizontal=e==="horizontal"),this.horizontal}}var mW=pW;bd.default=mW;Object.defineProperty(_l,"__esModule",{value:!0});_l.default=void 0;var gW=Kw(Zi),Qs=je,Ql=Kw(Wr),Yk=Kw(bd),vW=Ji,to=sr;function Kw(n){return n&&n.__esModule?n:{default:n}}const B$=typeof navigator<"u",yW=B$&&/Chrome/.test(navigator.userAgent),Zk=B$&&!yW&&/AppleWebKit/.test(navigator.userAgent),xW=1;class z${constructor(e,t,r,s){this.epubcfi=new Ql.default,this.document=e,this.documentElement=this.document.documentElement,this.content=t||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=s||0,this.cfiBase=r||"",this.epubReadingSystem("epub.js",to.EPUBJS_VERSION),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return to.DOM_EVENTS}width(e){var t=this.content;return e&&(0,Qs.isNumber)(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}height(e){var t=this.content;return e&&(0,Qs.isNumber)(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}contentWidth(e){var t=this.content||this.document.body;return e&&(0,Qs.isNumber)(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}contentHeight(e){var t=this.content||this.document.body;return e&&(0,Qs.isNumber)(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}textWidth(){let e,t,r=this.document.createRange(),s=this.content||this.document.body,i=(0,Qs.borders)(s);return r.selectNodeContents(s),e=r.getBoundingClientRect(),t=e.width,i&&i.width&&(t+=i.width),Math.round(t)}textHeight(){let e,t,r=this.document.createRange(),s=this.content||this.document.body;return r.selectNodeContents(s),e=r.getBoundingClientRect(),t=e.bottom,Math.round(t)}scrollWidth(){var e=this.documentElement.scrollWidth;return e}scrollHeight(){var e=this.documentElement.scrollHeight;return e}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,t,r){var s=this.content||this.document.body;return t?s.style.setProperty(e,t,r?"important":""):s.style.removeProperty(e),this.window.getComputedStyle(s)[e]}viewport(e){var t=this.document.querySelector("meta[name='viewport']"),r={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},s=[],i={};if(t&&t.hasAttribute("content")){let o=t.getAttribute("content"),a=o.match(/width\s*=\s*([^,]*)/),l=o.match(/height\s*=\s*([^,]*)/),u=o.match(/initial-scale\s*=\s*([^,]*)/),c=o.match(/minimum-scale\s*=\s*([^,]*)/),h=o.match(/maximum-scale\s*=\s*([^,]*)/),d=o.match(/user-scalable\s*=\s*([^,]*)/);a&&a.length&&typeof a[1]<"u"&&(r.width=a[1]),l&&l.length&&typeof l[1]<"u"&&(r.height=l[1]),u&&u.length&&typeof u[1]<"u"&&(r.scale=u[1]),c&&c.length&&typeof c[1]<"u"&&(r.minimum=c[1]),h&&h.length&&typeof h[1]<"u"&&(r.maximum=h[1]),d&&d.length&&typeof d[1]<"u"&&(r.scalable=d[1])}return i=(0,Qs.defaults)(e||{},r),e&&(i.width&&s.push("width="+i.width),i.height&&s.push("height="+i.height),i.scale&&s.push("initial-scale="+i.scale),i.scalable==="no"?(s.push("minimum-scale="+i.scale),s.push("maximum-scale="+i.scale),s.push("user-scalable="+i.scalable)):(i.scalable&&s.push("user-scalable="+i.scalable),i.minimum&&s.push("minimum-scale="+i.minimum),i.maximum&&s.push("minimum-scale="+i.maximum)),t||(t=this.document.createElement("meta"),t.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(t)),t.setAttribute("content",s.join(", ")),this.window.scrollTo(0,0)),i}expand(){this.emit(to.EVENTS.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver>"u"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),t=this.textHeight();(e!=this._size.width||t!=this._size.height)&&(this._size={width:e,height:t},this.onResize&&this.onResize(this._size),this.emit(to.EVENTS.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,t=(function(a){a.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}).bind(this),r=0;r<e.length;r+=1){var s;try{s=e[r].cssRules}catch{return}if(!s)return;for(var i=0;i<s.length;i+=1)if(s[i].media){var o=this.window.matchMedia(s[i].media.mediaText);o.addListener(t)}}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(t=>{this.resizeCheck()});let e={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,e)}imageLoadListeners(){for(var e=this.document.querySelectorAll("img"),t,r=0;r<e.length;r++)t=e[r],typeof t.naturalWidth<"u"&&t.naturalWidth===0&&(t.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then((function(){this.resizeCheck()}).bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,t){var r,s={left:0,top:0};if(!this.document)return s;if(this.epubcfi.isCfiString(e)){let i=new Ql.default(e).toRange(this.document,t);if(i){try{if(!i.endContainer||i.startContainer==i.endContainer&&i.startOffset==i.endOffset){let o=i.startContainer.textContent.indexOf(" ",i.startOffset);o==-1&&(o=i.startContainer.textContent.length),i.setEnd(i.startContainer,o)}}catch(o){console.error("setting end offset to start container length failed",o)}if(i.startContainer.nodeType===Node.ELEMENT_NODE)r=i.startContainer.getBoundingClientRect(),s.left=r.left,s.top=r.top;else if(Zk){let o=i.startContainer,a=new Range;try{o.nodeType===xW?r=o.getBoundingClientRect():i.startOffset+2<o.length?(a.setStart(o,i.startOffset),a.setEnd(o,i.startOffset+2),r=a.getBoundingClientRect()):i.startOffset-2>0?(a.setStart(o,i.startOffset-2),a.setEnd(o,i.startOffset),r=a.getBoundingClientRect()):r=o.parentNode.getBoundingClientRect()}catch(l){console.error(l,l.stack)}}else r=i.getBoundingClientRect()}}else if(typeof e=="string"&&e.indexOf("#")>-1){let i=e.substring(e.indexOf("#")+1),o=this.document.getElementById(i);if(o)if(Zk){let a=new Range;a.selectNode(o),r=a.getBoundingClientRect()}else r=o.getBoundingClientRect()}return r&&(s.left=r.left,s.top=r.top),s}addStylesheet(e){return new Promise((function(t,r){var s,i=!1;if(!this.document){t(!1);return}if(s=this.document.querySelector("link[href='"+e+"']"),s){t(!0);return}s=this.document.createElement("link"),s.type="text/css",s.rel="stylesheet",s.href=e,s.onload=s.onreadystatechange=function(){!i&&(!this.readyState||this.readyState=="complete")&&(i=!0,setTimeout(()=>{t(!0)},1))},this.document.head.appendChild(s)}).bind(this))}_getStylesheetNode(e){var t;return e="epubjs-inserted-css-"+(e||""),this.document?(t=this.document.getElementById(e),t||(t=this.document.createElement("style"),t.id=e,this.document.head.appendChild(t)),t):!1}addStylesheetCss(e,t){if(!this.document||!e)return!1;var r;return r=this._getStylesheetNode(t),r.innerHTML=e,!0}addStylesheetRules(e,t){var r;if(!(!this.document||!e||e.length===0))if(r=this._getStylesheetNode(t).sheet,Object.prototype.toString.call(e)==="[object Array]")for(var s=0,i=e.length;s<i;s++){var o=1,a=e[s],l=e[s][0],u="";Object.prototype.toString.call(a[1][0])==="[object Array]"&&(a=a[1],o=0);for(var c=a.length;o<c;o++){var h=a[o];u+=h[0]+":"+h[1]+(h[2]?" !important":"")+`;
`}r.insertRule(l+"{"+u+"}",r.cssRules.length)}else Object.keys(e).forEach(f=>{const p=e[f];if(Array.isArray(p))p.forEach(v=>{const m=Object.keys(v).map(y=>`${y}:${v[y]}`).join(";");r.insertRule(`${f}{${m}}`,r.cssRules.length)});else{const g=Object.keys(p).map(m=>`${m}:${p[m]}`).join(";");r.insertRule(`${f}{${g}}`,r.cssRules.length)}})}addScript(e){return new Promise((function(t,r){var s,i=!1;if(!this.document){t(!1);return}s=this.document.createElement("script"),s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){!i&&(!this.readyState||this.readyState=="complete")&&(i=!0,setTimeout(function(){t(!0)},1))},this.document.head.appendChild(s)}).bind(this))}addClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.add(e))}removeClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.remove(e))}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),to.DOM_EVENTS.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){this.document&&(to.DOM_EVENTS.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout((function(){var t=this.window.getSelection();this.triggerSelectedEvent(t)}).bind(this),250)}triggerSelectedEvent(e){var t,r;e&&e.rangeCount>0&&(t=e.getRangeAt(0),t.collapsed||(r=new Ql.default(t,this.cfiBase).toString(),this.emit(to.EVENTS.CONTENTS.SELECTED,r),this.emit(to.EVENTS.CONTENTS.SELECTED_RANGE,t)))}range(e,t){var r=new Ql.default(e);return r.toRange(this.document,t)}cfiFromRange(e,t){return new Ql.default(e,this.cfiBase,t).toString()}cfiFromNode(e,t){return new Ql.default(e,this.cfiBase,t).toString()}map(e){var t=new Yk.default(e);return t.section()}size(e,t){var r={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),r.width=e,this.css("padding","0 "+e/12+"px")),t>=0&&(this.height(t),r.height=t),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(r)}columns(e,t,r,s,i){let o=(0,Qs.prefixed)("column-axis"),a=(0,Qs.prefixed)("column-gap"),l=(0,Qs.prefixed)("column-width"),u=(0,Qs.prefixed)("column-fill"),h=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),i==="rtl"&&h==="horizontal"&&this.direction(i),this.width(e),this.height(t),this.viewport({width:e,height:t,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),h==="vertical"?(this.css("padding-top",s/2+"px",!0),this.css("padding-bottom",s/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(o,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",s/2+"px",!0),this.css("padding-right",s/2+"px",!0),this.css(o,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(u,"auto"),this.css(a,s+"px"),this.css(l,r+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,t,r){var s="scale("+e+")",i="";this.css("transform-origin","top left"),(t>=0||r>=0)&&(i=" translate("+(t||0)+"px, "+(r||0)+"px )"),this.css("transform",s+i)}fit(e,t,r){var s=this.viewport(),i=parseInt(s.width),o=parseInt(s.height),a=e/i,l=t/o,u=a<l?a:l;if(this.layoutStyle("paginated"),this.width(i),this.height(o),this.overflow("hidden"),this.scaler(u,0,0),this.css("background-size",i*u+"px "+o*u+"px"),this.css("background-color","transparent"),r&&r.properties.includes("page-spread-left")){var c=e-i*u;this.css("margin-left",c+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,t,r,s,i){var o=new Yk.default(t,i);return o.page(this,e,r,s)}linksHandler(){(0,vW.replaceLinks)(this.content,e=>{this.emit(to.EVENTS.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let t=(0,Qs.prefixed)("writing-mode");return e&&this.documentElement&&(this.documentElement.style[t]=e),this.window.getComputedStyle(this.documentElement)[t]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,t){return navigator.epubReadingSystem={name:e,version:t,layoutStyle:this.layoutStyle(),hasFeature:function(r){switch(r){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}(0,gW.default)(z$.prototype);var wW=z$;_l.default=wW;var zg={};Object.defineProperty(zg,"__esModule",{value:!0});zg.default=void 0;var bW=U$(Zi),CW=U$(Wr),Qk=sr;function U$(n){return n&&n.__esModule?n:{default:n}}class SW{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,t,r,s,i,o){let a=encodeURI(t+e),u=new CW.default(t).spinePos,c=new V$({type:e,cfiRange:t,data:r,sectionIndex:u,cb:s,className:i,styles:o});return this._annotations[a]=c,u in this._annotationsBySectionIndex?this._annotationsBySectionIndex[u].push(a):this._annotationsBySectionIndex[u]=[a],this.rendition.views().forEach(d=>{c.sectionIndex===d.index&&c.attach(d)}),c}remove(e,t){let r=encodeURI(e+t);if(r in this._annotations){let s=this._annotations[r];if(t&&s.type!==t)return;this.rendition.views().forEach(o=>{this._removeFromAnnotationBySectionIndex(s.sectionIndex,r),s.sectionIndex===o.index&&s.detach(o)}),delete this._annotations[r]}}_removeFromAnnotationBySectionIndex(e,t){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(r=>r!==t)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,t,r,s,i){return this.add("highlight",e,t,r,s,i)}underline(e,t,r,s,i){return this.add("underline",e,t,r,s,i)}mark(e,t,r){return this.add("mark",e,t,r)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(s=>{this._annotations[s].attach(e)})}clear(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(s=>{this._annotations[s].detach(e)})}show(){}hide(){}}class V${constructor({type:e,cfiRange:t,data:r,sectionIndex:s,cb:i,className:o,styles:a}){this.type=e,this.cfiRange=t,this.data=r,this.sectionIndex=s,this.mark=void 0,this.cb=i,this.className=o,this.styles=a}update(e){this.data=e}attach(e){let{cfiRange:t,data:r,type:s,mark:i,cb:o,className:a,styles:l}=this,u;return s==="highlight"?u=e.highlight(t,r,o,a,l):s==="underline"?u=e.underline(t,r,o,a,l):s==="mark"&&(u=e.mark(t,r,o)),this.mark=u,this.emit(Qk.EVENTS.ANNOTATION.ATTACH,u),u}detach(e){let{cfiRange:t,type:r}=this,s;return e&&(r==="highlight"?s=e.unhighlight(t):r==="underline"?s=e.ununderline(t):r==="mark"&&(s=e.unmark(t))),this.mark=void 0,this.emit(Qk.EVENTS.ANNOTATION.DETACH,s),s}text(){}}(0,bW.default)(V$.prototype);var kW=SW;zg.default=kW;var Cd={},Fi={},Ug={};Object.defineProperty(Ug,"__esModule",{value:!0});Ug.createElement=W$;function W$(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}Ug.default={createElement:W$};var Sd={};Object.defineProperty(Sd,"__esModule",{value:!0});Sd.proxyMouse=G$;Sd.clone=j$;Sd.default={proxyMouse:G$};function G$(n,e){function t(o){for(var a=e.length-1;a>=0;a--){var l=e[a],u=o.clientX,c=o.clientY;if(o.touches&&o.touches.length&&(u=o.touches[0].clientX,c=o.touches[0].clientY),!!EW(l,n,u,c)){l.dispatchEvent(j$(o));break}}}if(n.nodeName==="iframe"||n.nodeName==="IFRAME")try{this.target=n.contentDocument}catch{this.target=n}else this.target=n;for(var r=["mouseup","mousedown","click","touchstart"],s=0;s<r.length;s++){var i=r[s];this.target.addEventListener(i,function(o){return t(o)},!1)}}function j$(n){var e=Object.assign({},n,{bubbles:!1});try{return new MouseEvent(n.type,e)}catch{var t=document.createEvent("MouseEvents");return t.initMouseEvent(n.type,!1,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),t}}function EW(n,e,t,r){var s=e.getBoundingClientRect();function i(c,h,d){var f=c.top-s.top,p=c.left-s.left,v=f+c.height,g=p+c.width;return f<=d&&p<=h&&v>d&&g>h}var o=n.getBoundingClientRect();if(!i(o,t,r))return!1;for(var a=n.getClientRects(),l=0,u=a.length;l<u;l++)if(i(a[l],t,r))return!0;return!1}Object.defineProperty(Fi,"__esModule",{value:!0});Fi.Underline=Fi.Highlight=Fi.Mark=Fi.Pane=void 0;var IW=function n(e,t,r){e===null&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,t);if(s===void 0){var i=Object.getPrototypeOf(e);return i===null?void 0:n(i,t,r)}else{if("value"in s)return s.value;var o=s.get;return o===void 0?void 0:o.call(r)}},Vg=function(){function n(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),TW=Ug,Hh=H$(TW),_W=Sd,NW=H$(_W);function H$(n){return n&&n.__esModule?n:{default:n}}function q$(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n}function K$(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)}function Wg(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Fi.Pane=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;Wg(this,n),this.target=e,this.element=Hh.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),NW.default.proxyMouse(this.target,this.marks),this.container=t,this.container.appendChild(this.element),this.render()}return Vg(n,[{key:"addMark",value:function(t){var r=Hh.default.createElement("g");return this.element.appendChild(r),t.bind(r,this.container),this.marks.push(t),t.render(),t}},{key:"removeMark",value:function(t){var r=this.marks.indexOf(t);if(r!==-1){var s=t.unbind();this.element.removeChild(s),this.marks.splice(r,1)}}},{key:"render",value:function(){RW(this.element,AW(this.target,this.container));var t=!0,r=!1,s=void 0;try{for(var i=this.marks[Symbol.iterator](),o;!(t=(o=i.next()).done);t=!0){var a=o.value;a.render()}}catch(l){r=!0,s=l}finally{try{!t&&i.return&&i.return()}finally{if(r)throw s}}}}]),n}();var $W=Fi.Mark=function(){function n(){Wg(this,n),this.element=null}return Vg(n,[{key:"bind",value:function(t,r){this.element=t,this.container=r}},{key:"unbind",value:function(){var t=this.element;return this.element=null,t}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(t){this.element&&this.element.dispatchEvent(t)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var t=[],r=this.element.firstChild;r;)t.push(r.getBoundingClientRect()),r=r.nextSibling;return t}},{key:"filteredRanges",value:function(){var t=Array.from(this.range.getClientRects());return t.filter(function(r){for(var s=0;s<t.length;s++){if(t[s]===r)return!0;var i=OW(t[s],r);if(i)return!1}return!0})}}]),n}(),DW=Fi.Highlight=function(n){K$(e,n);function e(t,r,s,i){Wg(this,e);var o=q$(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.range=t,o.className=r,o.data=s||{},o.attributes=i||{},o}return Vg(e,[{key:"bind",value:function(r,s){IW(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bind",this).call(this,r,s);for(var i in this.data)this.data.hasOwnProperty(i)&&(this.element.dataset[i]=this.data[i]);for(var i in this.attributes)this.attributes.hasOwnProperty(i)&&this.element.setAttribute(i,this.attributes[i]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var r=this.element.ownerDocument.createDocumentFragment(),s=this.filteredRanges(),i=this.element.getBoundingClientRect(),o=this.container.getBoundingClientRect(),a=0,l=s.length;a<l;a++){var u=s[a],c=Hh.default.createElement("rect");c.setAttribute("x",u.left-i.left+o.left),c.setAttribute("y",u.top-i.top+o.top),c.setAttribute("height",u.height),c.setAttribute("width",u.width),r.appendChild(c)}this.element.appendChild(r)}}]),e}($W);Fi.Underline=function(n){K$(e,n);function e(t,r,s,i){return Wg(this,e),q$(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,s,i))}return Vg(e,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var r=this.element.ownerDocument.createDocumentFragment(),s=this.filteredRanges(),i=this.element.getBoundingClientRect(),o=this.container.getBoundingClientRect(),a=0,l=s.length;a<l;a++){var u=s[a],c=Hh.default.createElement("rect");c.setAttribute("x",u.left-i.left+o.left),c.setAttribute("y",u.top-i.top+o.top),c.setAttribute("height",u.height),c.setAttribute("width",u.width),c.setAttribute("fill","none");var h=Hh.default.createElement("line");h.setAttribute("x1",u.left-i.left+o.left),h.setAttribute("x2",u.left-i.left+o.left+u.width),h.setAttribute("y1",u.top-i.top+o.top+u.height-1),h.setAttribute("y2",u.top-i.top+o.top+u.height-1),h.setAttribute("stroke-width",1),h.setAttribute("stroke","black"),h.setAttribute("stroke-linecap","square"),r.appendChild(c),r.appendChild(h)}this.element.appendChild(r)}}]),e}(DW);function AW(n,e){var t=e.getBoundingClientRect(),r=n.getBoundingClientRect();return{top:r.top-t.top,left:r.left-t.left,height:n.scrollHeight,width:n.scrollWidth}}function RW(n,e){n.style.setProperty("top",e.top+"px","important"),n.style.setProperty("left",e.left+"px","important"),n.style.setProperty("height",e.height+"px","important"),n.style.setProperty("width",e.width+"px","important")}function OW(n,e){return e.right<=n.right&&e.left>=n.left&&e.top>=n.top&&e.bottom<=n.bottom}Object.defineProperty(Cd,"__esModule",{value:!0});Cd.default=void 0;var FW=Xw(Zi),cr=je,LW=Xw(Wr),PW=Xw(_l),us=sr,yp=Fi;function Xw(n){return n&&n.__esModule?n:{default:n}}class X${constructor(e,t){this.settings=(0,cr.extend)({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},t||{}),this.id="epubjs-view-"+(0,cr.uuid)(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new LW.default,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var t=document.createElement("div");return t.classList.add("epub-view"),t.style.height="0px",t.style.width="0px",t.style.overflow="hidden",t.style.position="relative",t.style.display="block",e&&e=="horizontal"?t.style.flex="none":t.style.flex="initial",t}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=(0,cr.bounds)(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(e,t){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then((function(r){return this.load(r)}).bind(this)).then((function(){let r=this.contents.writingMode(),s;return this.settings.flow==="scrolled"?s=r.indexOf("vertical")===0?"horizontal":"vertical":s=r.indexOf("vertical")===0?"vertical":"horizontal",r.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(s),this.emit(us.EVENTS.VIEWS.AXIS,s),this.setWritingMode(r),this.emit(us.EVENTS.VIEWS.WRITING_MODE,r),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((i,o)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),i()})}).bind(this),(function(r){return this.emit(us.EVENTS.VIEWS.LOAD_ERROR,r),new Promise((s,i)=>{i(r)})}).bind(this)).then((function(){this.emit(us.EVENTS.VIEWS.RENDERED,this.section)}).bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,t){var r=e||this.settings.width,s=t||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",r,s):this.settings.axis==="horizontal"?this.lock("height",r,s):this.lock("width",r,s),this.settings.width=r,this.settings.height=s}lock(e,t,r){var s=(0,cr.borders)(this.element),i;this.iframe?i=(0,cr.borders)(this.iframe):i={width:0,height:0},e=="width"&&(0,cr.isNumber)(t)&&(this.lockedWidth=t-s.width-i.width),e=="height"&&(0,cr.isNumber)(r)&&(this.lockedHeight=r-s.height-i.height),e==="both"&&(0,cr.isNumber)(t)&&(0,cr.isNumber)(r)&&(this.lockedWidth=t-s.width-i.width,this.lockedHeight=r-s.height-i.height),this.displayed&&this.iframe&&this.expand()}expand(e){var t=this.lockedWidth,r=this.lockedHeight,s;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(t=this.layout.columnWidth,r=this.layout.height):this.settings.axis==="horizontal"?(t=this.contents.textWidth(),t%this.layout.pageWidth>0&&(t=Math.ceil(t/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(s=t/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&s%2>0&&(t+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(r=this.contents.textHeight(),this.settings.flow==="paginated"&&r%this.layout.height>0&&(r=Math.ceil(r/this.layout.height)*this.layout.height)),(this._needsReframe||t!=this._width||r!=this._height)&&this.reframe(t,r),this._expanding=!1)}reframe(e,t){var r;(0,cr.isNumber)(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),(0,cr.isNumber)(t)&&(this.element.style.height=t+"px",this.iframe.style.height=t+"px",this._height=t);let s=this.prevBounds?e-this.prevBounds.width:e,i=this.prevBounds?t-this.prevBounds.height:t;r={width:e,height:t,widthDelta:s,heightDelta:i},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let o;for(let a in this.marks)this.marks.hasOwnProperty(a)&&(o=this.marks[a],this.placeMark(o.element,o.range))}),this.onResize(this,r),this.emit(us.EVENTS.VIEWS.RESIZED,r),this.prevBounds=r,this.elementBounds=(0,cr.bounds)(this.element)}load(e){var t=new cr.defer,r=t.promise;if(!this.iframe)return t.reject(new Error("No Iframe Available")),r;if(this.iframe.onload=(function(i){this.onLoad(i,t)}).bind(this),this.settings.method==="blobUrl")this.blobUrl=(0,cr.createBlobUrl)(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return t.reject(new Error("No Document Available")),r;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var s=this;MSApp.execUnsafeLocalFunction(function(){s.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return r}onLoad(e,t){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new PW.default(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var r=this.document.querySelector("link[rel='canonical']");r?r.setAttribute("href",this.section.canonical):(r=this.document.createElement("link"),r.setAttribute("rel","canonical"),r.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(r)),this.contents.on(us.EVENTS.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(us.EVENTS.CONTENTS.RESIZE,s=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),t.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,e=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var t=new cr.defer;return this.displayed?t.resolve(this):this.render(e).then((function(){this.emit(us.EVENTS.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,t.resolve(this)}).bind(this),function(r){t.reject(r,this)}),t.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(us.EVENTS.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(us.EVENTS.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var t=this.contents.locationOf(e,this.settings.ignoreClass);return{left:t.left,top:t.top}}onDisplayed(e){}onResize(e,t){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=(0,cr.bounds)(this.element)),this.elementBounds}highlight(e,t={},r,s="epubjs-hl",i={}){if(!this.contents)return;const o=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},i);let a=this.contents.range(e),l=()=>{this.emit(us.EVENTS.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new yp.Pane(this.iframe,this.element));let u=new yp.Highlight(a,s,t,o),c=this.pane.addMark(u);return this.highlights[e]={mark:c,element:c.element,listeners:[l,r]},c.element.setAttribute("ref",s),c.element.addEventListener("click",l),c.element.addEventListener("touchstart",l),r&&(c.element.addEventListener("click",r),c.element.addEventListener("touchstart",r)),c}underline(e,t={},r,s="epubjs-ul",i={}){if(!this.contents)return;const o=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},i);let a=this.contents.range(e),l=()=>{this.emit(us.EVENTS.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new yp.Pane(this.iframe,this.element));let u=new yp.Underline(a,s,t,o),c=this.pane.addMark(u);return this.underlines[e]={mark:c,element:c.element,listeners:[l,r]},c.element.setAttribute("ref",s),c.element.addEventListener("click",l),c.element.addEventListener("touchstart",l),r&&(c.element.addEventListener("click",r),c.element.addEventListener("touchstart",r)),c}mark(e,t={},r){if(!this.contents)return;if(e in this.marks)return this.marks[e];let s=this.contents.range(e);if(!s)return;let i=s.commonAncestorContainer,o=i.nodeType===1?i:i.parentNode,a=u=>{this.emit(us.EVENTS.VIEWS.MARK_CLICKED,e,t)};s.collapsed&&i.nodeType===1?(s=new Range,s.selectNodeContents(i)):s.collapsed&&(s=new Range,s.selectNodeContents(o));let l=this.document.createElement("a");return l.setAttribute("ref","epubjs-mk"),l.style.position="absolute",l.dataset.epubcfi=e,t&&Object.keys(t).forEach(u=>{l.dataset[u]=t[u]}),r&&(l.addEventListener("click",r),l.addEventListener("touchstart",r)),l.addEventListener("click",a),l.addEventListener("touchstart",a),this.placeMark(l,s),this.element.appendChild(l),this.marks[e]={element:l,range:s,listeners:[a,r]},o}placeMark(e,t){let r,s,i;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let a=t.getBoundingClientRect();r=a.top,s=a.right}else{let a=t.getClientRects(),l;for(var o=0;o!=a.length;o++)l=a[o],(!i||l.left<i)&&(i=l.left,s=Math.ceil(i/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,r=l.top)}e.style.top=`${r}px`,e.style.left=`${s}px`}unhighlight(e){let t;e in this.highlights&&(t=this.highlights[e],this.pane.removeMark(t.mark),t.listeners.forEach(r=>{r&&(t.element.removeEventListener("click",r),t.element.removeEventListener("touchstart",r))}),delete this.highlights[e])}ununderline(e){let t;e in this.underlines&&(t=this.underlines[e],this.pane.removeMark(t.mark),t.listeners.forEach(r=>{r&&(t.element.removeEventListener("click",r),t.element.removeEventListener("touchstart",r))}),delete this.underlines[e])}unmark(e){let t;e in this.marks&&(t=this.marks[e],this.element.removeChild(t.element),t.listeners.forEach(r=>{r&&(t.element.removeEventListener("click",r),t.element.removeEventListener("touchstart",r))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&(0,cr.revokeBlobUrl)(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}(0,FW.default)(X$.prototype);var MW=X$;Cd.default=MW;var cc={},Gg={};Object.defineProperty(Gg,"__esModule",{value:!0});Gg.createDefiner=Y$;Gg.default=BW;function BW(){var n="reverse",e=Y$();return document.body.appendChild(e),e.scrollLeft>0?n="default":typeof Element<"u"&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(n="negative")):(e.scrollLeft=1,e.scrollLeft===0&&(n="negative")),document.body.removeChild(e),n}function Y$(){var n=document.createElement("div");n.dir="rtl",n.style.position="fixed",n.style.width="1px",n.style.height="1px",n.style.top="0px",n.style.left="0px",n.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var t=document.createElement("span");t.style.width="1px",t.style.display="inline-block";var r=document.createElement("span");return r.style.width="1px",r.style.display="inline-block",e.appendChild(t),e.appendChild(r),n.appendChild(e),n}var jg={};function zW(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var Yw=zW,UW=typeof gn=="object"&&gn&&gn.Object===Object&&gn,VW=UW,WW=VW,GW=typeof self=="object"&&self&&self.Object===Object&&self,jW=WW||GW||Function("return this")(),Z$=jW,HW=Z$,qW=function(){return HW.Date.now()},KW=qW,XW=/\s/;function YW(n){for(var e=n.length;e--&&XW.test(n.charAt(e)););return e}var ZW=YW,QW=ZW,JW=/^\s+/;function e6(n){return n&&n.slice(0,QW(n)+1).replace(JW,"")}var t6=e6,n6=Z$,r6=n6.Symbol,Q$=r6,Jk=Q$,J$=Object.prototype,s6=J$.hasOwnProperty,i6=J$.toString,qc=Jk?Jk.toStringTag:void 0;function o6(n){var e=s6.call(n,qc),t=n[qc];try{n[qc]=void 0;var r=!0}catch{}var s=i6.call(n);return r&&(e?n[qc]=t:delete n[qc]),s}var a6=o6,l6=Object.prototype,u6=l6.toString;function c6(n){return u6.call(n)}var h6=c6,eE=Q$,d6=a6,f6=h6,p6="[object Null]",m6="[object Undefined]",tE=eE?eE.toStringTag:void 0;function g6(n){return n==null?n===void 0?m6:p6:tE&&tE in Object(n)?d6(n):f6(n)}var v6=g6;function y6(n){return n!=null&&typeof n=="object"}var x6=y6,w6=v6,b6=x6,C6="[object Symbol]";function S6(n){return typeof n=="symbol"||b6(n)&&w6(n)==C6}var k6=S6,E6=t6,nE=Yw,I6=k6,rE=0/0,T6=/^[-+]0x[0-9a-f]+$/i,_6=/^0b[01]+$/i,N6=/^0o[0-7]+$/i,$6=parseInt;function D6(n){if(typeof n=="number")return n;if(I6(n))return rE;if(nE(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=nE(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=E6(n);var t=_6.test(n);return t||N6.test(n)?$6(n.slice(2),t?2:8):T6.test(n)?rE:+n}var A6=D6,R6=Yw,xy=KW,sE=A6,O6="Expected a function",F6=Math.max,L6=Math.min;function P6(n,e,t){var r,s,i,o,a,l,u=0,c=!1,h=!1,d=!0;if(typeof n!="function")throw new TypeError(O6);e=sE(e)||0,R6(t)&&(c=!!t.leading,h="maxWait"in t,i=h?F6(sE(t.maxWait)||0,e):i,d="trailing"in t?!!t.trailing:d);function f(C){var k=r,E=s;return r=s=void 0,u=C,o=n.apply(E,k),o}function p(C){return u=C,a=setTimeout(m,e),c?f(C):o}function v(C){var k=C-l,E=C-u,T=e-k;return h?L6(T,i-E):T}function g(C){var k=C-l,E=C-u;return l===void 0||k>=e||k<0||h&&E>=i}function m(){var C=xy();if(g(C))return y(C);a=setTimeout(m,v(C))}function y(C){return a=void 0,d&&r?f(C):(r=s=void 0,o)}function w(){a!==void 0&&clearTimeout(a),u=0,r=l=s=a=void 0}function x(){return a===void 0?o:y(xy())}function b(){var C=xy(),k=g(C);if(r=arguments,s=this,l=C,k){if(a===void 0)return p(l);if(h)return clearTimeout(a),a=setTimeout(m,e),f(l)}return a===void 0&&(a=setTimeout(m,e)),o}return b.cancel=w,b.flush=x,b}var eD=P6,M6=eD,B6=Yw,z6="Expected a function";function U6(n,e,t){var r=!0,s=!0;if(typeof n!="function")throw new TypeError(z6);return B6(t)&&(r="leading"in t?!!t.leading:r,s="trailing"in t?!!t.trailing:s),M6(n,e,{leading:r,maxWait:e,trailing:s})}var V6=U6;Object.defineProperty(jg,"__esModule",{value:!0});jg.default=void 0;var cs=je,W6=G6(V6);function G6(n){return n&&n.__esModule?n:{default:n}}class j6{constructor(e){this.settings=e||{},this.id="epubjs-container-"+(0,cs.uuid)(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let t=e.height,r=e.width,s=e.overflow||!1,i=e.axis||"vertical",o=e.direction;(0,cs.extend)(this.settings,e),e.height&&(0,cs.isNumber)(e.height)&&(t=e.height+"px"),e.width&&(0,cs.isNumber)(e.width)&&(r=e.width+"px");let a=document.createElement("div");return a.id=this.id,a.classList.add("epub-container"),a.style.wordSpacing="0",a.style.lineHeight="0",a.style.verticalAlign="top",a.style.position="relative",i==="horizontal"&&(a.style.display="flex",a.style.flexDirection="row",a.style.flexWrap="nowrap"),r&&(a.style.width=r),t&&(a.style.height=t),s&&(s==="scroll"&&i==="vertical"?(a.style["overflow-y"]=s,a.style["overflow-x"]="hidden"):s==="scroll"&&i==="horizontal"?(a.style["overflow-y"]="hidden",a.style["overflow-x"]=s):a.style.overflow=s),o&&(a.dir=o,a.style.direction=o),o&&this.settings.fullsize&&(document.body.style.direction=o),a}wrap(e){var t=document.createElement("div");return t.style.visibility="hidden",t.style.overflow="hidden",t.style.width="0",t.style.height="0",t.appendChild(e),t}getElement(e){var t;if((0,cs.isElement)(e)?t=e:typeof e=="string"&&(t=document.getElementById(e)),!t)throw new Error("Not an Element");return t}attachTo(e){var t=this.getElement(e),r;if(t)return this.settings.hidden?r=this.wrapper:r=this.container,t.appendChild(r),this.element=t,t}getContainer(){return this.container}onResize(e){(!(0,cs.isNumber)(this.settings.width)||!(0,cs.isNumber)(this.settings.height))&&(this.resizeFunc=(0,W6.default)(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,t){var r;let s=e||this.settings.width,i=t||this.settings.height;e===null?(r=this.element.getBoundingClientRect(),r.width&&(e=Math.floor(r.width),this.container.style.width=e+"px")):(0,cs.isNumber)(e)?this.container.style.width=e+"px":this.container.style.width=e,t===null?(r=r||this.element.getBoundingClientRect(),r.height&&(t=r.height,this.container.style.height=t+"px")):(0,cs.isNumber)(t)?this.container.style.height=t+"px":this.container.style.height=t,(0,cs.isNumber)(e)||(e=this.container.clientWidth),(0,cs.isNumber)(t)||(t=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let o=(0,cs.windowBounds)(),a=window.getComputedStyle(document.body),l={left:parseFloat(a["padding-left"])||0,right:parseFloat(a["padding-right"])||0,top:parseFloat(a["padding-top"])||0,bottom:parseFloat(a["padding-bottom"])||0};return s||(e=o.width-l.left-l.right),(this.settings.fullsize&&!i||!i)&&(t=o.height-l.top-l.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:t-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return this.container.style.overflow!=="visible"&&(e=this.container&&this.container.getBoundingClientRect()),!e||!e.width||!e.height?(0,cs.windowBounds)():e}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,t){var r="#"+this.id+" ",s="";this.sheet||(this.sheet=this.getSheet()),t.forEach(function(i){for(var o in i)i.hasOwnProperty(o)&&(s+=o+":"+i[o]+";")}),this.sheet.insertRule(r+e+" {"+s+"}",0)}axis(e){e==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&(e==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):e==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}var H6=j6;jg.default=H6;var Hg={};Object.defineProperty(Hg,"__esModule",{value:!0});Hg.default=void 0;class q6{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,t){return this._views.splice(t,0,e),this.container&&(t<this.container.children.length?this.container.insertBefore(e.element,this.container.children[t]):this.container.appendChild(e.element)),this.length++,e}remove(e){var t=this._views.indexOf(e);t>-1&&this._views.splice(t,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,t=this.length;if(this.length){for(var r=0;r<t;r++)e=this._views[r],this.destroy(e);this._views=[],this.length=0}}find(e){for(var t,r=this.length,s=0;s<r;s++)if(t=this._views[s],t.displayed&&t.section.index==e.index)return t}displayed(){for(var e=[],t,r=this.length,s=0;s<r;s++)t=this._views[s],t.displayed&&e.push(t);return e}show(){for(var e,t=this.length,r=0;r<t;r++)e=this._views[r],e.displayed&&e.show();this.hidden=!1}hide(){for(var e,t=this.length,r=0;r<t;r++)e=this._views[r],e.displayed&&e.hide();this.hidden=!0}}var K6=q6;Hg.default=K6;Object.defineProperty(cc,"__esModule",{value:!0});cc.default=void 0;var X6=hc(Zi),Jl=je,Y6=hc(Gg),iE=hc(bd),Z6=hc(ua),Q6=hc(jg),J6=hc(Hg),hs=sr;function hc(n){return n&&n.__esModule?n:{default:n}}class tD{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new Z6.default(this),this.settings=(0,Jl.extend)(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),(0,Jl.extend)(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,t){let r=e.tagName;typeof this.settings.fullsize>"u"&&r&&(r.toLowerCase()=="body"||r.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=t,this.settings.rtlScrollType=(0,Y6.default)(),this.stage=new Q6.default({width:t.width,height:t.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new J6.default(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",(function(t){this.destroy()}).bind(this)),this.settings.fullsize?e=window:e=this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:t}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout((function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(hs.EVENTS.MANAGERS.ORIENTATION_CHANGE,t)}).bind(this),500)}onResized(e){this.resize()}resize(e,t,r){let s=this.stage.size(e,t);if(this.winBounds=(0,Jl.windowBounds)(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===s.width&&this._stageSize.height===s.height||(this._stageSize=s,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(hs.EVENTS.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},r))}createView(e,t){return new this.View(e,(0,Jl.extend)(this.viewSettings,{forceRight:t}))}handleNextPrePaginated(e,t,r){let s;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(e||t.index===0)return;if(s=t.next(),s&&!s.properties.includes("page-spread-left"))return r.call(this,s)}}display(e,t){var r=new Jl.defer,s=r.promise;(t===e.href||(0,Jl.isNumber)(t))&&(t=void 0);var i=this.views.find(e);if(i&&e&&this.layout.name!=="pre-paginated"){let a=i.offset();if(this.settings.direction==="ltr")this.scrollTo(a.left,a.top,!0);else{let l=i.width();this.scrollTo(a.left+l,a.top,!0)}if(t){let l=i.locationOf(t),u=i.width();this.moveTo(l,u)}return r.resolve(),s}this.clear();let o=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(o=!0),this.add(e,o).then((function(a){if(t){let l=a.locationOf(t),u=a.width();this.moveTo(l,u)}}).bind(this),a=>{r.reject(a)}).then((function(){return this.handleNextPrePaginated(o,e,this.add)}).bind(this)).then((function(){this.views.show(),r.resolve()}).bind(this)),s}afterDisplayed(e){this.emit(hs.EVENTS.MANAGERS.ADDED,e)}afterResized(e){this.emit(hs.EVENTS.MANAGERS.RESIZE,e.section)}moveTo(e,t){var r=0,s=0;this.isPaginated?(r=Math.floor(e.left/this.layout.delta)*this.layout.delta,r+this.layout.delta>this.container.scrollWidth&&(r=this.container.scrollWidth-this.layout.delta),s=Math.floor(e.top/this.layout.delta)*this.layout.delta,s+this.layout.delta>this.container.scrollHeight&&(s=this.container.scrollHeight-this.layout.delta)):s=e.top,this.settings.direction==="rtl"&&(r=r+this.layout.delta,r=r-t),this.scrollTo(r,s,!0)}add(e,t){var r=this.createView(e,t);return this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(hs.EVENTS.VIEWS.AXIS,s=>{this.updateAxis(s)}),r.on(hs.EVENTS.VIEWS.WRITING_MODE,s=>{this.updateWritingMode(s)}),r.display(this.request)}append(e,t){var r=this.createView(e,t);return this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(hs.EVENTS.VIEWS.AXIS,s=>{this.updateAxis(s)}),r.on(hs.EVENTS.VIEWS.WRITING_MODE,s=>{this.updateWritingMode(s)}),r.display(this.request)}prepend(e,t){var r=this.createView(e,t);return r.on(hs.EVENTS.VIEWS.RESIZED,s=>{this.counter(s)}),this.views.prepend(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(hs.EVENTS.VIEWS.AXIS,s=>{this.updateAxis(s)}),r.on(hs.EVENTS.VIEWS.WRITING_MODE,s=>{this.updateWritingMode(s)}),r.display(this.request)}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e,t;let r=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!r||r==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,t<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&r==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft,t>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):(t=this.container.scrollLeft+this.layout.delta*-1,t>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let s=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(s=!0),this.append(e,s).then((function(){return this.handleNextPrePaginated(s,e,this.append)}).bind(this),i=>i).then((function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}).bind(this))}}prev(){var e,t;let r=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!r||r==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft,t>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&r==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft+this.container.offsetWidth,t<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):(t=this.container.scrollLeft,t<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let s=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof e.prev()!="object"&&(s=!0),this.prepend(e,s).then((function(){var i;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(i=e.prev(),i))return this.prepend(i)}).bind(this),i=>i).then((function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}).bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),r=t.height<window.innerHeight?t.height:window.innerHeight,s=t.width<window.innerWidth?t.width:window.innerWidth,i=this.settings.axis==="vertical";this.settings.direction;let o=0,a=0;return this.settings.fullsize&&(o=i?window.scrollY:window.scrollX),e.map(u=>{let{index:c,href:h}=u.section,d=u.position(),f=u.width(),p=u.height(),v,g,m,y;i?(v=o+t.top-d.top+a,g=v+r-a,y=this.layout.count(p,r).pages,m=r):(v=o+t.left-d.left+a,g=v+s-a,y=this.layout.count(f,s).pages,m=s);let w=Math.ceil(v/m),x=[],b=Math.ceil(g/m);if(this.settings.direction==="rtl"&&!i){let E=w;w=y-b,b=y-E}x=[];for(var C=w;C<=b;C++){let E=C+1;x.push(E)}let k=this.mapping.page(u.contents,u.section.cfiBase,v,g);return{index:c,href:h,pages:x,totalPages:y,mapping:k}})}paginatedLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),r=0,s=0;return this.settings.fullsize&&(r=window.scrollX),e.map(o=>{let{index:a,href:l}=o.section,u,c=o.position(),h=o.width(),d,f,p;this.settings.direction==="rtl"?(u=t.right-r,p=Math.min(Math.abs(u-c.left),this.layout.width)-s,f=c.width-(c.right-u)-s,d=f-p):(u=t.left+r,p=Math.min(c.right-u,this.layout.width)-s,d=u-c.left+s,f=d+p),s+=p;let v=this.mapping.page(o.contents,o.section.cfiBase,d,f),g=this.layout.count(h).pages,m=Math.floor(d/this.layout.pageWidth),y=[],w=Math.floor(f/this.layout.pageWidth);if(m<0&&(m=0,w=w+1),this.settings.direction==="rtl"){let b=m;m=g-w,w=g-b}for(var x=m+1;x<=w;x++){let b=x;y.push(b)}return{index:a,href:l,pages:y,totalPages:g,mapping:v}})}isVisible(e,t,r,s){var i=e.position(),o=s||this.bounds();return this.settings.axis==="horizontal"&&i.right>o.left-t&&i.left<o.right+r?!0:this.settings.axis==="vertical"&&i.bottom>o.top-t&&i.top<o.bottom+r}visible(){for(var e=this.bounds(),t=this.views.displayed(),r=t.length,s=[],i,o,a=0;a<r;a++)o=t[a],i=this.isVisible(o,0,0,e),i===!0&&s.push(o);return s}scrollBy(e,t,r){let s=this.settings.direction==="rtl"?-1:1;r&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*s,t*s):(e&&(this.container.scrollLeft+=e*s),t&&(this.container.scrollTop+=t)),this.scrolled=!0}scrollTo(e,t,r){r&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,t):(this.container.scrollLeft=e,this.container.scrollTop=t),this.scrolled=!0}onScroll(){let e,t;this.settings.fullsize?(e=window.scrollY,t=window.scrollX):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:(this.emit(hs.EVENTS.MANAGERS.SCROLL,{top:e,left:t}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.emit(hs.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),20))}bounds(){var e;return e=this.stage.bounds(),e}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new iE.default(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(t){t&&t.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,t){!t&&e===this.settings.axis||(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new iE.default(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(e==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,t="auto"){let r=e==="paginated"||e==="auto";this.isPaginated=r,e==="scrolled-doc"||e==="scrolled-continuous"||e==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=r?"hidden":t,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(t){const r=t&&t.contents;r&&e.push(r)}),e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}(0,X6.default)(tD.prototype);var e8=tD;cc.default=e8;var kd={},qg={};Object.defineProperty(qg,"__esModule",{value:!0});qg.default=void 0;var oE=je,aE=sr,t8=n8(Zi);function n8(n){return n&&n.__esModule?n:{default:n}}const r8=Math.PI/2,s8={easeOutSine:function(n){return Math.sin(n*r8)},easeInOutSine:function(n){return-.5*(Math.cos(Math.PI*n)-1)},easeInOutQuint:function(n){return(n/=.5)<1?.5*Math.pow(n,5):.5*(Math.pow(n-2,5)+2)},easeInCubic:function(n){return Math.pow(n,3)}};class nD{constructor(e,t){this.settings=(0,oE.extend)({duration:80,minVelocity:.2,minDistance:10,easing:s8.easeInCubic},t||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(aE.EVENTS.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(aE.EVENTS.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let t=e.contents;["touchstart","touchmove","touchend"].forEach(r=>{t.on(r,s=>this.triggerViewEvent(s,t))})}triggerViewEvent(e,t){this.emit(e.type,e,t)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:t,screenY:r}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=t,this.startTouchY=r,this.startTime=this.now()),this.endTouchX=t,this.endTouchY=r,this.endTime=this.now()}onTouchMove(e){let{screenX:t,screenY:r}=e.touches[0],s=Math.abs(r-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&s<10&&(this.element.scrollLeft-=t-this.endTouchX),this.endTouchX=t,this.endTouchY=r,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let t=this.wasSwiped();t!==0?this.snap(t):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,t=this.endTouchX-this.startTouchX,r=Math.abs(t),s=this.endTime-this.startTime,i=t/s,o=this.settings.minVelocity;if(r<=this.settings.minDistance||r>=e)return 0;if(i>o)return-1;if(i<-o)return 1}needsSnap(){let e=this.scrollLeft,t=this.layout.pageWidth*this.layout.divisor;return e%t!==0}snap(e=0){let t=this.scrollLeft,r=this.layout.pageWidth*this.layout.divisor,s=Math.round(t/r)*r;return e&&(s+=e*r),this.smoothScrollTo(s)}smoothScrollTo(e){const t=new oE.defer,r=this.scrollLeft,s=this.now(),i=this.settings.duration,o=this.settings.easing;this.snapping=!0;function a(){const l=this.now(),u=Math.min(1,(l-s)/i);if(o(u),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,t.resolve();return}u<1?(window.requestAnimationFrame(a.bind(this)),this.scrollTo(r+(e-r)*u,0)):(this.scrollTo(e,0),this.snapping=!1,t.resolve())}return a.call(this),t.promise}scrollTo(e=0,t=0){this.fullsize?window.scroll(e,t):(this.scroller.scrollLeft=e,this.scroller.scrollTop=t)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}(0,t8.default)(nD.prototype);var i8=nD;qg.default=i8;Object.defineProperty(kd,"__esModule",{value:!0});kd.default=void 0;var Aa=je,lE=Zw(cc),uE=Zw(qg),Ns=sr,o8=Zw(eD);function Zw(n){return n&&n.__esModule?n:{default:n}}class a8 extends lE.default{constructor(e){super(e),this.name="continuous",this.settings=(0,Aa.extend)(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),(0,Aa.extend)(this.settings,e.settings||{}),e.settings.gap!="undefined"&&e.settings.gap===0&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,t){return lE.default.prototype.display.call(this,e,t).then((function(){return this.fill()}).bind(this))}fill(e){var t=e||new Aa.defer;return this.q.enqueue(()=>this.check()).then(r=>{r?this.fill(t):t.resolve()}),t.promise}moveTo(e){var t=0,r=0;this.isPaginated?(t=Math.floor(e.left/this.layout.delta)*this.layout.delta,t+this.settings.offsetDelta):(r=e.top,e.top+this.settings.offsetDelta),(t>0||r>0)&&this.scrollBy(t,r,!0)}afterResized(e){this.emit(Ns.EVENTS.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var t=this.createView(e);return this.views.append(t),t.on(Ns.EVENTS.VIEWS.RESIZED,r=>{t.expanded=!0}),t.on(Ns.EVENTS.VIEWS.AXIS,r=>{this.updateAxis(r)}),t.on(Ns.EVENTS.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),t.onDisplayed=this.afterDisplayed.bind(this),t.onResize=this.afterResized.bind(this),t.display(this.request)}append(e){var t=this.createView(e);return t.on(Ns.EVENTS.VIEWS.RESIZED,r=>{t.expanded=!0}),t.on(Ns.EVENTS.VIEWS.AXIS,r=>{this.updateAxis(r)}),t.on(Ns.EVENTS.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),this.views.append(t),t.onDisplayed=this.afterDisplayed.bind(this),t}prepend(e){var t=this.createView(e);return t.on(Ns.EVENTS.VIEWS.RESIZED,r=>{this.counter(r),t.expanded=!0}),t.on(Ns.EVENTS.VIEWS.AXIS,r=>{this.updateAxis(r)}),t.on(Ns.EVENTS.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),this.views.prepend(t),t.onDisplayed=this.afterDisplayed.bind(this),t}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var t=this.bounds(),r=this.views.all(),s=r.length,i=typeof e<"u"?e:this.settings.offset||0,o,a,l=new Aa.defer,u=[],c=0;c<s;c++)if(a=r[c],o=this.isVisible(a,i,i,t),o===!0)if(a.displayed)a.show();else{let h=a.display(this.request).then(function(d){d.show()},d=>{a.hide()});u.push(h)}else this.q.enqueue(a.destroy.bind(a)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout((function(){this.q.enqueue(this.trim.bind(this))}).bind(this),250);return u.length?Promise.all(u).catch(h=>{l.reject(h)}):(l.resolve(),l.promise)}check(e,t){var r=new Aa.defer,s=[],i=this.settings.axis==="horizontal",o=this.settings.offset||0;e&&i&&(o=e),t&&!i&&(o=t);var a=this._bounds;let l=i?this.scrollLeft:this.scrollTop,u=i?Math.floor(a.width):a.height,c=i?this.container.scrollWidth:this.container.scrollHeight,h=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",d=this.settings.rtlScrollType,f=this.settings.direction==="rtl";this.settings.fullsize?(i&&f&&d==="negative"||!i&&f&&d==="default")&&(l=l*-1):(f&&d==="default"&&h==="horizontal"&&(l=c-u-l),f&&d==="negative"&&h==="horizontal"&&(l=l*-1));let p=()=>{let w=this.views.first(),x=w&&w.section.prev();x&&s.push(this.prepend(x))},v=()=>{let w=this.views.last(),x=w&&w.section.next();x&&s.push(this.append(x))},g=l+u+o,m=l-o;g>=c&&v(),m<0&&p();let y=s.map(w=>w.display(this.request));return s.length?Promise.all(y).then(()=>this.check()).then(()=>this.update(o),w=>w):(this.q.enqueue((function(){this.update()}).bind(this)),r.resolve(!1),r.promise)}trim(){for(var e=new Aa.defer,t=this.views.displayed(),r=t[0],s=t[t.length-1],i=this.views.indexOf(r),o=this.views.indexOf(s),a=this.views.slice(0,i),l=this.views.slice(o+1),u=0;u<a.length-1;u++)this.erase(a[u],a);for(var c=1;c<l.length;c++)this.erase(l[c]);return e.resolve(),e.promise}erase(e,t){var r,s;this.settings.fullsize?(r=window.scrollY,s=window.scrollX):(r=this.container.scrollTop,s=this.container.scrollLeft);var i=e.bounds();this.views.remove(e),t&&(this.settings.axis==="vertical"?this.scrollTo(0,r-i.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(s+Math.floor(i.width),0,!0):this.scrollTo(s,0,!0):this.scrollTo(s-Math.floor(i.width),0,!0))}addEventListeners(e){window.addEventListener("unload",(function(t){this.ignore=!0,this.destroy()}).bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new uE.default(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var e;this.tick=Aa.requestAnimationFrame;let t=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*t,this.scrollLeft=window.scrollX*t):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=(0,o8.default)(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,t,r=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(e=window.scrollY*r,t=window.scrollX*r):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(t-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=t,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}).bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue((function(){return this.check()}).bind(this)),this.emit(Ns.EVENTS.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(Ns.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),this.settings.afterScrolledTimeout)}next(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}prev(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new uE.default(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}var l8=a8;kd.default=l8;Object.defineProperty(uc,"__esModule",{value:!0});uc.default=void 0;var u8=wi(Zi),Kc=je,Ra=wi(ac),cE=wi(Wr),c8=wi(ua),h8=wi(wd),d8=wi(Bg);wi(_l);var f8=wi(zg),Yt=sr,p8=wi(Cd),m8=wi(cc),g8=wi(kd);function wi(n){return n&&n.__esModule?n:{default:n}}class rD{constructor(e,t){this.settings=(0,Kc.extend)(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),(0,Kc.extend)(this.settings,t),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new Ra.default(this),this.hooks.serialize=new Ra.default(this),this.hooks.content=new Ra.default(this),this.hooks.unloaded=new Ra.default(this),this.hooks.layout=new Ra.default(this),this.hooks.render=new Ra.default(this),this.hooks.show=new Ra.default(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new d8.default(this),this.annotations=new f8.default(this),this.epubcfi=new cE.default,this.q=new c8.default(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new Kc.defer,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){var t;return typeof e=="string"&&e==="default"?t=m8.default:typeof e=="string"&&e==="continuous"?t=g8.default:t=e,t}requireView(e){var t;return typeof e=="string"&&e==="iframe"?t=p8.default:t=e,t}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(Yt.EVENTS.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(Yt.EVENTS.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(Yt.EVENTS.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(Yt.EVENTS.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(Yt.EVENTS.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(Yt.EVENTS.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue((function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit(Yt.EVENTS.RENDITION.ATTACHED)}).bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(this.book){this.epubcfi.isCfiString(e);var t=new Kc.defer,r=t.promise,s;return this.displaying=t,this.book.locations.length()&&(0,Kc.isFloat)(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),s=this.book.spine.get(e),s?(this.manager.display(s,e).then(()=>{t.resolve(s),this.displaying=void 0,this.emit(Yt.EVENTS.RENDITION.DISPLAYED,s),this.reportLocation()},i=>{this.emit(Yt.EVENTS.RENDITION.DISPLAY_ERROR,i)}),r):(t.reject(new Error("No Section Found")),r)}}afterDisplayed(e){e.on(Yt.EVENTS.VIEWS.MARK_CLICKED,(t,r)=>this.triggerMarkEvent(t,r,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit(Yt.EVENTS.RENDITION.RENDERED,e.section,e)}):this.emit(Yt.EVENTS.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit(Yt.EVENTS.RENDITION.REMOVED,e.section,e)})}onResized(e,t){this.emit(Yt.EVENTS.RENDITION.RESIZED,{width:e.width,height:e.height},t),this.location&&this.location.start&&this.display(t||this.location.start.cfi)}onOrientationChange(e){this.emit(Yt.EVENTS.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,t,r){e&&(this.settings.width=e),t&&(this.settings.height=t),this.manager.resize(e,t,r)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var t,r=this.settings.layout||e.layout||"reflowable",s=this.settings.spread||e.spread||"auto",i=this.settings.orientation||e.orientation||"auto",o=this.settings.flow||e.flow||"auto",a=e.viewport||"",l=this.settings.minSpreadWidth||e.minSpreadWidth||800,u=this.settings.direction||e.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),t={layout:r,spread:s,orientation:i,flow:o,viewport:a,minSpreadWidth:l,direction:u},t}flow(e){var t=e;(e==="scrolled"||e==="scrolled-doc"||e==="scrolled-continuous")&&(t="scrolled"),(e==="auto"||e==="paginated")&&(t="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(t),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(t),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new h8.default(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on(Yt.EVENTS.LAYOUT.UPDATED,(t,r)=>{this.emit(Yt.EVENTS.RENDITION.LAYOUT,t,r)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,t){this.settings.spread=e,t&&(this.settings.minSpreadWidth=t),this._layout&&this._layout.spread(e,t),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue((function(){requestAnimationFrame((function(){var r=this.manager.currentLocation();if(r&&r.then&&typeof r.then=="function")r.then((function(s){let i=this.located(s);!i||!i.start||!i.end||(this.location=i,this.emit(Yt.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(Yt.EVENTS.RENDITION.RELOCATED,this.location))}).bind(this));else if(r){let s=this.located(r);if(!s||!s.start||!s.end)return;this.location=s,this.emit(Yt.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(Yt.EVENTS.RENDITION.RELOCATED,this.location)}}).bind(this))}).bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then=="function")e.then((function(t){return this.located(t)}).bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let t=e[0],r=e[e.length-1],s={start:{index:t.index,href:t.href,cfi:t.mapping.start,displayed:{page:t.pages[0]||1,total:t.totalPages}},end:{index:r.index,href:r.href,cfi:r.mapping.end,displayed:{page:r.pages[r.pages.length-1]||1,total:r.totalPages}}},i=this.book.locations.locationFromCfi(t.mapping.start),o=this.book.locations.locationFromCfi(r.mapping.end);i!=null&&(s.start.location=i,s.start.percentage=this.book.locations.percentageFromLocation(i)),o!=null&&(s.end.location=o,s.end.percentage=this.book.locations.percentageFromLocation(o));let a=this.book.pageList.pageFromCfi(t.mapping.start),l=this.book.pageList.pageFromCfi(r.mapping.end);return a!=-1&&(s.start.page=a),l!=-1&&(s.end.page=l),r.index===this.book.spine.last().index&&s.end.displayed.page>=s.end.displayed.total&&(s.atEnd=!0),t.index===this.book.spine.first().index&&s.start.displayed.page===1&&(s.atStart=!0),s}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){Yt.DOM_EVENTS.forEach(t=>{e.on(t,r=>this.triggerViewEvent(r,e))}),e.on(Yt.EVENTS.CONTENTS.SELECTED,t=>this.triggerSelectedEvent(t,e))}triggerViewEvent(e,t){this.emit(e.type,e,t)}triggerSelectedEvent(e,t){this.emit(Yt.EVENTS.RENDITION.SELECTED,e,t)}triggerMarkEvent(e,t,r){this.emit(Yt.EVENTS.RENDITION.MARK_CLICKED,e,t,r)}getRange(e,t){var r=new cE.default(e),s=this.manager.visible().filter(function(i){if(r.spinePos===i.index)return!0});if(s.length)return s[0].contents.range(r,t)}adjustImages(e){if(this._layout.name==="pre-paginated")return new Promise(function(i){i()});let t=e.window.getComputedStyle(e.content,null),r=(e.content.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)))*.95,s=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-s+"px":"100%")+"!important","max-height":r+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-s+"px":"100%")+"!important","max-height":r+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(i,o){setTimeout(function(){i()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on(Yt.EVENTS.CONTENTS.LINK_CLICKED,t=>{let r=this.book.path.relative(t);this.display(r)})}injectStylesheet(e,t){let r=e.createElement("link");r.setAttribute("type","text/css"),r.setAttribute("rel","stylesheet"),r.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(r)}injectScript(e,t){let r=e.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",this.settings.script),r.textContent=" ",e.getElementsByTagName("head")[0].appendChild(r)}injectIdentifier(e,t){let r=this.book.packaging.metadata.identifier,s=e.createElement("meta");s.setAttribute("name","dc.relation.ispartof"),r&&s.setAttribute("content",r),e.getElementsByTagName("head")[0].appendChild(s)}}(0,u8.default)(rD.prototype);var v8=rD;uc.default=v8;var Kg={};function Go(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var sD={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(n,e){(function(t){n.exports=t()})(function(){return function t(r,s,i){function o(u,c){if(!s[u]){if(!r[u]){var h=typeof Go=="function"&&Go;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var f=s[u]={exports:{}};r[u][0].call(f.exports,function(p){var v=r[u][1][p];return o(v||p)},f,f.exports,t,r,s,i)}return s[u].exports}for(var a=typeof Go=="function"&&Go,l=0;l<i.length;l++)o(i[l]);return o}({1:[function(t,r,s){var i=t("./utils"),o=t("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var u=[],c,h,d,f,p,v,g,m=0,y=l.length,w=y,x=i.getTypeOf(l)!=="string";m<l.length;)w=y-m,x?(c=l[m++],h=m<y?l[m++]:0,d=m<y?l[m++]:0):(c=l.charCodeAt(m++),h=m<y?l.charCodeAt(m++):0,d=m<y?l.charCodeAt(m++):0),f=c>>2,p=(c&3)<<4|h>>4,v=w>1?(h&15)<<2|d>>6:64,g=w>2?d&63:64,u.push(a.charAt(f)+a.charAt(p)+a.charAt(v)+a.charAt(g));return u.join("")},s.decode=function(l){var u,c,h,d,f,p,v,g=0,m=0,y="data:";if(l.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");l=l.replace(/[^A-Za-z0-9+/=]/g,"");var w=l.length*3/4;if(l.charAt(l.length-1)===a.charAt(64)&&w--,l.charAt(l.length-2)===a.charAt(64)&&w--,w%1!==0)throw new Error("Invalid base64 input, bad content length.");var x;for(o.uint8array?x=new Uint8Array(w|0):x=new Array(w|0);g<l.length;)d=a.indexOf(l.charAt(g++)),f=a.indexOf(l.charAt(g++)),p=a.indexOf(l.charAt(g++)),v=a.indexOf(l.charAt(g++)),u=d<<2|f>>4,c=(f&15)<<4|p>>2,h=(p&3)<<6|v,x[m++]=u,p!==64&&(x[m++]=c),v!==64&&(x[m++]=h);return x}},{"./support":30,"./utils":32}],2:[function(t,r,s){var i=t("./external"),o=t("./stream/DataWorker"),a=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function u(c,h,d,f,p){this.compressedSize=c,this.uncompressedSize=h,this.crc32=d,this.compression=f,this.compressedContent=p}u.prototype={getContentWorker:function(){var c=new o(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),h=this;return c.on("end",function(){if(this.streamInfo.data_length!==h.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new o(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(c,h,d){return c.pipe(new a).pipe(new l("uncompressedSize")).pipe(h.compressWorker(d)).pipe(new l("compressedSize")).withStreamInfo("compression",h)},r.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,r,s){var i=t("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,r,s){var i=t("./utils");function o(){for(var c,h=[],d=0;d<256;d++){c=d;for(var f=0;f<8;f++)c=c&1?3988292384^c>>>1:c>>>1;h[d]=c}return h}var a=o();function l(c,h,d,f){var p=a,v=f+d;c=c^-1;for(var g=f;g<v;g++)c=c>>>8^p[(c^h[g])&255];return c^-1}function u(c,h,d,f){var p=a,v=f+d;c=c^-1;for(var g=f;g<v;g++)c=c>>>8^p[(c^h.charCodeAt(g))&255];return c^-1}r.exports=function(h,d){if(typeof h>"u"||!h.length)return 0;var f=i.getTypeOf(h)!=="string";return f?l(d|0,h,h.length,0):u(d|0,h,h.length,0)}},{"./utils":32}],5:[function(t,r,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(t,r,s){var i=null;typeof Promise<"u"?i=Promise:i=t("lie"),r.exports={Promise:i}},{lie:37}],7:[function(t,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=t("pako"),a=t("./utils"),l=t("./stream/GenericWorker"),u=i?"uint8array":"array";s.magic="\b\0";function c(h,d){l.call(this,"FlateWorker/"+h),this._pako=null,this._pakoAction=h,this._pakoOptions=d,this.meta={}}a.inherits(c,l),c.prototype.processChunk=function(h){this.meta=h.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(u,h.data),!1)},c.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var h=this;this._pako.onData=function(d){h.push({data:d,meta:h.meta})}},s.compressWorker=function(h){return new c("Deflate",h)},s.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,r,s){var i=t("../utils"),o=t("../stream/GenericWorker"),a=t("../utf8"),l=t("../crc32"),u=t("../signature"),c=function(m,y){var w="",x;for(x=0;x<y;x++)w+=String.fromCharCode(m&255),m=m>>>8;return w},h=function(m,y){var w=m;return m||(w=y?16893:33204),(w&65535)<<16},d=function(m){return(m||0)&63},f=function(m,y,w,x,b,C){var k=m.file,E=m.compression,T=C!==a.utf8encode,_=i.transformTo("string",C(k.name)),A=i.transformTo("string",a.utf8encode(k.name)),P=k.comment,j=i.transformTo("string",C(P)),X=i.transformTo("string",a.utf8encode(P)),F=A.length!==k.name.length,M=X.length!==P.length,W,D,z="",K="",ie="",V=k.dir,Z=k.date,de={crc32:0,compressedSize:0,uncompressedSize:0};(!y||w)&&(de.crc32=m.crc32,de.compressedSize=m.compressedSize,de.uncompressedSize=m.uncompressedSize);var ge=0;y&&(ge|=8),!T&&(F||M)&&(ge|=2048);var ye=0,G=0;V&&(ye|=16),b==="UNIX"?(G=798,ye|=h(k.unixPermissions,V)):(G=20,ye|=d(k.dosPermissions)),W=Z.getUTCHours(),W=W<<6,W=W|Z.getUTCMinutes(),W=W<<5,W=W|Z.getUTCSeconds()/2,D=Z.getUTCFullYear()-1980,D=D<<4,D=D|Z.getUTCMonth()+1,D=D<<5,D=D|Z.getUTCDate(),F&&(K=c(1,1)+c(l(_),4)+A,z+="up"+c(K.length,2)+K),M&&(ie=c(1,1)+c(l(j),4)+X,z+="uc"+c(ie.length,2)+ie);var J="";J+=`
\0`,J+=c(ge,2),J+=E.magic,J+=c(W,2),J+=c(D,2),J+=c(de.crc32,4),J+=c(de.compressedSize,4),J+=c(de.uncompressedSize,4),J+=c(_.length,2),J+=c(z.length,2);var fe=u.LOCAL_FILE_HEADER+J+_+z,ve=u.CENTRAL_FILE_HEADER+c(G,2)+J+c(j.length,2)+"\0\0\0\0"+c(ye,4)+c(x,4)+_+z+j;return{fileRecord:fe,dirRecord:ve}},p=function(m,y,w,x,b){var C="",k=i.transformTo("string",b(x));return C=u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+c(m,2)+c(m,2)+c(y,4)+c(w,4)+c(k.length,2)+k,C},v=function(m){var y="";return y=u.DATA_DESCRIPTOR+c(m.crc32,4)+c(m.compressedSize,4)+c(m.uncompressedSize,4),y};function g(m,y,w,x){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=w,this.encodeFileName=x,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(g,o),g.prototype.push=function(m){var y=m.meta.percent||0,w=this.entriesCount,x=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,o.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:w?(y+100*(w-x-1))/w:100}}))},g.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var y=this.streamFiles&&!m.file.dir;if(y){var w=f(m,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:w.fileRecord,meta:{percent:0}})}else this.accumulate=!0},g.prototype.closedSource=function(m){this.accumulate=!1;var y=this.streamFiles&&!m.file.dir,w=f(m,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(w.dirRecord),y)this.push({data:v(m),meta:{percent:100}});else for(this.push({data:w.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},g.prototype.flush=function(){for(var m=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var w=this.bytesWritten-m,x=p(this.dirRecords.length,w,m,this.zipComment,this.encodeFileName);this.push({data:x,meta:{percent:100}})},g.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},g.prototype.registerPrevious=function(m){this._sources.push(m);var y=this;return m.on("data",function(w){y.processChunk(w)}),m.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),m.on("error",function(w){y.error(w)}),this},g.prototype.resume=function(){if(!o.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},g.prototype.error=function(m){var y=this._sources;if(!o.prototype.error.call(this,m))return!1;for(var w=0;w<y.length;w++)try{y[w].error(m)}catch{}return!0},g.prototype.lock=function(){o.prototype.lock.call(this);for(var m=this._sources,y=0;y<m.length;y++)m[y].lock()},r.exports=g},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,r,s){var i=t("../compressions"),o=t("./ZipFileWorker"),a=function(l,u){var c=l||u,h=i[c];if(!h)throw new Error(c+" is not a valid compression method !");return h};s.generateWorker=function(l,u,c){var h=new o(u.streamFiles,c,u.platform,u.encodeFileName),d=0;try{l.forEach(function(f,p){d++;var v=a(p.options.compression,u.compression),g=p.options.compressionOptions||u.compressionOptions||{},m=p.dir,y=p.date;p._compressWorker(v,g).withStreamInfo("file",{name:f,dir:m,date:y,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(h)}),h.entriesCount=d}catch(f){h.error(f)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,r,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new i;for(var a in this)typeof this[a]!="function"&&(o[a]=this[a]);return o}}i.prototype=t("./object"),i.prototype.loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.10.1",i.loadAsync=function(o,a){return new i().loadAsync(o,a)},i.external=t("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,r,s){var i=t("./utils"),o=t("./external"),a=t("./utf8"),l=t("./zipEntries"),u=t("./stream/Crc32Probe"),c=t("./nodejsUtils");function h(d){return new o.Promise(function(f,p){var v=d.decompressed.getContentWorker().pipe(new u);v.on("error",function(g){p(g)}).on("end",function(){v.streamInfo.crc32!==d.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}r.exports=function(d,f){var p=this;return f=i.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),c.isNode&&c.isStream(d)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",d,!0,f.optimizedBinaryString,f.base64).then(function(v){var g=new l(f);return g.load(v),g}).then(function(g){var m=[o.Promise.resolve(g)],y=g.files;if(f.checkCRC32)for(var w=0;w<y.length;w++)m.push(h(y[w]));return o.Promise.all(m)}).then(function(g){for(var m=g.shift(),y=m.files,w=0;w<y.length;w++){var x=y[w],b=x.fileNameStr,C=i.resolve(x.fileNameStr);p.file(C,x.decompressed,{binary:!0,optimizedBinaryString:!0,date:x.date,dir:x.dir,comment:x.fileCommentStr.length?x.fileCommentStr:null,unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions,createFolders:f.createFolders}),x.dir||(p.file(C).unsafeOriginalName=b)}return m.zipComment.length&&(p.comment=m.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,r,s){var i=t("../utils"),o=t("../stream/GenericWorker");function a(l,u){o.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}i.inherits(a,o),a.prototype._bindStream=function(l){var u=this;this._stream=l,l.pause(),l.on("data",function(c){u.push({data:c,meta:{percent:0}})}).on("error",function(c){u.isPaused?this.generatedError=c:u.error(c)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},a.prototype.pause=function(){return o.prototype.pause.call(this)?(this._stream.pause(),!0):!1},a.prototype.resume=function(){return o.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},r.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,r,s){var i=t("readable-stream").Readable,o=t("../utils");o.inherits(a,i);function a(l,u,c){i.call(this,u),this._helper=l;var h=this;l.on("data",function(d,f){h.push(d)||h._helper.pause(),c&&c(f)}).on("error",function(d){h.emit("error",d)}).on("end",function(){h.push(null)})}a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(t,r,s){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,o);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,o)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var o=new Buffer(i);return o.fill(0),o},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(t,r,s){var i=t("./utf8"),o=t("./utils"),a=t("./stream/GenericWorker"),l=t("./stream/StreamHelper"),u=t("./defaults"),c=t("./compressedObject"),h=t("./zipObject"),d=t("./generate"),f=t("./nodejsUtils"),p=t("./nodejs/NodejsStreamInputAdapter"),v=function(b,C,k){var E=o.getTypeOf(C),T,_=o.extend(k||{},u);_.date=_.date||new Date,_.compression!==null&&(_.compression=_.compression.toUpperCase()),typeof _.unixPermissions=="string"&&(_.unixPermissions=parseInt(_.unixPermissions,8)),_.unixPermissions&&_.unixPermissions&16384&&(_.dir=!0),_.dosPermissions&&_.dosPermissions&16&&(_.dir=!0),_.dir&&(b=m(b)),_.createFolders&&(T=g(b))&&y.call(this,T,!0);var A=E==="string"&&_.binary===!1&&_.base64===!1;(!k||typeof k.binary>"u")&&(_.binary=!A);var P=C instanceof c&&C.uncompressedSize===0;(P||_.dir||!C||C.length===0)&&(_.base64=!1,_.binary=!0,C="",_.compression="STORE",E="string");var j=null;C instanceof c||C instanceof a?j=C:f.isNode&&f.isStream(C)?j=new p(b,C):j=o.prepareContent(b,C,_.binary,_.optimizedBinaryString,_.base64);var X=new h(b,j,_);this.files[b]=X},g=function(b){b.slice(-1)==="/"&&(b=b.substring(0,b.length-1));var C=b.lastIndexOf("/");return C>0?b.substring(0,C):""},m=function(b){return b.slice(-1)!=="/"&&(b+="/"),b},y=function(b,C){return C=typeof C<"u"?C:u.createFolders,b=m(b),this.files[b]||v.call(this,b,null,{dir:!0,createFolders:C}),this.files[b]};function w(b){return Object.prototype.toString.call(b)==="[object RegExp]"}var x={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(b){var C,k,E;for(C in this.files)E=this.files[C],k=C.slice(this.root.length,C.length),k&&C.slice(0,this.root.length)===this.root&&b(k,E)},filter:function(b){var C=[];return this.forEach(function(k,E){b(k,E)&&C.push(E)}),C},file:function(b,C,k){if(arguments.length===1)if(w(b)){var E=b;return this.filter(function(_,A){return!A.dir&&E.test(_)})}else{var T=this.files[this.root+b];return T&&!T.dir?T:null}else b=this.root+b,v.call(this,b,C,k);return this},folder:function(b){if(!b)return this;if(w(b))return this.filter(function(T,_){return _.dir&&b.test(T)});var C=this.root+b,k=y.call(this,C),E=this.clone();return E.root=k.name,E},remove:function(b){b=this.root+b;var C=this.files[b];if(C||(b.slice(-1)!=="/"&&(b+="/"),C=this.files[b]),C&&!C.dir)delete this.files[b];else for(var k=this.filter(function(T,_){return _.name.slice(0,b.length)===b}),E=0;E<k.length;E++)delete this.files[k[E].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(b){var C,k={};try{if(k=o.extend(b||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode}),k.type=k.type.toLowerCase(),k.compression=k.compression.toUpperCase(),k.type==="binarystring"&&(k.type="string"),!k.type)throw new Error("No output type specified.");o.checkSupport(k.type),(k.platform==="darwin"||k.platform==="freebsd"||k.platform==="linux"||k.platform==="sunos")&&(k.platform="UNIX"),k.platform==="win32"&&(k.platform="DOS");var E=k.comment||this.comment||"";C=d.generateWorker(this,k,E)}catch(T){C=new a("error"),C.error(T)}return new l(C,k.type||"string",k.mimeType)},generateAsync:function(b,C){return this.generateInternalStream(b).accumulate(C)},generateNodeStream:function(b,C){return b=b||{},b.type||(b.type="nodebuffer"),this.generateInternalStream(b).toNodejsStream(C)}};r.exports=x},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,r,s){r.exports=t("stream")},{stream:void 0}],17:[function(t,r,s){var i=t("./DataReader"),o=t("../utils");function a(l){i.call(this,l);for(var u=0;u<this.data.length;u++)l[u]=l[u]&255}o.inherits(a,i),a.prototype.byteAt=function(l){return this.data[this.zero+l]},a.prototype.lastIndexOfSignature=function(l){for(var u=l.charCodeAt(0),c=l.charCodeAt(1),h=l.charCodeAt(2),d=l.charCodeAt(3),f=this.length-4;f>=0;--f)if(this.data[f]===u&&this.data[f+1]===c&&this.data[f+2]===h&&this.data[f+3]===d)return f-this.zero;return-1},a.prototype.readAndCheckSignature=function(l){var u=l.charCodeAt(0),c=l.charCodeAt(1),h=l.charCodeAt(2),d=l.charCodeAt(3),f=this.readData(4);return u===f[0]&&c===f[1]&&h===f[2]&&d===f[3]},a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(t,r,s){var i=t("../utils");function o(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l=0,u;for(this.checkOffset(a),u=this.index+a-1;u>=this.index;u--)l=(l<<8)+this.byteAt(u);return this.index+=a,l},readString:function(a){return i.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC((a>>25&127)+1980,(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(a&31)<<1))}},r.exports=o},{"../utils":32}],19:[function(t,r,s){var i=t("./Uint8ArrayReader"),o=t("../utils");function a(l){i.call(this,l)}o.inherits(a,i),a.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,r,s){var i=t("./DataReader"),o=t("../utils");function a(l){i.call(this,l)}o.inherits(a,i),a.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},a.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},a.prototype.readAndCheckSignature=function(l){var u=this.readData(4);return l===u},a.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(t,r,s){var i=t("./ArrayReader"),o=t("../utils");function a(l){i.call(this,l)}o.inherits(a,i),a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(t,r,s){var i=t("../utils"),o=t("../support"),a=t("./ArrayReader"),l=t("./StringReader"),u=t("./NodeBufferReader"),c=t("./Uint8ArrayReader");r.exports=function(h){var d=i.getTypeOf(h);return i.checkSupport(d),d==="string"&&!o.uint8array?new l(h):d==="nodebuffer"?new u(h):o.uint8array?new c(i.transformTo("uint8array",h)):new a(i.transformTo("array",h))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,r,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,r,s){var i=t("./GenericWorker"),o=t("../utils");function a(l){i.call(this,"ConvertWorker to "+l),this.destType=l}o.inherits(a,i),a.prototype.processChunk=function(l){this.push({data:o.transformTo(this.destType,l.data),meta:l.meta})},r.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(t,r,s){var i=t("./GenericWorker"),o=t("../crc32"),a=t("../utils");function l(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}a.inherits(l,i),l.prototype.processChunk=function(u){this.streamInfo.crc32=o(u.data,this.streamInfo.crc32||0),this.push(u)},r.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,r,s){var i=t("../utils"),o=t("./GenericWorker");function a(l){o.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(a,o),a.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}o.prototype.processChunk.call(this,l)},r.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(t,r,s){var i=t("../utils"),o=t("./GenericWorker"),a=16*1024;function l(u){o.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(h){c.dataIsReady=!0,c.data=h,c.max=h&&h.length||0,c.type=i.getTypeOf(h),c.isPaused||c._tickAndRepeat()},function(h){c.error(h)})}i.inherits(l,o),l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return o.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0):!1},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=a,c=null,h=Math.min(this.max,this.index+u);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,h);break;case"uint8array":c=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":c=this.data.slice(this.index,h);break}return this.index=h,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(t,r,s){function i(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return this.isFinished?!1:(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,a){return this._listeners[o].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,a){if(this._listeners[o])for(var l=0;l<this._listeners[o].length;l++)this._listeners[o][l].call(this,a)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var a=this;return o.on("data",function(l){a.processChunk(l)}),o.on("end",function(){a.end()}),o.on("error",function(l){a.error(l)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var o=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,a){return this.extraStreamInfo[o]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},r.exports=i},{}],29:[function(t,r,s){var i=t("../utils"),o=t("./ConvertWorker"),a=t("./GenericWorker"),l=t("../base64"),u=t("../support"),c=t("../external"),h=null;if(u.nodestream)try{h=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(g,m,y){switch(g){case"blob":return i.newBlob(i.transformTo("arraybuffer",m),y);case"base64":return l.encode(m);default:return i.transformTo(g,m)}}function f(g,m){var y,w=0,x=null,b=0;for(y=0;y<m.length;y++)b+=m[y].length;switch(g){case"string":return m.join("");case"array":return Array.prototype.concat.apply([],m);case"uint8array":for(x=new Uint8Array(b),y=0;y<m.length;y++)x.set(m[y],w),w+=m[y].length;return x;case"nodebuffer":return Buffer.concat(m);default:throw new Error("concat : unsupported type '"+g+"'")}}function p(g,m){return new c.Promise(function(y,w){var x=[],b=g._internalType,C=g._outputType,k=g._mimeType;g.on("data",function(E,T){x.push(E),m&&m(T)}).on("error",function(E){x=[],w(E)}).on("end",function(){try{var E=d(C,f(b,x),k);y(E)}catch(T){w(T)}x=[]}).resume()})}function v(g,m,y){var w=m;switch(m){case"blob":case"arraybuffer":w="uint8array";break;case"base64":w="string";break}try{this._internalType=w,this._outputType=m,this._mimeType=y,i.checkSupport(w),this._worker=g.pipe(new o(w)),g.lock()}catch(x){this._worker=new a("error"),this._worker.error(x)}}v.prototype={accumulate:function(g){return p(this,g)},on:function(g,m){var y=this;return g==="data"?this._worker.on(g,function(w){m.call(y,w.data,w.meta)}):this._worker.on(g,function(){i.delay(m,arguments,y)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:this._outputType!=="nodebuffer"},g)}},r.exports=v},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,r,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var o=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,a=new o;a.append(i),s.blob=a.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!t("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(t,r,s){for(var i=t("./utils"),o=t("./support"),a=t("./nodejsUtils"),l=t("./stream/GenericWorker"),u=new Array(256),c=0;c<256;c++)u[c]=c>=252?6:c>=248?5:c>=240?4:c>=224?3:c>=192?2:1;u[254]=u[254]=1;var h=function(g){var m,y,w,x,b,C=g.length,k=0;for(x=0;x<C;x++)y=g.charCodeAt(x),(y&64512)===55296&&x+1<C&&(w=g.charCodeAt(x+1),(w&64512)===56320&&(y=65536+(y-55296<<10)+(w-56320),x++)),k+=y<128?1:y<2048?2:y<65536?3:4;for(o.uint8array?m=new Uint8Array(k):m=new Array(k),b=0,x=0;b<k;x++)y=g.charCodeAt(x),(y&64512)===55296&&x+1<C&&(w=g.charCodeAt(x+1),(w&64512)===56320&&(y=65536+(y-55296<<10)+(w-56320),x++)),y<128?m[b++]=y:y<2048?(m[b++]=192|y>>>6,m[b++]=128|y&63):y<65536?(m[b++]=224|y>>>12,m[b++]=128|y>>>6&63,m[b++]=128|y&63):(m[b++]=240|y>>>18,m[b++]=128|y>>>12&63,m[b++]=128|y>>>6&63,m[b++]=128|y&63);return m},d=function(g,m){var y;for(m=m||g.length,m>g.length&&(m=g.length),y=m-1;y>=0&&(g[y]&192)===128;)y--;return y<0||y===0?m:y+u[g[y]]>m?y:m},f=function(g){var m,y,w,x,b=g.length,C=new Array(b*2);for(y=0,m=0;m<b;){if(w=g[m++],w<128){C[y++]=w;continue}if(x=u[w],x>4){C[y++]=65533,m+=x-1;continue}for(w&=x===2?31:x===3?15:7;x>1&&m<b;)w=w<<6|g[m++]&63,x--;if(x>1){C[y++]=65533;continue}w<65536?C[y++]=w:(w-=65536,C[y++]=55296|w>>10&1023,C[y++]=56320|w&1023)}return C.length!==y&&(C.subarray?C=C.subarray(0,y):C.length=y),i.applyFromCharCode(C)};s.utf8encode=function(m){return o.nodebuffer?a.newBufferFrom(m,"utf-8"):h(m)},s.utf8decode=function(m){return o.nodebuffer?i.transformTo("nodebuffer",m).toString("utf-8"):(m=i.transformTo(o.uint8array?"uint8array":"array",m),f(m))};function p(){l.call(this,"utf-8 decode"),this.leftOver=null}i.inherits(p,l),p.prototype.processChunk=function(g){var m=i.transformTo(o.uint8array?"uint8array":"array",g.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var y=m;m=new Uint8Array(y.length+this.leftOver.length),m.set(this.leftOver,0),m.set(y,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var w=d(m),x=m;w!==m.length&&(o.uint8array?(x=m.subarray(0,w),this.leftOver=m.subarray(w,m.length)):(x=m.slice(0,w),this.leftOver=m.slice(w,m.length))),this.push({data:s.utf8decode(x),meta:g.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=p;function v(){l.call(this,"utf-8 encode")}i.inherits(v,l),v.prototype.processChunk=function(g){this.push({data:s.utf8encode(g.data),meta:g.meta})},s.Utf8EncodeWorker=v},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,r,s){var i=t("./support"),o=t("./base64"),a=t("./nodejsUtils"),l=t("./external");t("setimmediate");function u(g){var m=null;return i.uint8array?m=new Uint8Array(g.length):m=new Array(g.length),h(g,m)}s.newBlob=function(g,m){s.checkSupport("blob");try{return new Blob([g],{type:m})}catch{try{var y=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,w=new y;return w.append(g),w.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};function c(g){return g}function h(g,m){for(var y=0;y<g.length;++y)m[y]=g.charCodeAt(y)&255;return m}var d={stringifyByChunk:function(g,m,y){var w=[],x=0,b=g.length;if(b<=y)return String.fromCharCode.apply(null,g);for(;x<b;)m==="array"||m==="nodebuffer"?w.push(String.fromCharCode.apply(null,g.slice(x,Math.min(x+y,b)))):w.push(String.fromCharCode.apply(null,g.subarray(x,Math.min(x+y,b)))),x+=y;return w.join("")},stringifyByChar:function(g){for(var m="",y=0;y<g.length;y++)m+=String.fromCharCode(g[y]);return m},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function f(g){var m=65536,y=s.getTypeOf(g),w=!0;if(y==="uint8array"?w=d.applyCanBeUsed.uint8array:y==="nodebuffer"&&(w=d.applyCanBeUsed.nodebuffer),w)for(;m>1;)try{return d.stringifyByChunk(g,y,m)}catch{m=Math.floor(m/2)}return d.stringifyByChar(g)}s.applyFromCharCode=f;function p(g,m){for(var y=0;y<g.length;y++)m[y]=g[y];return m}var v={};v.string={string:c,array:function(g){return h(g,new Array(g.length))},arraybuffer:function(g){return v.string.uint8array(g).buffer},uint8array:function(g){return h(g,new Uint8Array(g.length))},nodebuffer:function(g){return h(g,a.allocBuffer(g.length))}},v.array={string:f,array:c,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return a.newBufferFrom(g)}},v.arraybuffer={string:function(g){return f(new Uint8Array(g))},array:function(g){return p(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:c,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return a.newBufferFrom(new Uint8Array(g))}},v.uint8array={string:f,array:function(g){return p(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:c,nodebuffer:function(g){return a.newBufferFrom(g)}},v.nodebuffer={string:f,array:function(g){return p(g,new Array(g.length))},arraybuffer:function(g){return v.nodebuffer.uint8array(g).buffer},uint8array:function(g){return p(g,new Uint8Array(g.length))},nodebuffer:c},s.transformTo=function(g,m){if(m||(m=""),!g)return m;s.checkSupport(g);var y=s.getTypeOf(m),w=v[y][g](m);return w},s.resolve=function(g){for(var m=g.split("/"),y=[],w=0;w<m.length;w++){var x=m[w];x==="."||x===""&&w!==0&&w!==m.length-1||(x===".."?y.pop():y.push(x))}return y.join("/")},s.getTypeOf=function(g){if(typeof g=="string")return"string";if(Object.prototype.toString.call(g)==="[object Array]")return"array";if(i.nodebuffer&&a.isBuffer(g))return"nodebuffer";if(i.uint8array&&g instanceof Uint8Array)return"uint8array";if(i.arraybuffer&&g instanceof ArrayBuffer)return"arraybuffer"},s.checkSupport=function(g){var m=i[g.toLowerCase()];if(!m)throw new Error(g+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(g){var m="",y,w;for(w=0;w<(g||"").length;w++)y=g.charCodeAt(w),m+="\\x"+(y<16?"0":"")+y.toString(16).toUpperCase();return m},s.delay=function(g,m,y){setImmediate(function(){g.apply(y||null,m||[])})},s.inherits=function(g,m){var y=function(){};y.prototype=m.prototype,g.prototype=new y},s.extend=function(){var g={},m,y;for(m=0;m<arguments.length;m++)for(y in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],y)&&typeof g[y]>"u"&&(g[y]=arguments[m][y]);return g},s.prepareContent=function(g,m,y,w,x){var b=l.Promise.resolve(m).then(function(C){var k=i.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1);return k&&typeof FileReader<"u"?new l.Promise(function(E,T){var _=new FileReader;_.onload=function(A){E(A.target.result)},_.onerror=function(A){T(A.target.error)},_.readAsArrayBuffer(C)}):C});return b.then(function(C){var k=s.getTypeOf(C);return k?(k==="arraybuffer"?C=s.transformTo("uint8array",C):k==="string"&&(x?C=o.decode(C):y&&w!==!0&&(C=u(C))),C):l.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,r,s){var i=t("./reader/readerFor"),o=t("./utils"),a=t("./signature"),l=t("./zipEntry"),u=t("./support");function c(h){this.files=[],this.loadOptions=h}c.prototype={checkSignature:function(h){if(!this.reader.readAndCheckSignature(h)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(d)+", expected "+o.pretty(h)+")")}},isSignature:function(h,d){var f=this.reader.index;this.reader.setIndex(h);var p=this.reader.readString(4),v=p===d;return this.reader.setIndex(f),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength),d=u.uint8array?"uint8array":"array",f=o.transformTo(d,h);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var h=this.zip64EndOfCentralSize-44,d=0,f,p,v;d<h;)f=this.reader.readInt(2),p=this.reader.readInt(4),v=this.reader.readData(p),this.zip64ExtensibleData[f]={id:f,length:p,value:v}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var h,d;for(h=0;h<this.files.length;h++)d=this.files[h],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)h=new l({zip64:this.zip64},this.loadOptions),h.readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(h<0){var d=!this.isSignature(0,a.LOCAL_FILE_HEADER);throw d?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(h);var f=h;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,h=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),h<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(h),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var v=f-p;if(v>0)this.isSignature(f,a.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(h){this.reader=i(h)},load:function(h){this.prepareReader(h),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,r,s){var i=t("./reader/readerFor"),o=t("./utils"),a=t("./compressedObject"),l=t("./crc32"),u=t("./utf8"),c=t("./compressions"),h=t("./support"),d=0,f=3,p=function(g){for(var m in c)if(Object.prototype.hasOwnProperty.call(c,m)&&c[m].magic===g)return c[m];return null};function v(g,m){this.options=g,this.loadOptions=m}v.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(g){var m,y;if(g.skip(22),this.fileNameLength=g.readInt(2),y=g.readInt(2),this.fileName=g.readData(this.fileNameLength),g.skip(y),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(m=p(this.compressionMethod),m===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,m,g.readData(this.compressedSize))},readCentralPart:function(g){this.versionMadeBy=g.readInt(2),g.skip(2),this.bitFlag=g.readInt(2),this.compressionMethod=g.readString(2),this.date=g.readDate(),this.crc32=g.readInt(4),this.compressedSize=g.readInt(4),this.uncompressedSize=g.readInt(4);var m=g.readInt(2);if(this.extraFieldsLength=g.readInt(2),this.fileCommentLength=g.readInt(2),this.diskNumberStart=g.readInt(2),this.internalFileAttributes=g.readInt(2),this.externalFileAttributes=g.readInt(4),this.localHeaderOffset=g.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");g.skip(m),this.readExtraFields(g),this.parseZIP64ExtraField(g),this.fileComment=g.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var g=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),g===d&&(this.dosPermissions=this.externalFileAttributes&63),g===f&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var g=i(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=g.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=g.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=g.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=g.readInt(4))}},readExtraFields:function(g){var m=g.index+this.extraFieldsLength,y,w,x;for(this.extraFields||(this.extraFields={});g.index+4<m;)y=g.readInt(2),w=g.readInt(2),x=g.readData(w),this.extraFields[y]={id:y,length:w,value:x};g.setIndex(m)},handleUTF8:function(){var g=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var y=o.transformTo(g,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(y)}var w=this.findExtraFieldUnicodeComment();if(w!==null)this.fileCommentStr=w;else{var x=o.transformTo(g,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var g=this.extraFields[28789];if(g){var m=i(g.value);return m.readInt(1)!==1||l(this.fileName)!==m.readInt(4)?null:u.utf8decode(m.readData(g.length-5))}return null},findExtraFieldUnicodeComment:function(){var g=this.extraFields[25461];if(g){var m=i(g.value);return m.readInt(1)!==1||l(this.fileComment)!==m.readInt(4)?null:u.utf8decode(m.readData(g.length-5))}return null}},r.exports=v},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,r,s){var i=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),a=t("./utf8"),l=t("./compressedObject"),u=t("./stream/GenericWorker"),c=function(p,v,g){this.name=p,this.dir=g.dir,this.date=g.date,this.comment=g.comment,this.unixPermissions=g.unixPermissions,this.dosPermissions=g.dosPermissions,this._data=v,this._dataBinary=g.binary,this.options={compression:g.compression,compressionOptions:g.compressionOptions}};c.prototype={internalStream:function(p){var v=null,g="string";try{if(!p)throw new Error("No output type specified.");g=p.toLowerCase();var m=g==="string"||g==="text";(g==="binarystring"||g==="text")&&(g="string"),v=this._decompressWorker();var y=!this._dataBinary;y&&!m&&(v=v.pipe(new a.Utf8EncodeWorker)),!y&&m&&(v=v.pipe(new a.Utf8DecodeWorker))}catch(w){v=new u("error"),v.error(w)}return new i(v,g,"")},async:function(p,v){return this.internalStream(p).accumulate(v)},nodeStream:function(p,v){return this.internalStream(p||"nodebuffer").toNodejsStream(v)},_compressWorker:function(p,v){if(this._data instanceof l&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var g=this._decompressWorker();return this._dataBinary||(g=g.pipe(new a.Utf8EncodeWorker)),l.createWorkerFrom(g,p,v)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<h.length;f++)c.prototype[h[f]]=d;r.exports=c},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,r,s){(function(i){var o=i.MutationObserver||i.WebKitMutationObserver,a;if(o){var l=0,u=new o(p),c=i.document.createTextNode("");u.observe(c,{characterData:!0}),a=function(){c.data=l=++l%2}}else if(!i.setImmediate&&typeof i.MessageChannel<"u"){var h=new i.MessageChannel;h.port1.onmessage=p,a=function(){h.port2.postMessage(0)}}else"document"in i&&"onreadystatechange"in i.document.createElement("script")?a=function(){var g=i.document.createElement("script");g.onreadystatechange=function(){p(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},i.document.documentElement.appendChild(g)}:a=function(){setTimeout(p,0)};var d,f=[];function p(){d=!0;for(var g,m,y=f.length;y;){for(m=f,f=[],g=-1;++g<y;)m[g]();y=f.length}d=!1}r.exports=v;function v(g){f.push(g)===1&&!d&&a()}}).call(this,typeof gn<"u"?gn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,r,s){var i=t("immediate");function o(){}var a={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];r.exports=h;function h(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,b!==o&&v(this,b)}h.prototype.finally=function(b){if(typeof b!="function")return this;var C=this.constructor;return this.then(k,E);function k(T){function _(){return T}return C.resolve(b()).then(_)}function E(T){function _(){throw T}return C.resolve(b()).then(_)}},h.prototype.catch=function(b){return this.then(null,b)},h.prototype.then=function(b,C){if(typeof b!="function"&&this.state===u||typeof C!="function"&&this.state===l)return this;var k=new this.constructor(o);if(this.state!==c){var E=this.state===u?b:C;f(k,E,this.outcome)}else this.queue.push(new d(k,b,C));return k};function d(b,C,k){this.promise=b,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}d.prototype.callFulfilled=function(b){a.resolve(this.promise,b)},d.prototype.otherCallFulfilled=function(b){f(this.promise,this.onFulfilled,b)},d.prototype.callRejected=function(b){a.reject(this.promise,b)},d.prototype.otherCallRejected=function(b){f(this.promise,this.onRejected,b)};function f(b,C,k){i(function(){var E;try{E=C(k)}catch(T){return a.reject(b,T)}E===b?a.reject(b,new TypeError("Cannot resolve promise with itself")):a.resolve(b,E)})}a.resolve=function(b,C){var k=g(p,C);if(k.status==="error")return a.reject(b,k.value);var E=k.value;if(E)v(b,E);else{b.state=u,b.outcome=C;for(var T=-1,_=b.queue.length;++T<_;)b.queue[T].callFulfilled(C)}return b},a.reject=function(b,C){b.state=l,b.outcome=C;for(var k=-1,E=b.queue.length;++k<E;)b.queue[k].callRejected(C);return b};function p(b){var C=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof C=="function")return function(){C.apply(b,arguments)}}function v(b,C){var k=!1;function E(P){k||(k=!0,a.reject(b,P))}function T(P){k||(k=!0,a.resolve(b,P))}function _(){C(T,E)}var A=g(_);A.status==="error"&&E(A.value)}function g(b,C){var k={};try{k.value=b(C),k.status="success"}catch(E){k.status="error",k.value=E}return k}h.resolve=m;function m(b){return b instanceof this?b:a.resolve(new this(o),b)}h.reject=y;function y(b){var C=new this(o);return a.reject(C,b)}h.all=w;function w(b){var C=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=b.length,E=!1;if(!k)return this.resolve([]);for(var T=new Array(k),_=0,A=-1,P=new this(o);++A<k;)j(b[A],A);return P;function j(X,F){C.resolve(X).then(M,function(W){E||(E=!0,a.reject(P,W))});function M(W){T[F]=W,++_===k&&!E&&(E=!0,a.resolve(P,T))}}}h.race=x;function x(b){var C=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=b.length,E=!1;if(!k)return this.resolve([]);for(var T=-1,_=new this(o);++T<k;)A(b[T]);return _;function A(P){C.resolve(P).then(function(j){E||(E=!0,a.resolve(_,j))},function(j){E||(E=!0,a.reject(_,j))})}}},{immediate:36}],38:[function(t,r,s){var i=t("./lib/utils/common").assign,o=t("./lib/deflate"),a=t("./lib/inflate"),l=t("./lib/zlib/constants"),u={};i(u,o,a,l),r.exports=u},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,r,s){var i=t("./zlib/deflate"),o=t("./utils/common"),a=t("./utils/strings"),l=t("./zlib/messages"),u=t("./zlib/zstream"),c=Object.prototype.toString,h=0,d=4,f=0,p=1,v=2,g=-1,m=0,y=8;function w(k){if(!(this instanceof w))return new w(k);this.options=o.assign({level:g,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},k||{});var E=this.options;E.raw&&E.windowBits>0?E.windowBits=-E.windowBits:E.gzip&&E.windowBits>0&&E.windowBits<16&&(E.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var T=i.deflateInit2(this.strm,E.level,E.method,E.windowBits,E.memLevel,E.strategy);if(T!==f)throw new Error(l[T]);if(E.header&&i.deflateSetHeader(this.strm,E.header),E.dictionary){var _;if(typeof E.dictionary=="string"?_=a.string2buf(E.dictionary):c.call(E.dictionary)==="[object ArrayBuffer]"?_=new Uint8Array(E.dictionary):_=E.dictionary,T=i.deflateSetDictionary(this.strm,_),T!==f)throw new Error(l[T]);this._dict_set=!0}}w.prototype.push=function(k,E){var T=this.strm,_=this.options.chunkSize,A,P;if(this.ended)return!1;P=E===~~E?E:E===!0?d:h,typeof k=="string"?T.input=a.string2buf(k):c.call(k)==="[object ArrayBuffer]"?T.input=new Uint8Array(k):T.input=k,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new o.Buf8(_),T.next_out=0,T.avail_out=_),A=i.deflate(T,P),A!==p&&A!==f)return this.onEnd(A),this.ended=!0,!1;(T.avail_out===0||T.avail_in===0&&(P===d||P===v))&&(this.options.to==="string"?this.onData(a.buf2binstring(o.shrinkBuf(T.output,T.next_out))):this.onData(o.shrinkBuf(T.output,T.next_out)))}while((T.avail_in>0||T.avail_out===0)&&A!==p);return P===d?(A=i.deflateEnd(this.strm),this.onEnd(A),this.ended=!0,A===f):(P===v&&(this.onEnd(f),T.avail_out=0),!0)},w.prototype.onData=function(k){this.chunks.push(k)},w.prototype.onEnd=function(k){k===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=k,this.msg=this.strm.msg};function x(k,E){var T=new w(E);if(T.push(k,!0),T.err)throw T.msg||l[T.err];return T.result}function b(k,E){return E=E||{},E.raw=!0,x(k,E)}function C(k,E){return E=E||{},E.gzip=!0,x(k,E)}s.Deflate=w,s.deflate=x,s.deflateRaw=b,s.gzip=C},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,r,s){var i=t("./zlib/inflate"),o=t("./utils/common"),a=t("./utils/strings"),l=t("./zlib/constants"),u=t("./zlib/messages"),c=t("./zlib/zstream"),h=t("./zlib/gzheader"),d=Object.prototype.toString;function f(g){if(!(this instanceof f))return new f(g);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},g||{});var m=this.options;m.raw&&m.windowBits>=0&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),m.windowBits>=0&&m.windowBits<16&&!(g&&g.windowBits)&&(m.windowBits+=32),m.windowBits>15&&m.windowBits<48&&(m.windowBits&15||(m.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var y=i.inflateInit2(this.strm,m.windowBits);if(y!==l.Z_OK)throw new Error(u[y]);this.header=new h,i.inflateGetHeader(this.strm,this.header)}f.prototype.push=function(g,m){var y=this.strm,w=this.options.chunkSize,x=this.options.dictionary,b,C,k,E,T,_,A=!1;if(this.ended)return!1;C=m===~~m?m:m===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof g=="string"?y.input=a.binstring2buf(g):d.call(g)==="[object ArrayBuffer]"?y.input=new Uint8Array(g):y.input=g,y.next_in=0,y.avail_in=y.input.length;do{if(y.avail_out===0&&(y.output=new o.Buf8(w),y.next_out=0,y.avail_out=w),b=i.inflate(y,l.Z_NO_FLUSH),b===l.Z_NEED_DICT&&x&&(typeof x=="string"?_=a.string2buf(x):d.call(x)==="[object ArrayBuffer]"?_=new Uint8Array(x):_=x,b=i.inflateSetDictionary(this.strm,_)),b===l.Z_BUF_ERROR&&A===!0&&(b=l.Z_OK,A=!1),b!==l.Z_STREAM_END&&b!==l.Z_OK)return this.onEnd(b),this.ended=!0,!1;y.next_out&&(y.avail_out===0||b===l.Z_STREAM_END||y.avail_in===0&&(C===l.Z_FINISH||C===l.Z_SYNC_FLUSH))&&(this.options.to==="string"?(k=a.utf8border(y.output,y.next_out),E=y.next_out-k,T=a.buf2string(y.output,k),y.next_out=E,y.avail_out=w-E,E&&o.arraySet(y.output,y.output,k,E,0),this.onData(T)):this.onData(o.shrinkBuf(y.output,y.next_out))),y.avail_in===0&&y.avail_out===0&&(A=!0)}while((y.avail_in>0||y.avail_out===0)&&b!==l.Z_STREAM_END);return b===l.Z_STREAM_END&&(C=l.Z_FINISH),C===l.Z_FINISH?(b=i.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===l.Z_OK):(C===l.Z_SYNC_FLUSH&&(this.onEnd(l.Z_OK),y.avail_out=0),!0)},f.prototype.onData=function(g){this.chunks.push(g)},f.prototype.onEnd=function(g){g===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg};function p(g,m){var y=new f(m);if(y.push(g,!0),y.err)throw y.msg||u[y.err];return y.result}function v(g,m){return m=m||{},m.raw=!0,p(g,m)}s.Inflate=f,s.inflate=p,s.inflateRaw=v,s.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var c=u.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var h in c)c.hasOwnProperty(h)&&(l[h]=c[h])}}return l},s.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var o={arraySet:function(l,u,c,h,d){if(u.subarray&&l.subarray){l.set(u.subarray(c,c+h),d);return}for(var f=0;f<h;f++)l[d+f]=u[c+f]},flattenChunks:function(l){var u,c,h,d,f,p;for(h=0,u=0,c=l.length;u<c;u++)h+=l[u].length;for(p=new Uint8Array(h),d=0,u=0,c=l.length;u<c;u++)f=l[u],p.set(f,d),d+=f.length;return p}},a={arraySet:function(l,u,c,h,d){for(var f=0;f<h;f++)l[d+f]=u[c+f]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,o)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,a))},s.setTyped(i)},{}],42:[function(t,r,s){var i=t("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new i.Buf8(256),u=0;u<256;u++)l[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;l[254]=l[254]=1,s.string2buf=function(h){var d,f,p,v,g,m=h.length,y=0;for(v=0;v<m;v++)f=h.charCodeAt(v),(f&64512)===55296&&v+1<m&&(p=h.charCodeAt(v+1),(p&64512)===56320&&(f=65536+(f-55296<<10)+(p-56320),v++)),y+=f<128?1:f<2048?2:f<65536?3:4;for(d=new i.Buf8(y),g=0,v=0;g<y;v++)f=h.charCodeAt(v),(f&64512)===55296&&v+1<m&&(p=h.charCodeAt(v+1),(p&64512)===56320&&(f=65536+(f-55296<<10)+(p-56320),v++)),f<128?d[g++]=f:f<2048?(d[g++]=192|f>>>6,d[g++]=128|f&63):f<65536?(d[g++]=224|f>>>12,d[g++]=128|f>>>6&63,d[g++]=128|f&63):(d[g++]=240|f>>>18,d[g++]=128|f>>>12&63,d[g++]=128|f>>>6&63,d[g++]=128|f&63);return d};function c(h,d){if(d<65537&&(h.subarray&&a||!h.subarray&&o))return String.fromCharCode.apply(null,i.shrinkBuf(h,d));for(var f="",p=0;p<d;p++)f+=String.fromCharCode(h[p]);return f}s.buf2binstring=function(h){return c(h,h.length)},s.binstring2buf=function(h){for(var d=new i.Buf8(h.length),f=0,p=d.length;f<p;f++)d[f]=h.charCodeAt(f);return d},s.buf2string=function(h,d){var f,p,v,g,m=d||h.length,y=new Array(m*2);for(p=0,f=0;f<m;){if(v=h[f++],v<128){y[p++]=v;continue}if(g=l[v],g>4){y[p++]=65533,f+=g-1;continue}for(v&=g===2?31:g===3?15:7;g>1&&f<m;)v=v<<6|h[f++]&63,g--;if(g>1){y[p++]=65533;continue}v<65536?y[p++]=v:(v-=65536,y[p++]=55296|v>>10&1023,y[p++]=56320|v&1023)}return c(y,p)},s.utf8border=function(h,d){var f;for(d=d||h.length,d>h.length&&(d=h.length),f=d-1;f>=0&&(h[f]&192)===128;)f--;return f<0||f===0?d:f+l[h[f]]>d?f:d}},{"./common":41}],43:[function(t,r,s){function i(o,a,l,u){for(var c=o&65535|0,h=o>>>16&65535|0,d=0;l!==0;){d=l>2e3?2e3:l,l-=d;do c=c+a[u++]|0,h=h+c|0;while(--d);c%=65521,h%=65521}return c|h<<16|0}r.exports=i},{}],44:[function(t,r,s){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,r,s){function i(){for(var l,u=[],c=0;c<256;c++){l=c;for(var h=0;h<8;h++)l=l&1?3988292384^l>>>1:l>>>1;u[c]=l}return u}var o=i();function a(l,u,c,h){var d=o,f=h+c;l^=-1;for(var p=h;p<f;p++)l=l>>>8^d[(l^u[p])&255];return l^-1}r.exports=a},{}],46:[function(t,r,s){var i=t("../utils/common"),o=t("./trees"),a=t("./adler32"),l=t("./crc32"),u=t("./messages"),c=0,h=1,d=3,f=4,p=5,v=0,g=1,m=-2,y=-3,w=-5,x=-1,b=1,C=2,k=3,E=4,T=0,_=2,A=8,P=9,j=15,X=8,F=29,M=256,W=M+1+F,D=30,z=19,K=2*W+1,ie=15,V=3,Z=258,de=Z+V+1,ge=32,ye=42,G=69,J=73,fe=91,ve=103,be=113,$e=666,Pe=1,Ge=2,Xe=3,Je=4,Ze=3;function it(S,se){return S.msg=u[se],se}function cn(S){return(S<<1)-(S>4?9:0)}function dt(S){for(var se=S.length;--se>=0;)S[se]=0}function Lt(S){var se=S.state,re=se.pending;re>S.avail_out&&(re=S.avail_out),re!==0&&(i.arraySet(S.output,se.pending_buf,se.pending_out,re,S.next_out),S.next_out+=re,se.pending_out+=re,S.total_out+=re,S.avail_out-=re,se.pending-=re,se.pending===0&&(se.pending_out=0))}function lt(S,se){o._tr_flush_block(S,S.block_start>=0?S.block_start:-1,S.strstart-S.block_start,se),S.block_start=S.strstart,Lt(S.strm)}function tt(S,se){S.pending_buf[S.pending++]=se}function Tt(S,se){S.pending_buf[S.pending++]=se>>>8&255,S.pending_buf[S.pending++]=se&255}function Sn(S,se,re,N){var q=S.avail_in;return q>N&&(q=N),q===0?0:(S.avail_in-=q,i.arraySet(se,S.input,S.next_in,q,re),S.state.wrap===1?S.adler=a(S.adler,se,q,re):S.state.wrap===2&&(S.adler=l(S.adler,se,q,re)),S.next_in+=q,S.total_in+=q,q)}function Pt(S,se){var re=S.max_chain_length,N=S.strstart,q,ue,Ne=S.prev_length,Ie=S.nice_match,Fe=S.strstart>S.w_size-de?S.strstart-(S.w_size-de):0,ot=S.window,Hn=S.w_mask,Rt=S.prev,vt=S.strstart+Z,$t=ot[N+Ne-1],jt=ot[N+Ne];S.prev_length>=S.good_match&&(re>>=2),Ie>S.lookahead&&(Ie=S.lookahead);do if(q=se,!(ot[q+Ne]!==jt||ot[q+Ne-1]!==$t||ot[q]!==ot[N]||ot[++q]!==ot[N+1])){N+=2,q++;do;while(ot[++N]===ot[++q]&&ot[++N]===ot[++q]&&ot[++N]===ot[++q]&&ot[++N]===ot[++q]&&ot[++N]===ot[++q]&&ot[++N]===ot[++q]&&ot[++N]===ot[++q]&&ot[++N]===ot[++q]&&N<vt);if(ue=Z-(vt-N),N=vt-Z,ue>Ne){if(S.match_start=se,Ne=ue,ue>=Ie)break;$t=ot[N+Ne-1],jt=ot[N+Ne]}}while((se=Rt[se&Hn])>Fe&&--re!==0);return Ne<=S.lookahead?Ne:S.lookahead}function Wt(S){var se=S.w_size,re,N,q,ue,Ne;do{if(ue=S.window_size-S.lookahead-S.strstart,S.strstart>=se+(se-de)){i.arraySet(S.window,S.window,se,se,0),S.match_start-=se,S.strstart-=se,S.block_start-=se,N=S.hash_size,re=N;do q=S.head[--re],S.head[re]=q>=se?q-se:0;while(--N);N=se,re=N;do q=S.prev[--re],S.prev[re]=q>=se?q-se:0;while(--N);ue+=se}if(S.strm.avail_in===0)break;if(N=Sn(S.strm,S.window,S.strstart+S.lookahead,ue),S.lookahead+=N,S.lookahead+S.insert>=V)for(Ne=S.strstart-S.insert,S.ins_h=S.window[Ne],S.ins_h=(S.ins_h<<S.hash_shift^S.window[Ne+1])&S.hash_mask;S.insert&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[Ne+V-1])&S.hash_mask,S.prev[Ne&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=Ne,Ne++,S.insert--,!(S.lookahead+S.insert<V)););}while(S.lookahead<de&&S.strm.avail_in!==0)}function kn(S,se){var re=65535;for(re>S.pending_buf_size-5&&(re=S.pending_buf_size-5);;){if(S.lookahead<=1){if(Wt(S),S.lookahead===0&&se===c)return Pe;if(S.lookahead===0)break}S.strstart+=S.lookahead,S.lookahead=0;var N=S.block_start+re;if((S.strstart===0||S.strstart>=N)&&(S.lookahead=S.strstart-N,S.strstart=N,lt(S,!1),S.strm.avail_out===0)||S.strstart-S.block_start>=S.w_size-de&&(lt(S,!1),S.strm.avail_out===0))return Pe}return S.insert=0,se===f?(lt(S,!0),S.strm.avail_out===0?Xe:Je):(S.strstart>S.block_start&&(lt(S,!1),S.strm.avail_out===0),Pe)}function On(S,se){for(var re,N;;){if(S.lookahead<de){if(Wt(S),S.lookahead<de&&se===c)return Pe;if(S.lookahead===0)break}if(re=0,S.lookahead>=V&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+V-1])&S.hash_mask,re=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),re!==0&&S.strstart-re<=S.w_size-de&&(S.match_length=Pt(S,re)),S.match_length>=V)if(N=o._tr_tally(S,S.strstart-S.match_start,S.match_length-V),S.lookahead-=S.match_length,S.match_length<=S.max_lazy_match&&S.lookahead>=V){S.match_length--;do S.strstart++,S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+V-1])&S.hash_mask,re=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart;while(--S.match_length!==0);S.strstart++}else S.strstart+=S.match_length,S.match_length=0,S.ins_h=S.window[S.strstart],S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+1])&S.hash_mask;else N=o._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++;if(N&&(lt(S,!1),S.strm.avail_out===0))return Pe}return S.insert=S.strstart<V-1?S.strstart:V-1,se===f?(lt(S,!0),S.strm.avail_out===0?Xe:Je):S.last_lit&&(lt(S,!1),S.strm.avail_out===0)?Pe:Ge}function Fn(S,se){for(var re,N,q;;){if(S.lookahead<de){if(Wt(S),S.lookahead<de&&se===c)return Pe;if(S.lookahead===0)break}if(re=0,S.lookahead>=V&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+V-1])&S.hash_mask,re=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),S.prev_length=S.match_length,S.prev_match=S.match_start,S.match_length=V-1,re!==0&&S.prev_length<S.max_lazy_match&&S.strstart-re<=S.w_size-de&&(S.match_length=Pt(S,re),S.match_length<=5&&(S.strategy===b||S.match_length===V&&S.strstart-S.match_start>4096)&&(S.match_length=V-1)),S.prev_length>=V&&S.match_length<=S.prev_length){q=S.strstart+S.lookahead-V,N=o._tr_tally(S,S.strstart-1-S.prev_match,S.prev_length-V),S.lookahead-=S.prev_length-1,S.prev_length-=2;do++S.strstart<=q&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+V-1])&S.hash_mask,re=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart);while(--S.prev_length!==0);if(S.match_available=0,S.match_length=V-1,S.strstart++,N&&(lt(S,!1),S.strm.avail_out===0))return Pe}else if(S.match_available){if(N=o._tr_tally(S,0,S.window[S.strstart-1]),N&&lt(S,!1),S.strstart++,S.lookahead--,S.strm.avail_out===0)return Pe}else S.match_available=1,S.strstart++,S.lookahead--}return S.match_available&&(N=o._tr_tally(S,0,S.window[S.strstart-1]),S.match_available=0),S.insert=S.strstart<V-1?S.strstart:V-1,se===f?(lt(S,!0),S.strm.avail_out===0?Xe:Je):S.last_lit&&(lt(S,!1),S.strm.avail_out===0)?Pe:Ge}function yr(S,se){for(var re,N,q,ue,Ne=S.window;;){if(S.lookahead<=Z){if(Wt(S),S.lookahead<=Z&&se===c)return Pe;if(S.lookahead===0)break}if(S.match_length=0,S.lookahead>=V&&S.strstart>0&&(q=S.strstart-1,N=Ne[q],N===Ne[++q]&&N===Ne[++q]&&N===Ne[++q])){ue=S.strstart+Z;do;while(N===Ne[++q]&&N===Ne[++q]&&N===Ne[++q]&&N===Ne[++q]&&N===Ne[++q]&&N===Ne[++q]&&N===Ne[++q]&&N===Ne[++q]&&q<ue);S.match_length=Z-(ue-q),S.match_length>S.lookahead&&(S.match_length=S.lookahead)}if(S.match_length>=V?(re=o._tr_tally(S,1,S.match_length-V),S.lookahead-=S.match_length,S.strstart+=S.match_length,S.match_length=0):(re=o._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++),re&&(lt(S,!1),S.strm.avail_out===0))return Pe}return S.insert=0,se===f?(lt(S,!0),S.strm.avail_out===0?Xe:Je):S.last_lit&&(lt(S,!1),S.strm.avail_out===0)?Pe:Ge}function er(S,se){for(var re;;){if(S.lookahead===0&&(Wt(S),S.lookahead===0)){if(se===c)return Pe;break}if(S.match_length=0,re=o._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++,re&&(lt(S,!1),S.strm.avail_out===0))return Pe}return S.insert=0,se===f?(lt(S,!0),S.strm.avail_out===0?Xe:Je):S.last_lit&&(lt(S,!1),S.strm.avail_out===0)?Pe:Ge}function Gt(S,se,re,N,q){this.good_length=S,this.max_lazy=se,this.nice_length=re,this.max_chain=N,this.func=q}var Ln;Ln=[new Gt(0,0,0,0,kn),new Gt(4,4,8,4,On),new Gt(4,5,16,8,On),new Gt(4,6,32,32,On),new Gt(4,4,16,16,Fn),new Gt(8,16,32,32,Fn),new Gt(8,16,128,128,Fn),new Gt(8,32,128,256,Fn),new Gt(32,128,258,1024,Fn),new Gt(32,258,258,4096,Fn)];function ks(S){S.window_size=2*S.w_size,dt(S.head),S.max_lazy_match=Ln[S.level].max_lazy,S.good_match=Ln[S.level].good_length,S.nice_match=Ln[S.level].nice_length,S.max_chain_length=Ln[S.level].max_chain,S.strstart=0,S.block_start=0,S.lookahead=0,S.insert=0,S.match_length=S.prev_length=V-1,S.match_available=0,S.ins_h=0}function L(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=A,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(K*2),this.dyn_dtree=new i.Buf16((2*D+1)*2),this.bl_tree=new i.Buf16((2*z+1)*2),dt(this.dyn_ltree),dt(this.dyn_dtree),dt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(ie+1),this.heap=new i.Buf16(2*W+1),dt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*W+1),dt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Se(S){var se;return!S||!S.state?it(S,m):(S.total_in=S.total_out=0,S.data_type=_,se=S.state,se.pending=0,se.pending_out=0,se.wrap<0&&(se.wrap=-se.wrap),se.status=se.wrap?ye:be,S.adler=se.wrap===2?0:1,se.last_flush=c,o._tr_init(se),v)}function _e(S){var se=Se(S);return se===v&&ks(S.state),se}function We(S,se){return!S||!S.state||S.state.wrap!==2?m:(S.state.gzhead=se,v)}function $(S,se,re,N,q,ue){if(!S)return m;var Ne=1;if(se===x&&(se=6),N<0?(Ne=0,N=-N):N>15&&(Ne=2,N-=16),q<1||q>P||re!==A||N<8||N>15||se<0||se>9||ue<0||ue>E)return it(S,m);N===8&&(N=9);var Ie=new L;return S.state=Ie,Ie.strm=S,Ie.wrap=Ne,Ie.gzhead=null,Ie.w_bits=N,Ie.w_size=1<<Ie.w_bits,Ie.w_mask=Ie.w_size-1,Ie.hash_bits=q+7,Ie.hash_size=1<<Ie.hash_bits,Ie.hash_mask=Ie.hash_size-1,Ie.hash_shift=~~((Ie.hash_bits+V-1)/V),Ie.window=new i.Buf8(Ie.w_size*2),Ie.head=new i.Buf16(Ie.hash_size),Ie.prev=new i.Buf16(Ie.w_size),Ie.lit_bufsize=1<<q+6,Ie.pending_buf_size=Ie.lit_bufsize*4,Ie.pending_buf=new i.Buf8(Ie.pending_buf_size),Ie.d_buf=1*Ie.lit_bufsize,Ie.l_buf=(1+2)*Ie.lit_bufsize,Ie.level=se,Ie.strategy=ue,Ie.method=re,_e(S)}function U(S,se){return $(S,se,A,j,X,T)}function I(S,se){var re,N,q,ue;if(!S||!S.state||se>p||se<0)return S?it(S,m):m;if(N=S.state,!S.output||!S.input&&S.avail_in!==0||N.status===$e&&se!==f)return it(S,S.avail_out===0?w:m);if(N.strm=S,re=N.last_flush,N.last_flush=se,N.status===ye)if(N.wrap===2)S.adler=0,tt(N,31),tt(N,139),tt(N,8),N.gzhead?(tt(N,(N.gzhead.text?1:0)+(N.gzhead.hcrc?2:0)+(N.gzhead.extra?4:0)+(N.gzhead.name?8:0)+(N.gzhead.comment?16:0)),tt(N,N.gzhead.time&255),tt(N,N.gzhead.time>>8&255),tt(N,N.gzhead.time>>16&255),tt(N,N.gzhead.time>>24&255),tt(N,N.level===9?2:N.strategy>=C||N.level<2?4:0),tt(N,N.gzhead.os&255),N.gzhead.extra&&N.gzhead.extra.length&&(tt(N,N.gzhead.extra.length&255),tt(N,N.gzhead.extra.length>>8&255)),N.gzhead.hcrc&&(S.adler=l(S.adler,N.pending_buf,N.pending,0)),N.gzindex=0,N.status=G):(tt(N,0),tt(N,0),tt(N,0),tt(N,0),tt(N,0),tt(N,N.level===9?2:N.strategy>=C||N.level<2?4:0),tt(N,Ze),N.status=be);else{var Ne=A+(N.w_bits-8<<4)<<8,Ie=-1;N.strategy>=C||N.level<2?Ie=0:N.level<6?Ie=1:N.level===6?Ie=2:Ie=3,Ne|=Ie<<6,N.strstart!==0&&(Ne|=ge),Ne+=31-Ne%31,N.status=be,Tt(N,Ne),N.strstart!==0&&(Tt(N,S.adler>>>16),Tt(N,S.adler&65535)),S.adler=1}if(N.status===G)if(N.gzhead.extra){for(q=N.pending;N.gzindex<(N.gzhead.extra.length&65535)&&!(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>q&&(S.adler=l(S.adler,N.pending_buf,N.pending-q,q)),Lt(S),q=N.pending,N.pending===N.pending_buf_size));)tt(N,N.gzhead.extra[N.gzindex]&255),N.gzindex++;N.gzhead.hcrc&&N.pending>q&&(S.adler=l(S.adler,N.pending_buf,N.pending-q,q)),N.gzindex===N.gzhead.extra.length&&(N.gzindex=0,N.status=J)}else N.status=J;if(N.status===J)if(N.gzhead.name){q=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>q&&(S.adler=l(S.adler,N.pending_buf,N.pending-q,q)),Lt(S),q=N.pending,N.pending===N.pending_buf_size)){ue=1;break}N.gzindex<N.gzhead.name.length?ue=N.gzhead.name.charCodeAt(N.gzindex++)&255:ue=0,tt(N,ue)}while(ue!==0);N.gzhead.hcrc&&N.pending>q&&(S.adler=l(S.adler,N.pending_buf,N.pending-q,q)),ue===0&&(N.gzindex=0,N.status=fe)}else N.status=fe;if(N.status===fe)if(N.gzhead.comment){q=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>q&&(S.adler=l(S.adler,N.pending_buf,N.pending-q,q)),Lt(S),q=N.pending,N.pending===N.pending_buf_size)){ue=1;break}N.gzindex<N.gzhead.comment.length?ue=N.gzhead.comment.charCodeAt(N.gzindex++)&255:ue=0,tt(N,ue)}while(ue!==0);N.gzhead.hcrc&&N.pending>q&&(S.adler=l(S.adler,N.pending_buf,N.pending-q,q)),ue===0&&(N.status=ve)}else N.status=ve;if(N.status===ve&&(N.gzhead.hcrc?(N.pending+2>N.pending_buf_size&&Lt(S),N.pending+2<=N.pending_buf_size&&(tt(N,S.adler&255),tt(N,S.adler>>8&255),S.adler=0,N.status=be)):N.status=be),N.pending!==0){if(Lt(S),S.avail_out===0)return N.last_flush=-1,v}else if(S.avail_in===0&&cn(se)<=cn(re)&&se!==f)return it(S,w);if(N.status===$e&&S.avail_in!==0)return it(S,w);if(S.avail_in!==0||N.lookahead!==0||se!==c&&N.status!==$e){var Fe=N.strategy===C?er(N,se):N.strategy===k?yr(N,se):Ln[N.level].func(N,se);if((Fe===Xe||Fe===Je)&&(N.status=$e),Fe===Pe||Fe===Xe)return S.avail_out===0&&(N.last_flush=-1),v;if(Fe===Ge&&(se===h?o._tr_align(N):se!==p&&(o._tr_stored_block(N,0,0,!1),se===d&&(dt(N.head),N.lookahead===0&&(N.strstart=0,N.block_start=0,N.insert=0))),Lt(S),S.avail_out===0))return N.last_flush=-1,v}return se!==f?v:N.wrap<=0?g:(N.wrap===2?(tt(N,S.adler&255),tt(N,S.adler>>8&255),tt(N,S.adler>>16&255),tt(N,S.adler>>24&255),tt(N,S.total_in&255),tt(N,S.total_in>>8&255),tt(N,S.total_in>>16&255),tt(N,S.total_in>>24&255)):(Tt(N,S.adler>>>16),Tt(N,S.adler&65535)),Lt(S),N.wrap>0&&(N.wrap=-N.wrap),N.pending!==0?v:g)}function ce(S){var se;return!S||!S.state?m:(se=S.state.status,se!==ye&&se!==G&&se!==J&&se!==fe&&se!==ve&&se!==be&&se!==$e?it(S,m):(S.state=null,se===be?it(S,y):v))}function ke(S,se){var re=se.length,N,q,ue,Ne,Ie,Fe,ot,Hn;if(!S||!S.state||(N=S.state,Ne=N.wrap,Ne===2||Ne===1&&N.status!==ye||N.lookahead))return m;for(Ne===1&&(S.adler=a(S.adler,se,re,0)),N.wrap=0,re>=N.w_size&&(Ne===0&&(dt(N.head),N.strstart=0,N.block_start=0,N.insert=0),Hn=new i.Buf8(N.w_size),i.arraySet(Hn,se,re-N.w_size,N.w_size,0),se=Hn,re=N.w_size),Ie=S.avail_in,Fe=S.next_in,ot=S.input,S.avail_in=re,S.next_in=0,S.input=se,Wt(N);N.lookahead>=V;){q=N.strstart,ue=N.lookahead-(V-1);do N.ins_h=(N.ins_h<<N.hash_shift^N.window[q+V-1])&N.hash_mask,N.prev[q&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=q,q++;while(--ue);N.strstart=q,N.lookahead=V-1,Wt(N)}return N.strstart+=N.lookahead,N.block_start=N.strstart,N.insert=N.lookahead,N.lookahead=0,N.match_length=N.prev_length=V-1,N.match_available=0,S.next_in=Fe,S.input=ot,S.avail_in=Ie,N.wrap=Ne,v}s.deflateInit=U,s.deflateInit2=$,s.deflateReset=_e,s.deflateResetKeep=Se,s.deflateSetHeader=We,s.deflate=I,s.deflateEnd=ce,s.deflateSetDictionary=ke,s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,r,s){function i(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}r.exports=i},{}],48:[function(t,r,s){var i=30,o=12;r.exports=function(l,u){var c,h,d,f,p,v,g,m,y,w,x,b,C,k,E,T,_,A,P,j,X,F,M,W,D;c=l.state,h=l.next_in,W=l.input,d=h+(l.avail_in-5),f=l.next_out,D=l.output,p=f-(u-l.avail_out),v=f+(l.avail_out-257),g=c.dmax,m=c.wsize,y=c.whave,w=c.wnext,x=c.window,b=c.hold,C=c.bits,k=c.lencode,E=c.distcode,T=(1<<c.lenbits)-1,_=(1<<c.distbits)-1;e:do{C<15&&(b+=W[h++]<<C,C+=8,b+=W[h++]<<C,C+=8),A=k[b&T];t:for(;;){if(P=A>>>24,b>>>=P,C-=P,P=A>>>16&255,P===0)D[f++]=A&65535;else if(P&16){j=A&65535,P&=15,P&&(C<P&&(b+=W[h++]<<C,C+=8),j+=b&(1<<P)-1,b>>>=P,C-=P),C<15&&(b+=W[h++]<<C,C+=8,b+=W[h++]<<C,C+=8),A=E[b&_];n:for(;;){if(P=A>>>24,b>>>=P,C-=P,P=A>>>16&255,P&16){if(X=A&65535,P&=15,C<P&&(b+=W[h++]<<C,C+=8,C<P&&(b+=W[h++]<<C,C+=8)),X+=b&(1<<P)-1,X>g){l.msg="invalid distance too far back",c.mode=i;break e}if(b>>>=P,C-=P,P=f-p,X>P){if(P=X-P,P>y&&c.sane){l.msg="invalid distance too far back",c.mode=i;break e}if(F=0,M=x,w===0){if(F+=m-P,P<j){j-=P;do D[f++]=x[F++];while(--P);F=f-X,M=D}}else if(w<P){if(F+=m+w-P,P-=w,P<j){j-=P;do D[f++]=x[F++];while(--P);if(F=0,w<j){P=w,j-=P;do D[f++]=x[F++];while(--P);F=f-X,M=D}}}else if(F+=w-P,P<j){j-=P;do D[f++]=x[F++];while(--P);F=f-X,M=D}for(;j>2;)D[f++]=M[F++],D[f++]=M[F++],D[f++]=M[F++],j-=3;j&&(D[f++]=M[F++],j>1&&(D[f++]=M[F++]))}else{F=f-X;do D[f++]=D[F++],D[f++]=D[F++],D[f++]=D[F++],j-=3;while(j>2);j&&(D[f++]=D[F++],j>1&&(D[f++]=D[F++]))}}else if(P&64){l.msg="invalid distance code",c.mode=i;break e}else{A=E[(A&65535)+(b&(1<<P)-1)];continue n}break}}else if(P&64)if(P&32){c.mode=o;break e}else{l.msg="invalid literal/length code",c.mode=i;break e}else{A=k[(A&65535)+(b&(1<<P)-1)];continue t}break}}while(h<d&&f<v);j=C>>3,h-=j,C-=j<<3,b&=(1<<C)-1,l.next_in=h,l.next_out=f,l.avail_in=h<d?5+(d-h):5-(h-d),l.avail_out=f<v?257+(v-f):257-(f-v),c.hold=b,c.bits=C}},{}],49:[function(t,r,s){var i=t("../utils/common"),o=t("./adler32"),a=t("./crc32"),l=t("./inffast"),u=t("./inftrees"),c=0,h=1,d=2,f=4,p=5,v=6,g=0,m=1,y=2,w=-2,x=-3,b=-4,C=-5,k=8,E=1,T=2,_=3,A=4,P=5,j=6,X=7,F=8,M=9,W=10,D=11,z=12,K=13,ie=14,V=15,Z=16,de=17,ge=18,ye=19,G=20,J=21,fe=22,ve=23,be=24,$e=25,Pe=26,Ge=27,Xe=28,Je=29,Ze=30,it=31,cn=32,dt=852,Lt=592,lt=15,tt=lt;function Tt($){return($>>>24&255)+($>>>8&65280)+(($&65280)<<8)+(($&255)<<24)}function Sn(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Pt($){var U;return!$||!$.state?w:(U=$.state,$.total_in=$.total_out=U.total=0,$.msg="",U.wrap&&($.adler=U.wrap&1),U.mode=E,U.last=0,U.havedict=0,U.dmax=32768,U.head=null,U.hold=0,U.bits=0,U.lencode=U.lendyn=new i.Buf32(dt),U.distcode=U.distdyn=new i.Buf32(Lt),U.sane=1,U.back=-1,g)}function Wt($){var U;return!$||!$.state?w:(U=$.state,U.wsize=0,U.whave=0,U.wnext=0,Pt($))}function kn($,U){var I,ce;return!$||!$.state||(ce=$.state,U<0?(I=0,U=-U):(I=(U>>4)+1,U<48&&(U&=15)),U&&(U<8||U>15))?w:(ce.window!==null&&ce.wbits!==U&&(ce.window=null),ce.wrap=I,ce.wbits=U,Wt($))}function On($,U){var I,ce;return $?(ce=new Sn,$.state=ce,ce.window=null,I=kn($,U),I!==g&&($.state=null),I):w}function Fn($){return On($,tt)}var yr=!0,er,Gt;function Ln($){if(yr){var U;for(er=new i.Buf32(512),Gt=new i.Buf32(32),U=0;U<144;)$.lens[U++]=8;for(;U<256;)$.lens[U++]=9;for(;U<280;)$.lens[U++]=7;for(;U<288;)$.lens[U++]=8;for(u(h,$.lens,0,288,er,0,$.work,{bits:9}),U=0;U<32;)$.lens[U++]=5;u(d,$.lens,0,32,Gt,0,$.work,{bits:5}),yr=!1}$.lencode=er,$.lenbits=9,$.distcode=Gt,$.distbits=5}function ks($,U,I,ce){var ke,S=$.state;return S.window===null&&(S.wsize=1<<S.wbits,S.wnext=0,S.whave=0,S.window=new i.Buf8(S.wsize)),ce>=S.wsize?(i.arraySet(S.window,U,I-S.wsize,S.wsize,0),S.wnext=0,S.whave=S.wsize):(ke=S.wsize-S.wnext,ke>ce&&(ke=ce),i.arraySet(S.window,U,I-ce,ke,S.wnext),ce-=ke,ce?(i.arraySet(S.window,U,I-ce,ce,0),S.wnext=ce,S.whave=S.wsize):(S.wnext+=ke,S.wnext===S.wsize&&(S.wnext=0),S.whave<S.wsize&&(S.whave+=ke))),0}function L($,U){var I,ce,ke,S,se,re,N,q,ue,Ne,Ie,Fe,ot,Hn,Rt=0,vt,$t,jt,En,Si,ki,Xt,ct,Dt=new i.Buf8(4),Pn,kt,Ei=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!$||!$.state||!$.output||!$.input&&$.avail_in!==0)return w;I=$.state,I.mode===z&&(I.mode=K),se=$.next_out,ke=$.output,N=$.avail_out,S=$.next_in,ce=$.input,re=$.avail_in,q=I.hold,ue=I.bits,Ne=re,Ie=N,ct=g;e:for(;;)switch(I.mode){case E:if(I.wrap===0){I.mode=K;break}for(;ue<16;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}if(I.wrap&2&&q===35615){I.check=0,Dt[0]=q&255,Dt[1]=q>>>8&255,I.check=a(I.check,Dt,2,0),q=0,ue=0,I.mode=T;break}if(I.flags=0,I.head&&(I.head.done=!1),!(I.wrap&1)||(((q&255)<<8)+(q>>8))%31){$.msg="incorrect header check",I.mode=Ze;break}if((q&15)!==k){$.msg="unknown compression method",I.mode=Ze;break}if(q>>>=4,ue-=4,Xt=(q&15)+8,I.wbits===0)I.wbits=Xt;else if(Xt>I.wbits){$.msg="invalid window size",I.mode=Ze;break}I.dmax=1<<Xt,$.adler=I.check=1,I.mode=q&512?W:z,q=0,ue=0;break;case T:for(;ue<16;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}if(I.flags=q,(I.flags&255)!==k){$.msg="unknown compression method",I.mode=Ze;break}if(I.flags&57344){$.msg="unknown header flags set",I.mode=Ze;break}I.head&&(I.head.text=q>>8&1),I.flags&512&&(Dt[0]=q&255,Dt[1]=q>>>8&255,I.check=a(I.check,Dt,2,0)),q=0,ue=0,I.mode=_;case _:for(;ue<32;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}I.head&&(I.head.time=q),I.flags&512&&(Dt[0]=q&255,Dt[1]=q>>>8&255,Dt[2]=q>>>16&255,Dt[3]=q>>>24&255,I.check=a(I.check,Dt,4,0)),q=0,ue=0,I.mode=A;case A:for(;ue<16;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}I.head&&(I.head.xflags=q&255,I.head.os=q>>8),I.flags&512&&(Dt[0]=q&255,Dt[1]=q>>>8&255,I.check=a(I.check,Dt,2,0)),q=0,ue=0,I.mode=P;case P:if(I.flags&1024){for(;ue<16;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}I.length=q,I.head&&(I.head.extra_len=q),I.flags&512&&(Dt[0]=q&255,Dt[1]=q>>>8&255,I.check=a(I.check,Dt,2,0)),q=0,ue=0}else I.head&&(I.head.extra=null);I.mode=j;case j:if(I.flags&1024&&(Fe=I.length,Fe>re&&(Fe=re),Fe&&(I.head&&(Xt=I.head.extra_len-I.length,I.head.extra||(I.head.extra=new Array(I.head.extra_len)),i.arraySet(I.head.extra,ce,S,Fe,Xt)),I.flags&512&&(I.check=a(I.check,ce,Fe,S)),re-=Fe,S+=Fe,I.length-=Fe),I.length))break e;I.length=0,I.mode=X;case X:if(I.flags&2048){if(re===0)break e;Fe=0;do Xt=ce[S+Fe++],I.head&&Xt&&I.length<65536&&(I.head.name+=String.fromCharCode(Xt));while(Xt&&Fe<re);if(I.flags&512&&(I.check=a(I.check,ce,Fe,S)),re-=Fe,S+=Fe,Xt)break e}else I.head&&(I.head.name=null);I.length=0,I.mode=F;case F:if(I.flags&4096){if(re===0)break e;Fe=0;do Xt=ce[S+Fe++],I.head&&Xt&&I.length<65536&&(I.head.comment+=String.fromCharCode(Xt));while(Xt&&Fe<re);if(I.flags&512&&(I.check=a(I.check,ce,Fe,S)),re-=Fe,S+=Fe,Xt)break e}else I.head&&(I.head.comment=null);I.mode=M;case M:if(I.flags&512){for(;ue<16;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}if(q!==(I.check&65535)){$.msg="header crc mismatch",I.mode=Ze;break}q=0,ue=0}I.head&&(I.head.hcrc=I.flags>>9&1,I.head.done=!0),$.adler=I.check=0,I.mode=z;break;case W:for(;ue<32;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}$.adler=I.check=Tt(q),q=0,ue=0,I.mode=D;case D:if(I.havedict===0)return $.next_out=se,$.avail_out=N,$.next_in=S,$.avail_in=re,I.hold=q,I.bits=ue,y;$.adler=I.check=1,I.mode=z;case z:if(U===p||U===v)break e;case K:if(I.last){q>>>=ue&7,ue-=ue&7,I.mode=Ge;break}for(;ue<3;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}switch(I.last=q&1,q>>>=1,ue-=1,q&3){case 0:I.mode=ie;break;case 1:if(Ln(I),I.mode=G,U===v){q>>>=2,ue-=2;break e}break;case 2:I.mode=de;break;case 3:$.msg="invalid block type",I.mode=Ze}q>>>=2,ue-=2;break;case ie:for(q>>>=ue&7,ue-=ue&7;ue<32;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}if((q&65535)!==(q>>>16^65535)){$.msg="invalid stored block lengths",I.mode=Ze;break}if(I.length=q&65535,q=0,ue=0,I.mode=V,U===v)break e;case V:I.mode=Z;case Z:if(Fe=I.length,Fe){if(Fe>re&&(Fe=re),Fe>N&&(Fe=N),Fe===0)break e;i.arraySet(ke,ce,S,Fe,se),re-=Fe,S+=Fe,N-=Fe,se+=Fe,I.length-=Fe;break}I.mode=z;break;case de:for(;ue<14;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}if(I.nlen=(q&31)+257,q>>>=5,ue-=5,I.ndist=(q&31)+1,q>>>=5,ue-=5,I.ncode=(q&15)+4,q>>>=4,ue-=4,I.nlen>286||I.ndist>30){$.msg="too many length or distance symbols",I.mode=Ze;break}I.have=0,I.mode=ge;case ge:for(;I.have<I.ncode;){for(;ue<3;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}I.lens[Ei[I.have++]]=q&7,q>>>=3,ue-=3}for(;I.have<19;)I.lens[Ei[I.have++]]=0;if(I.lencode=I.lendyn,I.lenbits=7,Pn={bits:I.lenbits},ct=u(c,I.lens,0,19,I.lencode,0,I.work,Pn),I.lenbits=Pn.bits,ct){$.msg="invalid code lengths set",I.mode=Ze;break}I.have=0,I.mode=ye;case ye:for(;I.have<I.nlen+I.ndist;){for(;Rt=I.lencode[q&(1<<I.lenbits)-1],vt=Rt>>>24,$t=Rt>>>16&255,jt=Rt&65535,!(vt<=ue);){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}if(jt<16)q>>>=vt,ue-=vt,I.lens[I.have++]=jt;else{if(jt===16){for(kt=vt+2;ue<kt;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}if(q>>>=vt,ue-=vt,I.have===0){$.msg="invalid bit length repeat",I.mode=Ze;break}Xt=I.lens[I.have-1],Fe=3+(q&3),q>>>=2,ue-=2}else if(jt===17){for(kt=vt+3;ue<kt;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}q>>>=vt,ue-=vt,Xt=0,Fe=3+(q&7),q>>>=3,ue-=3}else{for(kt=vt+7;ue<kt;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}q>>>=vt,ue-=vt,Xt=0,Fe=11+(q&127),q>>>=7,ue-=7}if(I.have+Fe>I.nlen+I.ndist){$.msg="invalid bit length repeat",I.mode=Ze;break}for(;Fe--;)I.lens[I.have++]=Xt}}if(I.mode===Ze)break;if(I.lens[256]===0){$.msg="invalid code -- missing end-of-block",I.mode=Ze;break}if(I.lenbits=9,Pn={bits:I.lenbits},ct=u(h,I.lens,0,I.nlen,I.lencode,0,I.work,Pn),I.lenbits=Pn.bits,ct){$.msg="invalid literal/lengths set",I.mode=Ze;break}if(I.distbits=6,I.distcode=I.distdyn,Pn={bits:I.distbits},ct=u(d,I.lens,I.nlen,I.ndist,I.distcode,0,I.work,Pn),I.distbits=Pn.bits,ct){$.msg="invalid distances set",I.mode=Ze;break}if(I.mode=G,U===v)break e;case G:I.mode=J;case J:if(re>=6&&N>=258){$.next_out=se,$.avail_out=N,$.next_in=S,$.avail_in=re,I.hold=q,I.bits=ue,l($,Ie),se=$.next_out,ke=$.output,N=$.avail_out,S=$.next_in,ce=$.input,re=$.avail_in,q=I.hold,ue=I.bits,I.mode===z&&(I.back=-1);break}for(I.back=0;Rt=I.lencode[q&(1<<I.lenbits)-1],vt=Rt>>>24,$t=Rt>>>16&255,jt=Rt&65535,!(vt<=ue);){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}if($t&&!($t&240)){for(En=vt,Si=$t,ki=jt;Rt=I.lencode[ki+((q&(1<<En+Si)-1)>>En)],vt=Rt>>>24,$t=Rt>>>16&255,jt=Rt&65535,!(En+vt<=ue);){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}q>>>=En,ue-=En,I.back+=En}if(q>>>=vt,ue-=vt,I.back+=vt,I.length=jt,$t===0){I.mode=Pe;break}if($t&32){I.back=-1,I.mode=z;break}if($t&64){$.msg="invalid literal/length code",I.mode=Ze;break}I.extra=$t&15,I.mode=fe;case fe:if(I.extra){for(kt=I.extra;ue<kt;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}I.length+=q&(1<<I.extra)-1,q>>>=I.extra,ue-=I.extra,I.back+=I.extra}I.was=I.length,I.mode=ve;case ve:for(;Rt=I.distcode[q&(1<<I.distbits)-1],vt=Rt>>>24,$t=Rt>>>16&255,jt=Rt&65535,!(vt<=ue);){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}if(!($t&240)){for(En=vt,Si=$t,ki=jt;Rt=I.distcode[ki+((q&(1<<En+Si)-1)>>En)],vt=Rt>>>24,$t=Rt>>>16&255,jt=Rt&65535,!(En+vt<=ue);){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}q>>>=En,ue-=En,I.back+=En}if(q>>>=vt,ue-=vt,I.back+=vt,$t&64){$.msg="invalid distance code",I.mode=Ze;break}I.offset=jt,I.extra=$t&15,I.mode=be;case be:if(I.extra){for(kt=I.extra;ue<kt;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}I.offset+=q&(1<<I.extra)-1,q>>>=I.extra,ue-=I.extra,I.back+=I.extra}if(I.offset>I.dmax){$.msg="invalid distance too far back",I.mode=Ze;break}I.mode=$e;case $e:if(N===0)break e;if(Fe=Ie-N,I.offset>Fe){if(Fe=I.offset-Fe,Fe>I.whave&&I.sane){$.msg="invalid distance too far back",I.mode=Ze;break}Fe>I.wnext?(Fe-=I.wnext,ot=I.wsize-Fe):ot=I.wnext-Fe,Fe>I.length&&(Fe=I.length),Hn=I.window}else Hn=ke,ot=se-I.offset,Fe=I.length;Fe>N&&(Fe=N),N-=Fe,I.length-=Fe;do ke[se++]=Hn[ot++];while(--Fe);I.length===0&&(I.mode=J);break;case Pe:if(N===0)break e;ke[se++]=I.length,N--,I.mode=J;break;case Ge:if(I.wrap){for(;ue<32;){if(re===0)break e;re--,q|=ce[S++]<<ue,ue+=8}if(Ie-=N,$.total_out+=Ie,I.total+=Ie,Ie&&($.adler=I.check=I.flags?a(I.check,ke,Ie,se-Ie):o(I.check,ke,Ie,se-Ie)),Ie=N,(I.flags?q:Tt(q))!==I.check){$.msg="incorrect data check",I.mode=Ze;break}q=0,ue=0}I.mode=Xe;case Xe:if(I.wrap&&I.flags){for(;ue<32;){if(re===0)break e;re--,q+=ce[S++]<<ue,ue+=8}if(q!==(I.total&4294967295)){$.msg="incorrect length check",I.mode=Ze;break}q=0,ue=0}I.mode=Je;case Je:ct=m;break e;case Ze:ct=x;break e;case it:return b;case cn:default:return w}return $.next_out=se,$.avail_out=N,$.next_in=S,$.avail_in=re,I.hold=q,I.bits=ue,(I.wsize||Ie!==$.avail_out&&I.mode<Ze&&(I.mode<Ge||U!==f))&&ks($,$.output,$.next_out,Ie-$.avail_out),Ne-=$.avail_in,Ie-=$.avail_out,$.total_in+=Ne,$.total_out+=Ie,I.total+=Ie,I.wrap&&Ie&&($.adler=I.check=I.flags?a(I.check,ke,Ie,$.next_out-Ie):o(I.check,ke,Ie,$.next_out-Ie)),$.data_type=I.bits+(I.last?64:0)+(I.mode===z?128:0)+(I.mode===G||I.mode===V?256:0),(Ne===0&&Ie===0||U===f)&&ct===g&&(ct=C),ct}function Se($){if(!$||!$.state)return w;var U=$.state;return U.window&&(U.window=null),$.state=null,g}function _e($,U){var I;return!$||!$.state||(I=$.state,!(I.wrap&2))?w:(I.head=U,U.done=!1,g)}function We($,U){var I=U.length,ce,ke,S;return!$||!$.state||(ce=$.state,ce.wrap!==0&&ce.mode!==D)?w:ce.mode===D&&(ke=1,ke=o(ke,U,I,0),ke!==ce.check)?x:(S=ks($,U,I,I),S?(ce.mode=it,b):(ce.havedict=1,g))}s.inflateReset=Wt,s.inflateReset2=kn,s.inflateResetKeep=Pt,s.inflateInit=Fn,s.inflateInit2=On,s.inflate=L,s.inflateEnd=Se,s.inflateGetHeader=_e,s.inflateSetDictionary=We,s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,r,s){var i=t("../utils/common"),o=15,a=852,l=592,u=0,c=1,h=2,d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],f=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],v=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(m,y,w,x,b,C,k,E){var T=E.bits,_=0,A=0,P=0,j=0,X=0,F=0,M=0,W=0,D=0,z=0,K,ie,V,Z,de,ge=null,ye=0,G,J=new i.Buf16(o+1),fe=new i.Buf16(o+1),ve=null,be=0,$e,Pe,Ge;for(_=0;_<=o;_++)J[_]=0;for(A=0;A<x;A++)J[y[w+A]]++;for(X=T,j=o;j>=1&&J[j]===0;j--);if(X>j&&(X=j),j===0)return b[C++]=1<<24|64<<16|0,b[C++]=1<<24|64<<16|0,E.bits=1,0;for(P=1;P<j&&J[P]===0;P++);for(X<P&&(X=P),W=1,_=1;_<=o;_++)if(W<<=1,W-=J[_],W<0)return-1;if(W>0&&(m===u||j!==1))return-1;for(fe[1]=0,_=1;_<o;_++)fe[_+1]=fe[_]+J[_];for(A=0;A<x;A++)y[w+A]!==0&&(k[fe[y[w+A]]++]=A);if(m===u?(ge=ve=k,G=19):m===c?(ge=d,ye-=257,ve=f,be-=257,G=256):(ge=p,ve=v,G=-1),z=0,A=0,_=P,de=C,F=X,M=0,V=-1,D=1<<X,Z=D-1,m===c&&D>a||m===h&&D>l)return 1;for(;;){$e=_-M,k[A]<G?(Pe=0,Ge=k[A]):k[A]>G?(Pe=ve[be+k[A]],Ge=ge[ye+k[A]]):(Pe=32+64,Ge=0),K=1<<_-M,ie=1<<F,P=ie;do ie-=K,b[de+(z>>M)+ie]=$e<<24|Pe<<16|Ge|0;while(ie!==0);for(K=1<<_-1;z&K;)K>>=1;if(K!==0?(z&=K-1,z+=K):z=0,A++,--J[_]===0){if(_===j)break;_=y[w+k[A]]}if(_>X&&(z&Z)!==V){for(M===0&&(M=X),de+=P,F=_-M,W=1<<F;F+M<j&&(W-=J[F+M],!(W<=0));)F++,W<<=1;if(D+=1<<F,m===c&&D>a||m===h&&D>l)return 1;V=z&Z,b[V]=X<<24|F<<16|de-C|0}}return z!==0&&(b[de+z]=_-M<<24|64<<16|0),E.bits=X,0}},{"../utils/common":41}],51:[function(t,r,s){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,r,s){var i=t("../utils/common"),o=4,a=0,l=1,u=2;function c(L){for(var Se=L.length;--Se>=0;)L[Se]=0}var h=0,d=1,f=2,p=3,v=258,g=29,m=256,y=m+1+g,w=30,x=19,b=2*y+1,C=15,k=16,E=7,T=256,_=16,A=17,P=18,j=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],X=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],F=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=512,D=new Array((y+2)*2);c(D);var z=new Array(w*2);c(z);var K=new Array(W);c(K);var ie=new Array(v-p+1);c(ie);var V=new Array(g);c(V);var Z=new Array(w);c(Z);function de(L,Se,_e,We,$){this.static_tree=L,this.extra_bits=Se,this.extra_base=_e,this.elems=We,this.max_length=$,this.has_stree=L&&L.length}var ge,ye,G;function J(L,Se){this.dyn_tree=L,this.max_code=0,this.stat_desc=Se}function fe(L){return L<256?K[L]:K[256+(L>>>7)]}function ve(L,Se){L.pending_buf[L.pending++]=Se&255,L.pending_buf[L.pending++]=Se>>>8&255}function be(L,Se,_e){L.bi_valid>k-_e?(L.bi_buf|=Se<<L.bi_valid&65535,ve(L,L.bi_buf),L.bi_buf=Se>>k-L.bi_valid,L.bi_valid+=_e-k):(L.bi_buf|=Se<<L.bi_valid&65535,L.bi_valid+=_e)}function $e(L,Se,_e){be(L,_e[Se*2],_e[Se*2+1])}function Pe(L,Se){var _e=0;do _e|=L&1,L>>>=1,_e<<=1;while(--Se>0);return _e>>>1}function Ge(L){L.bi_valid===16?(ve(L,L.bi_buf),L.bi_buf=0,L.bi_valid=0):L.bi_valid>=8&&(L.pending_buf[L.pending++]=L.bi_buf&255,L.bi_buf>>=8,L.bi_valid-=8)}function Xe(L,Se){var _e=Se.dyn_tree,We=Se.max_code,$=Se.stat_desc.static_tree,U=Se.stat_desc.has_stree,I=Se.stat_desc.extra_bits,ce=Se.stat_desc.extra_base,ke=Se.stat_desc.max_length,S,se,re,N,q,ue,Ne=0;for(N=0;N<=C;N++)L.bl_count[N]=0;for(_e[L.heap[L.heap_max]*2+1]=0,S=L.heap_max+1;S<b;S++)se=L.heap[S],N=_e[_e[se*2+1]*2+1]+1,N>ke&&(N=ke,Ne++),_e[se*2+1]=N,!(se>We)&&(L.bl_count[N]++,q=0,se>=ce&&(q=I[se-ce]),ue=_e[se*2],L.opt_len+=ue*(N+q),U&&(L.static_len+=ue*($[se*2+1]+q)));if(Ne!==0){do{for(N=ke-1;L.bl_count[N]===0;)N--;L.bl_count[N]--,L.bl_count[N+1]+=2,L.bl_count[ke]--,Ne-=2}while(Ne>0);for(N=ke;N!==0;N--)for(se=L.bl_count[N];se!==0;)re=L.heap[--S],!(re>We)&&(_e[re*2+1]!==N&&(L.opt_len+=(N-_e[re*2+1])*_e[re*2],_e[re*2+1]=N),se--)}}function Je(L,Se,_e){var We=new Array(C+1),$=0,U,I;for(U=1;U<=C;U++)We[U]=$=$+_e[U-1]<<1;for(I=0;I<=Se;I++){var ce=L[I*2+1];ce!==0&&(L[I*2]=Pe(We[ce]++,ce))}}function Ze(){var L,Se,_e,We,$,U=new Array(C+1);for(_e=0,We=0;We<g-1;We++)for(V[We]=_e,L=0;L<1<<j[We];L++)ie[_e++]=We;for(ie[_e-1]=We,$=0,We=0;We<16;We++)for(Z[We]=$,L=0;L<1<<X[We];L++)K[$++]=We;for($>>=7;We<w;We++)for(Z[We]=$<<7,L=0;L<1<<X[We]-7;L++)K[256+$++]=We;for(Se=0;Se<=C;Se++)U[Se]=0;for(L=0;L<=143;)D[L*2+1]=8,L++,U[8]++;for(;L<=255;)D[L*2+1]=9,L++,U[9]++;for(;L<=279;)D[L*2+1]=7,L++,U[7]++;for(;L<=287;)D[L*2+1]=8,L++,U[8]++;for(Je(D,y+1,U),L=0;L<w;L++)z[L*2+1]=5,z[L*2]=Pe(L,5);ge=new de(D,j,m+1,y,C),ye=new de(z,X,0,w,C),G=new de(new Array(0),F,0,x,E)}function it(L){var Se;for(Se=0;Se<y;Se++)L.dyn_ltree[Se*2]=0;for(Se=0;Se<w;Se++)L.dyn_dtree[Se*2]=0;for(Se=0;Se<x;Se++)L.bl_tree[Se*2]=0;L.dyn_ltree[T*2]=1,L.opt_len=L.static_len=0,L.last_lit=L.matches=0}function cn(L){L.bi_valid>8?ve(L,L.bi_buf):L.bi_valid>0&&(L.pending_buf[L.pending++]=L.bi_buf),L.bi_buf=0,L.bi_valid=0}function dt(L,Se,_e,We){cn(L),We&&(ve(L,_e),ve(L,~_e)),i.arraySet(L.pending_buf,L.window,Se,_e,L.pending),L.pending+=_e}function Lt(L,Se,_e,We){var $=Se*2,U=_e*2;return L[$]<L[U]||L[$]===L[U]&&We[Se]<=We[_e]}function lt(L,Se,_e){for(var We=L.heap[_e],$=_e<<1;$<=L.heap_len&&($<L.heap_len&&Lt(Se,L.heap[$+1],L.heap[$],L.depth)&&$++,!Lt(Se,We,L.heap[$],L.depth));)L.heap[_e]=L.heap[$],_e=$,$<<=1;L.heap[_e]=We}function tt(L,Se,_e){var We,$,U=0,I,ce;if(L.last_lit!==0)do We=L.pending_buf[L.d_buf+U*2]<<8|L.pending_buf[L.d_buf+U*2+1],$=L.pending_buf[L.l_buf+U],U++,We===0?$e(L,$,Se):(I=ie[$],$e(L,I+m+1,Se),ce=j[I],ce!==0&&($-=V[I],be(L,$,ce)),We--,I=fe(We),$e(L,I,_e),ce=X[I],ce!==0&&(We-=Z[I],be(L,We,ce)));while(U<L.last_lit);$e(L,T,Se)}function Tt(L,Se){var _e=Se.dyn_tree,We=Se.stat_desc.static_tree,$=Se.stat_desc.has_stree,U=Se.stat_desc.elems,I,ce,ke=-1,S;for(L.heap_len=0,L.heap_max=b,I=0;I<U;I++)_e[I*2]!==0?(L.heap[++L.heap_len]=ke=I,L.depth[I]=0):_e[I*2+1]=0;for(;L.heap_len<2;)S=L.heap[++L.heap_len]=ke<2?++ke:0,_e[S*2]=1,L.depth[S]=0,L.opt_len--,$&&(L.static_len-=We[S*2+1]);for(Se.max_code=ke,I=L.heap_len>>1;I>=1;I--)lt(L,_e,I);S=U;do I=L.heap[1],L.heap[1]=L.heap[L.heap_len--],lt(L,_e,1),ce=L.heap[1],L.heap[--L.heap_max]=I,L.heap[--L.heap_max]=ce,_e[S*2]=_e[I*2]+_e[ce*2],L.depth[S]=(L.depth[I]>=L.depth[ce]?L.depth[I]:L.depth[ce])+1,_e[I*2+1]=_e[ce*2+1]=S,L.heap[1]=S++,lt(L,_e,1);while(L.heap_len>=2);L.heap[--L.heap_max]=L.heap[1],Xe(L,Se),Je(_e,ke,L.bl_count)}function Sn(L,Se,_e){var We,$=-1,U,I=Se[0*2+1],ce=0,ke=7,S=4;for(I===0&&(ke=138,S=3),Se[(_e+1)*2+1]=65535,We=0;We<=_e;We++)U=I,I=Se[(We+1)*2+1],!(++ce<ke&&U===I)&&(ce<S?L.bl_tree[U*2]+=ce:U!==0?(U!==$&&L.bl_tree[U*2]++,L.bl_tree[_*2]++):ce<=10?L.bl_tree[A*2]++:L.bl_tree[P*2]++,ce=0,$=U,I===0?(ke=138,S=3):U===I?(ke=6,S=3):(ke=7,S=4))}function Pt(L,Se,_e){var We,$=-1,U,I=Se[0*2+1],ce=0,ke=7,S=4;for(I===0&&(ke=138,S=3),We=0;We<=_e;We++)if(U=I,I=Se[(We+1)*2+1],!(++ce<ke&&U===I)){if(ce<S)do $e(L,U,L.bl_tree);while(--ce!==0);else U!==0?(U!==$&&($e(L,U,L.bl_tree),ce--),$e(L,_,L.bl_tree),be(L,ce-3,2)):ce<=10?($e(L,A,L.bl_tree),be(L,ce-3,3)):($e(L,P,L.bl_tree),be(L,ce-11,7));ce=0,$=U,I===0?(ke=138,S=3):U===I?(ke=6,S=3):(ke=7,S=4)}}function Wt(L){var Se;for(Sn(L,L.dyn_ltree,L.l_desc.max_code),Sn(L,L.dyn_dtree,L.d_desc.max_code),Tt(L,L.bl_desc),Se=x-1;Se>=3&&L.bl_tree[M[Se]*2+1]===0;Se--);return L.opt_len+=3*(Se+1)+5+5+4,Se}function kn(L,Se,_e,We){var $;for(be(L,Se-257,5),be(L,_e-1,5),be(L,We-4,4),$=0;$<We;$++)be(L,L.bl_tree[M[$]*2+1],3);Pt(L,L.dyn_ltree,Se-1),Pt(L,L.dyn_dtree,_e-1)}function On(L){var Se=4093624447,_e;for(_e=0;_e<=31;_e++,Se>>>=1)if(Se&1&&L.dyn_ltree[_e*2]!==0)return a;if(L.dyn_ltree[9*2]!==0||L.dyn_ltree[10*2]!==0||L.dyn_ltree[13*2]!==0)return l;for(_e=32;_e<m;_e++)if(L.dyn_ltree[_e*2]!==0)return l;return a}var Fn=!1;function yr(L){Fn||(Ze(),Fn=!0),L.l_desc=new J(L.dyn_ltree,ge),L.d_desc=new J(L.dyn_dtree,ye),L.bl_desc=new J(L.bl_tree,G),L.bi_buf=0,L.bi_valid=0,it(L)}function er(L,Se,_e,We){be(L,(h<<1)+(We?1:0),3),dt(L,Se,_e,!0)}function Gt(L){be(L,d<<1,3),$e(L,T,D),Ge(L)}function Ln(L,Se,_e,We){var $,U,I=0;L.level>0?(L.strm.data_type===u&&(L.strm.data_type=On(L)),Tt(L,L.l_desc),Tt(L,L.d_desc),I=Wt(L),$=L.opt_len+3+7>>>3,U=L.static_len+3+7>>>3,U<=$&&($=U)):$=U=_e+5,_e+4<=$&&Se!==-1?er(L,Se,_e,We):L.strategy===o||U===$?(be(L,(d<<1)+(We?1:0),3),tt(L,D,z)):(be(L,(f<<1)+(We?1:0),3),kn(L,L.l_desc.max_code+1,L.d_desc.max_code+1,I+1),tt(L,L.dyn_ltree,L.dyn_dtree)),it(L),We&&cn(L)}function ks(L,Se,_e){return L.pending_buf[L.d_buf+L.last_lit*2]=Se>>>8&255,L.pending_buf[L.d_buf+L.last_lit*2+1]=Se&255,L.pending_buf[L.l_buf+L.last_lit]=_e&255,L.last_lit++,Se===0?L.dyn_ltree[_e*2]++:(L.matches++,Se--,L.dyn_ltree[(ie[_e]+m+1)*2]++,L.dyn_dtree[fe(Se)*2]++),L.last_lit===L.lit_bufsize-1}s._tr_init=yr,s._tr_stored_block=er,s._tr_flush_block=Ln,s._tr_tally=ks,s._tr_align=Gt},{"../utils/common":41}],53:[function(t,r,s){function i(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}r.exports=i},{}],54:[function(t,r,s){(function(i){(function(o,a){if(o.setImmediate)return;var l=1,u={},c=!1,h=o.document,d;function f(E){typeof E!="function"&&(E=new Function(""+E));for(var T=new Array(arguments.length-1),_=0;_<T.length;_++)T[_]=arguments[_+1];var A={callback:E,args:T};return u[l]=A,d(l),l++}function p(E){delete u[E]}function v(E){var T=E.callback,_=E.args;switch(_.length){case 0:T();break;case 1:T(_[0]);break;case 2:T(_[0],_[1]);break;case 3:T(_[0],_[1],_[2]);break;default:T.apply(a,_);break}}function g(E){if(c)setTimeout(g,0,E);else{var T=u[E];if(T){c=!0;try{v(T)}finally{p(E),c=!1}}}}function m(){d=function(E){process.nextTick(function(){g(E)})}}function y(){if(o.postMessage&&!o.importScripts){var E=!0,T=o.onmessage;return o.onmessage=function(){E=!1},o.postMessage("","*"),o.onmessage=T,E}}function w(){var E="setImmediate$"+Math.random()+"$",T=function(_){_.source===o&&typeof _.data=="string"&&_.data.indexOf(E)===0&&g(+_.data.slice(E.length))};o.addEventListener?o.addEventListener("message",T,!1):o.attachEvent("onmessage",T),d=function(_){o.postMessage(E+_,"*")}}function x(){var E=new MessageChannel;E.port1.onmessage=function(T){var _=T.data;g(_)},d=function(T){E.port2.postMessage(T)}}function b(){var E=h.documentElement;d=function(T){var _=h.createElement("script");_.onreadystatechange=function(){g(T),_.onreadystatechange=null,E.removeChild(_),_=null},E.appendChild(_)}}function C(){d=function(E){setTimeout(g,0,E)}}var k=Object.getPrototypeOf&&Object.getPrototypeOf(o);k=k&&k.setTimeout?k:o,{}.toString.call(o.process)==="[object process]"?m():y()?w():o.MessageChannel?x():h&&"onreadystatechange"in h.createElement("script")?b():C(),k.setImmediate=f,k.clearImmediate=p})(typeof self>"u"?typeof i>"u"?this:i:self)}).call(this,typeof gn<"u"?gn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(sD);var y8=sD.exports;Object.defineProperty(Kg,"__esModule",{value:!0});Kg.default=void 0;var eu=je,x8=Xg(Tl),hE=Xg(lc),w8=Xg(Qi),b8=Xg(y8);function Xg(n){return n&&n.__esModule?n:{default:n}}class C8{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new b8.default}catch{throw new Error("JSZip lib not loaded")}}open(e,t){return this.zip.loadAsync(e,{base64:t})}openUrl(e,t){return(0,x8.default)(e,"binary").then((function(r){return this.zip.loadAsync(r,{base64:t})}).bind(this))}request(e,t){var r=new eu.defer,s,i=new w8.default(e);return t||(t=i.extension),t=="blob"?s=this.getBlob(e):s=this.getText(e),s?s.then((function(o){let a=this.handleResponse(o,t);r.resolve(a)}).bind(this)):r.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),r.promise}handleResponse(e,t){var r;return t=="json"?r=JSON.parse(e):(0,eu.isXml)(t)?r=(0,eu.parse)(e,"text/xml"):t=="xhtml"?r=(0,eu.parse)(e,"application/xhtml+xml"):t=="html"||t=="htm"?r=(0,eu.parse)(e,"text/html"):r=e,r}getBlob(e,t){var r=window.decodeURIComponent(e.substr(1)),s=this.zip.file(r);if(s)return t=t||hE.default.lookup(s.name),s.async("uint8array").then(function(i){return new Blob([i],{type:t})})}getText(e,t){var r=window.decodeURIComponent(e.substr(1)),s=this.zip.file(r);if(s)return s.async("string").then(function(i){return i})}getBase64(e,t){var r=window.decodeURIComponent(e.substr(1)),s=this.zip.file(r);if(s)return t=t||hE.default.lookup(s.name),s.async("base64").then(function(i){return"data:"+t+";base64,"+i})}createUrl(e,t){var r=new eu.defer,s=window.URL||window.webkitURL||window.mozURL,i,o,a=t&&t.base64;return e in this.urlCache?(r.resolve(this.urlCache[e]),r.promise):(a?(o=this.getBase64(e),o&&o.then((function(l){this.urlCache[e]=l,r.resolve(l)}).bind(this))):(o=this.getBlob(e),o&&o.then((function(l){i=s.createObjectURL(l),this.urlCache[e]=i,r.resolve(i)}).bind(this))),o||r.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),r.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[e];r&&t.revokeObjectURL(r)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.zip=void 0,this.urlCache={}}}var S8=C8;Kg.default=S8;var Yg={},iD={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(n,e){(function(t){n.exports=t()})(function(){return function t(r,s,i){function o(u,c){if(!s[u]){if(!r[u]){var h=typeof Go=="function"&&Go;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var f=s[u]={exports:{}};r[u][0].call(f.exports,function(p){var v=r[u][1][p];return o(v||p)},f,f.exports,t,r,s,i)}return s[u].exports}for(var a=typeof Go=="function"&&Go,l=0;l<i.length;l++)o(i[l]);return o}({1:[function(t,r,s){(function(i){var o=i.MutationObserver||i.WebKitMutationObserver,a;if(o){var l=0,u=new o(p),c=i.document.createTextNode("");u.observe(c,{characterData:!0}),a=function(){c.data=l=++l%2}}else if(!i.setImmediate&&typeof i.MessageChannel<"u"){var h=new i.MessageChannel;h.port1.onmessage=p,a=function(){h.port2.postMessage(0)}}else"document"in i&&"onreadystatechange"in i.document.createElement("script")?a=function(){var g=i.document.createElement("script");g.onreadystatechange=function(){p(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},i.document.documentElement.appendChild(g)}:a=function(){setTimeout(p,0)};var d,f=[];function p(){d=!0;for(var g,m,y=f.length;y;){for(m=f,f=[],g=-1;++g<y;)m[g]();y=f.length}d=!1}r.exports=v;function v(g){f.push(g)===1&&!d&&a()}}).call(this,typeof gn<"u"?gn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,r,s){var i=t(1);function o(){}var a={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];r.exports=h;function h(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,b!==o&&v(this,b)}h.prototype.catch=function(b){return this.then(null,b)},h.prototype.then=function(b,C){if(typeof b!="function"&&this.state===u||typeof C!="function"&&this.state===l)return this;var k=new this.constructor(o);if(this.state!==c){var E=this.state===u?b:C;f(k,E,this.outcome)}else this.queue.push(new d(k,b,C));return k};function d(b,C,k){this.promise=b,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}d.prototype.callFulfilled=function(b){a.resolve(this.promise,b)},d.prototype.otherCallFulfilled=function(b){f(this.promise,this.onFulfilled,b)},d.prototype.callRejected=function(b){a.reject(this.promise,b)},d.prototype.otherCallRejected=function(b){f(this.promise,this.onRejected,b)};function f(b,C,k){i(function(){var E;try{E=C(k)}catch(T){return a.reject(b,T)}E===b?a.reject(b,new TypeError("Cannot resolve promise with itself")):a.resolve(b,E)})}a.resolve=function(b,C){var k=g(p,C);if(k.status==="error")return a.reject(b,k.value);var E=k.value;if(E)v(b,E);else{b.state=u,b.outcome=C;for(var T=-1,_=b.queue.length;++T<_;)b.queue[T].callFulfilled(C)}return b},a.reject=function(b,C){b.state=l,b.outcome=C;for(var k=-1,E=b.queue.length;++k<E;)b.queue[k].callRejected(C);return b};function p(b){var C=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof C=="function")return function(){C.apply(b,arguments)}}function v(b,C){var k=!1;function E(P){k||(k=!0,a.reject(b,P))}function T(P){k||(k=!0,a.resolve(b,P))}function _(){C(T,E)}var A=g(_);A.status==="error"&&E(A.value)}function g(b,C){var k={};try{k.value=b(C),k.status="success"}catch(E){k.status="error",k.value=E}return k}h.resolve=m;function m(b){return b instanceof this?b:a.resolve(new this(o),b)}h.reject=y;function y(b){var C=new this(o);return a.reject(C,b)}h.all=w;function w(b){var C=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=b.length,E=!1;if(!k)return this.resolve([]);for(var T=new Array(k),_=0,A=-1,P=new this(o);++A<k;)j(b[A],A);return P;function j(X,F){C.resolve(X).then(M,function(W){E||(E=!0,a.reject(P,W))});function M(W){T[F]=W,++_===k&&!E&&(E=!0,a.resolve(P,T))}}}h.race=x;function x(b){var C=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=b.length,E=!1;if(!k)return this.resolve([]);for(var T=-1,_=new this(o);++T<k;)A(b[T]);return _;function A(P){C.resolve(P).then(function(j){E||(E=!0,a.resolve(_,j))},function(j){E||(E=!0,a.reject(_,j))})}}},{1:1}],3:[function(t,r,s){(function(i){typeof i.Promise!="function"&&(i.Promise=t(2))}).call(this,typeof gn<"u"?gn:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,r,s){var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R};function o(R,Y){if(!(R instanceof Y))throw new TypeError("Cannot call a class as a function")}function a(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var l=a();function u(){try{if(!l||!l.open)return!1;var R=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),Y=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!R||Y)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function c(R,Y){R=R||[],Y=Y||{};try{return new Blob(R,Y)}catch(ne){if(ne.name!=="TypeError")throw ne;for(var B=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,oe=new B,he=0;he<R.length;he+=1)oe.append(R[he]);return oe.getBlob(Y.type)}}typeof Promise>"u"&&t(3);var h=Promise;function d(R,Y){Y&&R.then(function(B){Y(null,B)},function(B){Y(B)})}function f(R,Y,B){typeof Y=="function"&&R.then(Y),typeof B=="function"&&R.catch(B)}function p(R){return typeof R!="string"&&(console.warn(R+" used as a key, but it is not a string."),R=String(R)),R}function v(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var g="local-forage-detect-blob-support",m=void 0,y={},w=Object.prototype.toString,x="readonly",b="readwrite";function C(R){for(var Y=R.length,B=new ArrayBuffer(Y),oe=new Uint8Array(B),he=0;he<Y;he++)oe[he]=R.charCodeAt(he);return B}function k(R){return new h(function(Y){var B=R.transaction(g,b),oe=c([""]);B.objectStore(g).put(oe,"key"),B.onabort=function(he){he.preventDefault(),he.stopPropagation(),Y(!1)},B.oncomplete=function(){var he=navigator.userAgent.match(/Chrome\/(\d+)/),ne=navigator.userAgent.match(/Edge\//);Y(ne||!he||parseInt(he[1],10)>=43)}}).catch(function(){return!1})}function E(R){return typeof m=="boolean"?h.resolve(m):k(R).then(function(Y){return m=Y,m})}function T(R){var Y=y[R.name],B={};B.promise=new h(function(oe,he){B.resolve=oe,B.reject=he}),Y.deferredOperations.push(B),Y.dbReady?Y.dbReady=Y.dbReady.then(function(){return B.promise}):Y.dbReady=B.promise}function _(R){var Y=y[R.name],B=Y.deferredOperations.pop();if(B)return B.resolve(),B.promise}function A(R,Y){var B=y[R.name],oe=B.deferredOperations.pop();if(oe)return oe.reject(Y),oe.promise}function P(R,Y){return new h(function(B,oe){if(y[R.name]=y[R.name]||V(),R.db)if(Y)T(R),R.db.close();else return B(R.db);var he=[R.name];Y&&he.push(R.version);var ne=l.open.apply(l,he);Y&&(ne.onupgradeneeded=function(Ce){var Te=ne.result;try{Te.createObjectStore(R.storeName),Ce.oldVersion<=1&&Te.createObjectStore(g)}catch(Oe){if(Oe.name==="ConstraintError")console.warn('The database "'+R.name+'" has been upgraded from version '+Ce.oldVersion+" to version "+Ce.newVersion+', but the storage "'+R.storeName+'" already exists.');else throw Oe}}),ne.onerror=function(Ce){Ce.preventDefault(),oe(ne.error)},ne.onsuccess=function(){var Ce=ne.result;Ce.onversionchange=function(Te){Te.target.close()},B(Ce),_(R)}})}function j(R){return P(R,!1)}function X(R){return P(R,!0)}function F(R,Y){if(!R.db)return!0;var B=!R.db.objectStoreNames.contains(R.storeName),oe=R.version<R.db.version,he=R.version>R.db.version;if(oe&&(R.version!==Y&&console.warn('The database "'+R.name+`" can't be downgraded from version `+R.db.version+" to version "+R.version+"."),R.version=R.db.version),he||B){if(B){var ne=R.db.version+1;ne>R.version&&(R.version=ne)}return!0}return!1}function M(R){return new h(function(Y,B){var oe=new FileReader;oe.onerror=B,oe.onloadend=function(he){var ne=btoa(he.target.result||"");Y({__local_forage_encoded_blob:!0,data:ne,type:R.type})},oe.readAsBinaryString(R)})}function W(R){var Y=C(atob(R.data));return c([Y],{type:R.type})}function D(R){return R&&R.__local_forage_encoded_blob}function z(R){var Y=this,B=Y._initReady().then(function(){var oe=y[Y._dbInfo.name];if(oe&&oe.dbReady)return oe.dbReady});return f(B,R,R),B}function K(R){T(R);for(var Y=y[R.name],B=Y.forages,oe=0;oe<B.length;oe++){var he=B[oe];he._dbInfo.db&&(he._dbInfo.db.close(),he._dbInfo.db=null)}return R.db=null,j(R).then(function(ne){return R.db=ne,F(R)?X(R):ne}).then(function(ne){R.db=Y.db=ne;for(var Ce=0;Ce<B.length;Ce++)B[Ce]._dbInfo.db=ne}).catch(function(ne){throw A(R,ne),ne})}function ie(R,Y,B,oe){oe===void 0&&(oe=1);try{var he=R.db.transaction(R.storeName,Y);B(null,he)}catch(ne){if(oe>0&&(!R.db||ne.name==="InvalidStateError"||ne.name==="NotFoundError"))return h.resolve().then(function(){if(!R.db||ne.name==="NotFoundError"&&!R.db.objectStoreNames.contains(R.storeName)&&R.version<=R.db.version)return R.db&&(R.version=R.db.version+1),X(R)}).then(function(){return K(R).then(function(){ie(R,Y,B,oe-1)})}).catch(B);B(ne)}}function V(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Z(R){var Y=this,B={db:null};if(R)for(var oe in R)B[oe]=R[oe];var he=y[B.name];he||(he=V(),y[B.name]=he),he.forages.push(Y),Y._initReady||(Y._initReady=Y.ready,Y.ready=z);var ne=[];function Ce(){return h.resolve()}for(var Te=0;Te<he.forages.length;Te++){var Oe=he.forages[Te];Oe!==Y&&ne.push(Oe._initReady().catch(Ce))}var Le=he.forages.slice(0);return h.all(ne).then(function(){return B.db=he.db,j(B)}).then(function(Me){return B.db=Me,F(B,Y._defaultConfig.version)?X(B):Me}).then(function(Me){B.db=he.db=Me,Y._dbInfo=B;for(var Ye=0;Ye<Le.length;Ye++){var yt=Le[Ye];yt!==Y&&(yt._dbInfo.db=B.db,yt._dbInfo.version=B.version)}})}function de(R,Y){var B=this;R=p(R);var oe=new h(function(he,ne){B.ready().then(function(){ie(B._dbInfo,x,function(Ce,Te){if(Ce)return ne(Ce);try{var Oe=Te.objectStore(B._dbInfo.storeName),Le=Oe.get(R);Le.onsuccess=function(){var Me=Le.result;Me===void 0&&(Me=null),D(Me)&&(Me=W(Me)),he(Me)},Le.onerror=function(){ne(Le.error)}}catch(Me){ne(Me)}})}).catch(ne)});return d(oe,Y),oe}function ge(R,Y){var B=this,oe=new h(function(he,ne){B.ready().then(function(){ie(B._dbInfo,x,function(Ce,Te){if(Ce)return ne(Ce);try{var Oe=Te.objectStore(B._dbInfo.storeName),Le=Oe.openCursor(),Me=1;Le.onsuccess=function(){var Ye=Le.result;if(Ye){var yt=Ye.value;D(yt)&&(yt=W(yt));var Ot=R(yt,Ye.key,Me++);Ot!==void 0?he(Ot):Ye.continue()}else he()},Le.onerror=function(){ne(Le.error)}}catch(Ye){ne(Ye)}})}).catch(ne)});return d(oe,Y),oe}function ye(R,Y,B){var oe=this;R=p(R);var he=new h(function(ne,Ce){var Te;oe.ready().then(function(){return Te=oe._dbInfo,w.call(Y)==="[object Blob]"?E(Te.db).then(function(Oe){return Oe?Y:M(Y)}):Y}).then(function(Oe){ie(oe._dbInfo,b,function(Le,Me){if(Le)return Ce(Le);try{var Ye=Me.objectStore(oe._dbInfo.storeName);Oe===null&&(Oe=void 0);var yt=Ye.put(Oe,R);Me.oncomplete=function(){Oe===void 0&&(Oe=null),ne(Oe)},Me.onabort=Me.onerror=function(){var Ot=yt.error?yt.error:yt.transaction.error;Ce(Ot)}}catch(Ot){Ce(Ot)}})}).catch(Ce)});return d(he,B),he}function G(R,Y){var B=this;R=p(R);var oe=new h(function(he,ne){B.ready().then(function(){ie(B._dbInfo,b,function(Ce,Te){if(Ce)return ne(Ce);try{var Oe=Te.objectStore(B._dbInfo.storeName),Le=Oe.delete(R);Te.oncomplete=function(){he()},Te.onerror=function(){ne(Le.error)},Te.onabort=function(){var Me=Le.error?Le.error:Le.transaction.error;ne(Me)}}catch(Me){ne(Me)}})}).catch(ne)});return d(oe,Y),oe}function J(R){var Y=this,B=new h(function(oe,he){Y.ready().then(function(){ie(Y._dbInfo,b,function(ne,Ce){if(ne)return he(ne);try{var Te=Ce.objectStore(Y._dbInfo.storeName),Oe=Te.clear();Ce.oncomplete=function(){oe()},Ce.onabort=Ce.onerror=function(){var Le=Oe.error?Oe.error:Oe.transaction.error;he(Le)}}catch(Le){he(Le)}})}).catch(he)});return d(B,R),B}function fe(R){var Y=this,B=new h(function(oe,he){Y.ready().then(function(){ie(Y._dbInfo,x,function(ne,Ce){if(ne)return he(ne);try{var Te=Ce.objectStore(Y._dbInfo.storeName),Oe=Te.count();Oe.onsuccess=function(){oe(Oe.result)},Oe.onerror=function(){he(Oe.error)}}catch(Le){he(Le)}})}).catch(he)});return d(B,R),B}function ve(R,Y){var B=this,oe=new h(function(he,ne){if(R<0){he(null);return}B.ready().then(function(){ie(B._dbInfo,x,function(Ce,Te){if(Ce)return ne(Ce);try{var Oe=Te.objectStore(B._dbInfo.storeName),Le=!1,Me=Oe.openKeyCursor();Me.onsuccess=function(){var Ye=Me.result;if(!Ye){he(null);return}R===0||Le?he(Ye.key):(Le=!0,Ye.advance(R))},Me.onerror=function(){ne(Me.error)}}catch(Ye){ne(Ye)}})}).catch(ne)});return d(oe,Y),oe}function be(R){var Y=this,B=new h(function(oe,he){Y.ready().then(function(){ie(Y._dbInfo,x,function(ne,Ce){if(ne)return he(ne);try{var Te=Ce.objectStore(Y._dbInfo.storeName),Oe=Te.openKeyCursor(),Le=[];Oe.onsuccess=function(){var Me=Oe.result;if(!Me){oe(Le);return}Le.push(Me.key),Me.continue()},Oe.onerror=function(){he(Oe.error)}}catch(Me){he(Me)}})}).catch(he)});return d(B,R),B}function $e(R,Y){Y=v.apply(this,arguments);var B=this.config();R=typeof R!="function"&&R||{},R.name||(R.name=R.name||B.name,R.storeName=R.storeName||B.storeName);var oe=this,he;if(!R.name)he=h.reject("Invalid arguments");else{var ne=R.name===B.name&&oe._dbInfo.db,Ce=ne?h.resolve(oe._dbInfo.db):j(R).then(function(Te){var Oe=y[R.name],Le=Oe.forages;Oe.db=Te;for(var Me=0;Me<Le.length;Me++)Le[Me]._dbInfo.db=Te;return Te});R.storeName?he=Ce.then(function(Te){if(Te.objectStoreNames.contains(R.storeName)){var Oe=Te.version+1;T(R);var Le=y[R.name],Me=Le.forages;Te.close();for(var Ye=0;Ye<Me.length;Ye++){var yt=Me[Ye];yt._dbInfo.db=null,yt._dbInfo.version=Oe}var Ot=new h(function(Mt,Mn){var In=l.open(R.name,Oe);In.onerror=function(Es){var Nc=In.result;Nc.close(),Mn(Es)},In.onupgradeneeded=function(){var Es=In.result;Es.deleteObjectStore(R.storeName)},In.onsuccess=function(){var Es=In.result;Es.close(),Mt(Es)}});return Ot.then(function(Mt){Le.db=Mt;for(var Mn=0;Mn<Me.length;Mn++){var In=Me[Mn];In._dbInfo.db=Mt,_(In._dbInfo)}}).catch(function(Mt){throw(A(R,Mt)||h.resolve()).catch(function(){}),Mt})}}):he=Ce.then(function(Te){T(R);var Oe=y[R.name],Le=Oe.forages;Te.close();for(var Me=0;Me<Le.length;Me++){var Ye=Le[Me];Ye._dbInfo.db=null}var yt=new h(function(Ot,Mt){var Mn=l.deleteDatabase(R.name);Mn.onerror=function(){var In=Mn.result;In&&In.close(),Mt(Mn.error)},Mn.onblocked=function(){console.warn('dropInstance blocked for database "'+R.name+'" until all open connections are closed')},Mn.onsuccess=function(){var In=Mn.result;In&&In.close(),Ot(In)}});return yt.then(function(Ot){Oe.db=Ot;for(var Mt=0;Mt<Le.length;Mt++){var Mn=Le[Mt];_(Mn._dbInfo)}}).catch(function(Ot){throw(A(R,Ot)||h.resolve()).catch(function(){}),Ot})})}return d(he,Y),he}var Pe={_driver:"asyncStorage",_initStorage:Z,_support:u(),iterate:ge,getItem:de,setItem:ye,removeItem:G,clear:J,length:fe,key:ve,keys:be,dropInstance:$e};function Ge(){return typeof openDatabase=="function"}var Xe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Je="~~local_forage_type~",Ze=/^~~local_forage_type~([^~]+)~/,it="__lfsc__:",cn=it.length,dt="arbf",Lt="blob",lt="si08",tt="ui08",Tt="uic8",Sn="si16",Pt="si32",Wt="ur16",kn="ui32",On="fl32",Fn="fl64",yr=cn+dt.length,er=Object.prototype.toString;function Gt(R){var Y=R.length*.75,B=R.length,oe,he=0,ne,Ce,Te,Oe;R[R.length-1]==="="&&(Y--,R[R.length-2]==="="&&Y--);var Le=new ArrayBuffer(Y),Me=new Uint8Array(Le);for(oe=0;oe<B;oe+=4)ne=Xe.indexOf(R[oe]),Ce=Xe.indexOf(R[oe+1]),Te=Xe.indexOf(R[oe+2]),Oe=Xe.indexOf(R[oe+3]),Me[he++]=ne<<2|Ce>>4,Me[he++]=(Ce&15)<<4|Te>>2,Me[he++]=(Te&3)<<6|Oe&63;return Le}function Ln(R){var Y=new Uint8Array(R),B="",oe;for(oe=0;oe<Y.length;oe+=3)B+=Xe[Y[oe]>>2],B+=Xe[(Y[oe]&3)<<4|Y[oe+1]>>4],B+=Xe[(Y[oe+1]&15)<<2|Y[oe+2]>>6],B+=Xe[Y[oe+2]&63];return Y.length%3===2?B=B.substring(0,B.length-1)+"=":Y.length%3===1&&(B=B.substring(0,B.length-2)+"=="),B}function ks(R,Y){var B="";if(R&&(B=er.call(R)),R&&(B==="[object ArrayBuffer]"||R.buffer&&er.call(R.buffer)==="[object ArrayBuffer]")){var oe,he=it;R instanceof ArrayBuffer?(oe=R,he+=dt):(oe=R.buffer,B==="[object Int8Array]"?he+=lt:B==="[object Uint8Array]"?he+=tt:B==="[object Uint8ClampedArray]"?he+=Tt:B==="[object Int16Array]"?he+=Sn:B==="[object Uint16Array]"?he+=Wt:B==="[object Int32Array]"?he+=Pt:B==="[object Uint32Array]"?he+=kn:B==="[object Float32Array]"?he+=On:B==="[object Float64Array]"?he+=Fn:Y(new Error("Failed to get type for BinaryArray"))),Y(he+Ln(oe))}else if(B==="[object Blob]"){var ne=new FileReader;ne.onload=function(){var Ce=Je+R.type+"~"+Ln(this.result);Y(it+Lt+Ce)},ne.readAsArrayBuffer(R)}else try{Y(JSON.stringify(R))}catch(Ce){console.error("Couldn't convert value into a JSON string: ",R),Y(null,Ce)}}function L(R){if(R.substring(0,cn)!==it)return JSON.parse(R);var Y=R.substring(yr),B=R.substring(cn,yr),oe;if(B===Lt&&Ze.test(Y)){var he=Y.match(Ze);oe=he[1],Y=Y.substring(he[0].length)}var ne=Gt(Y);switch(B){case dt:return ne;case Lt:return c([ne],{type:oe});case lt:return new Int8Array(ne);case tt:return new Uint8Array(ne);case Tt:return new Uint8ClampedArray(ne);case Sn:return new Int16Array(ne);case Wt:return new Uint16Array(ne);case Pt:return new Int32Array(ne);case kn:return new Uint32Array(ne);case On:return new Float32Array(ne);case Fn:return new Float64Array(ne);default:throw new Error("Unkown type: "+B)}}var Se={serialize:ks,deserialize:L,stringToBuffer:Gt,bufferToString:Ln};function _e(R,Y,B,oe){R.executeSql("CREATE TABLE IF NOT EXISTS "+Y.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],B,oe)}function We(R){var Y=this,B={db:null};if(R)for(var oe in R)B[oe]=typeof R[oe]!="string"?R[oe].toString():R[oe];var he=new h(function(ne,Ce){try{B.db=openDatabase(B.name,String(B.version),B.description,B.size)}catch(Te){return Ce(Te)}B.db.transaction(function(Te){_e(Te,B,function(){Y._dbInfo=B,ne()},function(Oe,Le){Ce(Le)})},Ce)});return B.serializer=Se,he}function $(R,Y,B,oe,he,ne){R.executeSql(B,oe,he,function(Ce,Te){Te.code===Te.SYNTAX_ERR?Ce.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[Y.storeName],function(Oe,Le){Le.rows.length?ne(Oe,Te):_e(Oe,Y,function(){Oe.executeSql(B,oe,he,ne)},ne)},ne):ne(Ce,Te)},ne)}function U(R,Y){var B=this;R=p(R);var oe=new h(function(he,ne){B.ready().then(function(){var Ce=B._dbInfo;Ce.db.transaction(function(Te){$(Te,Ce,"SELECT * FROM "+Ce.storeName+" WHERE key = ? LIMIT 1",[R],function(Oe,Le){var Me=Le.rows.length?Le.rows.item(0).value:null;Me&&(Me=Ce.serializer.deserialize(Me)),he(Me)},function(Oe,Le){ne(Le)})})}).catch(ne)});return d(oe,Y),oe}function I(R,Y){var B=this,oe=new h(function(he,ne){B.ready().then(function(){var Ce=B._dbInfo;Ce.db.transaction(function(Te){$(Te,Ce,"SELECT * FROM "+Ce.storeName,[],function(Oe,Le){for(var Me=Le.rows,Ye=Me.length,yt=0;yt<Ye;yt++){var Ot=Me.item(yt),Mt=Ot.value;if(Mt&&(Mt=Ce.serializer.deserialize(Mt)),Mt=R(Mt,Ot.key,yt+1),Mt!==void 0){he(Mt);return}}he()},function(Oe,Le){ne(Le)})})}).catch(ne)});return d(oe,Y),oe}function ce(R,Y,B,oe){var he=this;R=p(R);var ne=new h(function(Ce,Te){he.ready().then(function(){Y===void 0&&(Y=null);var Oe=Y,Le=he._dbInfo;Le.serializer.serialize(Y,function(Me,Ye){Ye?Te(Ye):Le.db.transaction(function(yt){$(yt,Le,"INSERT OR REPLACE INTO "+Le.storeName+" (key, value) VALUES (?, ?)",[R,Me],function(){Ce(Oe)},function(Ot,Mt){Te(Mt)})},function(yt){if(yt.code===yt.QUOTA_ERR){if(oe>0){Ce(ce.apply(he,[R,Oe,B,oe-1]));return}Te(yt)}})})}).catch(Te)});return d(ne,B),ne}function ke(R,Y,B){return ce.apply(this,[R,Y,B,1])}function S(R,Y){var B=this;R=p(R);var oe=new h(function(he,ne){B.ready().then(function(){var Ce=B._dbInfo;Ce.db.transaction(function(Te){$(Te,Ce,"DELETE FROM "+Ce.storeName+" WHERE key = ?",[R],function(){he()},function(Oe,Le){ne(Le)})})}).catch(ne)});return d(oe,Y),oe}function se(R){var Y=this,B=new h(function(oe,he){Y.ready().then(function(){var ne=Y._dbInfo;ne.db.transaction(function(Ce){$(Ce,ne,"DELETE FROM "+ne.storeName,[],function(){oe()},function(Te,Oe){he(Oe)})})}).catch(he)});return d(B,R),B}function re(R){var Y=this,B=new h(function(oe,he){Y.ready().then(function(){var ne=Y._dbInfo;ne.db.transaction(function(Ce){$(Ce,ne,"SELECT COUNT(key) as c FROM "+ne.storeName,[],function(Te,Oe){var Le=Oe.rows.item(0).c;oe(Le)},function(Te,Oe){he(Oe)})})}).catch(he)});return d(B,R),B}function N(R,Y){var B=this,oe=new h(function(he,ne){B.ready().then(function(){var Ce=B._dbInfo;Ce.db.transaction(function(Te){$(Te,Ce,"SELECT key FROM "+Ce.storeName+" WHERE id = ? LIMIT 1",[R+1],function(Oe,Le){var Me=Le.rows.length?Le.rows.item(0).key:null;he(Me)},function(Oe,Le){ne(Le)})})}).catch(ne)});return d(oe,Y),oe}function q(R){var Y=this,B=new h(function(oe,he){Y.ready().then(function(){var ne=Y._dbInfo;ne.db.transaction(function(Ce){$(Ce,ne,"SELECT key FROM "+ne.storeName,[],function(Te,Oe){for(var Le=[],Me=0;Me<Oe.rows.length;Me++)Le.push(Oe.rows.item(Me).key);oe(Le)},function(Te,Oe){he(Oe)})})}).catch(he)});return d(B,R),B}function ue(R){return new h(function(Y,B){R.transaction(function(oe){oe.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(he,ne){for(var Ce=[],Te=0;Te<ne.rows.length;Te++)Ce.push(ne.rows.item(Te).name);Y({db:R,storeNames:Ce})},function(he,ne){B(ne)})},function(oe){B(oe)})})}function Ne(R,Y){Y=v.apply(this,arguments);var B=this.config();R=typeof R!="function"&&R||{},R.name||(R.name=R.name||B.name,R.storeName=R.storeName||B.storeName);var oe=this,he;return R.name?he=new h(function(ne){var Ce;R.name===B.name?Ce=oe._dbInfo.db:Ce=openDatabase(R.name,"","",0),R.storeName?ne({db:Ce,storeNames:[R.storeName]}):ne(ue(Ce))}).then(function(ne){return new h(function(Ce,Te){ne.db.transaction(function(Oe){function Le(Ot){return new h(function(Mt,Mn){Oe.executeSql("DROP TABLE IF EXISTS "+Ot,[],function(){Mt()},function(In,Es){Mn(Es)})})}for(var Me=[],Ye=0,yt=ne.storeNames.length;Ye<yt;Ye++)Me.push(Le(ne.storeNames[Ye]));h.all(Me).then(function(){Ce()}).catch(function(Ot){Te(Ot)})},function(Oe){Te(Oe)})})}):he=h.reject("Invalid arguments"),d(he,Y),he}var Ie={_driver:"webSQLStorage",_initStorage:We,_support:Ge(),iterate:I,getItem:U,setItem:ke,removeItem:S,clear:se,length:re,key:N,keys:q,dropInstance:Ne};function Fe(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function ot(R,Y){var B=R.name+"/";return R.storeName!==Y.storeName&&(B+=R.storeName+"/"),B}function Hn(){var R="_localforage_support_test";try{return localStorage.setItem(R,!0),localStorage.removeItem(R),!1}catch{return!0}}function Rt(){return!Hn()||localStorage.length>0}function vt(R){var Y=this,B={};if(R)for(var oe in R)B[oe]=R[oe];return B.keyPrefix=ot(R,Y._defaultConfig),Rt()?(Y._dbInfo=B,B.serializer=Se,h.resolve()):h.reject()}function $t(R){var Y=this,B=Y.ready().then(function(){for(var oe=Y._dbInfo.keyPrefix,he=localStorage.length-1;he>=0;he--){var ne=localStorage.key(he);ne.indexOf(oe)===0&&localStorage.removeItem(ne)}});return d(B,R),B}function jt(R,Y){var B=this;R=p(R);var oe=B.ready().then(function(){var he=B._dbInfo,ne=localStorage.getItem(he.keyPrefix+R);return ne&&(ne=he.serializer.deserialize(ne)),ne});return d(oe,Y),oe}function En(R,Y){var B=this,oe=B.ready().then(function(){for(var he=B._dbInfo,ne=he.keyPrefix,Ce=ne.length,Te=localStorage.length,Oe=1,Le=0;Le<Te;Le++){var Me=localStorage.key(Le);if(Me.indexOf(ne)===0){var Ye=localStorage.getItem(Me);if(Ye&&(Ye=he.serializer.deserialize(Ye)),Ye=R(Ye,Me.substring(Ce),Oe++),Ye!==void 0)return Ye}}});return d(oe,Y),oe}function Si(R,Y){var B=this,oe=B.ready().then(function(){var he=B._dbInfo,ne;try{ne=localStorage.key(R)}catch{ne=null}return ne&&(ne=ne.substring(he.keyPrefix.length)),ne});return d(oe,Y),oe}function ki(R){var Y=this,B=Y.ready().then(function(){for(var oe=Y._dbInfo,he=localStorage.length,ne=[],Ce=0;Ce<he;Ce++){var Te=localStorage.key(Ce);Te.indexOf(oe.keyPrefix)===0&&ne.push(Te.substring(oe.keyPrefix.length))}return ne});return d(B,R),B}function Xt(R){var Y=this,B=Y.keys().then(function(oe){return oe.length});return d(B,R),B}function ct(R,Y){var B=this;R=p(R);var oe=B.ready().then(function(){var he=B._dbInfo;localStorage.removeItem(he.keyPrefix+R)});return d(oe,Y),oe}function Dt(R,Y,B){var oe=this;R=p(R);var he=oe.ready().then(function(){Y===void 0&&(Y=null);var ne=Y;return new h(function(Ce,Te){var Oe=oe._dbInfo;Oe.serializer.serialize(Y,function(Le,Me){if(Me)Te(Me);else try{localStorage.setItem(Oe.keyPrefix+R,Le),Ce(ne)}catch(Ye){(Ye.name==="QuotaExceededError"||Ye.name==="NS_ERROR_DOM_QUOTA_REACHED")&&Te(Ye),Te(Ye)}})})});return d(he,B),he}function Pn(R,Y){if(Y=v.apply(this,arguments),R=typeof R!="function"&&R||{},!R.name){var B=this.config();R.name=R.name||B.name,R.storeName=R.storeName||B.storeName}var oe=this,he;return R.name?he=new h(function(ne){R.storeName?ne(ot(R,oe._defaultConfig)):ne(R.name+"/")}).then(function(ne){for(var Ce=localStorage.length-1;Ce>=0;Ce--){var Te=localStorage.key(Ce);Te.indexOf(ne)===0&&localStorage.removeItem(Te)}}):he=h.reject("Invalid arguments"),d(he,Y),he}var kt={_driver:"localStorageWrapper",_initStorage:vt,_support:Fe(),iterate:En,getItem:jt,setItem:Dt,removeItem:ct,clear:$t,length:Xt,key:Si,keys:ki,dropInstance:Pn},Ei=function(Y,B){return Y===B||typeof Y=="number"&&typeof B=="number"&&isNaN(Y)&&isNaN(B)},qf=function(Y,B){for(var oe=Y.length,he=0;he<oe;){if(Ei(Y[he],B))return!0;he++}return!1},Kf=Array.isArray||function(R){return Object.prototype.toString.call(R)==="[object Array]"},_c={},jC={},Gl={INDEXEDDB:Pe,WEBSQL:Ie,LOCALSTORAGE:kt},rP=[Gl.INDEXEDDB._driver,Gl.WEBSQL._driver,Gl.LOCALSTORAGE._driver],Xf=["dropInstance"],_v=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Xf),sP={description:"",driver:rP.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function iP(R,Y){R[Y]=function(){var B=arguments;return R.ready().then(function(){return R[Y].apply(R,B)})}}function Nv(){for(var R=1;R<arguments.length;R++){var Y=arguments[R];if(Y)for(var B in Y)Y.hasOwnProperty(B)&&(Kf(Y[B])?arguments[0][B]=Y[B].slice():arguments[0][B]=Y[B])}return arguments[0]}var oP=function(){function R(Y){o(this,R);for(var B in Gl)if(Gl.hasOwnProperty(B)){var oe=Gl[B],he=oe._driver;this[B]=he,_c[he]||this.defineDriver(oe)}this._defaultConfig=Nv({},sP),this._config=Nv({},this._defaultConfig,Y),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return R.prototype.config=function(B){if((typeof B>"u"?"undefined":i(B))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var oe in B){if(oe==="storeName"&&(B[oe]=B[oe].replace(/\W/g,"_")),oe==="version"&&typeof B[oe]!="number")return new Error("Database version must be a number.");this._config[oe]=B[oe]}return"driver"in B&&B.driver?this.setDriver(this._config.driver):!0}else return typeof B=="string"?this._config[B]:this._config},R.prototype.defineDriver=function(B,oe,he){var ne=new h(function(Ce,Te){try{var Oe=B._driver,Le=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!B._driver){Te(Le);return}for(var Me=_v.concat("_initStorage"),Ye=0,yt=Me.length;Ye<yt;Ye++){var Ot=Me[Ye],Mt=!qf(Xf,Ot);if((Mt||B[Ot])&&typeof B[Ot]!="function"){Te(Le);return}}var Mn=function(){for(var Nc=function(uP){return function(){var cP=new Error("Method "+uP+" is not implemented by the current driver"),HC=h.reject(cP);return d(HC,arguments[arguments.length-1]),HC}},$v=0,lP=Xf.length;$v<lP;$v++){var Dv=Xf[$v];B[Dv]||(B[Dv]=Nc(Dv))}};Mn();var In=function(Nc){_c[Oe]&&console.info("Redefining LocalForage driver: "+Oe),_c[Oe]=B,jC[Oe]=Nc,Ce()};"_support"in B?B._support&&typeof B._support=="function"?B._support().then(In,Te):In(!!B._support):In(!0)}catch(Es){Te(Es)}});return f(ne,oe,he),ne},R.prototype.driver=function(){return this._driver||null},R.prototype.getDriver=function(B,oe,he){var ne=_c[B]?h.resolve(_c[B]):h.reject(new Error("Driver not found."));return f(ne,oe,he),ne},R.prototype.getSerializer=function(B){var oe=h.resolve(Se);return f(oe,B),oe},R.prototype.ready=function(B){var oe=this,he=oe._driverSet.then(function(){return oe._ready===null&&(oe._ready=oe._initDriver()),oe._ready});return f(he,B,B),he},R.prototype.setDriver=function(B,oe,he){var ne=this;Kf(B)||(B=[B]);var Ce=this._getSupportedDrivers(B);function Te(){ne._config.driver=ne.driver()}function Oe(Ye){return ne._extend(Ye),Te(),ne._ready=ne._initStorage(ne._config),ne._ready}function Le(Ye){return function(){var yt=0;function Ot(){for(;yt<Ye.length;){var Mt=Ye[yt];return yt++,ne._dbInfo=null,ne._ready=null,ne.getDriver(Mt).then(Oe).catch(Ot)}Te();var Mn=new Error("No available storage method found.");return ne._driverSet=h.reject(Mn),ne._driverSet}return Ot()}}var Me=this._driverSet!==null?this._driverSet.catch(function(){return h.resolve()}):h.resolve();return this._driverSet=Me.then(function(){var Ye=Ce[0];return ne._dbInfo=null,ne._ready=null,ne.getDriver(Ye).then(function(yt){ne._driver=yt._driver,Te(),ne._wrapLibraryMethodsWithReady(),ne._initDriver=Le(Ce)})}).catch(function(){Te();var Ye=new Error("No available storage method found.");return ne._driverSet=h.reject(Ye),ne._driverSet}),f(this._driverSet,oe,he),this._driverSet},R.prototype.supports=function(B){return!!jC[B]},R.prototype._extend=function(B){Nv(this,B)},R.prototype._getSupportedDrivers=function(B){for(var oe=[],he=0,ne=B.length;he<ne;he++){var Ce=B[he];this.supports(Ce)&&oe.push(Ce)}return oe},R.prototype._wrapLibraryMethodsWithReady=function(){for(var B=0,oe=_v.length;B<oe;B++)iP(this,_v[B])},R.prototype.createInstance=function(B){return new R(B)},R}(),aP=new oP;r.exports=aP},{3:3}]},{},[4])(4)})})(iD);var k8=iD.exports;Object.defineProperty(Yg,"__esModule",{value:!0});Yg.default=void 0;var no=je,E8=Ed(Tl),wy=Ed(lc),I8=Ed(Qi),T8=Ed(Zi),dE=Ed(k8);function Ed(n){return n&&n.__esModule?n:{default:n}}class oD{constructor(e,t,r){this.urlCache={},this.storage=void 0,this.name=e,this.requester=t||E8.default,this.resolver=r,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;typeof dE.default>"u"&&(e=dE.default),this.storage=e.createInstance({name:this.name})}catch{throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let t=navigator.onLine;this.online=t,t?this.emit("online",this):this.emit("offline",this)}add(e,t){let r=e.resources.map(s=>{let{href:i}=s,o=this.resolver(i),a=window.encodeURIComponent(o);return this.storage.getItem(a).then(l=>!l||t?this.requester(o,"binary").then(u=>this.storage.setItem(a,u)):l)});return Promise.all(r)}put(e,t,r){let s=window.encodeURIComponent(e);return this.storage.getItem(s).then(i=>i||this.requester(e,"binary",t,r).then(o=>this.storage.setItem(s,o)))}request(e,t,r,s){return this.online?this.requester(e,t,r,s).then(i=>(this.put(e),i)):this.retrieve(e,t)}retrieve(e,t){new no.defer;var r,s=new I8.default(e);return t||(t=s.extension),t=="blob"?r=this.getBlob(e):r=this.getText(e),r.then(i=>{var o=new no.defer,a;return i?(a=this.handleResponse(i,t),o.resolve(a)):o.reject({message:"File not found in storage: "+e,stack:new Error().stack}),o.promise})}handleResponse(e,t){var r;return t=="json"?r=JSON.parse(e):(0,no.isXml)(t)?r=(0,no.parse)(e,"text/xml"):t=="xhtml"?r=(0,no.parse)(e,"application/xhtml+xml"):t=="html"||t=="htm"?r=(0,no.parse)(e,"text/html"):r=e,r}getBlob(e,t){let r=window.encodeURIComponent(e);return this.storage.getItem(r).then(function(s){if(s)return t=t||wy.default.lookup(e),new Blob([s],{type:t})})}getText(e,t){let r=window.encodeURIComponent(e);return t=t||wy.default.lookup(e),this.storage.getItem(r).then(function(s){var i=new no.defer,o=new FileReader,a;if(s)return a=new Blob([s],{type:t}),o.addEventListener("loadend",()=>{i.resolve(o.result)}),o.readAsText(a,t),i.promise})}getBase64(e,t){let r=window.encodeURIComponent(e);return t=t||wy.default.lookup(e),this.storage.getItem(r).then(s=>{var i=new no.defer,o=new FileReader,a;if(s)return a=new Blob([s],{type:t}),o.addEventListener("loadend",()=>{i.resolve(o.result)}),o.readAsDataURL(a,t),i.promise})}createUrl(e,t){var r=new no.defer,s=window.URL||window.webkitURL||window.mozURL,i,o,a=t&&t.base64;return e in this.urlCache?(r.resolve(this.urlCache[e]),r.promise):(a?(o=this.getBase64(e),o&&o.then((function(l){this.urlCache[e]=l,r.resolve(l)}).bind(this))):(o=this.getBlob(e),o&&o.then((function(l){i=s.createObjectURL(l),this.urlCache[e]=i,r.resolve(i)}).bind(this))),o||r.reject({message:"File not found in storage: "+e,stack:new Error().stack}),r.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[e];r&&t.revokeObjectURL(r)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.urlCache={},this.removeListeners()}}(0,T8.default)(oD.prototype);var _8=oD;Yg.default=_8;var Zg={};Object.defineProperty(Zg,"__esModule",{value:!0});Zg.default=void 0;var fE=je;class N8{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const t=(0,fE.qs)(e,"display_options");return t?((0,fE.qsa)(t,"option").forEach(s=>{let i="";switch(s.childNodes.length&&(i=s.childNodes[0].nodeValue),s.attributes.name.value){case"interactive":this.interactive=i;break;case"fixed-layout":this.fixedLayout=i;break;case"open-to-spread":this.openToSpread=i;break;case"orientation-lock":this.orientationLock=i;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}var $8=N8;Zg.default=$8;Object.defineProperty(fd,"__esModule",{value:!0});fd.default=void 0;var D8=$r(Zi),Js=je,Oo=$r(Il),pE=$r(Qi),A8=$r($g),R8=$r(Ag),O8=$r(Rg),mE=$r(Og),by=$r(Fg),F8=$r(Lg),Cy=$r(Mg),L8=$r(uc),P8=$r(Kg),gE=$r(Tl),M8=$r(Wr),B8=$r(Yg),Sy=$r(Zg),vE=sr;function $r(n){return n&&n.__esModule?n:{default:n}}const yE="META-INF/container.xml",z8="META-INF/com.apple.ibooks.display-options.xml",ei={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class aD{constructor(e,t){typeof t>"u"&&typeof e!="string"&&!(e instanceof Blob)&&!(e instanceof ArrayBuffer)&&(t=e,e=void 0),this.settings=(0,Js.extend)(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),(0,Js.extend)(this.settings,t),this.opening=new Js.defer,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new Js.defer,spine:new Js.defer,metadata:new Js.defer,cover:new Js.defer,navigation:new Js.defer,pageList:new Js.defer,resources:new Js.defer,displayOptions:new Js.defer},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||gE.default,this.spine=new A8.default,this.locations=new R8.default(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(r=>{var s=new Error("Cannot load book at "+e);this.emit(vE.EVENTS.BOOK.OPEN_FAILED,s)})}open(e,t){var r,s=t||this.determineType(e);return s===ei.BINARY?(this.archived=!0,this.url=new Oo.default("/",""),r=this.openEpub(e)):s===ei.BASE64?(this.archived=!0,this.url=new Oo.default("/",""),r=this.openEpub(e,s)):s===ei.EPUB?(this.archived=!0,this.url=new Oo.default("/",""),r=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):s==ei.OPF?(this.url=new Oo.default(e),r=this.openPackaging(this.url.Path.toString())):s==ei.MANIFEST?(this.url=new Oo.default(e),r=this.openManifest(this.url.Path.toString())):(this.url=new Oo.default(e),r=this.openContainer(yE).then(this.openPackaging.bind(this))),r}openEpub(e,t){return this.unarchive(e,t||this.settings.encoding).then(()=>this.openContainer(yE)).then(r=>this.openPackaging(r))}openContainer(e){return this.load(e).then(t=>(this.container=new O8.default(t),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new pE.default(e),this.load(e).then(t=>(this.packaging=new mE.default(t),this.unpack(this.packaging)))}openManifest(e){return this.path=new pE.default(e),this.load(e).then(t=>(this.packaging=new mE.default,this.packaging.load(t),this.unpack(this.packaging)))}load(e){var t=this.resolve(e);return this.archived?this.archive.request(t):this.request(t,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,t){if(e){var r=e,s=e.indexOf("://")>-1;return s?e:(this.path&&(r=this.path.resolve(e)),t!=!1&&this.url&&(r=this.url.resolve(r)),r)}}canonical(e){var t=e;return e?(this.settings.canonical?t=this.settings.canonical(e):t=this.resolve(e,!0),t):""}determineType(e){var t,r,s;if(this.settings.encoding==="base64")return ei.BASE64;if(typeof e!="string")return ei.BINARY;if(t=new Oo.default(e),r=t.path(),s=r.extension,s&&(s=s.replace(/\?.*$/,"")),!s)return ei.DIRECTORY;if(s==="epub")return ei.EPUB;if(s==="opf")return ei.OPF;if(s==="json")return ei.MANIFEST}unpack(e){this.package=e,this.packaging.metadata.layout===""?this.load(this.url.resolve(z8)).then(t=>{this.displayOptions=new Sy.default(t),this.loading.displayOptions.resolve(this.displayOptions)}).catch(t=>{this.displayOptions=new Sy.default,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new Sy.default,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new F8.default(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(t=>{console.error(t)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let t=e.navPath||e.ncxPath,r=e.toc;return r?new Promise((s,i)=>{this.navigation=new by.default(r),e.pageList&&(this.pageList=new Cy.default(e.pageList)),s(this.navigation)}):t?this.load(t,"xml").then(s=>(this.navigation=new by.default(s),this.pageList=new Cy.default(s),this.navigation)):new Promise((s,i)=>{this.navigation=new by.default,this.pageList=new Cy.default,s(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,t){return this.rendition=new L8.default(this,t),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,t){return this.archive=new P8.default,this.archive.open(e,t)}store(e){let t=this.settings.replacements&&this.settings.replacements!=="none",r=this.url,s=this.settings.requestMethod||gE.default.bind(this);return this.storage=new B8.default(e,s,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let i=(o,a)=>{a.output=this.resources.substitute(o,a.url)};this.resources.settings.replacements=t||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new Oo.default("/",""),this.spine.hooks.serialize.register(i)}),this.storage.on("online",()=>{this.url=r,this.spine.hooks.serialize.deregister(i)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,t)=>{t.output=this.resources.substitute(e,t.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var t=new M8.default(e),r=this.spine.get(t.spinePos),s=this.load.bind(this);return r?r.load(s).then(function(i){var o=t.toRange(r.document);return o}):new Promise((i,o)=>{o("CFI could not be found")})}key(e){var t=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${vE.EPUBJS_VERSION}:${t}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}(0,D8.default)(aD.prototype);var U8=aD;fd.default=U8;var Qg={};Object.defineProperty(Qg,"__esModule",{value:!0});Qg.default=void 0;var lD=Nl(fd),V8=Nl(uc),W8=Nl(Wr),G8=Nl(_l),j8=H8(je),uD=sr;Nl(Cd);Nl(cc);Nl(kd);function cD(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(cD=function(r){return r?t:e})(n)}function H8(n,e){if(!e&&n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=cD(e);if(t&&t.has(n))return t.get(n);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in n)if(i!=="default"&&Object.prototype.hasOwnProperty.call(n,i)){var o=s?Object.getOwnPropertyDescriptor(n,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=n[i]}return r.default=n,t&&t.set(n,r),r}function Nl(n){return n&&n.__esModule?n:{default:n}}function $l(n,e){return new lD.default(n,e)}$l.VERSION=uD.EPUBJS_VERSION;typeof gn<"u"&&(gn.EPUBJS_VERSION=uD.EPUBJS_VERSION);$l.Book=lD.default;$l.Rendition=V8.default;$l.Contents=G8.default;$l.CFI=W8.default;$l.utils=j8;var q8=$l;Qg.default=q8;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Book",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"Contents",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"EpubCFI",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"Layout",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"Rendition",{enumerable:!0,get:function(){return r.default}}),n.default=void 0;var e=a(fd),t=a(Wr),r=a(uc),s=a(_l),i=a(wd),o=a(Qg);function a(u){return u&&u.__esModule?u:{default:u}}var l=o.default;n.default=l})(KN);var Id={};Object.defineProperty(Id,"__esModule",{value:!0});Id.EpubViewStyle=void 0;var K8={viewHolder:{position:"relative",height:"100%",width:"100%"},view:{height:"100%"}};Id.EpubViewStyle=K8;Object.defineProperty(Ig,"__esModule",{value:!0});Ig.default=void 0;var xp=Z8(Re),Ar=hD(qN),X8=hD(KN),Y8=Id;function hD(n){return n&&n.__esModule?n:{default:n}}function dD(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(dD=function(s){return s?t:e})(n)}function Z8(n,e){if(!e&&n&&n.__esModule)return n;if(n===null||ul(n)!=="object"&&typeof n!="function")return{default:n};var t=dD(e);if(t&&t.has(n))return t.get(n);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in n)if(i!=="default"&&Object.prototype.hasOwnProperty.call(n,i)){var o=s?Object.getOwnPropertyDescriptor(n,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=n[i]}return r.default=n,t&&t.set(n,r),r}function ul(n){"@babel/helpers - typeof";return ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ul(n)}function xE(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function Q8(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xE(Object(t),!0).forEach(function(r){Hx(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):xE(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function J8(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function wE(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,fD(r.key),r)}}function e5(n,e,t){return e&&wE(n.prototype,e),t&&wE(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function t5(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&Gx(n,e)}function Gx(n,e){return Gx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},Gx(n,e)}function n5(n){var e=s5();return function(){var r=_m(n),s;if(e){var i=_m(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return r5(this,s)}}function r5(n,e){if(e&&(ul(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jx(n)}function jx(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function s5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _m(n){return _m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_m(n)}function Hx(n,e,t){return e=fD(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function fD(n){var e=i5(n,"string");return ul(e)==="symbol"?e:String(e)}function i5(n,e){if(ul(n)!=="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(ul(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}var Qw=function(n){t5(t,n);var e=n5(t);function t(r){var s;return J8(this,t),s=e.call(this,r),Hx(jx(s),"onLocationChange",function(i){var o=s.props,a=o.location,l=o.locationChanged,u=i&&i.start;a!==u&&(s.location=u,l&&l(u))}),Hx(jx(s),"handleKeyPress",function(i){var o=i.key;o&&o==="ArrowRight"&&s.nextPage(),o&&o==="ArrowLeft"&&s.prevPage()}),s.state={isLoaded:!1,toc:[]},s.viewerRef=xp.default.createRef(),s.location=r.location,s.book=s.rendition=s.prevPage=s.nextPage=null,s}return e5(t,[{key:"componentDidMount",value:function(){this.initBook(!0),document.addEventListener("keyup",this.handleKeyPress,!1)}},{key:"initBook",value:function(){var s=this,i=this.props,o=i.url,a=i.tocChanged,l=i.epubInitOptions;this.book&&this.book.destroy(),this.book=new X8.default(o,l),this.book.loaded.navigation.then(function(u){var c=u.toc;s.setState({isLoaded:!0,toc:c},function(){a&&a(c),s.initReader()})})}},{key:"componentWillUnmount",value:function(){this.book&&this.book.destroy(),this.book=this.rendition=this.prevPage=this.nextPage=null,document.removeEventListener("keyup",this.handleKeyPress,!1)}},{key:"shouldComponentUpdate",value:function(s){return!this.state.isLoaded||s.location!==this.props.location||s.location!==this.props.location}},{key:"componentDidUpdate",value:function(s){s.location!==this.props.location&&this.location!==this.props.location&&this.rendition.display(this.props.location),s.url!==this.props.url&&this.initBook()}},{key:"initReader",value:function(){var s=this,i=this.state.toc,o=this.props,a=o.location,l=o.epubOptions,u=o.getRendition,c=this.viewerRef.current;this.rendition=this.book.renderTo(c,Q8({contained:!0,width:"100%",height:"100%"},l)),this.prevPage=function(){s.rendition.prev()},this.nextPage=function(){s.rendition.next()},this.registerEvents(),u&&u(this.rendition),typeof a=="string"||typeof a=="number"?this.rendition.display(a):i.length>0&&i[0].href?this.rendition.display(i[0].href):this.rendition.display()}},{key:"registerEvents",value:function(){var s=this.props,i=s.handleKeyPress,o=s.handleTextSelected;this.rendition.on("locationChanged",this.onLocationChange),this.rendition.on("keyup",i||this.handleKeyPress),o&&this.rendition.on("selected",o)}},{key:"renderBook",value:function(){var s=this.props.epubViewStyles;return xp.default.createElement("div",{ref:this.viewerRef,style:s.view})}},{key:"render",value:function(){var s=this.state.isLoaded,i=this.props,o=i.loadingView,a=i.epubViewStyles;return xp.default.createElement("div",{style:a.viewHolder},s&&this.renderBook()||o)}}]),t}(xp.Component);Qw.defaultProps={loadingView:null,locationChanged:null,tocChanged:null,epubViewStyles:Y8.EpubViewStyle,epubOptions:{},epubInitOptions:{}};Qw.propTypes={url:Ar.default.oneOfType([Ar.default.string,Ar.default.instanceOf(ArrayBuffer)]),loadingView:Ar.default.element,location:Ar.default.oneOfType([Ar.default.string,Ar.default.number]),locationChanged:Ar.default.func,tocChanged:Ar.default.func,epubViewStyles:Ar.default.object,epubInitOptions:Ar.default.object,epubOptions:Ar.default.object,getRendition:Ar.default.func,handleKeyPress:Ar.default.func,handleTextSelected:Ar.default.func};var o5=Qw;Ig.default=o5;var Xc={};const pD="Left",mD="Right",gD="Up",vD="Down",bu={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},qx={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},bE="mousemove",CE="mouseup",a5="touchend",l5="touchmove",u5="touchstart";function c5(n,e,t,r){return n>e?t>0?mD:pD:r>0?vD:gD}function SE(n,e){if(e===0)return n;const t=Math.PI/180*e,r=n[0]*Math.cos(t)+n[1]*Math.sin(t),s=n[1]*Math.cos(t)-n[0]*Math.sin(t);return[r,s]}function h5(n,e){const t=c=>{const h="touches"in c;h&&c.touches.length>1||n((d,f)=>{f.trackMouse&&!h&&(document.addEventListener(bE,r),document.addEventListener(CE,o));const{clientX:p,clientY:v}=h?c.touches[0]:c,g=SE([p,v],f.rotationAngle);return f.onTouchStartOrOnMouseDown&&f.onTouchStartOrOnMouseDown({event:c}),Object.assign(Object.assign(Object.assign({},d),qx),{initial:g.slice(),xy:g,start:c.timeStamp||0})})},r=c=>{n((h,d)=>{const f="touches"in c;if(f&&c.touches.length>1)return h;if(c.timeStamp-h.start>d.swipeDuration)return h.swiping?Object.assign(Object.assign({},h),{swiping:!1}):h;const{clientX:p,clientY:v}=f?c.touches[0]:c,[g,m]=SE([p,v],d.rotationAngle),y=g-h.xy[0],w=m-h.xy[1],x=Math.abs(y),b=Math.abs(w),C=(c.timeStamp||0)-h.start,k=Math.sqrt(x*x+b*b)/(C||1),E=[y/(C||1),w/(C||1)],T=c5(x,b,y,w),_=typeof d.delta=="number"?d.delta:d.delta[T.toLowerCase()]||bu.delta;if(x<_&&b<_&&!h.swiping)return h;const A={absX:x,absY:b,deltaX:y,deltaY:w,dir:T,event:c,first:h.first,initial:h.initial,velocity:k,vxvy:E};A.first&&d.onSwipeStart&&d.onSwipeStart(A),d.onSwiping&&d.onSwiping(A);let P=!1;return(d.onSwiping||d.onSwiped||d[`onSwiped${T}`])&&(P=!0),P&&d.preventScrollOnSwipe&&d.trackTouch&&c.cancelable&&c.preventDefault(),Object.assign(Object.assign({},h),{first:!1,eventData:A,swiping:!0})})},s=c=>{n((h,d)=>{let f;if(h.swiping&&h.eventData){if(c.timeStamp-h.start<d.swipeDuration){f=Object.assign(Object.assign({},h.eventData),{event:c}),d.onSwiped&&d.onSwiped(f);const p=d[`onSwiped${f.dir}`];p&&p(f)}}else d.onTap&&d.onTap({event:c});return d.onTouchEndOrOnMouseUp&&d.onTouchEndOrOnMouseUp({event:c}),Object.assign(Object.assign(Object.assign({},h),qx),{eventData:f})})},i=()=>{document.removeEventListener(bE,r),document.removeEventListener(CE,o)},o=c=>{i(),s(c)},a=(c,h)=>{let d=()=>{};if(c&&c.addEventListener){const f=Object.assign(Object.assign({},bu.touchEventOptions),h.touchEventOptions),p=[[u5,t,f],[l5,r,Object.assign(Object.assign({},f),h.preventScrollOnSwipe?{passive:!1}:{})],[a5,s,f]];p.forEach(([v,g,m])=>c.addEventListener(v,g,m)),d=()=>p.forEach(([v,g])=>c.removeEventListener(v,g))}return d},u={ref:c=>{c!==null&&n((h,d)=>{if(h.el===c)return h;const f={};return h.el&&h.el!==c&&h.cleanUpTouch&&(h.cleanUpTouch(),f.cleanUpTouch=void 0),d.trackTouch&&c&&(f.cleanUpTouch=a(c,d)),Object.assign(Object.assign(Object.assign({},h),{el:c}),f)})}};return e.trackMouse&&(u.onMouseDown=t),[u,a]}function d5(n,e,t,r){return!e.trackTouch||!n.el?(n.cleanUpTouch&&n.cleanUpTouch(),Object.assign(Object.assign({},n),{cleanUpTouch:void 0})):n.cleanUpTouch?e.preventScrollOnSwipe!==t.preventScrollOnSwipe||e.touchEventOptions.passive!==t.touchEventOptions.passive?(n.cleanUpTouch(),Object.assign(Object.assign({},n),{cleanUpTouch:r(n.el,e)})):n:Object.assign(Object.assign({},n),{cleanUpTouch:r(n.el,e)})}function f5(n){const{trackMouse:e}=n,t=Re.useRef(Object.assign({},qx)),r=Re.useRef(Object.assign({},bu)),s=Re.useRef(Object.assign({},r.current));s.current=Object.assign({},r.current),r.current=Object.assign(Object.assign({},bu),n);let i;for(i in bu)r.current[i]===void 0&&(r.current[i]=bu[i]);const[o,a]=Re.useMemo(()=>h5(l=>t.current=l(t.current,r.current),{trackMouse:e}),[e]);return t.current=d5(t.current,r.current,s.current,a),o}const p5=Object.freeze(Object.defineProperty({__proto__:null,DOWN:vD,LEFT:pD,RIGHT:mD,UP:gD,useSwipeable:f5},Symbol.toStringTag,{value:"Module"})),m5=hT(p5);var Td={};Object.defineProperty(Td,"__esModule",{value:!0});Td.ReactReaderStyle=void 0;var g5={container:{overflow:"hidden",position:"relative",height:"100%"},readerArea:{position:"relative",zIndex:1,height:"100%",width:"100%",backgroundColor:"#fff",transition:"all .3s ease"},containerExpanded:{transform:"translateX(256px)"},titleArea:{position:"absolute",top:20,left:50,right:50,textAlign:"center",color:"#999"},reader:{position:"absolute",top:50,left:50,bottom:20,right:50},swipeWrapper:{position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:200},prev:{left:1},next:{right:1},arrow:{outline:"none",border:"none",background:"none",position:"absolute",top:"50%",marginTop:-32,fontSize:64,padding:"0 10px",color:"#E2E2E2",fontFamily:"arial, sans-serif",cursor:"pointer",userSelect:"none",appearance:"none",fontWeight:"normal"},arrowHover:{color:"#777"},tocBackground:{position:"absolute",left:256,top:0,bottom:0,right:0,zIndex:1},tocArea:{position:"absolute",left:0,top:0,bottom:0,zIndex:0,width:256,overflowY:"auto",WebkitOverflowScrolling:"touch",background:"#f2f2f2",padding:"10px 0"},tocAreaButton:{userSelect:"none",appearance:"none",background:"none",border:"none",display:"block",fontFamily:"sans-serif",width:"100%",fontSize:".9em",textAlign:"left",padding:".9em 1em",borderBottom:"1px solid #ddd",color:"#aaa",boxSizing:"border-box",outline:"none",cursor:"pointer"},tocButton:{background:"none",border:"none",width:32,height:32,position:"absolute",top:10,left:10,borderRadius:2,outline:"none",cursor:"pointer"},tocButtonExpanded:{background:"#f2f2f2"},tocButtonBar:{position:"absolute",width:"60%",background:"#ccc",height:2,left:"50%",margin:"-1px -30%",top:"50%",transition:"all .5s ease"},tocButtonBarTop:{top:"35%"},tocButtonBottom:{top:"66%"},loadingView:{position:"absolute",top:"50%",left:"10%",right:"10%",color:"#ccc",textAlign:"center",margintop:"-.5em"}};Td.ReactReaderStyle=g5;var kE;function v5(){if(kE)return Xc;kE=1;function n(F){"@babel/helpers - typeof";return n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},n(F)}Object.defineProperty(Xc,"__esModule",{value:!0}),Xc.default=void 0;var e=c(Re),t=l(qN),r=m5,s=yD(),i=Td,o=["children"],a=["title","showToc","loadingView","readerStyles","locationChanged","swipeable","epubViewStyles"];function l(F){return F&&F.__esModule?F:{default:F}}function u(F){if(typeof WeakMap!="function")return null;var M=new WeakMap,W=new WeakMap;return(u=function(z){return z?W:M})(F)}function c(F,M){if(!M&&F&&F.__esModule)return F;if(F===null||n(F)!=="object"&&typeof F!="function")return{default:F};var W=u(M);if(W&&W.has(F))return W.get(F);var D={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var K in F)if(K!=="default"&&Object.prototype.hasOwnProperty.call(F,K)){var ie=z?Object.getOwnPropertyDescriptor(F,K):null;ie&&(ie.get||ie.set)?Object.defineProperty(D,K,ie):D[K]=F[K]}return D.default=F,W&&W.set(F,D),D}function h(){return h=Object.assign?Object.assign.bind():function(F){for(var M=1;M<arguments.length;M++){var W=arguments[M];for(var D in W)Object.prototype.hasOwnProperty.call(W,D)&&(F[D]=W[D])}return F},h.apply(this,arguments)}function d(F,M){if(!(F instanceof M))throw new TypeError("Cannot call a class as a function")}function f(F,M){for(var W=0;W<M.length;W++){var D=M[W];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(F,k(D.key),D)}}function p(F,M,W){return M&&f(F.prototype,M),W&&f(F,W),Object.defineProperty(F,"prototype",{writable:!1}),F}function v(F,M){if(typeof M!="function"&&M!==null)throw new TypeError("Super expression must either be null or a function");F.prototype=Object.create(M&&M.prototype,{constructor:{value:F,writable:!0,configurable:!0}}),Object.defineProperty(F,"prototype",{writable:!1}),M&&g(F,M)}function g(F,M){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,z){return D.__proto__=z,D},g(F,M)}function m(F){var M=x();return function(){var D=b(F),z;if(M){var K=b(this).constructor;z=Reflect.construct(D,arguments,K)}else z=D.apply(this,arguments);return y(this,z)}}function y(F,M){if(M&&(n(M)==="object"||typeof M=="function"))return M;if(M!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w(F)}function w(F){if(F===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F}function x(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(F){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(W){return W.__proto__||Object.getPrototypeOf(W)},b(F)}function C(F,M,W){return M=k(M),M in F?Object.defineProperty(F,M,{value:W,enumerable:!0,configurable:!0,writable:!0}):F[M]=W,F}function k(F){var M=E(F,"string");return n(M)==="symbol"?M:String(M)}function E(F,M){if(n(F)!=="object"||F===null)return F;var W=F[Symbol.toPrimitive];if(W!==void 0){var D=W.call(F,M||"default");if(n(D)!=="object")return D;throw new TypeError("@@toPrimitive must return a primitive value.")}return(M==="string"?String:Number)(F)}function T(F,M){if(F==null)return{};var W=_(F,M),D,z;if(Object.getOwnPropertySymbols){var K=Object.getOwnPropertySymbols(F);for(z=0;z<K.length;z++)D=K[z],!(M.indexOf(D)>=0)&&Object.prototype.propertyIsEnumerable.call(F,D)&&(W[D]=F[D])}return W}function _(F,M){if(F==null)return{};var W={},D=Object.keys(F),z,K;for(K=0;K<D.length;K++)z=D[K],!(M.indexOf(z)>=0)&&(W[z]=F[z]);return W}var A=function(M){var W=M.children,D=T(M,o),z=(0,r.useSwipeable)(D);return e.default.createElement("div",z,W)},P=function(F){v(W,F);var M=m(W);function W(){var D;d(this,W);for(var z=arguments.length,K=new Array(z),ie=0;ie<z;ie++)K[ie]=arguments[ie];return D=M.call.apply(M,[this].concat(K)),C(w(D),"setLocation",function(){D.props.setLocation(D.props.href)}),D}return p(W,[{key:"render",value:function(){var z=this,K=this.props,ie=K.label,V=K.styles,Z=K.subitems;return e.default.createElement("div",null,e.default.createElement("button",{onClick:this.setLocation,style:V},ie),Z&&Z.length>0&&e.default.createElement("div",{style:{paddingLeft:10}},Z.map(function(de,ge){return e.default.createElement(W,h({key:ge},z.props,de))})))}}]),W}(e.PureComponent);P.propTypes={label:t.default.string,href:t.default.string,setLocation:t.default.func,styles:t.default.object};var j=function(F){v(W,F);var M=m(W);function W(D){var z;return d(this,W),z=M.call(this,D),C(w(z),"toggleToc",function(){z.setState({expandedToc:!z.state.expandedToc})}),C(w(z),"next",function(){var K=z.readerRef.current;K.nextPage()}),C(w(z),"prev",function(){var K=z.readerRef.current;K.prevPage()}),C(w(z),"onTocChange",function(K){var ie=z.props.tocChanged;z.setState({toc:K},function(){return ie&&ie(K)})}),C(w(z),"setLocation",function(K){var ie=z.props.locationChanged;z.setState({expandedToc:!1},function(){return ie&&ie(K)})}),z.readerRef=e.default.createRef(),z.state={expandedToc:!1,toc:!1},z}return p(W,[{key:"renderToc",value:function(){var z=this,K=this.state,ie=K.toc,V=K.expandedToc,Z=this.props.readerStyles;return e.default.createElement("div",null,e.default.createElement("div",{style:Z.tocArea},e.default.createElement("div",{style:Z.toc},ie.map(function(de,ge){return e.default.createElement(P,h({},de,{key:ge,setLocation:z.setLocation,styles:Z.tocAreaButton}))}))),V&&e.default.createElement("div",{style:Z.tocBackground,onClick:this.toggleToc}))}},{key:"renderTocToggle",value:function(){var z=this.state.expandedToc,K=this.props.readerStyles;return e.default.createElement("button",{style:Object.assign({},K.tocButton,z?K.tocButtonExpanded:{}),onClick:this.toggleToc},e.default.createElement("span",{style:Object.assign({},K.tocButtonBar,K.tocButtonBarTop)}),e.default.createElement("span",{style:Object.assign({},K.tocButtonBar,K.tocButtonBottom)}))}},{key:"render",value:function(){var z=this.props,K=z.title,ie=z.showToc,V=z.loadingView,Z=z.readerStyles,de=z.locationChanged,ge=z.swipeable,ye=z.epubViewStyles,G=T(z,a),J=this.state,fe=J.toc,ve=J.expandedToc;return e.default.createElement("div",{style:Z.container},e.default.createElement("div",{style:Object.assign({},Z.readerArea,ve?Z.containerExpanded:{})},ie&&this.renderTocToggle(),e.default.createElement("div",{style:Z.titleArea},K),e.default.createElement(A,{onSwipedRight:this.prev,onSwipedLeft:this.next,trackMouse:!0},e.default.createElement("div",{style:Z.reader},e.default.createElement(s.EpubView,h({ref:this.readerRef,loadingView:V,epubViewStyles:ye},G,{tocChanged:this.onTocChange,locationChanged:de})),ge&&e.default.createElement("div",{style:Z.swipeWrapper}))),e.default.createElement("button",{style:Object.assign({},Z.arrow,Z.prev),onClick:this.prev},"‹"),e.default.createElement("button",{style:Object.assign({},Z.arrow,Z.next),onClick:this.next},"›")),ie&&fe&&this.renderToc())}}]),W}(e.PureComponent);j.defaultProps={loadingView:e.default.createElement("div",{style:i.ReactReaderStyle.loadingView},"Loading…"),locationChanged:null,tocChanged:null,showToc:!0,readerStyles:i.ReactReaderStyle},j.propTypes={title:t.default.string,loadingView:t.default.element,showToc:t.default.bool,locationChanged:t.default.func,tocChanged:t.default.func,readerStyles:t.default.object,epubViewStyles:t.default.object,swipeable:t.default.bool};var X=j;return Xc.default=X,Xc}var EE;function yD(){return EE||(EE=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"EpubView",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"EpubViewStyle",{enumerable:!0,get:function(){return t.EpubViewStyle}}),Object.defineProperty(n,"ReactReader",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"ReactReaderStyle",{enumerable:!0,get:function(){return s.ReactReaderStyle}});var e=i(Ig),t=Id,r=i(v5()),s=Td;function i(o){return o&&o.__esModule?o:{default:o}}}(ly)),ly}var Fo=yD();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y5=1e-7,x5=1e-4;class xD{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Jw{refCount(e){return Hr("refCount")}incRef(e){return Hr("incRef")}timerAvailable(){return!0}time(e){return Hr("time")}read(e){return Hr("read")}readSync(e){return Hr("readSync")}readToGPU(e,t){return Hr("readToGPU")}numDataIds(){return Hr("numDataIds")}disposeData(e,t){return Hr("disposeData")}write(e,t,r){return Hr("write")}move(e,t,r,s,i){return Hr("move")}createTensorFromGPUData(e,t,r){return Hr("createTensorFromGPUData")}memory(){return Hr("memory")}floatPrecision(){return Hr("floatPrecision")}epsilon(){return this.floatPrecision()===32?y5:x5}dispose(){return Hr("dispose")}}function Hr(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w5(n){let e=n.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,su(n,e,t)}function cl(n,e,t){return Math.max(n,Math.min(e,t))}function eb(n){return n%2===0?n:n+1}function su(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function b5(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function O(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function tb(n,e,t=""){O(Nt(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function wD(n){O(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function we(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function Nt(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function ju(n){return n%1===0}function Kx(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function $u(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function IE(n,e=s=>0,t,r){return new Promise((s,i)=>{let o=0;const a=()=>{if(n()){s();return}o++;const l=e(o);if(t!=null&&o>=t){i();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function bD(n,e){let t=1,r=-1;for(let i=0;i<n.length;++i)if(n[i]>=0)t*=n[i];else if(n[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(n[i]<0)throw Error(`Shapes can not be < 0. Found ${n[i]} at dim ${i}`);if(r===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const s=n.slice();return s[r]=e/t,s}function mt(n,e){const t=e.length;return n=n==null?e.map((r,s)=>s):[].concat(n),O(n.every(r=>r>=-t&&r<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),O(n.every(r=>ju(r)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(r=>r<0?t+r:r)}function ba(n,e){const t=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||s?null:mt(e,n).sort();let o=0;for(let a=0;a<n.length;++a){if(i!=null){if(i[o]===a&&n[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${n[a]}' is not 1`);(i[o]==null||i[o]>a)&&n[a]===1&&(t.push(n[a]),r.push(a)),i[o]<=a&&o++}n[a]!==1&&(t.push(n[a]),r.push(a))}return{newShape:t,keptDims:r}}function pr(n,e){return vn(n,e)}function vn(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function C5(n,e){for(let t=0;t<n.length;t++){const r=n[t];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function S5(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function CD(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function Nm(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function k5(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function _d(n){return typeof n=="string"||n instanceof String}function E5(n){return typeof n=="boolean"}function Xx(n){return typeof n=="number"}function dc(n){return Array.isArray(n)?dc(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":Xx(n)?"float32":_d(n)?"string":E5(n)?"bool":"float32"}function Yx(n){return!!(n&&n.constructor&&n.call&&n.apply)}function Zx(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function Qe(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let r=e-3;r>=0;--r)t[r]=t[r+1]*n[r+1];return t}function SD(n,e,t,r=!1){const s=new Array;if(e.length===1){const i=e[0]*(r?2:1);for(let o=0;o<i;o++)s[o]=t[n+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<i;l++)s[l]=SD(n+l*a,o,t,r)}return s}function fi(n,e,t=!1){if(n.length===0)return e[0];const r=n.reduce((s,i)=>s*i)*(t?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return SD(0,n,e,t)}function I5(n,e){if(Array.isArray(n))return n;if(e==="float32")return n instanceof Float32Array?n:new Float32Array(n);if(e==="int32")return n instanceof Int32Array?n:new Int32Array(n);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${e}`)}function nb(n,e){const t=mr(n,e);for(let r=0;r<t.length;r++)t[r]=1;return t}function mr(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function kD(n,e){const t=n.reduce((r,s)=>r*s,1);if(e==null||e==="float32")return fi(n,new Float32Array(t));if(e==="int32")return fi(n,new Int32Array(t));if(e==="bool")return fi(n,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function Io(n){n.forEach(e=>{O(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function Vi(n,e,t){if(e===0)return 0;if(e===1)return n[0];let r=n[n.length-1];for(let s=0;s<n.length-1;++s)r+=t[s]*n[s];return r}function fc(n,e,t){if(e===0)return[];if(e===1)return[n];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(n/t[s]),n-=r[s]*t[s];return r[r.length-1]=n,r}function rb(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TE="tfjsflags";class T5{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=_5,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(me().getBool("IS_TEST")||me().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];me().getBool("IS_TEST")||me().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(rb(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);TE in e&&e[TE].split(",").forEach(r=>{const[s,i]=r.split(":");this.urlFlags[s]=$5(s,i)})}}function _5(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...r)=>(N5(e,r[0],r[1]),r.join("="))),e}function N5(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function $5(n,e){const t=e.toLowerCase();return t==="true"||t==="false"?t==="true":`${+t}`===t?+t:e}function me(){return ED}let ED=null;function D5(n){ED=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ky;function ID(){if(ky==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");ky=n}return ky}function A5(){const n=ID();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function sb(n,e){const t=A5();if(t.has(n))return t.get(n);{const r=e();return t.set(n,r),t.get(n)}}const Jg="Abs",Nd="Acos",$d="Acosh",pc="Add",ib="AddN",ob="All",ab="Any",e0="ArgMax",t0="ArgMin",Dd="Asin",Ad="Asinh",Rd="Atan",Od="Atanh",Fd="Atan2",n0="AvgPool",lb="AvgPoolGrad",r0="AvgPool3D",ub="AvgPool3DGrad",s0="BatchMatMul",i0="BatchToSpaceND",cb="Bincount",hb="BitwiseAnd",R5="BroadcastTo",TD="BroadcastArgs",Ld="Cast",Pd="Ceil",Md="ClipByValue",db="Complex",o0="ComplexAbs",a0="Concat",l0="Conv2D",fb="Conv2DBackpropFilter",u0="Conv2DBackpropInput",c0="Conv3D",pb="Conv3DBackpropFilterV2",mb="Conv3DBackpropInputV2",Bd="Cos",zd="Cosh",gb="Cumprod",h0="Cumsum",vb="CropAndResize",yb="DenseBincount",xb="DepthToSpace",d0="DepthwiseConv2dNative",wb="DepthwiseConv2dNativeBackpropFilter",bb="DepthwiseConv2dNativeBackpropInput",_D="Diag",f0="Dilation2D",Qx="Dilation2DBackpropInput",Jx="Dilation2DBackpropFilter",O5="Draw",Ud="RealDiv",Cb="Einsum",Vd="Elu",Sb="EluGrad",Wd="Erf",p0="Equal",Gd="Exp",m0="ExpandDims",jd="Expm1",kb="FFT",Eb="Fill",Ib="FlipLeftRight",Hd="Floor",qd="FloorDiv",g0="FusedBatchNorm",v0="GatherV2",ND="GatherNd",y0="Greater",Kd="GreaterEqual",Xd="Identity",Tb="IFFT",_b="Imag",Yd="IsFinite",Zd="IsInf",Qd="IsNan",x0="LeakyRelu",w0="Less",b0="LessEqual",$D="LinSpace",Jd="Log",ef="Log1p",C0="LogicalAnd",S0="LogicalNot",k0="LogicalOr",F5="LogSoftmax",E0="LRN",Nb="LRNGrad",I0="Max",tf="Maximum",T0="MaxPool",$b="MaxPoolGrad",_0="MaxPool3D",Db="MaxPool3DGrad",DD="MaxPoolWithArgmax",N0="Mean",$0="Min",nf="Minimum",D0="MirrorPad",rf="Mod",AD="Multinomial",sf="Multiply",A0="Neg",R0="NotEqual",Ab="NonMaxSuppressionV3",Rb="NonMaxSuppressionV4",Ob="NonMaxSuppressionV5",O0="OnesLike",F0="OneHot",L0="Pack",P0="PadV2",of="Pow",M0="Prelu",B0="Prod",RD="RaggedGather",OD="RaggedRange",FD="RaggedTensorToTensor",Fb="Range",Lb="Real",af="Reciprocal",lf="Relu",z0="Reshape",U0="ResizeNearestNeighbor",Pb="ResizeNearestNeighborGrad",V0="ResizeBilinear",Mb="ResizeBilinearGrad",uf="Relu6",W0="Reverse",cf="Round",hf="Rsqrt",LD="ScatterNd",PD="TensorScatterUpdate",MD="SearchSorted",G0="Select",df="Selu",j0="Slice",ff="Sin",pf="Sinh",mf="Sign",gf="Sigmoid",vf="Softplus",yf="Sqrt",H0="Sum",q0="SpaceToBatchND",K0="SplitV",X0="Softmax",BD="SparseFillEmptyRows",zD="SparseReshape",UD="SparseSegmentMean",VD="SparseSegmentSum",WD="SparseToDense",xf="SquaredDifference",Bb="Square",zb="StaticRegexReplace",Ub="StridedSlice",GD="StringNGrams",jD="StringSplit",HD="StringToHashBucketFast",wf="Sub",bf="Tan",Cf="Tanh",Sf="Tile",Vb="TopK",Wb="Transform",Du="Transpose",Gb="Unique",Y0="Unpack",Z0="UnsortedSegmentSum",Q0="ZerosLike",kf="Step",L5="FromPixels",jb="RotateWithOffset",$m="_FusedMatMul",Dm="FusedConv2D",qD="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fs(...n){me().getBool("IS_TEST")||me().getBool("PROD")||console.warn(...n)}function P5(...n){me().getBool("IS_TEST")||me().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Am=sb("kernelRegistry",()=>new Map),e1=sb("gradRegistry",()=>new Map);function _E(n,e){const t=XD(n,e);return Am.get(t)}function NE(n){return e1.get(n)}function $E(n){const e=Am.entries(),t=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[i,o]=s,[a]=i.split("_");a===n&&t.push(o)}return t}function KD(n){const{kernelName:e,backendName:t}=n,r=XD(e,t);Am.has(r)&&fs(`The kernel '${e}' for backend '${t}' is already registered`),Am.set(r,n)}function M5(n){const{kernelName:e}=n;e1.has(e)&&me().getBool("DEBUG")&&fs(`Overriding the gradient for '${e}'`),e1.set(e,n)}function XD(n,e){return`${e}_${n}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YD(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var ZD=en,Ms=null;try{Ms=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function en(n,e,t){this.low=n|0,this.high=e|0,this.unsigned=!!t}en.prototype.__isLong__;Object.defineProperty(en.prototype,"__isLong__",{value:!0});function as(n){return(n&&n.__isLong__)===!0}en.isLong=as;var DE={},AE={};function Dl(n,e){var t,r,s;return e?(n>>>=0,(s=0<=n&&n<256)&&(r=AE[n],r)?r:(t=tn(n,(n|0)<0?-1:0,!0),s&&(AE[n]=t),t)):(n|=0,(s=-128<=n&&n<128)&&(r=DE[n],r)?r:(t=tn(n,n<0?-1:0,!1),s&&(DE[n]=t),t))}en.fromInt=Dl;function Bs(n,e){if(isNaN(n))return e?qa:zs;if(e){if(n<0)return qa;if(n>=QD)return tA}else{if(n<=-OE)return Zr;if(n+1>=OE)return eA}return n<0?Bs(-n,e).neg():tn(n%Hu|0,n/Hu|0,e)}en.fromNumber=Bs;function tn(n,e,t){return new en(n,e,t)}en.fromBits=tn;var Rm=Math.pow;function Hb(n,e,t){if(n.length===0)throw Error("empty string");if(n==="NaN"||n==="Infinity"||n==="+Infinity"||n==="-Infinity")return zs;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var r;if((r=n.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return Hb(n.substring(1),e,t).neg();for(var s=Bs(Rm(t,8)),i=zs,o=0;o<n.length;o+=8){var a=Math.min(8,n.length-o),l=parseInt(n.substring(o,o+a),t);if(a<8){var u=Bs(Rm(t,a));i=i.mul(u).add(Bs(l))}else i=i.mul(s),i=i.add(Bs(l))}return i.unsigned=e,i}en.fromString=Hb;function bi(n,e){return typeof n=="number"?Bs(n,e):typeof n=="string"?Hb(n,e):tn(n.low,n.high,typeof e=="boolean"?e:n.unsigned)}en.fromValue=bi;var RE=65536,B5=1<<24,Hu=RE*RE,QD=Hu*Hu,OE=QD/2,FE=Dl(B5),zs=Dl(0);en.ZERO=zs;var qa=Dl(0,!0);en.UZERO=qa;var Cu=Dl(1);en.ONE=Cu;var JD=Dl(1,!0);en.UONE=JD;var t1=Dl(-1);en.NEG_ONE=t1;var eA=tn(-1,2147483647,!1);en.MAX_VALUE=eA;var tA=tn(-1,-1,!0);en.MAX_UNSIGNED_VALUE=tA;var Zr=tn(0,-2147483648,!1);en.MIN_VALUE=Zr;var ze=en.prototype;ze.toInt=function(){return this.unsigned?this.low>>>0:this.low};ze.toNumber=function(){return this.unsigned?(this.high>>>0)*Hu+(this.low>>>0):this.high*Hu+(this.low>>>0)};ze.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Zr)){var t=Bs(e),r=this.div(t),s=r.mul(t).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=Bs(Rm(e,6),this.unsigned),o=this,a="";;){var l=o.div(i),u=o.sub(l.mul(i)).toInt()>>>0,c=u.toString(e);if(o=l,o.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}};ze.getHighBits=function(){return this.high};ze.getHighBitsUnsigned=function(){return this.high>>>0};ze.getLowBits=function(){return this.low};ze.getLowBitsUnsigned=function(){return this.low>>>0};ze.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Zr)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};ze.isZero=function(){return this.high===0&&this.low===0};ze.eqz=ze.isZero;ze.isNegative=function(){return!this.unsigned&&this.high<0};ze.isPositive=function(){return this.unsigned||this.high>=0};ze.isOdd=function(){return(this.low&1)===1};ze.isEven=function(){return(this.low&1)===0};ze.equals=function(e){return as(e)||(e=bi(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};ze.eq=ze.equals;ze.notEquals=function(e){return!this.eq(e)};ze.neq=ze.notEquals;ze.ne=ze.notEquals;ze.lessThan=function(e){return this.comp(e)<0};ze.lt=ze.lessThan;ze.lessThanOrEqual=function(e){return this.comp(e)<=0};ze.lte=ze.lessThanOrEqual;ze.le=ze.lessThanOrEqual;ze.greaterThan=function(e){return this.comp(e)>0};ze.gt=ze.greaterThan;ze.greaterThanOrEqual=function(e){return this.comp(e)>=0};ze.gte=ze.greaterThanOrEqual;ze.ge=ze.greaterThanOrEqual;ze.compare=function(e){if(as(e)||(e=bi(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ze.comp=ze.compare;ze.negate=function(){return!this.unsigned&&this.eq(Zr)?Zr:this.not().add(Cu)};ze.neg=ze.negate;ze.add=function(e){as(e)||(e=bi(e));var t=this.high>>>16,r=this.high&65535,s=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,h=0,d=0,f=0;return f+=i+u,d+=f>>>16,f&=65535,d+=s+l,h+=d>>>16,d&=65535,h+=r+a,c+=h>>>16,h&=65535,c+=t+o,c&=65535,tn(d<<16|f,c<<16|h,this.unsigned)};ze.subtract=function(e){return as(e)||(e=bi(e)),this.add(e.neg())};ze.sub=ze.subtract;ze.multiply=function(e){if(this.isZero())return zs;if(as(e)||(e=bi(e)),Ms){var t=Ms.mul(this.low,this.high,e.low,e.high);return tn(t,Ms.get_high(),this.unsigned)}if(e.isZero())return zs;if(this.eq(Zr))return e.isOdd()?Zr:zs;if(e.eq(Zr))return this.isOdd()?Zr:zs;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(FE)&&e.lt(FE))return Bs(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,u=e.low>>>16,c=e.low&65535,h=0,d=0,f=0,p=0;return p+=o*c,f+=p>>>16,p&=65535,f+=i*c,d+=f>>>16,f&=65535,f+=o*u,d+=f>>>16,f&=65535,d+=s*c,h+=d>>>16,d&=65535,d+=i*u,h+=d>>>16,d&=65535,d+=o*l,h+=d>>>16,d&=65535,h+=r*c+s*u+i*l+o*a,h&=65535,tn(f<<16|p,h<<16|d,this.unsigned)};ze.mul=ze.multiply;ze.divide=function(e){if(as(e)||(e=bi(e)),e.isZero())throw Error("division by zero");if(Ms){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?Ms.div_u:Ms.div_s)(this.low,this.high,e.low,e.high);return tn(t,Ms.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?qa:zs;var r,s,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return qa;if(e.gt(this.shru(1)))return JD;i=qa}else{if(this.eq(Zr)){if(e.eq(Cu)||e.eq(t1))return Zr;if(e.eq(Zr))return Cu;var o=this.shr(1);return r=o.div(e).shl(1),r.eq(zs)?e.isNegative()?Cu:t1:(s=this.sub(e.mul(r)),i=r.add(s.div(e)),i)}else if(e.eq(Zr))return this.unsigned?qa:zs;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=zs}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:Rm(2,a-48),u=Bs(r),c=u.mul(e);c.isNegative()||c.gt(s);)r-=l,u=Bs(r,this.unsigned),c=u.mul(e);u.isZero()&&(u=Cu),i=i.add(u),s=s.sub(c)}return i};ze.div=ze.divide;ze.modulo=function(e){if(as(e)||(e=bi(e)),Ms){var t=(this.unsigned?Ms.rem_u:Ms.rem_s)(this.low,this.high,e.low,e.high);return tn(t,Ms.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ze.mod=ze.modulo;ze.rem=ze.modulo;ze.not=function(){return tn(~this.low,~this.high,this.unsigned)};ze.and=function(e){return as(e)||(e=bi(e)),tn(this.low&e.low,this.high&e.high,this.unsigned)};ze.or=function(e){return as(e)||(e=bi(e)),tn(this.low|e.low,this.high|e.high,this.unsigned)};ze.xor=function(e){return as(e)||(e=bi(e)),tn(this.low^e.low,this.high^e.high,this.unsigned)};ze.shiftLeft=function(e){return as(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?tn(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):tn(0,this.low<<e-32,this.unsigned)};ze.shl=ze.shiftLeft;ze.shiftRight=function(e){return as(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?tn(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):tn(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ze.shr=ze.shiftRight;ze.shiftRightUnsigned=function(e){if(as(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var r=this.low;return tn(r>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?tn(t,0,this.unsigned):tn(t>>>e-32,0,this.unsigned)};ze.shru=ze.shiftRightUnsigned;ze.shr_u=ze.shiftRightUnsigned;ze.toSigned=function(){return this.unsigned?tn(this.low,this.high,!1):this};ze.toUnsigned=function(){return this.unsigned?this:tn(this.low,this.high,!0)};ze.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ze.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ze.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};en.fromBytes=function(e,t,r){return r?en.fromBytesLE(e,t):en.fromBytesBE(e,t)};en.fromBytesLE=function(e,t){return new en(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};en.fromBytesBE=function(e,t){return new en(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};const nA=A1(ZD),z5=cT({__proto__:null,default:nA},[ZD]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const za=nA||z5;function J0(n){return za.fromString(n,!0,16)}const rA=J0("c3a5c85c97cb3127"),Ma=J0("b492b66fbe98f273"),Sr=J0("9ae16a3b2f90404f");function n1(n){return n.xor(n.shru(47))}function sA(n,e,t){const r=n.slice(e,e+t);return za.fromBytes(Array.from(r),!0,!0)}function Ht(n,e){return sA(n,e,8)}function LE(n,e){return sA(n,e,4)}function Xn(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function ra(n,e,t=J0("9ddfea08eb382d69")){let r=n.xor(e).mul(t);r=r.xor(r.shru(47));let s=e.xor(r).mul(t);return s=s.xor(s.shru(47)),s=s.mul(t),s}function U5(n,e,t,r,s,i){s=s.add(n),i=Xn(i.add(s).add(r),21);const o=s;return s=s.add(e),s=s.add(t),i=i.add(Xn(s,44)),[s.add(r),i.add(o)]}function wp(n,e,t,r){return U5(Ht(n,e),Ht(n,e+8),Ht(n,e+16),Ht(n,e+24),t,r)}function V5(n,e=n.length){if(e>=8){const t=Sr.add(e*2),r=Ht(n,0).add(Sr),s=Ht(n,e-8),i=Xn(s,37).mul(t).add(r),o=Xn(r,25).add(s).mul(t);return ra(i,o,t)}if(e>=4){const t=Sr.add(e*2),r=LE(n,0);return ra(r.shl(3).add(e),LE(n,e-4),t)}if(e>0){const t=n[0],r=n[e>>1],s=n[e-1],i=t+(r<<8),o=e+(s<<2);return n1(Sr.mul(i).xor(rA.mul(o))).mul(Sr)}return Sr}function W5(n,e=n.length){const t=Sr.add(e*2),r=Ht(n,0).mul(Ma),s=Ht(n,8),i=Ht(n,e-8).mul(t),o=Ht(n,e-16).mul(Sr);return ra(Xn(r.add(s),43).add(Xn(i,30)).add(o),r.add(Xn(s.add(Sr),18)).add(i),t)}function G5(n,e=n.length){const t=Sr.add(e*2),r=Ht(n,0).mul(Sr),s=Ht(n,8),i=Ht(n,e-8).mul(t),o=Ht(n,e-16).mul(Sr),a=Xn(r.add(s),43).add(Xn(i,30)).add(o),l=ra(a,r.add(Xn(s.add(Sr),18)).add(i),t),u=Ht(n,16).mul(t),c=Ht(n,24),h=a.add(Ht(n,e-32)).mul(t),d=l.add(Ht(n,e-24)).mul(t);return ra(Xn(u.add(c),43).add(Xn(h,30)).add(d),u.add(Xn(c.add(r),18)).add(h),t)}function j5(n,e=n.length){const t=za.fromNumber(81,!0);if(e<=32)return e<=16?V5(n,e):W5(n,e);if(e<=64)return G5(n,e);let r=t,s=t.mul(Ma).add(113),i=n1(s.mul(Sr).add(113)).mul(Sr),o=[za.UZERO,za.UZERO],a=[za.UZERO,za.UZERO];r=r.mul(Sr).add(Ht(n,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do r=Xn(r.add(s).add(o[0]).add(Ht(n,l+8)),37).mul(Ma),s=Xn(s.add(o[1]).add(Ht(n,l+48)),42).mul(Ma),r=r.xor(a[1]),s=s.add(o[0]).add(Ht(n,l+40)),i=Xn(i.add(a[0]),33).mul(Ma),o=wp(n,l,o[1].mul(Ma),r.add(a[0])),a=wp(n,l+32,i.add(a[1]),s.add(Ht(n,l+16))),[i,r]=[r,i],l+=64;while(l!==u);const h=Ma.add(i.and(255).shl(1));return l=c,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),r=Xn(r.add(s).add(o[0]).add(Ht(n,l+8)),37).mul(h),s=Xn(s.add(o[1]).add(Ht(n,l+48)),42).mul(h),r=r.xor(a[1].mul(9)),s=s.add(o[0].mul(9).add(Ht(n,l+40))),i=Xn(i.add(a[0]),33).mul(h),o=wp(n,l,o[1].mul(h),r.add(a[0])),a=wp(n,l+32,i.add(a[1]),s.add(Ht(n,l+16))),[i,r]=[r,i],ra(ra(o[0],a[0],h).add(n1(s).mul(rA)).add(i),ra(o[1],a[1],h).add(r),h)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ca(n,e){return e==="string"?sa(n):Al([n],e)}function H5(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function Al(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=hl(n)),me().getBool("DEBUG")&&C5(n,e),H5(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let r=0;r<t.length;++r)Math.round(n[r])!==0&&(t[r]=1);return t}else throw new Error(`Unknown data type ${e}`)}function Or(){return me().platform.now()}function sa(n,e="utf-8"){return e=e||"utf-8",me().platform.encode(n,e)}function ca(n,e="utf-8"){return e=e||"utf-8",me().platform.decode(n,e)}function Hs(n){return me().platform.isTypedArray!=null?me().platform.isTypedArray(n):YD(n)}function hl(n,e=[],t=!1){if(e==null&&(e=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||rb(n)||n==null||Hs(n)&&t)e.push(n);else if(Array.isArray(n)||Hs(n))for(let r=0;r<n.length;++r)hl(n[r],e,t);else{let r=-1;for(const s of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)hl(n[s],e,t)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q5{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new X5)}profileKernel(e,t,r){let s;const i=()=>{s=r()};let o;const a=Or();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const u of s)u.dataSync();o=Promise.resolve({kernelMs:Or()-a})}if(me().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<s.length;u++){const c=s[u];c.data().then(h=>{K5(h,c.dtype,e)})}return{kernelName:e,outputs:s,inputs:t,timeMs:o.then(u=>u.kernelMs),extraInfo:o.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:r,timeMs:s,inputs:i,extraInfo:o}=e;r.forEach(a=>{Promise.all([a.data(),s,o]).then(l=>{this.logger.logKernelProfile(t,a,l[0],l[1],i,l[2])})})}}function K5(n,e,t){if(e!=="float32")return!1;for(let r=0;r<n.length;r++){const s=n[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${t}'`),!0}return!1}class X5{logKernelProfile(e,t,r,s,i,o){const a=typeof s=="number"?$u(`${s}ms`,9):s.error,l=$u(e,25),u=t.rank,c=t.size,h=$u(t.shape.toString(),14);let d="";for(const f in i){const p=i[f];if(p!=null){const v=p.shape||t.shape,g=v.length;d+=`${f}: ${g}D ${g>0?v:""} `}}console.log(`%c${l}	%c${a}	%c${u}D ${h}	%c${c}	%c${d}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y5(n,e,t){const r={},s={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<n.length;l++){const u=n[l],c=u.inputs;for(const h in c){const d=c[h];let f=!1;for(let p=0;p<e.length;p++)if(r[d.id]){u.outputs.forEach(v=>r[v.id]=!0),f=!0,s[u.id]=!0;break}if(f)break}}const i={};i[t.id]=!0;const o={};for(let l=n.length-1;l>=0;l--){const u=n[l],c=u.inputs;for(let h=0;h<u.outputs.length;h++)if(i[u.outputs[h].id]){for(const d in c)i[c[d].id]=!0,o[u.id]=!0;break}}const a=[];for(let l=0;l<n.length;l++){const u=n[l];if(s[u.id]&&o[u.id]){const c={};for(const d in u.inputs){const f=u.inputs[d];r[f.id]&&(c[d]=f)}const h=Object.assign({},u);h.inputs=c,h.outputs=u.outputs,a.push(h)}}return a}function Z5(n,e,t,r){for(let s=e.length-1;s>=0;s--){const i=e[s],o=[];if(i.outputs.forEach(l=>{const u=n[l.id];u!=null?o.push(u):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const u=t(()=>a[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=i.inputs[l];if(!Nt(u.shape,c.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(n[c.id]==null)n[c.id]=u;else{const h=n[c.id];n[c.id]=r(h,u),h.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PE=20,Yc=3,Ey=7;function Q5(n,e,t,r){const s=Qe(e),i=J5(n,e,t,s),o=e.length,a=qp(n,e,t,s,i),l=["Tensor"];return r&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(u=>"    "+u).join(`
`)),l.join(`
`)}function J5(n,e,t,r){const s=we(e),i=r[r.length-1],o=new Array(i).fill(0),a=e.length,l=t==="complex64"?ih(n):n;if(a>1)for(let u=0;u<s/i;u++){const c=u*i;for(let h=0;h<i;h++)o[h]=Math.max(o[h],sh(l[c+h],0,t).length)}return o}function sh(n,e,t){let r;return Array.isArray(n)?r=`${parseFloat(n[0].toFixed(Ey))} + ${parseFloat(n[1].toFixed(Ey))}j`:_d(n)?r=`'${n}'`:t==="bool"?r=iA(n):r=parseFloat(n.toFixed(Ey)).toString(),$u(r,e)}function iA(n){return n===0?"false":"true"}function qp(n,e,t,r,s,i=!0){const o=t==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(t==="complex64"){const v=ih(n);return[sh(v[0],0,t)]}return t==="bool"?[iA(n[0])]:[n[0].toString()]}if(l===1){if(a>PE){const g=Yc*o;let m=Array.from(n.slice(0,g)),y=Array.from(n.slice((a-Yc)*o,a*o));return t==="complex64"&&(m=ih(m),y=ih(y)),["["+m.map((w,x)=>sh(w,s[x],t)).join(", ")+", ..., "+y.map((w,x)=>sh(w,s[a-Yc+x],t)).join(", ")+"]"]}return["["+(t==="complex64"?ih(n):Array.from(n)).map((g,m)=>sh(g,s[m],t)).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),h=r[0]*o,d=[];if(a>PE){for(let v=0;v<Yc;v++){const g=v*h,m=g+h;d.push(...qp(n.slice(g,m),u,t,c,s,!1))}d.push("...");for(let v=a-Yc;v<a;v++){const g=v*h,m=g+h;d.push(...qp(n.slice(g,m),u,t,c,s,v===a-1))}}else for(let v=0;v<a;v++){const g=v*h,m=g+h;d.push(...qp(n.slice(g,m),u,t,c,s,v===a-1))}const f=l===2?",":"";d[0]="["+(a>0?d[0]+f:"");for(let v=1;v<d.length-1;v++)d[v]=" "+d[v]+f;let p=`,
`;for(let v=2;v<l;v++)p+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(i?"":p),d}function ih(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ir{constructor(e,t,r){if(this.dtype=t,this.shape=e.slice(),this.size=we(e),r!=null){const s=r.length;O(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||vn(t,this.size),this.strides=Qe(e)}set(e,...t){t.length===0&&(t=[0]),O(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const r=this.locToIndex(t);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const s of e){if(s<0||s>=this.shape[t]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}t++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return ai().makeTensor(this.values,this.shape,this.dtype)}}let ai=null,iu=null;function eG(n){ai=n}function tG(n){iu=n}class Dn{constructor(e,t,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=we(e),this.strides=Qe(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return iu.buffer(this.shape,this.dtype,e)}bufferSync(){return iu.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return fi(this.shape,e,this.dtype==="complex64")}arraySync(){return fi(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=ai().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(r=>ca(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),ai().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=ai().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>ca(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await ai().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(ai().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return iu.print(this,e)}clone(){return this.throwIfDisposed(),iu.clone(this)}toString(e=!1){const t=this.dataSync();return Q5(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),iu.cast(this,e)}variable(e=!0,t,r){return this.throwIfDisposed(),ai().makeVariable(this,e,t,r)}}Object.defineProperty(Dn,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function xe(){return sb("Tensor",()=>Dn)}xe();class Om extends Dn{constructor(e,t,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=t,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Nt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);ai().disposeTensor(this),this.dataId=e.dataId,ai().incRef(this,null)}dispose(){ai().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Om,Symbol.hasInstance,{value:n=>n instanceof Dn&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ME;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(ME||(ME={}));var r1;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(r1||(r1={}));var s1;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(s1||(s1={}));var i1;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(i1||(i1={}));var o1;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(o1||(o1={}));const nG={float32:i1,int32:r1,bool:s1,complex64:o1};function ns(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return nG[n][e]}function qb(n){return ns(n,"int32")}function oA(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function aA(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xn(n,e){if(n.dtype===e.dtype)return[n,e];const t=ns(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function lA(n){const e=[];return uA(n,e,new Set),e}function uA(n,e,t){if(n==null)return;if(n instanceof Dn){e.push(n);return}if(!rG(n))return;const r=n;for(const s in r){const i=r[s];t.has(i)||(t.add(i),uA(i,e,t))}}function rG(n){return Array.isArray(n)||typeof n=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iy(n){return n.kernelName!=null}class BE{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class qu{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new BE}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,r=1){return e in this.registryFactory?(fs(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:r}=this.initializeBackend(e);if(!(r?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new q5(this.backendInstance),!0}setupRegisteredKernels(){$E(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){$E(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=t.factory();if(r&&!(r instanceof Jw)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,i=r.then(o=>s<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,fs(`Initialization of backend ${e} failed`),fs(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return fs(`Initialization of backend ${e} failed`),fs(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t],{success:s,asyncInit:i}=this.initializeBackend(r);if(i||s)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const r=this.state.tensorInfo.get(t),s=r.backend,i=this.readSync(t),o=s.refCount(t);s.disposeData(t,!0),r.backend=e,e.move(t,i,r.shape,r.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let r=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=t(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,t,r){e();try{const s=r();return t(),s}catch(s){throw t(),s}}nextTensorId(){return qu.nextTensorId++}nextVariableId(){return qu.nextVariableId++}clone(e){const t=te.runKernel(Xd,{x:e}),r={x:e},s=o=>({x:()=>{const a="float32",l={x:o},u={dtype:a};return te.runKernel(Ld,l,u)}}),i=[];return this.addTapeNode(this.state.activeScope.name,r,[t],s,i,{}),t}runKernel(e,t,r){if(this.backendName==null&&this.backend,!(_E(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,r){const s=this.backend.numDataIds();let i=0;r.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=s-t-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let t,r=[];const s=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const u=Iy(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Iy(e)){const{kernelName:p,inputs:v,attrs:g}=e;this.backendName==null&&this.backend;const m=_E(p,this.backendName);O(m!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const y=this.backend.numDataIds();l=m.kernelFunc({inputs:v,attrs:g,backend:this.backend});const w=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,y,w);const x=w.map(b=>b.rank!=null?b:this.makeTensorFromTensorInfo(b));if(s){const b=this.getTensorsForGradient(p,v,x);r=this.saveTensorsForBackwardMode(b)}return x}}else{const{forwardFunc:p}=e,v=g=>{s&&(r=g.map(m=>this.keep(this.clone(m))))};a=()=>{const g=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,v));const m=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,g,m),m}}const{inputs:c,attrs:h}=e,d=Iy(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=a():(f=this.profiler.profileKernel(u,c,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),t=f.outputs)}),s&&this.addTapeNode(u,c,t,d,r,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(p=>c[p]!=null?c[p].shape:null),outputShapes:t.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,t,r){const s=NE(e);if(s!=null){const i=s.inputsToSave||[],o=s.outputsToSave||[];let a;s.saveAllInputs?(O(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(t).map(u=>t[u])):a=i.map(u=>t[u]);const l=r.filter((u,c)=>o[c]);return a.concat(l)}return[]}makeTensor(e,t,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let i=e;r==="string"&&_d(e[0])&&(i=e.map(l=>sa(l)));const o=s.write(i,t,r),a=new Dn(t,r,o,this.nextTensorId());if(this.trackTensor(a,s),r==="string"){const l=this.state.tensorInfo.get(o),u=k5(i);this.state.numBytes+=u-l.bytes,l.bytes=u}return a}makeTensorFromDataId(e,t,r,s){r=r||"float32";const i={dataId:e,shape:t,dtype:r};return this.makeTensorFromTensorInfo(i,s)}makeTensorFromTensorInfo(e,t){const{dataId:r,shape:s,dtype:i}=e,o=new Dn(s,i,r,this.nextTensorId());return this.trackTensor(o,t),o}makeVariable(e,t=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const i=new Om(e,t,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*Nm(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof Om||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*Nm(e.dtype);this.state.numBytes-=r}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,r,s,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:r,saved:i},l=NE(e);l!=null&&(s=l.gradFunc),s!=null&&(a.gradient=u=>(u=u.map((c,h)=>{if(c==null){const d=r[h],f=mr(d.size,d.dtype);return this.makeTensor(f,d.shape,d.dtype)}return c}),s(u.length>1?u:u[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=lA(e),r=new Set(t.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!r.has(o.id)&&o.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(i=>{!i.kept&&i.scopeId===s.id&&this.track(i)})}gradients(e,t,r,s=!1){if(O(t.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));O(i instanceof Dn,()=>"The result y returned by f() must be a tensor.");const o=Y5(this.state.activeTape,t,i);if(!s&&o.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=r??sG(i.shape),Z5(a,o,u=>this.tidy(u),iG);const l=t.map(u=>a[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return O(Yx(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{O(t.every(a=>a instanceof Dn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};t.forEach((a,l)=>{s[l]=a});const i=(a,l)=>(r=e(...t,l),O(r.value instanceof Dn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),O(Yx(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),o=(a,l)=>{const u=r.gradFunc(a,l),c=Array.isArray(u)?u:[u];O(c.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),O(c.every(d=>d instanceof Dn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const h={};return c.forEach((d,f)=>{h[f]=()=>d}),h};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=Or(),r=await this.backend.time(e);return r.wallMs=Or()-t,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new BE;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}qu.nextTensorId=0;qu.nextVariableId=0;function sG(n){const e=nb(we(n),"float32");return te.makeTensor(e,n,"float32")}function cA(){const n=ID();if(n._tfengine==null){const e=new T5(n);n._tfengine=new qu(e)}return D5(n._tfengine.ENV),eG(()=>n._tfengine),n._tfengine}const te=cA();function iG(n,e){const t={a:n,b:e};return te.runKernel(pc,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oG(){return typeof navigator<"u"&&navigator!=null}function hA(n){if(n||oG()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function dA(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Br=me();Br.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Br.registerFlag("IS_BROWSER",()=>dA());Br.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Br.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Br.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Br.registerFlag("PROD",()=>!1);Br.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Br.getBool("DEBUG"));Br.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Br.registerFlag("IS_TEST",()=>!1);Br.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Br.getBool("DEBUG"));Br.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Br.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Br.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ev(n,e){let t=n;if(Hs(n))return e==="string"?[]:[n.length];if(oA(n)){const s=n.channels||"RGBA";return[n.height,n.width*s.length]}else if(aA(n))return[n.buffer.size/(e==null?4:Nm(e))];if(!Array.isArray(n))return[];const r=[];for(;Array.isArray(t)||Hs(t)&&e!=="string";)r.push(t.length),t=t[0];return Array.isArray(n)&&me().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&fA(n,r,[]),r}function fA(n,e,t){if(t=t||[],!Array.isArray(n)&&!Hs(n)){O(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}O(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),O(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const r=e.slice(1);for(let s=0;s<n.length;++s)fA(n[s],r,t.concat(s))}function zE(n,e,t,r){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${r}' must be ${n} tensor, but got ${e} tensor`)}}function H(n,e,t,r="numeric"){if(n instanceof Dn)return zE(r,n.dtype,e,t),n;let s=dc(n);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),zE(r,s,e,t),n==null||!Hs(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const l=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const i=ev(n,s);!Hs(n)&&!Array.isArray(n)&&(n=[n]);const a=s!=="string"?Al(n,s):hl(n,[],!0);return te.makeTensor(a,i,s)}function pA(n,e,t,r="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((i,o)=>H(i,`${e}[${o}]`,t,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aG="__op";function le(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const r=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+aG;const s=(...i)=>{te.startScope(t);try{const o=r(...i);return rb(o)&&console.error("Cannot return a Promise inside of tidy."),te.endScope(o),o}catch(o){throw te.endScope(null),o}};return Object.defineProperty(s,"name",{value:t,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lG(n,e){const t=H(n,"real","complex"),r=H(e,"imag","complex");tb(t.shape,r.shape,`real and imag shapes, ${t.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:t,imag:r};return te.runKernel(db,s)}const dl=le({complex_:lG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tv(n,e,t,r){if(r==null)r=dc(n);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(aA(n)||oA(n)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return te.backend.createTensorFromGPUData(n,e||t,r)}if(!Hs(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Io(e);const s=we(e),i=we(t);O(s===i,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${i}`);for(let o=0;o<t.length;++o){const a=t[o],l=o===t.length-1?a!==we(e.slice(o)):!0;O(t[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!Hs(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=r!=="string"?Al(n,r):hl(n,[],!0),te.makeTensor(n,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ch(n,e,t){const r=ev(n,t);return tv(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UE={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Sa{static join(e){return new Sa(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>Hs(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let r=0;r<e.length;r++){const s=e[r];r!==e.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=t+s.byteLength;this.shards.push({buffer:s,start:t,end:i}),t=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const s=t-e,i=new ArrayBuffer(s),o=new Uint8Array(i);let a=0;for(let l=r;l<this.shards.length;l++){const u=this.shards[l],h=e+a-u.start,d=a,p=Math.min(t,u.end)-u.start,v=new Uint8Array(u.buffer,h,p-h);if(o.set(v,d),a+=v.length,t<u.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(s){return e<s.start?-1:e>=s.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=uG(this.shards,t);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function uG(n,e){let t=0,r=n.length;for(;t<=r;){const s=Math.floor((r-t)/2)+t,i=e(n[s]);if(i===0)return s;i<0?r=s:t=s+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fm=4;async function VE(n,e){const t=[],r=[],s=Array.isArray(n)?n.map(o=>o.name):Object.keys(n);for(let o=0;o<s.length;++o){const a=s[o],l=Array.isArray(n)?n[o].tensor:n[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const u={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async h=>{const d=await l.bytes(),f=d.reduce((g,m)=>g+m.length,0)+Fm*d.length,p=new Uint8Array(f);let v=0;for(let g=0;g<d.length;g++){const m=d[g],y=new Uint8Array(new Uint32Array([m.length]).buffer);p.set(y,v),v+=Fm,p.set(m,v),v+=m.length}h(p)});r.push(c)}else r.push(l.data());e!=null&&(u.group=e),t.push(u)}const i=await Promise.all(r);return{data:hG(i),specs:t}}function cG(n,e){const t=new Sa(n),r={};let s,i=0;for(const o of e){const a=o.name,l=o.dtype,u=o.shape,c=we(u);let h;if("quantization"in o){const d=o.quantization;if(d.dtype==="uint8"||d.dtype==="uint16"){if(!("min"in d&&"scale"in d))throw new Error(`Weight ${o.name} with quantization ${d.dtype} doesn't have corresponding metadata min and scale.`)}else if(d.dtype==="float16"){if(l!=="float32")throw new Error(`Weight ${o.name} is quantized with ${d.dtype} which only supports weights of type float32 not ${l}.`)}else throw new Error(`Weight ${o.name} has unknown quantization dtype ${d.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const f=UE[d.dtype],p=t.slice(i,i+c*f),v=d.dtype==="uint8"?new Uint8Array(p):new Uint16Array(p);if(l==="float32")if(d.dtype==="uint8"||d.dtype==="uint16"){h=new Float32Array(v.length);for(let g=0;g<v.length;g++){const m=v[g];h[g]=m*d.scale+d.min}}else if(d.dtype==="float16")s===void 0&&(s=CG()),h=s(v);else throw new Error(`Unsupported quantization type ${d.dtype} for weight type float32.`);else if(l==="int32"){if(d.dtype!=="uint8"&&d.dtype!=="uint16")throw new Error(`Unsupported quantization type ${d.dtype} for weight type int32.`);h=new Int32Array(v.length);for(let g=0;g<v.length;g++){const m=v[g];h[g]=Math.round(m*d.scale+d.min)}}else throw new Error(`Unsupported dtype in weight '${a}': ${l}`);i+=c*f}else if(l==="string"){const d=we(o.shape);h=[];for(let f=0;f<d;f++){const p=new Uint32Array(t.slice(i,i+Fm))[0];i+=Fm;const v=new Uint8Array(t.slice(i,i+p));h.push(v),i+=p}}else{const d=UE[l],f=t.slice(i,i+c*d);if(l==="float32")h=new Float32Array(f);else if(l==="int32")h=new Int32Array(f);else if(l==="bool")h=new Uint8Array(f);else if(l==="complex64"){h=new Float32Array(f);const p=new Float32Array(h.length/2),v=new Float32Array(h.length/2);for(let y=0;y<p.length;y++)p[y]=h[y*2],v[y]=h[y*2+1];const g=Ch(p,u,"float32"),m=Ch(v,u,"float32");r[a]=dl(g,m),g.dispose(),m.dispose()}else throw new Error(`Unsupported dtype in weight '${a}': ${l}`);i+=c*d}l!=="complex64"&&(r[a]=Ch(h,u,l))}return r}function hG(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(i=>{if(e+=i.byteLength,t.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const r=new Uint8Array(e);let s=0;return t.forEach(i=>{r.set(new Uint8Array(i.buffer),s),s+=i.byteLength}),r.buffer}const Kb=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function WE(n){return Kb?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function dG(n){if(Kb)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let r=0,s=e.length;r<s;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function fG(n){if(Kb){const r=Buffer.from(n,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t.set([e.charCodeAt(r)],r);return t.buffer}function pG(n){return Sa.join(n)}function mG(n,e){const t={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:e};return n.signature!=null&&(t.signature=n.signature),n.userDefinedMetadata!=null&&(t.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(t.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(t.initializerSignature=n.initializerSignature),n.trainingConfig!=null&&(t.trainingConfig=n.trainingConfig),t}function gG(n,e,t){const r={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(r.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=t}return n.signature!=null&&(r.signature=n.signature),n.userDefinedMetadata!=null&&(r.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(r.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(r.initializerSignature=n.initializerSignature),r}async function vG(n,e){let t,r;return n.weightsManifest!=null&&([t,r]=await e(n.weightsManifest)),gG(n,t,r)}function Xb(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:WE(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:WE(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new Sa(n.weightData).byteLength}}function yG(n){const e=[];for(const t of n)e.push(...t.weights);return e}function xG(){const n=t=>{let r=t<<13,s=0;for(;!(r&8388608);)s-=8388608,r<<=1;return r&=-8388609,s+=947912704,r|s},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=n(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function wG(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let e=1;e<31;e++)n[e]=e<<23;for(let e=33;e<63;e++)n[e]=2147483648+(e-32<<23);return n}function bG(){const n=new Uint32Array(64);for(let e=0;e<64;e++)n[e]=1024;return n[0]=n[32]=0,n}function CG(){const n=xG(),e=wG(),t=bG();return r=>{const s=new ArrayBuffer(4*r.length),i=new Uint32Array(s);for(let o=0;o<r.length;o++){const a=r[o],l=n[t[a>>10]+(a&1023)]+e[a>>10];i[o]=l}return new Float32Array(s)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return qn.instance==null&&(qn.instance=new qn),qn.instance}static registerSaveRouter(e){qn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){qn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return qn.getHandlers(e,"save")}static getLoadHandlers(e,t){return qn.getHandlers(e,"load",t)}static getHandlers(e,t,r){const s=[];return(t==="load"?qn.getInstance().loadRouters:qn.getInstance().saveRouters).forEach(o=>{const a=o(e,r);a!==null&&s.push(a)}),s}}const SG=n=>qn.getSaveHandlers(n),kG=(n,e)=>qn.getLoadHandlers(n,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a1="tensorflowjs",l1=1,Ka="models_store",jo="model_info_store";function mA(){if(!me().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function u1(n){const e=n.result;e.createObjectStore(Ka,{keyPath:"modelPath"}),e.createObjectStore(jo,{keyPath:"modelPath"})}class fl{constructor(e){if(this.indexedDB=mA(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((r,s)=>{const i=this.indexedDB.open(a1,l1);i.onupgradeneeded=()=>u1(i),i.onsuccess=()=>{const o=i.result;if(t==null){const a=o.transaction(Ka,"readonly"),u=a.objectStore(Ka).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return o.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(u.result.modelArtifacts)},u.onerror=c=>(o.close(),s(u.error)),a.oncomplete=()=>o.close()}else{t.weightData=Sa.join(t.weightData);const a=Xb(t),l=o.transaction(jo,"readwrite");let u=l.objectStore(jo),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(d){return s(d)}let h;c.onsuccess=()=>{h=o.transaction(Ka,"readwrite");const d=h.objectStore(Ka);let f;try{f=d.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:a})}catch(p){return s(p)}f.onsuccess=()=>r({modelArtifactsInfo:a}),f.onerror=p=>{u=l.objectStore(jo);const v=u.delete(this.modelPath);v.onsuccess=()=>(o.close(),s(f.error)),v.onerror=g=>(o.close(),s(f.error))}},c.onerror=d=>(o.close(),s(c.error)),l.oncomplete=()=>{h==null?o.close():h.oncomplete=()=>o.close()}}},i.onerror=o=>s(i.error)})}}fl.URL_SCHEME="indexeddb://";const gA=n=>me().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(fl.URL_SCHEME)?EG(n.slice(fl.URL_SCHEME.length)):null;qn.registerSaveRouter(gA);qn.registerLoadRouter(gA);function EG(n){return new fl(n)}function IG(n){return n.startsWith(fl.URL_SCHEME)?n.slice(fl.URL_SCHEME.length):n}class TG{constructor(){this.indexedDB=mA()}async listModels(){return new Promise((e,t)=>{const r=this.indexedDB.open(a1,l1);r.onupgradeneeded=()=>u1(r),r.onsuccess=()=>{const s=r.result,i=s.transaction(jo,"readonly"),a=i.objectStore(jo).getAll();a.onsuccess=()=>{const l={};for(const u of a.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},a.onerror=l=>(s.close(),t(a.error)),i.oncomplete=()=>s.close()},r.onerror=s=>t(r.error)})}async removeModel(e){return e=IG(e),new Promise((t,r)=>{const s=this.indexedDB.open(a1,l1);s.onupgradeneeded=()=>u1(s),s.onsuccess=()=>{const i=s.result,o=i.transaction(jo,"readwrite"),a=o.objectStore(jo),l=a.get(e);let u;l.onsuccess=()=>{if(l.result==null)return i.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=a.delete(e),h=()=>{u=i.transaction(Ka,"readwrite");const f=u.objectStore(Ka).delete(e);f.onsuccess=()=>t(l.result.modelArtifactsInfo),f.onerror=p=>r(l.error)};c.onsuccess=h,c.onerror=d=>(h(),i.close(),r(l.error))}},l.onerror=c=>(i.close(),r(l.error)),o.oncomplete=()=>{u==null?i.close():u.oncomplete=()=>i.close()}},s.onerror=i=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oo="/",ou="tensorflowjs_models",vA="info",_G="model_topology",NG="weight_specs",$G="weight_data",DG="model_metadata";function yA(n){return{info:[ou,n,vA].join(oo),topology:[ou,n,_G].join(oo),weightSpecs:[ou,n,NG].join(oo),weightData:[ou,n,$G].join(oo),modelMetadata:[ou,n,DG].join(oo)}}function xA(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function AG(n){const e=n.split(oo);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(oo)}function RG(n){return n.startsWith(pl.URL_SCHEME)?n.slice(pl.URL_SCHEME.length):n}class pl{constructor(e){if(!me().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=yA(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=Xb(e),i=Sa.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,dG(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:s}}catch{throw xA(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=s;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);t.format=a.format,t.generatedBy=a.generatedBy,t.convertedBy=a.convertedBy,a.signature!=null&&(t.signature=a.signature),a.userDefinedMetadata!=null&&(t.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(t.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(t.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(t.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=fG(o),t}}pl.URL_SCHEME="localstorage://";const wA=n=>me().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(pl.URL_SCHEME)?OG(n.slice(pl.URL_SCHEME.length)):null;qn.registerSaveRouter(wA);qn.registerLoadRouter(wA);function OG(n){return new pl(n)}class FG{constructor(){O(me().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),O(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=ou+oo,r=oo+vA;for(let s=0;s<this.LS.length;++s){const i=this.LS.key(s);if(i.startsWith(t)&&i.endsWith(r)){const o=AG(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=RG(e);const t=yA(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(t.info));return xA(t),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GE="://";class $i{constructor(){this.managers={}}static getInstance(){return $i.instance==null&&($i.instance=new $i),$i.instance}static registerManager(e,t){O(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(GE)&&(e=e.slice(0,e.indexOf(GE))),O(e.length>0,()=>"scheme must not be an empty string.");const r=$i.getInstance();O(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=t}static getManager(e){const t=$i.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys($i.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LG{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!me().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return YD(e)}}if(me().get("IS_BROWSER")){me().setPlatform("browser",new LG);try{$i.registerManager(pl.URL_SCHEME,new FG)}catch{}try{$i.registerManager(fl.URL_SCHEME,new TG)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PG={importFetch:()=>require("node-fetch")};let Ty;class MG{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return me().global.fetch!=null?me().global.fetch(e,t):(Ty==null&&(Ty=PG.importFetch()),Ty(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}me().get("IS_NODE")&&!me().get("IS_BROWSER")&&me().setPlatform("node",new MG);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pt(n,e="float32",t){return e=e||"float32",Io(n),new ir(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BG(n,e){const t=H(n,"x","cast");if(!S5(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:t},s={dtype:e};return te.runKernel(Ld,r,s)}const Ve=le({cast_:BG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zG(n){const t={x:H(n,"x","clone","string_or_numeric")};return te.runKernel(Xd,t)}const Qa=le({clone_:zG});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UG(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */cA();const VG={buffer:pt,cast:Ve,clone:Qa,print:UG};tG(VG);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ni(){return te}function c1(){return te.memory()}function pe(n,e){return te.tidy(n,e)}function ft(n){lA(n).forEach(t=>t.dispose())}function Wi(n){return te.keep(n)}function bA(n,e,t=1){return te.registerBackend(n,e,t)}function WG(){return te.backend}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GG(n,e){let t=H(n,"a","add"),r=H(e,"b","add");[t,r]=xn(t,r);const s={a:t,b:r};return te.runKernel(pc,s)}const De=le({add_:GG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jG(n,e){let t=H(n,"a","floorDiv"),r=H(e,"b","floorDiv");[t,r]=xn(t,r);const s={a:t,b:r};return te.runKernel(qd,s)}const CA=le({floorDiv_:jG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HG(n,e){let t=H(n,"a","div"),r=H(e,"b","div");if([t,r]=xn(t,r),t.dtype==="int32"&&r.dtype==="int32")return CA(t,r);const s={a:t,b:r},i={};return te.runKernel(Ud,s,i)}const nt=le({div_:HG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qG(n,e){let t=H(n,"a","mul"),r=H(e,"b","mul");[t,r]=xn(t,r);const s={a:t,b:r};return te.runKernel(sf,s)}const ee=le({mul_:qG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KG(n){const e=H(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return te.runKernel(o0,t)}else{const t={x:e};return te.runKernel(Jg,t)}}const br=le({abs_:KG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XG(n){const t={x:H(n,"x","acos")};return te.runKernel(Nd,t)}const YG=le({acos_:XG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZG(n){const t={x:H(n,"x","acosh")};return te.runKernel($d,t)}const QG=le({acosh_:ZG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JG(n,e=null,t=!1){const s={x:H(n,"x","all","bool")},i={axis:e,keepDims:t};return te.runKernel(ob,s,i)}const SA=le({all_:JG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ej(n,e=null,t=!1){const s={x:H(n,"x","any","bool")},i={axis:e,keepDims:t};return te.runKernel(ab,s,i)}const h1=le({any_:ej});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tj(n,e=0){const r={x:H(n,"x","argMax")},s={axis:e};return te.runKernel(e0,r,s)}const qh=le({argMax_:tj});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nj(n,e=0){const r={x:H(n,"x","argMin")},s={axis:e};return te.runKernel(t0,r,s)}const rj=le({argMin_:nj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sj(n){const t={x:H(n,"x","asin")};return te.runKernel(Dd,t)}const ij=le({asin_:sj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oj(n){const t={x:H(n,"x","asinh")};return te.runKernel(Ad,t)}const aj=le({asinh_:oj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lj(n){const t={x:H(n,"x","atan")};return te.runKernel(Rd,t)}const uj=le({atan_:lj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cj(n,e){let t=H(n,"a","atan2"),r=H(e,"b","atan2");[t,r]=xn(t,r);const s={a:t,b:r};return te.runKernel(Fd,s)}const hj=le({atan2_:cj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dj(n){const t={x:H(n,"x","atanh")};return te.runKernel(Od,t)}const fj=le({atanh_:dj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ef(n,e,t,r,s="NHWC",i){const o=n[3],a=[...e,o],l=_o(s);return ar(n,a,t,i,r,null,null,l)}function Ks(n,e,t,r,s,i,o="channelsLast"){const[a,l]=Kh(e);let u;if(o==="channelsLast")u=[a,l,n[3],n[3]];else if(o==="channelsFirst")u=[a,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${o}`);return ar(n,u,t,r,s,i,!1,o)}function To(n,e,t,r,s,i,o="NDHWC"){const[a,l,u]=d1(e);let c,h;if(o==="NDHWC")h="channelsLast",c=[a,l,u,n[4],n[4]];else if(o==="NCDHW")h="channelsFirst",c=[a,l,u,n[1],n[1]];else throw new Error(`Unknown dataFormat ${o}`);return ka(n,c,t,r,s,!1,h,i)}function ar(n,e,t,r,s,i,o=!1,a="channelsLast"){let[l,u,c,h]=[-1,-1,-1,-1];if(a==="channelsLast")[l,u,c,h]=n;else if(a==="channelsFirst")[l,h,u,c]=n;else throw new Error(`Unknown dataFormat ${a}`);const[d,f,,p]=e,[v,g]=Kh(t),[m,y]=Kh(r),w=Au(d,m),x=Au(f,y),{padInfo:b,outHeight:C,outWidth:k}=gj(s,u,c,v,g,w,x,i,a),E=o?p*h:p;let T;return a==="channelsFirst"?T=[l,E,C,k]:a==="channelsLast"&&(T=[l,C,k,E]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:c,inChannels:h,outHeight:C,outWidth:k,outChannels:E,padInfo:b,strideHeight:v,strideWidth:g,filterHeight:d,filterWidth:f,effectiveFilterHeight:w,effectiveFilterWidth:x,dilationHeight:m,dilationWidth:y,inShape:n,outShape:T,filterShape:e}}function ka(n,e,t,r,s,i=!1,o="channelsLast",a){let[l,u,c,h,d]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,u,c,h,d]=n;else if(o==="channelsFirst")[l,d,u,c,h]=n;else throw new Error(`Unknown dataFormat ${o}`);const[f,p,v,,g]=e,[m,y,w]=d1(t),[x,b,C]=d1(r),k=Au(f,x),E=Au(p,b),T=Au(v,C),{padInfo:_,outDepth:A,outHeight:P,outWidth:j}=vj(s,u,c,h,m,y,w,k,E,T,a),X=i?g*d:g;let F;return o==="channelsFirst"?F=[l,X,A,P,j]:o==="channelsLast"&&(F=[l,A,P,j,X]),{batchSize:l,dataFormat:o,inDepth:u,inHeight:c,inWidth:h,inChannels:d,outDepth:A,outHeight:P,outWidth:j,outChannels:X,padInfo:_,strideDepth:m,strideHeight:y,strideWidth:w,filterDepth:f,filterHeight:p,filterWidth:v,effectiveFilterDepth:k,effectiveFilterHeight:E,effectiveFilterWidth:T,dilationDepth:x,dilationHeight:b,dilationWidth:C,inShape:n,outShape:F,filterShape:e}}function pj(n,e,t,r,s){r==null&&(r=Yb(n,e,t));const i=n[0],o=n[1],a=Xh((i-e+2*r)/t+1,s),l=Xh((o-e+2*r)/t+1,s);return[a,l]}function mj(n,e,t,r,s,i){s==null&&(s=Yb(n,e[0],r[0]));const o=[0,0,0,t];for(let a=0;a<3;a++)n[a]+2*s>=e[a]&&(o[a]=Xh((n[a]-e[a]+2*s)/r[a]+1,i));return o}function Yb(n,e,t,r=1){const s=Au(e,r);return Math.floor((n[0]*(t-1)-t+s)/2)}function Kh(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function d1(n){return typeof n=="number"?[n,n,n]:n}function Au(n,e){return e<=1?n:n+(n-1)*(e-1)}function gj(n,e,t,r,s,i,o,a,l){let u,c,h;if(typeof n=="number"){u={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const f=pj([e,t],i,r,n,a);c=f[0],h=f[1]}else if(n==="same"){c=Math.ceil(e/r),h=Math.ceil(t/s);const d=Math.max(0,(c-1)*r+i-e),f=Math.max(0,(h-1)*s+o-t),p=Math.floor(d/2),v=d-p,g=Math.floor(f/2),m=f-g;u={top:p,bottom:v,left:g,right:m,type:"SAME"}}else if(n==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-i+1)/r),h=Math.ceil((t-o+1)/s);else if(typeof n=="object"){const d=l==="channelsLast"?n[1][0]:n[2][0],f=l==="channelsLast"?n[1][1]:n[2][1],p=l==="channelsLast"?n[2][0]:n[3][0],v=l==="channelsLast"?n[2][1]:n[3][1];u={top:d,bottom:f,left:p,right:v,type:d===0&&f===0&&p===0&&v===0?"VALID":"EXPLICIT"},c=Xh((e-i+d+f)/r+1,a),h=Xh((t-o+p+v)/s+1,a)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:u,outHeight:c,outWidth:h}}function vj(n,e,t,r,s,i,o,a,l,u,c){let h,d,f,p;if(n==="valid"&&(n=0),typeof n=="number"){h={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const g=mj([e,t,r,1],[a,l,u],1,[s,i,o],n,c);d=g[0],f=g[1],p=g[2]}else if(n==="same"){d=Math.ceil(e/s),f=Math.ceil(t/i),p=Math.ceil(r/o);const v=(d-1)*s+a-e,g=(f-1)*i+l-t,m=(p-1)*o+u-r,y=Math.floor(v/2),w=v-y,x=Math.floor(g/2),b=g-x,C=Math.floor(m/2),k=m-C;h={top:x,bottom:b,left:C,right:k,front:y,back:w,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:h,outDepth:d,outHeight:f,outWidth:p}}function Xh(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function ml(n){const[e,t,r]=Kh(n);return e===1&&t===1&&r===1}function gr(n,e){return ml(n)||ml(e)}function gl(n){return Kh(n).every(e=>e>0)}function _o(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function Gr(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")O(ju(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{O(ju(s),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${s}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yj(n,e){const r={x:H(n,"x","reshape","string_or_numeric")},s={shape:e};return te.runKernel(z0,r,s)}const ae=le({reshape_:yj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xj(n,e,t,r,s){const i=H(n,"x","avgPool","float32"),o=1;O(gr(t,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=ae(i,[1,i.shape[0],i.shape[1],i.shape[2]])),O(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Gr("avgPool",r,s);const u={x:a},c={filterSize:e,strides:t,pad:r,dimRoundingMode:s};let h=te.runKernel(n0,u,c);return h=Ve(h,i.dtype),l?ae(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Zb=le({avgPool_:xj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wj(n,e,t,r,s,i="NDHWC"){const o=H(n,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=ae(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),O(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),O(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),O(typeof t=="number"&&t>0||Array.isArray(t)&&t[0]>0&&t[1]>0&&t[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${t}'`),Gr("avgPool3d",r,s);const u={x:a},c={filterSize:e,strides:t,pad:r,dimRoundingMode:s,dataFormat:i};let h=te.runKernel(r0,u,c);return h=Ve(h,a.dtype),l?ae(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const bj=le({avgPool3d_:wj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cj(n,e=0){O(n.length>=1,()=>"Pass at least one tensor to concat");const t=pA(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),t.length===1)return Qa(t[0]);const r=t,s={axis:e};return te.runKernel(a0,r,s)}const Mr=le({concat_:Cj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sj(n,e,t=!1,r=!1){let s=H(n,"a","matMul"),i=H(e,"b","matMul");[s,i]=xn(s,i);const o={a:s,b:i},a={transposeA:t,transposeB:r};return te.runKernel(s0,o,a)}const _t=le({matMul_:Sj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kj(n){const t={x:H(n,"x","sigmoid","float32")};return te.runKernel(gf,t)}const mc=le({sigmoid_:kj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ej(n,e,t){const r=H(n,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},i={begin:e,size:t};return te.runKernel(j0,s,i)}const qt=le({slice_:Ej});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ij(n){const t={x:H(n,"x","tanh","float32")};return te.runKernel(Cf,t)}const Qb=le({tanh_:Ij});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tj(n,e,t){const r=H(n,"x","batchToSpaceND"),s=e.reduce((a,l)=>a*l);O(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),O(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),O(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const i={x:r},o={blockShape:e,crops:t};return te.runKernel(i0,i,o)}const Jb=le({batchToSpaceND_:Tj});function _j(n){let e;return n.rank===0||n.rank===1?e=ae(n,[1,1,1,n.size]):n.rank===2?e=ae(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=ae(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nj(n,e,t,r,s,i){i==null&&(i=.001);const o=H(n,"x","batchNorm"),a=H(e,"mean","batchNorm"),l=H(t,"variance","batchNorm");let u;s!=null&&(u=H(s,"scale","batchNorm"));let c;r!=null&&(c=H(r,"offset","batchNorm")),O(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),O(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),O(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:_j(o),scale:u,offset:c,mean:a,variance:l},f={varianceEpsilon:i},p=te.runKernel(g0,d,f);return ae(p,o.shape)}const nv=le({batchNorm_:Nj});function $j(n,e,t,r,s,i){const o=H(n,"x","batchNorm"),a=H(e,"mean","batchNorm"),l=H(t,"variance","batchNorm");let u;s!=null&&(u=H(s,"scale","batchNorm"));let c;return r!=null&&(c=H(r,"offset","batchNorm")),O(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),O(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),O(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&O(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&O(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),nv(o,a,l,c,u,i)}const Dj=le({batchNorm2d_:$j});function Aj(n,e,t,r,s,i){const o=H(n,"x","batchNorm"),a=H(e,"mean","batchNorm"),l=H(t,"variance","batchNorm");let u;s!=null&&(u=H(s,"scale","batchNorm"));let c;return r!=null&&(c=H(r,"offset","batchNorm")),O(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),O(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),O(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&O(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&O(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),nv(o,a,l,c,u,i)}const Rj=le({batchNorm3d_:Aj});function Oj(n,e,t,r,s,i){const o=H(n,"x","batchNorm"),a=H(e,"mean","batchNorm"),l=H(t,"variance","batchNorm");let u;s!=null&&(u=H(s,"scale","batchNorm"));let c;return r!=null&&(c=H(r,"offset","batchNorm")),O(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),O(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),O(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&O(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&O(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),nv(o,a,l,c,u,i)}const Fj=le({batchNorm4d_:Oj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lj(n,e,t){const r=H(n,"x","bincount"),s=H(e,"weights","bincount");O(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),O(t>=0,()=>`size must be non-negative, but got ${t}.`),O(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const i={x:r,weights:s},o={size:t};return te.runKernel(cb,i,o)}const Pj=le({bincount_:Lj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mj(n,e){let t=H(n,"broadcastTo","x");const r=t.shape;if(Io(e),e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const u=t.shape.slice();for(;u.length<e.length;)u.unshift(1);t=ae(t,u)}const s=t.shape,i=Array.from(e);for(let u=e.length-1;u>=0;u--)if(s[u]===e[u])i[u]=1;else if(t.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(i.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return Qa(t);const a={x:t},l={reps:i};return te.runKernel(Sf,a,l)}const Sh=le({broadcastTo_:Mj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bj(n){const t={x:H(n,"x","ceil","float32")};return te.runKernel(Pd,t)}const zj=le({ceil_:Bj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rv(n,e,t){Io(n),t=t||dc(e);const r={shape:n,value:e,dtype:t};return te.runKernel(Eb,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uj(n,e,t){const r=H(n,"x","clipByValue");if(O(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return rv(r.shape,e,r.dtype);const s={x:r},i={clipValueMin:e,clipValueMax:t};return te.runKernel(Md,s,i)}const xs=le({clipByValue_:Uj});function Vj(n){return Mr(n,0)}const Wj=le({concat1d_:Vj});function Gj(n,e){return Mr(n,e)}const jj=le({concat2d_:Gj});function Hj(n,e){return Mr(n,e)}const qj=le({concat3d_:Hj});function Kj(n,e){return Mr(n,e)}const Xj=le({concat4d_:Kj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yj(n,e,t,r,s="NHWC",i=[1,1],o){const a=H(n,"x","conv2d","float32"),l=H(e,"filter","conv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=ae(a,[1,a.shape[0],a.shape[1],a.shape[2]])),O(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),O(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Gr("conv2d",r,o);const h=s==="NHWC"?u.shape[3]:u.shape[1];O(h===l.shape[2],()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${l.shape[2]}.`),O(gr(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),O(gl(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),O(gl(t),()=>"Error in conv2D: Strides should be larger than 0.");const d={x:u,filter:l},f={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},p=te.runKernel(l0,d,f);return c?ae(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const vl=le({conv2d_:Yj});function Zj(n,e,t,r,s="NWC",i=1,o){const a=H(n,"x","conv1d"),l=H(e,"filter","conv1d");let u=a,c=!1;a.rank===2&&(c=!0,u=ae(a,[1,a.shape[0],a.shape[1]])),O(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),O(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Gr("conv1d",r,o),O(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),O(gr(t,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${i}'`),O(gl(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),O(gl(t),()=>"Error in conv1D: Stride should be larger than 0."),O(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const h=ae(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=ae(u,[u.shape[0],1,u.shape[1],u.shape[2]]),g=vl(d,h,[1,t],r,"NHWC",[1,i],o);return c?ae(g,[g.shape[2],g.shape[3]]):ae(g,[g.shape[0],g.shape[2],g.shape[3]])}const kA=le({conv1d_:Zj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qj(n,e,t,r,s,i="NHWC",o){O(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let a=n,l=e,u=!1;e.rank===3&&(u=!0,l=ae(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,n[0],n[1],n[2]]),O(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),O(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),O(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const c=i==="NHWC"?a[3]:a[1],h=i==="NHWC"?l.shape[3]:l.shape[1];O(c===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${t.shape[2]}.`),O(h===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${t.shape[3]}.`),Gr("conv2dDerInput",s,o);const d={dy:l,filter:t},f={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,inputShape:a},p=te.runKernel(u0,d,f);return u?ae(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const e2=le({conv2DBackpropInput_:Qj});function Jj(n,e,t,r,s,i){const o=H(n,"x","conv2dTranspose"),a=H(e,"filter","conv2dTranspose");return e2(t,o,a,r,s,"NHWC",i)}const EA=le({conv2dTranspose_:Jj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eH(n,e,t,r,s="NDHWC",i=[1,1,1]){const o=H(n,"x","conv3d"),a=H(e,"filter","conv3d");let l=o,u=!1;o.rank===4&&(u=!0,l=ae(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),O(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),O(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),O(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),O(gr(t,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),O(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),O(gl(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),O(gl(t),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:a},h={strides:t,pad:r,dataFormat:s,dilations:i},d=te.runKernel(c0,c,h);return u?ae(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const tH=le({conv3d_:eH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nH(n,e,t,r,s){O(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let i=n,o=e,a=!1;e.rank===4&&(a=!0,o=ae(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,n[0],n[1],n[2],n[3]]);const l=i[4],u=o.shape[4];O(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),O(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),O(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),O(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),O(u===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${t.shape[4]}.`);const c={dy:o,filter:t},h={pad:s,strides:r,inputShape:i},d=te.runKernel(mb,c,h);return a?ae(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const IA=le({conv3DBackpropInput_:nH});function rH(n,e,t,r,s){const i=H(n,"x","conv3dTranspose"),o=H(e,"filter","conv3dTranspose");return IA(t,i,o,r,s)}const sH=le({conv3dTranspose_:rH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iH(n){const t={x:H(n,"x","cos","float32")};return te.runKernel(Bd,t)}const t2=le({cos_:iH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oH(n){const t={x:H(n,"x","cosh","float32")};return te.runKernel(zd,t)}const TA=le({cosh_:oH});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aH(n,e=0,t=!1,r=!1){const i={x:H(n,"x","cumprod")},o={axis:e,exclusive:t,reverse:r};return te.runKernel(gb,i,o)}const f1=le({cumprod_:aH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lH(n,e=0,t=!1,r=!1){const i={x:H(n,"x","cumsum")},o={axis:e,exclusive:t,reverse:r};return te.runKernel(h0,i,o)}const _A=le({cumsum_:lH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uH(n,e,t,r=!1){const s=H(n,"x","denseBincount"),i=H(e,"weights","denseBincount");O(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),O(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),O(t>=0,()=>`size must be non-negative, but got ${t}.`),O(i.size===s.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${i.shape}.`);const o={x:s,weights:i},a={size:t,binaryOutput:r};return te.runKernel(yb,o,a)}const jE=le({denseBincount_:uH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cH(n,e,t="NHWC"){const r=H(n,"x","depthToSpace","float32"),s=t==="NHWC"?r.shape[1]:r.shape[2],i=t==="NHWC"?r.shape[2]:r.shape[3],o=t==="NHWC"?r.shape[3]:r.shape[1];O(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),O(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),O(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${r.shape}`),O(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${r.shape}`);const a={x:r},l={blockSize:e,dataFormat:t};return te.runKernel(xb,a,l)}const hH=le({depthToSpace_:cH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dH(n,e,t,r,s="NHWC",i=[1,1],o){const a=H(n,"x","depthwiseConv2d","float32"),l=H(e,"filter","depthwiseConv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=ae(a,[1,a.shape[0],a.shape[1],a.shape[2]])),O(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),O(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const h=s==="NHWC"?u.shape[3]:u.shape[1];O(h===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${h}) must match the inChannels dimension in filter ${l.shape[2]}.`),Gr("depthwiseConv2d",r,o);const d={x:u,filter:l},f={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},p=te.runKernel(d0,d,f);return c?ae(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const n2=le({depthwiseConv2d_:dH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fH(n,e,t,r,s=[1,1],i="NHWC"){const o=H(n,"x","dilation2d"),a=H(e,"filter","dilation2d");O(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),O(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),O(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,u=!1;o.rank===3&&(l=ae(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=!0),O(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const c={x:l,filter:a},h={strides:t,pad:r,dilations:s},d=te.runKernel(f0,c,h);return u?ae(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const pH=le({dilation2d_:fH});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ku(n,e){const t=n.length,r=[];for(let s=0;s<t;s++){const i=t-1-s,o=n[i]||1;(e[e.length-1-s]||1)>1&&o===1&&r.unshift(i)}return r}function Gn(n,e){const t=[];for(let r=0;r<e.length;r++){const s=n[n.length-r-1],i=e.length-r-1,o=e[i];(s==null||s===1&&o>1)&&t.unshift(i)}return t}function ut(n,e){const t=Math.max(n.length,e.length),r=new Array(t);for(let s=0;s<t;s++){let i=n[n.length-s-1];i==null&&(i=1);let o=e[e.length-s-1];if(o==null&&(o=1),i===1)r[t-s-1]=o;else if(o===1)r[t-s-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(a)}else r[t-s-1]=i}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mH(n,e){let t=H(n,"a","equal","string_or_numeric"),r=H(e,"b","equal","string_or_numeric");[t,r]=xn(t,r),ut(t.shape,r.shape);const s={a:t,b:r};return te.runKernel(p0,s)}const Ki=le({equal_:mH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gH(n,e,t){const r=H(e,"a","where"),s=H(t,"b","where"),i=H(n,"condition","where","bool"),o=ut(ut(i.shape,r.shape),s.shape),a=Sh(i,o),l=Sh(r,o),u=Sh(s,o),c={condition:a,t:l,e:u};return te.runKernel(G0,c)}const Er=le({where_:gH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vH(n){const t={x:H(n,"x","zerosLike")};return te.runKernel(Q0,t)}const Ct=le({zerosLike_:vH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yH(n,e){let t=H(n,"a","div"),r=H(e,"b","div");[t,r]=xn(t,r);const s=nt(t,r),i=Ct(s),o=Ki(r,i);return Er(o,i,s)}const xH=le({divNoNan_:yH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wH(n,e){const t=H(n,"t1","dot"),r=H(e,"t2","dot");O((t.rank===1||t.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${r.rank}.`);const s=t.rank===1?t.size:t.shape[1],i=r.rank===1?r.size:r.shape[0];if(O(s===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${i}.`),t.rank===1&&r.rank===1){const o=ae(t,[1,-1]),a=ae(r,[-1,1]),l=_t(o,a);return ae(l,[])}else if(t.rank===1&&r.rank===2){const o=ae(t,[1,-1]),a=ae(r,[r.shape[0],r.shape[1]]),l=_t(o,a);return ae(l,[l.size])}else if(t.rank===2&&r.rank===1){const o=ae(r,[-1,1]),a=_t(t,o);return ae(a,[a.size])}else{const o=ae(r,[r.shape[0],r.shape[1]]);return _t(t,o)}}const bH=le({dot_:wH});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CH(n,...e){const t=e.map((s,i)=>H(s,`tensors${i}`,"einsum")),r={equation:n};return te.runKernel(Cb,t,r)}const Zc=le({einsum_:CH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SH(n){const t={x:H(n,"x","elu","float32")};return te.runKernel(Vd,t)}const sv=le({elu_:SH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kH(n){let e=H(n,"x","erf");O(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Ve(e,"float32"));const t={x:e};return te.runKernel(Wd,t)}const EH=le({erf_:kH});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r2(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function NA(n,e,t){const r=n.length+e.length,s=[];let i=0,o=0;for(let a=0;a<r;a++)t.indexOf(a)===-1?s.push(n[i++]):s.push(e[o++]);return s}function Jn(n,e){const t=[],r=n.length;for(let i=0;i<r;i++)e.indexOf(i)===-1&&t.push(n[i]);const s=e.map(i=>n[i]);return[t,s]}function Rn(n,e){const t=e.map(r=>1);return NA(n,t,e)}function lr(n,e,t){O(r2(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function un(n,e){if(r2(n,e))return null;const t=[];for(let r=0;r<e;++r)n.indexOf(r)===-1&&t.push(r);return n.forEach(r=>t.push(r)),t}function Ea(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function wn(n,e){const t=[];for(let r=e-n;r<e;++r)t.push(r);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IH(n,e=null,t=!1){const s={x:H(n,"x","max")},i={reductionIndices:e,keepDims:t};return te.runKernel(I0,s,i)}const pi=le({max_:IH});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TH(n,e=null,t=!1){const s={x:H(n,"x","min")},i={axis:e,keepDims:t};return te.runKernel($0,s,i)}const Lm=le({min_:TH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _H(n,e){let t=H(n,"base","pow"),r=H(e,"exp","pow");[t,r]=xn(t,r);const s={a:t,b:r};return te.runKernel(of,s)}const Xu=le({pow_:_H});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function At(n,e){if((Hs(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Hs(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return tv(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NH(n){const t={x:H(n,"x","sqrt","float32")};return te.runKernel(yf,t)}const Tr=le({sqrt_:NH});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $H(n){const e=H(n,"x","square"),t={};return te.runKernel("Square",{x:e},t)}const Jt=le({square_:$H});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DH(n,e=null,t=!1){let r=H(n,"x","sum");r.dtype==="bool"&&(r=Ve(r,"int32"));const s={x:r},i={axis:e,keepDims:t};return te.runKernel(H0,s,i)}const et=le({sum_:DH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AH(n,e="euclidean",t=null,r=!1){n=H(n,"x","norm");const s=$A(n,e,t);let i=s.shape;if(r){const o=mt(t,n.shape);i=Rn(s.shape,o)}return ae(s,i)}function $A(n,e,t=null){if(n.rank===0)return br(n);if(n.rank!==1&&t===null)return $A(ae(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return et(br(n),t);if(e===1/0)return pi(br(n),t);if(e===-1/0)return Lm(br(n),t);if(e==="euclidean"||e===2)return Tr(et(Xu(br(n),At(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return pi(et(br(n),t[0]),t[1]-1);if(e===1/0)return pi(et(br(n),t[1]),t[0]);if(e===-1/0)return Lm(et(br(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return Tr(et(Jt(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const iv=le({norm_:AH});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RH(n,e=null,t=!1){return iv(n,"euclidean",e,t)}const OH=le({euclideanNorm_:RH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FH(n){const t={x:H(n,"x","exp")};return te.runKernel(Gd,t)}const xo=le({exp_:FH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LH(n,e=0){const t=H(n,"x","expandDims","string_or_numeric");O(e<=t.rank,()=>"Axis must be <= rank of the tensor");const r={input:t},s={dim:e};return te.runKernel(m0,r,s)}const Fr=le({expandDims_:LH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PH(n){const t={x:H(n,"x","expm1")};return te.runKernel(jd,t)}const MH=le({expm1_:PH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BH(n,e){const t=H(n,"x","tile","string_or_numeric");O(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const r={x:t},s={reps:e};return te.runKernel(Sf,r,s)}const ui=le({tile_:BH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zH(n,e,t,r="float32"){e==null&&(e=n);const s=pt([n,e],r),i=n<=e?n:e;for(let a=0;a<i;++a)s.set(1,a,a);const o=ae(s.toTensor(),[n,e]);if(t==null)return o;if(t.length===1)return ui(Fr(o,0),[t[0],1,1]);if(t.length===2)return ui(Fr(Fr(o,0),0),[t[0],t[1],1,1]);if(t.length===3)return ui(Fr(Fr(Fr(o,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const DA=le({eye_:zH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UH(n){const t={x:H(n,"x","floor","float32")};return te.runKernel(Hd,t)}const ov=le({floor_:UH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VH(n,e,t=0,r=0){const s=H(n,"x","gather"),i=H(e,"indices","gather","int32"),o={x:s,indices:i},a={axis:t,batchDims:r};return te.runKernel(v0,o,a)}const s2=le({gather_:VH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WH(n,e){let t=H(n,"a","greater","string_or_numeric"),r=H(e,"b","greater","string_or_numeric");[t,r]=xn(t,r),ut(t.shape,r.shape);const s={a:t,b:r};return te.runKernel(y0,s)}const Cs=le({greater_:WH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GH(n,e){let t=H(n,"a","greaterEqual","string_or_numeric"),r=H(e,"b","greaterEqual","string_or_numeric");[t,r]=xn(t,r),ut(t.shape,r.shape);const s={a:t,b:r};return te.runKernel(Kd,s)}const Rl=le({greaterEqual_:GH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jH(n){const t={input:H(n,"input","imag")};return te.runKernel(_b,t)}const i2=le({imag_:jH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HH(n){const t={x:H(n,"x","isFinite")};return te.runKernel(Yd,t)}const qH=le({isFinite_:HH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KH(n){const t={x:H(n,"x","isInf")};return te.runKernel(Zd,t)}const XH=le({isInf_:KH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YH(n){const t={x:H(n,"x","isNaN")};return te.runKernel(Qd,t)}const ZH=le({isNaN_:YH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QH(n,e=.2){const r={x:H(n,"x","leakyRelu")},s={alpha:e};return te.runKernel(x0,r,s)}const o2=le({leakyRelu_:QH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JH(n,e){let t=H(n,"a","less","string_or_numeric"),r=H(e,"b","less","string_or_numeric");[t,r]=xn(t,r),ut(t.shape,r.shape);const s={a:t,b:r};return te.runKernel(w0,s)}const Pm=le({less_:JH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eq(n,e){let t=H(n,"a","lessEqual","string_or_numeric"),r=H(e,"b","lessEqual","string_or_numeric");[t,r]=xn(t,r),ut(t.shape,r.shape);const s={a:t,b:r};return te.runKernel(b0,s)}const gc=le({lessEqual_:eq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tq(n,e=5,t=1,r=1,s=.5){const i=H(n,"x","localResponseNormalization");O(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),O(ju(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=ae(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},u={depthRadius:e,bias:t,alpha:r,beta:s},c=te.runKernel(E0,l,u);return a?ae(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const nq=le({localResponseNormalization_:tq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rq(n){const t={x:H(n,"x","log","float32")};return te.runKernel(Jd,t)}const Xi=le({log_:rq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sq(n){const t={x:H(n,"x","log1p")};return te.runKernel(ef,t)}const AA=le({log1p_:sq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iq(n,e){O(Yx(n),()=>"The f passed in variableGrads(f) must be a function"),O(e==null||Array.isArray(e)&&e.every(u=>u instanceof Om),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const u in te.registeredVariables)e.push(te.registeredVariables[u])}const r=t?e.filter(u=>!u.trainable):null,s=e.length;e=e.filter(u=>u.trainable),O(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const i=!0,{value:o,grads:a}=te.gradients(n,e,null,i);O(a.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),O(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((u,c)=>{a[c]!=null&&(l[u.name]=a[c])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:o,grads:l}}function Yu(n){return te.customGrad(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oq(n){const t={x:H(n,"x","neg")};return te.runKernel(A0,t)}const yn=le({neg_:oq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aq(n){const t={x:H(n,"x","softplus")};return te.runKernel(vf,t)}const If=le({softplus_:aq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lq(n){const e=H(n,"x","logSigmoid");return Yu(r=>({value:yn(If(yn(r))),gradFunc:o=>ee(o,mc(yn(r)))}))(e)}const uq=le({logSigmoid_:lq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cq(n,e){let t=H(n,"a","sub"),r=H(e,"b","sub");[t,r]=xn(t,r);const s={a:t,b:r};return te.runKernel(wf,s)}const st=le({sub_:cq});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hq(n,e=-1){const t=H(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Yu((s,i)=>{const a=pi(s,e,!0),l=st(s,a),u=st(Ve(l,"float32"),Xi(et(xo(l),e,!0)));return i([u]),{value:u,gradFunc:(h,d)=>{const[f]=d,p=!0,v=xo(f);return st(h,ee(et(h,e,p),v))}}})(t)}const RA=le({logSoftmax_:hq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dq(n,e=null,t=!1){const r=H(n,"x","logSumExp"),s=mt(e,r.shape),i=pi(r,s,!0),o=st(r,i),a=xo(o),l=et(a,s),u=Xi(l),c=De(ae(i,u.shape),u);if(t){const h=Rn(c.shape,s);return ae(c,h)}return c}const fq=le({logSumExp_:dq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pq(n,e){const t=H(n,"a","logicalAnd","bool"),r=H(e,"b","logicalAnd","bool");ut(t.shape,r.shape);const s={a:t,b:r};return te.runKernel(C0,s)}const wo=le({logicalAnd_:pq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mq(n){const t={x:H(n,"x","logicalNot","bool")};return te.runKernel(S0,t)}const a2=le({logicalNot_:mq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gq(n,e){const t=H(n,"a","logicalOr","bool"),r=H(e,"b","logicalOr","bool");ut(t.shape,r.shape);const s={a:t,b:r};return te.runKernel(k0,s)}const OA=le({logicalOr_:gq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vq(n,e){const t=H(n,"a","logicalXor","bool"),r=H(e,"b","logicalXor","bool");return ut(t.shape,r.shape),wo(OA(n,e),a2(wo(n,e)))}const yq=le({logicalXor_:vq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xq(n,e,t,r,s){const i=H(n,"x","maxPool"),o=1;let a=i,l=!1;i.rank===3&&(l=!0,a=ae(i,[1,i.shape[0],i.shape[1],i.shape[2]])),O(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),O(gr(t,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),Gr("maxPool",r,s);const u={x:a},c={filterSize:e,strides:t,pad:r,dimRoundingMode:s},h=te.runKernel(T0,u,c);return l?ae(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const l2=le({maxPool_:xq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wq(n,e=[1,1,1],t,r,s,i="NDHWC"){const o=H(n,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=ae(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),O(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),O(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),Gr("maxPool3d",r,s);const u={x:a},c={filterSize:e,strides:t,pad:r,dimRoundingMode:s,dataFormat:i},h=te.runKernel(_0,u,c);return l?ae(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const bq=le({maxPool3d_:wq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cq(n,e){let t=H(n,"a","maximum"),r=H(e,"b","maximum");[t,r]=xn(t,r),t.dtype==="bool"&&(t=Ve(t,"int32"),r=Ve(r,"int32")),ut(t.shape,r.shape);const s={a:t,b:r};return te.runKernel(tf,s)}const Ia=le({maximum_:Cq});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sq(n,e=null,t=!1){const s={x:H(n,"x","mean")},i={axis:e,keepDims:t};return te.runKernel(N0,s,i)}const An=le({mean_:Sq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yn(n,e="float32"){if(Io(n),e==="complex64"){const r=Yn(n,"float32"),s=Yn(n,"float32");return dl(r,s)}const t=mr(we(n),e);return te.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ol(n,e="float32"){if(Io(n),e==="complex64"){const r=Ol(n,"float32"),s=Yn(n,"float32");return dl(r,s)}const t=nb(we(n),e);return te.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kq(n,e){let t=H(n,"a","minimum"),r=H(e,"b","minimum");[t,r]=xn(t,r),t.dtype==="bool"&&(t=Ve(t,"int32"),r=Ve(r,"int32")),ut(t.shape,r.shape);const s={a:t,b:r};return te.runKernel(nf,s)}const Yh=le({minimum_:kq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eq(n,e,t){O(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const r=H(n,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");O(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=t==="reflect"?1:0;for(let a=0;a<r.rank;a++)O(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),O(e[a][0]>=0&&e[a][0]<=r.shape[a]-s&&e[a][1]>=0&&e[a][1]<=r.shape[a]-s,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-s} or less than 0 for input of shape ${r.shape}`);const i={paddings:e,mode:t},o={x:r};return te.runKernel(D0,o,i)}const Iq=le({mirrorPad_:Eq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tq(n,e){let t=H(n,"a","mod"),r=H(e,"b","mod");[t,r]=xn(t,r);const s={a:t,b:r};return te.runKernel(rf,s)}const _q=le({mod_:Tq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nq(n,e=null,t=!1){n=H(n,"x","moments");const r=mt(e,n.shape),s=An(n,r,t);let i=s.shape;t||(i=Rn(s.shape,r));const o=Jt(st(Ve(n,"float32"),ae(s,i))),a=An(o,r,t);return{mean:s,variance:a}}const u2=le({moments_:Nq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $q(n,e){let t=H(n,"a","notEqual","string_or_numeric"),r=H(e,"b","notEqual","string_or_numeric");[t,r]=xn(t,r),ut(t.shape,r.shape);const s={a:t,b:r};return te.runKernel(R0,s)}const Mm=le({notEqual_:$q});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dq(n,e,t=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:H(n,"indices","oneHot","int32")},a={dtype:s,depth:e,onValue:t,offValue:r};return te.runKernel(F0,o,a)}const FA=le({oneHot_:Dq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aq(n){const t={x:H(n,"x","onesLike")};return te.runKernel(O0,t)}const qs=le({onesLike_:Aq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rq(n,e,t=0){const r=H(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:t},i={x:r};return te.runKernel(P0,i,s)}const c2=le({pad_:Rq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oq(n,e,t){const r=H(n,"x","spaceToBatchND");O(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),O(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),O(r.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+t[l-1][0]+t[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},i={blockShape:e,paddings:t};return te.runKernel(q0,s,i)}const h2=le({spaceToBatchND_:Oq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fq(n,e,t,r,s,i,o){s==null&&(s=[1,1]),i==null&&(i=1),r===0&&(r="valid");const a=H(n,"x","maxPool");let l=a,u=!1;a.rank===3&&(u=!0,l=ae(a,[1,a.shape[0],a.shape[1],a.shape[2]])),O(gr(i,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${s}'`);const c=Ks(l.shape,e,i,s,r),h=[c.dilationHeight,c.dilationWidth];let d;r==="same"?d=Pq([c.filterHeight,c.filterWidth],h):d=[[0,0],[0,0]];const f=h[0]===1&&h[1]===1,[p,v]=Lq([c.inHeight,c.inWidth],h,d),g=f?r:"valid",m=f?l:h2(l,h,p),w=(t==="avg"?()=>Zb(m,e,i,g,o):()=>l2(m,e,i,g,o))(),x=f?w:Jb(w,h,v);return u?ae(x,[x.shape[1],x.shape[2],x.shape[3]]):x}function Lq(n,e,t){const r=t.map(c=>c[0]),s=t.map(c=>c[1]),i=n.concat(r,s),o=e.map((c,h)=>(c-i[h]%c)%c),a=s.map((c,h)=>c+o[h]),l=e.map((c,h)=>[r[h],a[h]]),u=e.map((c,h)=>[0,o[h]]);return[l,u]}function Pq(n,e){const r=n.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),s=r.map(o=>Math.floor(o/2)),i=r.map((o,a)=>o-s[a]);return r.map((o,a)=>[s[a],i[a]])}const Mq=le({pool_:Fq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bq(n,e){const t=H(n,"x","prelu"),r=H(e,"alpha","prelu"),s={x:t,alpha:r};return te.runKernel(M0,s)}const d2=le({prelu_:Bq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zq(n,e=null,t=!1){let r=H(n,"x","prod");r.dtype==="bool"&&(r=Ve(r,"int32"));const s={x:r},i={axis:e,keepDims:t};return te.runKernel(B0,s,i)}const Uq=le({prod_:zq});var f2={exports:{}};f2.exports;(function(n){(function(e,t,r){function s(l){var u=this,c=a();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function i(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function o(l,u){var c=new s(l),h=u&&u.state,d=c.next;return d.int32=function(){return c.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&i(h,c),d.state=function(){return i(c,{})}),d}function a(){var l=4022871197,u=function(c){c=String(c);for(var h=0;h<c.length;h++){l+=c.charCodeAt(h);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return u}t&&t.exports?t.exports=o:r&&r.amd?r(function(){return o}):this.alea=o})(gn,n,!1)})(f2);var Vq=f2.exports,p2={exports:{}};p2.exports;(function(n){(function(e,t,r){function s(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var u=new s(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&i(c,u),h.state=function(){return i(u,{})}),h}t&&t.exports?t.exports=o:r&&r.amd?r(function(){return o}):this.xor128=o})(gn,n,!1)})(p2);var Wq=p2.exports,m2={exports:{}};m2.exports;(function(n){(function(e,t,r){function s(a){var l=this,u="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var u=new s(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&i(c,u),h.state=function(){return i(u,{})}),h}t&&t.exports?t.exports=o:r&&r.amd?r(function(){return o}):this.xorwow=o})(gn,n,!1)})(m2);var Gq=m2.exports,g2={exports:{}};g2.exports;(function(n){(function(e,t,r){function s(a){var l=this;l.next=function(){var c=l.x,h=l.i,d,f;return d=c[h],d^=d>>>7,f=d^d<<24,d=c[h+1&7],f^=d^d>>>10,d=c[h+3&7],f^=d^d>>>3,d=c[h+4&7],f^=d^d<<7,d=c[h+7&7],d=d^d<<13,f^=d^d<<9,c[h]=f,l.i=h+1&7,f};function u(c,h){var d,f=[];if(h===(h|0))f[0]=h;else for(h=""+h,d=0;d<h.length;++d)f[d&7]=f[d&7]<<15^h.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],c.x=f,c.i=0,d=256;d>0;--d)c.next()}u(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(c.x&&i(c,u),h.state=function(){return i(u,{})}),h}t&&t.exports?t.exports=o:r&&r.amd?r(function(){return o}):this.xorshift7=o})(gn,n,!1)})(g2);var jq=g2.exports,v2={exports:{}};v2.exports;(function(n){(function(e,t,r){function s(a){var l=this;l.next=function(){var c=l.w,h=l.X,d=l.i,f,p;return l.w=c=c+1640531527|0,p=h[d+34&127],f=h[d=d+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=h[d]=p^f,l.i=d,p+(c^c>>>16)|0};function u(c,h){var d,f,p,v,g,m=[],y=128;for(h===(h|0)?(f=h,h=null):(h=h+"\0",f=0,y=Math.max(y,h.length)),p=0,v=-32;v<y;++v)h&&(f^=h.charCodeAt((v+32)%h.length)),v===0&&(g=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,v>=0&&(g=g+1640531527|0,d=m[v&127]^=f+g,p=d==0?p+1:0);for(p>=128&&(m[(h&&h.length||0)&127]=-1),p=127,v=4*128;v>0;--v)f=m[p+34&127],d=m[p=p+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,m[p]=f^d;c.w=g,c.X=m,c.i=p}u(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(c.X&&i(c,u),h.state=function(){return i(u,{})}),h}t&&t.exports?t.exports=o:r&&r.amd?r(function(){return o}):this.xor4096=o})(gn,n,!1)})(v2);var Hq=v2.exports,y2={exports:{}};y2.exports;(function(n){(function(e,t,r){function s(a){var l=this,u="";l.next=function(){var h=l.b,d=l.c,f=l.d,p=l.a;return h=h<<25^h>>>7^d,d=d-f|0,f=f<<24^f>>>8^p,p=p-h|0,l.b=h=h<<20^h>>>12^d,l.c=d=d-f|0,l.d=f<<16^d>>>16^p,l.a=p-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var u=new s(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&i(c,u),h.state=function(){return i(u,{})}),h}t&&t.exports?t.exports=o:r&&r.amd?r(function(){return o}):this.tychei=o})(gn,n,!1)})(y2);var qq=y2.exports,LA={exports:{}};const Kq={},Xq=Object.freeze(Object.defineProperty({__proto__:null,default:Kq},Symbol.toStringTag,{value:"Module"})),Yq=hT(Xq);(function(n){(function(e,t,r){var s=256,i=6,o=52,a="random",l=r.pow(s,i),u=r.pow(2,o),c=u*2,h=s-1,d;function f(x,b,C){var k=[];b=b==!0?{entropy:!0}:b||{};var E=m(g(b.entropy?[x,w(t)]:x??y(),3),k),T=new p(k),_=function(){for(var A=T.g(i),P=l,j=0;A<u;)A=(A+j)*s,P*=s,j=T.g(1);for(;A>=c;)A/=2,P/=2,j>>>=1;return(A+j)/P};return _.int32=function(){return T.g(4)|0},_.quick=function(){return T.g(4)/4294967296},_.double=_,m(w(T.S),t),(b.pass||C||function(A,P,j,X){return X&&(X.S&&v(X,T),A.state=function(){return v(T,{})}),j?(r[a]=A,P):A})(_,E,"global"in b?b.global:this==r,b.state)}function p(x){var b,C=x.length,k=this,E=0,T=k.i=k.j=0,_=k.S=[];for(C||(x=[C++]);E<s;)_[E]=E++;for(E=0;E<s;E++)_[E]=_[T=h&T+x[E%C]+(b=_[E])],_[T]=b;(k.g=function(A){for(var P,j=0,X=k.i,F=k.j,M=k.S;A--;)P=M[X=h&X+1],j=j*s+M[h&(M[X]=M[F=h&F+P])+(M[F]=P)];return k.i=X,k.j=F,j})(s)}function v(x,b){return b.i=x.i,b.j=x.j,b.S=x.S.slice(),b}function g(x,b){var C=[],k=typeof x,E;if(b&&k=="object")for(E in x)try{C.push(g(x[E],b-1))}catch{}return C.length?C:k=="string"?x:x+"\0"}function m(x,b){for(var C=x+"",k,E=0;E<C.length;)b[h&E]=h&(k^=b[h&E]*19)+C.charCodeAt(E++);return w(b)}function y(){try{var x;return d&&(x=d.randomBytes)?x=x(s):(x=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(x)),w(x)}catch{var b=e.navigator,C=b&&b.plugins;return[+new Date,e,C,e.screen,w(t)]}}function w(x){return String.fromCharCode.apply(0,x)}if(m(r.random(),t),n.exports){n.exports=f;try{d=Yq}catch{}}else r["seed"+a]=f})(typeof self<"u"?self:gn,[],Math)})(LA);var Zq=LA.exports,Qq=Vq,Jq=Wq,e9=Gq,t9=jq,n9=Hq,r9=qq,Fl=Zq;Fl.alea=Qq;Fl.xor128=Jq;Fl.xorwow=e9;Fl.xorshift7=t9;Fl.xor4096=n9;Fl.tychei=r9;var x2=Fl;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PA{constructor(e,t,r,s,i){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=x2.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,t,r=!1;for(;!r;){let s,i,o;do s=2*this.random()-1,i=2*this.random()-1,o=s*s+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*s*a,t=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class s9{constructor(e=0,t=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=x2.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i9(n,e=0,t=1,r,s){if(Io(n),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const i=new PA(e,t,r,!1,s),o=pt(n,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const o9=le({randomNormal_:i9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a9(n,e=0,t=1,r="float32",s){Io(n);const i=pt(n,r),o=new s9(e,t,null,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Tf=le({randomUniform_:a9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zh(n,e,t=1,r="float32"){if(t===0)throw new Error("Cannot have a step of zero");const s={start:n,stop:e,step:t,dtype:r};return te.runKernel(Fb,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l9(n){const t={input:H(n,"input","real")};return te.runKernel(Lb,t)}const Bm=le({real_:l9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u9(n){const t={x:H(n,"x","reciprocal")};return te.runKernel(af,t)}const c9=le({reciprocal_:u9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h9(n){const t={x:H(n,"x","relu")};return te.runKernel(lf,t)}const Ll=le({relu_:h9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d9(n){const t={x:H(n,"x","relu6")};return te.runKernel(uf,t)}const MA=le({relu6_:d9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f9(n,e){const r={x:H(n,"x","reverse")},s={dims:e};return te.runKernel(W0,r,s)}const yl=le({reverse_:f9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p9(n){const t={x:H(n,"x","round")};return te.runKernel(cf,t)}const BA=le({round_:p9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m9(n){const t={x:H(n,"x","rsqrt","float32")};return te.runKernel(hf,t)}const zA=le({rsqrt_:m9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g9(n){const t={x:H(n,"x","selu")};return te.runKernel(df,t)}const UA=le({selu_:g9});function v9(n,e,t,r,s,i=[1,1],o="NHWC"){const a=H(n,"x","separableConv2d"),l=H(e,"depthwiseFilter","separableConv2d"),u=H(t,"pointwiseFilter","separableConv2d");let c=a,h=!1;if(a.rank===3&&(h=!0,c=ae(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");O(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),O(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),O(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),O(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),O(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const d=l.shape[2],f=l.shape[3];O(u.shape[2]===d*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*f}, but got ${u.shape[2]}.`);const p=n2(c,l,r,s,o,i),g=vl(p,u,1,"valid",o);return h?ae(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const VA=le({separableConv2d_:v9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y9(n){const t={x:H(n,"x","sign")};return te.runKernel(mf,t)}const x9=le({sign_:y9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w9(n){const t={x:H(n,"x","sin","float32")};return te.runKernel(ff,t)}const WA=le({sin_:w9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b9(n){const t={x:H(n,"x","sinh")};return te.runKernel(pf,t)}const GA=le({sinh_:b9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C9(n,e,t){const r=H(n,"x","slice1d");return O(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),qt(r,[e],[t])}const w2=le({slice1d_:C9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S9(n,e,t){const r=H(n,"x","slice2d");return O(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),qt(r,e,t)}const jA=le({slice2d_:S9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k9(n,e,t){const r=H(n,"x","slice3d");return O(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),qt(r,e,t)}const b2=le({slice3d_:k9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E9(n,e,t){const r=H(n,"x","slice4d");return O(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),qt(r,e,t)}const zm=le({slice4d_:E9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I9(n,e=-1){const t=H(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const r={logits:t},s={dim:e};return te.runKernel(X0,r,s)}const C2=le({softmax_:I9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T9(n){O(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return te.runKernel(kb,e)}const HA=le({fft_:T9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _9(n){O(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return te.runKernel(Tb,e)}const p1=le({ifft_:_9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N9(n){const e=n.shape[n.shape.length-1],t=n.size/e;let r;if(e<=2){const s=ae(n,[t,e]);r=p1(s)}else{const s=[t,2*(e-1)],i=ae(Bm(n),[t,e]),o=ae(i2(n),[t,e]),a=yl(qt(i,[0,1],[t,e-2]),1),l=ee(yl(qt(o,[0,1],[t,e-2]),1),At(-1)),u=Mr([i,a],1),c=Mr([o,l],1),h=ae(dl(u,c),[s[0],s[1]]);r=p1(h)}if(r=Bm(r),n.rank===3&&n.shape[0]!==0){const s=r,i=n.shape[0];r=ae(r,[i,r.shape[0]/i,r.shape[1]]),s.dispose()}return r}const $9=le({irfft_:N9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D9(n,e,t=0){const s={x:H(n,"x","split")},i={numOrSizeSplits:e,axis:t};return te.runKernel(K0,s,i)}const vs=le({split_:D9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A9(n,e){O(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const r=n.size/t;let s;if(e!=null&&e<t){const p=n.shape.map(g=>0),v=n.shape.map(g=>g);v[n.shape.length-1]=e,s=qt(n,p,v),t=e}else if(e!=null&&e>t){const p=n.shape.map(v=>v);p[n.shape.length-1]=e-t,s=Mr([n,Yn(p)],n.shape.length-1),t=e}else s=n;const i=Ct(s),o=ae(dl(s,i),[r,t]),a=HA(o),l=Math.floor(t/2)+1,u=Bm(a),c=i2(a),h=vs(u,[l,t-l],u.shape.length-1),d=vs(c,[l,t-l],c.shape.length-1),f=s.shape.slice();return f[s.shape.length-1]=l,ae(dl(h[0],d[0]),f)}const R9=le({rfft_:A9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O9(n,e){let t=H(n,"a","squaredDifference"),r=H(e,"b","squaredDifference");[t,r]=xn(t,r),ut(t.shape,r.shape);const s={a:t,b:r},i={};return te.runKernel(xf,s,i)}const F9=le({squaredDifference_:O9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L9(n,e){const t=H(n,"x","squeeze","string_or_numeric");return ae(t,ba(t.shape,e).newShape)}const _f=le({squeeze_:L9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P9(n,e=0){const t=pA(n,"tensors","stack","string_or_numeric");O(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&O(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const r=t,s={axis:e};return te.runKernel(L0,r,s)}const ha=le({stack_:P9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M9(n,e=0){const r={x:H(n,"x","step")},s={alpha:e};return te.runKernel(kf,r,s)}const Nf=le({step_:M9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B9(n,e,t,r,s=0,i=0,o=0,a=0,l=0){const c={x:H(n,"x","stridedSlice","string_or_numeric")},h={begin:e,end:t,strides:r,beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return te.runKernel(Ub,c,h)}const z9=le({stridedSlice_:B9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U9(n){const t={x:H(n,"x","tan","float32")};return te.runKernel(bf,t)}const V9=le({tan_:U9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qr(n,e){wD(n);const t=ev(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return tv(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kp(n,e,t){if(wD(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=ev(n,t);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return tv(n,e,r,t)}function qA(n,e,t){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${r}, and batchDim: ${s}.`;if(t.rank<s)throw new Error(i+` update.rank < ${s}. `);if(n.length<r+(t.rank-s))throw new Error(i+` Output shape length < ${r+(t.rank-s)}`);if(t.rank!==s+n.length-r)throw new Error(i+` update.rank != ${s+n.length-r}`);for(let o=0;o<s;++o)if(t.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${t.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<t.rank-s;++o)if(t.shape[o+s]!==n[o+r])throw new Error(i+` updates.shape[${o+s}] (${t.shape[o+s]}) != shape[${o+s}] (${n[o+s]})`)}function W9(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}qA(t,e,n)}function Pl(n,e,t){const r=e.shape.length,s=r>1?e.shape[r-1]:1,i=t.length;let o=1;for(let h=s;h<i;++h)o*=t[h];const a=s<1?1:s,l=we(e.shape)/a,u=[...Qe(t.slice(0,s)),1],c=we(t);return{sliceRank:s,numUpdates:l,sliceSize:o,strides:u,outputSize:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G9(n,e=1,t=!0){const r=H(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const i={x:r},o={k:e,sorted:t},[a,l]=te.runKernel(Vb,i,o);return{values:a,indices:l}}const j9=le({topk_:G9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H9(n,e=0,t=1,r,s){if(Io(n),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new PA(e,t,r,!0,s),o=pt(n,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const KA=le({truncatedNormal_:H9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q9(n,e=0){const t=H(n,"x","unique","string_or_numeric");O(t.rank>0,()=>"The input tensor must be at least 1D");const r={x:t},s={axis:e},[i,o]=te.runKernel(Gb,r,s);return{values:i,indices:o}}const K9=le({unique_:q9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X9(n,e,t){const r=H(n,"x","unsortedSegmentSum"),s=H(e,"segmentIds","unsortedSegmentSum","int32");O(ju(t),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:s},o={numSegments:t};return te.runKernel(Z0,i,o)}const XA=le({unsortedSegmentSum_:X9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y9(n,e=0){const t=H(n,"x","unstack","string_or_numeric");O(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const r={value:t},s={axis:e};return te.runKernel(Y0,r,s)}const xl=le({unstack_:Y9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z9(n,e=!0,t,r){return te.makeVariable(n,e,t,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YA(n,e){const t=[];for(let i=0;i<e.length;i++)e[i]&&t.push(i);const r=pt(n,"int32"),s=pt([t.length,n.length],"int32");for(let i=0;i<t.length;i++){const o=r.indexToLoc(t[i]),a=i*n.length;s.values.set(o,a)}return s.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q9(n,e,t){const r=H(n,"x","transpose");if(e==null&&(e=r.shape.map((o,a)=>a).reverse()),O(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(o=>{O(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},i={perm:e};return r.dtype==="complex64"?pe(()=>{let o=Bm(r),a=i2(r);return o=te.runKernel(Du,{x:o},i),a=te.runKernel(Du,{x:a},i),t&&(a=yn(a)),dl(o,a)}):te.runKernel(Du,s,i)}const bt=le({transpose_:Q9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J9(n,e){if(e==null)return n.shape.slice();if(Nt(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let r=0;r<n.shape.length;r++)e[r]==null&&n.shape[r]!=null?t.push(n.shape[r]):t.push(e[r]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e7(n,e,t,r){const s=H(n,"x","dropout");if(O(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),O(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof Dn?s.clone():s;const i=J9(s,t),o=1-e,a=nt(ov(De(Tf(i,0,1,"float32",r),o)),o);return ee(s,a)}const t7=le({dropout_:e7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n7(n,e,t,r,s,i="NHWC",o){let a=n;n.rank===3&&(a=ae(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=ae(e,[1,e.shape[0],e.shape[1],e.shape[2]])),O(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),O(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),O(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const u=i==="NHWC"?a.shape[3]:a.shape[1],c=i==="NHWC"?l.shape[3]:l.shape[1];O(u===t[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${t[2]}.`),O(c===t[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${t[3]}).`),Gr("conv2dDerFilter",s,o);const h={x:a,dy:l},d={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,filterShape:t};return te.runKernel(fb,h,d)}const S2=le({conv2DBackpropFilter_:n7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k2(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return ee(n,Nf(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function E2(n,e){let t=e;const r=Gn(n.shape,e.shape);return r.length>0&&(t=et(t,r)),ae(t,n.shape)}function I2(n,e,t,r){if(e==="linear")return n;if(e==="relu")return Ll(n);if(e==="elu")return sv(n);if(e==="relu6")return MA(n);if(e==="prelu")return d2(n,t);if(e==="leakyrelu")return o2(n,r);if(e==="sigmoid")return mc(n);throw new Error(`Unknown fused activation ${e}.`)}const T2=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r7({x:n,filter:e,strides:t,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",T2(te.state.gradientDepth,l)===!1){O(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let C=vl(n,e,t,r,s,i,o);return a!=null&&(C=De(C,a)),I2(C,l,u,c)}const h=H(n,"x","conv2d","float32"),d=H(e,"filter","conv2d","float32");let f=h,p=!1;h.rank===3&&(p=!0,f=ae(h,[1,h.shape[0],h.shape[1],h.shape[2]])),O(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),O(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),Gr("fused conv2d",r,o);const v=s==="NHWC"?f.shape[3]:f.shape[1];O(d.shape[2]===v,()=>`Error in conv2d: depth of input (${v}) must match input depth for filter ${d.shape[2]}.`),O(gr(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);const g=ar(f.shape,d.shape,t,i,r,o);let m;a!=null&&(m=H(a,"bias","fused conv2d"),[m]=xn(m,h),s==="NHWC"?ut(g.outShape,m.shape):(O(m.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${m.shape.length}.`),O(m.shape.length===0||m.shape[0]===g.outChannels||m.shape[0]===1,()=>`Error in fused conv2d: bias shape (${m.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let y;if(u!=null){const C=u.shape;if(O(C.length<=1||C.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${C.length}.`),C.length===1)O(C[0]===1||C[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the number of output channels (${g.outChannels}).`);else if(C.length===3)try{ut(C,g.outShape)}catch{const E=`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(E)}y=H(u,"prelu weights","fused conv2d")}const w=(C,k)=>{O(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[E,T,_,A]=k,P=k2(C,_,l);O(ml(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const j=e2(T.shape,P,E,t,r),X=S2(T,P,E.shape,t,r),F=[j,X];if(A!=null){const M=E2(A,P);F.push(M)}return F},x={x:f,filter:d,bias:m,preluActivationWeights:y},b={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:c};return a==null?Yu((k,E,T)=>{let _=te.runKernel(Dm,x,b);return T([E,k,_]),p&&(_=ae(_,[_.shape[1],_.shape[2],_.shape[3]])),{value:_,gradFunc:w}})(f,d):Yu((k,E,T,_)=>{let A=te.runKernel(Dm,x,b);return _([E,k,A,T]),p&&(A=ae(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:w}})(f,d,m)}const s7=le({fusedConv2d_:r7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i7(n,e,t,r,s,i=[1,1],o){let a=n;n.rank===3&&(a=ae(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=ae(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},c={strides:r,pad:s,dimRoundingMode:o,dilations:i,filterShape:t};return te.runKernel(wb,u,c)}const o7=le({depthwiseConv2dNativeBackpropFilter_:i7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a7(n,e,t,r,s,i=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=ae(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:t},c={strides:r,pad:s,dimRoundingMode:o,dilations:i,inputShape:n},h=te.runKernel(bb,u,c);return l?ae(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const l7=le({depthwiseConv2dNativeBackpropInput_:a7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u7({a:n,b:e,transposeA:t=!1,transposeB:r=!1,bias:s,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(T2(te.state.gradientDepth,i)===!1){let A=_t(n,e,t,r);return s!=null&&(A=De(A,s)),I2(A,i,o,a)}let l=H(n,"a","fused matMul"),u=H(e,"b","fused matMul");[l,u]=xn(l,u);const c=t?l.shape[l.rank-2]:l.shape[l.rank-1],h=r?u.shape[u.rank-1]:u.shape[u.rank-2],d=t?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?u.shape[u.rank-2]:u.shape[u.rank-1],p=l.shape.slice(0,-2),v=u.shape.slice(0,-2),g=we(p),m=we(v);O(c===h,()=>`Error in fused matMul: inner shapes (${c}) and (${h}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${t} and transposeB=${r} must match.`);const w=ut(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([d,f]),x=t?ae(l,[g,c,d]):ae(l,[g,d,c]),b=r?ae(u,[m,f,h]):ae(u,[m,h,f]);let C;s!=null&&(C=H(s,"bias","fused matMul"),[C]=xn(C,l),ut(w,C.shape));let k;o!=null&&(k=H(o,"prelu weights","fused matMul"));const E=(A,P)=>{const[j,X,F,M]=P,W=k2(ae(A,F.shape),F,i);let D,z;if(!t&&!r?(D=_t(W,X,!1,!0),z=_t(j,W,!0,!1)):!t&&r?(D=_t(W,X,!1,!1),z=_t(W,j,!0,!1)):t&&!r?(D=_t(X,W,!1,!0),z=_t(j,W,!1,!1)):(D=_t(X,W,!0,!0),z=_t(W,j,!0,!0)),s!=null){const K=E2(M,W);return[D,z,K]}else return[D,z]},T={a:x,b,bias:C,preluActivationWeights:k},_={transposeA:t,transposeB:r,activation:i,leakyreluAlpha:a};return s==null?Yu((P,j,X)=>{const F=te.runKernel($m,T,_);return X([P,j,F]),{value:ae(F,w),gradFunc:E}})(x,b):Yu((P,j,X,F)=>{const M=te.runKernel($m,T,_);return F([P,j,M,X]),{value:ae(M,w),gradFunc:E}})(x,b,C)}const HE=le({fusedMatMul_:u7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c7(n,e,t,r,s="bilinear",i=0){const o=H(n,"image","cropAndResize"),a=H(e,"boxes","cropAndResize","float32"),l=H(t,"boxInd","cropAndResize","int32"),u=a.shape[0];O(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),O(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`),O(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`),O(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),O(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),O(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const c={image:o,boxes:a,boxInd:l},h={method:s,extrapolationValue:i,cropSize:r};return te.runKernel(vb,c,h)}const h7=le({cropAndResize_:c7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d7(n){const e=H(n,"image","flipLeftRight","float32");O(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return te.runKernel(Ib,t,{})}const f7=le({flipLeftRight_:d7});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p7(n){const e=H(n,"image","grayscaleToRGB"),t=e.rank-1,r=e.shape[t];O(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),O(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,t),s[t]=3,ui(e,s)}const m7=le({grayscaleToRGB_:p7});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g7(n){const e=H(n,"image","RGBToGrayscale"),t=e.rank-1,r=e.shape[t];O(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),O(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const s=e.dtype,i=Ve(e,"float32"),o=Qr([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Zc("ij,j->i",i,o);break;case 3:a=Zc("ijk,k->ij",i,o);break;case 4:a=Zc("ijkl,l->ijk",i,o);break;case 5:a=Zc("ijklm,m->ijkl",i,o);break;case 6:a=Zc("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=Fr(a,-1),Ve(a,s)}const v7=le({rgbToGrayscale_:g7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y7(n,e,t=0,r=.5){const s=H(n,"image","rotateWithOffset","float32");O(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const i={image:s},o={radians:e,fillValue:t,center:r};return te.runKernel(jb,i,o)}const x7=le({rotateWithOffset_:y7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vc(n,e,t,r,s,i){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=n.shape[0];return t=Math.min(t,o),O(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),O(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),O(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),O(e.rank===1,()=>"scores must be a 1D tensor"),O(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),O(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:t,iouThreshold:r,scoreThreshold:s,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w7(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY){const i=H(n,"boxes","nonMaxSuppression","float32"),o=H(e,"scores","nonMaxSuppression","float32"),a=vc(i,o,t,r,s);t=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l={maxOutputSize:t,iouThreshold:r,scoreThreshold:s};return te.runKernel(Ab,{boxes:i,scores:o},l)}const b7=le({nonMaxSuppression_:w7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C7(n,e,t){const r=S7(n,e,t),s=r<0?-(r+1):r;n.splice(s,0,e)}function S7(n,e,t){return E7(n,e,t||k7)}function k7(n,e){return n>e?1:n<e?-1:0}function E7(n,e,t){let r=0,s=n.length,i=0,o=!1;for(;r<s;){i=r+(s-r>>>1);const a=t(e,n[i]);a>0?r=i+1:(s=i,o=!a)}return o?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _2(n,e,t,r,s){return D2(n,e,t,r,s,0)}function N2(n,e,t,r,s,i){return D2(n,e,t,r,s,0,!1,i,!0)}function $2(n,e,t,r,s,i){return D2(n,e,t,r,s,i,!0)}function D2(n,e,t,r,s,i,o=!1,a=!1,l=!1){const u=[];for(let g=0;g<e.length;g++)e[g]>s&&u.push({score:e[g],boxIndex:g,suppressBeginIndex:0});u.sort(qE);const c=i>0?-.5/i:0,h=[],d=[];for(;h.length<t&&u.length>0;){const g=u.pop(),{score:m,boxIndex:y,suppressBeginIndex:w}=g;if(m<s)break;let x=!1;for(let b=h.length-1;b>=w;--b){const C=I7(n,y,h[b]);if(C>=r){x=!0;break}if(g.score=g.score*T7(r,c,C),g.score<=s)break}g.suppressBeginIndex=h.length,x||(g.score===m?(h.push(y),d.push(g.score)):g.score>s&&C7(u,g,qE))}const f=h.length,p=t-f;a&&p>0&&(h.push(...new Array(p).fill(0)),d.push(...new Array(p).fill(0)));const v={selectedIndices:h};return o&&(v.selectedScores=d),l&&(v.validOutputs=f),v}function I7(n,e,t){const r=n.subarray(e*4,e*4+4),s=n.subarray(t*4,t*4+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(s[0],s[2]),c=Math.min(s[1],s[3]),h=Math.max(s[0],s[2]),d=Math.max(s[1],s[3]),f=(a-i)*(l-o),p=(h-u)*(d-c);if(f<=0||p<=0)return 0;const v=Math.max(i,u),g=Math.max(o,c),m=Math.min(a,h),y=Math.min(l,d),w=Math.max(m-v,0)*Math.max(y-g,0);return w/(f+p-w)}function T7(n,e,t){const r=Math.exp(e*t*t);return t<=n?r:0}function qE(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function _7(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY){const i=H(n,"boxes","nonMaxSuppressionAsync"),o=H(e,"scores","nonMaxSuppressionAsync"),a=vc(i,o,t,r,s);t=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),u=l[0],c=l[1],{selectedIndices:h}=_2(u,c,t,r,s);return i!==n&&i.dispose(),o!==e&&o.dispose(),Qr(h,"int32")}const N7=_7;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $7(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=H(n,"boxes","nonMaxSuppression"),a=H(e,"scores","nonMaxSuppression"),l=vc(o,a,t,r,s,i);t=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const u={boxes:o,scores:a},c={maxOutputSize:t,iouThreshold:r,scoreThreshold:s,softNmsSigma:i},h=te.runKernel(Ob,u,c);return{selectedIndices:h[0],selectedScores:h[1]}}const D7=le({nonMaxSuppressionWithScore_:$7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function A7(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=H(n,"boxes","nonMaxSuppressionAsync"),a=H(e,"scores","nonMaxSuppressionAsync"),l=vc(o,a,t,r,s,i);t=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const u=await Promise.all([o.data(),a.data()]),c=u[0],h=u[1],{selectedIndices:d,selectedScores:f}=$2(c,h,t,r,s,i);return o!==n&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:Qr(d,"int32"),selectedScores:Qr(f)}}const R7=A7;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O7(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=H(n,"boxes","nonMaxSuppression"),a=H(e,"scores","nonMaxSuppression"),l=vc(o,a,t,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,h=l.scoreThreshold,d={boxes:o,scores:a},f={maxOutputSize:u,iouThreshold:c,scoreThreshold:h,padToMaxOutputSize:i},p=te.runKernel(Rb,d,f);return{selectedIndices:p[0],validOutputs:p[1]}}const F7=le({nonMaxSuppressionPadded_:O7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function L7(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=H(n,"boxes","nonMaxSuppressionAsync"),a=H(e,"scores","nonMaxSuppressionAsync"),l=vc(o,a,t,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,h=l.scoreThreshold,[d,f]=await Promise.all([o.data(),a.data()]),{selectedIndices:p,validOutputs:v}=N2(d,f,u,c,h,i);return o!==n&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:Qr(p,"int32"),validOutputs:At(v,"int32")}}const P7=L7;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M7(n,e,t=!1,r=!1){const s=H(n,"images","resizeBilinear");O(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),O(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),O(r===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=ae(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},l={alignCorners:t,halfPixelCenters:r,size:e},u=te.runKernel(V0,a,l);return o?ae(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const ZA=le({resizeBilinear_:M7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B7(n,e,t=!1,r=!1){const s=H(n,"images","resizeNearestNeighbor");O(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),O(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),O(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),O(r===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=ae(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},l={alignCorners:t,halfPixelCenters:r,size:e},u=te.runKernel(U0,a,l);return o?ae(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const QA=le({resizeNearestNeighbor_:B7});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z7(n,e="binary",t=!1,r=.5){const s=H(n,"image","threshold"),i=.2989,o=.587,a=.114,l=s.shape[0]*s.shape[1];let u=ee(Qr([r]),255),c,h,d,f;if(O(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),O(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),O(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),O(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[c,h,d]=vs(s,[1,1,1],-1);const g=ee(c,i),m=ee(h,o),y=ee(d,a);f=De(De(g,m),y)}else f=n;if(e==="otsu"){const g=Pj(Ve(BA(f),"int32"),Ch([]),256);u=U7(g,l)}const p=t?gc(f,u):Cs(f,u);return Ve(ee(p,255),"int32")}function U7(n,e){let t=Qr([-1]),r=Qr([0]),s=Qr([0]),i,o,a,l,u,c;for(let h=0;h<n.size-1;h++){i=qt(n,0,h+1),o=qt(n,h+1),u=nt(et(i),e),c=nt(et(o),e);const d=et(ee(i,Zh(0,i.size)));a=nt(d,et(i));const f=rv(o.shape,i.size),p=De(Zh(0,o.size),f),v=ee(o,p);l=nt(et(v),et(o));const g=st(a,l),m=st(a,l),y=ee(u,c);s=ee(ee(y,g),m);const w=Cs(s,r);r=Er(w,s,r),t=Er(w,Qr([h]),t)}return t}const V7=le({threshold_:z7});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W7(n,e,t="nearest",r="constant",s=0,i){const o=H(n,"image","transform","float32"),a=H(e,"transforms","transform","float32");O(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),O(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),O(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:a},u={interpolation:t,fillMode:r,fillValue:s,outputShape:i};return te.runKernel(Wb,l,u)}const G7=le({transform_:W7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j7(n,e,t){const r=H(n,"a","bandPart");O(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[i,o]=r.shape.slice(-2);let a,l;typeof e=="number"?(O(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),O(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=H(e<0?i:e,"numLower","bandPart")):(O(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Er(Pm(e,0),i,Yh(e,i))),typeof t=="number"?(O(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`),O(t<=o,()=>`bandPart(): numUpper (${t}) must not be greater than the number of columns (${o}).`),l=H(t<0?o:t,"numUpper","bandPart")):(O(t.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Er(Pm(t,0),o,Yh(t,o)));const u=ae(Zh(0,i,1,"int32"),[-1,1]),c=Zh(0,o,1,"int32"),h=st(u,c),d=wo(gc(h,a),Rl(h,yn(l))),f=Yn([i,o],r.dtype);return ae(ha(xl(ae(r,[-1,i,o])).map(p=>Er(d,p,f))),s)}const H7=le({bandPart_:j7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q7(n){let e;if(Array.isArray(n)){e=!1,O(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=n[0].shape[0];for(let i=1;i<n.length;++i)O(n[i].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[i].shape[0]} vs. ${s})`)}else e=!0,n=vs(n,n.shape[0],0).map(s=>_f(s,[0]));O(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],r=n;for(let s=0;s<n.length;++s)t.push(te.tidy(()=>{let i=r[s];if(s>0)for(let o=0;o<s;++o){const a=ee(et(ee(t[o],i)),t[o]);i=st(i,a)}return nt(i,iv(i,"euclidean"))}));return e?ha(t,0):t}const K7=le({gramSchmidt_:q7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X7(n,e=!1){if(O(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return KE(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((l,u)=>l*u),r=xl(ae(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),s=[],i=[];r.forEach(l=>{const[u,c]=KE(l,e);s.push(u),i.push(c)});const o=ae(ha(s,0),n.shape),a=ae(ha(i,0),n.shape);return[o,a]}}function KE(n,e=!1){return te.tidy(()=>{O(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],r=n.shape[1];let s=DA(t),i=Qa(n);const o=Kp([[1]],[1,1]);let a=Qa(o);const l=t>=r?r:t;for(let u=0;u<l;++u){const c=i,h=a,d=s;[a,i,s]=te.tidy(()=>{const f=qt(i,[u,u],[t-u,1]),p=iv(f),v=qt(i,[u,u],[1,1]),g=Er(Cs(v,0),Kp([[-1]]),Kp([[1]])),m=st(v,ee(g,p)),y=nt(f,m);y.shape[0]===1?a=Qa(o):a=Mr([o,qt(y,[1,0],[y.shape[0]-1,y.shape[1]])],0);const w=yn(nt(_t(g,m),p)),x=qt(i,[u,0],[t-u,r]),b=ee(w,a),C=bt(a);if(u===0)i=st(x,_t(b,_t(C,x)));else{const T=st(x,_t(b,_t(C,x)));i=Mr([qt(i,[0,0],[u,r]),T],0)}const k=bt(b),E=qt(s,[0,u],[t,s.shape[1]-u]);if(u===0)s=st(E,_t(_t(E,a),k));else{const T=st(E,_t(_t(E,a),k));s=Mr([qt(s,[0,0],[t,u]),T],1)}return[a,i,s]}),ft([c,h,d])}return!e&&t>r&&(s=qt(s,[0,0],[t,r]),i=qt(i,[0,0],[r,r])),[s,i]})}const Y7=le({qr_:X7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uo={flipLeftRight:f7,grayscaleToRGB:m7,resizeNearestNeighbor:QA,resizeBilinear:ZA,rgbToGrayscale:v7,rotateWithOffset:x7,cropAndResize:h7,nonMaxSuppression:b7,nonMaxSuppressionAsync:N7,nonMaxSuppressionWithScore:D7,nonMaxSuppressionWithScoreAsync:R7,nonMaxSuppressionPadded:F7,nonMaxSuppressionPaddedAsync:P7,threshold:V7,transform:G7},Z7={bandPart:H7,gramSchmidt:K7,qr:Y7};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q7=new Map,J7=new Map;class yc{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class Ls{constructor(){this.classNameMap={}}static getMap(){return Ls.instance==null&&(Ls.instance=new Ls),Ls.instance}static register(e){Ls.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Ee(n,e,t){O(n.className!=null,()=>"Class being registered does not have the static className property defined."),O(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),O(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof t>"u"&&(t=n.className);const r=t,s=e+">"+r;return Ls.register(n),Q7.set(s,n),J7.set(n,s),n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ta extends yc{minimize(e,t=!1,r){const{value:s,grads:i}=this.computeGradients(e,r);if(r!=null){const o=r.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return ft(i),t?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return iq(e,t)}dispose(){this.iterations_!=null&&ft(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:At(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Ta,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JA extends Ta{static get className(){return"Adadelta"}constructor(e,t,r=null){super(),this.learningRate=e,this.rho=t,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=te.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=te.registeredVariables[r],o=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:pe(()=>Ct(i).variable(o))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:pe(()=>Ct(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedGrads[s].variable,u=this.accumulatedUpdates[s].variable;pe(()=>{const c=De(ee(l,this.rho),ee(Jt(a),1-this.rho)),h=ee(nt(Tr(De(u,this.epsilon)),Tr(De(l,this.epsilon))),a),d=De(ee(u,this.rho),ee(Jt(h),1-this.rho));l.assign(c),u.assign(d);const f=De(ee(h,-this.learningRate),i);i.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(ft(this.accumulatedGrads.map(e=>e.variable)),ft(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eR extends Ta{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=te.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:pe(()=>rv(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const a=this.accumulatedGrads[s].variable;pe(()=>{const l=De(a,Jt(o));a.assign(l);const u=De(ee(nt(o,Tr(De(l,te.backend.epsilon()))),-this.learningRate),i);i.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&ft(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tR extends Ta{static get className(){return"Adam"}constructor(e,t,r,s=null){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],pe(()=>{this.accBeta1=At(t).variable(),this.accBeta2=At(r).variable()}),s==null&&(this.epsilon=te.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);pe(()=>{const r=st(1,this.accBeta1),s=st(1,this.accBeta2);t.forEach((i,o)=>{const a=te.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:pe(()=>Ct(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:pe(()=>Ct(a).variable(l))});const u=Array.isArray(e)?e[o].tensor:e[i];if(u==null)return;const c=this.accumulatedFirstMoment[o].variable,h=this.accumulatedSecondMoment[o].variable,d=De(ee(c,this.beta1),ee(u,1-this.beta1)),f=De(ee(h,this.beta2),ee(Jt(u),1-this.beta2)),p=nt(d,r),v=nt(f,s);c.assign(d),h.assign(f);const g=De(ee(nt(p,De(Tr(v),this.epsilon)),-this.learningRate),a);a.assign(g)}),this.accBeta1.assign(ee(this.accBeta1,this.beta1)),this.accBeta2.assign(ee(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&ft(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&ft(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),pe(()=>{this.accBeta1.assign(Xu(this.beta1,this.iterations_+1)),this.accBeta2.assign(Xu(this.beta2,this.iterations_+1))});const t=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nR extends Ta{static get className(){return"Adamax"}constructor(e,t,r,s=null,i=0){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=s,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],pe(()=>{this.iteration=At(0).variable(),this.accBeta1=At(t).variable()}),s==null&&(this.epsilon=te.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);pe(()=>{const r=st(1,this.accBeta1),s=nt(-this.learningRate,De(ee(this.iteration,this.decay),1));t.forEach((i,o)=>{const a=te.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:Ct(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:Ct(a).variable(l)});const u=Array.isArray(e)?e[o].tensor:e[i];if(u==null)return;const c=this.accumulatedFirstMoment[o].variable,h=this.accumulatedWeightedInfNorm[o].variable,d=De(ee(c,this.beta1),ee(u,1-this.beta1)),f=ee(h,this.beta2),p=br(u),v=Ia(f,p);c.assign(d),h.assign(v);const g=De(ee(nt(s,r),nt(d,De(v,this.epsilon))),a);a.assign(g)}),this.iteration.assign(De(this.iteration,1)),this.accBeta1.assign(ee(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&ft(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&ft(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A2 extends Ta{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const o=te.registeredVariables[r];pe(()=>{const a=De(ee(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Wi(At(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rR extends A2{static get className(){return"Momentum"}constructor(e,t,r=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=r,this.accumulations=[],this.m=At(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=te.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:pe(()=>Ct(i).variable(!1))});const o=this.accumulations[s].variable,a=Array.isArray(e)?e[s].tensor:e[r];a!=null&&pe(()=>{let l;const u=De(ee(this.m,o),a);this.useNesterov?l=De(ee(this.c,De(a,ee(u,this.m))),i):l=De(ee(this.c,u),i),o.assign(u),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&ft(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sR extends Ta{static get className(){return"RMSProp"}constructor(e,t=.9,r=0,s=null,i=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,s==null&&(this.epsilon=te.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=te.registeredVariables[r],o=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:pe(()=>Ct(i).variable(o))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:pe(()=>Ct(i).variable(o))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:pe(()=>Ct(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedMeanSquares[s].variable,u=this.accumulatedMoments[s].variable;pe(()=>{const c=De(ee(l,this.decay),ee(Jt(a),1-this.decay));if(this.centered){const h=this.accumulatedMeanGrads[s].variable,d=De(ee(h,this.decay),ee(a,1-this.decay)),f=nt(ee(a,this.learningRate),Tr(st(c,De(Jt(d),this.epsilon)))),p=De(ee(u,this.momentum),f);l.assign(c),h.assign(d),u.assign(p);const v=st(i,p);i.assign(v)}else{const h=De(ee(l,this.decay),ee(Jt(a),1-this.decay)),d=De(ee(u,this.momentum),nt(ee(a,this.learningRate),Tr(De(h,this.epsilon))));l.assign(h),u.assign(d);const f=st(i,d);i.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&ft(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&ft(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&ft(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eK=[JA,eR,tR,nR,rR,sR,A2];function tK(){for(const n of eK)Ee(n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XE(n,e,t,r){o(n),t=t??0,r=r??1,a(t,r);let s=0;const i=l=>(l.then(u=>{const c=t+ ++s/n.length*(r-t);return e(c),u}),l);function o(l){O(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,u){O(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),O(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),O(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(n.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function nK(n,e){e==null&&(e={});const t=e.fetchFunc==null?me().platform.fetch:e.fetchFunc,r=n.map(h=>t(h,e.requestInit,{isBinary:!0})),s=0,i=.5,a=(e.onProgress==null?await Promise.all(r):await XE(r,e.onProgress,s,i)).map(h=>h.arrayBuffer()),l=.5,u=1;return e.onProgress==null?await Promise.all(a):await XE(a,e.onProgress,l,u)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rK="application/octet-stream",sK="application/json";class R2{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(O(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=me().platform.fetch,O(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&O(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=mG(e,r);if(t.body.append("model.json",new Blob([JSON.stringify(s)],{type:sK}),"model.json"),e.weightData!=null){const o=Sa.join(e.weightData);t.body.append("model.weights.bin",new Blob([o],{type:rK}),"model.weights.bin")}const i=await this.fetch(this.path,t);if(i.ok)return{modelArtifactsInfo:Xb(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const r=t.modelTopology,s=t.weightsManifest;if(r==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return vG(t,i=>this.loadWeights(i))}async loadWeights(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[r,s]=iK(t),i=this.weightPathPrefix||r,o=yG(e),a=[],l=[];for(const c of e)for(const h of c.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(h)):a.push(i+h+s);this.weightUrlConverter&&a.push(...await Promise.all(l));const u=await nK(a,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[o,u]}}R2.URL_SCHEME_REGEX=/^https?:\/\//;function iK(n){const e=n.lastIndexOf("/"),t=n.lastIndexOf("?"),r=n.substring(0,e),s=t>e?n.substring(t):"";return[r+"/",s]}function YE(n){return n.match(R2.URL_SCHEME_REGEX)!=null}const iR=(n,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(n)?t=n.every(r=>YE(r)):t=YE(n),t)return oR(n,e)}return null};qn.registerSaveRouter(iR);qn.registerLoadRouter(iR);function oR(n,e){return new R2(n,e)}function oK(n,e){return oR(n,e)}function O2(n,e){const t=n.shape.length,r=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${t}`);if(we(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const s=e.shape,i=s[s.length-1];let o=1;for(let h=0;h<s.length-1;++h)o*=s[h];const a=n.shape,l=s.slice();l.pop();let u=1;for(let h=i;h<t;++h)u*=a[h],l.push(a[h]);const c=[...Qe(n.shape).map(h=>h/u),1].slice(0,i);return[l,o,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m1=-2,aK=-1;function F2(n,e,t){const r=n.shape.length;O(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),O(r===t.length,()=>`Error in slice${r}D: Length of size ${t} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)O(e[s]+t[s]<=n.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+t[s]}) would overflow input.shape[${s}] (${n.shape[s]})`)}function lK(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function L2(n,e,t){const r=[];for(let s=0;s<n.length;s++)r[s]=Math.ceil((e[s]-n[s])/t[s]);return r}function aR(n,e,t,r){const s=[...n];for(let i=s.length;i<r.length;i++)s.push(1);for(let i=0;i<t;i++)i===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function lR(n,e,t){return t<=n?t:t-(e-1)}function uR(n,e){const t=[];for(let r=0;r<n;r++)t.push(e+r);return t}function uK(n,e,t,r,s,i,o,a,l){const u=n.length;let c=new Array(u),h=new Array(u),d=new Array(u);if(e.length&&t>0){const f=e[0],p=t+1;c=cR(o,f,p,r,n),h=hR(a,f,p,s,n),d=aR(i,f,p,n)}else for(let f=0;f<u;f++)c[f]=fR(o,r,i,n,f,l),h[f]=pR(a,s,i,n,f,l),d[f]=dR(i,f,l);return{begin:c,end:h,strides:d}}function cR(n,e,t,r,s){const i=[...s],o=uR(t,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const l=lR(e,t,a);let u=r[l];n&1<<l&&(u=0),i[a]=u}return i}function hR(n,e,t,r,s){const i=[...s],o=uR(t,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=lR(e,t,a);let u=r[l];n&1<<l&&(u=Number.MAX_SAFE_INTEGER),i[a]=u}for(let a=0;a<i.length;a++){const l=s[a];i[a]<0&&(i[a]+=l),i[a]=cl(0,i[a],s[a])}return i}function dR(n,e,t){let r=n[e];return(t&1<<e||r==null)&&(r=1),r}function fR(n,e,t,r,s,i){let o=e[s];const a=t[s]||1;(n&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=r[s];return o<0&&(o+=l),o=cl(0,o,l-1),o}function pR(n,e,t,r,s,i){let o=e[s];const a=t[s]||1;(n&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=r[s];return o<0&&(o+=l),a>0?o=cl(0,o,l):o=cl(-1,o,l-1),o}function P2(n,e,t){let r=t.length;for(let s=0;s<t.length;s++)if(t[s]>1){r=s;break}for(let s=r+1;s<t.length;s++)if(e[s]>0||t[s]!==n[s])return!1;return!0}function M2(n,e){let t=n.length>0?n[n.length-1]:1;for(let r=0;r<n.length-1;r++)t+=n[r]*e[r];return t}function av(n,e,t){let r;const s=n.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(o=>{O(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return t==null?i=new Array(s).fill(-1):typeof t=="number"?i=[t,...new Array(s-1).fill(-1)]:t.length<s?i=t.concat(new Array(s-t.length).fill(-1)):i=t,i=i.map((o,a)=>o>=0?o:(O(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),n.shape[a]-r[a])),[r,i]}function B2(n,e,t,r,s,i,o,a,l){let u;if(r==null?(u=new Array(e.length),u.fill(1)):u=r,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const h={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:u.slice(),beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let w=0;w<h.dims;w++)c&&1<<w&a&&h.numAddAxisAfterEllipsis++,1<<w&o&&(c=!0);c||(h.ellipsisMask|=1<<h.dims,h.dims++);const d={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};cK(h,d);let f=!0,p=!0,v=!0;const g=[],m=[];for(let w=0;w<n.length;++w){if(d.strides[w]===0)throw Error(`strides[${w}] must be non-zero`);const x=!!(d.shrinkAxisMask&1<<w),b=n[w];if(b===-1){g.push(x?1:-1);continue}const C=[d.beginMask&1<<w,d.endMask&1<<w],k=[d.strides[w]>0?0:-1,d.strides[w]>0?b:b-1];if(x&&d.strides[w]<=0)throw Error("only stride 1 allowed on non-range indexing.");v=v&&d.strides[w]===1;const E=!!(d.beginMask&1<<w&&d.endMask&1<<w);if(d.beginValid&&d.endValid){if(x){const P=d.begin[w]<0?b+d.begin[w]:d.begin[w];if(d.begin[w]=P,d.end[w]=d.begin[w]+1,P<0||P>=b)throw Error(`slice index ${d.begin[w]} of dimension ${w} out of bounds.`)}else d.begin[w]=ZE(d.begin[w],0,d.strides[w],b,C,k),d.end[w]=ZE(d.end[w],1,d.strides[w],b,C,k);const A=d.strides[w]===1&&d.begin[w]===0&&d.end[w]===b;f=f&&A,p=p&&(w===0&&d.strides[w]===1||A)}else f=f&&d.strides[w]===1&&E,p=p&&(w===0&&d.strides[w]===1||E);let T,_=!1;if(d.beginValid&&d.endValid?(T=d.end[w]-d.begin[w],_=!0):x?(T=1,_=!0):E&&b>=0&&(d.strides[w]<0?T=-b:T=b,_=!0),_){let A;T===0||T<0!=d.strides[w]<0?A=0:A=Math.trunc(T/d.strides[w])+(T%d.strides[w]!==0?1:0),g.push(A)}else g.push(-1)}for(let w=0;w<d.finalShapeGatherIndices.length;++w){const x=d.finalShapeGatherIndices[w];x>=0?m.push(g[x]):x===m1&&m.push(1)}return{finalShapeSparse:m.filter((w,x)=>d.finalShapeGatherIndices[x]!==m1),finalShape:m,isIdentity:f,sliceDim0:p,isSimpleSlice:v,begin:d.begin,end:d.end,strides:d.strides}}function cK(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<n.dims;r++)if(1<<r&n.ellipsisMask){const s=Math.min(e.dims-(n.dims-r)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<s;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=r}else if(1<<r&n.newAxisMask)e.finalShapeGatherIndices.push(m1),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[r]),n.end!=null&&(e.end[t]=n.end[r]),e.strides[t]=n.strides[r],n.beginMask&1<<r&&(e.beginMask|=1<<t),n.endMask&1<<r&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(aK),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[t]=r,t++}}function ZE(n,e,t,r,s,i){if(s[e])return t>0?i[e]:i[e+1&1];{const o=n<0?r+n:n;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const hK=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:F2,computeFlatOffset:M2,computeOutShape:L2,getNormalizedAxes:uK,isSliceContinous:P2,maskToAxes:lK,parseSliceParams:av,sliceInfo:B2,startForAxis:fR,startIndicesWithElidedDims:cR,stopForAxis:pR,stopIndicesWithElidedDims:hR,stridesForAxis:dR,stridesWithElidedDims:aR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dK{static sgd(e){return new A2(e)}static momentum(e,t,r=!1){return new rR(e,t,r)}static rmsprop(e,t=.9,r=0,s=null,i=!1){return new sR(e,t,r,s,i)}static adam(e=.001,t=.9,r=.999,s=null){return new tR(e,t,r,s)}static adadelta(e=.001,t=.95,r=null){return new JA(e,t,r)}static adamax(e=.002,t=.9,r=.999,s=null,i=0){return new nR(e,t,r,s,i)}static adagrad(e,t=.1){return new eR(e,t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tu=dK;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fK=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n())();function mR(){return new Promise(n=>fK(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z2(n,e){const t=n[0].length;n.forEach((s,i)=>{O(s.length===t,()=>`Error in concat${t}D: rank of tensors[${i}] must be the same as the rank of the rest (${t})`)}),O(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const r=n[0];n.forEach((s,i)=>{for(let o=0;o<t;o++)O(o===e||s[o]===r[o],()=>`Error in concat${t}D: Shape of tensors[${i}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function Gi(n,e){const t=n[0].slice();for(let r=1;r<n.length;r++)t[e]+=n[r][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var li;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(li||(li={}));function gR(n,e,t){let r=new Array;if(t==null&&e==null)return r;if(e==null)for(;r.length<n+t.length;)r.push(-1);else r=e.slice();if(t==null)return r;if(n+t.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${r.length}`);for(let s=1;s<t.length;++s){const i=t[s],o=r[r.length-t.length+s],a=r[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+n}] = ${i} but shape[${s+n}] = ${a}`)}else r[o]=i}return r}function vR(n){const e={FIRST_DIM_SIZE:li.FIRST_DIM_SIZE,VALUE_ROWIDS:li.VALUE_ROWIDS,ROW_LENGTHS:li.ROW_LENGTHS,ROW_SPLITS:li.ROW_SPLITS,ROW_LIMITS:li.ROW_LIMITS,ROW_STARTS:li.ROW_STARTS},t=[];for(const r of n)if(r in e)t.push(e[r]);else break;return t}function yR(n){return n.length===0?0:n[0]===li.FIRST_DIM_SIZE?n.length-1:n.length}function xR(n,e){if(n==null||e==null)return;const t=n.length,r=e.length;if(t>=r)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(t,r-1);++s){const i=n[s],o=e[s+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-n.length}] = ${i} but ragged tensor input.flatValues.shape[${s-n.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U2=30;function lv(n){return n<=U2?n:Zx(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V2(n,e,t){const r=t*(typeof n=="number"?n:n[0]),s=e*(typeof n=="number"?n:n[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $f(n,e,t,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(n[0]/t),s=s.concat(n.slice(1));else{s=s.concat(n[0]);const i=e.length;for(let o=0;o<i;++o)s=s.concat([n[o+1]/e[o],e[o]]);s=s.concat(n.slice(i+1))}return s}function Df(n,e,t=!0){const r=[];if(t){r.push(e);for(let s=e+1;s<n;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],i=[];for(let o=1;o<n;++o)o>=e*2+1||o%2===1?i.push(o):s.push(o);r.push(...s),r.push(0),r.push(...i)}return r}function Af(n,e,t,r=!0){const s=[];r?s.push(n[0]/t):s.push(n[0]*t);for(let i=1;i<n.length;++i)i<=e.length?r?s.push(e[i-1]*n[i]):s.push(n[i]/e[i-1]):s.push(n[i]);return s}function W2(n,e){const t=[0];for(let r=0;r<e;++r)t.push(n[r][0]);return t}function G2(n,e,t){const r=n.slice(0,1);for(let s=0;s<t;++s)r.push(n[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uv=1.7580993408473768,cv=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j2=.3275911,H2=.254829592,q2=-.284496736,K2=1.421413741,X2=-1.453152027,Y2=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bo(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let r=0;r<t.length;r+=2)t[r]=n[r/2],t[r+1]=e[r/2];return t}function wR(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let r=0;r<n.length;r+=2)e[r/2]=n[r],t[r/2]=n[r+1];return{real:e,imag:t}}function bR(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<n.length;s+=4)t[Math.floor(s/4)]=n[s],r[Math.floor(s/4)]=n[s+1];return{real:t,imag:r}}function CR(n){const e=Math.floor(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<n.length;s+=4)t[Math.floor(s/4)]=n[s],r[Math.floor(s/4)]=n[s+1];return{real:t,imag:r}}function Z2(n,e){const t=n[e*2],r=n[e*2+1];return{real:t,imag:r}}function SR(n,e,t,r){n[r*2]=e,n[r*2+1]=t}function kR(n,e){const t=new Float32Array(n/2),r=new Float32Array(n/2);for(let s=0;s<Math.ceil(n/2);s++){const i=(e?2:-2)*Math.PI*(s/n);t[s]=Math.cos(i),r[s]=Math.sin(i)}return{real:t,imag:r}}function ER(n,e,t){const r=(t?2:-2)*Math.PI*(n/e),s=Math.cos(r),i=Math.sin(r);return{real:s,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _y="->",pK=/->/g,QE=",",JE="...";function Q2(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(pK,"").length)/_y.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${_y}").`);const[r,s]=n.split(_y);O(r.indexOf(JE)===-1,()=>`The ellipsis notation ("${JE}") is not supported yet.`);const i=r.split(QE),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let d=0;d<s.length;++d){const f=s[d];if(!i.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let d=0;d<r.length;++d){const f=r[d];a.indexOf(f)===-1&&f!==QE&&a.push(f)}const l=new Array(i.length);for(let d=0;d<o;++d){if(new Set(i[d].split("")).size!==i[d].length)throw new Error(`Found duplicate axes in input component ${i[d]}. Support for duplicate axes in input is not implemented yet.`);l[d]=[];for(let f=0;f<i[d].length;++f)l[d].push(a.indexOf(i[d][f]))}const u=a.length,c=s.length,h=[];for(let d=c;d<u;++d)h.push(d);return{allDims:a,summedDims:h,idDims:l}}function J2(n,e){let t=new Array(n);t.fill(-1);for(let s=0;s<e.length;++s)t[e[s]]=s;const r=[];for(let s=0;s<n;++s)t[s]===-1&&r.push(s);return t=t.filter(s=>s!==-1),{permutationIndices:t,expandDims:r}}function eC(n,e,t){const r=new Array(n);for(let s=0;s<t.length;++s){const i=t[s].shape;for(let o=0;o<e[s].length;++o)r[e[s][o]]===void 0?r[e[s][o]]=i[o]:O(r[e[s][o]]===i[o],()=>`Expected dimension ${r[e[s][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function tC(n,e){const t=n,r=[];let s=0;n.length===0&&t.push(-1),s=n.length+1;for(let o=0;o<s;++o)r.push([]);const i=[];for(let o=0;o<t.length;++o){const a=t[o],l=mK(e,a);for(const u of l)i.indexOf(u)===-1&&(r[o].push(u),i.push(u))}return{path:t,steps:r}}function nC(n){return n.every((e,t)=>e===t)}function mK(n,e){const t=[];for(let r=0;r<n.length;++r)(n[r].length===0||n[r].indexOf(e)!==-1||e===-1)&&t.push(r);return t}function rC(n,e,t=0){let r=[];if(typeof e=="number")O(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(n.shape[t]/e);else{const s=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);O(s<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[i]=n.shape[t]-o}O(n.shape[t]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IR(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function TR(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function _R(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NR(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function $R(n,e){return`size ${n} must be non-negative, not ${e}`}function DR(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function AR(n,e){const t=we(n),r=we(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${n} outputShape= ${e}`}function RR(n,e){const t=we(n),r=we(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${r}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g1(){return"segment ids must be >= 0"}function OR(){return"segment ids are not increasing"}function FR(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function LR(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PR(n,e){let t=!1,r;for(n<=U2?(r=n,t=!0):r=Zx(n,Math.floor(Math.sqrt(n)));!t;)r>e||r===n?t=!0:r=Zx(n,r+1);return r}function MR(n,e,t){const r=[],s=n.length;for(let i=0;i<s;i++)i!==e?r.push(n[i]):r.push(t);return r}function sC(n,e,t,r){const s=e.shape.length,i=n.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(t<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${t}).`);for(let h=0;h<r;++h)if(n.shape[h]!==e.shape[h])throw new Error(`x.shape[${h}]: ${n.shape[h]} should be equal to indices.shape[${h}]: ${e.shape[h]}.`);const o=n.shape[t],a=[];let l=1,u=1,c=1;for(let h=0;h<r;++h)a.push(n.shape[h]),l*=n.shape[h];for(let h=r;h<t;h++)a.push(n.shape[h]),u*=n.shape[h];for(let h=r;h<s;h++)a.push(e.shape[h]);for(let h=t+1;h<i;h++)a.push(n.shape[h]),c*=n.shape[h];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:o,outputShape:a}}const gK=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:sC,computeOutShape:MR,segOpComputeOptimalWindowSize:PR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Co(n){try{return n.map(e=>ca(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function BR(n){return n.map(e=>sa(e))}const vK=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:H2,ERF_A2:q2,ERF_A3:K2,ERF_A4:X2,ERF_A5:Y2,ERF_P:j2,PARALLELIZE_THRESHOLD:U2,get RowPartitionType(){return li},SELU_SCALE:cv,SELU_SCALEALPHA:uv,applyActivation:I2,assertAndGetBroadcastShape:ut,assertAxesAreInnerMostDims:lr,assertParamsConsistent:z2,assignToTypedArray:SR,axesAreInnerMostDims:r2,calculateShapes:Pl,checkEinsumDimSizes:eC,checkPadOnDimRoundingMode:Gr,combineLocations:NA,combineRaggedTensorToTensorShapes:gR,complexWithEvenIndex:bR,complexWithOddIndex:CR,computeConv2DInfo:ar,computeConv3DInfo:ka,computeDefaultPad:Yb,computeDilation2DInfo:Ef,computeOptimalWindowSize:lv,computeOutAndReduceShapes:Jn,computeOutShape:Gi,computePool2DInfo:Ks,computePool3DInfo:To,convertConv2DDataFormat:_o,decodeEinsumEquation:Q2,eitherStridesOrDilationsAreOne:gr,expandShapeToKeepDim:Rn,exponent:ER,exponents:kR,fromStringArrayToUint8:BR,fromUint8ToStringArray:Co,getAxesPermutation:un,getBroadcastDims:Ku,getComplexWithIndex:Z2,getEinsumComputePath:tC,getEinsumPermutation:J2,getFusedBiasGradient:E2,getFusedDyActivation:k2,getImageCenter:V2,getInnerMostAxes:wn,getPermuted:Df,getRaggedRank:yR,getReductionAxes:Gn,getReshaped:$f,getReshapedPermuted:Af,getRowPartitionTypesHelper:vR,getSliceBeginCoords:W2,getSliceSize:G2,getSparseFillEmptyRowsIndicesDenseShapeMismatch:IR,getSparseFillEmptyRowsNegativeIndexErrorMessage:TR,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:_R,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:DR,getSparseReshapeInputOutputMismatchErrorMessage:RR,getSparseReshapeInputOutputMultipleErrorMessage:AR,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:NR,getSparseReshapeNegativeOutputDimErrorMessage:$R,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:LR,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:g1,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:OR,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:FR,getUndoAxesPermutation:Ea,isIdentityPermutation:nC,log:P5,mergeRealAndImagArrays:bo,prepareAndValidate:O2,prepareSplitSize:rC,segment_util:gK,shouldFuse:T2,slice_util:hK,splitRealAndImagArrays:wR,stridesOrDilationsArePositive:gl,tupleValuesAreOne:ml,upcastType:ns,validateDefaultValueShape:xR,validateInput:W9,validateUpdateShape:qA,warn:fs},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */tK();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zR={kernelName:Jg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ee(n,Nf(Ve(t,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yK={kernelName:Nd,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=Jt(Ve(t,"float32")),s=Tr(st(At(1),r));return yn(nt(n,s))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xK={kernelName:$d,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=Tr(st(Jt(Ve(t,"float32")),1));return nt(n,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wK={kernelName:pc,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=ut(t.shape,r.shape);return{a:()=>{let a=n;const l=Gn(t.shape,s);return l.length>0&&(a=et(a,l)),ae(a,t.shape)},b:()=>{let a=n;const l=Gn(r.shape,s);return l.length>0&&(a=et(a,l)),ae(a,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bK={kernelName:ib,saveAllInputs:!0,gradFunc:(n,e)=>{const t={};return e.forEach((r,s)=>{t[s]=()=>n.clone()}),t}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CK={kernelName:e0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ct(t)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SK={kernelName:t0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ct(t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kK={kernelName:Dd,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>nt(n,Tr(st(At(1),Jt(Ve(t,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EK={kernelName:Ad,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=Tr(De(At(1),Jt(Ve(t,"float32"))));return nt(n,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IK={kernelName:Fd,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=ut(t.shape,r.shape);return{a:()=>{const a=De(Jt(t),Jt(r));let l=ee(n,nt(r,a));const u=Gn(t.shape,s);return u.length>0&&(l=et(l,u)),ae(l,t.shape)},b:()=>{const a=De(Jt(t),Jt(r));let l=yn(ee(n,nt(t,a)));const u=Gn(r.shape,s);return u.length>0&&(l=et(l,u)),ae(l,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TK={kernelName:Rd,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>nt(n,De(Jt(Ve(t,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _K={kernelName:Od,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>nt(n,st(At(1),Jt(Ve(t,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NK(n,e,t,r,s,i){const o=H(n,"dy","avgPool3dGrad"),a=H(e,"input","avgPool3dGrad");let l=o,u=a,c=!1;a.rank===4&&(c=!0,l=ae(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),u=ae(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),O(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),O(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),Gr("avgPool3dGrad",s,i);const h={dy:l,input:u},d={filterSize:t,strides:r,pad:s,dimRoundingMode:i},f=te.runKernel(ub,h,d);return c?ae(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const $K=le({avgPool3dGrad_:NK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DK={kernelName:r0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{filterSize:s,strides:i,pad:o,dimRoundingMode:a}=t;return{x:()=>$K(n,r,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AK(n,e,t,r,s){const i=H(n,"dy","avgPoolGrad"),o=H(e,"input","avgPoolGrad");O(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,l=i,u=!1;o.rank===3&&(u=!0,a=ae(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=ae(i,[1,i.shape[0],i.shape[1],i.shape[2]])),O(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),O(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const c={dy:l,input:a},h={filterSize:t,strides:r,pad:s},d=te.runKernel(lb,c,h);return u?ae(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const RK=le({avgPoolGrad_:AK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OK={kernelName:n0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{filterSize:s,strides:i,pad:o}=t;return{x:()=>RK(n,r,s,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FK={kernelName:s0,inputsToSave:["a","b"],gradFunc:(n,e,t)=>{const[r,s]=e,{transposeA:i,transposeB:o}=t;return!i&&!o?{a:()=>_t(n,s,!1,!0),b:()=>_t(r,n,!0,!1)}:!i&&o?{a:()=>_t(n,s,!1,!1),b:()=>_t(n,r,!0,!1)}:i&&!o?{a:()=>_t(s,n,!1,!0),b:()=>_t(r,n,!1,!1)}:{a:()=>_t(s,n,!0,!0),b:()=>_t(n,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LK={kernelName:i0,gradFunc:(n,e,t)=>{const{blockShape:r,crops:s}=t;return{x:()=>h2(n,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PK={kernelName:R5,gradFunc:(n,e,t)=>{const r=t,s=r.inputShape,i=r.shape,o=Array.from(i);for(let l=s.length-1;l>=0;l--)if(s[l]===i[l])o[l]=1;else if(s[l]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>et(n,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MK={kernelName:Ld,gradFunc:n=>({x:()=>n.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BK={kernelName:Pd,gradFunc:n=>({x:()=>Ct(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zK={kernelName:Md,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{clipValueMin:s,clipValueMax:i}=t;return{x:()=>Er(wo(Rl(r,s),gc(r,i)),n,Ct(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UK={kernelName:o0,inputsToSave:["x"],gradFunc:zR.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VK={kernelName:a0,saveAllInputs:!0,gradFunc:(n,e,t)=>{const r=e.map(l=>l.shape),{axis:s}=t,i=mt(s,e[0].shape)[0],o=r.map(l=>l[i]);return vs(n,o,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WK={kernelName:l0,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[r,s]=e,{dilations:i,strides:o,pad:a,dataFormat:l}=t;return O(ml(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>e2(r.shape,n,s,o,a,l),filter:()=>S2(r,n,s.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GK={kernelName:u0,inputsToSave:["dy","filter"],gradFunc:(n,e,t)=>{const[r,s]=e,{strides:i,pad:o,dataFormat:a,dimRoundingMode:l}=t;return{dy:()=>vl(n,s,i,o,a,1,l),filter:()=>S2(n,r,s.shape,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jK(n,e,t,r,s){let i=n;n.rank===4&&(i=ae(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let o=e;o.rank===4&&(o=ae(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),O(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),O(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),O(t.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${t}.`),O(i.shape[4]===t[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${t[3]}.`),O(o.shape[4]===t[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${t[4]}).`);const a={x:i,dy:o},l={strides:r,pad:s,filterShape:t};return te.runKernel(pb,a,l)}const HK=le({conv3DBackpropFilter_:jK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qK={kernelName:c0,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:r,strides:s,pad:i}=t;O(ml(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[o,a]=e;return{x:()=>IA(o.shape,n,a,s,i),filter:()=>HK(o,n,a.shape,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KK={kernelName:Bd,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ee(yn(WA(Ve(t,"float32"))),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XK={kernelName:zd,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ee(GA(Ve(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YK={kernelName:h0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{axis:s,exclusive:i,reverse:o}=t;return{x:()=>{const a=un([s],r.rank);let l=_A(n,s,i,!o);return a!=null&&(l=bt(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZK={kernelName:d0,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:r,strides:s,pad:i,dimRoundingMode:o}=t,a=r??[1,1];O(ml(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,u]=e;return O(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),O(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),O(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),O(gr(s,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${s} and dilations '${a}'.`),Gr("depthwiseConv2d",i,o),{x:()=>l7(l.shape,n,u,s,i,a,o),filter:()=>o7(l,n,u.shape,s,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QK={kernelName:f0,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[r,s]=e,i={x:r,filter:s,dy:n},o={x:r,filter:s,dy:n};return{x:()=>te.runKernel(Qx,i,t),filter:()=>te.runKernel(Jx,o,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JK={kernelName:Vd,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e,r={dy:n,y:t};return{x:()=>te.runKernel(Sb,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eX={kernelName:Wd,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,r=ee(xo(yn(Jt(t))),2/Math.sqrt(Math.PI));return{x:()=>ee(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tX={kernelName:Gd,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ee(n,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nX={kernelName:m0,inputsToSave:["input"],gradFunc:(n,e)=>{const[t]=e;return{input:()=>ae(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rX={kernelName:jd,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ee(n,xo(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sX={kernelName:Hd,gradFunc:n=>({x:()=>Ct(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iX={kernelName:qd,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=ut(t.shape,r.shape);return{a:()=>{const a=nt(n,Ve(r,"float32")),l=Gn(t.shape,s);return l.length>0?ae(et(a,l),t.shape):a},b:()=>{let a=ee(n,Ve(t,"float32"));const l=Gn(r.shape,s);l.length>0&&(a=ae(et(a,l),r.shape));const u=Jt(r);return yn(nt(a,Ve(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oX={kernelName:g0,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,e,t)=>{const{varianceEpsilon:r}=t,[s,i,o,a]=e,l=a??At(1),u=Gn(i.shape,s.shape),c=[];if(i.rank===1){for(let x=0;x<s.shape.length-1;++x)c.push(s.shape[x]);c.push(1)}const h=st(s,i),d=ee(n,l),f=zA(De(o,At(r))),p=ee(ee(ee(f,f),f),At(-.5));return{x:()=>i.rank===1?ae(ee(ee(n,ui(ae(f,[1,1,1,i.shape[0]]),c)),l),s.shape):ae(ee(ee(n,f),l),s.shape),mean:()=>{let x=ee(ee(f,At(-1)),d);return i.rank===1&&(x=et(x,u)),ae(x,i.shape)},variance:()=>{let x=ee(ee(p,h),d);return i.rank===1&&(x=et(x,u)),ae(x,i.shape)},scale:()=>{const x=ee(h,f);let b=ee(n,x);return i.rank===1&&(b=et(b,u)),ae(b,i.shape)},offset:()=>{let x=n;return i.rank===1&&(x=et(x,u)),ae(x,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aX={kernelName:v0,inputsToSave:["x","indices"],gradFunc:(n,e,t)=>{const[r,s]=e,{axis:i}=t,o=mt(i,r.shape)[0];return{x:()=>{const l=r.shape,u=s.size,c=l.slice(0,o),h=c.length,d=l.slice(i,l.length).slice(1),f=d.length,p=eI(0,h),v=eI(h+1,h+1+f),g=tI([c,[u],d]),m=ae(n,g),y=ae(s,[u]),w=tI([[h],p,v]),x=bt(m,w);let b=XA(x,y,r.shape[o]);const C=Ea(w);return b=bt(b,C),b},indices:()=>s}}};function eI(n,e){const t=[];for(let r=n;r<e;++r)t.push(r);return t}function tI(n){const e=[];for(let t=0;t<n.length;++t)for(let r=0;r<n[t].length;++r)e.push(n[t][r]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lX={kernelName:Kd,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e;return{a:()=>Ct(t),b:()=>Ct(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uX={kernelName:Xd,gradFunc:n=>({x:()=>Ve(n,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cX={kernelName:Yd,gradFunc:n=>({x:()=>Ct(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hX={kernelName:Zd,gradFunc:n=>({x:()=>Ct(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dX={kernelName:Qd,gradFunc:n=>({x:()=>Ct(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fX={kernelName:x0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{alpha:s}=t,i=Cs(r,0);return{x:()=>Er(i,n,ee(n,s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pX={kernelName:ef,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>nt(n,De(t,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mX={kernelName:Jd,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>nt(n,Ve(t,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gX={kernelName:F5,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r]=e,{axis:s}=t;return{logits:()=>{const o=xo(r);return st(n,ee(et(n,s,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vX(n,e,t,r=5,s=1,i=1,o=.5){const a={x:n,y:e,dy:t},l={depthRadius:r,bias:s,alpha:i,beta:o};return te.runKernel(Nb,a,l)}const yX=le({localResponseNormalizationBackprop_:vX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xX={kernelName:E0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r,s]=e,{depthRadius:i,bias:o,alpha:a,beta:l}=t;return{x:()=>yX(r,s,n,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UR(n,e,t,r){return e.rank<t.rank&&(e=ae(e,Rn(e.shape,r))),n.rank<t.rank&&(n=ae(n,Rn(n.shape,r))),{x:()=>ee(n,Ve(Ki(t,e),n.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nI={kernelName:I0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const r=t,{reductionIndices:s}=r,i=e[0],o=e[1],a=mt(s,i.shape),l=UR(n,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wX={kernelName:tf,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e;return{a:()=>ee(n,Ve(Rl(t,r),"float32")),b:()=>ee(n,Ve(Pm(t,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bX(n,e,t,r,s,i,o){const a=H(n,"dy","maxPool3dGrad"),l=H(e,"input","maxPool3dGrad"),u=H(t,"output","maxPool3dGrad");let c=a,h=l,d=u,f=!1;l.rank===4&&(f=!0,c=ae(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),h=ae(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=ae(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),O(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),O(h.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${h.rank}.`),O(d.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`),Gr("maxPool3dGrad",i,o);const p={dy:c,input:h,output:d},v={filterSize:r,strides:s,pad:i,dimRoundingMode:o},g=te.runKernel(Db,p,v);return f?ae(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const CX=le({maxPool3dGrad_:bX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SX={kernelName:_0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r,s]=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=t;return{x:()=>CX(n,r,s,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kX(n,e,t,r,s,i,o){const a=H(n,"dy","maxPoolGrad"),l=H(e,"input","maxPoolGrad"),u=H(t,"output","maxPoolGrad");O(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),O(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),O(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Gr("maxPoolGrad",i,o);const c={dy:a,input:l,output:u},h={filterSize:r,strides:s,pad:i,dimRoundingMode:o};return te.runKernel($b,c,h)}const EX=le({maxPoolGrad_:kX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IX={kernelName:T0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r,s]=e,{filterSize:i,strides:o,pad:a}=t;return{x:()=>EX(n,r,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TX={kernelName:N0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{axis:s}=t,i=mt(s,r.shape),a=Jn(r.shape,i)[1],l=we(a);return{x:()=>{const c=r.shape.slice();i.forEach(f=>{c[f]=1});const h=ae(n,c);return nt(ee(h,Ol(r.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _X={kernelName:$0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const r=t,{axis:s}=r,[i,o]=e,a=mt(s,i.shape),l=UR(n,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NX={kernelName:nf,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e;return{a:()=>ee(n,Ve(gc(t,r),"float32")),b:()=>ee(n,Ve(Cs(t,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $X={kernelName:D0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const r=e[0],{paddings:s}=t,i=s.map(o=>o[0]);return{x:()=>qt(n,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DX={kernelName:rf,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=ut(t.shape,r.shape);return{a:()=>{const a=Gn(t.shape,s);return a.length>0?ae(et(n,a),t.shape):n},b:()=>{const a=ee(n,yn(ov(nt(t,r)))),l=Gn(r.shape,s);return l.length>0?ae(et(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AX={kernelName:sf,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=ut(t.shape,r.shape);return{a:()=>{const a=ee(n,Ve(r,"float32")),l=Gn(t.shape,s);return l.length>0?ae(et(a,l),t.shape):a},b:()=>{const a=ee(n,Ve(t,"float32")),l=Gn(r.shape,s);return l.length>0?ae(et(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RX={kernelName:A0,gradFunc:n=>({x:()=>yn(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OX={kernelName:F0,inputsToSave:["indices"],gradFunc:(n,e)=>{const t=e[0];return{indices:()=>Yn(t.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FX={kernelName:O0,gradFunc:n=>({x:()=>Ct(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LX={kernelName:L0,saveAllInputs:!0,gradFunc:(n,e,t)=>{const{axis:r}=t;return xl(n,r).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rI={kernelName:P0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const r=e[0],{paddings:s}=t,i=s.map(o=>o[0]);return{x:()=>qt(n,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PX={kernelName:of,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,e)=>{const[t,r,s]=e,i=t,o=r,a=ut(i.shape,o.shape);return{a:()=>{const c=Ve(o,"float32");let h=ee(n,ee(c,Xu(i,st(c,At(1)))));const d=Gn(i.shape,a);return d.length>0&&(h=et(h,d)),ae(h,i.shape)},b:()=>{const c=Cs(i,0),h=Er(c,Xi(i),Ct(i));let d=ee(n,ee(s,h));const f=Gn(o.shape,a);return f.length>0&&(d=et(d,f)),ae(d,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MX={kernelName:M0,inputsToSave:["x","alpha"],gradFunc:(n,e)=>{const[t,r]=e,s=Cs(t,0);return{x:()=>Er(s,n,ee(n,r)),alpha:()=>{let i=Er(s,Ct(n),ee(n,t));const o=Gn(r.shape,n.shape);return o.length>0&&(i=et(i,o)),ae(i,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BX(n,e,t){const r=n.shape.slice();r[t]=1;const s=ae(e,r),i=f1(n,t,!0,!1),o=f1(n,t,!0,!0),a=ee(i,o);return ee(s,a)}function zX(n,e,t){const r=n.shape.length,s=r-t.length,i=un(t,r);let o=n;i!=null&&(o=bt(n,i));const a=o.shape.slice(),u=a.splice(r-t.length,t.length).reduce((d,f)=>d*f,1);a.push(u);const c=o.reshape(a);let h=BX(c,e,s);if(h=h.reshape(o.shape),i!=null){const d=Ea(i);h=bt(h,d)}return h}const UX={kernelName:B0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{axis:s}=t;let i=[];return s==null?i=r.shape.map((o,a)=>a):typeof s=="number"?i=[s]:i=s,{x:()=>zX(r,n,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VX={kernelName:Ud,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=ut(t.shape,r.shape);return{a:()=>{const a=nt(n,Ve(r,"float32")),l=Gn(t.shape,s);return l.length>0?ae(et(a,l),t.shape):a},b:()=>{let a=ee(n,Ve(t,"float32"));const l=Gn(r.shape,s);l.length>0&&(a=ae(et(a,l),r.shape));const u=Jt(r);return yn(nt(a,Ve(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WX={kernelName:af,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>nt(n,yn(Jt(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GX={kernelName:uf,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,r=ee(gc(t,6),Nf(t));return{x:()=>ee(n,Ve(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jX={kernelName:lf,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ee(n,Ve(Nf(t),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HX={kernelName:z0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ae(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qX={kernelName:V0,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[r]=e,s={dy:n,images:r};return{images:()=>te.runKernel(Mb,s,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KX={kernelName:U0,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[r]=e,s={dy:n,images:r};return{images:()=>te.runKernel(Pb,s,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XX={kernelName:W0,gradFunc:(n,e,t)=>{const{dims:r}=t,s=mt(r,n.shape);return{x:()=>yl(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YX={kernelName:cf,gradFunc:n=>({x:()=>Ct(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZX={kernelName:hf,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>yn(nt(n,ee(Xu(t,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QX={kernelName:G0,inputsToSave:["condition"],gradFunc:(n,e)=>{const[t]=e;return{condition:()=>Ve(Ct(t),"float32"),t:()=>ee(n,Ve(t,n.dtype)),e:()=>ee(n,Ve(a2(t),n.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JX={kernelName:df,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=Cs(t,At(0)),s=At(uv),i=At(cv),o=ee(n,i),a=ee(ee(n,s),xo(Ve(t,"float32")));return Er(r,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eY={kernelName:gf,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ee(n,ee(t,st(At(1),t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tY={kernelName:mf,gradFunc:n=>({x:()=>Ct(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nY={kernelName:ff,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ee(t2(Ve(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rY={kernelName:pf,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ee(TA(Ve(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sY={kernelName:j0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{begin:s,size:i}=t,o=r.shape,[a,l]=av(r,s,i),u=[];for(let c=0;c<n.rank;c++)u.push([a[c],o[c]-a[c]-l[c]]);return{x:()=>c2(n,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iY={kernelName:X0,outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r]=e,{dim:s}=t,i=!0,o=ee(n,r);return{logits:()=>st(o,ee(et(o,[s],i),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oY={kernelName:vf,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ee(n,mc(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sI={kernelName:q0,gradFunc:(n,e,t)=>{const{blockShape:r,paddings:s}=t;return{x:()=>Jb(n,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iI={kernelName:K0,gradFunc:(n,e,t)=>{const{axis:r}=t;return{x:()=>Mr(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aY={kernelName:yf,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>nt(n,ee(Tr(Ve(t,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lY={kernelName:Bb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ee(n,ee(Ve(t,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uY={kernelName:xf,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=At(2);return{a:()=>ee(n,ee(s,st(t,r))),b:()=>ee(n,ee(s,st(r,t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cY={kernelName:kf,gradFunc:n=>({x:()=>Ct(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hY={kernelName:wf,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=ut(t.shape,r.shape);return{a:()=>{let a=n;const l=Gn(t.shape,s);return l.length>0&&(a=et(a,l)),ae(a,t.shape)},b:()=>{let a=n;const l=Gn(r.shape,s);return l.length>0&&(a=et(a,l)),ae(yn(a),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dY={kernelName:H0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,s=r.shape.slice(),{axis:i}=t;mt(i,r.shape).forEach(u=>{s[u]=1});const a=ae(n,s),l=ee(a,Ol(r.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fY={kernelName:bf,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>nt(n,Jt(t2(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pY={kernelName:Cf,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ee(st(At(1),Jt(t)),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mY={kernelName:Sf,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{reps:s}=t;return{x:()=>{let o=Ct(r);if(r.rank===1)for(let a=0;a<s[0];++a)o=De(o,qt(n,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)o=De(o,qt(n,[a*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let u=0;u<s[2];++u)o=De(o,qt(n,[a*r.shape[0],l*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let u=0;u<s[2];++u)for(let c=0;c<s[3];++c)o=De(o,qt(n,[a*r.shape[0],l*r.shape[1],u*r.shape[2],c*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gY={kernelName:Du,gradFunc:(n,e,t)=>{const r=t,{perm:s}=r,i=Ea(s);return{x:()=>bt(n,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vY={kernelName:Y0,gradFunc:(n,e,t)=>{const r=t,{axis:s}=r;return{value:()=>ha(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yY={kernelName:Z0,inputsToSave:["segmentIds"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>xY(n,t)}}};function xY(n,e){const t=Ia(e,Ct(e)),r=s2(n,t);let s=Rl(e,At(0,"int32"));const i=r.rank-s.rank;for(let a=0;a<i;++a)s=Fr(s,a+1);s=wo(s,Ol(r.shape,"bool"));const o=Ct(r);return Er(s,r,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wY={kernelName:Q0,gradFunc:n=>({x:()=>Ct(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bY=[zR,yK,xK,wK,bK,CK,SK,kK,EK,IK,TK,_K,DK,OK,FK,LK,PK,MK,BK,zK,UK,VK,GK,WK,qK,KK,XK,YK,ZK,QK,VX,JK,eX,tX,nX,rX,iX,sX,oX,aX,lX,uX,cX,hX,dX,fX,pX,mX,gX,xX,nI,nI,wX,SX,IX,TX,_X,NX,$X,DX,AX,RX,OX,FX,LX,rI,rI,PX,MX,UX,WX,GX,jX,HX,qX,KX,XX,YX,ZX,QX,JX,eY,tY,nY,rY,sY,iY,oY,sI,sI,iI,iI,aY,uY,lY,cY,hY,dY,fY,pY,mY,gY,vY,yY,wY];for(const n of bY)M5(n);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.abs=function(){return this.throwIfDisposed(),br(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.acos=function(){return this.throwIfDisposed(),YG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.acosh=function(){return this.throwIfDisposed(),QG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.add=function(n){return this.throwIfDisposed(),De(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.all=function(n,e){return this.throwIfDisposed(),SA(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.any=function(n,e){return this.throwIfDisposed(),h1(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.argMax=function(n){return this.throwIfDisposed(),qh(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.argMin=function(n){return this.throwIfDisposed(),rj(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.asScalar=function(){return this.throwIfDisposed(),O(this.size===1,()=>"The array must have only 1 element."),ae(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.asType=function(n){return this.throwIfDisposed(),Ve(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.as1D=function(){return this.throwIfDisposed(),ae(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.as2D=function(n,e){return this.throwIfDisposed(),ae(this,[n,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.as3D=function(n,e,t){return this.throwIfDisposed(),ae(this,[n,e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.as4D=function(n,e,t,r){return this.throwIfDisposed(),ae(this,[n,e,t,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.as5D=function(n,e,t,r,s){return this.throwIfDisposed(),ae(this,[n,e,t,r,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.asin=function(){return this.throwIfDisposed(),ij(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.asinh=function(){return this.throwIfDisposed(),aj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.atan=function(){return this.throwIfDisposed(),uj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.atan2=function(n){return this.throwIfDisposed(),hj(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.atanh=function(){return this.throwIfDisposed(),fj(this)};xe().prototype.avgPool=function(n,e,t,r){return this.throwIfDisposed(),Zb(this,n,e,t,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.batchToSpaceND=function(n,e){return this.throwIfDisposed(),Jb(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.batchNorm=function(n,e,t,r,s){return this.throwIfDisposed(),nv(this,n,e,t,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.broadcastTo=function(n){return this.throwIfDisposed(),Sh(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.cast=function(n){return this.throwIfDisposed(),Ve(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.ceil=function(){return this.throwIfDisposed(),zj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.clipByValue=function(n,e){return this.throwIfDisposed(),xs(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.concat=function(n,e){return this.throwIfDisposed(),n instanceof Dn&&(n=[n]),Mr([this,...n],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.conv1d=function(n,e,t,r,s,i){return this.throwIfDisposed(),kA(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.conv2dTranspose=function(n,e,t,r,s){return this.throwIfDisposed(),EA(this,n,e,t,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.conv2d=function(n,e,t,r,s,i){return this.throwIfDisposed(),vl(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.cos=function(){return this.throwIfDisposed(),t2(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.cosh=function(){return this.throwIfDisposed(),TA(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.cumprod=function(n,e,t){return this.throwIfDisposed(),f1(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.cumsum=function(n,e,t){return this.throwIfDisposed(),_A(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.depthToSpace=function(n,e){return this.throwIfDisposed(),hH(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.depthwiseConv2d=function(n,e,t,r,s,i){return this.throwIfDisposed(),n2(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.dilation2d=function(n,e,t,r,s){return this.throwIfDisposed(),pH(this,n,e,t,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.divNoNan=function(n){return this.throwIfDisposed(),xH(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.div=function(n){return this.throwIfDisposed(),nt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.dot=function(n){return this.throwIfDisposed(),bH(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.elu=function(){return this.throwIfDisposed(),sv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.equal=function(n){return this.throwIfDisposed(),Ki(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.erf=function(){return this.throwIfDisposed(),EH(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.euclideanNorm=function(n,e){return this.throwIfDisposed(),OH(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.exp=function(){return this.throwIfDisposed(),xo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.expandDims=function(n){return this.throwIfDisposed(),Fr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.expm1=function(){return this.throwIfDisposed(),MH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.fft=function(){return this.throwIfDisposed(),HA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.flatten=function(){return this.throwIfDisposed(),ae(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.floor=function(){return this.throwIfDisposed(),ov(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.floorDiv=function(n){return this.throwIfDisposed(),CA(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.gather=function(n,e,t){return this.throwIfDisposed(),s2(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.greaterEqual=function(n){return this.throwIfDisposed(),Rl(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.greater=function(n){return this.throwIfDisposed(),Cs(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.ifft=function(){return this.throwIfDisposed(),p1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.irfft=function(){return this.throwIfDisposed(),$9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.isFinite=function(){return this.throwIfDisposed(),qH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.isInf=function(){return this.throwIfDisposed(),XH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.isNaN=function(){return this.throwIfDisposed(),ZH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.leakyRelu=function(n){return this.throwIfDisposed(),o2(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.lessEqual=function(n){return this.throwIfDisposed(),gc(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.less=function(n){return this.throwIfDisposed(),Pm(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.localResponseNormalization=function(n,e,t,r){return this.throwIfDisposed(),nq(this,n,e,t,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.logSigmoid=function(){return this.throwIfDisposed(),uq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.logSoftmax=function(n){return this.throwIfDisposed(),RA(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.logSumExp=function(n,e){return this.throwIfDisposed(),fq(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.log=function(){return this.throwIfDisposed(),Xi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.log1p=function(){return this.throwIfDisposed(),AA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.logicalAnd=function(n){return this.throwIfDisposed(),wo(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.logicalNot=function(){return this.throwIfDisposed(),a2(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.logicalOr=function(n){return this.throwIfDisposed(),OA(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.logicalXor=function(n){return this.throwIfDisposed(),yq(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.matMul=function(n,e,t){return this.throwIfDisposed(),_t(this,n,e,t)};xe().prototype.maxPool=function(n,e,t,r){return this.throwIfDisposed(),l2(this,n,e,t,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.max=function(n,e){return this.throwIfDisposed(),pi(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.maximum=function(n){return this.throwIfDisposed(),Ia(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.mean=function(n,e){return this.throwIfDisposed(),An(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.min=function(n,e){return this.throwIfDisposed(),Lm(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.minimum=function(n){return this.throwIfDisposed(),Yh(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.mirrorPad=function(n,e){return this.throwIfDisposed(),Iq(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.mod=function(n){return this.throwIfDisposed(),_q(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.mul=function(n){return this.throwIfDisposed(),ee(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.neg=function(){return this.throwIfDisposed(),yn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.norm=function(n,e,t){return this.throwIfDisposed(),iv(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.notEqual=function(n){return this.throwIfDisposed(),Mm(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.oneHot=function(n,e=1,t=0){return this.throwIfDisposed(),FA(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.onesLike=function(){return this.throwIfDisposed(),qs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.pad=function(n,e){return this.throwIfDisposed(),c2(this,n,e)};xe().prototype.pool=function(n,e,t,r,s,i){return this.throwIfDisposed(),Mq(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.pow=function(n){return this.throwIfDisposed(),Xu(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.prelu=function(n){return this.throwIfDisposed(),d2(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.prod=function(n,e){return this.throwIfDisposed(),Uq(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.reciprocal=function(){return this.throwIfDisposed(),c9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.relu=function(){return this.throwIfDisposed(),Ll(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.relu6=function(){return this.throwIfDisposed(),MA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.reshapeAs=function(n){return this.throwIfDisposed(),ae(this,n.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.reshape=function(n){return this.throwIfDisposed(),ae(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.resizeBilinear=function(n,e,t){return this.throwIfDisposed(),ZA(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.resizeNearestNeighbor=function(n,e,t){return this.throwIfDisposed(),QA(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.reverse=function(n){return this.throwIfDisposed(),yl(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.rfft=function(){return this.throwIfDisposed(),R9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.round=function(){return this.throwIfDisposed(),BA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.rsqrt=function(){return this.throwIfDisposed(),zA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.selu=function(){return this.throwIfDisposed(),UA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.separableConv2d=function(n,e,t,r,s,i){return this.throwIfDisposed(),VA(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.sigmoid=function(){return this.throwIfDisposed(),mc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.sign=function(){return this.throwIfDisposed(),x9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.sin=function(){return this.throwIfDisposed(),WA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.sinh=function(){return this.throwIfDisposed(),GA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.slice=function(n,e){return this.throwIfDisposed(),qt(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.softmax=function(n){return this.throwIfDisposed(),C2(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.softplus=function(){return this.throwIfDisposed(),If(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.spaceToBatchND=function(n,e){return this.throwIfDisposed(),h2(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.split=function(n,e){return this.throwIfDisposed(),vs(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.sqrt=function(){return this.throwIfDisposed(),Tr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.square=function(){return this.throwIfDisposed(),Jt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.squaredDifference=function(n){return this.throwIfDisposed(),F9(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.squeeze=function(n){return this.throwIfDisposed(),_f(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.stack=function(n,e){this.throwIfDisposed();const t=n instanceof Dn?[this,n]:[this,...n];return ha(t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.step=function(n){return this.throwIfDisposed(),Nf(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.stridedSlice=function(n,e,t,r,s,i,o,a){return this.throwIfDisposed(),z9(this,n,e,t,r,s,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.sub=function(n){return this.throwIfDisposed(),st(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.sum=function(n,e){return this.throwIfDisposed(),et(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.tan=function(){return this.throwIfDisposed(),V9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.tanh=function(){return this.throwIfDisposed(),Qb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.tile=function(n){return this.throwIfDisposed(),ui(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.toBool=function(){return this.throwIfDisposed(),Ve(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.toFloat=function(){return this.throwIfDisposed(),Ve(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.toInt=function(){return this.throwIfDisposed(),Ve(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.topk=function(n,e){return this.throwIfDisposed(),j9(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.transpose=function(n){return this.throwIfDisposed(),bt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.unique=function(n){return this.throwIfDisposed(),K9(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.unsortedSegmentSum=function(n,e){return this.throwIfDisposed(),XA(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.unstack=function(n){return this.throwIfDisposed(),xl(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.where=function(n,e){return this.throwIfDisposed(),Er(n,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.zerosLike=function(){return this.throwIfDisposed(),Ct(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Di extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Di.prototype)}}class Us extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Us.prototype)}}class Q extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Q.prototype)}}class ht extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ht.prototype)}}class iC extends Error{constructor(e){super(e),Object.setPrototypeOf(this,iC.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class VR{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wl(n,e){if(Array.isArray(n)){let t=[];for(let r=0;r<e;r++)t=t.concat(n);return t}else{const t=new Array(e);return t.fill(n),t}}function Ai(n,e){if(!n)throw new iC(e)}function oI(n,e){let t=0;for(const r of n)r===e&&t++;return t}function Lr(n){return n.length===1?n[0]:n}function Zt(n){return Array.isArray(n)?n:[n]}function io(n){const t=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function Ua(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let $s={};function oC(n){if(n==null)return null;const e={};return e.className=n.getClassName(),e.config=n.getConfig(),e}function v1(n){if(!(n==null||typeof n!="object"))if(Array.isArray(n))n.forEach(e=>v1(e));else{const e=Object.keys(n);for(const t of e){const r=n[t];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?n[t]=r.value:v1(r))}}}function Rf(n,e={},t={},r="object",s=!1){if(typeof n=="string"){const i=n;let o;if(i in t)o=t[i];else if(i in $s)o=$s[i];else if(o=e[i],o==null)throw new Q(`Unknown ${r}: ${n}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=n;if(i.className==null||i.config==null)throw new Q(`${r}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,l;if(o in t?[a,l]=t[o]:o in $s?[a,l]=$s.className:o in e&&([a,l]=e[o]),a==null)throw new Q(`Unknown ${r}: ${o}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const f of Object.keys($s))u[f]=$s[f];for(const f of Object.keys(t))u[f]=t[f];const c=i.config;c.customObjects=u;const h=Object.assign({},$s);for(const f of Object.keys(t))$s[f]=t[f];v1(i.config);const d=l(a,i.config,t,s);return $s=Object.assign({},h),d}else{const u=Object.assign({},$s);for(const h of Object.keys(t))$s[h]=t[h];const c=new a(i.config);return $s=Object.assign({},u),c}}}function CY(n,e){return n<e?-1:n>e?1:0}function bp(n,e){return-1*CY(n,e)}function ia(n){if(n==null)return n;const e=[];for(const t of n)e.indexOf(t)===-1&&e.push(t);return e}function SY(n){if(n==null)throw new Q(`Invalid value in obj: ${JSON.stringify(n)}`);for(const e in n)if(n.hasOwnProperty(e))return!1;return!0}function Ml(n,e,t){if(t!=null&&n.indexOf(t)<0)throw new Q(`${t} is not a valid ${e}.  Valid values are ${n} or null/undefined.`)}function aC(n,e,t=0,r=1/0){return Ai(t>=0),Ai(r>=t),Array.isArray(n)&&n.length>=t&&n.length<=r&&n.every(s=>typeof s===e)}function Qn(n,e){Array.isArray(n)?(O(n.length>0,()=>`${e} is unexpectedly an empty array.`),n.forEach((t,r)=>Qn(t,`element ${r+1} of ${e}`))):O(Number.isInteger(n)&&n>0,()=>`Expected ${e} to be a positive integer, but got ${WR(n)}.`)}function WR(n){return n===null?"null":Array.isArray(n)?"["+n.map(e=>WR(e)).join(",")+"]":typeof n=="string"?`"${n}"`:`${n}`}function kY(n,e,t){let r=t!=null?t():Or(),s;return(...o)=>{const a=t!=null?t():Or();return a-r<e||(r=a,s=n(...o)),s}}function GR(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let EY=0;function jR(){return EY++}const Cp={};function hv(n=""){return n in Cp||(Cp[n]=0),Cp[n]+=1,n+Cp[n].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const IY=["channelsFirst","channelsLast"],TY=["nearest","bilinear"],_Y=["valid","same","causal"],NY=["max","avg"],$Y=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const nu=new Map;function bn(n){Ml(IY,"DataFormat",n)}function DY(n){Ml(TY,"InterpolationFormat",n)}function Ss(n){Ml(_Y,"PaddingMode",n)}function HR(n){Ml(NY,"PoolMode",n)}const kh=[],aI="/";function Ja(n,e){kh.push(n);try{const t=e();return kh.pop(),t}catch(t){throw kh.pop(),t}}function AY(){return kh.length===0?"":kh.join(aI)+aI}function qR(n){if(!XR(n))throw new Error("Not a valid tensor name: '"+n+"'");return AY()+n}function KR(n){if(!XR(n))throw new Error("Not a valid tensor name: '"+n+"'");nu.has(n)||nu.set(n,0);const e=nu.get(n);if(nu.set(n,nu.get(n)+1),e>0){const t=`${n}_${e}`;return nu.set(t,1),t}else return n}const RY=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function XR(n){return!!n.match(RY)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function OY(n){return n===parseInt(n.toString(),10)}function oa(n,e,t){e==null&&(e=0),t==null&&(t=n.length);let r=1;for(let s=e;s<t;++s)r*=n[s];return r}function Zu(n){if(n.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let t=0;t<n.length;t++){const r=n[t];r<e&&(e=r)}return e}function da(n){if(n.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let t=0;t<n.length;t++){const r=n[t];r>e&&(e=r)}return e}function vi(n,e){if(e<n)throw new Q(`end (${e}) < begin (${n}) is forbidden.`);const t=[];for(let r=n;r<e;++r)t.push(r);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Ny;function zn(){return Ny==null&&(Ny=WG().epsilon()),Ny}function yi(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ji(n,e){return Ve(n,e)}function Of(n,e=-1){const t=n.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),ae(n,t)}function FY(n,e){return pe(()=>{if(n.shape.length!==2)throw new Q(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);const t=Of(n,1);return y1(t,[1,e,1])})}function LY(n){const e=[oa(n.shape)];return ae(n,e)}function PY(n){if(n.rank<=1)throw new Q(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const e=[n.shape[0],oa(n.shape,1)];return ae(n,e)}function el(n,e,t){return pe(()=>{switch(n.rank){case 1:return w2(n,e,t);case 2:return jA(n,[e,0],[t,n.shape[1]]);case 3:return b2(n,[e,0,0],[t,n.shape[1],n.shape[2]]);case 4:return zm(n,[e,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3]]);case 5:return qt(n,[e,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return qt(n,[e,0,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new Q(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function $y(n,e,t){return pe(()=>{switch(n.rank){case 1:return w2(n,e,t);case 2:return jA(n,[0,e],[n.shape[0],t]);case 3:return b2(n,[0,0,e],[n.shape[0],n.shape[1],t]);case 4:return zm(n,[0,0,0,e],[n.shape[0],n.shape[1],n.shape[2],t]);default:throw new Q(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function Sp(n,e,t,r){return pe(()=>{switch(n.rank){case 1:return w2(n,e,t);case 2:switch(r){case 1:return el(n,e,t);case 2:return $y(n,e,t);default:throw new Q(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return el(n,e,t);case 2:return b2(n,[0,e,0],[n.shape[0],t,n.shape[2]]);case 3:return $y(n,e,t);default:throw new Q(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return el(n,e,t);case 2:return zm(n,[0,e,0,0],[n.shape[0],t,n.shape[2],n.shape[3]]);case 3:return zm(n,[0,0,e,0],[n.shape[0],n.shape[1],t,n.shape[3]]);case 4:return $y(n,e,t);default:throw new Q(`The axis is not within the rank of the tensor ${r}`)}default:throw new Q(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function lC(n,e=-1){let t;return e<0&&(t=n[0].rank,t!==0?e=t:e=0),e===n[0].rank&&(e=-1),Mr(n,e)}function lI(n,e){switch(n.rank){case 1:return Wj([n,e]);case 2:return jj([n,e],0);case 3:return qj([n,e],0);case 4:return Xj([n,e],0);default:throw new Q(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function y1(n,e){if(Array.isArray(e)||(e=[e]),n.rank!==e.length)throw new Q(`The length of input n (${e.length}) does not match the number of dimensions in input x (${n.rank})`);return ui(n,e)}function dv(n,e=0,t=1,r,s){return o9(n,e,t,r,s)}function Hi(n,e,t,r){if(n.rank<2||e.rank<2)throw new ht(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${e.shape}`);if(e.rank>=3){const s=n.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(s!==i)throw new ht(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${e.shape}`)}if(n.rank===2&&e.rank===2)return HE({a:n,b:e,transposeA:!1,transposeB:!1,bias:r?x1(n.rank,r,yi()):null,activation:t});{const s=n.shape.slice(),i=s.pop();n=ae(n,[-1,i]);const o=e.shape.slice(),a=o.pop(),l=o.pop(),u=[...o,a],c=Array.from({length:e.rank},(p,v)=>v===0?e.rank-2:v<=e.rank-2?v-1:v);e=ae(bt(e,c),[l,-1]);const h=[...s,...u];return ae(HE({a:n,b:e,transposeA:!1,transposeB:!1,bias:r?x1(n.rank,r,yi()):null,activation:t}),h)}}function YR(n,e,t){return pe(()=>(Array.isArray(e)?e=Qr(e,"int32"):e=Ve(e,"int32"),s2(n,e,t)))}function Ff(n){return ee(n,n)}function x1(n,e,t){const r=e.shape;if(e.rank!==1&&e.rank!==n)throw new Q(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${n}`);if(n===5){if(t==="channelsFirst")return r.length===1?ae(e,[1,r[0],1,1,1]):ae(e,[1,r[3],r[0],r[1],r[2]]);if(t==="channelsLast")return r.length===1?ae(e,[1,1,1,1,r[0]]):ae(e,[1].concat(r))}else if(n===4){if(t==="channelsFirst")return r.length===1?ae(e,[1,r[0],1,1]):ae(e,[1,r[2],r[0],r[1]]);if(t==="channelsLast")return r.length===1?ae(e,[1,1,1,r[0]]):ae(e,[1].concat(r))}else if(n===3){if(t==="channelsFirst")return r.length===1?ae(e,[1,r[0],1]):ae(e,[1,r[1],r[0]]);if(t==="channelsLast")return r.length===1?ae(e,[1,1,r[0]]):ae(e,[1].concat(r))}else if(n<3)return e;throw new Q(`Unsupported input rank by biasAdd: ${e.rank}`)}function Ci(n,e,t){return pe(()=>(t==null&&(t=yi()),bn(t),De(n,x1(n.rank,e,t))))}function MY(n,e=1){if(e!==1)throw new ht(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return sv(n)}function BY(n){return pe(()=>nt(n,De(br(n),1)))}function ZR(n,e,t,r){return pe(()=>t7(n,e,t,r))}function zY(n){return pe(()=>{const e=De(.5,ee(.2,n));return xs(e,0,1)})}function Lf(n,e,t=!1){return t?n():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const UY=["fanIn","fanOut","fanAvg"],VY=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function WY(n){Ml(UY,"FanMode",n)}function GY(n){Ml(VY,"Distribution",n)}class Xs extends yc{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class QR extends Xs{apply(e,t){return Yn(e,t)}}QR.className="Zeros";Ee(QR);class uC extends Xs{apply(e,t){return Ol(e,t)}}uC.className="Ones";Ee(uC);class JR extends Xs{constructor(e){if(super(),typeof e!="object")throw new Q(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new Q(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return pe(()=>ee(At(this.value),Ol(e,t)))}getConfig(){return{value:this.value}}}JR.className="Constant";Ee(JR);class eO extends Xs{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return Tf(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}eO.className="RandomUniform";Ee(eO);class tO extends Xs{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new ht(`randomNormal does not support dType ${t}.`);return dv(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}tO.className="RandomNormal";Ee(tO);class nO extends Xs{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new ht(`truncatedNormal does not support dType ${t}.`);return KA(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}nO.className="TruncatedNormal";Ee(nO);class rO extends Xs{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return pe(()=>{if(e.length!==2||e[0]!==e[1])throw new Q("Identity matrix initializer can only be used for 2D square matrices.");return ee(this.gain,DA(e[0]))})}getConfig(){return{gain:this.gain}}}rO.className="Identity";Ee(rO);function jY(n,e="channelsLast"){let t,r;if(bn(e),n.length===2)t=n[0],r=n[1];else if([3,4,5].indexOf(n.length)!==-1){if(e==="channelsFirst"){const s=oa(n,2);t=n[1]*s,r=n[0]*s}else if(e==="channelsLast"){const s=oa(n,0,n.length-2);t=n[n.length-2]*s,r=n[n.length-1]*s}}else{const s=oa(n);t=Math.sqrt(s),r=Math.sqrt(s)}return[t,r]}class rs extends Xs{constructor(e){if(super(),e.scale<0)throw new Q(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,WY(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,GY(this.distribution),this.seed=e.seed}apply(e,t){const r=jY(e),s=r[0],i=r[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,s):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(s+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new ht(`${this.getClassName()} does not support dType ${t}.`);return KA(e,0,a,t,this.seed)}else{const a=Math.sqrt(3*o);return Tf(e,-a,a,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}rs.className="VarianceScaling";Ee(rs);class cC extends rs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return rs.className}}cC.className="GlorotUniform";Ee(cC);class hC extends rs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return rs.className}}hC.className="GlorotNormal";Ee(hC);class dC extends rs{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return rs.className}}dC.className="HeNormal";Ee(dC);class fC extends rs{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return rs.className}}fC.className="HeUniform";Ee(fC);class pC extends rs{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return rs.className}}pC.className="LeCunNormal";Ee(pC);class mC extends rs{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return rs.className}}mC.className="LeCunUniform";Ee(mC);class sO extends Xs{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return pe(()=>{if(e.length<2)throw new ht("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError(`Unsupported data type ${t}.`);t=t;const r=we(e.slice(0,-1)),s=e[e.length-1],i=r*s;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(s,r),Math.min(s,r)],a=dv(o,0,1,t,this.seed),l=Z7.qr(a,!1);let u=l[0];const h=l[1].flatten().stridedSlice([0],[Math.min(s,r)*Math.min(s,r)],[Math.min(s,r)+1]);return u=ee(u,h.sign()),r<s&&(u=u.transpose()),ee(At(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}sO.className="Orthogonal";Ee(sO);const uI={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function cI(n,e={}){return Rf(n,Ls.getMap().classNameMap,e,"initializer")}function ln(n){return oC(n)}function sn(n){if(typeof n=="string"){const e=n in uI?uI[n]:n;if(e==="GlorotNormal")return new hC;if(e==="GlorotUniform")return new cC;if(e==="HeNormal")return new dC;if(e==="HeUniform")return new fC;if(e==="LeCunNormal")return new pC;if(e==="LeCunUniform")return new mC;{const t={};return t.className=e,t.config={},cI(t)}}else return n instanceof Xs?n:cI(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function w1(n){return Array.isArray(n)&&Array.isArray(n[0])}function Um(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function rt(n){let e;if(Array.isArray(n)){if(n.length!==1)throw new Q(`Expected Tensor length to be 1; got ${n.length}`);e=n[0]}else e=n;return e}function Et(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return n=n,n[0];throw new Q(`Expected exactly 1 Shape; got ${n.length}`)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Vm(n){let e=0;for(const t of n)t.shape.length===0?e+=1:e+=t.shape.reduce((r,s)=>r*s);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const hI="Variable";class HY{constructor(e,t="float32",r=hI,s=!0,i=null){this.dtype=t??"float32",this.shape=e.shape,this.id=jR(),r=r??hI,this.originalName=qR(r),this.name=KR(this.originalName),this.trainable_=s,this.constraint=i,this.val=Z9(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),qY(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function qY(n,e){if(n.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(e.shape))}function b1(n){return n.map(e=>e.read())}function gC(n){n.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Un{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Li{constructor(e,t,r,s,i,o,a){this.dtype=e,this.shape=t,this.sourceLayer=r,this.inputs=s,this.callArgs=i,this.outputTensorIndex=a,this.id=jR(),o!=null&&(this.originalName=qR(o),this.name=KR(this.originalName)),this.rank=t.length}}let KY=0,fv=class{constructor(e,t){this.callArgs=t,this.id=KY++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const r of e.inboundLayers)r!=null&&r.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},XY=0;class gt extends yc{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=XY++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const r=this.getClassName();t=io(r)+"_"+hv(r)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let r;if(e.batchInputShape!=null)r=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),r=[i].concat(e.inputShape)}this.batchInputShape=r;let s=e.dtype;s==null&&(s=e.inputDType),s==null&&(s="float32"),this.dtype=s}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new Us(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new Q(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Lr(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Lr(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Di(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Di(`Layer ${this.name} is not connected, no input to return.`);return Lr(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Di(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Di(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Lr(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){if(e=Zt(e),this.inputSpec==null||this.inputSpec.length===0)return;const t=Zt(this.inputSpec);if(e.length!==t.length)throw new Q(`Layer ${this.name} expects ${t.length} inputs, but it received ${e.length} input tensors. Input received: ${e}`);for(let r=0;r<e.length;r++){const s=e[r],i=t[r];if(i==null)continue;const o=s.rank;if(i.ndim!=null&&o!==i.ndim)throw new Q(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${o}`);if(i.maxNDim!=null&&o>i.maxNDim)throw new Q(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${o}`);if(i.minNDim!=null&&o<i.minNDim)throw new Q(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${o}.`);if(i.dtype!=null&&s.dtype!==i.dtype)throw new Q(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${s.dtype}.`);if(i.axes){const a=s.shape;for(const l in i.axes){const u=Number(l),c=i.axes[l],h=u>=0?a[u]:a[a.length+u];if(c!=null&&[c,null].indexOf(h)===-1)throw new Q(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${c} but got shape ${a}.`)}}if(i.shape!=null)for(let a=0;a<i.shape.length;++a){const l=i.shape[a],u=s.shape[a];if(l!=null&&u!=null&&l!==u)throw new Q(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${s.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const r=Zt(e);let s=!0;for(const o of r)if(!(o instanceof Li)){s=!1;break}let i=!0;for(const o of r)if(o instanceof Li){i=!1;break}if(s===i)throw new Q("Arguments to apply() must be all SymbolicTensors or all Tensors");return Ja(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of Zt(e))o.push(a.shape);this.build(Lr(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let o=this.call(e,t);const a=Zt(o),l=[];for(let u of a)r.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(o=Lr(l),this.activityRegularizer!=null)throw new ht("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=YY(e),a=this.computeOutputShape(o);let l;const u=ZY(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((c,h)=>new Li(u,c,this,Zt(e),t,this.name,h)):l=new Li(u,a,this,Zt(e),t,this.name),this.addInboundNode(e,l,null,null,o,a,t),this._refCount++,this.activityRegularizer!=null)throw new ht("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((r,s)=>{r!=null&&e[s]!=null&&e[s]!==r&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Di(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const r=JSON.stringify(t.outputShapes);e.indexOf(r)===-1&&e.push(r)}if(e.length===1){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new Di(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Us(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Vm(this.weights)}build(e){this.built=!0}getWeights(e=!1){return b1(e?this.trainableWeights:this.weights)}setWeights(e){pe(()=>{const t=this.weights;if(t.length!==e.length)throw new Q(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;const r=[],s=b1(t);for(let i=0;i<s.length;++i){const o=s[i],a=t[i],l=e[i];if(!Nt(o.shape,l.shape))throw new Q(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);r.push([a,l])}gC(r)})}addWeight(e,t,r,s,i,o,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new Q(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(s=l!=null?l():sn("zeros"));const u=s.apply(t,r),c=new HY(u,r,e,o,a);return u.dispose(),i!=null&&this.addLoss(()=>i.apply(c.read())),o==null&&(o=!0),o?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Zt(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}addInboundNode(e,t,r,s,i,o,a=null){const l=Zt(e);t=Zt(t),r=Zt(r),s=Zt(s),i=Um(i),o=Um(o);const u=[],c=[],h=[];for(const d of l)u.push(d.sourceLayer),c.push(d.nodeIndex),h.push(d.tensorIndex);new fv({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:h,inputTensors:l,outputTensors:t,inputMasks:r,outputMasks:s,inputShapes:i,outputShapes:o},a);for(let d=0;d<t.length;d++)t[d].sourceLayer=this,t[d].nodeIndex=this.inboundNodes.length-1,t[d].tensorIndex=d}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function YY(n){n=Zt(n);const e=[];for(const t of n)e.push(t.shape);return Lr(e)}function ZY(n){return"float32"}function iO(n,e,t){if((e==null||t!=null&&t>0)&&(e=n.sourceLayer,t=n.nodeIndex),e.inboundNodes.length===0)return[n];{const r=e.inboundNodes[t];if(r.inboundLayers.length===0)return r.inputTensors;{const s=[];for(let i=0;i<r.inboundLayers.length;i++){const o=r.inputTensors[i],a=r.inboundLayers[i],l=r.nodeIndices[i],u=iO(o,a,l);for(const c of u)s.indexOf(c)===-1&&s.push(c)}return s}}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Pf extends gt{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:hv("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new Q("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new Q("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new Q("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=e.dtype||"float32";this.batchInputShape=t,this.dtype=r,this.inputSpec=[{shape:t}];const s=new Li(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new fv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new Q(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Pf.className="InputLayer";Ee(Pf);function QY(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new Q("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=n.batchShape;n.shape!=null&&e==null&&(e=[null].concat(n.shape));let t=n.dtype;return t==null&&(t="float32"),new Pf({batchInputShape:e,name:n.name,dtype:t,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function JY(n,e){if(n.dtype==null||n.dtype===e.dtype)return e;try{return Ve(e,n.dtype)}catch{throw new Q(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}class Ho{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Ho)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,r){if(this.id2Value[e.id]==null)this.id2Value[e.id]=JY(e,t),this.name2Id[e.name]=e.id,r!=null&&(this.id2Mask[e.id]=r);else throw new Q(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Li){if(this.id2Value[e.id]==null)throw new Q(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const t=this.name2Id[e];if(t==null)throw new Q(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof Li){if(this.id2Value[e.id]==null)throw new Q(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const t=this.name2Id[e];if(t==null)throw new Q(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&ft(this.id2Mask)}}const Wm=new VR,Gm=new VR;function eZ(n){Wm!=null&&Wm.setMaxEntries(n),Gm!=null&&Gm.setMaxEntries(n)}function oh(n,e,t,r){const s=t==null?!1:t.training,i=Array.isArray(n),o=i?n:[n],a=o.map(p=>p.name),l=[],u=e.names();for(const p of a)u.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const c=a.join(",")+"|"+e.names().sort().join(",");let h=Wm.get(c),d;if(h==null){const p=tZ(o,e);h=p.sorted,d=p.recipientCounts,Wm.put(c,h),Gm.put(c,d)}d={},s||Object.assign(d,Gm.get(c));const f=new Ho(e);for(let p=0;p<h.length;++p){if(r!=null){const T=c1().numTensors;T>r.maxNumTensors&&(r.maxNumTensors=T),T<r.minNumTensors&&(r.minNumTensors=T)}const v=h[p],g=v.sourceLayer;if(g instanceof Pf)continue;const m=[],y=[],w=[];let x=!1;for(const T of v.inputs){const _=f.getValue(T),A=f.getMask(T);m.push(_),y.push(A),A!=null&&(x=!0),s||(d[T.name]--,d[T.name]===0&&!e.hasKey(T)&&a.indexOf(T.name)===-1&&!_.isDisposed&&T.sourceLayer.stateful!==!0&&w.push(_))}x&&(t=t||{},t.mask=y[0]);const b=Zt(g.apply(m,t));let C=null;g.supportsMasking&&(C=g.computeMask(m,y));const k=rZ(v),E=Array.isArray(k)?k:[k];for(let T=0;T<E.length;++T){f.hasKey(E[T])||f.add(E[T],b[T],Array.isArray(C)?C[0]:C);const _=a.indexOf(E[T].name);_!==-1&&(l[_]=b[T])}s||ft(w)}return f.disposeMasks(),i?l:l[0]}function tZ(n,e){O(n!=null&&n.length>0,()=>"Expected at least one fetch, got none");let t=[],r={};if(n.length===1){const s=dI(n[0],e);t=s.sorted,r=s.recipientMap}else{const s=new Set;for(const i of n){const{sorted:o,recipientMap:a}=dI(i,e);for(const l of o)s.has(l.name)||(t.push(l),s.add(l.name));for(const l in a)r[l]==null&&(r[l]=new Set),a[l].forEach(u=>r[l].add(u))}}return{sorted:t,recipientCounts:nZ(r)}}function nZ(n){const e={};for(const t in n)e[t]=n[t].size;return e}function dI(n,e){const t=new Set,r=[],s={};for(const a of e.names())t.add(a);const i=[],o=[];for(i.push(n);i.length>0;){const a=i[i.length-1];if(t.has(a.name)){i.pop();continue}const l=o[o.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),r.push(a),t.add(a.name),l&&o.pop();else{o.push(i.length-1);for(const u of a.inputs)s[u.name]==null&&(s[u.name]=new Set),s[u.name].add(a.name),!t.has(u.name)&&i.push(u)}}return{sorted:r,recipientMap:s}}function rZ(n){let e;if(n.sourceLayer.inboundNodes.length===1)e=n.sourceLayer.output;else{let t=null;for(let r=0;r<n.sourceLayer.inboundNodes.length;++r)for(const s of n.sourceLayer.inboundNodes[r].outputTensors)if(s.id===n.id){t=r;break}e=n.sourceLayer.getOutputAt(t)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sZ=me();sZ.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,eZ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vC(n,e){return pe(()=>Tr(et(ee(n,n),e,!0)))}class Mf extends yc{getConfig(){return{}}}class oO extends Mf{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return pe(()=>{const t=vC(e,this.axis),r=xs(t,0,this.maxValue);return ee(e,nt(r,De(zn(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}oO.className="MaxNorm";Ee(oO);class aO extends Mf{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return pe(()=>nt(e,De(zn(),vC(e,this.axis))))}getConfig(){return{axis:this.axis}}}aO.className="UnitNorm";Ee(aO);class lO extends Mf{apply(e){return Ll(e)}}lO.className="NonNeg";Ee(lO);class uO extends Mf{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return pe(()=>{const t=vC(e,this.axis),r=De(ee(this.rate,xs(t,this.minValue,this.maxValue)),ee(1-this.rate,t));return ee(e,nt(r,De(zn(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}uO.className="MinMaxNorm";Ee(uO);const fI={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Vn(n){return oC(n)}function pI(n,e={}){return Rf(n,Ls.getMap().classNameMap,e,"constraint")}function Wn(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in fI?fI[n]:n,config:{}};return pI(t)}else return n instanceof Mf?n:pI(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Oa(n){if(n==null)return;const e=[],t=[],r=[];for(const s in n){const i=n[s];if(typeof i!="number"){const o=i;e.push(o.data()),t.push(s),r.push(o)}}if(e.length>0){const s=await Promise.all(e);for(let i=0;i<s.length;++i)n[t[i]]=s[i][0];ft(r)}}function cO(n){if(n!=null)for(const e in n){const t=n[e];typeof t!="number"&&t.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var mI;(function(n){n[n.SILENT=0]="SILENT",n[n.VERBOSE=1]="VERBOSE"})(mI||(mI={}));const iZ=125;class Qh{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class oZ{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class aZ extends Qh{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});const r=t.size==null?0:t.size;this.seen+=r;for(const s in t){const i=t[s];if(typeof i=="number")this.totals.hasOwnProperty(s)||(this.totals[s]=0),this.totals[s]=this.totals[s]+i*r;else{let o;s in this.totals?o=this.totals[s]:this.totals[s]=0;const a=pe(()=>De(this.totals[s],ee(i,r)));this.totals[s]=a,o!=null&&o.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?t[r]=this.totals[r]/this.seen:pe(()=>{const s=ee(nt(1,this.seen),this.totals[r]);t[r]=s,this.totals[r].dispose(),Wi(t[r])}))}}class lZ extends Qh{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(const r in t)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(t[r])}async syncData(){const e=[],t=[],r=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];e.push(l.data()),t.push(i),r.push(a)}}const s=await Promise.all(e);for(let i=0;i<s.length;++i)this.history[t[i]][r[i]].dispose(),this.history[t[i]][r[i]]=s[i][0]}}class uZ extends Qh{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||mR,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=iZ),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Xx(this.yieldEvery)&&(this.maybeWait=kY(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,r){const s=[];this.yield!=null&&(await Oa(r),s.push(this.yield(e,t,r))),s.push(this.nextFrameFunc()),await Promise.all(s)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await Oa(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const r=[];this.epochEnd!=null&&(await Oa(t),r.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(e,t){this.batchBegin!=null&&(await Oa(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const r=[];this.batchEnd!=null&&(await Oa(t),r.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):Xx(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(r)}async onTrainBegin(e){this.trainBegin!=null&&(await Oa(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Oa(e),await this.trainEnd(e))}}function hO(n,e){return n==null&&(n={}),n instanceof Qh?[n]:Array.isArray(n)&&n[0]instanceof Qh?n:Zt(n).map(r=>new uZ(r,e))}class As{constructor(){}static registerCallbackConstructor(e,t){O(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),As.checkForDuplicate(t),As.constructors[e]==null&&(As.constructors[e]=[]),As.constructors[e].push(t)}static checkForDuplicate(e){for(const t in As.constructors)As.constructors[+t].forEach(s=>{if(s===e)throw new Q("Duplicate callback constructor.")})}static clear(){As.constructors={}}static createCallbacks(e){const t=[];for(const r in As.constructors){const s=+r;e>=s&&t.push(...As.constructors[s])}return t.map(r=>new r)}}As.constructors={};function dO(n,e,t,r,s,i,o,a,l){const u=new lZ,c=[new aZ,...As.createCallbacks(e)];n!=null&&c.push(...n),c.push(u);const h=new oZ(c);return h.setParams({epochs:t,initialEpoch:r,samples:s,steps:i,batchSize:o,verbose:e,doValidation:a,metrics:l}),{callbackList:h,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qi(n,e={},t=!1){return Rf(n,Ls.getMap().classNameMap,e,"layer",t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jm(n,e){return pe(()=>{n.dtype!=="float32"&&(n=Ve(n,"float32"));const t=et(Ff(n),e,!0),r=rv(t.shape,zn()),s=Tr(Ia(t,r));return nt(n,s)})}function pv(n,e){return pe(()=>An(Ff(st(e,n)),-1))}function yC(n,e){return pe(()=>An(br(st(e,n)),-1))}function xC(n,e){return pe(()=>{const t=st(n,e),r=xs(br(n),zn(),Number.MAX_VALUE),s=br(nt(t,r));return ee(100,An(s,-1))})}function cZ(n,e){return pe(()=>{const t=xs(e,zn(),Number.MAX_VALUE),r=Xi(De(1,t)),s=xs(n,zn(),Number.MAX_VALUE),i=Xi(De(1,s));return An(Ff(st(r,i)),-1)})}function hZ(n,e){return pe(()=>{const t=Ia(0,st(1,ee(n,e)));return An(Ff(t),-1)})}function dZ(n,e){return pe(()=>{const t=Ia(0,st(1,ee(n,e)));return An(t,-1)})}function fZ(n,e){return pe(()=>{const t=et(ee(n,e),-1),r=pi(ee(st(1,n),e),-1);return Ia(0,De(1,st(r,t)))})}function pZ(n,e){return pe(()=>{const t=Math.log(2),r=st(e,n),s=st(De(r,If(ee(-2,r))),t);return An(s,-1)})}function Jh(n,e,t=!1){return pe(()=>{if(t)e=C2(e);else{const r=et(e,e.shape.length-1,!0);e=nt(e,r)}return e=xs(e,zn(),1-zn()),yn(et(ee(Ve(n,"float32"),Xi(e)),e.shape.length-1))})}function Hm(n,e,t=!1){return pe(()=>{const r=Ve(ov(LY(n)),"int32");e=xs(e,zn(),1-zn());const s=e.shape,i=ae(FA(r,s[s.length-1]),s);return Jh(i,e,t)})}function mZ(n,e){if(!Nt(n.shape,e.shape))throw new Q(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(e.shape)}`);return pe(()=>{const t=Ll(e),r=yn(br(e));return De(st(t,ee(e,n)),AA(xo(r)))})}function mv(n,e){return pe(()=>{let t;return t=xs(e,zn(),1-zn()),t=Xi(nt(t,st(1,t))),An(mZ(n,t),-1)})}function gZ(n,e){return pe(()=>{const t=xs(n,zn(),1),r=xs(e,zn(),1);return et(ee(n,Xi(nt(t,r))),-1)})}function vZ(n,e){return pe(()=>{const t=Xi(De(zn(),e));return An(st(e,ee(n,t)),-1)})}function fO(n,e){return pe(()=>{const t=jm(n,-1),r=jm(e,-1),s=ee(t,r);return yn(et(s,-1))})}const qm={meanSquaredError:pv,meanAbsoluteError:yC,meanAbsolutePercentageError:xC,meanSquaredLogarithmicError:cZ,squaredHinge:hZ,hinge:dZ,categoricalHinge:fZ,logcosh:pZ,categoricalCrossentropy:Jh,sparseCategoricalCrossentropy:Hm,binaryCrossentropy:mv,kullbackLeiblerDivergence:gZ,poisson:vZ,cosineProximity:fO};function Dy(n){if(typeof n=="string"){if(n in qm)return qm[n];let e=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new Q(e)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pO(n,e){return pe(()=>{const t=ee(.5,qs(e)),r=ji(Cs(e,t),n.dtype);return An(Ki(n,r),-1)})}function mO(n,e){return pe(()=>ji(Ki(qh(n,-1),qh(e,-1)),"float32"))}function yZ(n,e){return pe(()=>Ve(et(wo(Ki(n,1),Ki(e,1))),"float32"))}function xZ(n,e){return pe(()=>Ve(et(wo(Ki(n,0),Ki(e,1))),"float32"))}function wZ(n,e){return pe(()=>{const t=yZ(n,e),r=xZ(n,e),s=De(t,r);return Ve(Er(Cs(s,0),nt(t,s),0),"float32")})}function bZ(n,e){return mv(n,e)}function CZ(n,e){return n.rank===e.rank&&(n=_f(n,[n.rank-1])),e=qh(e,-1),e.dtype!==n.dtype&&(e=Ve(e,n.dtype)),Ve(Ki(n,e),"float32")}const SZ=pv,kZ=pv,EZ=yC,IZ=yC,TZ=xC,_Z=xC,gO=Jh,NZ=fO,vO=Hm,Km={binaryAccuracy:pO,categoricalAccuracy:mO,precision:wZ,categoricalCrossentropy:gO,sparseCategoricalCrossentropy:vO,mse:SZ,MSE:kZ,mae:EZ,MAE:IZ,mape:TZ,MAPE:_Z,cosine:NZ};function $Z(n){if(typeof n=="string"&&n in Km)return Km[n];if(typeof n!="string"&&n!=null)return n;throw new Q(`Unknown metric ${n}`)}function kp(n){if(Ai(n!==null,`Unknown LossOrMetricFn ${n}`),typeof n=="string")return n;{let e;for(const t of Object.keys(qm))if(qm[t]===n){e=t;break}if(e!==void 0)return e;for(const t of Object.keys(Km))if(Km[t]===n){e=t;break}return e!==void 0?e:n.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function DZ(n){const e={Adagrad:()=>tu.adagrad(.01),Adadelta:()=>tu.adadelta(1,.95,zn()),Adam:()=>tu.adam(.001,.9,.999,zn()),Adamax:()=>tu.adamax(.002,.9,.999,zn(),0),RMSProp:()=>tu.rmsprop(.001,.9,0,zn()),SGD:()=>tu.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,n in e)return e[n]();throw new Q(`Unknown Optimizer ${n}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const gI=1*1024*1024;function vI(n,e,t=!1){if(n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!C1(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){const r=JSON.stringify(n);r.length>gI&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${gI}.`)}}function C1(n){if(n===null)return!0;if(typeof n=="object")if(Object.getPrototypeOf(n)===Object.prototype){const e=Object.keys(n);for(const t of e)if(typeof t!="string"||!C1(n[t]))return!1;return!0}else if(Array.isArray(n)){for(const e of n)if(!C1(e))return!1;return!0}else return!1;else{const e=typeof n;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function AZ(n,e,t,r=console.log){const s=OZ(n),i=["Layer (type)","Input Shape","Output shape","Param #"];s?(e=e||90,t=t||[.32,.61,.89,1]):(e=e||115,t=t||[.24,.48,.7,.8,1]),t[t.length-1]<=1&&(t=t.map(c=>Math.floor(e*c)));let o;if(!s){i.push("Receives inputs"),o=[];for(const c in n.nodesByDepth)o.push(...n.nodesByDepth[c])}r("_".repeat(e)),Xm(i,t,r),r("=".repeat(e));const a=n.layers;for(let c=0;c<a.length;++c)s?FZ(a[c],t,r):LZ(a[c],t,o,r),r((c===a.length-1?"=":"_").repeat(e));n.checkTrainableWeightsConsistency();const l=RZ(n),u=Vm(n.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(e))}function RZ(n){let e;return n.collectedTrainableWeights!=null?e=Vm(n.collectedTrainableWeights):e=Vm(n.trainableWeights),e}function OZ(n){let e=!0;const t=[],r=[];for(const s in n.nodesByDepth)t.push(n.nodesByDepth[s]);for(const s of t){if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){e=!1;break}r.push(...s)}if(e)for(const s of n.layers){let i=!1;for(const o of s.inboundNodes)if(r.indexOf(o)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function Xm(n,e,t=console.log){let r="";for(let s=0;s<n.length;++s)s>0&&(r=r.slice(0,r.length-1)+" "),r+=n[s],r=r.slice(0,e[s]),r+=" ".repeat(e[s]-r.length);t(r)}function FZ(n,e,t){let r,s;try{s=n.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{s="multiple"}try{r=JSON.stringify(n.outputShape)}catch{r="multiple"}const i=n.name,o=n.getClassName(),a=[`${i} (${o})`,s,r,n.countParams().toString()];Xm(a,e,t)}function LZ(n,e,t,r){let s,i;try{i=n.inboundNodes.map(h=>JSON.stringify(h.inputShapes)).join(",")}catch{i="multiple"}try{s=JSON.stringify(n.outputShape)}catch{s="multiple"}const o=[];for(const h of n.inboundNodes)if(!(t!=null&&t.length>0&&t.indexOf(h)===-1))for(let d=0;d<h.inboundLayers.length;++d){const f=h.inboundLayers[d].name,p=h.nodeIndices[d],v=h.tensorIndices[d];o.push(`${f}[${p}][${v}]`)}const a=n.name,l=n.getClassName(),u=o.length===0?"":o[0],c=[`${a} (${l})`,i,s,n.countParams().toString(),u];Xm(c,e,r);for(let h=1;h<o.length;++h)Xm(["","","","",o[h]],e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yO(n,e,t){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&e===0&&typeof t=="string"}function Ym(n,e){if(n===null)return null;if(typeof n=="string")return Ua(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],r=n.length;for(let s=0;s<r;++s){const i=n[s];yO(e,s,i)?t.push(i):t.push(Ym(i,e))}return t}else{const t={};for(const r of Object.keys(n)){const s=n[r];if(r==="name"&&typeof s=="string")t[r]=s;else{const i=Ua(r);t[i]=Ym(s,i)}}return t}}function S1(n,e){if(n==null)return null;if(typeof n=="string")return io(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],r=n.length;for(let s=0;s<r;++s){const i=n[s];yO(e,s,i)?t.push(i):t.push(S1(i,e))}return t}else{const t={};for(const r of Object.keys(n)){const s=n[r],i=io(r);(r==="name"||r==="className")&&typeof s=="string"?t[i]=s:t[i]=S1(s,r)}return t}}/** @license See the LICENSE file. */const xO="4.10.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ni extends gt{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const y=this.getClassName().toLowerCase();this.name=hv(y)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],ia(this.inputs).length!==this.inputs.length)throw new Q(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(y=>y.name)}`);ia(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(y=>y.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const w=y.sourceLayer,x=y.nodeIndex,b=y.tensorIndex;this.outputLayers.push(w),this.outputLayersNodeIndices.push(x),this.outputLayersTensorIndices.push(b)}for(const y of this.inputs){const w=y.sourceLayer,x=y.nodeIndex,b=y.tensorIndex;Ai(x===0,"input layer has >1 nodes"),Ai(b===0,"input layer has >1 tensors"),this.inputLayers.push(w),this.inputLayersNodeIndices.push(x),this.inputLayersTensorIndices.push(b)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const w=this.inputLayers[y];if(!(w instanceof Pf))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${y} (0-based) originates from layer type ${w.getClassName()}.`);this.inputNames.push(w.name),this.feedInputShapes.push(w.batchInputShape),this.feedInputNames.push(w.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(y=>y.shape),this.internalOutputShapes=this.outputs.map(y=>y.shape);const t={},r={},s={},i={},o={},a=[],l=(y,w,x,b,C,k)=>{(b==null||C==null||k==null)&&(b=y.sourceLayer,C=y.nodeIndex,k=y.tensorIndex);const E=b.inboundNodes[C];if(x.indexOf(E)!==-1)throw new Us(`The tensor ${y.name} at layer "${b.name}" is part of a cycle.`);if(w.indexOf(E)!==-1)return;this.containerNodes.add(ni.nodeKey(b,C)),b.id in o||(o[b.id]=Object.keys(o).length),x.indexOf(E)===-1&&x.push(E);const T=E.inboundLayers.length;for(let _=0;_<T;_++){const A=E.inputTensors[_],P=E.inboundLayers[_],j=E.nodeIndices[_],X=E.tensorIndices[_];l(A,w,x,P,j,X)}for(w.push(E);x.indexOf(E)>=0;)x.splice(x.indexOf(E),1);a.push(E)},u=[],c=[];for(const y of this.outputs)l(y,u,c);const h=a.slice().reverse();for(const y of h){r[y.id]=y,y.id in t||(t[y.id]=0);let w=t[y.id];const x=s[y.outboundLayer.id]==null?0:s[y.outboundLayer.id];w=Math.max(w,x),s[y.outboundLayer.id]=w,i[y.outboundLayer.id]=y.outboundLayer,t[y.id]=w;for(let b=0;b<y.inboundLayers.length;b++){const C=y.inboundLayers[b],k=y.nodeIndices[b],E=C.inboundNodes[k],T=t[E.id]==null?0:t[E.id];t[E.id]=Math.max(w+1,T),r[E.id]=E}}const d={};for(const y in t){const w=t[y];w in d||(d[w]=[]),d[w].push(r[y])}const f={};for(const y in s){const w=s[y];w in f||(f[w]=[]),f[w].push(i[y])}let p=Object.keys(f).map(y=>parseInt(y,10)).sort(bp);this.layers=[];for(const y of p){const w=f[y];w.sort((x,b)=>{const C=o[x.id],k=o[b.id];return C<k?-1:C>k?1:0});for(const x of w)x instanceof ni&&this.internalContainerRefs.push(x),this.layers.push(x)}this.layersByDepth=f,p=Object.keys(d).map(y=>parseInt(y,10)).sort(bp);const v=this.inputs.slice(),g=[];for(const y of p)for(const w of d[y]){const x=w.outboundLayer;if(x!=null){for(const b of w.inputTensors)if(v.indexOf(b)===-1)throw new Us(`Graph disconnected: cannot obtain value for tensor ${b} at layer "${x.name}". The following previous layers were accessed without issue: ${g}`);for(const b of w.outputTensors)v.push(b);g.push(x.name)}}this.nodesByDepth=d;const m=this.layers.map(y=>y.name);for(const y of m){const w=m.filter(x=>x===y).length;if(w!==1)throw new Us(`The name "${y}" is used ${w} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(m))}this.outboundNodes=[],this.inboundNodes=[],new fv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(y=>null),outputMasks:this.outputs.map(y=>null),inputShapes:this.inputs.map(y=>y.shape),outputShapes:this.outputs.map(y=>y.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(r=>r.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new Q("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const r of this.layers)t.push(...r.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const r={};let s=0;const i=Object.keys(e)[0].split("/"),o=!isNaN(parseInt(i[i.length-1],10));for(const l of this.layers)for(const[u,c]of l.weights.entries()){const h=o?`${c.name.split("/").slice(0,-1).join("/")+"/"}${u}`:c.originalName;if(r[h]!=null)throw new Q(`Duplicate weight name: ${h}`);r[h]=c,s++}const a=[];for(const l in e){let u=l;if(r[l]==null){const c=l.split("/");u=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(r[u]!=null)a.push([r[u],e[l]]);else if(t)throw new Q(`Provided weight data has no target variable: ${l}`);delete r[u]}if(t){const l=[];for(const u in r)l.push(u);if(l.length>0)throw new Q(`${l.length} of ${s} weights are not set: ${l}`)}gC(a)}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${xO}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){const r=S1(this.updatedConfig());return t?JSON.stringify(r):r}call(e,t){return pe(()=>{e=Zt(e);const r=new Ho;for(let s=0;s<this.inputs.length;++s)r.add(this.inputs[s],e[s]);return oh(this.outputs,r,t)})}computeMask(e,t){return pe(()=>{e=Zt(e);let r;return t==null?r=wl(null,e.length):r=Zt(t),this.runInternalGraph(e,r)[1]})}computeOutputShape(e){const t=Um(e);if(t.length!==this.inputLayers.length)throw new Q(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let a=0;a<t.length;a++){const l=this.inputLayers[a],u=t[a],c=l.name+"_0_0";r[c]=u}const s=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(bp);if(s.length>1)for(const a of s){const l=this.nodesByDepth[a];for(const u of l){const c=u.outboundLayer;if(this.inputLayers.map(v=>v.id).indexOf(c.id)!==-1)continue;const h=[];for(let v=0;v<u.inboundLayers.length;v++){const g=u.inboundLayers[v],m=u.nodeIndices[v],y=u.tensorIndices[v],w=`${g.name}_${m}_${y}`,x=r[w];h.push(x)}const d=c.computeOutputShape(Lr(h)),f=Um(d),p=c.inboundNodes.indexOf(u);for(let v=0;v<f.length;v++){const g=`${c.name}_${p}_${v}`;r[g]=f[v]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],u=this.outputLayersNodeIndices[a],c=this.outputLayersTensorIndices[a],h=`${l.name}_${u}_${c}`;o.push(h)}for(let a=0;a<o.length;a++){const l=o[a];Ai(l in r),i.push(r[l])}return Lr(i)}runInternalGraph(e,t){t==null&&(t=wl(null,e.length));const r={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],c=e[l],h=t[l];r[u.id]=[c,h]}const s=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(bp);for(const l of s){const u=this.nodesByDepth[l];for(const c of u){const h=c.outboundLayer,d=c.inputTensors,f=c.outputTensors,p=new Array;for(const v of d)v.id in r&&p.push(r[v.id]);if(p.length===d.length){let v={},g,m,y,w;if(c.callArgs!=null&&(v=c.callArgs),p.length===1){const[x,b]=p[0];v.mask==null&&(v.mask=b),y=Zt(h.call(x,v)),w=Zt(h.computeMask(x,b)),g=[x],m=[b]}else g=p.map(x=>x[0]),m=p.map(x=>x[1]),v.mask==null&&(v.mask=m),y=Zt(h.call(g,v)),w=Zt(h.computeMask(g,m));if(h.activityRegularizer)throw new ht("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let x=0;x<f.length;++x){const b=f[x],C=y[x],k=w[x];r[b.id]=[C,k]}}}}const i=[],o=[],a=[];for(const l of this.outputs){Ai(l.id in r,`Could not compute output ${l.name} : ${l.id}`);const[u,c]=r[l.id];a.push(u.shape),i.push(u),o.push(c)}return[i,o,a]}buildNodeConversionMap(e){const t={};let r;for(const s of this.layers){r=s instanceof ni?1:0;for(let i=0;i<s.inboundNodes.length;i++){const o=ni.nodeKey(s,i);this.containerNodes.has(o)&&(t[o]=r,r+=1)}}return t}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new Q("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const r of this.layers)if(r.name===e)return r;throw new Q(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new Q(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return pe(()=>{const e=[];for(const t of this.layers)for(let r=0;r<t.inboundNodes.length;++r){const s=ni.nodeKey(t,r);this.containerNodes.has(s)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),r=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),u=[];for(let h=0;h<o.inboundNodes.length;h++){const d=o.inboundNodes[h],f=ni.nodeKey(o,h);let p={};if(this.containerNodes.has(f)){if(d.callArgs)try{JSON.stringify(d.callArgs),p=d.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${d.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(d.inboundLayers.length>0){const v=[];for(let g=0;g<d.inboundLayers.length;g++){const m=d.inboundLayers[g],y=d.nodeIndices[g],w=d.tensorIndices[g],x=ni.nodeKey(m,y);let b=t[x];b==null&&(b=0),v.push([m.name,b,w,p])}u.push(v)}}}const c={};c.name=o.name,c.className=a,c.config=l,c.inboundNodes=u,r.push(c)}e.layers=r;const s=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],u=ni.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=t[u];c==null&&(c=0);const h=this.inputLayersTensorIndices[o];s.push([a.name,c,h])}e.inputLayers=s;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],u=ni.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=t[u];c==null&&(c=0);const h=this.outputLayersTensorIndices[o];i.push([a.name,c,h])}return e.outputLayers=i,e}static fromConfig(e,t,r={},s=!1){const i={},o={};function a(g,m){g.name in o?o[g.name].push(m):o[g.name]=[m]}function l(g,m){const y=[];let w;for(const x of m){const b=x[0],C=x[1],k=x[2];if(w=x[3]==null?{}:x[3],!(b in i)){a(g,m);return}const E=i[b];if(E.inboundNodes.length<=C){a(g,m);return}const T=E.inboundNodes[C];y.push(T.outputTensors[k])}y.length>0&&g.apply(Lr(y),w)}function u(g){const m=g.name,y=qi(g,t.customObjects!=null?t.customObjects:{});y.setFastWeightInitDuringBuild(s),i[m]=y,g.inboundNodes.forEach(x=>{if(!(x instanceof Array))throw new Q(`Corrupted configuration, expected array for nodeData: ${x}`);a(y,x)})}const c=t.name,h=t.layers;for(const g of h)u(g);for(;!SY(o);)for(const g of h){const m=i[g.name];if(m.name in o){const y=o[m.name];delete o[m.name];for(const w of y)l(m,w)}}const d=[],f=[],p=t.inputLayers;for(const g of p){const m=g[0],y=g[1],w=g[2];Ai(m in i);const b=i[m].inboundNodes[y].outputTensors;d.push(b[w])}const v=t.outputLayers;for(const g of v){const m=g[0],y=g[1],w=g[2];Ai(m in i);const b=i[m].inboundNodes[y].outputTensors;f.push(b[w])}return new e({inputs:d,outputs:f,name:c})}get stateful(){if(this._stateful)throw new Q("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){pe(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function PZ(n,e,t){const r=e.length;if(n==null||Array.isArray(n)&&n.length===0)return e.map(s=>null);if(r===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&e[0]in n?[n[e[0]]]:[n];if(Array.isArray(n)){if(n.length!==r)throw new Error(`Provided ${t} is an array of ${n.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return n}else if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){const s=[];return e.forEach(i=>{i in n?s.push(n[i]):s.push(null)}),s}else throw new Error(`The model has multiple (${r}) outputs, so ${t} must be either an array with ${r} elements or an object with ${e} keys. Provided ${t} not understood: ${JSON.stringify(n)}`)}function wO(n,e){return PZ(n,e,"classWeight")}async function bO(n,e,t,r){if(e!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");if(t!=null){const s=pe(()=>{if(n.shape.length===1)return Qa(n);if(n.shape.length===2){if(n.shape[1]>1)return qh(n,1);if(n.shape[1]===1)return ae(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await s.data());ft(s);const o=[];return i.forEach(a=>{if(t[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(t[a])}),Qr(o,"float32")}else return null}function MZ(n,e){return ee(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const BZ=32;function CO(n,e){let t,r;const s=e;t=s.xs,r=s.ys,O(t!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=yI("input",n.inputNames,t),o=yI("output",n.outputNames,r),a=i[0].shape[0];O(i.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),O(o.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let l=0;l<i.length;l++)O(i[l].shape[0]===a,()=>`Batch size mismatch: input ${n.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);for(let l=0;l<o.length;l++)O(o[l].shape[0]===a,()=>`Batch size mismatch: output ${n.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);return{xs:i,ys:o}}function yI(n,e,t){if(t instanceof Dn)return[t];if(Array.isArray(t))return O(t.length===e.length,()=>`Received an array of ${t.length} Tensors, but expected ${e.length} to match the ${n} keys ${e}.`),t;{const r=[];for(const s of e){if(t[s]==null)throw new Q(`The feature data generated by the dataset lacks the required ${n} key '${s}'.`);r.push(t[s])}return r}}function zZ(n){if(n.length===3)throw new ht("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}async function UZ(n,e,t){const r=t.batchesPerEpoch!=null;if(O(n.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),O(t!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),O(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${t.epochs}`),O(!r||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${t.batchesPerEpoch}`),O(t.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const s=t.validationData!=null;let i,o;if(s)if(xI(t.validationData))O(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${t.validationBatches}`);else{const g=zZ(t.validationData);i=g.xs,o=g.ys}const a=n.makeTrainFunction(),l=n.getDedupedMetricsNames();let u;s?u=l.slice().concat(l.map(g=>"val_"+g)):u=l.slice();const c=hO(t.callbacks,t.yieldEvery),h=t.verbose==null?1:t.verbose,{callbackList:d,history:f}=dO(c,h,t.epochs,null,null,VZ(e,t),null,s,u);d.setModel(n),n.history=f,await d.onTrainBegin(),n.stopTraining_=!1;let p=t.initialEpoch==null?0:t.initialEpoch,v=await e.iterator();for(;p<t.epochs;){const g={};await d.onEpochBegin(p);let m=0,y=0;for(r||(v=await e.iterator());!r||m<t.batchesPerEpoch;){const w=await v.next();if(r&&w.done){console.warn(`You provided \`batchesPerEpoch\` as ${t.batchesPerEpoch}, but your dataset iterator ran out of data after ${m} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${t.batchesPerEpoch*t.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(w.value!=null){const{xs:x,ys:b}=CO(n,w.value),C={};C.batch=y,C.size=x[0].shape[0],await d.onBatchBegin(y,C);const k=[];if(t.classWeight!=null){const _=wO(t.classWeight,n.outputNames);for(let A=0;A<_.length;++A)k.push(await bO(b[A],null,_[A]))}const E=x.concat(b).concat(k),T=a(E);ft(E);for(let _=0;_<l.length;++_){const A=l[_],P=T[_];C[A]=P,Wi(P)}await d.onBatchEnd(y,C),cO(C),y++,m++}if(r?m>=t.batchesPerEpoch:w.done){if(s){let x;xI(t.validationData)?x=Zt(await n.evaluateDataset(t.validationData,{batches:t.validationBatches})):x=Zt(n.evaluate(i,o,{batchSize:t.validationBatchSize==null?BZ:t.validationBatchSize,verbose:0}));for(let b=0;b<n.metricsNames.length;++b)g[`val_${n.metricsNames[b]}`]=x[b]}break}if(n.stopTraining_)break}if(await d.onEpochEnd(p,g),p++,n.stopTraining_)break}return await d.onTrainEnd(),await n.history.syncData(),n.history}finally{n.isTraining=!1}}function VZ(n,e){let t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(n.size)&&(t=n.size),t}function xI(n){return typeof n.iterator=="function"}function WZ(n){return typeof n.next=="function"}async function GZ(n,e,t){t=t||{};const r=t.batches!=null,s=n.testFunction;let i=[];if(t.verbose>0)throw new ht("Verbose mode is not implemented yet.");O(!r||t.batches>0&&Number.isInteger(t.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(t.batches)}`);const o=WZ(e)?e:await e.iterator();let a=0,l=0;for(;!r||l<t.batches;){const u=await o.next();if(i=pe(()=>{if(u.value){const{xs:c,ys:h}=CO(n,u.value),d=c.concat(h),f=pe(()=>s(d));if(ft(d),l===0)for(let v=0;v<f.length;++v)i.push(At(0));const p=d[0].shape[0];for(let v=0;v<f.length;++v){const g=f[v],m=i[v];i[v]=pe(()=>De(i[v],ee(p,g))),l>0&&ft(m)}ft(f),a+=p,++l}return i}),u.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${t.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<i.length;++u){const c=i[u];i[u]=nt(i[u],a),ft(c)}return Lr(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ay(n){O(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function Qc(n,e,t){return n==null?[null]:Array.isArray(n)?n.map(r=>el(r,e,t-e)):el(n,e,t-e)}function k1(n,e){return pe(()=>n==null?null:Array.isArray(n)?n.map(t=>k1(t,e)):YR(n,e.dtype==="int32"?e:Ve(e,"int32")))}function Ry(n,e){const t=[];let r=0,s=null;for(;r<n;)s=r+e,s>=n&&(s=n),t.push([r,s]),r=s;return t}function SO(n){const e=[];n instanceof Dn&&(n=[n]);for(let t=0;t<n.length;++t){const r=n[t];if(r.rank===1)e.push(Of(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function ti(n,e){if(n==null)return;const t=[];if(e instanceof Dn)t.push(e.id);else if(Array.isArray(e))e.forEach(s=>t.push(s.id));else if(e!=null)for(const s in e){const i=e[s];t.push(i.id)}const r=[];if(n instanceof Dn)t.indexOf(n.id)===-1&&r.push(n);else if(Array.isArray(n))n.forEach(s=>{t.indexOf(s.id)===-1&&r.push(s)});else if(n!=null)for(const s in n){const i=n[s];t.indexOf(i.id)===-1&&r.push(i)}r.forEach(s=>{s.isDisposed||s.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jZ(n){return n instanceof Dn}function E1(n){return Array.isArray(n)}function wI(n){return!jZ(n)&&!E1(n)}function bI(n,e,t,r=!0,s=""){if(e==null||e.length===0){if(n!=null){let o=!1;if(E1(n)&&n.length>0)o=!0;else if(wI(n)){for(const a in n)if(n.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new Q(`Error when checking model ${s} expected no data, but got ${n}`)}return[]}if(n==null)return e.map(o=>null);let i;if(wI(n)){n=n,i=[];for(const o of e){if(n[o]==null)throw new Q(`No data provided for "${o}". Need data for each key in: ${e}`);i.push(n[o])}}else if(E1(n)){if(n=n,n.length!==e.length)throw new Q(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);i=n}else{if(n=n,e.length>1)throw new Q(`The model ${s} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);i=[n]}if(i=SO(i),t!=null)for(let o=0;o<e.length;++o){if(t[o]==null)continue;const a=i[o];if(a.shape.length!==t[o].length)throw new Q(`Error when checking ${s}: expected ${e[o]} to have ${t[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<t[o].length;++l){if(l===0&&!r)continue;const u=a.shape[l],c=t[o][l];if(c!=null&&c>=0&&u!==c)throw new Q(`${s} expected a batch of elements where each example has shape [${t[o].slice(1,t[o].length)}] (i.e.,tensor shape [*,${t[o].slice(1,t[o].length)}]) but the ${s} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function HZ(n,e,t){const r=ia(n.map(i=>i.shape[0]));r.sort();const s=ia(e.map(i=>i.shape[0]));if(s.sort(),r.length>1)throw new Q(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(i=>i.shape))}`);if(s.length>1)throw new Q(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(r.length>0&&s.length>0&&!Nt(r,s))throw new Q(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${s[0]} target sample(s).`)}function qZ(n,e,t){const r=[pv,mv,Jh];for(let s=0;s<n.length;++s){const i=n[s],o=e[s],a=t[s];if(o!=null){if(o===Jh&&i.shape[i.shape.length-1]===1)throw new Q(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(o)!==-1){const l=i.shape.slice(1),u=a.slice(1);for(let c=0;c<l.length;++c){const h=l[c],d=u[c];if(d!=null&&h!==d)throw new Q(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function CI(n,e,t,r=!0,s=""){let i;if(Array.isArray(n)){if(n.length!==e.length)throw new Q(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${n.length} Tensors(s).`);i=n}else{if(e.length>1)throw new Q(`The model expects ${e.length} ${s} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);i=[n]}if(t!=null)for(let o=0;o<e.length;++o){if(t[o]==null)continue;const a=i[o];if(a.shape.length!==t[o].length)throw new Q(`Error when checking ${s}: expected ${e[o]} to have ${t[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<t[o].length;++l){if(l===0&&!r)continue;const u=a.shape[l],c=t[o][l];if(c!=null&&c!==u)throw new Q(`Error when checking ${s}: expected ${e[o]} to have shape ${JSON.stringify(t[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function KZ(n,e){if(n==null||Array.isArray(n)&&n.length===0)return e.map(r=>[]);let t;if(typeof n=="string"||typeof n=="function")t=[n];else if(Array.isArray(n)||typeof n=="object")t=n;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);if(Array.isArray(t))return e.map(r=>t);{const r=[];for(const s of e){let i=t.hasOwnProperty(s)?t[s]:[];Array.isArray(i)||(i=[i]),r.push(i)}return r}}const XZ="layers-model";class Ru extends ni{constructor(e){super(e),this.isTraining=!1}summary(e,t,r=console.log){if(!this.built)throw new Q("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");AZ(this,e,t,r)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=DZ(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Ta))throw new Q("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new Q(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),t.push(Dy(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new Q(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(a=>Dy(a))}else{const o=Dy(e.loss);this.outputs.forEach(a=>{t.push(o)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const r=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Ja("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const s=KZ(e.metrics,this.outputNames),i=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};Ja("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=s[o];(u=>{const c="";let h,d,f;for(const p of u){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const g=this.internalOutputShapes[o];g[g.length-1]===1||this.lossFunctions[o]===mv?["accuracy","acc"].indexOf(p)!==-1?d=pO:["crossentropy","ce"].indexOf(p)!==-1&&(d=bZ):this.lossFunctions[o]===Hm?["accuracy","acc"].indexOf(p)!==-1?d=CZ:["crossentropy","ce"].indexOf(p)!==-1&&(d=vO):["accuracy","acc"].indexOf(p)!==-1?d=mO:["crossentropy","ce"].indexOf(p)!==-1&&(d=gO);let m;["accuracy","acc"].indexOf(p)!==-1?m="acc":["crossentropy","ce"].indexOf(p)!==-1&&(m="ce"),f=d,h=c+m}else f=$Z(p),h=c+kp(p);let v;Ja(h,()=>{v=f}),i(o,h,v)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,r={}){const s=r.batchSize==null?32:r.batchSize;Ay(s);const i=!0,o=this.standardizeUserDataXY(e,t,i,s);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,a,s,r.verbose,r.steps);return Lr(u)}finally{ti(o[0],e),ti(o[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),GZ(this,e,t)}checkNumSamples(e,t,r,s="steps"){let i;if(r!=null){if(i=null,t!=null)throw new Q(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new Q(`Either the input data should have a defined shape, or ${s} shoud be specified.`);return i}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new Q("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(t),s=r?t:[t],i=this.retrieveSymbolicTensors(s),o=new Ho;if(e instanceof Dn&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new Q(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],e[l])}else for(const l of this.inputs){const u=e[l.name];if(u==null)throw new Q(`No value is provided for the model's input ${l.name}`);o.add(l,u)}const a=oh(i,o);return r?a:a[0]}retrieveSymbolicTensors(e){const t=wl(null,e.length);let r=e.length;for(const s of this.layers){const i=Array.isArray(s.output)?s.output:[s.output],o=i.map(a=>a.name);for(let a=0;a<e.length;++a){const l=o.indexOf(e[a]);if(l!==-1&&(t[a]=i[l],r--),r===0)break}if(r===0)break}if(r>0){const s=[];throw t.forEach((i,o)=>{i==null&&s.push(e[o])}),new Q(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return t}predictLoop(e,t=32,r=!1){return pe(()=>{const s=this.checkNumSamples(e);if(r)throw new ht("Verbose predictLoop() is not implemented yet.");const i=Ry(s,t),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)pe(()=>{const u=i[a][0],c=i[a][1],h=Qc(e,u,c),d=[];if(Array.isArray(h))for(let p=0;p<h.length;++p)d.push({key:this.inputs[p],value:h[p]});else d.push({key:this.inputs[0],value:h});const f=new Ho(d);return oh(this.outputs,f)}).forEach((u,c)=>o[c].push(u));return Lr(o.map(a=>Mr(a,0)))})}predict(e,t={}){const r=SO(e);CI(r,this.inputNames,this.feedInputShapes,!1);try{const s=t.batchSize==null?32:t.batchSize;return Ay(s),this.predictLoop(r,s)}finally{ti(r,e)}}predictOnBatch(e){CI(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,r=!0,s){if(this.optimizer_==null)throw new Us("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===Hm?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=bI(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=bI(t,this.feedOutputNames,i,!1,"target"),HZ(e,t),qZ(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&s!=null&&s>0&&e[0].shape[0]%s!==0)throw new Q(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,r,s,i=!0,o){const[a,l]=this.standardizeUserDataXY(e,t,i,o);if(r!=null)throw new Error("sample weight is not supported yet.");let u=null;if(s!=null){const c=wO(s,this.outputNames);u=[];for(let h=0;h<c.length;++h)u.push(await bO(l[h],null,c[h]))}return[a,l,u]}testLoop(e,t,r,s=0,i){return pe(()=>{const o=this.checkNumSamples(t,r,i,"steps"),a=[];if(s>0)throw new ht("Verbose mode is not implemented yet.");if(i!=null)throw new ht("steps mode in testLoop() is not implemented yet");{const l=Ry(o,r),u=Qr(vi(0,o));for(let c=0;c<l.length;++c){const h=l[c][0],d=l[c][1],f=el(u,h,d-h),p=k1(t,f),v=e(p);if(c===0)for(let g=0;g<v.length;++g)a.push(At(0));for(let g=0;g<v.length;++g){const m=v[g];a[g]=De(a[g],ee(d-h,m))}}for(let c=0;c<a.length;++c)a[c]=nt(a[c],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let r=0;r<e.length;++r){const s=e[r];let i=s;if(oI(e,s)>1){const o=oI(e.slice(0,r),s);i+=`_${o}`}t.push(i)}return t}makeTrainFunction(){return e=>{const t=[],r=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const h=[];for(let v=0;v<this.inputs.length;++v)h.push({key:this.inputs[v],value:r[v]});const d=new Ho(h),f=oh(this.outputs,d,{training:!0});let p;for(let v=0;v<this.lossFunctions.length;++v){const g=this.lossFunctions[v];let m=g(s[v],f[v]);i[v]!=null&&(m=MZ(m,i[v]));const y=An(m);t.push(y),v===0?p=m:p=De(p,m)}for(let v=0;v<this.metricsTensors.length;++v){let g;if(this.outputs.length>1&&v<this.outputs.length)g=t[v];else{const m=this.metricsTensors[v][0],y=this.metricsTensors[v][1];g=An(m(s[y],f[y]))}Wi(g),o.push(g)}return p=An(p),this.calculateLosses().forEach(v=>{p=De(p,v)}),p},l=this.collectedTrainableWeights.map(h=>h.read()),u=!0;return[this.optimizer_.minimize(a,u,l)].concat(o)}}makeTestFunction(){this.testFunction=e=>pe(()=>{const t=[];let r;const s=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let u=0;u<this.inputs.length;++u)o.push({key:this.inputs[u],value:s[u]});const a=new Ho(o),l=oh(this.outputs,a);for(let u=0;u<this.lossFunctions.length;++u){const c=this.lossFunctions[u],h=An(c(i[u],l[u]));u===0?r=h:r=De(r,h),t.push(r)}for(let u=0;u<this.metricsTensors.length;++u){const c=this.metricsTensors[u][0],h=this.metricsTensors[u][1],d=An(c(i[h],l[h]));t.push(d)}return t})}async fit(e,t,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let s,i,o,a,l,u,c,h,d;try{const f=r.batchSize==null?32:r.batchSize;Ay(f);const p=!1,v=await this.standardizeUserData(e,t,r.sampleWeight,r.classWeight,p,f);s=v[0],i=v[1],d=v[2];let g=!1,m;if(r.validationData!=null&&r.validationData.length>0){if(g=!0,r.validationData.length===2)l=r.validationData[0],u=r.validationData[1];else throw r.validationData.length===3?new ht("validationData including sample weights is not supported yet."):new Q(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const T=!0,_=await this.standardizeUserData(l,u,null,null,T,f);c=_[0],h=_[1],m=c.concat(h)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){g=!0;const T=Math.floor(s[0].shape[0]*(1-r.validationSplit)),_=s[0].shape[0];c=Qc(s,T,_),o=s,s=Qc(s,0,T),h=Qc(i,T,_),a=i,i=Qc(i,0,T),m=c.concat(h)}else r.validationSteps!=null&&(g=!0);const y=s.concat(i).concat(d);this.checkTrainableWeightsConsistency();const w=this.makeTrainFunction(),x=this.getDedupedMetricsNames();let b,C;g?(this.makeTestFunction(),b=this.testFunction,C=x.slice().concat(x.map(T=>"val_"+T))):(b=null,m=[],C=x.slice());const k=hO(r.callbacks,r.yieldEvery);return await this.fitLoop(w,y,x,f,r.epochs,r.verbose,k,b,m,r.shuffle,C,r.initialEpoch,null,null)}finally{this.isTraining=!1,ti(s,e),ti(i,t),ti(o,e),ti(a,t),ti(c,l),ti(h,u),d!=null&&ft(d)}}async fitLoop(e,t,r,s,i,o,a,l,u,c,h,d,f,p){s==null&&(s=32),i==null&&(i=1),c==null&&(c=!0),d==null&&(d=0);let v=!1;if(l!=null&&u!=null&&(v=!0),p!=null&&(v=!0,f==null))throw new Q("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const g=this.checkNumSamples(t,s,f,"steps_per_epoch");let m;g!=null&&(m=vi(0,g)),o==null&&(o=1);const{callbackList:y,history:w}=dO(a,o,i,d,g,f,s,v,h);y.setModel(this),this.history=w,await y.onTrainBegin(),this.stopTraining_=!1;for(let x=d;x<i;++x){await y.onEpochBegin(x);const b={};if(f!=null)throw new ht("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new ht("batch shuffling is not implemneted yet");c&&w5(m);const C=Qr(m),k=Ry(g,s);for(let E=0;E<k.length;++E){const T={};if(await y.onBatchBegin(E,T),pe(()=>{const _=k[E][0],A=k[E][1],P=el(C,_,A-_);T.batch=E,T.size=A-_;const j=k1(t,P),X=e(j);for(let F=0;F<r.length;++F){const M=r[F],W=X[F];T[M]=W,Wi(W)}if(E===k.length-1&&v){const F=this.testLoop(l,u,s);for(let M=0;M<r.length;++M){const W=r[M],D=F[M];Wi(D),b["val_"+W]=D}}}),await y.onBatchEnd(E,T),cO(T),this.stopTraining_)break}C.dispose()}if(await y.onEpochEnd(x,b),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return UZ(this,e,t)}async trainOnBatch(e,t){const r=await this.standardizeUserData(e,t),s=r[0],i=r[1],a=this.makeTrainFunction()(s.concat(i)),l=[];for(const u of a){const c=await u.data();l.push(c[0])}return ft(a),ti(r[0],e),ti(r[1],t),Lr(l)}getNamedWeights(e){const t=[],r=e!=null&&e.trainableOnly,s=r?this.trainableWeights:this.weights,i=this.getWeights(r);for(let o=0;o<s.length;++o)r&&!s[o].trainable||t.push({name:s[o].originalName,tensor:i[o]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const t=c1().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-c1().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=io(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>io(t))}else{const t=Object.keys(this.loss);e={};const r=this.loss;for(const s of t)if(typeof r[s]=="string")e[s]=io(r[s]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[io(kp(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>io(kp(e)));{const e={};for(const t in this.metrics)e[t]=io(kp(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const t=Ym(e.optimizer_config),r=qi(t);let s;if(typeof e.loss=="string")s=Ua(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(o=>Ua(o));else if(e.loss!=null){s={};for(const o in e.loss)s[o]=Ua(e.loss[o])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(o=>Ua(o));else if(e.metrics!=null){i={};for(const o in e.metrics)i[o]=Ua(e.metrics[o])}this.compile({loss:s,metrics:i,optimizer:r})}async save(e,t){if(typeof e=="string"){const u=SG(e);if(u.length===0)throw new Q(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new Q(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new Q("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await VE(this.getNamedWeights(t)),s=!1,i=null,a={modelTopology:this.toJSON(i,s),format:XZ,generatedBy:`TensorFlow.js tfjs-layers v${xO}`,convertedBy:null};if((t==null?!1:t.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:c,specs:h}=await VE(await this.optimizer.getWeights(),u);r.specs.push(...h),r.data=pG([r.data,c])}return this.userDefinedMetadata!=null&&(vI(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=r.data,a.weightSpecs=r.specs,e.save(a)}setUserDefinedMetadata(e){vI(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Ru.className="Model";Ee(Ru);class kO extends Ru{}kO.className="Functional";Ee(kO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function YZ(n,e){if(e==null&&(e={}),typeof n=="string"){const t=kG(n,e);if(t.length===0)t.push(oK(n,e));else if(t.length>1)throw new Q(`Found more than one (${t.length}) load handlers for URL '${n}'`);n=t[0]}return ZZ(n,void 0,e)}async function ZZ(n,e,t){if(t==null&&(t={}),n.load==null)throw new Q("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const r=await n.load();let s=r.modelTopology;s.model_config!=null&&(s=s.model_config);const i=t.strict==null?!0:t.strict,o=r.weightData!=null&&r.weightSpecs!=null&&i,a=qi(Ym(s),e,o),l=r.trainingConfig;if(l!=null&&a.loadTrainingConfig(l),r.userDefinedMetadata!=null&&a.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData!=null){if(r.weightSpecs==null)throw new Q("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:u,optimizerWeights:c}=QZ(r.weightData,r.weightSpecs);a.loadWeights(u,i),a.optimizer!=null&&c.length>0&&await a.optimizer.setWeights(c),ft(u),ft(c.map(h=>h.tensor))}return a}function QZ(n,e){const t=cG(n,e),r={},s=[];return e.forEach(i=>{i.group==="optimizer"?s.push({name:i.name,tensor:t[i.name]}):r[i.name]=t[i.name]}),{modelWeights:r,optimizerWeights:s}}class ed extends Ru{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:hv("sequential_"),e.layers!=null)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new Q(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof ed||e instanceof Ru;let r;if(t){if(r=e,r.outputs.length!==1)throw new Q("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new Q("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new Q("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const s=QY({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(t)this.outputs=r.outputs,this.inputs=r.inputs;else{if(e.inboundNodes.length!==1)throw new Q(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new Q("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=iO(this.outputs[0])}this.inboundNodes=[],new fv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:wl(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{const s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(Et(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Ru({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,r=console.log){this.built||this.build(),super.summary(e,t,r)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,r={}){if(!this.built)throw new Us("The model needs to be compiled before being used.");return this.model.evaluate(e,t,r)}async evaluateDataset(e,t){if(!this.built)throw new Us("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,r={}){if(!this.built)throw new Us("The model needs to be compiled before being used.");return this.model.fit(e,t,r)}async fitDataset(e,t){if(!this.built)throw new Us("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,r={},s=!1){let i,o={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new Q("Legacy serialization format not supported yet.");i=t}else O(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=t.layers,delete t.layers,o=t;const a=new e(o);if(!(a instanceof ed))throw new ht(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const c=qi(l,void 0,s);s&&c.setFastWeightInitDuringBuild(!0),a.add(c)}return a}set stopTraining(e){if(this.model==null)throw new Q("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new Q("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const r={};r.className=t.getClassName(),r.config=t.getConfig(),e.push(r)}return{name:this.name,layers:e}}}ed.className="Sequential";Ee(ed);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let jr=class extends yc{getConfig(){return{}}};class EO extends jr{apply(e,t=1){return MY(e,t)}}EO.className="elu";Ee(EO);class IO extends jr{apply(e){return UA(e)}}IO.className="selu";Ee(IO);class TO extends jr{apply(e){return Ll(e)}}TO.className="relu";Ee(TO);class _O extends jr{apply(e){return pe(()=>Yh(6,Ll(e)))}}_O.className="relu6";Ee(_O);class NO extends jr{apply(e){return e}}NO.className="linear";Ee(NO);class $O extends jr{apply(e){return mc(e)}}$O.className="sigmoid";Ee($O);class DO extends jr{apply(e){return zY(e)}}DO.className="hardSigmoid";Ee(DO);class AO extends jr{apply(e){return If(e)}}AO.className="softplus";Ee(AO);class RO extends jr{apply(e){return BY(e)}}RO.className="softsign";Ee(RO);class OO extends jr{apply(e){return Qb(e)}}OO.className="tanh";Ee(OO);let wC=class extends jr{apply(e,t=-1){return C2(e,t)}};wC.className="softmax";Ee(wC);class FO extends jr{apply(e,t=-1){return RA(e,t)}}FO.className="logSoftmax";Ee(FO);class LO extends jr{apply(e,t=1){return pe(()=>ee(mc(ee(e,t)),e))}}LO.className="swish";Ee(LO);class PO extends jr{apply(e){return pe(()=>ee(e,Qb(If(e))))}}PO.className="mish";Ee(PO);function fa(n){return n.getClassName()}function Oy(n,e={}){return Rf(n,Ls.getMap().classNameMap,e,"activation")}function pa(n){if(n==null){const e={};return e.className="linear",e.config={},Oy(e)}if(typeof n=="string"){const e={};return e.className=n,e.config={},Oy(e)}else return n instanceof jr?n:Oy(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function JZ(n){if(n!=null&&typeof n!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}class MO extends yc{}class BO extends MO{constructor(e){super(),JZ(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return pe(()=>{let t=Yn([1]);return this.hasL1&&(t=De(t,et(ee(this.l1,br(e))))),this.hasL2&&(t=De(t,et(ee(this.l2,Ff(e))))),ae(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}BO.className="L1L2";Ee(BO);const SI={l1l2:"L1L2"};function Vt(n){return oC(n)}function kI(n,e={}){return Rf(n,Ls.getMap().classNameMap,e,"regularizer")}function on(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in SI?SI[n]:n,config:{}};return kI(t)}else return n instanceof MO?n:kI(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class zO extends gt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=rt(e);let r=Ll(e);return this.maxValue!=null&&(r=xs(r,0,this.maxValue)),r}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}zO.className="ReLU";Ee(zO);class UO extends gt{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const r=rt(e);return o2(r,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}UO.className="LeakyReLU";Ee(UO);class VO extends gt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=sn(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=on(e.alphaRegularizer),this.alphaConstraint=Wn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new Q(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Et(e);const t=e.slice(1);if(this.sharedAxes!=null)for(const s of this.sharedAxes)t[s-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let s=1;s<e.length;++s)r[s]=e[s];this.inputSpec=[new Un({ndim:e.length,axes:r})],this.built=!0}call(e,t){return e=rt(e),d2(e,this.alpha.read())}getConfig(){const e={alphaInitializer:ln(this.alphaInitializer),alphaRegularizer:Vt(this.alphaRegularizer),alphaConstraint:Vn(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}VO.className="PReLU";Ee(VO);let WO=class extends gt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new ht(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const r=rt(e);return sv(r)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};WO.className="ELU";Ee(WO);class GO extends gt{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){const r=rt(e);return ee(r,Ve(Cs(r,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}GO.className="ThresholdedReLU";Ee(GO);class jO extends gt{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new wC().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){const r=rt(e);return this.softmax(r,this.axis)}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}jO.className="Softmax";Ee(jO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ou(n,e,t){if(typeof n=="number")return wl(n,e);if(n.length!==e)throw new Q(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${n.length} elements.`);for(let r=0;r<e;++r){const s=n[r];if(!OY(s))throw new Q(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(n)} including a non-integer number ${s}`)}return n}function mi(n,e,t,r,s=1){if(n==null)return n;const i=e+(e-1)*(s-1);let o;return t==="same"?o=n:o=n-i+1,Math.floor((o+r-1)/r)}function Ri(n,e,t,r){if(n==null)return null;if(r==="valid")n=n*e+da([t-e,0]);else if(r==="same")n=n*e;else throw new Q(`Unsupport padding mode: ${r}.`);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bC(n,e){return pe(()=>(bn(e),e==="channelsFirst"?bt(n,[0,2,3,1]):n))}function HO(n,e){return pe(()=>(bn(e),e==="channelsFirst"?bt(n,[0,2,3,4,1]):n))}function eQ(n,e,t,r=1,s="valid",i,o=1){return pe(()=>{if(i==null&&(i=yi()),bn(i),n.shape.length!==3)throw new Q(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(e.shape.length!==3)throw new Q(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(t!=null&&t.shape.length!==1)throw new Q(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if(i==="channelsFirst"&&(n=bt(n,[0,2,1])),s==="causal")throw new ht("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=kA(n,e,r,s==="same"?"same":"valid","NWC",o);return t!=null&&(a=Ci(a,t)),a})}function EI(n,e,t,r=[1,1],s="valid",i,o,a=null){return pe(()=>{if(i==null&&(i=yi()),bn(i),n.rank!==3&&n.rank!==4)throw new Q(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(e.rank!==3&&e.rank!==4)throw new Q(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let l=bC(n,i);if(s==="causal")throw new ht("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=s7({x:l,filter:e,strides:r,pad:s==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:t,activation:a}),i==="channelsFirst"&&(l=bt(l,[0,3,1,2])),l})}function tQ(n,e,t,r=[1,1,1],s="valid",i,o){return pe(()=>{if(i==null&&(i=yi()),bn(i),n.rank!==4&&n.rank!==5)throw new Q(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(e.rank!==4&&e.rank!==5)throw new Q(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let a=HO(n,i);if(s==="causal")throw new ht("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=tH(a,e,r,s==="same"?"same":"valid","NDHWC",o),t!=null&&(a=Ci(a,t)),i==="channelsFirst"&&(a=bt(a,[0,4,1,2,3])),a})}class gv extends gt{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",gv.verifyArgs(t),this.rank=e,Qn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new ht(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Ou(t.kernelSize,e,"kernelSize"),this.strides=Ou(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,Ss(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,bn(this.dataFormat),this.activation=pa(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=sn(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Wn(t.biasConstraint),this.biasRegularizer=on(t.biasRegularizer),this.activityRegularizer=on(t.activityRegularizer),this.dilationRate=Ou(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new Q(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new Q(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new Q(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Ai("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!aC(e.kernelSize,"number",1,3))throw new Q(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:fa(this.activation),useBias:this.useBias,biasInitializer:ln(this.biasInitializer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),biasConstraint:Vn(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class xc extends gv{constructor(e,t){super(e,t),this.kernel=null,xc.verifyArgs(t),this.filters=t.filters,Qn(this.filters,"filters"),this.kernelInitializer=sn(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Wn(t.kernelConstraint),this.kernelRegularizer=on(t.kernelRegularizer)}build(e){e=Et(e);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new Q(`The channel dimension of the input should be defined. Found ${e[t]}`);const r=e[t],s=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:r}}],this.built=!0}call(e,t){return pe(()=>{e=rt(e);let r;const s=this.bias==null?null:this.bias.read(),i=GR(this.activation.getClassName());if(i!=null&&this.rank===2)r=EI(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)r=eQ(e,this.kernel.read(),s,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=EI(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=tQ(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new ht("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(e){e=Et(e);const t=[],r=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<r.length;++i){const o=mi(r[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);t.push(o)}let s=[e[0]];return this.dataFormat==="channelsLast"?(s=s.concat(t),s.push(this.filters)):(s.push(this.filters),s=s.concat(t)),s}getConfig(){const e={filters:this.filters,kernelInitializer:ln(this.kernelInitializer),kernelRegularizer:Vt(this.kernelRegularizer),kernelConstraint:Vn(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new Q(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Bf extends xc{constructor(e){super(2,e),Bf.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!aC(e.kernelSize,"number",1,2))throw new Q(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Bf.className="Conv2D";Ee(Bf);class zf extends xc{constructor(e){super(3,e),zf.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new Q(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}zf.className="Conv3D";Ee(zf);class qO extends Bf{constructor(e){if(super(e),this.inputSpec=[new Un({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new Q(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Et(e),e.length!==4)throw new Q("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new Q("The channel dimension of the inputs should be defined. Found `None`.");const r=e[t],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Un({ndim:4,axes:{[t]:r}})],this.built=!0}call(e,t){return pe(()=>{let r=rt(e);if(r.shape.length!==4)throw new Q(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=s[o],u=s[a],c=this.kernelSize[0],h=this.kernelSize[1],d=this.strides[0],f=this.strides[1],p=Ri(l,d,c,this.padding),v=Ri(u,f,h,this.padding),g=[i,p,v,this.filters];this.dataFormat!=="channelsLast"&&(r=bt(r,[0,2,3,1]));let m=EA(r,this.kernel.read(),g,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(m=bt(m,[0,3,1,2])),this.bias!=null&&(m=Ci(m,this.bias.read(),this.dataFormat)),this.activation!=null&&(m=this.activation.apply(m)),m})}computeOutputShape(e){e=Et(e);const t=e.slice();let r,s,i;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3):(r=3,s=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return t[r]=this.filters,t[s]=Ri(t[s],l,o,this.padding),t[i]=Ri(t[i],u,a,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}qO.className="Conv2DTranspose";Ee(qO);class KO extends zf{constructor(e){if(super(e),this.inputSpec=[new Un({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new Q(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Et(e),e.length!==5)throw new Q("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new Q("The channel dimension of the inputs should be defined. Found `None`.");const r=e[t],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Un({ndim:5,axes:{[t]:r}})],this.built=!0}call(e,t){return pe(()=>{let r=rt(e);if(r.shape.length!==5)throw new Q(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const u=s[l],c=s[o],h=s[a],d=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],v=this.strides[0],g=this.strides[1],m=this.strides[2],y=Ri(u,v,d,this.padding),w=Ri(c,g,f,this.padding),x=Ri(h,m,p,this.padding),b=[i,y,w,x,this.filters];this.dataFormat!=="channelsLast"&&(r=bt(r,[0,2,3,4,1]));let C=sH(r,this.kernel.read(),b,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(C=bt(C,[0,4,1,2,3])),this.bias!==null&&(C=Ci(C,this.bias.read(),this.dataFormat)),this.activation!==null&&(C=this.activation.apply(C)),C})}computeOutputShape(e){e=Et(e);const t=e.slice();let r,s,i,o;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3,o=4):(r=4,s=1,i=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],h=this.strides[1],d=this.strides[2];return t[r]=this.filters,t[s]=Ri(t[s],c,a,this.padding),t[i]=Ri(t[i],h,l,this.padding),t[o]=Ri(t[o],d,u,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}KO.className="Conv3DTranspose";Ee(KO);class XO extends xc{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new Q("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new Q("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new Q(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=sn(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=on(t.depthwiseRegularizer),this.depthwiseConstraint=Wn(t.depthwiseConstraint),this.pointwiseInitializer=sn(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=on(t.pointwiseRegularizer),this.pointwiseConstraint=Wn(t.pointwiseConstraint)}build(e){if(e=Et(e),e.length<this.rank+2)throw new Q(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new Q(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const r=e[t],s=this.kernelSize.concat([r,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(r*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new Un({ndim:this.rank+2,axes:{[t]:r}})],this.built=!0}call(e,t){return pe(()=>{e=rt(e);let r;if(this.rank===1)throw new ht("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=bt(e,[0,2,3,1])),r=VA(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=Ci(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=bt(r,[0,3,1,2])),r})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=ln(this.depthwiseInitializer),e.pointwiseInitializer=ln(this.pointwiseInitializer),e.depthwiseRegularizer=Vt(this.depthwiseRegularizer),e.pointwiseRegularizer=Vt(this.pointwiseRegularizer),e.depthwiseConstraint=Vn(this.depthwiseConstraint),e.pointwiseConstraint=Vn(this.pointwiseConstraint),e}}XO.className="SeparableConv";class YO extends XO{constructor(e){super(2,e)}}YO.className="SeparableConv2D";Ee(YO);class vv extends xc{constructor(e){super(1,e),vv.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!aC(e.kernelSize,"number",1,1))throw new Q(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}vv.className="Conv1D";Ee(vv);class ZO extends gt{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return pe(()=>{if(e=rt(e),this.dataFormat==="channelsLast"){const r=Sp(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Sp(r,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=Sp(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Sp(r,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}ZO.className="Cropping2D";Ee(ZO);class QO extends gt{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,bn(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,DY(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const t=e[2]==null?null:this.size[0]*e[2],r=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,r]}else{const t=e[1]==null?null:this.size[0]*e[1],r=e[2]==null?null:this.size[1]*e[2];return[e[0],t,r,e[3]]}}call(e,t){return pe(()=>{let r=rt(e);const s=r.shape;if(this.dataFormat==="channelsFirst"){r=bt(r,[0,2,3,1]);const i=this.size[0]*s[2],o=this.size[1]*s[3],a=this.interpolation==="nearest"?uo.resizeNearestNeighbor(r,[i,o]):uo.resizeBilinear(r,[i,o]);return bt(a,[0,3,1,2])}else{const i=this.size[0]*s[1],o=this.size[1]*s[2];return this.interpolation==="nearest"?uo.resizeNearestNeighbor(r,[i,o]):uo.resizeBilinear(r,[i,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}QO.className="UpSampling2D";Ee(QO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nQ(n,e,t=[1,1],r="valid",s,i){return pe(()=>{s==null&&(s=yi()),bn(s);let o=bC(n,s);if(n.rank!==4)throw new Q(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(e.rank!==4)throw new Q(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=n2(o,e,t,r==="same"?"same":"valid","NHWC",i),s==="channelsFirst"&&(o=bt(o,[0,3,1,2])),o})}class JO extends gv{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=sn(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Wn(e.depthwiseConstraint),this.depthwiseRegularizer=on(e.depthwiseRegularizer)}build(e){if(e=Et(e),e.length<4)throw new Q(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new Q(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const r=e[t],s=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",s,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return pe(()=>{e=rt(e);let r=nQ(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=Ci(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(e){e=Et(e);const t=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=mi(t,this.kernelSize[0],this.padding,this.strides[0]),o=mi(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],s,i,o]:[e[0],i,o,s]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=ln(this.depthwiseInitializer),e.depthwiseRegularizer=Vt(this.depthwiseRegularizer),e.depthwiseConstraint=Vn(this.depthwiseRegularizer),e}}JO.className="DepthwiseConv2D";Ee(JO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function eF(n,e,t,r){if(Array.isArray(n)){if(e!=null||t!=null)throw new Q("When inputs is an array, neither initialState or constants should be provided");r!=null&&(t=n.slice(n.length-r,n.length),n=n.slice(0,n.length-r)),n.length>1&&(e=n.slice(1,n.length)),n=n[0]}function s(i){return i==null||Array.isArray(i)?i:[i]}return e=s(e),t=s(t),{inputs:n,initialState:e,constants:t}}function tF(n,e,t,r=!1,s,i,o=!1,a=!1){return pe(()=>{const l=e.shape.length;if(l<3)throw new Q(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(vi(2,l));if(e=bt(e,u),i!=null)throw new ht("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),s!=null&&(s=Ve(Ve(s,"bool"),"float32"),s.rank===l-1&&(s=Fr(s,-1)),s=bt(s,u)),r&&(e=yl(e,0),s!=null&&(s=yl(s,0)));const c=[];let h,d=t;const f=e.shape[0],p=xl(e);let v;s!=null&&(v=xl(s));for(let m=0;m<f;++m){const y=p[m],w=pe(()=>n(y,d));if(s==null)h=w[0],d=w[1];else{const x=pe(()=>{const b=v[m],C=st(qs(b),b),k=De(ee(w[0],b),ee(d[0],C)),E=d.map((T,_)=>De(ee(w[1][_],b),ee(T,C)));return{output:k,newStates:E}});h=x.output,d=x.newStates}a&&c.push(h)}let g;return a&&(g=ha(c,1)),[h,g,d]})}class _a extends gt{constructor(e){super(e);let t;if(e.cell==null)throw new Q("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new kC({cells:e.cell}):t=e.cell,t.stateSize==null)throw new Q("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Un({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return vi(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){w1(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const r=t[0];let s;if(this.returnSequences?s=[e[0],e[1],r]:s=[e[0],r],this.returnState){const i=[];for(const o of t)i.push([e[0],o]);return[s].concat(i)}else return s}computeMask(e,t){return pe(()=>{Array.isArray(t)&&(t=t[0]);const r=this.returnSequences?t:null;if(this.returnState){const s=this.states.map(i=>null);return[r].concat(s)}else return r})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let r=0;r<e;++r)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new ht("Constants support is not implemented in RNN yet.");w1(e)&&(e=e[0]),e=e;const t=this.stateful?e[0]:null,r=e.slice(2);this.inputSpec[0]=new Un({shape:[t,null,...r]});const s=[e[0]].concat(e.slice(2));this.cell.build(s);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!Nt(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new Q(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new Un({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){pe(()=>{if(!this.stateful)throw new Di("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new Q("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Yn([r,s])):this.states_=[Yn([r,this.cell.stateSize])];else if(e==null)ft(this.states_),this.keptStates!=null&&(ft(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Yn([r,s])):this.states_[0]=Yn([r,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Q(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t===!0?this.keptStates.push(this.states_.slice()):ft(this.states_);for(let s=0;s<this.states_.length;++s){const i=e[s],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,a=[r,o];if(!Nt(i.shape,a))throw new Q(`State ${s} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[s]=i}}this.states_=this.states_.map(s=>Wi(s.clone()))})}apply(e,t){let r=t==null?null:t.initialState,s=t==null?null:t.constants;t==null&&(t={});const i=eF(e,r,s,this.numConstants);e=i.inputs,r=i.initialState,s=i.constants;let o=[],a=[];if(r!=null){t.initialState=r,o=o.concat(r),this.stateSpec=[];for(const u of r)this.stateSpec.push(new Un({shape:u.shape}));a=a.concat(this.stateSpec)}if(s!=null&&(t.constants=s,o=o.concat(s),this.numConstants=s.length),o[0]instanceof Li){const u=[e].concat(o),c=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=c;const d=super.apply(u,t);return this.inputSpec=h,d}else return super.apply(e,t)}call(e,t){return pe(()=>{const r=t==null?null:t.mask,s=t==null?null:t.training;let i=t==null?null:t.initialState;e=rt(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new Q(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:s},u=tF((p,v)=>{const g=this.cell.call([p].concat(v),a);return[g[0],g.slice(1)]},e,i,this.goBackwards,r,null,this.unroll,this.returnSequences),c=u[0],h=u[1],d=u[2];this.stateful&&this.resetStates(d,s);const f=this.returnSequences?h:c;return this.returnState?[f].concat(d):f})}getInitialState(e){return pe(()=>{let t=Yn(e.shape);return t=et(t,[1,2]),t=Of(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?y1(t,[1,r]):t):this.cell.stateSize>1?[y1(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===_a.className&&(t.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),t)}static fromConfig(e,t,r={}){const s=t.cell,i=qi(s,r);return new e(Object.assign(t,{cell:i}))}}_a.className="RNN";Ee(_a);class yv extends gt{}class CC extends yv{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Qn(this.units,"units"),this.activation=pa(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=sn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=sn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=sn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=on(e.kernelRegularizer),this.recurrentRegularizer=on(e.recurrentRegularizer),this.biasRegularizer=on(e.biasRegularizer),this.kernelConstraint=Wn(e.kernelConstraint),this.recurrentConstraint=Wn(e.recurrentConstraint),this.biasConstraint=Wn(e.biasConstraint),this.dropout=Zu([1,da([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Zu([1,da([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Et(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return pe(()=>{if(e=e,e.length!==2)throw new Q(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let r=e[1];e=e[0];const s=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ma({ones:()=>qs(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ma({ones:()=>qs(r),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=Hi(ee(e,o),this.kernel.read()):i=Hi(e,this.kernel.read()),this.bias!=null&&(i=Ci(i,this.bias.read())),a!=null&&(r=ee(r,a));let l=De(i,Hi(r,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:fa(this.activation),useBias:this.useBias,kernelInitializer:ln(this.kernelInitializer),recurrentInitializer:ln(this.recurrentInitializer),biasInitializer:ln(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Vn(this.kernelConstraint),recurrentConstraint:Vn(this.recurrentConstraint),biasConstraint:Vn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}CC.className="SimpleRNNCell";Ee(CC);class nF extends _a{constructor(e){e.cell=new CC(e),super(e)}call(e,t){return pe(()=>{this.cell.dropoutMask!=null&&(ft(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ft(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,t){return new e(t)}}nF.className="SimpleRNN";Ee(nF);class SC extends yv{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new Q("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Qn(this.units,"units"),this.activation=pa(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=pa(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=sn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=sn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=sn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=on(e.kernelRegularizer),this.recurrentRegularizer=on(e.recurrentRegularizer),this.biasRegularizer=on(e.biasRegularizer),this.kernelConstraint=Wn(e.kernelConstraint),this.recurrentConstraint=Wn(e.recurrentConstraint),this.biasConstraint=Wn(e.biasConstraint),this.dropout=Zu([1,da([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Zu([1,da([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Et(e);const t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return pe(()=>{if(e=e,e.length!==2)throw new Q(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const r=t.training==null?!1:t.training;let s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ma({ones:()=>qs(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ma({ones:()=>qs(s),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,u;0<this.dropout&&this.dropout<1&&(e=ee(e,i[0]));let c=Hi(e,this.kernel.read());this.useBias&&(c=Ci(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=ee(s,o[0]));const h=this.recurrentKernel.read(),[d,f]=vs(h,[2*this.units,this.units],h.rank-1),p=Hi(s,d),[v,g,m]=vs(c,3,c.rank-1),[y,w]=vs(p,2,p.rank-1);a=this.recurrentActivation.apply(De(v,y)),l=this.recurrentActivation.apply(De(g,w));const x=Hi(ee(l,s),f);u=this.activation.apply(De(m,x));const b=De(ee(a,s),ee(De(1,yn(a)),u));return[b,b]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:fa(this.activation),recurrentActivation:fa(this.recurrentActivation),useBias:this.useBias,kernelInitializer:ln(this.kernelInitializer),recurrentInitializer:ln(this.recurrentInitializer),biasInitializer:ln(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Vn(this.kernelConstraint),recurrentConstraint:Vn(this.recurrentConstraint),biasConstraint:Vn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}SC.className="GRUCell";Ee(SC);class rF extends _a{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new SC(e),super(e)}call(e,t){return pe(()=>{this.cell.dropoutMask!=null&&(ft(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ft(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}rF.className="GRU";Ee(rF);class xv extends yv{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Qn(this.units,"units"),this.activation=pa(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=pa(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=sn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=sn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=sn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=on(e.kernelRegularizer),this.recurrentRegularizer=on(e.recurrentRegularizer),this.biasRegularizer=on(e.biasRegularizer),this.kernelConstraint=Wn(e.kernelConstraint),this.recurrentConstraint=Wn(e.recurrentConstraint),this.biasConstraint=Wn(e.biasConstraint),this.dropout=Zu([1,da([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Zu([1,da([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=Et(e);const r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let s;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;s=new(t=class extends Xs{apply(l,u){const c=i.apply([o]),h=new uC().apply([o]),d=i.apply([o*2]);return lI(lI(c,h),d)}},t.className="CustomInit",t)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return pe(()=>{const r=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new Q(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ma({ones:()=>qs(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ma({ones:()=>qs(s),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,u,c,h;0<this.dropout&&this.dropout<1&&(e=ee(e,o[0]));let d=Hi(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=ee(s,a[0])),d=De(d,Hi(s,this.recurrentKernel.read())),this.useBias&&(d=Ci(d,this.bias.read()));const[f,p,v,g]=vs(d,4,d.rank-1);l=this.recurrentActivation.apply(f),u=this.recurrentActivation.apply(p),c=De(ee(u,i),ee(l,this.activation.apply(v))),h=this.recurrentActivation.apply(g);const m=ee(h,this.activation.apply(c));return[m,m,c]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:fa(this.activation),recurrentActivation:fa(this.recurrentActivation),useBias:this.useBias,kernelInitializer:ln(this.kernelInitializer),recurrentInitializer:ln(this.recurrentInitializer),biasInitializer:ln(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Vn(this.kernelConstraint),recurrentConstraint:Vn(this.recurrentConstraint),biasConstraint:Vn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}xv.className="LSTMCell";Ee(xv);class sF extends _a{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new xv(e),super(e)}call(e,t){return pe(()=>{this.cell.dropoutMask!=null&&(ft(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ft(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}sF.className="LSTM";Ee(sF);class kC extends yv{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return pe(()=>{e=e;let r=e.slice(1);const s=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?s.push(r.splice(0,a.stateSize.length)):s.push(r.splice(0,1));s.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];r=s[a],a===0?o=[e[0]].concat(r):o=[o[0]].concat(r),o=l.call(o,t),i.push(o.slice(1))}r=[];for(const a of i.slice().reverse())r.push(...a);return[o[0]].concat(r)})}build(e){w1(e)&&(e=e[0]),e=e;let t;this.cells.forEach((r,s)=>{Ja(`RNNCell_${s}`,()=>{r.build(e),Array.isArray(r.stateSize)?t=r.stateSize[0]:t=r.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t=i=>({className:i.getClassName(),config:i.getConfig()}),s={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),s)}static fromConfig(e,t,r={}){const s=[];for(const i of t.cells)s.push(qi(i,r));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const r of this.cells)t.push(...r.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return b1(e)}setWeights(e){const t=[];for(const r of this.cells){const s=r.weights.length,i=e.splice(s);for(let o=0;o<r.weights.length;++o)t.push([r.weights[o],i[o]])}gC(t)}}kC.className="StackedRNNCells";Ee(kC);function ma(n){const{ones:e,rate:t,training:r=!1,count:s=1,dropoutFunc:i}=n,o=()=>i!=null?i(e(),t):ZR(e(),t),a=()=>Lf(o,e,r);return!s||s<=1?Wi(a().clone()):Array(s).fill(void 0).map(a).map(u=>Wi(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var rQ=globalThis&&globalThis.__rest||function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class iF extends _a{constructor(e){if(e.unroll)throw new ht("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new ht("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Un({ndim:5})]}call(e,t){return pe(()=>{if(this.cell.dropoutMask!=null&&(ft(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ft(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new Q("ConvRNN2D cell does not support constants");const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return pe(()=>{const{stateSize:t}=this.cell,r=e.shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)],o=Yn(i);return Array.isArray(t)?Array(t.length).fill(o):[o]})}resetStates(e,t=!1){pe(()=>{if(!this.stateful)throw new Di("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)];if(r[0]==null)throw new Q("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Yn(i)):this.states_=[Yn(i)];else if(e==null)ft(this.states_),this.keptStates!=null&&(ft(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Yn(i)):this.states_[0]=Yn(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Q(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):ft(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],u=i;if(!Nt(l.shape,u))throw new Q(`State ${a} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>Wi(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:r,kernelSize:s,padding:i,strides:o,dilationRate:a}=this.cell,l=t==="channelsFirst",u=e[l?3:2],c=e[l?4:3],h=mi(u,s[0],i,o[0],a[0]),d=mi(c,s[1],i,o[1],a[1]);return[...e.slice(0,2),...l?[r,h,d]:[h,d,r]]}}iF.className="ConvRNN2D";class EC extends xv{constructor(e){const{filters:t,kernelSize:r,strides:s,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,Qn(this.filters,"filters"),this.kernelSize=Ou(r,2,"kernelSize"),this.kernelSize.forEach(l=>Qn(l,"kernelSize")),this.strides=Ou(s||1,2,"strides"),this.strides.forEach(l=>Qn(l,"strides")),this.padding=i||"valid",Ss(this.padding),this.dataFormat=o||"channelsLast",bn(this.dataFormat),this.dilationRate=Ou(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>Qn(l,"dilationRate"))}build(e){var t;e=Et(e);const r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new Q(`The channel dimension of the input should be defined. Found ${e[r]}`);const s=e[r],i=4,o=this.kernelSize.concat([s,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,c=this.filters;l=new(t=class extends Xs{apply(d,f){const p=u.apply([c]),v=Ol([c]),g=u.apply([c*2]);return lC([p,v,g])}},t.className="CustomInit",t)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return pe(()=>{if(e.length!==3)throw new Q(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const r=t.training||!1,s=e[0],i=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ma({ones:()=>qs(s),rate:this.dropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(K,ie,V)=>!ie||!ie[V]?K:ee(ie[V],K);let c=u(s,l,0),h=u(s,l,1),d=u(s,l,2),f=u(s,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ma({ones:()=>qs(i),rate:this.recurrentDropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let v=u(i,p,0),g=u(i,p,1),m=u(i,p,2),y=u(i,p,3);const w=3,[x,b,C,k]=vs(this.kernel.read(),a,w),[E,T,_,A]=this.useBias?vs(this.bias.read(),a):[null,null,null,null];c=this.inputConv(c,x,E,this.padding),h=this.inputConv(h,b,T,this.padding),d=this.inputConv(d,C,_,this.padding),f=this.inputConv(f,k,A,this.padding);const[P,j,X,F]=vs(this.recurrentKernel.read(),a,w);v=this.recurrentConv(v,P),g=this.recurrentConv(g,j),m=this.recurrentConv(m,X),y=this.recurrentConv(y,F);const M=this.recurrentActivation.apply(De(c,v)),W=this.recurrentActivation.apply(De(h,g)),D=De(ee(W,o),ee(M,this.activation.apply(De(d,m)))),z=ee(this.recurrentActivation.apply(De(f,y)),this.activation.apply(D));return[z,z,D]})}getConfig(){const e=super.getConfig(),t=rQ(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},t),r)}inputConv(e,t,r,s){const i=vl(e,t,this.strides,s||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?Ci(i,r,this.dataFormat):i}recurrentConv(e,t){return vl(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}EC.className="ConvLSTM2DCell";Ee(EC);class oF extends iF{constructor(e){const t=new EC(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}oF.className="ConvLSTM2D";Ee(oF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class IC extends gt{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const t=e.shape,r=[];for(let s=0;s<this.noiseShape.length;++s)r.push(this.noiseShape[s]==null?t[s]:this.noiseShape[s]);return r}call(e,t){return pe(()=>{this.invokeCallHook(e,t);const r=rt(e);if(0<this.rate&&this.rate<1){const s=t.training==null?!1:t.training,i=this.getNoiseShape(r);return Lf(()=>ZR(r,this.rate,i,this.seed),()=>r,s)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}IC.className="Dropout";Ee(IC);class aF extends IC{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}aF.className="SpatialDropout1D";Ee(aF);class lF extends gt{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,Qn(this.units,"units"),this.activation=pa(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=sn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=sn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Wn(e.kernelConstraint),this.biasConstraint=Wn(e.biasConstraint),this.kernelRegularizer=on(e.kernelRegularizer),this.biasRegularizer=on(e.biasRegularizer),this.activityRegularizer=on(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Et(e);const t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=Et(e);const t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return pe(()=>{this.invokeCallHook(e,t);const r=rt(e),s=GR(this.activation.getClassName());let i;return s!=null?i=Hi(r,this.kernel.read(),s,this.bias?this.bias.read():null):(i=Hi(r,this.kernel.read()),this.bias!=null&&(i=Ci(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:fa(this.activation),useBias:this.useBias,kernelInitializer:ln(this.kernelInitializer),biasInitializer:ln(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Vn(this.kernelConstraint),biasConstraint:Vn(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}lF.className="Dense";Ee(lF);class uF extends gt{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Et(e);for(const t of e.slice(1))if(t==null)throw new Q(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],oa(e,1)]}call(e,t){return pe(()=>{this.invokeCallHook(e,t);let r=rt(e);if(this.dataFormat==="channelsFirst"&&r.rank>1){const s=[0];for(let i=2;i<r.rank;++i)s.push(i);s.push(1),r=bt(r,s)}return PY(r)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}uF.className="Flatten";Ee(uF);class cF extends gt{constructor(e){super(e),this.supportsMasking=!0,this.activation=pa(e.activation)}call(e,t){return pe(()=>{this.invokeCallHook(e,t);const r=rt(e);return this.activation.apply(r)})}getConfig(){const e={activation:fa(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}cF.className="Activation";Ee(cF);class hF extends gt{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return pe(()=>(e=rt(e),FY(e,this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}hF.className="RepeatVector";Ee(hF);class dF extends gt{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){const r="Total size of new array must be unchanged.",s=t.slice();let i=1,o=null;for(let l=0;l<s.length;++l){const u=s[l];if(this.isUnknown(u))if(o===null)o=l;else throw new Q("Can only specifiy one unknown dimension.");else i*=u}const a=oa(e);if(o!==null){if(i===0||a%i!==0)throw new Q(r);s[o]=a/i}else if(a!==i)throw new Q(r);return s}computeOutputShape(e){let t=!1;for(let r=0;r<e.length;++r)if(this.isUnknown(e[r])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return pe(()=>{this.invokeCallHook(e,t);const r=rt(e),s=r.shape,i=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return ae(r,i)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}dF.className="Reshape";Ee(dF);class fF extends gt{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=vi(1,e.dims.length+1);if(!Nt(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Un({ndim:this.dims.length+1})]}computeOutputShape(e){e=Et(e);const t=e.slice();return this.dims.forEach((r,s)=>{t[s+1]=e[r]}),t}call(e,t){return bt(rt(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}fF.className="Permute";Ee(fF);class pF extends gt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const r=rt(e),s=-1;return h1(Mm(r,this.maskValue),s)}call(e,t){return pe(()=>{this.invokeCallHook(e,t);const r=rt(e),s=-1,i=!0,o=h1(Mm(r,this.maskValue),s,i);return ee(r,Ve(o,r.dtype))})}}pF.className="Masking";Ee(pF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class mF extends gt{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(Zt(e.inputLength))}this.inputDim=e.inputDim,Qn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Qn(this.outputDim,"outputDim"),this.embeddingsInitializer=sn(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=on(e.embeddingsRegularizer),this.activityRegularizer=on(e.activityRegularizer),this.embeddingsConstraint=Wn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return pe(()=>this.maskZero?(e=rt(e),Mm(e,Ct(e))):null)}computeOutputShape(e){if(e=Et(e),this.inputLength==null)return[...e,this.outputDim];const t=Zt(this.inputLength);if(t.length!==e.length-1)throw new Q(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let r=0;for(let s=0;s<t.length;++s){const i=t[s],o=e[s+1];if(i!=null&&o!=null&&i!==o)throw new Q(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(t[r]=o),r++}}return[e[0],...t,this.outputDim]}call(e,t){return pe(()=>{this.invokeCallHook(e,t);let r=rt(e);r.dtype!=="int32"&&(r=ji(r,"int32"));const s=YR(this.embeddings.read(),ae(r,[r.size]));return ae(s,Et(this.computeOutputShape(r.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:ln(this.embeddingsInitializer),embeddingsRegularizer:Vt(this.embeddingsRegularizer),activityRegularizer:Vt(this.activityRegularizer),embeddingsConstraint:Vn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}mF.className="Embedding";Ee(mF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Bl extends gt{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new ht}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;const r=e.slice(0,e.length-t.length);for(let s=0;s<t.length;++s){const i=e[e.length-t.length+s],o=t[s];if(i==null||o==null||i<0||o<0)r.push(null);else if(i===1)r.push(o);else if(o===1)r.push(i);else{if(i!==o)throw new Q("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));r.push(i)}}return r}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Et(e)]),e=e,e.length<2)throw new Q(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const i of e)i!=null&&i[0]!==null&&t.push(i[0]);if(t=ia(t),t.length>1)throw new Q(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const o=e[i]==null?null:e[i].slice(1);r=this.computeElementwiseOpOutputShape(r,o)}const s=e.map(i=>i.length);e.indexOf(null)===-1&&ia(s).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return pe(()=>{if(e=e,this.reshapeRequired){const r=[],s=e.map(i=>i.rank);if(s.indexOf(null)===-1){const i=da(s);for(let o of e){const a=o.rank;for(let l=0;l<i-a;++l)o=Of(o,1);r.push(o)}return this.mergeFunction(r)}else{let i=!1;for(const l of e){const u=l.rank;if(u==null){const c=l.shape,h=c[0],d=c.slice(1).concat([h]);let f=ae(l,[h].concat(oa(c.slice(1))));f=bt(f,[1,0]),f=ae(f,d),r.push(f),i=!0}else if(u>1){const c=vi(1,u).concat([0]);r.push(bt(l,c)),i=!0}else r.push(l)}let o=this.mergeFunction(r);const a=o.rank;if(i){if(a==null){const l=o.shape,u=l.length,c=l[u-1],h=[c].concat(l.slice(0,l.length-1));o=ae(bt(ae(o,[-1,c]),[1,0]),h)}else if(a>1){const l=[a-1].concat(vi(0,a-1));o=bt(o,l)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let s=1;s<e.length;++s){const i=e[s]==null?null:e[s].slice(1);t=this.computeElementwiseOpOutputShape(t,i)}let r=[];for(const s of e)s!=null&&s[0]!==null&&r.push(s[0]);return r=ia(r),r.length===1?t=r.concat(t):t=[null].concat(t),t}computeMask(e,t){return pe(()=>{if(t==null)return null;if(!Array.isArray(t))throw new Q("`mask` should be an Array");if(!Array.isArray(e))throw new Q("`inputs` should be an Array");if(t.length!==e.length)throw new Q(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(s=>s==null))return null;t=t.map(s=>s==null?s:Fr(s,0));let r=t[0];for(let s=1;s<t.length-1;++s)r=wo(r,t[s]);return r})}}class gF extends Bl{constructor(e){super(e)}mergeFunction(e){return pe(()=>{let t=e[0].clone();for(let r=1;r<e.length;++r)t=De(t,e[r]);return t})}}gF.className="Add";Ee(gF);class vF extends Bl{constructor(e){super(e)}mergeFunction(e){return pe(()=>{let t=e[0].clone();for(let r=1;r<e.length;++r)t=ee(t,e[r]);return t})}}vF.className="Multiply";Ee(vF);class yF extends Bl{constructor(e){super(e)}mergeFunction(e){return pe(()=>{let t=e[0].clone();for(let r=1;r<e.length;++r)t=De(t,e[r]);return ee(1/e.length,t)})}}yF.className="Average";Ee(yF);class xF extends Bl{constructor(e){super(e)}mergeFunction(e){return pe(()=>{let t=e[0];for(let r=1;r<e.length;++r)t=Ia(t,e[r]);return t})}}xF.className="Maximum";Ee(xF);class wF extends Bl{constructor(e){super(e)}mergeFunction(e){return pe(()=>{let t=e[0];for(let r=1;r<e.length;++r)t=Yh(t,e[r]);return t})}}wF.className="Minimum";Ee(wF);class bF extends Bl{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new Q("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(const s of e)if(s!=null){t=!1;break}if(t)return;const r=[];for(let s=0;s<e.length;++s){const i=e[s].slice();i.splice(this.axis,1);let o=!1;for(const a of r)if(Nt(a,i)){o=!0;break}o||r.push(i)}if(r.length>1)throw new Q("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return pe(()=>lC(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new Q("A `Concatenate` layer should be called on a list of inputs.");const t=e,r=t[0].slice(),s=this.axis<0?r.length+this.axis:this.axis;for(const i of t.slice(1)){if(r[s]==null||i[s]==null){r[s]=null;break}r[s]+=i[s]}return r}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new Q("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new Q("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new Q(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return pe(()=>{let r=!0;if(t.forEach(o=>{if(o!=null){r=!1;return}}),r)return null;const s=[];for(let o=0;o<e.length;++o)t[o]==null?s.push(Ve(qs(e[o]),"bool")):t[o].rank<e[o].rank?s.push(Fr(t[o],-1)):s.push(t[o]);const i=Mr(s,this.axis);return SA(i,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}bF.className="Concatenate";Ee(bF);function Jc(n,e){for(;n<0;)n+=e;return n}function sQ(n,e,t){if(n.shape.length>3||e.shape.length>3)throw new ht("batchDot is not implemented for tensors of 4D or higher rank yet");if(O(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),O(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof t=="number"&&(t=[t,t]),n.dtype==="complex64"||e.dtype==="complex64")throw new ht("batchDot is not implemented for complex64-type Tensors yet.");const r=n.shape.length,s=e.shape.length;t==null&&(t=[r-1,s-2]);const i=t;return pe(()=>{let o;if(r>s){o=r-s;const l=[];for(let u=0;u<o;++u)l.push(1);e=ae(e,e.shape.concat(l))}else if(s>r){o=s-r;const l=[];for(let u=0;u<o;++u)l.push(1);n=ae(n,n.shape.concat(l))}else o=0;let a;if(n.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=et(ee(n,e),i[0]):a=et(ee(bt(n,[1,0]),e),i[1]);else{const l=i[0]!==n.shape.length-1,u=i[1]===e.shape.length-1;a=_t(n,e,l,u)}if(o>0){let l;r>s?l=r+s-3:l=r-1;const u=[];for(let c=l;c<l+o;++c)u.push(c);a=_f(a,u)}return a.shape.length===1&&(a=Fr(a,1)),a})}class CF extends Bl{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){O(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],r=e[1];if(t.length>3||r.length>3)throw new ht("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(t,r);if(t[s[0]]!==r[s[1]])throw new Q(`Dimension incompatibility: ${t[s[0]]} !== ${r[s[1]]}`)}mergeFunction(e){if(e.length!==2)throw new Q(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],r=e[1],s;return Array.isArray(this.axes)?s=this.axes.map((i,o)=>Jc(i,e[o].shape.length)):s=[Jc(this.axes,t.shape.length),Jc(this.axes,r.shape.length)],this.normalize&&(t=jm(t,s[0]),r=jm(r,s[1])),sQ(t,r,s)}interpretAxes(e,t){let r;return Array.isArray(this.axes)?r=this.axes:r=[Jc(this.axes,e.length),Jc(this.axes,t.length)],r}computeOutputShape(e){O(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),r=e[1].slice();if(t.length>3||r.length>3)throw new ht("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(t,r);t.splice(s[0],1),r.splice(s[1],1),r.splice(0,1);const i=t.concat(r);return i.length===1&&i.push(1),i}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}CF.className="Dot";Ee(CF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class SF extends gt{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return pe(()=>{this.invokeCallHook(e,t);const r=rt(e);return Lf(()=>De(dv(r.shape,0,this.stddev),r),()=>r,t.training||!1)})}}SF.className="GaussianNoise";Ee(SF);class kF extends gt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return pe(()=>{this.invokeCallHook(e,t);const r=rt(e);return this.rate>0&&this.rate<1?Lf(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return ee(r,dv(r.shape,1,i))},()=>r,t.training||!1):r})}}kF.className="GaussianDropout";Ee(kF);class EF extends gt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||rt(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return pe(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(e);return Lf(()=>{const i=rt(e),o=1.6732632423543772,a=1.0507009873554805,l=-o*a;let u=Rl(Tf(r),this.rate);u=ji(u,"float32");const c=((1-this.rate)*(1+this.rate*l**2))**-.5,h=-c*l*this.rate,d=De(ee(i,u),ee(De(u,-1),l));return De(ee(d,c),h)},()=>rt(e),t.training||!1)}return e})}}EF.className="AlphaDropout";Ee(EF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function td(n,e,t,r,s,i=.001){let o;if(n.rank===2)o=Dj(n,e,t,r,s,i);else if(n.rank===3)o=Rj(n,e,t,r,s,i);else if(n.rank===4)o=Fj(n,e,t,r,s,i);else throw new ht(`batchNormalization is not implemented for array of rank ${n.rank} yet`);return o}function iQ(n,e,t,r,s=.001){return pe(()=>{const i=u2(n,r),o=i.mean,a=i.variance;return[td(n,o,a,t,e,s),o,a]})}function oQ(n,e,t,r,s=.001){return pe(()=>{const i=u2(n,r),o=i.mean,a=i.variance,l=[];for(const p of vi(0,n.rank))r.indexOf(p)!==-1?l.push(1):l.push(n.shape[p]);const u=ae(o,l),c=ae(a,l),h=e==null?null:ae(e,l),d=t==null?null:ae(t,l);return[td(n,u,c,d,h,s),o,a]})}function aQ(n,e,t,r,s=.001){return Nt(r.slice().sort(),vi(0,n.rank-1))?iQ(n,e,t,r,s):oQ(n,e,t,r,s)}class IF extends gt{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=sn(e.betaInitializer||"zeros"),this.gammaInitializer=sn(e.gammaInitializer||"ones"),this.movingMeanInitializer=sn(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=sn(e.movingVarianceInitializer||"ones"),this.betaConstraint=Wn(e.betaConstraint),this.gammaConstraint=Wn(e.gammaConstraint),this.betaRegularizer=on(e.betaRegularizer),this.gammaRegularizer=on(e.gammaRegularizer)}build(e){e=Et(e);const t=this.axis>=0?this.axis:this.axis+e.length,r=e[t];if(r==null)throw new Q(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Un({ndim:e.length,axes:{[t]:r}})];const s=[r];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return pe(()=>{const r=t.training==null?!1:t.training,s=rt(e),i=s.shape,o=i.length,a=vi(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const u=wl(1,o);u[l]=i[l];const c=a.slice();c.sort();const h=!Nt(c,vi(0,o).slice(0,o-1)),d=()=>{if(h){const y=ae(this.movingMean.read(),u),w=ae(this.movingVariance.read(),u),x=this.center?ae(this.beta.read(),u):null,b=this.scale?ae(this.gamma.read(),u):null;return td(s,y,w,x,b,this.epsilon)}else return td(s,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return d();const[f,p,v]=aQ(s,this.gamma.read(),this.beta.read(),a,this.epsilon),g=(y,w,x)=>{pe(()=>{const b=1-x,C=y.read(),k=ee(st(C,w),b);y.write(st(C,k))})};return(()=>{g(this.movingMean,p,this.momentum),g(this.movingVariance,v,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:ln(this.betaInitializer),gammaInitializer:ln(this.gammaInitializer),movingMeanInitializer:ln(this.movingMeanInitializer),movingVarianceInitializer:ln(this.movingVarianceInitializer),betaRegularizer:Vt(this.betaRegularizer),gammaRegularizer:Vt(this.gammaRegularizer),betaConstraint:Vn(this.betaConstraint),gammaConstraint:Vn(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}IF.className="BatchNormalization";Ee(IF);class TF extends gt{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=sn(e.betaInitializer||"zeros"),this.gammaInitializer=sn(e.gammaInitializer||"ones"),this.betaRegularizer=on(e.betaRegularizer),this.gammaRegularizer=on(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Et(e);const t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=t);for(const i of this.axis)if(i<0||i>=t)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==ia(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(i=>e[i]),s=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,s):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,s):this.beta=null,this.built=!0}call(e,t){const r=rt(e),s=r.shape,i=s.length;return pe(()=>{let{mean:a,variance:l}=u2(r,this.axis,!0);const u=wl(1,i);for(const v of this.axis)u[v]=s[v];const c=v=>v!=null&&v.shape.length!==i?ae(v,u):v;let h=this.scale?c(this.gamma.read()):null,d=this.center?c(this.beta.read()):null;const f=[],p=[];for(let v=0;v<i;++v)this.axis.indexOf(v)!==-1?(f.push(s[v]),p.push(1)):(f.push(1),p.push(s[v]));return a=ui(a,f),l=ui(l,f),h!=null&&(h=ui(h,p)),d!=null&&(d=ui(d,p)),td(r,a,l,d,h,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:ln(this.betaInitializer),gammaInitializer:ln(this.gammaInitializer),betaRegularizer:Vt(this.betaRegularizer),gammaRegularizer:Vt(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}TF.className="LayerNormalization";Ee(TF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lQ(n,e,t){return pe(()=>{if(n.rank!==4)throw new Q(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new Q("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=yi()),t!=="channelsLast"&&t!=="channelsFirst")throw new Q(`Unknown data format: ${t}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return t==="channelsFirst"?r=[[0,0],[0,0],e[0],e[1]]:r=[[0,0],e[0],e[1],[0,0]],c2(n,r)})}class _F extends gt{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?yi():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new Q(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,r;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],r=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new Q(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new Q(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);r=e.padding[1]}this.padding=[t,r]}this.inputSpec=[new Un({ndim:4})]}computeOutputShape(e){e=Et(e);let t,r;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?r=e[3]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],e[1],t,r]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?r=e[2]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],t,r,e[3]])}call(e,t){return pe(()=>lQ(rt(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}_F.className="ZeroPadding2D";Ee(_F);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wv(n,e,t,r,s,i){return pe(()=>{bn(s),HR(i),Ss(r),t==null&&(t=[1,1]),r==null&&(r="valid"),s==null&&(s=yi()),i==null&&(i="max"),n=bC(n,s);let o;const a=r==="same"?"same":"valid";return i==="max"?o=l2(n,e,t,a):o=Zb(n,e,t,a),s==="channelsFirst"&&(o=bt(o,[0,3,1,2])),o})}function NF(n,e,t,r,s,i){return pe(()=>{bn(s),HR(i),Ss(r),t==null&&(t=[1,1,1]),r==null&&(r="valid"),s==null&&(s=yi()),i==null&&(i="max"),n=HO(n,s);let o;const a=r==="same"?"same":"valid";return i==="max"?o=bq(n,e,t,a):o=bj(n,e,t,a),s==="channelsFirst"&&(o=bt(o,[0,4,1,2,3])),o})}class $F extends gt{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new Q(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Qn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new Q(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Qn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Ss(this.padding),this.inputSpec=[new Un({ndim:3})]}computeOutputShape(e){e=Et(e);const t=mi(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return pe(()=>{this.invokeCallHook(e,t),e=Of(rt(e),2);const r=this.poolingFunction(rt(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return _f(r,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class DF extends $F{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return bn(i),Ss(s),wv(e,t,r,s,i,"max")}}DF.className="MaxPooling1D";Ee(DF);class AF extends $F{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return bn(i),Ss(s),wv(e,t,r,s,i,"avg")}}AF.className="AveragePooling1D";Ee(AF);class RF extends gt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new Q(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Qn(this.poolSize,"poolSize"),Qn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,bn(this.dataFormat),Ss(this.padding),this.inputSpec=[new Un({ndim:4})]}computeOutputShape(e){e=Et(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=mi(t,this.poolSize[0],this.padding,this.strides[0]),r=mi(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,r]:[e[0],t,r,e[3]]}call(e,t){return pe(()=>(this.invokeCallHook(e,t),this.poolingFunction(rt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class OF extends RF{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return bn(i),Ss(s),wv(e,t,r,s,i,"max")}}OF.className="MaxPooling2D";Ee(OF);class FF extends RF{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return bn(i),Ss(s),wv(e,t,r,s,i,"avg")}}FF.className="AveragePooling2D";Ee(FF);class LF extends gt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new Q(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Qn(this.poolSize,"poolSize"),Qn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,bn(this.dataFormat),Ss(this.padding),this.inputSpec=[new Un({ndim:5})]}computeOutputShape(e){e=Et(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=mi(t,this.poolSize[0],this.padding,this.strides[0]),r=mi(r,this.poolSize[1],this.padding,this.strides[1]),s=mi(s,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,r,s]:[e[0],t,r,s,e[4]]}call(e,t){return pe(()=>(this.invokeCallHook(e,t),this.poolingFunction(rt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class PF extends LF{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return bn(i),Ss(s),NF(e,t,r,s,i,"max")}}PF.className="MaxPooling3D";Ee(PF);class MF extends LF{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return bn(i),Ss(s),NF(e,t,r,s,i,"avg")}}MF.className="AveragePooling3D";Ee(MF);class BF extends gt{constructor(e){super(e),this.inputSpec=[new Un({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new ht}}class zF extends BF{constructor(e){super(e||{})}call(e,t){return pe(()=>{const r=rt(e);return An(r,1)})}}zF.className="GlobalAveragePooling1D";Ee(zF);class UF extends BF{constructor(e){super(e||{})}call(e,t){return pe(()=>{const r=rt(e);return pi(r,1)})}}UF.className="GlobalMaxPooling1D";Ee(UF);class VF extends gt{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,bn(this.dataFormat),this.inputSpec=[new Un({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new ht}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class WF extends VF{call(e,t){return pe(()=>{const r=rt(e);return this.dataFormat==="channelsLast"?An(r,[1,2]):An(r,[2,3])})}}WF.className="GlobalAveragePooling2D";Ee(WF);class GF extends VF{call(e,t){return pe(()=>{const r=rt(e);return this.dataFormat==="channelsLast"?pi(r,[1,2]):pi(r,[2,3])})}}GF.className="GlobalMaxPooling2D";Ee(GF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class jF extends gt{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,r={}){const s=t.layer,i=qi(s,r);delete t.layer;const o={layer:i};return Object.assign(o,t),new e(o)}}class HF extends jF{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Et(e),e.length<3)throw new Q(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Et(e);const t=[e[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(t),s=e[1];return[r[0],s].concat(r.slice(1))}call(e,t){return pe(()=>(e=rt(e),tF((o,a)=>[rt(this.layer.call(o,t)),[]],e,[],!1,null,null,!1,!0)[1]))}}HF.className="TimeDistributed";Ee(HF);function uQ(n){Ml($Y,"BidirectionalMergeMode",n)}const cQ="concat";class qF extends jF{constructor(e){super(e);const t=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=t,this.forwardLayer=qi(r),t.goBackwards=t.goBackwards!==!0;const s={};if(s.className=e.layer.getClassName(),s.config=t,this.backwardLayer=qi(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?cQ:e.mergeMode,uQ(this.mergeMode),e.weights)throw new ht("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,r=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let r,s,i;return this.returnState&&(i=t.slice(1)),r=t[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,s=[r]):this.mergeMode==null?s=[r,r.slice()]:s=[r],this.returnState?this.mergeMode==null?s.concat(i).concat(i.slice()):[r].concat(i).concat(i.slice()):Lr(s)}apply(e,t){let r=t==null?null:t.initialState,s=t==null?null:t.constants;t==null&&(t={});const i=eF(e,r,s,this.numConstants);if(e=i.inputs,r=i.initialState,s=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(r==null||r.length===0)&&s==null)return super.apply(e,t);const o=[],a=[];if(r!=null){const u=r.length;if(u%2>0)throw new Q("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,o.push(...r);const c=r.map(h=>new Un({shape:h.shape}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),a.push(...c)}if(s!=null)throw new ht("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof Li;for(const u of o)if(u instanceof Li!==l)throw new Q("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[e].concat(o),c=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=c;const d=super.apply(u,t);return this.inputSpec=h,d}else return super.apply(e,t)}call(e,t){return pe(()=>{const r=t.initialState;let s,i;if(r==null)s=this.forwardLayer.call(e,t),i=this.backwardLayer.call(e,t);else{const l=r.slice(0,r.length/2),u=r.slice(r.length/2);s=this.forwardLayer.call(e,Object.assign(t,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(t,{initialState:u}))}let o;this.returnState&&(Array.isArray(s)&&(o=s.slice(1).concat(i.slice(1))),s=s[0],i=i[0]),this.returnSequences&&(i=yl(i,1));let a;return this.mergeMode==="concat"?a=lC([s,i]):this.mergeMode==="sum"?a=De(s,i):this.mergeMode==="ave"?a=ee(.5,De(s,i)):this.mergeMode==="mul"?a=ee(s,i):this.mergeMode==null&&(a=[s,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Ja(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Ja(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[t,t]:r=t:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(r)?r.concat(i).concat(i):[r].concat(i).concat(i)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const r=qi(t.layer);if(delete t.layer,t.numConstants!=null)throw new ht("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const s=t;return s.layer=r,new e(s)}}qF.className="Bidirectional";Ee(qF);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class KF extends gt{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return pe(()=>(e=rt(e),e.dtype!=="float32"&&(e=ji(e,"float32")),De(ee(e,this.scale),this.offset)))}}KF.className="Rescaling";Ee(KF);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:hQ,cropAndResize:dQ}=uo;class XF extends gt{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,r,s,i,o,a,l){return pe(()=>{let u,c=!1;const h=t/o,d=r/a,f=(s+t)/o,p=(i+r)/a,v=[h,d,f,p],g=[];e.rank===3?(c=!0,u=ha([e])):u=e;for(let b=0;b<u.shape[0];b++)g.push(v);const m=Ch(g,[g.length,4]),y=Zh(0,g.length,1,"int32"),x=dQ(u,m,y,[s,i],"nearest");return ji(c?rt(xl(x)):x,l)})}upsize(e,t,r,s){return pe(()=>{const i=hQ(e,[t,r]);return ji(i,s)})}call(e,t){return pe(()=>{const r=rt(e),s=r.dtype,i=r.shape,o=i[i.length-3],a=i[i.length-2];let l=0;o!==this.height&&(l=Math.floor((o-this.height)/2));let u=0;return a!==this.width&&(u=Math.floor((a-this.width)/2),u===0&&(u=1)),l>=0&&u>=0?this.centerCrop(r,l,u,this.height,this.width,o,a,s):this.upsize(e,this.height,this.width,s)})}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=Et(e);const t=e.length-3,r=e.length-2;return e[t]=this.height,e[r]=this.width,e}}XF.className="CenterCrop";Ee(XF);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function fQ(n,e,t,r){let s=rt(n);if(s.dtype!=="int32"&&(s=ji(s,"int32")),e==="int")return s;const i=s.shape;if(s.rank===0&&(s=Fr(s,-1)),e==="oneHot"&&s.shape[s.shape.length-1]!==1&&(s=Fr(s,-1)),s.rank>2)throw new Q(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${s.rank}.`);const o=["multiHot","oneHot"].includes(e),a=s;let l;if(typeof r<"u"&&e==="count"?l=jE(a,r,t,o):l=jE(a,[],t,o),e!=="tfIdf")return l;if(r)return ee(l,r);throw new Q("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class YF extends gt{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=Et(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return pe(()=>{e=rt(e),e.dtype!=="int32"&&(e=ji(e,"int32"));let r;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new Q(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);r=rt(t.countWeights)}const s=pi(e),i=Lm(e),o=Cs(this.numTokens,s).bufferSync().get(0),a=Rl(i,0).bufferSync().get(0);if(!(o&&a))throw new Q(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return fQ(e,this.outputMode,this.numTokens,r)})}}YF.className="CategoryEncoding";Ee(YF);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const pQ=["bilinear","nearest"],II=new Set(pQ);class ZF extends gt{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(II.has(e.interpolation))this.interpolation=e.interpolation;else throw new Q(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Et(e);const t=e[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return pe(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return uo.resizeBilinear(e,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return uo.resizeNearestNeighbor(e,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...II]} are supported`)})}}ZF.className="Resizing";Ee(ZF);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class QF{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}QF.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class JF extends gt{constructor(e){super(e),this.randomGenerator=new QF(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}JF.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const mQ=["bilinear","nearest"],TI=new Set(mQ);class e3 extends JF{constructor(e){super(e);const{factor:t,interpolation:r="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new Q(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new Q(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new Q(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(TI.has(r))this.interpolation=r;else throw new Q(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=Et(e);const t=e[2];return[this.imgHeight,-1,t]}call(e,t){return pe(()=>{const r=rt(e);this.imgHeight=r.shape[r.shape.length-3];const s=r.shape[r.shape.length-2];this.widthFactor=Tf([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*s;i=Math.round(i);const o=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return uo.resizeBilinear(e,o);case"nearest":return uo.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...TI]} are supported`)}})}}e3.className="RandomWidth";Ee(e3);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gQ=me();gQ.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var _I;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(_I||(_I={}));var NI;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(NI||(NI={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var $I;(function(n){n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST"})($I||($I={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qe(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&O(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vQ=YA;class bv extends Jw{nextDataId(){return bv.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new xD(this,Ni())}write(e,t,r){this.firstUse&&(this.firstUse=!1,me().get("IS_NODE")&&fs(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:r,refCount:1}),s}makeTensorInfo(e,t,r){let s;if(t==="string"&&r!=null&&r.length>0&&_d(r[0])){const i=r.map(o=>sa(o));s=this.write(i,e,t)}else s=this.write(r,e,t);return{dataId:s,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){const t=this.data.get(e);t.refCount--}}move(e,t,r,s,i){this.data.set(e,{values:t,dtype:s,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:r}=this.data.get(e);if(t==="complex64"){const s=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return bo(s,i)}return I5(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const r=t.map(s=>ca(s));return pt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return pt(e.shape,e.dtype,t)}makeOutput(e,t,r){return Ni().makeTensorFromTensorInfo(this.makeTensorInfo(t,r,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=Or();return e(),{kernelMs:Or()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){qe([e],"where");const t=this.readSync(e.dataId);return vQ(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}bv.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t3(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}const yQ=n=>{const{x:e}=n.inputs,t=n.backend;qe(e,"abs");let r=new Float32Array(we(e.shape));const s=t.data.get(e.dataId).values;return r=t3(s),t.makeOutput(r,e.shape,e.dtype)},xQ={kernelName:Jg,backendName:"cpu",kernelFunc:yQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cn(n){return(e,t,r,s,i)=>{const o=ut(e,t),a=o.length,l=Qe(o),u=we(o),c=pr(i,u),h=e.length,d=t.length,f=Qe(e),p=Qe(t),v=Ku(e,o),g=Ku(t,o);if(v.length+g.length===0)for(let m=0;m<c.length;++m)c[m]=n(r[m%r.length],s[m%s.length]);else for(let m=0;m<c.length;++m){const y=fc(m,a,l),w=y.slice(-h);v.forEach(k=>w[k]=0);const x=Vi(w,h,f),b=y.slice(-d);g.forEach(k=>b[k]=0);const C=Vi(b,d,p);c[m]=n(r[x],s[C])}return[c,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xr(n){const{inputs:e,backend:t}=n,{real:r,imag:s}=e,i=t.data.get(r.dataId).values,o=t.data.get(s.dataId).values,a=t.makeTensorInfo(r.shape,"complex64"),l=t.data.get(a.dataId);return l.complexTensorInfos={real:t.makeTensorInfo(r.shape,"float32",i),imag:t.makeTensorInfo(s.shape,"float32",o)},a}const wQ={kernelName:db,backendName:"cpu",kernelFunc:Xr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zm(n,e,t="float32"){if(t==="complex64"){const s=Zm(n,e,"float32"),i=Zm(n,e,"float32");return Xr({inputs:{real:s,imag:i},backend:n})}const r=mr(we(e),t);return n.makeTensorInfo(e,t,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yi(n){const{inputs:e,backend:t}=n,{x:r}=e;return t.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const bQ={kernelName:Xd,backendName:"cpu",kernelFunc:Yi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bl(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.data.get(r.dataId).complexTensorInfos.real,i=t.data.get(s.dataId).values;return t.makeTensorInfo(s.shape,s.dtype,i)}const CQ={kernelName:Lb,backendName:"cpu",kernelFunc:bl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n3(n,e,t,r){if(r==="int32"){const s=Int32Array.from(n);return[e,"int32",s]}if(r==="bool"){const s=Al([0],t),[i,o]=Cn((a,l)=>a!==l?1:0)(e,[],n,s,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${t} to ${r}`)}function ga(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return Yi({inputs:{x:s},backend:t});const c=Zm(t,s.shape,s.dtype),h=ga({inputs:{x:s},backend:t,attrs:{dtype:"float32"}}),d=Xr({inputs:{real:h,imag:c},backend:t});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(h),d}if(s.dtype==="complex64"){const c=bl({inputs:{input:s},backend:t}),h=ga({inputs:{x:c},backend:t,attrs:{dtype:i}});return t.disposeIntermediateTensorInfo(c),h}if(!CD(s.dtype,i)){const c=Yi({inputs:{x:s},backend:t});return{dataId:c.dataId,shape:c.shape,dtype:i}}const o=t.data.get(s.dataId).values,[a,l,u]=n3(o,s.shape,s.dtype,i);return t.makeTensorInfo(a,l,u)}const SQ={kernelName:Ld,backendName:"cpu",kernelFunc:ga};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jn(n,e,t,r){return t==null?({inputs:s,backend:i})=>{const{a:o,b:a}=s,l=i;qe([o,a],n);const u=l.data.get(o.dataId).values,c=l.data.get(a.dataId).values,h=o.dtype==="string"?Co(u):u,d=o.dtype==="string"?Co(c):c,f=r||o.dtype,[p,v]=e(o.shape,a.shape,h,d,f);return l.makeTensorInfo(v,f,p)}:({inputs:s,backend:i})=>{const{a:o,b:a}=s,l=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const u=ga({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),h=c.complexTensorInfos.real,d=c.complexTensorInfos.imag,f=l.data.get(h.dataId).values,p=l.data.get(d.dataId).values,v=ga({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),g=l.data.get(v.dataId),m=g.complexTensorInfos.real,y=g.complexTensorInfos.imag,w=l.data.get(m.dataId).values,x=l.data.get(y.dataId).values,[b,C,k]=t(o.shape,a.shape,f,p,w,x),E=l.makeTensorInfo(k,"float32",b),T=l.makeTensorInfo(k,"float32",C),_=Xr({inputs:{real:E,imag:T},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(v),l.disposeIntermediateTensorInfo(E),l.disposeIntermediateTensorInfo(T),_}else{const u=l.data.get(o.dataId).values,c=l.data.get(a.dataId).values,h=r||o.dtype,[d,f]=e(o.shape,a.shape,u,c,h);return l.makeTensorInfo(f,h,d)}}}function TC(n){return(e,t,r,s,i,o)=>{const a=ut(e,t),l=we(a),u=a.length,c=Qe(a),h=pr("float32",l),d=pr("float32",l),f=Ku(e,a),p=Ku(t,a),v=bo(r,s),g=bo(i,o),m=e.length,y=Qe(e),w=t.length,x=Qe(t);if(f.length+p.length===0)for(let b=0;b<h.length;b++){const C=b%v.length,k=b%g.length,E=n(v[C*2],v[C*2+1],g[k*2],g[k*2+1]);h[b]=E.real,d[b]=E.imag}else for(let b=0;b<h.length;b++){const C=fc(b,u,c),k=C.slice(-m);f.forEach(P=>k[P]=0);const E=Vi(k,m,y),T=C.slice(-w);p.forEach(P=>T[P]=0);const _=Vi(T,w,x),A=n(v[E*2],v[E*2+1],g[_*2],g[_*2+1]);h[b]=A.real,d[b]=A.imag}return[h,d,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r3=Cn((n,e)=>n+e),kQ=TC((n,e,t,r)=>({real:n+t,imag:e+r})),Qu=jn(pc,r3,kQ),EQ={kernelName:pc,backendName:"cpu",kernelFunc:Qu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _C(n,e,t,r,s){const i=we(r),o=mr(s,t);for(let a=0;a<n.length;a++){const l=n[a];if(l<0)throw new Error("Input x must be non-negative!");l>=s||(i>0?o[l]+=e[a]:o[l]+=1)}return o}function s3(n,e,t,r=!1){const s=n.shape[0],i=n.shape[1],o=pt([s,t],e.dtype);for(let a=0;a<s;a++)for(let l=0;l<i;l++){const u=n.get(a,l);if(u<0)throw new Error("Input x must be non-negative!");u>=t||(r?o.set(1,a,u):e.size>0?o.set(o.get(a,u)+e.get(a,l),a,u):o.set(o.get(a,u)+1,a,u))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i3=Cn((n,e)=>n&e),IQ=jn(hb,i3),TQ={kernelName:hb,backendName:"cpu",kernelFunc:IQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eo(n){return(e,t,r)=>{const s=vn(t,e.length);for(let i=0;i<e.length;++i)s[i]=n(e[i],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ft(n,e,t){const r=eo(e);return Na(n,r,t)}function Na(n,e,t){return({inputs:r,attrs:s,backend:i})=>{const{x:o}=r;qe(o,n);const a=i,l=a.data.get(o.dataId).values;let u;if(o.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=Co(l)}else u=l;const c=t||o.dtype,h=e(u,c,s);return a.makeTensorInfo(o.shape,c,h)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o3=eo(n=>Math.ceil(n)),_Q=Na(Pd,o3),NQ={kernelName:Pd,backendName:"cpu",kernelFunc:_Q};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a3(n,e,t,r){const s=vn(t,we(e));if(r&&t!=="string"){let i=0;n.forEach(o=>{const a=we(o.shape);s.set(o.vals,i),i+=a})}else{let i=0;n.forEach(o=>{const a=t==="string"?Co(o.vals):o.vals;let l=0;for(let u=0;u<o.shape[0];++u){const c=u*e[1]+i;for(let h=0;h<o.shape[1];++h)s[c+h]=a[l++]}i+=o.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l3=Cn((n,e)=>n===e?1:0),u3=jn(p0,l3,null,"bool"),$Q={kernelName:p0,backendName:"cpu",kernelFunc:u3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c3=eo(n=>Math.exp(n)),h3=Na(Gd,c3,"float32"),DQ={kernelName:Gd,backendName:"cpu",kernelFunc:h3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d3=eo(n=>Math.expm1(n)),AQ=Na(jd,d3),RQ={kernelName:jd,backendName:"cpu",kernelFunc:AQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f3=eo(n=>Math.floor(n)),OQ=Na(Hd,f3),FQ={kernelName:Hd,backendName:"cpu",kernelFunc:OQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p3=Cn((n,e)=>Math.floor(n/e)),LQ=jn(qd,p3,null,"int32"),PQ={kernelName:qd,backendName:"cpu",kernelFunc:LQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m3(n,e,t,r,s,i,o,a,l){const u=pt([r,i],t);for(let c=0;c<r;c++){const h=[];let d=0;for(let f=0;f<s;f++){const p=n[c*s+f];d+=p*o[f],h.push(p)}if(d<0||d>=l/i)throw new Error(`Invalid indices: ${h} does not index into ${a}`);for(let f=0;f<i;f++)u.values[c*i+f]=e.get(...e.indexToLoc(d*i+f))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g3(n,e,t){const r=pt(t,n.dtype);for(let s=0;s<r.size;++s){const o=r.indexToLoc(s).slice(),a=o[0],l=o[2],u=e.locToIndex([a,l]);o[2]=e.values[u];const c=n.locToIndex(o);0<=c&&c<n.values.length&&(r.values[s]=n.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v3=Cn((n,e)=>n>e?1:0),MQ=jn(y0,v3,null,"bool"),BQ={kernelName:y0,backendName:"cpu",kernelFunc:MQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y3=Cn((n,e)=>n>=e?1:0),zQ=jn(Kd,y3,null,"bool"),UQ={kernelName:Kd,backendName:"cpu",kernelFunc:zQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x3=Cn((n,e)=>n<e?1:0),VQ=jn(w0,x3,null,"bool"),WQ={kernelName:w0,backendName:"cpu",kernelFunc:VQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w3=Cn((n,e)=>n<=e?1:0),GQ=jn(b0,w3,null,"bool"),jQ={kernelName:b0,backendName:"cpu",kernelFunc:GQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b3(n,e,t){const r=(e-n)/(t-1),s=mr(t,"float32");s[0]=n;for(let i=1;i<s.length;i++)s[i]=s[i-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C3=eo(n=>Math.log(n)),HQ=Na(Jd,C3),qQ={kernelName:Jd,backendName:"cpu",kernelFunc:HQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S3(n,e,t,r){const s=pr(r,we(t));for(let i=0;i<s.length;++i){const o=i*e;let a=n[o];for(let l=0;l<e;++l){const u=n[o+l];(Number.isNaN(u)||u>a)&&(a=u)}s[i]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k3=Cn((n,e)=>Math.max(n,e)),KQ=jn(tf,k3),XQ={kernelName:tf,backendName:"cpu",kernelFunc:KQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E3=Cn((n,e)=>Math.min(n,e)),YQ=jn(nf,E3),ZQ={kernelName:nf,backendName:"cpu",kernelFunc:YQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NC=Cn((n,e)=>n*e),QQ=TC((n,e,t,r)=>({real:n*t-e*r,imag:n*r+e*t})),Cv=jn(sf,NC,QQ),JQ={kernelName:sf,backendName:"cpu",kernelFunc:Cv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I3(n,e,t){const r=Ca(-1,t);return NC([],e,r,n,t)}function eJ(n){const{inputs:e,backend:t}=n,{x:r}=e;qe(r,"neg");const s=t.data.get(r.dataId).values,[i,o]=I3(s,r.shape,r.dtype);return t.makeTensorInfo(o,r.dtype,i)}const tJ={kernelName:A0,backendName:"cpu",kernelFunc:eJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T3=Cn((n,e)=>n!==e?1:0),nJ=jn(R0,T3,null,"bool"),rJ={kernelName:R0,backendName:"cpu",kernelFunc:nJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $C(n,e,t,r,s){const i=e.length,o=we(e),a=Qe(e),l=Qe(s),u=pr(t,we(s));for(let c=0;c<o;++c){const h=fc(c,i,a),d=new Array(h.length);for(let p=0;p<d.length;p++)d[p]=h[r[p]];const f=Vi(d,i,l);u[f]=n[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zr(n){const{inputs:e,attrs:t,backend:r}=n,{x:s}=e,{perm:i}=t;qe(s,"transpose");const o=s.shape.length,a=new Array(o);for(let h=0;h<a.length;h++)a[h]=s.shape[i[h]];const l=r.data.get(s.dataId).values,u=$C(l,s.shape,s.dtype,i,a);return{dataId:r.write(u,a,s.dtype),shape:a,dtype:s.dtype}}const sJ={kernelName:Du,backendName:"cpu",kernelFunc:zr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _3(n,e,t,r){const[s,i]=Jn(n,r),o=ns(e,"int32"),a=mr(we(s),o),l=we(i);for(let u=0;u<a.length;++u){const c=u*l;let h=1;for(let d=0;d<l;++d)h*=t[c+d];a[u]=h}return{outVals:a,outShape:s,outDtype:o}}function iJ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r;qe(s,"prod");const a=s.shape.length,l=mt(i,s.shape),u=un(l,a);let c=l,h=s;const d=[];u!=null&&(h=zr({inputs:{x:s},backend:t,attrs:{perm:u}}),d.push(h),c=wn(c.length,a));const f=t.data.get(h.dataId).values,{outVals:p,outShape:v,outDtype:g}=_3(h.shape,h.dtype,f,c);let m=v;return o&&(m=Rn(v,l)),d.forEach(y=>t.disposeIntermediateTensorInfo(y)),t.makeTensorInfo(m,g,p)}const oJ={kernelName:B0,backendName:"cpu",kernelFunc:iJ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aJ(n,e,t){n.forEach((r,s)=>{if(r<0||r>=t){const i=fc(s,e.length,Qe(e)).join(",");throw new Error(`indices[${i}] = ${r} is not in [0, ${t})`)}})}function lJ(n,e){for(let t=0;t<n.length;++t){const r=n[t],s=t===n.length-1?e:n[t+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function uJ(n,e,t,r){const s=[];let i=0;const o=e.length-1+t.length,a=new Array(o).fill(null).map(()=>[0]);lJ(t,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let h=1;h<l+1;++h)a[u].push(h*c)}for(let u=0;u<n.length;++u){let c=n[u],h=n[u]+1;for(let d=0;d<t.length;++d){const f=t[d],p=d+e.length-1;if(p>=0){const v=a[p],g=v[v.length-1]-f[c];for(let m=c;m<h;++m)a[p].push(f[m+1]+g)}c=f[c],h=f[h]}h!==c&&(s.push([c,h]),i+=h-c)}return{outSplits:a,valueSlices:s,numValues:i}}function cJ(n){const e=[];for(let t=0;t<n.length;++t){const r=n[t].length,s=vn("int32",r);e.push(s),n[t].forEach((i,o)=>s[o]=i)}return e}function DI(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let r=e;r<n.length;r++)t[e-1]*=n[r];return t}function hJ(n,e,t,r,s,i){const o=DI(e,2)[1],a=DI(i,2)[1];let l=0;for(const u of t)for(let c=u[0];c<u[1];++c){for(let h=0;h<r;++h)s[l*a+h]=n[c*o+h];++l}}function dJ(n,e,t,r,s){const i=e.slice();i[0]=s;const o=vn(t,we(i)),a=n.length,l=a===0?0:a/e[0];return hJ(n,e,r,l,o,i),[o,i]}function N3(n,e,t,r,s,i,o,a){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(aJ(i,o,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:h,numValues:d}=uJ(i,o,n,u),f=cJ(c),p=dJ(t,r,s,h,d);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AI=2147483647;function $3(n,e,t,r,s,i,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=s.length===0,u=o.length===0,c=[];a||c.push(e[0]),l||c.push(s[0]),u||c.push(o[0]);for(let g=1;g<c.length;++g)if(c[g]!==c[g-1])throw new Error("starts, limits, and deltas must have the same shape");const h=c.length===0?1:c[0],d=vn("int32",h+1);d[0]=0;for(let g=0;g<h;++g){const m=a?n[0]:n[g],y=l?r[0]:r[g],w=u?i[0]:i[g];if(w===0)throw new Error("Requires delta != 0");let x;if(w>0&&y<m||w<0&&y>m)x=0;else if(x=Math.ceil(Math.abs((y-m)/w)),x>AI)throw new Error(`Requires ((limit - start) / delta) <= ${AI}`);d[g+1]=d[g]+x}const f=d[h],p=vn(t,f);let v=0;for(let g=0;g<h;++g){const m=d[g+1]-d[g];let y=a?n[0]:n[g];const w=u?i[0]:i[g];for(let x=0;x<m;++x)p[v++]=y,y+=w}return[d,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ds=li;class Qm{constructor(e,t,r,s,i,o,a,l,u,c){this.shape=e,this.shapeShape=t,this.values=r,this.valuesShape=s,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=vR(c),this.raggedRank=yR(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Ds.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Ds.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Ds.VALUE_ROWIDS:return Qm.getMaxWidthValueRowID(t);case Ds.ROW_SPLITS:return Qm.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${Ds[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let r=0;for(let s=0;s<t-1;++s){const i=e[s+1]-e[s];i>r&&(r=i)}return r}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let r=0,s=e[0],i=0;for(let o=1;o<t;++o){const a=e[o];a!==s&&(s=a,i=Math.max(o-r,i),r=o)}return Math.max(t-r,i)}tensorShapeFromTensor(e,t,r=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return OI(e,r)}calculateOutputSize(e){const t=this.valuesShape,r=this.defaultValueShape;xR(r,t);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=gR(this.raggedRank,s,t);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,t,r){const s=Math.min(e,r),i=[];let o=0;for(let a=0;a<s;++a,o+=t)i.push(o);for(let a=s;a<e;++a)i.push(-1);return O(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,t,r,s){const i=e.length,o=[];for(let a=0;a<i-1;++a){const l=e[a+1]-e[a];let u=Math.min(s,l),c=t[a];c===-1&&(u=0);for(let h=0;h<u;++h)o.push(c),c+=r;for(let h=0;h<l-u;++h)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,t,r,s){const i=e.length,o=[];if(i===0)return[];let a=0,l=e[0];if(l>=t.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${t.length}`);let u=t[l];o.push(u);for(let c=1;c<i;++c){const h=e[c];if(h===l)u>=0&&(++a,a<s?u+=r:u=-1);else{if(a=0,l=h,h>=t.length)throw new Error(`Got nextValueRowId=${h} which is not less than ${t.length}`);u=t[h]}o.push(u)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,t,r,s){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case Ds.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,t,r,s);case Ds.ROW_SPLITS:if(i.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(i,t,r,s);default:throw new Error(`Unsupported partition type: ${Ds[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case Ds.FIRST_DIM_SIZE:return e[0];case Ds.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ds.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Ds[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),r=this.calculateOutputSize(t),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let l=s.length-2;l>=0;--l)s[l]=s[l+1]*r[l+1];const i=OI(r,!1),o=vn(this.valuesDType,we(i));if(s[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(t,s[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,s[u],r[u]);this.setOutput(this.raggedRank,l,o,i)}return[i,o]}setOutput(e,t,r,s){if(r.length===0)return;const i=this.values,o=r;let a=s.slice();a=a.slice(e+1);const l=we(a),u=t.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const p=this.defaultValueShape;pe(()=>{const v=ae(c,p);c=Sh(v,a).dataSync()})}let h=0,d=0,f=0;for(let p=0;p<=u;++p){let v=p<u?t[p]:-1;if(v===f){++f;continue}if(d<f){const g=i.subarray(h*l),m=o.subarray(d*l),y=(f-d)*l;RI(m,g,y)}if(p>=u){const g=r.length;v=Math.floor(g/l)}if(v>f)if(this.defaultValue.length===1)o.subarray(f*l,v*l).fill(this.defaultValue[0]),f=v;else for(;v>f;){const g=o.slice(f*l);RI(g,c,l),++f}v<0?(h=p+1,d=f):(h=p,d=f,f=d+1)}}}function RI(n,e,t){for(let r=0;r<t;r++)n[r]=e[r]}function OI(n,e){const t=[];for(let r of n){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}t.push(r)}return t}function D3(n,e,t,r,s,i,o,a,l,u){return new Qm(n,e,t,r,s,i,o,a,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A3(n,e,t,r){const s=n===e,i=n<e&&t<0,o=e<n&&t>1;if(s||i||o)return mr(0,r);const a=Math.abs(Math.ceil((e-n)/t)),l=mr(a,r);e<n&&t===1&&(t=-1),l[0]=n;for(let u=1;u<l.length;u++)l[u]=l[u-1]+t;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R3=eo(n=>1/Math.sqrt(n)),fJ=Na(hf,R3),pJ={kernelName:hf,backendName:"cpu",kernelFunc:fJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xa(n,e,t,r,s,i,o,a,l,u){const c=[r/s,s],h=n.values,d=e.values;if(r===0)return pt(t,e.dtype);const f=l instanceof ir?l:pt(c,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<i;p++){const v=[];let g=0;for(let m=0;m<o;m++){const y=h[p*o+m];v.push(y),g+=y*a[m]}if(g<0||g>=r/s)throw new Error(`Invalid indices: ${v} does not index into ${t}`);for(let m=0;m<s;m++)u?f.values[g*s+m]+=d[p*s+m]:f.values[g*s+m]=e.rank===0?d[0]:d[p*s+m]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mJ=eo(n=>1/(1+Math.exp(-n))),O3=Ft(gf,n=>1/(1+Math.exp(-n))),gJ={kernelName:gf,backendName:"cpu",kernelFunc:O3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F3(n,e,t,r,s){const i=P2(r,e,t),o=we(t),a=Qe(r);if(i){const h=M2(e,a);return s==="string"?n.slice(h,h+o):n.subarray(h,h+o)}const l=s==="string"?Co(n):n,u=pt(r,s,l),c=pt(t,s);for(let h=0;h<c.size;++h){const d=c.indexToLoc(h),f=d.map((p,v)=>p+e[v]);c.set(u.get(...f),...d)}return s==="string"?BR(c.values):c.values}function Cl(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,size:o}=r;qe(s,"slice");const[a,l]=av(s,i,o);F2(s,a,l);const u=t.data.get(s.dataId).values,c=F3(u,a,l,s.shape,s.dtype);return t.makeTensorInfo(l,s.dtype,c)}const vJ={kernelName:j0,backendName:"cpu",kernelFunc:Cl};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L3(n,e,t,r,s,i,o){const a=e[0],l=i[0],u=new Array(l),c=new Array(a),h=e[1];if(l===0){if(a!==0)throw new Error(IR(a));const g=vn(t,0),m=vn(s,0);return[g,[0,h],m,u,c]}let d=!0,f=0;const p=new Array(l).fill(0);for(let g=0;g<a;++g){const m=n[g*h];if(m<0)throw new Error(TR(g,m));if(m>=l)throw new Error(_R(g,m,l));++p[m],d=d&&m>=f,f=m}let v=!0;for(let g=0;g<l;++g){const m=p[g]===0;u[g]=m,v=v&&!m,p[g]=Math.max(p[g],1),g>0&&(p[g]+=p[g-1])}if(v&&d){const g=n,m=r;for(let y=0;y<a;++y)c[y]=y;return[g,[a,h],m,u,c]}else{const g=p[l-1],m=vn(t,g*h),y=vn(s,g),w=new Array(l).fill(0);for(let x=0;x<a;++x){const b=n[x*h],C=w[b],k=(b===0?0:p[b-1])+C;w[b]++;for(let E=0;E<h;++E)m[k*h+E]=n[x*h+E];y[k]=r[x],c[x]=k}for(let x=0;x<l;++x)if(w[x]===0){const C=x===0?0:p[x-1];m[C*h+0]=x;for(let k=1;k<h;++k)m[C*h+k]=0;y[C]=o}return[m,[g,h],y,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P3(n,e,t,r,s){const i=we(r),o=e[0],a=s.length,l=[];let u=1,c=-1;for(let g=0;g<a;++g){const m=s[g];if(m===-1){if(c!==-1)throw new Error(NR(c,g));c=g,l.push(1)}else{if(m<0)throw new Error($R(g,m));u*=m,l.push(m)}}if(c!==-1){if(u<=0)throw new Error(DR());const g=Math.trunc(i/u);if(u*g!==i)throw new Error(AR(r,l));l[c]=g}if(we(l)!==i)throw new Error(RR(r,l));const d=r.length,f=[];if(d>0){f[d-1]=1;for(let g=d-2;g>=0;--g)f[g]=f[g+1]*r[g+1]}const p=[];if(a>0){p[a-1]=1;for(let g=a-2;g>=0;--g)p[g]=p[g+1]*l[g+1]}const v=vn(t,o*a);for(let g=0;g<o;++g){let m=0;for(let y=0;y<d;++y)m+=n[g*d+y]*f[y];for(let y=0;y<a;++y)v[g*a+y]=Math.trunc(m/p[y]),m%=p[y]}return[v,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DC(n,e,t,r,s,i=!1,o=0){const a=r.length,l=[e[0],n.length/e[0]],u=l[1],h=a>0?s[a-1]+1:0;if(h<0)throw new Error(g1());const d=e.slice();d[0]=h;const f=d.reduce((w,x)=>w*x,1),p=vn(t,f);if(a===0)return h>0&&p.fill(o),[p,d];if(h<=0)throw new Error(g1());let v=0,g=1,m=0,y=s[v];for(;;){let w=0;if(g<a){if(w=s[g],y===w){++g;continue}if(y>=w)throw new Error(OR())}if(y<0||y>=h)throw new Error(FR(y,h));y>m&&p.fill(o,m*u,y*u);for(let x=v;x<g;++x){const b=r[x];if(b<0||b>=l[0])throw new Error(LR(x,r[x],l[0]));for(let C=0;C<u;C++)p[y*u+C]+=n[b*u+C]}if(i)for(let x=0;x<u;x++)p[y*u+x]/=g-v;if(v=g,++g,m=y+1,y=w,g>a)break}return m<h&&p.fill(o,m*u,h*u),[p,d]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yJ=eo(n=>Math.sqrt(n)),xJ=Ft(yf,n=>Math.sqrt(n)),wJ={kernelName:yf,backendName:"cpu",kernelFunc:xJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M3=Cn((n,e)=>{const t=n-e;return t*t}),bJ=jn(xf,M3),CJ={kernelName:xf,backendName:"cpu",kernelFunc:bJ};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B3=eo((n,e)=>{const{pattern:t,replaceGlobal:r,rewrite:s}=e;return n.replace(new RegExp(t,r?"g":""),s)}),SJ=Na(zb,B3),kJ={kernelName:zb,backendName:"cpu",kernelFunc:SJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z3(n,e,t,r){const s=pt(n,e.dtype);for(let i=0;i<s.size;i++){const o=s.indexToLoc(i),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*t[l]+r[l];s.set(e.get(...a),...o)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EJ{constructor(e,t,r,s,i,o){this.separator=sa(e),this.nGramWidths=t,this.leftPad=sa(r),this.rightPad=sa(s),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const r=this.getPadWidth(t);return Math.max(0,e+2*r-t+1)}createNGrams(e,t,r,s,i,o){for(let a=0;a<i;++a){const l=this.getPadWidth(o),u=Math.max(0,l-a),c=Math.max(0,l-(i-(a+1))),h=o-(u+c),d=t+(u>0?0:a-l);let f=0;f+=u*this.leftPad.length;for(let y=0;y<h;++y)f+=e[d+y].length;f+=c*this.rightPad.length;const p=u+c+h-1;f+=p*this.separator.length,r[s+a]=new Uint8Array(f);const v=r[s+a];let g=0;const m=y=>y.forEach(w=>v[g++]=w);for(let y=0;y<u;++y)m(this.leftPad),m(this.separator);for(let y=0;y<h-1;++y)m(e[d+y]),m(this.separator);if(h>0){m(e[d+h-1]);for(let y=0;y<c;++y)m(this.separator),m(this.rightPad)}else{for(let y=0;y<c-1;++y)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,t){const r=e.length,s=t.length;if(s>0){let l=t[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<s;++u){let c=t[u]>=l;if(c=c&&t[u]<=r,!c)throw new Error(`Invalid split value ${t[u]}, must be in [${l}, ${r}]`);l=t[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const i=s-1,o=vn("int32",s);if(r===0||s===0){const l=new Array(r);for(let u=0;u<=i;++u)o[u]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const u=t[l]-t[l-1];let c=0;this.nGramWidths.forEach(h=>{c+=this.getNumNGrams(u,h)}),this.preserveShort&&u>0&&c===0&&(c=1),o[l]=o[l-1]+c}const a=new Array(o[i]);for(let l=0;l<i;++l){const u=t[l];let c=o[l];if(this.nGramWidths.forEach(h=>{const d=t[l+1]-t[l],f=this.getNumNGrams(d,h);this.createNGrams(e,u,a,c,f,h),c+=f}),this.preserveShort&&c===o[l]){const h=t[l+1]-t[l];if(h===0)continue;const d=h+2*this.padWidth,f=1;this.createNGrams(e,u,a,c,f,d)}}return[a,o]}}function U3(n,e,t,r,s,i,o,a){return new EJ(t,r,s,i,o,a).compute(n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IJ(n,e,t,r){if(!n.length)return;if(e.length===0){for(let i=0;i<n.length;++i)r.push(n.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=n.indexOf(i);for(;o!==-1;){const a=n.subarray(0,o);(!t||a.length!==0)&&r.push(a),n=n.subarray(o+1),o=n.indexOf(i)}(!t||n.length!==0)&&r.push(n);return}let s=0;for(let i=0;i<n.length+1;i++)if(i===n.length||e.indexOf(n[i])!==-1){const o=n.subarray(s,i);(!t||o.length!==0)&&r.push(o),s=i+1}}function V3(n,e,t){const r=n.length,s=[];let i=0,o=0;const a=new Array(r);for(let d=0;d<r;++d){const f=s.length;IJ(n[d],e,t,s);const p=s.length-f;a[d]=p,i+=p,o=Math.max(o,p)}const l=vn("int32",i*2),u=new Array(i),c=[r,o];let h=0;for(let d=0;d<r;++d)for(let f=0;f<a[d];++f)l[h*2]=d,l[h*2+1]=f,u[h]=s[h],++h;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W3(n,e){const t=vn("int32",n.length);for(let r=0;r<n.length;++r)t[r]=j5(n[r]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G3=Cn((n,e)=>n-e),TJ=TC((n,e,t,r)=>({real:n-t,imag:e-r})),AC=jn(wf,G3,TJ),_J={kernelName:wf,backendName:"cpu",kernelFunc:AC};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j3(n,e){const t=new Array(n.rank);for(let s=0;s<t.length;s++)t[s]=n.shape[s]*e[s];const r=pt(t,n.dtype);for(let s=0;s<r.values.length;++s){const i=r.indexToLoc(s),o=new Array(n.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%n.shape[l];const a=n.locToIndex(o);r.values[s]=n.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ah=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function H3(n,e,t=0,r=n.length-1){for(;r>t;){if(r-t>600){const a=r-t+1,l=e-t+1,u=Math.log(a),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(a-c)/a)*Math.sign(l-a/2),d=Math.max(t,Math.floor(e-l*c/a+h)),f=Math.min(r,Math.floor(e+(a-l)*c/a+h));H3(n,e,d,f)}const s=n[e];let i=t,o=r;for(su(n,t,e),ah(n[r],s)>0&&su(n,t,r);i<o;){for(su(n,i,o),i++,o--;ah(n[i],s)<0;)i=i+1;for(;ah(n[o],s)>0;)o=o-1}ah(n[t],s)===0?su(n,t,o):(o=o+1,su(n,o,r)),o<=e&&(t=o+1),e<=o&&(r=o-1)}}function q3(n,e,t,r,s){const i=e[e.length-1],[o,a]=[n.length/i,i],l=pr(t,o*r),u=pr("int32",o*r);for(let h=0;h<o;h++){const d=h*a,f=n.subarray(d,d+a);let p=new Array(f.length);f.forEach((y,w)=>p[w]={value:y,index:w}),r<p.length&&(H3(p,r),p=p.slice(0,r)),s&&p.sort(ah);const v=h*r,g=l.subarray(v,v+r),m=u.subarray(v,v+r);for(let y=0;y<r;y++)g[y]=p[y].value,m[y]=p[y].index}const c=e.slice();return c[c.length-1]=r,[pt(c,t,l),pt(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K3(n,e,t,r){const s=mt(e,t)[0],i=[1,t[0],1];for(let p=0;p<s;p++)i[0]*=t[p];i[1]=t[s];for(let p=s+1;p<t.length;p++)i[2]*=t[p];const o=new Map,a=new Int32Array(t[s]),l=new ir(i,r,n),u=[],c=i[0]===1&&i[2]===1;for(let p=0;p<t[s];p++){let v;if(c)v=n[p].toString();else{const m=[];for(let y=0;y<i[0];y++)for(let w=0;w<i[2];w++)m.push(l.get(y,p,w));v=m.join(",")}const g=o.get(v);if(g!=null)a[p]=g;else{const m=o.size;o.set(v,m),a[p]=m,u.push(p)}}const h=i.slice();h[1]=o.size;const d=new ir(h,r);u.forEach((p,v)=>{for(let g=0;g<i[0];g++)for(let m=0;m<i[2];m++)d.set(l.get(g,p,m),g,v,m)});const f=t.slice();return f[s]=h[1],{outputValues:d.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NJ=Object.freeze(Object.defineProperty({__proto__:null,addImpl:r3,bincountImpl:_C,bincountReduceImpl:s3,bitwiseAndImpl:i3,castImpl:n3,ceilImpl:o3,concatImpl:a3,equalImpl:l3,expImpl:c3,expm1Impl:d3,floorDivImpl:p3,floorImpl:f3,gatherNdImpl:m3,gatherV2Impl:g3,greaterEqualImpl:y3,greaterImpl:v3,lessEqualImpl:w3,lessImpl:x3,linSpaceImpl:b3,logImpl:C3,maxImpl:S3,maximumImpl:k3,minimumImpl:E3,multiplyImpl:NC,negImpl:I3,notEqualImpl:T3,prodImpl:_3,raggedGatherImpl:N3,raggedRangeImpl:$3,raggedTensorToTensorImpl:D3,rangeImpl:A3,rsqrtImpl:R3,scatterImpl:Xa,sigmoidImpl:mJ,simpleAbsImpl:t3,sliceImpl:F3,sparseFillEmptyRowsImpl:L3,sparseReshapeImpl:P3,sparseSegmentReductionImpl:DC,sqrtImpl:yJ,squaredDifferenceImpl:M3,staticRegexReplaceImpl:B3,stridedSliceImpl:z3,stringNGramsImpl:U3,stringSplitImpl:V3,stringToHashBucketFastImpl:W3,subImpl:G3,tileImpl:j3,topKImpl:q3,transposeImpl:$C,uniqueImpl:K3},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */bA("cpu",()=>new bv,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X3=Ft(Vd,n=>n>=0?n:Math.exp(n)-1),$J={kernelName:Vd,backendName:"cpu",kernelFunc:X3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y3(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{alpha:i}=r;qe([s],"leakyRelu");const o=we(s.shape),a=t.data.get(s.dataId).values,l=pr("float32",o);for(let u=0;u<a.length;u++)l[u]=a[u]<0?i*a[u]:a[u];return t.makeTensorInfo(s.shape,"float32",l)}const DJ={kernelName:x0,backendName:"cpu",kernelFunc:Y3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AJ=Cn((n,e)=>n<0?e*n:n);function Z3(n){const{inputs:e,backend:t}=n,{x:r,alpha:s}=e;qe([r,s],"prelu");const i=t.data.get(r.dataId).values,o=t.data.get(s.dataId).values,[a,l]=AJ(r.shape,s.shape,i,o,"float32");return t.makeTensorInfo(l,"float32",a)}const RJ={kernelName:M0,backendName:"cpu",kernelFunc:Z3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q3=Ft(lf,n=>Math.max(0,n)),OJ={kernelName:lf,backendName:"cpu",kernelFunc:Q3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J3=Ft(uf,n=>Math.min(Math.max(0,n),6)),FJ={kernelName:uf,backendName:"cpu",kernelFunc:J3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jm(n,e,t,r,s){if(t==="linear")return Yi({inputs:{x:e},backend:n});if(t==="relu")return Q3({inputs:{x:e},backend:n});if(t==="elu")return X3({inputs:{x:e},backend:n});if(t==="relu6")return J3({inputs:{x:e},backend:n});if(t==="prelu")return Z3({inputs:{x:e,alpha:r},backend:n});if(t==="leakyrelu")return Y3({inputs:{x:e},backend:n,attrs:{alpha:s}});if(t==="sigmoid")return O3({inputs:{x:e},backend:n});throw new Error(`Activation ${t} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kt(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{shape:i}=r,o=we(s.shape),a=bD(i,o),l=we(a);O(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${s.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),t.incRef(s.dataId);const u=t.data.get(s.dataId);if(u.complexTensorInfos!=null){const c=u.complexTensorInfos.real,h=u.complexTensorInfos.imag;c.shape=a,h.shape=a}return{dataId:s.dataId,shape:a,dtype:s.dtype}}const LJ={kernelName:z0,backendName:"cpu",kernelFunc:Kt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eL(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;qe([s,i],"matMul");const l=s.shape.length,u=i.shape.length,c=o?s.shape[l-2]:s.shape[l-1],h=a?i.shape[u-1]:i.shape[u-2],d=o?s.shape[l-1]:s.shape[l-2],f=a?i.shape[u-2]:i.shape[u-1],p=s.shape.slice(0,-2),v=i.shape.slice(0,-2),g=we(p),m=we(v),w=ut(s.shape.slice(0,-2),i.shape.slice(0,-2)).concat([d,f]);O(c===h,()=>`Error in matMul: inner shapes (${c}) and (${h}) of Tensors with shapes ${s.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const x=o?[g,c,d]:[g,d,c],b=a?[m,f,h]:[m,h,f],C=Kt({inputs:{x:s},backend:t,attrs:{shape:x}}),k=Kt({inputs:{x:i},backend:t,attrs:{shape:b}}),E=o?C.shape[1]:C.shape[2],T=o?C.shape[2]:C.shape[1],_=a?k.shape[1]:k.shape[2],A=Math.max(g,m),P=t.data.get(C.dataId).values,j=t.data.get(k.dataId).values,X=Qe(C.shape),F=Qe(k.shape),[M,W,D]=o?[X[0],1,X[1]]:[X[0],X[1],1],[z,K,ie]=a?[1,F[1],F[0]]:[F[1],1,F[0]],V=T*_,Z=pt([A,T,_],C.dtype),de=Z.values,ge=t.blockSize;for(let ye=0;ye<A;ye++){const G=ye%g,J=ye%m;for(let fe=0;fe<T;fe+=ge){const ve=Math.min(fe+ge,T);for(let be=0;be<_;be+=ge){const $e=Math.min(be+ge,_);for(let Pe=0;Pe<E;Pe+=ge){const Ge=Math.min(Pe+ge,E);for(let Xe=fe;Xe<ve;Xe++)for(let Je=be;Je<$e;Je++){let Ze=0;for(let it=Pe;it<Ge;it++){const cn=P[G*M+Xe*W+it*D],dt=j[it*z+Je*K+J*ie];Ze+=cn*dt}de[ye*V+(Xe*_+Je)]+=Ze}}}}}return t.disposeIntermediateTensorInfo(C),t.disposeIntermediateTensorInfo(k),t.makeTensorInfo(w,Z.dtype,Z.values)}const PJ={kernelName:s0,backendName:"cpu",kernelFunc:eL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MJ(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:h}=r;let d,f,p;const v=[];d=eL({inputs:{a:s,b:i},attrs:{transposeA:l,transposeB:u},backend:t}),o&&(f=Qu({inputs:{a:d,b:o},backend:t}),v.push(d),d=f),c&&(p=Jm(t,d,c,a,h),v.push(d),d=p);for(const m of v)t.disposeIntermediateTensorInfo(m);return d}const BJ={kernelName:$m,backendName:"cpu",kernelFunc:MJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zJ=Ft(Nd,n=>Math.acos(n)),UJ={kernelName:Nd,backendName:"cpu",kernelFunc:zJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VJ=Ft($d,n=>Math.acosh(n)),WJ={kernelName:$d,backendName:"cpu",kernelFunc:VJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GJ(n){const{inputs:e,backend:t}=n,r=e;qe(e,"addN");const s=r.map(a=>t.data.get(a.dataId).values),i=pt(r[0].shape,r[0].dtype),o=i.values;for(let a=0;a<r.length;a++){const l=s[a];for(let u=0;u<o.length;u++)o[u]+=l[u]}return t.makeTensorInfo(i.shape,i.dtype,i.values)}const jJ={kernelName:ib,backendName:"cpu",kernelFunc:GJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HJ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r;qe(s,"all");const a=mt(i,s.shape);let l=a;const u=un(l,s.shape.length);let c=s;u!=null&&(c=zr({inputs:{x:s},backend:t,attrs:{perm:u}}),l=wn(l.length,s.shape.length)),lr("all",l,c.shape.length);const[h,d]=Jn(c.shape,l),f=we(d),p=mr(we(h),c.dtype),v=t.data.get(c.dataId).values;for(let m=0;m<p.length;++m){const y=m*f;let w=v[y];for(let x=0;x<f;++x){const b=v[y+x];w=w&&b}p[m]=w}u!=null&&t.disposeIntermediateTensorInfo(c);const g=t.makeTensorInfo(h,c.dtype,p);if(o){const m=Rn(h,a),y=Kt({inputs:{x:g},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(g),y}return g}const qJ={kernelName:ob,backendName:"cpu",kernelFunc:HJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KJ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r;qe(s,"any");const a=mt(i,s.shape);let l=a;const u=un(l,s.shape.length);let c=s;u!=null&&(c=zr({inputs:{x:s},backend:t,attrs:{perm:u}}),l=wn(l.length,s.shape.length)),lr("any",l,c.shape.length);const[h,d]=Jn(c.shape,l),f=we(d),p=mr(we(h),c.dtype),v=t.data.get(c.dataId).values;for(let m=0;m<p.length;++m){const y=m*f;let w=v[y];for(let x=0;x<f;++x){const b=v[y+x];w=w||b}p[m]=w}u!=null&&t.disposeIntermediateTensorInfo(c);const g=t.makeTensorInfo(h,c.dtype,p);if(o){const m=Rn(h,a),y=Kt({inputs:{x:g},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(g),y}return g}const XJ={kernelName:ab,backendName:"cpu",kernelFunc:KJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YJ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;qe(s,"argMax");let o=mt(i,s.shape);const a=un(o,s.shape.length);let l=s;const u=[];a!=null&&(l=zr({inputs:{x:s},backend:t,attrs:{perm:a}}),u.push(l),o=wn(o.length,l.shape.length)),o=[o[0]],lr("argMax",o,l.shape.length);const[c,h]=Jn(l.shape,o),d=we(c),f=mr(d,"int32"),p=we(h),v=t.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const m=g*p;let y=v[m],w=0;for(let x=0;x<p;++x){const b=v[m+x];b>y&&(y=b,w=x)}f[g]=w}return u.forEach(g=>t.disposeIntermediateTensorInfo(g)),t.makeTensorInfo(c,"int32",f)}const ZJ={kernelName:e0,backendName:"cpu",kernelFunc:YJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QJ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;qe(s,"argMin");let o=mt(i,s.shape);const a=un(o,s.shape.length);let l=s;const u=[];a!=null&&(l=zr({inputs:{x:s},backend:t,attrs:{perm:a}}),u.push(l),o=wn(o.length,l.shape.length)),o=[o[0]],lr("argMin",o,l.shape.length);const[c,h]=Jn(l.shape,o),d=we(c),f=mr(d,"int32"),p=we(h),v=t.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const m=g*p;let y=v[m],w=0;for(let x=0;x<p;++x){const b=v[m+x];b<y&&(y=b,w=x)}f[g]=w}return u.forEach(g=>t.disposeIntermediateTensorInfo(g)),t.makeTensorInfo(c,"int32",f)}const JJ={kernelName:t0,backendName:"cpu",kernelFunc:QJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eee=Ft(Dd,n=>Math.asin(n)),tee={kernelName:Dd,backendName:"cpu",kernelFunc:eee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nee=Ft(Ad,n=>Math.asinh(n)),ree={kernelName:Ad,backendName:"cpu",kernelFunc:nee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const see=Ft(Rd,n=>Math.atan(n)),iee={kernelName:Rd,backendName:"cpu",kernelFunc:see};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oee=Cn((n,e)=>Math.atan2(n,e)),aee=jn(Fd,oee),lee={kernelName:Fd,backendName:"cpu",kernelFunc:aee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uee=Ft(Od,n=>Math.atanh(n)),cee={kernelName:Od,backendName:"cpu",kernelFunc:uee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RC(n,e,t,r,s,i){const o=s.strideHeight,a=s.strideWidth,l=s.dilationHeight,u=s.dilationWidth,c=s.effectiveFilterHeight,h=s.effectiveFilterWidth,d=s.padInfo.top,f=s.padInfo.left,p=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=pt(s.outShape,t),g=v.values,m=s.outShape[1]*s.outShape[2]*s.outShape[3],y=s.outShape[2]*s.outShape[3],w=s.outShape[3];for(let x=0;x<s.batchSize;++x){const b=x*m,C=x*r[0];for(let k=0;k<s.inChannels;++k)for(let E=0;E<s.outHeight;++E){const T=E*o-d,_=Math.max(0,T),A=Math.min(s.inHeight,c+T),P=b+E*y;for(let j=0;j<s.outWidth;++j){const X=j*a-f,F=Math.max(0,X),M=Math.min(s.inWidth,h+X);let W=p,D=0,z=0;for(let ie=_;ie<A;ie+=l){const V=C+ie*r[1];for(let Z=F;Z<M;Z+=u){const de=V+Z*r[2],ge=n[de+k];i==="max"&&ge>W?W=ge:i==="avg"&&(D+=ge,z++)}if(isNaN(W))break}const K=P+j*w+k;g[K]=i==="avg"?D/z:W}}}return v}function tL(n,e,t,r,s=!1,i=!1){const o=pt(r.outShape,"int32"),a=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterHeight,d=r.effectiveFilterWidth,f=r.padInfo.top,p=r.padInfo.left,v=pt(e,t,n);for(let g=0;g<r.batchSize;++g)for(let m=0;m<r.inChannels;++m)for(let y=0;y<r.outHeight;++y){const w=y*a-f;let x=w;for(;x<0;)x+=u;const b=Math.min(r.inHeight,h+w);for(let C=0;C<r.outWidth;++C){const k=C*l-p;let E=k;for(;E<0;)E+=c;const T=Math.min(r.inWidth,d+k);let _=Number.NEGATIVE_INFINITY,A=-1;for(let P=x;P<b;P+=u){const j=P-w;for(let X=E;X<T;X+=c){const F=X-k,M=v.get(g,P,X,m);M>_&&(_=M,s?A=i?((g*r.inHeight+P)*r.inWidth+X)*r.inChannels+m:(P*r.inWidth+X)*r.inChannels+m:A=j*d+F)}}o.set(A,g,y,C,m)}}return o}function nL(n,e,t,r,s,i){const o=s.strideDepth,a=s.strideHeight,l=s.strideWidth,u=s.dilationDepth,c=s.dilationHeight,h=s.dilationWidth,d=s.effectiveFilterDepth,f=s.effectiveFilterHeight,p=s.effectiveFilterWidth,v=s.padInfo.front,g=s.padInfo.top,m=s.padInfo.left,y=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=pt(s.outShape,t),x=w.values,b=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],C=s.outShape[2]*s.outShape[3]*s.outShape[4],k=s.outShape[3]*s.outShape[4],E=s.outShape[4];for(let T=0;T<s.batchSize;++T){const _=T*b,A=T*r[0];for(let P=0;P<s.inChannels;++P)for(let j=0;j<s.outDepth;++j){const X=j*o-v;let F=X;for(;F<0;)F+=u;const M=Math.min(s.inDepth,d+X),W=_+j*C;for(let D=0;D<s.outHeight;++D){const z=D*a-g;let K=z;for(;K<0;)K+=c;const ie=Math.min(s.inHeight,f+z),V=W+D*k;for(let Z=0;Z<s.outWidth;++Z){const de=Z*l-m;let ge=de;for(;ge<0;)ge+=h;const ye=Math.min(s.inWidth,p+de),G=V+Z*E;let J=y,fe=0,ve=0;for(let $e=F;$e<M;$e+=u){const Pe=A+$e*r[1];for(let Ge=K;Ge<ie;Ge+=c){const Xe=Pe+Ge*r[2];for(let Je=ge;Je<ye;Je+=h){const Ze=Xe+Je*r[3],it=n[Ze+P];if(i==="max"&&it>J?J=it:i==="avg"&&(fe+=it,ve++),isNaN(J))break}if(isNaN(J))break}if(isNaN(J))break}const be=G+P;x[be]=i==="avg"?fe/Math.max(ve,1):J}}}}return w}function hee(n,e){const t=pt(e.outShape,"int32"),r=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let v=0;v<e.batchSize;++v)for(let g=0;g<e.inChannels;++g)for(let m=0;m<e.outDepth;++m){const y=m*r-d;let w=y;for(;w<0;)w+=o;const x=Math.min(e.inDepth,u+y);for(let b=0;b<e.outHeight;++b){const C=b*s-f;let k=C;for(;k<0;)k+=a;const E=Math.min(e.inHeight,c+C);for(let T=0;T<e.outWidth;++T){const _=T*i-p;let A=_;for(;A<0;)A+=l;const P=Math.min(e.inWidth,h+_);let j=Number.NEGATIVE_INFINITY,X=-1;for(let F=w;F<x;F+=o){const M=F-y;for(let W=k;W<E;W+=a){const D=W-C;for(let z=A;z<P;z+=l){const K=z-_,ie=n.get(v,F,W,z,g);ie>=j&&(j=ie,X=M*c*h+D*c+K)}}}t.set(X,v,m,b,T,g)}}}return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dee(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;qe(s,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;O(gr(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ks(s.shape,i,o,u,a,l);let h;if(c.filterWidth===1&&c.filterHeight===1&&Nt(c.inShape,c.outShape))h=Yi({inputs:{x:s},backend:t});else{const d=t.data.get(s.dataId).values,f=Qe(s.shape),p=RC(d,s.shape,s.dtype,f,c,"avg");h=t.makeTensorInfo(c.outShape,s.dtype,p.values)}return h}const fee={kernelName:n0,backendName:"cpu",kernelFunc:dee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pee(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r;qe(s,"avgPool3d");const c=To(s.shape,i,o,1,a,l,u),h=t.data.get(s.dataId).values,d=nL(h,s.shape,s.dtype,Qe(s.shape),c,"avg");return t.makeTensorInfo(d.shape,"float32",d.values)}const mee={kernelName:r0,backendName:"cpu",kernelFunc:pee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gee(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:u}=r;qe([s,i],"avgPool3DGrad");const c=To(i.shape,o,a,1,l,u),h=c.strideDepth,d=c.strideHeight,f=c.strideWidth,p=c.filterDepth,v=c.filterHeight,g=c.filterWidth,m=c.dilationDepth,y=c.dilationHeight,w=c.dilationWidth,x=c.effectiveFilterDepth,b=c.effectiveFilterHeight,C=c.effectiveFilterWidth,k=x-1-c.padInfo.front,E=C-1-c.padInfo.left,T=b-1-c.padInfo.top,_=pt(i.shape,"float32"),A=1/(p*v*g),P=t.bufferSync(s);for(let j=0;j<c.batchSize;++j)for(let X=0;X<c.inChannels;++X)for(let F=0;F<c.inDepth;++F)for(let M=0;M<c.inHeight;++M)for(let W=0;W<c.inWidth;++W){const D=F-k,z=M-T,K=W-E;let ie=0;for(let V=0;V<x;V+=m){const Z=(D+V)/h;if(!(Z<0||Z>=c.outDepth||Math.floor(Z)!==Z))for(let de=0;de<b;de+=y){const ge=(z+de)/d;if(!(ge<0||ge>=c.outHeight||Math.floor(ge)!==ge))for(let ye=0;ye<C;ye+=w){const G=(K+ye)/f;if(G<0||G>=c.outWidth||Math.floor(G)!==G)continue;const J=P.get(j,Z,ge,G,X);ie+=J}}}_.set(ie*A,j,F,M,W,X)}return t.makeTensorInfo(_.shape,_.dtype,_.values)}const vee={kernelName:ub,backendName:"cpu",kernelFunc:gee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yee(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,o=i;qe([s,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=Ks(o.shape,a,l,1,u),h=c.strideHeight,d=c.strideWidth,f=c.filterHeight,p=c.filterWidth,v=c.dilationHeight,g=c.dilationWidth,m=c.effectiveFilterHeight,y=c.effectiveFilterWidth,w=y-1-c.padInfo.left,x=m-1-c.padInfo.top,b=pt(o.shape,"float32"),C=1/(f*p),k=t.data.get(s.dataId).values,E=pt(s.shape,"float32",k);for(let T=0;T<c.batchSize;++T)for(let _=0;_<c.inChannels;++_)for(let A=0;A<c.inHeight;++A)for(let P=0;P<c.inWidth;++P){const j=A-x,X=P-w;let F=0;for(let M=0;M<m;M+=v){const W=(j+M)/h;if(!(W<0||W>=c.outHeight||Math.floor(W)!==W))for(let D=0;D<y;D+=g){const z=(X+D)/d;if(z<0||z>=c.outWidth||Math.floor(z)!==z)continue;const K=E.get(T,W,z,_);F+=K}}b.set(F*C,T,A,P,_)}return t.makeTensorInfo(b.shape,b.dtype,b.values)}const xee={kernelName:lb,backendName:"cpu",kernelFunc:yee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wee(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,scale:i,offset:o,mean:a,variance:l}=e;O(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),O(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),O(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),qe([s,a,l,i,o],"batchNorm");let{varianceEpsilon:u}=r;u==null&&(u=.001);const c=t.data.get(s.dataId).values,h=t.data.get(a.dataId).values,d=t.data.get(l.dataId).values,f=i?t.data.get(i.dataId).values:new Float32Array([1]),p=o?t.data.get(o.dataId).values:new Float32Array([0]),v=new Float32Array(c.length),g=p.length,m=f.length,y=d.length,w=h.length;let x=0,b=0,C=0,k=0;for(let E=0;E<c.length;++E)v[E]=p[x++]+(c[E]-h[b++])*f[C++]/Math.sqrt(d[k++]+u),x>=g&&(x=0),b>=w&&(b=0),C>=m&&(C=0),k>=y&&(k=0);return t.makeTensorInfo(s.shape,s.dtype,v)}const bee={kernelName:g0,backendName:"cpu",kernelFunc:wee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cee(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,crops:o}=r;qe([s],"batchToSpaceND");const a=i.reduce((m,y)=>m*y),l=$f(s.shape,i,a),u=Df(l.length,i.length),c=Af(s.shape,i,a),h=W2(o,i.length),d=G2(c,o,i.length),f=Kt({inputs:{x:s},backend:t,attrs:{shape:l}}),p=zr({inputs:{x:f},backend:t,attrs:{perm:u}}),v=Kt({inputs:{x:p},backend:t,attrs:{shape:c}}),g=Cl({inputs:{x:v},backend:t,attrs:{begin:h,size:d}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(v),g}const See={kernelName:i0,backendName:"cpu",kernelFunc:Cee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kee(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:o}=r,a=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,u=_C(a,l,i.dtype,i.shape,o);return t.makeTensorInfo([o],i.dtype,u)}const Eee={kernelName:cb,backendName:"cpu",kernelFunc:kee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iee(n){const{inputs:e,backend:t}=n,{s0:r,s1:s}=e,i=t.data.get(r.dataId).values,o=t.data.get(s.dataId).values,a=ut(Array.from(i),Array.from(o));return t.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Tee={kernelName:TD,backendName:"cpu",kernelFunc:Iee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ee=Ft(Md,(n,e)=>{const t=e;return n>t.clipValueMax?t.clipValueMax:n<t.clipValueMin?t.clipValueMin:n}),Nee={kernelName:Md,backendName:"cpu",kernelFunc:_ee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ee=n=>{const{x:e}=n.inputs,t=n.backend,r=new Float32Array(we(e.shape)),s=t.data.get(e.dataId),i=s.complexTensorInfos.real,o=s.complexTensorInfos.imag,a=t.data.get(i.dataId).values,l=t.data.get(o.dataId).values;for(let u=0;u<a.length;u++){const c=a[u],h=l[u];r[u]=Math.hypot(c,h)}return t.makeOutput(r,e.shape,"float32")},Dee={kernelName:o0,backendName:"cpu",kernelFunc:$ee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ju(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.data.get(r.dataId).complexTensorInfos.imag,i=t.data.get(s.dataId).values;return t.makeTensorInfo(s.shape,s.dtype,i)}const Aee={kernelName:_b,backendName:"cpu",kernelFunc:Ju};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ec(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r,i=mt(s,e[0].shape)[0],o=e.map(v=>v.shape);z2(o,i);let a=Gi(e.map(v=>v.shape),i);if(we(a)===0)return t.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(v=>we(v.shape)>0);if(l.length===1)return Yi({inputs:{x:l[0]},backend:t});if(l[0].dtype==="complex64"){const v=l.map(x=>bl({inputs:{input:x},backend:t})),g=l.map(x=>Ju({inputs:{input:x},backend:t})),m=ec({inputs:v,backend:t,attrs:{axis:i}}),y=ec({inputs:g,backend:t,attrs:{axis:i}}),w=Xr({inputs:{real:m,imag:y},backend:t});return v.forEach(x=>t.disposeIntermediateTensorInfo(x)),g.forEach(x=>t.disposeIntermediateTensorInfo(x)),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(y),w}const u=l.map(v=>{const m=[-1,we(v.shape.slice(i))];return Kt({inputs:{x:v},backend:t,attrs:{shape:m}})}),c=u.map(v=>({vals:t.data.get(v.dataId).values,shape:v.shape}));a=Gi(u.map(v=>v.shape),1);const h=u[0].shape[0]===1,d=a3(c,a,e[0].dtype,h),f=Gi(l.map(v=>v.shape),i),p=t.makeTensorInfo(f,e[0].dtype,d);return u.forEach(v=>t.disposeIntermediateTensorInfo(v)),p}const Ree={kernelName:a0,backendName:"cpu",kernelFunc:ec};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rL(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r;qe([s,i],"conv2d");const h=_o(l),d=ar(s.shape,i.shape,o,u,a,c,!1,h),f=d.filterHeight,p=d.filterWidth,v=d.dilationHeight,g=d.dilationWidth,m=d.padInfo.left,y=d.padInfo.top,w=d.dataFormat==="channelsLast",x=new ir(d.outShape,s.dtype),b=Qe(s.shape),C=Qe(i.shape),k=b[0],E=w?b[1]:b[2],T=w?b[2]:1,_=w?1:b[1],A=x.strides[0],P=w?x.strides[1]:x.strides[2],j=w?x.strides[2]:1,X=w?1:x.strides[1],F=t.data.get(s.dataId).values,M=t.data.get(i.dataId).values,W=x.values;for(let D=0;D<d.batchSize;++D){const z=D*k,K=D*A;for(let ie=0;ie<d.outHeight;++ie){const V=K+ie*P,Z=ie*d.strideHeight-y;for(let de=0;de<f;++de){const ge=Z+de*v;if(ge<0||ge>=d.inHeight)continue;const ye=de*C[0],G=z+ge*E;for(let J=0;J<d.outWidth;++J){const fe=V+J*j,ve=J*d.strideWidth-m;for(let be=0;be<p;++be){const $e=ve+be*g;if($e<0||$e>=d.inWidth)continue;const Pe=ye+be*C[1],Ge=G+$e*T;let Xe=Pe;for(let Je=0;Je<d.inChannels;++Je){const Ze=F[Ge+Je*_];for(let it=0;it<d.outChannels;++it)W[fe+it*X]+=Ze*M[Xe+it];Xe+=d.outChannels}}}}}}return t.makeTensorInfo(x.shape,x.dtype,W)}const Oee={kernelName:l0,backendName:"cpu",kernelFunc:rL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fee(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;qe([s,i],"conv2dBackpropFilter");const h=_o(l),d=ar(s.shape,c,o,1,a,u,!1,h),{strideHeight:f,strideWidth:p,filterHeight:v,filterWidth:g}=d,m=d.dataFormat==="channelsLast",y=new ir(d.filterShape,"float32"),w=d.padInfo.left,x=d.padInfo.top,b=t.data.get(s.dataId).values,C=t.data.get(i.dataId).values,k=new ir(s.shape,s.dtype,b),E=new ir(i.shape,i.dtype,C);for(let T=0;T<v;++T){const _=Math.max(0,Math.ceil((x-T)/f)),A=Math.min(d.outHeight,(d.inHeight+x-T)/f);for(let P=0;P<g;++P){const j=Math.max(0,Math.ceil((w-P)/p)),X=Math.min(d.outWidth,(d.inWidth+w-P)/p);for(let F=0;F<d.inChannels;++F)for(let M=0;M<d.outChannels;++M){let W=0;for(let D=0;D<d.batchSize;++D)for(let z=_;z<A;++z){const K=T+z*f-x;for(let ie=j;ie<X;++ie){const V=P+ie*p-w;m?W+=k.get(D,K,V,F)*E.get(D,z,ie,M):W+=k.get(D,F,K,V)*E.get(D,M,z,ie)}}y.set(W,T,P,F,M)}}}return t.makeTensorInfo(y.shape,y.dtype,y.values)}const Lee={kernelName:fb,backendName:"cpu",kernelFunc:Fee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pee(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r;qe([s,i],"conv2dBackpropInput");const h=Qe(i.shape),d=Qe(s.shape);let f=_o(u);const p=ar(o,i.shape,a,1,l,c,!1,f),v=new ir(p.inShape,"float32"),g=v.values,m=t.data.get(s.dataId).values,y=t.data.get(i.dataId).values,[w,x,b]=h,{batchSize:C,filterHeight:k,filterWidth:E,inChannels:T,inHeight:_,inWidth:A,outChannels:P,outHeight:j,outWidth:X,strideHeight:F,strideWidth:M}=p;f=p.dataFormat;const W=k-1-p.padInfo.top,D=E-1-p.padInfo.left,z=f==="channelsLast",K=v.strides[0],ie=z?v.strides[1]:v.strides[2],V=z?v.strides[2]:1,Z=z?1:v.strides[1],de=d[0],ge=z?d[1]:d[2],ye=z?d[2]:1,G=z?1:d[1];for(let J=0;J<C;++J)for(let fe=0;fe<T;++fe)for(let ve=0;ve<_;++ve){const be=ve-W,$e=Math.max(0,Math.ceil(be/F)),Pe=Math.min(j,(k+be)/F);for(let Ge=0;Ge<A;++Ge){const Xe=Ge-D,Je=Math.max(0,Math.ceil(Xe/M)),Ze=Math.min(X,(E+Xe)/M);let it=0;for(let dt=$e;dt<Pe;++dt){const Lt=dt*F-be;for(let lt=Je;lt<Ze;++lt){const tt=lt*M-Xe,Tt=de*J+ge*dt+ye*lt,Sn=w*(k-1-Lt)+x*(E-1-tt)+b*fe;for(let Pt=0;Pt<P;++Pt){const Wt=m[Tt+G*Pt],kn=y[Sn+Pt];it+=Wt*kn}}}const cn=K*J+ie*ve+V*Ge+Z*fe;g[cn]=it}}return t.makeTensorInfo(v.shape,v.dtype,v.values)}const Mee={kernelName:u0,backendName:"cpu",kernelFunc:Pee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bee(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r;qe([s,i],"conv3d");const u=ka(s.shape,i.shape,o,l,a),{filterDepth:c,filterHeight:h,filterWidth:d,dilationDepth:f,dilationHeight:p,dilationWidth:v,padInfo:g}=u,m=g.front,y=g.left,w=g.top,x=new ir(u.outShape,s.dtype),b=t.data.get(s.dataId).values,C=t.data.get(i.dataId).values,k=x.values,E=Qe(s.shape),T=Qe(i.shape);for(let _=0;_<u.batchSize;++_){const A=_*E[0],P=_*x.strides[0];for(let j=0;j<u.outDepth;++j){const X=P+j*x.strides[1],F=j*u.strideDepth-m;for(let M=0;M<c;++M){const W=F+M*f;if(W<0||W>=u.inDepth)continue;const D=M*T[0],z=A+W*E[1];for(let K=0;K<u.outHeight;++K){const ie=X+K*x.strides[2],V=K*u.strideHeight-w;for(let Z=0;Z<h;++Z){const de=V+Z*p;if(de<0||de>=u.inHeight)continue;const ge=D+Z*T[1],ye=z+de*E[2];for(let G=0;G<u.outWidth;++G){const J=ie+G*u.outChannels,fe=G*u.strideWidth-y;for(let ve=0;ve<d;++ve){const be=fe+ve*v;if(be<0||be>=u.inWidth)continue;const $e=ge+ve*T[2],Pe=ye+be*u.inChannels;let Ge=$e;for(let Xe=0;Xe<u.inChannels;++Xe){const Je=b[Pe+Xe];for(let Ze=0;Ze<u.outChannels;++Ze)k[J+Ze]+=Je*C[Ge+Ze];Ge+=u.outChannels}}}}}}}}return t.makeTensorInfo(x.shape,x.dtype,x.values)}const zee={kernelName:c0,backendName:"cpu",kernelFunc:Bee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uee(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:l}=r;qe([s,i],"conv3dBackpropFilterV2");const u=Qe(s.shape),c=Qe(i.shape),h=ka(s.shape,l,o,1,a),d=h.strideDepth,f=h.strideHeight,p=h.strideWidth,v=h.filterDepth,g=h.filterHeight,m=h.filterWidth,y=new ir(h.filterShape,"float32"),w=y.values,[x,b,C,k]=y.strides,E=t.data.get(i.dataId).values,[T,_,A,P]=c,j=t.data.get(s.dataId).values,[X,F,M,W]=u,D=h.padInfo.front,z=h.padInfo.left,K=h.padInfo.top;for(let ie=0;ie<v;++ie){const V=Math.max(0,Math.ceil((D-ie)/d)),Z=Math.min(h.outDepth,(h.inDepth+D-ie)/d),de=ie*x;for(let ge=0;ge<g;++ge){const ye=Math.max(0,Math.ceil((K-ge)/f)),G=Math.min(h.outHeight,(h.inHeight+K-ge)/f),J=ge*b+de;for(let fe=0;fe<m;++fe){const ve=Math.max(0,Math.ceil((z-fe)/p)),be=Math.min(h.outWidth,(h.inWidth+z-fe)/p),$e=fe*C+J;for(let Pe=0;Pe<h.inChannels;++Pe){const Ge=Pe*k+$e;for(let Xe=0;Xe<h.outChannels;++Xe){let Je=0;for(let Ze=0;Ze<h.batchSize;++Ze){const it=Ze*X,cn=Ze*T;for(let dt=V;dt<Z;++dt){const lt=(ie+dt*d-D)*F+it,tt=dt*_+cn;for(let Tt=ye;Tt<G;++Tt){const Pt=(ge+Tt*f-K)*M+lt,Wt=Tt*A+tt;for(let kn=ve;kn<be;++kn){const Fn=(fe+kn*p-z)*W+Pt,yr=kn*P+Wt;Je+=j[Fn+Pe]*E[yr+Xe]}}}}w[Ge+Xe]=Je}}}}}return t.makeTensorInfo(y.shape,y.dtype,y.values)}const Vee={kernelName:pb,backendName:"cpu",kernelFunc:Uee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wee(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{pad:o,strides:a,inputShape:l}=r;qe([s],"conv3dBackpropInputV2");const u=Qe(s.shape),c=Qe(i.shape),h=ka(l,i.shape,a,1,o),d=new ir(h.inShape,"float32"),f=d.values,[p,v,g,m]=d.strides,y=t.data.get(s.dataId).values,[w,x,b,C]=u,k=t.data.get(i.dataId).values,[E,T,_,A]=c,{batchSize:P,filterDepth:j,filterHeight:X,filterWidth:F,inChannels:M,inDepth:W,inHeight:D,inWidth:z,outChannels:K,outDepth:ie,outHeight:V,outWidth:Z,strideDepth:de,strideHeight:ge,strideWidth:ye}=h,G=j-1-h.padInfo.front,J=X-1-h.padInfo.top,fe=F-1-h.padInfo.left;for(let ve=0;ve<P;++ve)for(let be=0;be<M;++be)for(let $e=0;$e<W;++$e){const Pe=$e-G,Ge=Math.max(0,Math.ceil(Pe/de)),Xe=Math.min(ie,(j+Pe)/de);for(let Je=0;Je<D;++Je){const Ze=Je-J,it=Math.max(0,Math.ceil(Ze/ge)),cn=Math.min(V,(X+Ze)/ge);for(let dt=0;dt<z;++dt){const Lt=dt-fe,lt=Math.max(0,Math.ceil(Lt/ye)),tt=Math.min(Z,(F+Lt)/ye);let Tt=0;for(let Sn=Ge;Sn<Xe;++Sn){const Pt=Sn*de-Pe;for(let Wt=it;Wt<cn;++Wt){const kn=Wt*ge-Ze;for(let On=lt;On<tt;++On){const Fn=On*ye-Lt,yr=w*ve+x*Sn+b*Wt+C*On,er=E*(j-1-Pt)+T*(X-1-kn)+_*(F-1-Fn)+A*be;for(let Gt=0;Gt<K;++Gt){const Ln=y[yr+Gt],ks=k[er+Gt];Tt+=Ln*ks}}}}f[p*ve+v*$e+g*Je+m*dt+be]=Tt}}}return t.makeTensorInfo(d.shape,d.dtype,d.values)}const Gee={kernelName:mb,backendName:"cpu",kernelFunc:Wee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jee=Ft(Bd,n=>Math.cos(n)),Hee={kernelName:Bd,backendName:"cpu",kernelFunc:jee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qee=Ft(zd,n=>Math.cosh(n)),Kee={kernelName:zd,backendName:"cpu",kernelFunc:qee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xee(n){const{inputs:e,backend:t,attrs:r}=n,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:u}=r,[c,h,d,f]=s.shape,p=i.shape[0],[v,g]=a,m=pt([p,v,g,f],"float32"),y=t.data.get(i.dataId).values,w=t.data.get(o.dataId).values,x=t.data.get(s.dataId).values,b=Qe(s.shape),C=Qe(m.shape);for(let k=0;k<p;k++){const E=k*4,T=y[E],_=y[E+1],A=y[E+2],P=y[E+3],j=w[k];if(j>=c)continue;const X=v>1?(A-T)*(h-1)/(v-1):0,F=g>1?(P-_)*(d-1)/(g-1):0;for(let M=0;M<v;M++){const W=v>1?T*(h-1)+M*X:.5*(T+A)*(h-1);if(W<0||W>h-1){for(let D=0;D<g;D++)for(let z=0;z<f;z++){const K=z+D*C[2]+M*C[1]+k*C[0];m.values[K]=u}continue}if(l==="bilinear"){const D=Math.floor(W),z=Math.ceil(W),K=W-D;for(let ie=0;ie<g;ie++){const V=g>1?_*(d-1)+ie*F:.5*(_+P)*(d-1);if(V<0||V>d-1){for(let ye=0;ye<f;ye++){const G=ye+ie*C[2]+M*C[1]+k*C[0];m.values[G]=u}continue}const Z=Math.floor(V),de=Math.ceil(V),ge=V-Z;for(let ye=0;ye<f;ye++){let G=ye+Z*b[2]+D*b[1]+j*b[0];const J=x[G];G=ye+de*b[2]+D*b[1]+j*b[0];const fe=x[G];G=ye+Z*b[2]+z*b[1]+j*b[0];const ve=x[G];G=ye+de*b[2]+z*b[1]+j*b[0];const be=x[G],$e=J+(fe-J)*ge,Pe=ve+(be-ve)*ge;G=ye+ie*C[2]+M*C[1]+k*C[0],m.values[G]=$e+(Pe-$e)*K}}}else for(let D=0;D<g;++D){const z=g>1?_*(d-1)+D*F:.5*(_+P)*(d-1);if(z<0||z>d-1){for(let V=0;V<f;V++){const Z=V+D*C[2]+M*C[1]+k*C[0];m.values[Z]=u}continue}const K=Math.round(z),ie=Math.round(W);for(let V=0;V<f;V++){const Z=V+K*b[2]+ie*b[1]+j*b[0],de=V+D*C[2]+M*C[1]+k*C[0];m.values[de]=x[Z]}}}}return t.makeTensorInfo(m.shape,m.dtype,m.values)}const Yee={kernelName:vb,backendName:"cpu",kernelFunc:Xee};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zee(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;qe(s,"cumprod");const l=un([i],s.shape.length);let u=s;l!=null&&(u=zr({inputs:{x:s},backend:t,attrs:{perm:l}}));const c=wn(1,s.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const h=ns(u.dtype,"int32"),d=nb(we(u.shape),h),f=t.data.get(u.dataId).values,p=u.shape[u.shape.length-1],v=a?(m,y)=>m+p-y-1:(m,y)=>m+y;for(let m=0;m<f.length;m+=p)for(let y=0;y<p;y++){const w=v(m,y);if(y===0)d[w]=o?1:f[w];else{const x=v(m,y-1);d[w]=o?f[x]*d[x]:f[w]*d[x]}}const g=t.makeTensorInfo(u.shape,h,d);if(l!=null){const m=Ea(l),y=zr({inputs:{x:g},backend:t,attrs:{perm:m}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(u),y}return g}const Qee={kernelName:gb,backendName:"cpu",kernelFunc:Zee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jee(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;qe(s,"cumsum");const l=un([i],s.shape.length);let u=s;l!=null&&(u=zr({inputs:{x:s},backend:t,attrs:{perm:l}}));const c=wn(1,s.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const h=ns(u.dtype,"int32"),d=mr(we(u.shape),h),f=t.data.get(u.dataId).values,p=u.shape[u.shape.length-1],v=a?(m,y)=>m+p-y-1:(m,y)=>m+y;for(let m=0;m<f.length;m+=p)for(let y=0;y<p;y++){const w=v(m,y);if(y===0)d[w]=o?0:f[w];else{const x=v(m,y-1);d[w]=o?f[x]+d[x]:f[w]+d[x]}}const g=t.makeTensorInfo(u.shape,h,d);if(l!=null){const m=Ea(l),y=zr({inputs:{x:g},backend:t,attrs:{perm:m}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(u),y}return g}const ete={kernelName:h0,backendName:"cpu",kernelFunc:Jee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tte(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r;if(s.shape.length===1){const l=t.data.get(s.dataId).values,u=t.data.get(i.dataId).values,c=_C(l,u,i.dtype,i.shape,o);return t.makeTensorInfo([o],i.dtype,c)}else if(s.shape.length===2){const l=t.bufferSync(s),u=t.bufferSync(i),c=s3(l,u,o,a);return t.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const nte={kernelName:yb,backendName:"cpu",kernelFunc:tte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rte(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockSize:i,dataFormat:o}=r;O(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=s.shape[0],l=s.shape[1],u=s.shape[2],c=s.shape[3],h=l*i,d=u*i,f=c/(i*i),p=t.data.get(s.dataId).values,v=new Float32Array(a*h*d*f);let g=0;for(let m=0;m<a;++m)for(let y=0;y<h;++y){const w=Math.floor(y/i),x=y%i;for(let b=0;b<d;++b){const C=Math.floor(b/i),k=b%i,E=(x*i+k)*f;for(let T=0;T<f;++T){const A=T+E+c*(C+u*(w+l*m));v[g++]=p[A]}}}return t.makeTensorInfo([a,h,d,f],s.dtype,v)}const ste={kernelName:xb,backendName:"cpu",kernelFunc:rte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sL(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:u}=r;qe([s,i],"depthwiseConv2DNative");const c=Qe(s.shape),h=Qe(i.shape);let d=l;d==null&&(d=[1,1]),O(gr(o,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${d}'`);const f=ar(s.shape,i.shape,o,d,a,u,!0),{filterHeight:p,filterWidth:v,dilationHeight:g,dilationWidth:m,padInfo:y}=f,w=y.left,x=y.top,b=f.outChannels/f.inChannels,C=new ir(f.outShape,s.dtype),k=t.data.get(s.dataId).values,E=t.data.get(i.dataId).values,T=C.values;for(let _=0;_<f.batchSize;++_){const A=_*c[0],P=_*C.strides[0];for(let j=0;j<f.outHeight;++j){const X=P+j*C.strides[1],F=j*f.strideHeight-x;for(let M=0;M<p;++M){const W=F+M*g;if(W<0||W>=f.inHeight)continue;const D=M*h[0],z=A+W*c[1];for(let K=0;K<f.outWidth;++K){const ie=X+K*C.strides[2],V=K*f.strideWidth-w;for(let Z=0;Z<v;++Z){const de=V+Z*m;if(de<0||de>=f.inWidth)continue;const ge=D+Z*h[1],ye=z+de*f.inChannels;let G=ie,J=ge;for(let fe=0;fe<f.inChannels;++fe){const ve=k[ye+fe];for(let be=0;be<b;++be)T[G+be]+=ve*E[J+be];G+=b,J+=b}}}}}}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const ite={kernelName:d0,backendName:"cpu",kernelFunc:sL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ote(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r;qe([s,i],"depthwiseConv2dNativeBackpropFilter");const h=ar(s.shape,c,o,a,l,u,!0),{strideHeight:d,strideWidth:f,filterHeight:p,filterWidth:v}=h,g=new ir(h.filterShape,"float32"),m=h.padInfo.left,y=h.padInfo.top,w=h.outChannels/h.inChannels,x=t.data.get(s.dataId).values,b=new ir(s.shape,s.dtype,x),C=t.data.get(i.dataId).values,k=new ir(i.shape,i.dtype,C);for(let E=0;E<p;++E){const T=Math.max(0,Math.ceil((y-E)/d)),_=Math.min(h.outHeight,(h.inHeight+y-E)/d);for(let A=0;A<v;++A){const P=Math.max(0,Math.ceil((m-A)/f)),j=Math.min(h.outWidth,(h.inWidth+m-A)/f);for(let X=0;X<h.outChannels;++X){const F=Math.trunc(X/w),M=X%w;let W=0;for(let D=0;D<h.batchSize;++D)for(let z=T;z<_;++z){const K=E+z*d-y;for(let ie=P;ie<j;++ie){const V=A+ie*f-m;W+=b.get(D,K,V,F)*k.get(D,z,ie,X)}}g.set(W,E,A,F,M)}}}return t.makeTensorInfo(g.shape,g.dtype,g.values)}const ate={kernelName:wb,backendName:"cpu",kernelFunc:ote};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lte(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r;qe([s,i],"depthwiseConv2DNativeBackpropInput");const h=Qe(s.shape),d=Qe(i.shape),f=ar(c,i.shape,o,a,l,u,!0),p=new ir(f.inShape,"float32"),v=p.values,[g,m,y]=p.strides,w=t.data.get(s.dataId).values,[x,b,C]=h,k=t.data.get(i.dataId).values,[E,T,_]=d,{batchSize:A,filterHeight:P,filterWidth:j,inChannels:X,inHeight:F,inWidth:M,outChannels:W,outHeight:D,outWidth:z,strideHeight:K,strideWidth:ie}=f,V=P-1-f.padInfo.top,Z=j-1-f.padInfo.left,de=W/X;for(let ge=0;ge<A;++ge)for(let ye=0;ye<X;++ye)for(let G=0;G<F;++G){const J=G-V,fe=Math.max(0,Math.ceil(J/K)),ve=Math.min(D,(P+J)/K);for(let be=0;be<M;++be){const $e=be-Z,Pe=Math.max(0,Math.ceil($e/ie)),Ge=Math.min(z,(j+$e)/ie);let Xe=0;for(let Je=fe;Je<ve;++Je){const Ze=Je*K-J;for(let it=Pe;it<Ge;++it){const cn=it*ie-$e,dt=x*ge+b*Je+C*it,Lt=E*(P-1-Ze)+T*(j-1-cn)+_*ye;for(let lt=0;lt<de;++lt){const tt=ye*de+lt,Tt=w[dt+tt],Sn=k[Lt+lt];Xe+=Tt*Sn}}}v[g*ge+m*G+y*be+ye]=Xe}}return t.makeTensorInfo(p.shape,p.dtype,p.values)}const ute={kernelName:bb,backendName:"cpu",kernelFunc:lte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cte(n){const{inputs:e,backend:t}=n,{x:r}=e,s=we(r.shape),i=t.data.get(r.dataId).values,o=pt([s,s],r.dtype),a=o.values;for(let u=0;u<i.length;u++)a[u*s+u]=i[u];const l=[...r.shape,...r.shape];return t.makeTensorInfo(l,o.dtype,o.values)}const hte={kernelName:_D,backendName:"cpu",kernelFunc:cte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dte={kernelName:f0,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:r,filter:s}=n,{strides:i,pad:o,dilations:a}=t,l=e,u=l.data.get(r.dataId).values,c=r.shape.length,h=l.data.get(s.dataId).values,d=s.shape.length,{batchSize:f,inHeight:p,inWidth:v,inChannels:g,outHeight:m,outWidth:y,padInfo:w,strideHeight:x,strideWidth:b,filterHeight:C,filterWidth:k,dilationHeight:E,dilationWidth:T,outShape:_}=Ef(r.shape,s.shape,i,o,"NHWC",a),A=we(_),P=_.length,j=vn(r.dtype,A);for(let F=0;F<f;++F)for(let M=0;M<m;++M){const W=M*x-w.top;for(let D=0;D<y;++D){const z=D*b-w.left;for(let K=0;K<g;++K){let ie=Number.MIN_SAFE_INTEGER;for(let Z=0;Z<C;++Z){const de=W+Z*E;if(de>=0&&de<p)for(let ge=0;ge<k;++ge){const ye=z+ge*T;if(ye>=0&&ye<v){const G=Vi([F,de,ye,K],c,Qe(r.shape)),J=Vi([Z,ge,K],d,Qe(s.shape)),fe=u[G]+h[J];fe>ie&&(ie=fe)}}}const V=Vi([F,M,D,K],P,Qe(_));j[V]=ie}}}return{dataId:l.write(Al(j,r.dtype),_,r.dtype),shape:_,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fte={kernelName:Jx,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:r,filter:s,dy:i}=n,{strides:o,pad:a,dilations:l}=t,u=e,c=fi(r.shape,u.data.get(r.dataId).values),h=fi(s.shape,u.data.get(s.dataId).values),{batchSize:d,inHeight:f,inWidth:p,inChannels:v,outHeight:g,outWidth:m,padInfo:y,strideHeight:w,strideWidth:x,filterHeight:b,filterWidth:C,dilationHeight:k,dilationWidth:E,outShape:T}=Ef(r.shape,s.shape,o,a,"NHWC",l);O(i.rank===T.length,()=>`Error in ${Jx}, dy must have the same rank as output ${T.length}, but got ${i.rank}`);const _=fi(T,u.data.get(i.dataId).values),A=kD(s.shape,s.dtype);for(let j=0;j<d;++j)for(let X=0;X<g;++X){const F=X*w-y.top;for(let M=0;M<m;++M){const W=M*x-y.left;for(let D=0;D<v;++D){let z=Number.MIN_SAFE_INTEGER,K=0,ie=0;for(let V=0;V<b;++V){const Z=F+V*k;if(Z>=0&&Z<f)for(let de=0;de<C;++de){const ge=W+de*E;if(ge>=0&&ge<p){const ye=c[j][Z][ge][D]+h[V][de][D];ye>z&&(z=ye,K=V,ie=de)}}}A[K][ie][D]+=_[j][X][M][D]}}}return{dataId:u.write(Al(A,r.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pte={kernelName:Qx,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:r,filter:s,dy:i}=n,{strides:o,pad:a,dilations:l}=t,u=e,c=fi(r.shape,u.data.get(r.dataId).values),h=fi(s.shape,u.data.get(s.dataId).values),{batchSize:d,inHeight:f,inWidth:p,inChannels:v,outHeight:g,outWidth:m,padInfo:y,strideHeight:w,strideWidth:x,filterHeight:b,filterWidth:C,dilationHeight:k,dilationWidth:E,outShape:T}=Ef(r.shape,s.shape,o,a,"NHWC",l);O(i.rank===T.length,()=>`Error in ${Qx}, dy must have the same rank as output ${T.length}, but got ${i.rank}`);const _=fi(T,u.data.get(i.dataId).values),A=kD(r.shape,r.dtype);for(let j=0;j<d;++j)for(let X=0;X<g;++X){const F=X*w-y.top;for(let M=0;M<m;++M){const W=M*x-y.left;for(let D=0;D<v;++D){let z=Number.MIN_SAFE_INTEGER,K=F<0?0:F,ie=W<0?0:W;for(let V=0;V<b;++V){const Z=F+V*k;if(Z>=0&&Z<f)for(let de=0;de<C;++de){const ge=W+de*E;if(ge>=0&&ge<p){const ye=c[j][Z][ge][D]+h[V][de][D];ye>z&&(z=ye,K=Z,ie=ge)}}}A[j][K][ie][D]+=_[j][X][M][D]}}}return{dataId:u.write(Al(A,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mte(n){const{inputs:e,backend:t,attrs:r}=n,{image:s}=e,{canvas:i,options:o}=r,{contextOptions:a,imageOptions:l}=o||{},u=(l==null?void 0:l.alpha)||1,c=(a==null?void 0:a.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const h=i.getContext(c,(a==null?void 0:a.contextAttributes)||{});if(h==null)throw new Error(`Could not get the context with ${c} type.`);const[d,f]=s.shape.slice(0,2),p=s.shape.length===2?1:s.shape[2],v=t.data.get(s.dataId).values,g=s.dtype==="float32"?255:1,m=new Uint8ClampedArray(f*d*4);for(let w=0;w<d*f;++w){const x=[0,0,0,255*u];for(let C=0;C<p;C++){const k=v[w*p+C];if(s.dtype==="float32"){if(k<0||k>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${k}.`)}else if(s.dtype==="int32"&&(k<0||k>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${k}.`);p===1?(x[0]=k*g,x[1]=k*g,x[2]=k*g):x[C]=k*g}const b=w*4;m[b+0]=Math.round(x[0]),m[b+1]=Math.round(x[1]),m[b+2]=Math.round(x[2]),m[b+3]=Math.round(x[3])}i.width=f,i.height=d;const y=new ImageData(m,f,d);return h.putImageData(y,0,0),s}const gte={kernelName:O5,backendName:"cpu",kernelFunc:mte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uf(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r;qe(s,"sum");let a;s.dtype==="bool"?a=ga({inputs:{x:s},backend:t,attrs:{dtype:"int32"}}):a=Yi({inputs:{x:s},backend:t});const l=a.shape.length,u=mt(i,a.shape),c=un(u,l);let h=u,d=a;c!=null&&(d=zr({inputs:{x:a},backend:t,attrs:{perm:c}}),h=wn(h.length,l)),lr("sum",h,d.shape.length);const[f,p]=Jn(d.shape,h),v=ns(d.dtype,"int32");let g=Zm(t,f,v);const m=we(p),y=t.data.get(g.dataId).values,w=t.data.get(d.dataId).values;for(let x=0;x<y.length;++x){const b=x*m;let C=0;for(let k=0;k<m;++k)C+=w[b+k];y[x]=C}if(o){const x=Rn(g.shape,u),b=g;g=Kt({inputs:{x:g},backend:t,attrs:{shape:x}}),t.disposeIntermediateTensorInfo(b)}return t.disposeIntermediateTensorInfo(a),c!=null&&t.disposeIntermediateTensorInfo(d),g}const vte={kernelName:H0,backendName:"cpu",kernelFunc:Uf};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yte(n){const{inputs:e,backend:t,attrs:r}=n,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:l}=Q2(s,i.length);eC(o.length,l,i);const{path:u,steps:c}=tC(a,l),h=c.length;let d=null,f=o.length;const p=[];for(let v=0;v<h;++v){for(const g of c[v]){const{permutationIndices:m,expandDims:y}=J2(f,l[g]);let w;nC(m)?w=i[g]:(w=zr({inputs:{x:i[g]},backend:t,attrs:{perm:m}}),p.push(w));const x=w.shape.slice();for(let b=0;b<y.length;++b)x.splice(y[b],0,1);Nt(w.shape,x)||(w=Kt({inputs:{x:w},backend:t,attrs:{shape:x}}),p.push(w)),d===null?d=w:(d=Cv({inputs:{a:w,b:d},backend:t}),p.push(d))}v<h-1&&(u[v]>=0&&(d=Uf({inputs:{x:d},backend:t,attrs:{axis:u[v]-(o.length-f),keepDims:!1}}),p.push(d)),f--)}for(const v of p)v!==d&&t.disposeIntermediateTensorInfo(v);return d}const xte={kernelName:Cb,backendName:"cpu",kernelFunc:yte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wte(n){const{inputs:e,backend:t}=n,{dy:r,y:s}=e;qe([r,s],"eluGrad");const i=new Float32Array(we(s.shape)),o=t.data.get(s.dataId).values,a=t.data.get(r.dataId).values;for(let l=0;l<o.length;++l){const u=o[l];u>=0?i[l]=a[l]:i[l]=a[l]*(u+1)}return t.makeTensorInfo(s.shape,"float32",i)}const bte={kernelName:Sb,backendName:"cpu",kernelFunc:wte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cte=j2,Ste=H2,kte=q2,Ete=K2,Ite=X2,Tte=Y2,_te=Ft(Wd,n=>{const e=Math.sign(n),t=Math.abs(n),r=1/(1+Cte*t);return e*(1-((((Tte*r+Ite)*r+Ete)*r+kte)*r+Ste)*r*Math.exp(-t*t))}),Nte={kernelName:Wd,backendName:"cpu",kernelFunc:_te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eg(n){const{inputs:e,backend:t,attrs:r}=n,{input:s}=e,{dim:i}=r,o=s.shape.length,a=s.shape.slice();let l=i;return i<0&&(O(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),Kt({inputs:{x:s},backend:t,attrs:{shape:a}})}const $te={kernelName:m0,backendName:"cpu",kernelFunc:eg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dte=Cn((n,e)=>n/e),OC=jn(Ud,Dte),I1={kernelName:Ud,backendName:"cpu",kernelFunc:OC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iL(n,e,t){const r=n.shape,s=r[0],i=r[1],o=t.data.get(n.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,u=[s,i],c=we(u),h=pr("float32",c),d=pr("float32",c);for(let g=0;g<s;g++){const m=Cl({inputs:{x:a},backend:t,attrs:{begin:[g,0],size:[1,i]}}),y=Cl({inputs:{x:l},backend:t,attrs:{begin:[g,0],size:[1,i]}}),w=Xr({inputs:{real:m,imag:y},backend:t}),{real:x,imag:b}=Ate(w,e,t),C=bo(x,b);for(let k=0;k<i;k++){const E=Z2(C,k);h[g*i+k]=E.real,d[g*i+k]=E.imag}t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(w)}const f=t.makeTensorInfo(u,"float32",h),p=t.makeTensorInfo(u,"float32",d),v=Xr({inputs:{real:f,imag:p},backend:t});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),v}function Ate(n,e,t){const r=we(n.shape),s=t.data.get(n.dataId),i=t.data.get(s.complexTensorInfos.real.dataId).values,o=t.data.get(s.complexTensorInfos.imag.dataId).values;if(Rte(r)){const a=T1(i,o,r,e,t),l=[n.shape[0],n.shape[1]];if(e){const u=t.makeTensorInfo(l,"float32",a.real),c=t.makeTensorInfo(l,"float32",a.imag),h=t.makeTensorInfo([],"float32",Ca(r,"float32")),d=Yi({inputs:{x:h},backend:t}),f=I1.kernelFunc({inputs:{a:u,b:h},backend:t}),p=I1.kernelFunc({inputs:{a:c,b:d},backend:t}),v=t.data.get(f.dataId).values,g=t.data.get(p.dataId).values;return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),{real:v,imag:g}}return a}else{const a=bo(i,o),l=Ote(a,r,e);return wR(l)}}function Rte(n){return(n&n-1)===0}function T1(n,e,t,r,s){if(t===1)return{real:n,imag:e};const i=bo(n,e),o=t/2,a=bR(i),l=a.real,u=a.imag,c=[l.length],h=s.makeTensorInfo(c,"float32",l),d=s.makeTensorInfo(c,"float32",u),f=Xr({inputs:{real:h,imag:d},backend:s}),p=CR(i),v=p.real,g=p.imag,m=[v.length],y=s.makeTensorInfo(m,"float32",v),w=s.makeTensorInfo(m,"float32",g),x=Xr({inputs:{real:y,imag:w},backend:s}),b=T1(l,u,o,r,s),C=b.real,k=b.imag,E=[C.length],T=s.makeTensorInfo(E,"float32",C),_=s.makeTensorInfo(E,"float32",k),A=Xr({inputs:{real:T,imag:_},backend:s}),P=T1(v,g,o,r,s),j=P.real,X=P.imag,F=[j.length],M=s.makeTensorInfo(F,"float32",j),W=s.makeTensorInfo(F,"float32",X),D=Xr({inputs:{real:M,imag:W},backend:s}),z=kR(t,r),K=[z.real.length],ie=s.makeTensorInfo(K,"float32",z.real),V=s.makeTensorInfo(K,"float32",z.imag),Z=Xr({inputs:{real:ie,imag:V},backend:s}),de=Cv({inputs:{a:Z,b:D},backend:s}),ge=Qu({inputs:{a:A,b:de},backend:s}),ye=AC({inputs:{a:A,b:de},backend:s}),G=bl({inputs:{input:ge},backend:s}),J=bl({inputs:{input:ye},backend:s}),fe=Ju({inputs:{input:ge},backend:s}),ve=Ju({inputs:{input:ye},backend:s}),be=ec({inputs:[G,J],backend:s,attrs:{axis:0}}),$e=ec({inputs:[fe,ve],backend:s,attrs:{axis:0}}),Pe=s.data.get(be.dataId).values,Ge=s.data.get($e.dataId).values;return s.disposeIntermediateTensorInfo(h),s.disposeIntermediateTensorInfo(d),s.disposeIntermediateTensorInfo(f),s.disposeIntermediateTensorInfo(y),s.disposeIntermediateTensorInfo(w),s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(T),s.disposeIntermediateTensorInfo(_),s.disposeIntermediateTensorInfo(A),s.disposeIntermediateTensorInfo(M),s.disposeIntermediateTensorInfo(W),s.disposeIntermediateTensorInfo(D),s.disposeIntermediateTensorInfo(ie),s.disposeIntermediateTensorInfo(V),s.disposeIntermediateTensorInfo(Z),s.disposeIntermediateTensorInfo(de),s.disposeIntermediateTensorInfo(ge),s.disposeIntermediateTensorInfo(ye),s.disposeIntermediateTensorInfo(G),s.disposeIntermediateTensorInfo(fe),s.disposeIntermediateTensorInfo(J),s.disposeIntermediateTensorInfo(ve),s.disposeIntermediateTensorInfo(be),s.disposeIntermediateTensorInfo($e),{real:Pe,imag:Ge}}function Ote(n,e,t){const r=new Float32Array(e*2);for(let s=0;s<e;s++){let i=0,o=0;for(let a=0;a<e;a++){const l=ER(s*a,e,t),u=Z2(n,a);i+=u.real*l.real-u.imag*l.imag,o+=u.real*l.imag+u.imag*l.real}t&&(i/=e,o/=e),SR(r,i,o,s)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fte(n){const{inputs:e,backend:t}=n,{input:r}=e,s=we(r.shape),i=r.shape[r.shape.length-1],o=s/i,a=Kt({inputs:{x:r},backend:t,attrs:{shape:[o,i]}}),l=iL(a,!1,t),u=Kt({inputs:{x:l},backend:t,attrs:{shape:r.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(l),u}const Lte={kernelName:kb,backendName:"cpu",kernelFunc:Fte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FC(n){const{backend:e,attrs:t}=n,{shape:r,value:s,dtype:i}=t,o=i||dc(s),a=vn(o,we(r));return Mte(a,s,o),e.makeTensorInfo(r,o,a)}const Pte={kernelName:Eb,backendName:"cpu",kernelFunc:FC};function Mte(n,e,t){n.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bte={kernelName:Ib,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,s=t,i=pr(r.dtype,we(r.shape)),[o,a,l,u]=r.shape,c=s.data.get(r.dataId).values;for(let d=0;d<o;d++){const f=d*l*a*u;for(let p=0;p<a;p++){const v=p*(l*u);for(let g=0;g<l;g++){const m=g*u;for(let y=0;y<u;y++){const w=Math.round(l-g-1),x=f+v+m+y;let b=c[x];if(w>=0&&w<l){const C=w*u,k=f+v+C+y;b=c[k]}i[x]=b}}}}return{dataId:s.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zte(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r;let v=rL({inputs:{x:s,filter:i},backend:t,attrs:{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d}});if(o){const g=v;if(c==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const m=Kt({inputs:{x:o},backend:t,attrs:{shape:[o.shape[0],1,1]}});v=Qu({inputs:{a:v,b:m},backend:t}),t.disposeIntermediateTensorInfo(m)}else v=Qu({inputs:{a:v,b:o},backend:t});t.disposeIntermediateTensorInfo(g)}if(f){const g=v;if(c==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const m=Kt({inputs:{x:a},backend:t,attrs:{shape:[a.shape[0],1,1]}});v=Jm(t,v,f,m,p),t.disposeIntermediateTensorInfo(m)}else v=Jm(t,v,f,a,p);t.disposeIntermediateTensorInfo(g)}return v}const Ute={kernelName:Dm,backendName:"cpu",kernelFunc:zte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vte(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r;let v=sL({inputs:{x:s,filter:i},backend:t,attrs:{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d}});if(o){const g=v;v=Qu({inputs:{a:v,b:o},backend:t}),t.disposeIntermediateTensorInfo(g)}if(f){const g=v;v=Jm(t,v,f,a,p),t.disposeIntermediateTensorInfo(g)}return v}const Wte={kernelName:qD,backendName:"cpu",kernelFunc:Vte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gte(n){const{inputs:e,backend:t}=n,{params:r,indices:s}=e,i=we(r.shape),o=s.shape,a=o[o.length-1],[l,u,c,h]=O2(r,s);if(u===0)return t.makeTensorInfo(l,r.dtype,[]);const d=t.data.get(s.dataId).values,f=t.bufferSync(r),p=m3(d,f,r.dtype,u,a,c,h,r.shape,i);return t.makeTensorInfo(l,r.dtype,p.values)}const jte={kernelName:ND,backendName:"cpu",kernelFunc:Gte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hte(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,indices:i}=e,{axis:o,batchDims:a}=r;qe([s,i],"gatherV2");const l=mt(o,s.shape)[0],u=t.data.get(i.dataId).values,c=s.shape[l];for(let x=0;x<u.length;++x){const b=u[x];O(b<=c-1&&b>=0,()=>`GatherV2: the index value ${b} is not in [0, ${c-1}]`)}let h=a;a==null&&(h=0);const d=we(i.shape),f=sC(s,i,l,h),p=Kt({inputs:{x:s},backend:t,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),v=Kt({inputs:{x:i},backend:t,attrs:{shape:[f.batchSize,d/f.batchSize]}}),g=[f.batchSize,f.outerSize,d/f.batchSize,f.sliceSize],m=t.bufferSync(v),y=t.bufferSync(p),w=g3(y,m,g);return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(v),t.makeTensorInfo(f.outputShape,w.dtype,w.values)}const qte={kernelName:v0,backendName:"cpu",kernelFunc:Hte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kte(n){const{inputs:e,backend:t}=n,{input:r}=e,s=we(r.shape),i=r.shape[r.shape.length-1],o=s/i,a=Kt({inputs:{x:r},backend:t,attrs:{shape:[o,i]}}),l=iL(a,!0,t),u=Kt({inputs:{x:l},backend:t,attrs:{shape:r.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(l),u}const Xte={kernelName:Tb,backendName:"cpu",kernelFunc:Kte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yte=Ft(Yd,n=>Number.isFinite(n)?1:0,"bool"),Zte={kernelName:Yd,backendName:"cpu",kernelFunc:Yte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qte=Ft(Zd,n=>Math.abs(n)===1/0?1:0,"bool"),Jte={kernelName:Zd,backendName:"cpu",kernelFunc:Qte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ene=Ft(Qd,n=>Number.isNaN(n)?1:0,"bool"),tne={kernelName:Qd,backendName:"cpu",kernelFunc:ene};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nne(n){const{backend:e,attrs:t}=n,{start:r,stop:s,num:i}=t,o=b3(r,s,i);return e.makeTensorInfo([o.length],"float32",o)}const rne={kernelName:$D,backendName:"cpu",kernelFunc:nne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sne=Ft(ef,n=>Math.log1p(n)),ine={kernelName:ef,backendName:"cpu",kernelFunc:sne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const one=Cn((n,e)=>n&&e),ane=jn(C0,one,null,"bool"),lne={kernelName:C0,backendName:"cpu",kernelFunc:ane};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const une=Ft(S0,n=>n?0:1,"bool"),cne={kernelName:S0,backendName:"cpu",kernelFunc:une};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hne=Cn((n,e)=>n||e),dne=jn(k0,hne,null,"bool"),fne={kernelName:k0,backendName:"cpu",kernelFunc:dne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pne(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=r;qe(s,"LRN");const u=s.shape[3],c=u-1,h=t.data.get(s.dataId).values,d=we(s.shape),f=new Float32Array(d);function p(v){const g=v%u;let m=v-g+Math.max(0,g-i);const y=v-g+Math.min(g+i,c);let w=0;for(;m<=y;m++){const x=h[m];w+=x*x}return w}for(let v=0;v<d;v++){const g=p(v),m=h[v]*Math.pow(o+a*g,-l);f[v]=m}return t.makeTensorInfo(s.shape,s.dtype,f)}const mne={kernelName:E0,backendName:"cpu",kernelFunc:pne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gne(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r;qe(o,"LRNGrad");const h=we(o.shape),d=o.shape[3],f=t.data.get(o.dataId).values,p=t.data.get(s.dataId).values,v=t.data.get(i.dataId).values,g=new Float32Array(h),m=h;for(let y=0;y<m;y++){const w=y%d,x=y-w+Math.max(0,w-a),b=y-w+Math.min(d,w+a+1);let C=0;for(let k=x;k<b;k++)C+=Math.pow(p[k],2);C=u*C+l;for(let k=x;k<b;k++){let E=-2*u*c*p[k]*v[y]/C;y===k&&(E+=Math.pow(C,-c)),E*=f[y],g[k]+=E}}return t.makeTensorInfo(o.shape,s.dtype,g)}const vne={kernelName:Nb,backendName:"cpu",kernelFunc:gne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oL(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reductionIndices:i,keepDims:o}=r,a=t;let l=s.shape;const u=l.length,c=mt(i,l);let h=c;const d=un(h,u);let f=a.data.get(s.dataId).values;if(d!=null){const x=new Array(u);for(let b=0;b<x.length;b++)x[b]=l[d[b]];f=$C(f,l,s.dtype,d,x),h=wn(h.length,u),l=x}qe(s,"max"),lr("max",h,u);const[p,v]=Jn(l,h),g=we(v),m=S3(f,g,p,s.dtype),y=a.write(m,p,s.dtype);let w=p;return o&&(w=Rn(p,c)),{dataId:y,shape:w,dtype:s.dtype}}const yne={kernelName:I0,backendName:"cpu",kernelFunc:oL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xne(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;qe(s,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;O(gr(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ks(s.shape,i,o,u,a,l);let h;if(c.filterWidth===1&&c.filterHeight===1&&Nt(c.inShape,c.outShape))h=Yi({inputs:{x:s},backend:t});else{const d=t.data.get(s.dataId).values,f=Qe(s.shape),p=RC(d,s.shape,s.dtype,f,c,"max");h=t.makeTensorInfo(c.outShape,s.dtype,p.values)}return h}const wne={kernelName:T0,backendName:"cpu",kernelFunc:xne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bne(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r;qe(s,"maxPool3d");const c=To(s.shape,i,o,1,a,l,u),h=t.data.get(s.dataId).values,d=nL(h,s.shape,s.dtype,Qe(s.shape),c,"max");return t.makeTensorInfo(d.shape,"float32",d.values)}const Cne={kernelName:_0,backendName:"cpu",kernelFunc:bne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sne(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:u}=r;qe([s,i],"maxPool3DGrad");const c=To(i.shape,o,a,1,l,u),h=t.bufferSync(i),d=hee(h,c),f=c.strideDepth,p=c.strideHeight,v=c.strideWidth,g=c.dilationDepth,m=c.dilationHeight,y=c.dilationWidth,w=c.effectiveFilterDepth,x=c.effectiveFilterHeight,b=c.effectiveFilterWidth,C=w-1-c.padInfo.front,k=b-1-c.padInfo.left,E=x-1-c.padInfo.top,T=pt(i.shape,"float32"),_=t.bufferSync(s);for(let A=0;A<c.batchSize;++A)for(let P=0;P<c.inChannels;++P)for(let j=0;j<c.inDepth;++j)for(let X=0;X<c.inHeight;++X)for(let F=0;F<c.inWidth;++F){const M=j-C,W=X-E,D=F-k;let z=0;for(let K=0;K<w;K+=g){const ie=(M+K)/f;if(!(ie<0||ie>=c.outDepth||Math.floor(ie)!==ie))for(let V=0;V<x;V+=m){const Z=(W+V)/p;if(!(Z<0||Z>=c.outHeight||Math.floor(Z)!==Z))for(let de=0;de<b;de+=y){const ge=(D+de)/v;if(ge<0||ge>=c.outWidth||Math.floor(ge)!==ge)continue;const ye=w*x*b-1-d.get(A,ie,Z,ge,P),G=K*x*b+V*b+de,J=ye===G?1:0;if(J===0)continue;const fe=_.get(A,ie,Z,ge,P);z+=fe*J}}}T.set(z,A,j,X,F,P)}return t.makeTensorInfo(T.shape,T.dtype,T.values)}const kne={kernelName:Db,backendName:"cpu",kernelFunc:Sne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ene(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i,output:o}=e,a=i;qe([i,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:h}=r,d=Ks(a.shape,l,u,1,c,h),f=t.data.get(a.dataId).values,p=pt(d.outShape,a.dtype,tL(f,a.shape,a.dtype,d).values),v=d.strideHeight,g=d.strideWidth,m=d.dilationHeight,y=d.dilationWidth,w=d.effectiveFilterHeight,x=d.effectiveFilterWidth,b=x-1-d.padInfo.left,C=w-1-d.padInfo.top,k=pt(a.shape,"float32"),E=t.data.get(s.dataId).values,T=pt(s.shape,"float32",E);for(let _=0;_<d.batchSize;++_)for(let A=0;A<d.inChannels;++A)for(let P=0;P<d.inHeight;++P)for(let j=0;j<d.inWidth;++j){const X=P-C,F=j-b;let M=0;for(let W=0;W<w;W+=m){const D=(X+W)/v;if(!(D<0||D>=d.outHeight||Math.floor(D)!==D))for(let z=0;z<x;z+=y){const K=(F+z)/g;if(K<0||K>=d.outWidth||Math.floor(K)!==K)continue;const ie=w*x-1-p.get(_,D,K,A),V=W*x+z,Z=ie===V?1:0;if(Z===0)continue;const de=T.get(_,D,K,A);M+=de*Z}}k.set(M,_,P,j,A)}return t.makeTensorInfo(k.shape,k.dtype,k.values)}const Ine={kernelName:$b,backendName:"cpu",kernelFunc:Ene};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tne(n,e,t,r,s){const i=Qe(e),o=RC(n,e,t,i,s,"max"),a=tL(n,e,t,s,!0,r);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ne={kernelName:DD,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=e,l=t;qe(r,"MaxPoolWithArgmax");const u=l.data.get(r.dataId).values,c=Ks(r.shape,s,i,[1,1],o),[h,d]=Tne(u,r.shape,r.dtype,a,c),f=l.write(h,c.outShape,r.dtype),p=l.write(d,c.outShape,r.dtype);return[{dataId:f,shape:c.outShape,dtype:r.dtype},{dataId:p,shape:c.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nne(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r,a=mt(i,s.shape),u=Jn(s.shape,a)[1],c=we(u),h=[],d=t.makeTensorInfo([],"float32",new Float32Array([c]));h.push(d);const f=ga({inputs:{x:s},backend:t,attrs:{dtype:"float32"}});h.push(f);const p=OC({inputs:{a:f,b:d},backend:t});h.push(p);const v=Uf({inputs:{x:p},backend:t,attrs:{axis:i,keepDims:o}});return h.forEach(g=>t.disposeIntermediateTensorInfo(g)),v}const $ne={kernelName:N0,backendName:"cpu",kernelFunc:Nne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dne(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r;qe(s,"min");const a=mt(i,s.shape);let l=a;const u=un(l,s.shape.length);let c=s;u!=null&&(c=zr({inputs:{x:s},backend:t,attrs:{perm:u}}),l=wn(l.length,s.shape.length)),lr("min",l,c.shape.length);const[h,d]=Jn(c.shape,l),f=we(d),p=mr(we(h),c.dtype),v=t.data.get(c.dataId).values;for(let m=0;m<p.length;++m){const y=m*f;let w=v[y];for(let x=0;x<f;++x){const b=v[y+x];(Number.isNaN(b)||b<w)&&(w=b)}p[m]=w}u!=null&&t.disposeIntermediateTensorInfo(c);const g=t.makeTensorInfo(h,c.dtype,p);if(o){const m=Rn(h,a),y=Kt({inputs:{x:g},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(g),y}return g}const Ane={kernelName:$0,backendName:"cpu",kernelFunc:Dne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rne(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{paddings:i,mode:o}=r;qe(s,"mirrorPad");const a=i.map((w,x)=>w[0]+s.shape[x]+w[1]),l=i.map(w=>w[0]),u=i.map((w,x)=>w[0]+s.shape[x]),c=o==="reflect"?0:1,h=t.data.get(s.dataId).values,d=s.shape.length,f=Qe(s.shape),p=we(a),v=a.length,g=Qe(a),m=pr(s.dtype,p);for(let w=0;w<p;w++){let x=fc(w,v,g);for(let C=0;C<v;C++)x[C]<l[C]?x[C]=l[C]*2-x[C]-c:x[C]>=u[C]&&(x[C]=(u[C]-1)*2-x[C]+c);x=x.map((C,k)=>C-l[k]);const b=Vi(x,d,f);m[w]=h[b]}return{dataId:t.write(m,a,s.dtype),shape:a,dtype:s.dtype}}const One={kernelName:D0,backendName:"cpu",kernelFunc:Rne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fne=Cn((n,e)=>{const t=n%e;return n<0&&e<0||n>=0&&e>=0?t:(t+e)%e}),Lne=jn(rf,Fne),Pne={kernelName:rf,backendName:"cpu",kernelFunc:Lne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aL(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{dim:i}=r,o=s.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=mt([a],s.shape),u=oL({inputs:{x:s},backend:t,attrs:{reductionIndices:l,keepDims:!1}}),c=Rn(u.shape,l),h=Kt({inputs:{x:u},backend:t,attrs:{shape:c}}),d=AC({inputs:{a:s,b:h},backend:t}),f=h3({inputs:{x:d},backend:t}),p=Uf({inputs:{x:f},backend:t,attrs:{axis:l,keepDims:!1}}),v=Kt({inputs:{x:p},backend:t,attrs:{shape:c}}),g=OC({inputs:{a:f,b:v},backend:t});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(v),g}const Mne={kernelName:X0,backendName:"cpu",kernelFunc:aL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bne(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r;qe(s,"multinomial");const l=a?s:aL({inputs:{logits:s},backend:t,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],h=t.data.get(l.dataId).values,d=[u,i],f=mr(we(d),"int32");for(let p=0;p<u;++p){const v=p*c,g=new Float32Array(c-1);g[0]=h[v];for(let w=1;w<g.length;++w)g[w]=g[w-1]+h[v+w];const m=x2.alea(o.toString()),y=p*i;for(let w=0;w<i;++w){const x=m();f[y+w]=g.length;for(let b=0;b<g.length;b++)if(x<g[b]){f[y+w]=b;break}}}return a||t.disposeIntermediateTensorInfo(l),t.makeTensorInfo(d,"int32",f)}const zne={kernelName:AD,backendName:"cpu",kernelFunc:Bne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Une=_2;function Vne(n){const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r;qe(s,"NonMaxSuppression");const u=t.data.get(s.dataId).values,c=t.data.get(i.dataId).values,{selectedIndices:h}=Une(u,c,o,a,l);return t.makeTensorInfo([h.length],"int32",new Int32Array(h))}const Wne={kernelName:Ab,backendName:"cpu",kernelFunc:Vne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gne=N2;function jne(n){const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r;qe(s,"NonMaxSuppressionPadded");const c=t.data.get(s.dataId).values,h=t.data.get(i.dataId).values,{selectedIndices:d,validOutputs:f}=Gne(c,h,o,a,l,u);return[t.makeTensorInfo([d.length],"int32",new Int32Array(d)),t.makeTensorInfo([],"int32",new Int32Array([f]))]}const Hne={kernelName:Rb,backendName:"cpu",kernelFunc:jne};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qne=$2;function Kne(n){const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r;qe(s,"NonMaxSuppressionWithScore");const c=t.data.get(s.dataId).values,h=t.data.get(i.dataId).values,d=o,f=a,p=l,v=u,{selectedIndices:g,selectedScores:m}=qne(c,h,d,f,p,v);return[t.makeTensorInfo([g.length],"int32",new Int32Array(g)),t.makeTensorInfo([m.length],"float32",new Float32Array(m))]}const Xne={kernelName:Ob,backendName:"cpu",kernelFunc:Kne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yne(n){const{inputs:e,backend:t,attrs:r}=n,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:l}=r;qe(s,"oneHot");const u=we(s.shape),c=new Float32Array(u*o);c.fill(l);const h=t.data.get(s.dataId).values;for(let d=0;d<u;++d)h[d]>=0&&h[d]<o&&(c[d*o+h[d]]=a);return t.makeTensorInfo([...s.shape,o],i,c)}const Zne={kernelName:F0,backendName:"cpu",kernelFunc:Yne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tg(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const s=bl({inputs:{input:r},backend:t}),i=tg({inputs:{x:s},backend:t}),o=Ju({inputs:{input:r},backend:t}),a=tg({inputs:{x:o},backend:t}),l=Xr({inputs:{real:i,imag:a},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),l}else return FC({backend:t,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const Qne={kernelName:Q0,backendName:"cpu",kernelFunc:tg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lL(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const s=bl({inputs:{input:r},backend:t}),i=lL({inputs:{x:s},backend:t}),o=Ju({inputs:{input:r},backend:t}),a=tg({inputs:{x:o},backend:t}),l=Xr({inputs:{real:i,imag:a},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),l}else return FC({backend:t,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const Jne={kernelName:O0,backendName:"cpu",kernelFunc:lL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uL(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r;if(e.length===1)return eg({inputs:{input:e[0]},backend:t,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(c=>{tb(i,c.shape,"All tensors passed to stack must have matching shapes"),O(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const h=eg({inputs:{input:c},backend:t,attrs:{dim:s}});return a.push(h),h}),u=ec({inputs:l,backend:t,attrs:{axis:s}});return a.forEach(c=>t.disposeIntermediateTensorInfo(c)),u}const ere={kernelName:L0,backendName:"cpu",kernelFunc:uL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tre(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{paddings:i,constantValue:o}=r;qe(s,"pad");const a=i.map((y,w)=>y[0]+s.shape[w]+y[1]),l=i.map(y=>y[0]),u=t.data.get(s.dataId).values,c=we(s.shape),h=s.shape.length,d=Qe(s.shape),f=we(a),p=a.length,v=Qe(a),g=pr(s.dtype,f);o!==0&&g.fill(o);for(let y=0;y<c;y++){const x=fc(y,h,d).map((C,k)=>C+l[k]),b=Vi(x,p,v);g[b]=u[y]}return{dataId:t.write(g,a,s.dtype),shape:a,dtype:s.dtype}}const cL={kernelName:P0,backendName:"cpu",kernelFunc:tre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nre=Cn((n,e)=>Math.pow(n,e)),rre=jn(of,nre),sre={kernelName:of,backendName:"cpu",kernelFunc:rre};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ire(n){const{inputs:e,backend:t,attrs:r}=n,{paramsNestedSplits:s,paramsDenseValues:i,indices:o}=e,a=s.map(g=>t.data.get(g.dataId).values),l=s.map(g=>g.shape),u=t.data.get(i.dataId).values,c=t.data.get(o.dataId).values,[h,d,f]=N3(a,l,u,i.shape,i.dtype,c,o.shape),p=h.map(g=>t.makeTensorInfo([g.length],"int32",g)),v=t.makeTensorInfo(f,i.dtype,d);return p.concat([v])}const ore={kernelName:RD,backendName:"cpu",kernelFunc:ire};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function are(n){const{inputs:e,backend:t}=n,{starts:r,limits:s,deltas:i}=e,o=t.data.get(r.dataId).values,a=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,[u,c]=$3(o,r.shape,r.dtype,a,s.shape,l,i.shape),h=t.makeTensorInfo([u.length],"int32",u),d=t.makeTensorInfo([c.length],r.dtype,c);return[h,d]}const lre={kernelName:OD,backendName:"cpu",kernelFunc:are};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ure(n){const{inputs:e,backend:t,attrs:r}=n,{shape:s,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=t.data.get(s.dataId).values,c=t.data.get(i.dataId).values,h=t.data.get(o.dataId).values,d=a.map(g=>t.data.get(g.dataId).values),f=a.map(g=>g.shape),[p,v]=D3(u,s.shape,c,i.shape,i.dtype,h,o.shape,d,f,l);return t.makeTensorInfo(p,i.dtype,v)}const cre={kernelName:FD,backendName:"cpu",kernelFunc:ure};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hre(n){const{backend:e,attrs:t}=n,{start:r,stop:s,dtype:i,step:o}=t,a=A3(r,s,o,i);return e.makeTensorInfo([a.length],i,a)}const dre={kernelName:Fb,backendName:"cpu",kernelFunc:hre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fre=Ft(af,n=>1/n),pre={kernelName:af,backendName:"cpu",kernelFunc:fre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mre(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r;qe(s,"resizeBilinear");const l=Qe(s.shape),[u,c]=a,[h,d,f,p]=s.shape,v=t.data.get(s.dataId).values,g=new Float32Array(we([h,u,c,p])),m=[i&&u>1?d-1:d,i&&c>1?f-1:f],y=[i&&u>1?u-1:u,i&&c>1?c-1:c];let w=0;const x=m[0]/y[0],b=m[1]/y[1];for(let C=0;C<h;C++)for(let k=0;k<u;k++){let E;o?E=x*(k+.5)-.5:E=x*k;const T=Math.max(0,Math.floor(E)),_=E-T,A=Math.min(d-1,Math.ceil(E)),P=C*l[0]+T*l[1],j=C*l[0]+A*l[1];for(let X=0;X<c;X++){let F;o?F=b*(X+.5)-.5:F=b*X;const M=Math.max(0,Math.floor(F)),W=F-M,D=Math.min(f-1,Math.ceil(F)),z=P+M*l[2],K=j+M*l[2],ie=P+D*l[2],V=j+D*l[2];for(let Z=0;Z<p;Z++){const de=v[z+Z],ge=v[K+Z],ye=v[ie+Z],G=v[V+Z],J=de+(ye-de)*W,fe=ge+(G-ge)*W,ve=J+(fe-J)*_;g[w++]=ve}}}return t.makeTensorInfo([h,u,c,p],"float32",g)}const gre={kernelName:V0,backendName:"cpu",kernelFunc:mre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vre(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:o}=r;qe([i,s],"resizeBilinearGrad");const a=Qe(s.shape),[l,u,c,h]=s.shape,[,d,f]=i.shape,p=new Float32Array(l*u*c*h),v=[o&&d>1?u-1:u,o&&f>1?c-1:c],g=[o&&d>1?d-1:d,o&&f>1?f-1:f],m=v[0]/g[0],y=v[1]/g[1],w=t.data.get(i.dataId).values;let x=0;for(let b=0;b<l;b++){const C=b*a[0];for(let k=0;k<d;k++){const E=k*m,T=Math.floor(E),_=Math.min(Math.ceil(E),u-1),A=C+T*a[1],P=C+_*a[1],j=E-T,X=1-j;for(let F=0;F<f;F++){const M=F*y,W=Math.floor(M),D=Math.min(Math.ceil(M),c-1),z=M-W,K=1-z,ie=A+W*a[2],V=A+D*a[2],Z=P+W*a[2],de=P+D*a[2],ge=X*K,ye=X*z,G=j*K,J=j*z;for(let fe=0;fe<h;fe++){const ve=w[x++];p[ie+fe]+=ve*ge,p[V+fe]+=ve*ye,p[Z+fe]+=ve*G,p[de+fe]+=ve*J}}}}return t.makeTensorInfo([l,c,u,h],"float32",p)}const yre={kernelName:Mb,backendName:"cpu",kernelFunc:vre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xre(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r;qe(s,"resizeNearestNeighbor");const l=Qe(s.shape),[u,c]=a,[h,d,f,p]=s.shape,v=t.data.get(s.dataId).values,g=new Float32Array(h*u*c*p),m=[i&&u>1?d-1:d,i&&c>1?f-1:f],y=[i&&u>1?u-1:u,i&&c>1?c-1:c],w=m[0]/y[0],x=m[1]/y[1];let b=0;for(let C=0;C<h;C++){const k=C*l[0];for(let E=0;E<u;E++){const T=o?w*(E+.5):w*E;let _=Math.min(d-1,i?Math.round(T):Math.floor(T));o&&(_=Math.max(0,_));const A=k+_*l[1];for(let P=0;P<c;P++){const j=o?x*(P+.5):x*P;let X=Math.min(f-1,i?Math.round(j):Math.floor(j));o&&(X=Math.max(0,X));const F=A+X*l[2];for(let M=0;M<p;M++){const W=v[F+M];g[b++]=W}}}}return t.makeTensorInfo([h,u,c,p],s.dtype,g)}const wre={kernelName:U0,backendName:"cpu",kernelFunc:xre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bre(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:o}=r;qe([i,s],"resizeNearestNeighborGrad");const a=Qe(s.shape),l=Qe(i.shape),[u,c,h,d]=s.shape,[,f,p]=i.shape,v=new Float32Array(u*c*h*d),g=t.data.get(i.dataId).values,m=[o&&f>1?c-1:c,o&&p>1?h-1:h],y=[o&&f>1?f-1:f,o&&p>1?p-1:p],w=m[0]/y[0],x=m[1]/y[1],b=1/w,C=1/x,k=Math.ceil(b)*2+2,E=Math.ceil(C)*2+2;for(let T=0;T<u;T++){const _=T*a[0];for(let A=0;A<c;A++){const P=_+A*a[1],j=Math.floor(A*b),X=Math.floor(j-k/2);for(let F=0;F<h;F++){const M=P+F*a[2],W=Math.floor(F*C),D=Math.floor(W-E/2);for(let z=0;z<d;z++){let K=0;for(let ie=0;ie<k;ie++){const V=ie+X;if(V<0||V>=f)continue;const Z=_+V*l[1],de=V*w,ge=Math.min(c-1,o?Math.round(de):Math.floor(de));if(A===ge)for(let ye=0;ye<E;ye++){const G=ye+D;if(G<0||G>=p)continue;const J=Z+G*l[2],fe=G*x,ve=Math.min(h-1,o?Math.round(fe):Math.floor(fe));F===ve&&(K+=g[J+z])}}v[M+z]=K}}}}return t.makeTensorInfo(s.shape,s.dtype,v)}const Cre={kernelName:Pb,backendName:"cpu",kernelFunc:bre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sre(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dims:i}=r;qe(s,"reverse");const o=s.shape.length,a=mt(i,s.shape);if(o===0)return Yi({inputs:{x:s},backend:t});const l=new ir(s.shape,s.dtype),u=t.bufferSync(s);for(let c=0;c<l.size;c++){const h=l.indexToLoc(c),d=h.slice();a.forEach(f=>d[f]=s.shape[f]-1-d[f]),l.set(u.get(...d),...h)}return t.makeTensorInfo(l.shape,l.dtype,l.values)}const kre={kernelName:W0,backendName:"cpu",kernelFunc:Sre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ere={kernelName:jb,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,{radians:s,fillValue:i,center:o}=e,a=t,l=pr(r.dtype,we(r.shape)),[u,c,h,d]=r.shape,[f,p]=V2(o,c,h),v=255,g=Math.sin(s),m=Math.cos(s),y=a.data.get(r.dataId).values;for(let x=0;x<u;x++){const b=x*h*c*d;for(let C=0;C<c;C++){const k=C*(h*d);for(let E=0;E<h;E++){const T=E*d;for(let _=0;_<d;_++){const A=[u,C,E,_],P=A[2],j=A[1];let X=(P-f)*m-(j-p)*g,F=(P-f)*g+(j-p)*m;X=Math.round(X+f),F=Math.round(F+p);let M=i;if(typeof i!="number"&&(_===3?M=v:M=i[_]),X>=0&&X<h&&F>=0&&F<c){const D=F*(h*d),z=X*d,K=b+D+z+_;M=y[K]}const W=b+k+T+_;l[W]=M}}}}return{dataId:a.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ire=Ft(cf,n=>{const e=Math.floor(n);return n-e<.5?Math.floor(n):n-e>.5?Math.ceil(n):e%2===0?e:e+1}),Tre={kernelName:cf,backendName:"cpu",kernelFunc:Ire};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _re(n){const{inputs:e,backend:t,attrs:r}=n,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:h}=Pl(i,s,o),d=!0,f=t.bufferSync(s),p=t.bufferSync(i),v=Xa(f,p,o,h,u,l,a,c,0,d);return t.makeTensorInfo(o,v.dtype,v.values)}const Nre={kernelName:LD,backendName:"cpu",kernelFunc:_re};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $re(n,e){let t=0,r=n.length,s=0;for(;t<r;)s=Math.floor((t+r)/2),n[s]<e?t=s+1:r=s;return r}function Dre(n,e){let t=0,r=n.length,s=0;for(;t<r;)s=Math.floor((t+r)/2),n[s]<=e?t=s+1:r=s;return r}function Are(n,e,t,r,s,i){const o=vn("int32",t*s);for(let a=0;a<t;++a){const l=n.slice(a*r,(a+1)*r),u=a*s;for(let c=0;c<s;++c)o[u+c]=i==="left"?$re(l,e[c+u]):Dre(l,e[c+u])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rre(n){const{inputs:e,backend:t,attrs:r}=n,{sortedSequence:s,values:i}=e,{side:o}=r,a=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,u=Are(a,l,s.shape[0],s.shape[1],i.shape[1],o);return t.makeTensorInfo(i.shape,"int32",u)}const Ore={kernelName:MD,backendName:"cpu",kernelFunc:Rre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fre(n){const{inputs:e,backend:t}=n,{condition:r,t:s,e:i}=e;qe([r,s,i],"select");const o=r.shape.length,a=t.data.get(r.dataId).values,l=t.data.get(s.dataId).values,u=t.data.get(i.dataId).values,c=ns(s.dtype,i.dtype),h=mr(we(s.shape),c);let d=0;const f=o===0||o>1||s.shape.length===1?1:we(s.shape.slice(1));for(let p=0;p<a.length;p++)for(let v=0;v<f;v++)a[p]===1?h[d++]=l[p]:h[d++]=u[p];return t.makeTensorInfo(s.shape,c,h)}const Lre={kernelName:G0,backendName:"cpu",kernelFunc:Fre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pre=uv,Mre=cv,Bre=Ft(df,n=>n>=0?Mre*n:Pre*(Math.exp(n)-1)),zre={kernelName:df,backendName:"cpu",kernelFunc:Bre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ure=Ft(mf,n=>n<0?-1:n>0?1:0),Vre={kernelName:mf,backendName:"cpu",kernelFunc:Ure};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wre=Ft(ff,n=>Math.sin(n)),Gre={kernelName:ff,backendName:"cpu",kernelFunc:Wre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jre=Ft(pf,n=>Math.sinh(n)),Hre={kernelName:pf,backendName:"cpu",kernelFunc:jre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qre=11920928955078125e-23,FI=Math.log(qre)+2,Kre=Ft(vf,n=>{const e=n>-FI,t=n<FI,r=Math.exp(n);let s;return t?s=r:e?s=n:s=Math.log(1+r),s}),Xre={kernelName:vf,backendName:"cpu",kernelFunc:Kre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yre(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,paddings:o}=r;qe([s],"spaceToBatchND");const a=we(i),l=[[0,0]];l.push(...o);for(let C=1+i.length;C<s.shape.length;++C)l.push([0,0]);const u=cL.kernelFunc({inputs:{x:s},backend:t,attrs:{paddings:l,constantValue:0}}),c=$f(u.shape,i,a,!1),h=Df(c.length,i.length,!1),d=Af(u.shape,i,a,!1),v=Kt({inputs:{x:u},backend:t,attrs:{shape:c}}),y=zr({inputs:{x:v},backend:t,attrs:{perm:h}}),b=Kt({inputs:{x:y},backend:t,attrs:{shape:d}});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(y),b}const Zre={kernelName:q0,backendName:"cpu",kernelFunc:Yre};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qre(n){const{inputs:e,backend:t}=n,{indices:r,values:s,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=t.data.get(r.dataId).values,l=t.data.get(s.dataId).values,u=t.data.get(i.dataId).values,c=t.data.get(o.dataId).values[0],[h,d,f,p,v]=L3(a,r.shape,r.dtype,l,s.dtype,u,c);return[t.makeTensorInfo(d,r.dtype,h),t.makeTensorInfo([d[0]],s.dtype,f),t.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),t.makeTensorInfo([v.length],r.dtype,new Int32Array(v))]}const Jre={kernelName:BD,backendName:"cpu",kernelFunc:Qre};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ese(n){const{inputs:e,backend:t}=n,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(t.data.get(s.dataId).values),a=t.data.get(r.dataId).values,l=Array.from(t.data.get(i.dataId).values),[u,c,h]=P3(a,r.shape,r.dtype,o,l);return[t.makeTensorInfo(c,r.dtype,u),t.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}const tse={kernelName:zD,backendName:"cpu",kernelFunc:ese};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nse(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=t.data.get(r.dataId).values,a=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,[u,c]=DC(o,r.shape,r.dtype,a,l,!0);return t.makeTensorInfo(c,r.dtype,u)}const rse={kernelName:UD,backendName:"cpu",kernelFunc:nse};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sse(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=t.data.get(r.dataId).values,a=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,[u,c]=DC(o,r.shape,r.dtype,a,l);return t.makeTensorInfo(c,r.dtype,u)}const ise={kernelName:VD,backendName:"cpu",kernelFunc:sse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ose(n){const{inputs:e,backend:t,attrs:r}=n,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:h,outputSize:d}=Pl(i,s,a),f=!1,p=t.bufferSync(s);let v;switch(i.dtype){case"bool":{const g=t.bufferSync(i),m=!!t.data.get(o.dataId).values[0];v=Xa(p,g,a,d,c,u,l,h,m,f);break}case"float32":{const g=t.bufferSync(i),m=t.data.get(o.dataId).values[0];v=Xa(p,g,a,d,c,u,l,h,m,f);break}case"int32":{const g=t.bufferSync(i),m=t.data.get(o.dataId).values[0];v=Xa(p,g,a,d,c,u,l,h,m,f);break}case"string":{const g=t.bufferSync(i),m=ca(t.data.get(o.dataId).values[0]);v=Xa(p,g,a,d,c,u,l,h,m,f);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return t.makeTensorInfo(a,v.dtype,v.values)}const ase={kernelName:WD,backendName:"cpu",kernelFunc:ose};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lse(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=mt(o,s.shape)[0],l=rC(s,i,a),u=new Array(s.shape.length).fill(0),c=s.shape.slice();return l.map(h=>{const d=[...c];d[a]=h;const f=Cl({inputs:{x:s},backend:t,attrs:{begin:u,size:d}});return u[a]+=h,f})}const use={kernelName:K0,backendName:"cpu",kernelFunc:lse};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cse={kernelName:Bb,backendName:"cpu",kernelFunc:({inputs:n,backend:e})=>{const{x:t}=n,r=e;qe(t,"square");const s=r.data.get(t.dataId).values,i=new Float32Array(s.length);for(let a=0;a<s.length;++a){const l=s[a];i[a]=l*l}return{dataId:r.write(i,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hse=Ft(kf,(n,e)=>{const t=e;return isNaN(n)?NaN:n>0?1:t.alpha}),dse={kernelName:kf,backendName:"cpu",kernelFunc:hse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fse(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:h,shrinkAxisMask:d}=r;qe(s,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:v,sliceDim0:g,isSimpleSlice:m,begin:y,end:w,strides:x}=B2(s.shape,i,o,a,l,u,c,h,d);let b;if(v)b=Kt({inputs:{x:s},backend:t,attrs:{shape:p}});else if(g||m){O(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const C=L2(y,w,x),k=Cl({inputs:{x:s},backend:t,attrs:{begin:y,size:C}});b=Kt({inputs:{x:k},backend:t,attrs:{shape:p}}),t.disposeIntermediateTensorInfo(k)}else{const C=t.bufferSync(s),k=z3(f,C,x,y);b=t.makeTensorInfo(p,k.dtype,k.values)}return b}const pse={kernelName:Ub,backendName:"cpu",kernelFunc:fse};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mse(n){const{inputs:e,backend:t,attrs:r}=n,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:h}=e,d=t.data.get(c.dataId).values,f=t.data.get(h.dataId).values,[p,v]=U3(d,f,s,i,o,a,l,u);return[t.makeTensorInfo([p.length],"string",p),t.makeTensorInfo(h.shape,"int32",v)]}const gse={kernelName:GD,backendName:"cpu",kernelFunc:mse};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vse(n){const{inputs:e,backend:t,attrs:r}=n,{skipEmpty:s}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=t.data.get(i.dataId).values,l=t.data.get(o.dataId).values[0],[u,c,h]=V3(a,l,s),d=c.length;return[t.makeTensorInfo([d,2],"int32",u),t.makeTensorInfo([d],"string",c),t.makeTensorInfo([2],"int32",new Int32Array(h))]}const yse={kernelName:jD,backendName:"cpu",kernelFunc:vse};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xse(n){const{inputs:e,backend:t,attrs:r}=n,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=t.data.get(i.dataId).values,a=W3(o,s);return t.makeTensorInfo(i.shape,"int32",a)}const wse={kernelName:HD,backendName:"cpu",kernelFunc:xse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bse=Ft(bf,n=>Math.tan(n)),Cse={kernelName:bf,backendName:"cpu",kernelFunc:bse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sse=Ft(Cf,n=>Math.tanh(n)),kse={kernelName:Cf,backendName:"cpu",kernelFunc:Sse};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ese(n){const{inputs:e,backend:t}=n,{tensor:r,indices:s,updates:i}=e,{sliceRank:o,numUpdates:a,sliceSize:l,strides:u,outputSize:c}=Pl(i,s,r.shape),h=!1,d=t.bufferSync(s),f=t.bufferSync(i),p=t.bufferSync(r),v=Xa(d,f,r.shape,c,l,a,o,u,p,h);return t.makeTensorInfo(r.shape,v.dtype,v.values)}const Ise={kernelName:PD,backendName:"cpu",kernelFunc:Ese};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tse(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reps:i}=r;qe(s,"tile");const o=j3(t.bufferSync(s),i);return t.makeTensorInfo(o.shape,o.dtype,o.values)}const _se={kernelName:Sf,backendName:"cpu",kernelFunc:Tse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nse(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{k:i,sorted:o}=r;qe(s,"topk");const a=t.data.get(s.dataId).values,[l,u]=q3(a,s.shape,s.dtype,i,o);return[t.makeTensorInfo(l.shape,l.dtype,l.values),t.makeTensorInfo(u.shape,u.dtype,u.values)]}const $se={kernelName:Vb,backendName:"cpu",kernelFunc:Nse};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dse(n){const{inputs:e,attrs:t,backend:r}=n,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:u}=t,[c,h,d,f]=s.shape,[p,v]=u??[h,d],g=[c,p,v,f],m=Qe(s.shape),y=m[0],w=m[1],x=m[2],b=Qe(g),C=b[0],k=b[1],E=b[2],T=pr(s.dtype,we(g));T.fill(l);const _=r.data.get(s.dataId).values,A=r.data.get(i.dataId).values;for(let j=0;j<c;++j){const X=i.shape[0]===1?A:A.subarray(j*8,j*8+8);for(let F=0;F<p;++F)for(let M=0;M<v;++M)for(let W=0;W<f;++W){let D;const z=X[6]*M+X[7]*F+1;if(z===0)continue;const K=(X[0]*M+X[1]*F+X[2])/z,ie=(X[3]*M+X[4]*F+X[5])/z,V=LI(K,d,a),Z=LI(ie,h,a);switch(o){case"nearest":D=Pse(_,h,d,y,w,x,j,Z,V,W,l);break;case"bilinear":D=Mse(_,h,d,y,w,x,j,Z,V,W,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const de=j*C+F*k+M*E+W;T[de]=D}return r.makeTensorInfo(g,s.dtype,T)}return{dataId:r.write(T,g,s.dtype),shape:s.shape,dtype:s.dtype}}const Ase={kernelName:Wb,backendName:"cpu",kernelFunc:Dse};function LI(n,e,t){switch(t){case"reflect":return Rse(n,e);case"wrap":return Ose(n,e);case"nearest":return Lse(n,e);case"constant":default:return Fse(n)}}function Rse(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const r=2*e;t<r&&(t=r*Math.trunc(-t/r)+t),t=t<-e?t+r:-t-1}else if(t>e-1)if(e<=1)t=0;else{const r=2*e;t-=r*Math.trunc(t/r),t>=e&&(t=r-t-1)}return cl(0,t,e-1)}function Ose(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const r=e-1;t+=e*(Math.trunc(-t/r)+1)}else if(t>e-1)if(e<=1)t=0;else{const r=e-1;t-=e*Math.trunc(t/r)}return cl(0,t,e-1)}function Fse(n,e){return n}function Lse(n,e){return cl(0,n,e-1)}function lh(n,e,t,r,s,i,o,a,l,u,c){const h=o*r+a*s+l*i+u;return 0<=a&&a<e&&0<=l&&l<t?n[h]:c}function Pse(n,e,t,r,s,i,o,a,l,u,c){const h=Math.round(a),d=Math.round(l);return lh(n,e,t,r,s,i,o,h,d,u,c)}function Mse(n,e,t,r,s,i,o,a,l,u,c){const h=Math.floor(a),d=Math.floor(l),f=h+1,p=d+1,v=(p-l)*lh(n,e,t,r,s,i,o,h,d,u,c)+(l-d)*lh(n,e,t,r,s,i,o,h,p,u,c),g=(p-l)*lh(n,e,t,r,s,i,o,f,d,u,c)+(l-d)*lh(n,e,t,r,s,i,o,f,p,u,c);return(f-a)*v+(a-h)*g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bse(n){const{inputs:e,attrs:t,backend:r}=n,{axis:s}=t,{x:i}=e;qe(i,"unique");const o=r.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:u}=K3(o,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const zse={kernelName:Gb,backendName:"cpu",kernelFunc:Bse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Use(n){const{inputs:e,backend:t,attrs:r}=n,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s.shape.length,a=s.shape[i],l=new Array(o-1);let u=0;for(let f=0;f<o;f++)f!==i&&(l[u++]=s.shape[f]);const c=new Array(o).fill(0),h=s.shape.slice();h[i]=1;const d=new Array(a);for(let f=0;f<d.length;f++){c[i]=f;const p=Cl({inputs:{x:s},backend:t,attrs:{begin:c,size:h}});d[f]=Kt({inputs:{x:p},backend:t,attrs:{shape:l}}),t.disposeIntermediateTensorInfo(p)}return d}const Vse={kernelName:Y0,backendName:"cpu",kernelFunc:Use};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wse(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,segmentIds:i}=e,{numSegments:o}=r;qe(s,"unsortedSegmentSum");const a=s.shape.length,l=i.shape.length,u=[],c=[],h=a-l;let d=i;for(let p=0;p<h;++p){const v=eg({inputs:{input:d},backend:t,attrs:{dim:p+1}});d=v,c.push(v)}for(let p=0;p<o;++p){const v=Ca(p,"int32"),g=t.makeTensorInfo([],"int32",v),m=u3({inputs:{a:g,b:d},backend:t}),y=ga({inputs:{x:m},backend:t,attrs:{dtype:"float32"}}),w=Cv({inputs:{a:y,b:s},backend:t}),x=Uf({inputs:{x:w},backend:t,attrs:{axis:0,keepDims:!1}});u.push(x),c.push(g),c.push(m),c.push(y),c.push(w),c.push(x)}const f=uL({inputs:u,backend:t,attrs:{axis:0}});return c.forEach(p=>t.disposeIntermediateTensorInfo(p)),f}const Gse={kernelName:Z0,backendName:"cpu",kernelFunc:Wse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jse=[BJ,xQ,UJ,WJ,EQ,jJ,qJ,XJ,ZJ,JJ,tee,ree,iee,lee,cee,fee,mee,vee,xee,PJ,bee,See,Eee,TQ,Tee,SQ,NQ,Nee,wQ,Dee,Ree,Oee,Lee,Mee,zee,Vee,Gee,Hee,Kee,Yee,Qee,ete,nte,ste,ite,ate,ute,hte,dte,fte,pte,gte,xte,$J,bte,$Q,Nte,DQ,$te,RQ,Lte,Pte,Bte,FQ,PQ,Ute,Wte,jte,qte,BQ,UQ,bQ,Xte,Aee,Zte,Jte,tne,DJ,WQ,jQ,rne,qQ,ine,lne,cne,fne,mne,vne,yne,XQ,wne,Cne,kne,Ine,_ne,$ne,Ane,ZQ,One,Pne,zne,JQ,tJ,Wne,Hne,Xne,rJ,Zne,Jne,ere,cL,sre,RJ,oJ,ore,lre,cre,dre,CQ,I1,pre,OJ,FJ,LJ,gre,yre,wre,Cre,kre,Ere,Tre,pJ,Nre,Ore,Lre,zre,gJ,Vre,Gre,Hre,vJ,Mne,Xre,Zre,Jre,tse,rse,ise,ase,use,wJ,cse,CJ,kJ,dse,pse,gse,yse,wse,_J,vte,Cse,kse,Ise,_se,$se,Ase,sJ,zse,Vse,Gse,Qne];for(const n of jse)KD(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Va={},Ep={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Hse(n,e){Va[n]=e}function xi(n,e){if(!(n in Va)||e!=null){const r=Kse(n,e);if(r!==null)Va[n]=r;else return console.log("Could not get context for WebGL version",n),null}const t=Va[n];return t==null||t.isContextLost()?(delete Va[n],xi(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Va[n])}function qse(n){if(!me().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Kse(n,e){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e??qse(n);return t.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Va[n]},!1),me().getBool("SOFTWARE_WEBGL_ENABLED")&&(Ep.failIfMajorPerformanceCaveat=!1),n===1?t.getContext("webgl",Ep)||t.getContext("experimental-webgl",Ep):t.getContext("webgl2",Ep)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var nd;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(nd||(nd={}));var ms;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(ms||(ms={}));var nr;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(nr||(nr={}));function Vf(n,e){return[e,n]}function Xse(n,e){return n*e}function Ip(n){const e=we(n),t=Math.ceil(e/4);return Kx(t)}function wc(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function Yse(n,e){const[t,r]=wc(n,e);return t*r*4}function LC(n,e){const t=n;let r,s,i,o,a,l,u,c,h,d;return me().getNumber("WEBGL_VERSION")===2?(r=t.R32F,s=t.R16F,i=t.RGBA16F,o=t.RGBA32F,a=t.RED,u=4,c=1,h=t.HALF_FLOAT,d=t.FLOAT,l=t.RGBA8):(r=n.RGBA,s=n.RGBA,i=n.RGBA,o=t.RGBA,a=n.RGBA,u=4,c=4,h=e!=null?e.HALF_FLOAT_OES:null,d=n.FLOAT,l=n.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:h,textureTypeFloat:d}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ue(n,e){const t=e();return me().getBool("DEBUG")&&Zse(n),t}function Zse(n){const e=n.getError();if(e!==n.NO_ERROR)throw new Error("WebGL Error: "+tie(n,e))}const Qse=596e-10,Jse=65504;function eie(n){return!!(me().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||Qse<Math.abs(n)&&Math.abs(n)<Jse)}function tie(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Tp(n,e){return No(n,()=>n.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function nie(n,e){const t=No(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ue(n,()=>n.shaderSource(t,e)),Ue(n,()=>n.compileShader(t)),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function rie(n,e){const t=No(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ue(n,()=>n.shaderSource(t,e)),Ue(n,()=>n.compileShader(t)),me().get("ENGINE_COMPILE_ONLY"))return t;if(n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw hL(e,n.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const sie=/ERROR: [0-9]+:([0-9]+):/g;function hL(n,e){const t=sie.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(n);return}const r=+t[1],s=n.split(`
`),i=s.length.toString().length+2,o=s.map((h,d)=>$u((d+1).toString(),i)+h);let a=0;for(let h=0;h<o.length;h++)a=Math.max(o[h].length,a);const l=o.slice(0,r-1),u=o.slice(r-1,r),c=o.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${$u(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function iie(n){return No(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function oie(n,e){if(Ue(n,()=>n.linkProgram(e)),!me().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Fy(n,e){if(Ue(n,()=>n.validateProgram(e)),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function aie(n,e){const t=No(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Ue(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),Ue(n,()=>n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function lie(n,e){const t=No(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Ue(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t)),Ue(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function uie(n){return No(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function cie(n,e){const t=me().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){const r=`[${n}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(n>t||e>t){const r=`[${n}x${e}]`,s=`[${t}x${t}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function hie(n){return No(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function PI(n,e,t,r,s,i,o){const a=n.getAttribLocation(e,t);return a===-1?!1:(Ue(n,()=>n.bindBuffer(n.ARRAY_BUFFER,r)),Ue(n,()=>n.vertexAttribPointer(a,s,n.FLOAT,!1,i,o)),Ue(n,()=>n.enableVertexAttribArray(a)),!0)}function die(n,e,t){vie(n,t),Ue(n,()=>n.activeTexture(n.TEXTURE0+t)),Ue(n,()=>n.bindTexture(n.TEXTURE_2D,e))}function fie(n,e,t){return No(n,()=>n.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function pie(n,e,t){return n.getUniformLocation(e,t)}function mie(n,e,t,r){Ue(n,()=>die(n,e,r)),Ue(n,()=>n.uniform1i(t,r))}function Ly(n,e,t){Ue(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),Ue(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0))}function MI(n,e){Ue(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),Ue(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function _p(n){const e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+gie(n,e))}function gie(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function No(n,e,t){const r=Ue(n,()=>e());if(r==null)throw new Error(t);return r}function vie(n,e){const t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+n.TEXTURE0;if(r<n.TEXTURE0||r>t){const s=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${s}.`)}}function tc(n,e=2){return we(n.slice(0,n.length-e))}function nc(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function Np(n){let e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[tc(n),...nc(n)]),e}function yie(n,e=!1){let t=me().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=me().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&me().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=t/2),e&&(t=t*2,r=r*2,n=n.map((a,l)=>l>=n.length-2?eb(n[l]):n[l]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=ba(n).newShape);let s=we(n),i=null;n.length<=1&&s<=t?i=[1,s]:n.length===2&&n[0]<=t&&n[1]<=t?i=n:n.length===3&&n[0]*n[1]<=t&&n[2]<=t?i=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=t&&n[1]*n[2]<=t?i=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=t&&n[3]<=t?i=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=t&&n[1]*n[2]*n[3]<=t&&(i=[n[0],n[1]*n[2]*n[3]]);const o=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=tc(n);let l=2,u=2;n.length&&([l,u]=nc(n)),s=a*(l/2)*(u/2),i=Kx(s).map(c=>c*2)}else i=Kx(s);return i}function $p(n){return n%2===0}function ng(n,e){if(n=n.slice(-2),e=e.slice(-2),Nt(n,e)||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){const t=n[n.length-1],r=e[e.length-1];if(t===r||$p(t)&&$p(r)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&$p(n[0])&&$p(e[0])}let Py,My;function xie(n){if(Py==null){const e=xi(n);Py=e.getParameter(e.MAX_TEXTURE_SIZE)}return Py}function wie(n){if(My==null){const e=xi(n);My=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,My)}function bie(n){if(n===0)return 0;let e;const t=xi(n);return Vs(t,"EXT_disjoint_timer_query_webgl2")&&n===2?e=2:Vs(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function Vs(n,e){return n.getExtension(e)!=null}function BI(n){try{if(xi(n)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Cie(n){if(n===0)return!1;const e=xi(n);if(n===1){if(!Vs(e,"OES_texture_float"))return!1}else if(!Vs(e,"EXT_color_buffer_float"))return!1;return _1(e)}function Sie(n){if(n===0)return!1;const e=xi(n);if(n===1){if(!Vs(e,"OES_texture_float")||!Vs(e,"WEBGL_color_buffer_float"))return!1}else{if(Vs(e,"EXT_color_buffer_float"))return _1(e);const r="EXT_color_buffer_half_float";if(Vs(e,r)){const s=e.getExtension(r);return kie(e,s)}return!1}return _1(e)}function _1(n){const e=LC(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t);const r=1,s=1;n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,r,s,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const o=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(i),o}function kie(n,e){const t=LC(n,e),r=n.createTexture();n.bindTexture(n.TEXTURE_2D,r);const s=1,i=1;n.texImage2D(n.TEXTURE_2D,0,t.internalFormatHalfFloat,s,i,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const o=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,o),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,r,0);const a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(r),n.deleteFramebuffer(o),a}function Eie(n){return n!==2?!1:xi(n).fenceSync!=null}function Wf(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&O(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ke=me();Ke.registerFlag("HAS_WEBGL",()=>Ke.getNumber("WEBGL_VERSION")>0);Ke.registerFlag("WEBGL_VERSION",()=>BI(2)?2:BI(1)?1:0);Ke.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ke.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ke.get("WEBGL_VERSION")===2);Ke.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ke.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ke.registerFlag("WEBGL_PACK",()=>Ke.getBool("HAS_WEBGL"));Ke.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_CLIP",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_REDUCE",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_CONV_IM2COL",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>xie(Ke.getNumber("WEBGL_VERSION")));Ke.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>wie(Ke.getNumber("WEBGL_VERSION")));Ke.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=Ke.getNumber("WEBGL_VERSION");return n===0?0:bie(n)});Ke.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ke.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!hA());Ke.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Cie(Ke.getNumber("WEBGL_VERSION")));Ke.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ke.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ke.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ke.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Sie(Ke.getNumber("WEBGL_VERSION")));Ke.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Eie(Ke.getNumber("WEBGL_VERSION")));Ke.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ke.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ke.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});Ke.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>hA()?1:-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});Ke.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ke.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ke.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ke.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ke.registerFlag("WEBGL_EXP_CONV",()=>!1);Ke.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ke.getBool("IS_TEST"));Ke.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ke.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ke.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ke.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dr(){let n,e,t,r,s,i,o,a,l,u;return me().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",r="in",s="texture",i="outputColor",o="out vec4 outputColor;",a=me().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",r="varying",s="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:r,texture2D:s,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zl(n,e,t="index"){const r=Qe(e);return r.map((s,i)=>{const o=`int ${n[i]} = ${t} / ${s}`,a=i===r.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * ${s}`:`index -= ${n[i]} * ${s}`;return`${o}; ${a};`}).join("")}function Sv(n,e,t="index"){const r=Qe(e);return r.map((s,i)=>{const o=`int ${n[i]} = ${t} / outShapeStrides[${i}]`,a=i===r.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * outShapeStrides[${i}]`:`index -= ${n[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function Iie(n,e){const t=n.length,r=n.map(i=>`${e}[${i}]`),s=new Array(t-1);s[t-2]=r[t-1];for(let i=t-3;i>=0;--i)s[i]=`(${s[i+1]} * ${r[i+1]})`;return s}function Tie(n,e,t="index"){const r=n.map((i,o)=>o),s=Iie(r,e);return s.map((i,o)=>{const a=`int ${n[o]} = ${t} / ${s[o]}`,l=o===s.length-1?`int ${n[o+1]} = ${t} - ${n[o]} * ${s[o]}`:`index -= ${n[o]} * ${s[o]}`;return`${a}; ${l};`}).join("")}function PC(n){const e=Qe(n).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function MC(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const dL=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:fL}=vK;function _ie(n,e,t){const r=[];if(n.forEach(f=>{const p=we(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?r.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(r.push(`uniform sampler2D ${f.name};`),r.push(`uniform int offset${f.name};`)),t.enableShapeUniforms){const{uniformShape:v}=BC(t.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(v.length){case 1:r.push(`uniform int ${f.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${f.name}Shape;`);break}r.push(`uniform ivec2 ${f.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(f=>{r.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const s=r.join(`
`),i=n.map(f=>Nie(f,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),o=e.texShape,a=Dr(),l=Aie(a);let u,c,h=Fie(a);return e.isPacked?(u=$ie(e.logicalShape,o,t.enableShapeUniforms),c=Oie(a)):(u=Die(e.logicalShape,o,t.enableShapeUniforms),c=Rie(a)),t.packedInputs&&(h+=Bie),[h,l,c,s,u,i,t.userCode].join(`
`)}function bc(n,e=!1){const t=n.shapeInfo.logicalShape;switch(t.length){case 0:return Zie(n,e);case 1:return Jie(n,e);case 2:return toe(n,e);case 3:return roe(n,e);case 4:return ioe(n,e);case 5:return ooe(n);case 6:return aoe(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function pL(n,e){switch(n.shapeInfo.logicalShape.length){case 0:return Yie(n);case 1:return Qie(n,e);case 2:return eoe(n,e);case 3:return noe(n,e);default:return soe(n,e)}}function Nie(n,e,t=!1,r){let s="";t?s+=pL(n,r):s+=bc(n,r);const i=n.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(t?s+=loe(n,e):s+=uoe(n,e)),s}function $ie(n,e,t){switch(n.length){case 0:return mL();case 1:return zie(n,e,t);case 2:return Kie(n,e,t);case 3:return Vie(n,e,t);default:return Gie(n,e,t)}}function Die(n,e,t){switch(n.length){case 0:return mL();case 1:return Uie(n,e,t);case 2:return Xie(n,e,t);case 3:return Wie(n,e,t);case 4:return jie(n,e,t);case 5:return Hie(n,e);case 6:return qie(n,e);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function Aie(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function Rie(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function Oie(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function Fie(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Lie}
    ${Pie}
    ${Mie}
  `}const Lie=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Pie=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Mie=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Bie=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function mL(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function zie(n,e,t){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function Uie(n,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Vie(n,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(n[2]/2),i=s*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function Wie(n,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Sv(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const r=zl(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function Gie(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(n[n.length-1]/2),i=s*Math.ceil(n[n.length-2]/2);let o=i,a="",l="b, r, c";for(let u=2;u<n.length-1;u++)o*=n[n.length-u-1],a=`
      int b${u} = index / ${o};
      index -= b${u} * ${o};
    `+a,l=`b${u}, `+l;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${n.length}(${l});
    }
  `}function jie(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Sv(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const r=zl(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function Hie(n,e){const t=zl(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function qie(n,e){const t=zl(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Kie(n,e,t){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Nt(n,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(n[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function Xie(n,e,t){return Nt(n,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:n[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function Ul(n){return`offset${n}`}function Yie(n){const e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Dr();return`
    vec4 ${t}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function Zie(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${r}() {return ${t};}`;const[s,i]=n.shapeInfo.texShape;if(s===1&&i===1)return`
      float ${r}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const o=Ul(t);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${o});
      return sampleTexture(${t}, uv);
    }
  `;const[a,l]=n.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${t}, uv);
    }
  `}function Qie(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),s=n.shapeInfo.texShape,i=Dr();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${t}, uv);
    }
  `;const o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${t}, uv);
    }
  `}function Jie(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${Cc(n)}
      }
    `;const s=n.shapeInfo.texShape,i=s[0],o=s[1];if(o===1&&i===1)return`
      float ${r}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const a=Ul(t);return o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${t}, uv);
      }
    `:i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${a});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${t}, uv);
    }
  `}function eoe(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n.shapeInfo.texShape,o=i[0],a=i[1],l=Dr();if(i!=null&&Nt(t,i))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],c=Math.ceil(t[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function toe(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n.shapeInfo.texShape;if(i!=null&&Nt(t,i)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const d=i[0],f=i[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:o,keptDims:a}=ba(t),l=o;if(l.length<t.length){const d=Sc(n,l),f=["row","col"];return`
      ${bc(d,e)}
      float ${s}(int row, int col) {
        return ${s}(${kc(f,a)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${Cc(n)}
      }
    `;const u=i[0],c=i[1],h=Ul(r);return c===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${h};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${h};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function noe(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(t[0]===1){const d=t.slice(1),f=[1,2],p=Sc(n,d),v=["b","row","col"];return`
        ${pL(p,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${kc(v,f)});
        }
      `}const a=Dr();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const l=o[0],u=o[1],c=Math.ceil(t[2]/2),h=c*Math.ceil(t[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${h}, ${c}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function roe(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t[1]*t[2],o=t[2],{newShape:a,keptDims:l}=ba(t),u=a;if(u.length<t.length){const v=Sc(n,u),g=["row","col","depth"];return`
        ${bc(v,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${kc(g,l)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${Cc(n)}
      }
    `;const c=n.shapeInfo.texShape,h=c[0],d=c[1],f=n.shapeInfo.flatOffset;if(d===i&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${d}.0, ${h}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(d===o&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `;const p=Ul(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${p};
        vec2 uv = uvFromFlat(${h}, ${d}, index);
        return sampleTexture(${r}, uv);
      }
  `}function soe(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),s=Dr();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${t}, uv);
    }
  `;const i=n.shapeInfo.logicalShape,o=i.length,a=n.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],c=l[1],h=Math.ceil(i[o-1]/2);let d=h*Math.ceil(i[o-2]/2),f="int b, int row, int col",p=`b * ${d} + (row / 2) * ${h} + (col / 2)`;for(let v=2;v<o-1;v++)f=`int b${v}, `+f,d*=i[o-v-1],p=`b${v} * ${d} + `+p;return`
    vec4 ${r}(${f}) {
      int index = ${p};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${s.texture2D}(${t}, uv);
    }
  `}function ioe(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t[3],o=t[2]*i,a=t[1]*o,{newShape:l,keptDims:u}=ba(t);if(l.length<t.length){const y=Sc(n,l),w=["row","col","depth","depth2"];return`
      ${bc(y,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${kc(w,u)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${Cc(n)}
      }
    `;const c=n.shapeInfo.flatOffset,h=n.shapeInfo.texShape,d=h[0],f=h[1],p=`int stride2 = ${r}Shape[3];`,v=`int stride1 = ${r}Shape[2] * stride2;`,g=`int stride0 = ${r}Shape[1] * stride1;`;if(f===a&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${p}
        ${v}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(f===i&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;const m=Ul(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${v}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${m});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${d}, ${f}, index + ${m});
      return sampleTexture(${r}, uv);
    }
  `}function ooe(n){const e=n.shapeInfo.logicalShape,t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),s=e[4],i=e[3]*s,o=e[2]*i,a=e[1]*o,{newShape:l,keptDims:u}=ba(e);if(l.length<e.length){const v=Sc(n,l),g=["row","col","depth","depth2","depth3"];return`
      ${bc(v)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${kc(g,u)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${s})) +
          depth3;
        ${Cc(n)}
      }
    `;const c=n.shapeInfo.flatOffset,h=n.shapeInfo.texShape,d=h[0],f=h[1];if(f===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(f===s&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${t}, uv);
      }
    `;const p=Ul(t);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${s} + depth3 + ${p};
      vec2 uv = uvFromFlat(${d}, ${f}, index);
      return sampleTexture(${t}, uv);
    }
  `}function aoe(n){const e=n.shapeInfo.logicalShape,t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:s,keptDims:i}=ba(e);if(s.length<e.length){const g=Sc(n,s),m=["row","col","depth","depth2","depth3","depth4"];return`
      ${bc(g)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${kc(m,i)});
      }
    `}const o=e[5],a=e[4]*o,l=e[3]*a,u=e[2]*l,c=e[1]*u;if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Cc(n)}
      }
    `;const h=n.shapeInfo.flatOffset,d=n.shapeInfo.texShape,f=d[0],p=d[1];if(p===c&&h==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(p===o&&h==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${t}, uv);
      }
    `;const v=Ul(t);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${v};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${t}, uv);
    }
  `}function Cc(n){const e=n.name,t=we(n.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function loe(n,e){const t=n.name,r=t.charAt(0).toUpperCase()+t.slice(1),s="get"+r+"AtOutCoords",i=n.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=fL(n.shapeInfo.logicalShape,e.logicalShape),l=Ut(o),u=o-i;let c;const h=["x","y","z","w","u","v"];i===0?c="":o<2&&a.length>=1?c="coords = 0;":c=a.map(y=>`coords.${h[y+u]} = 0;`).join(`
`);let d="";o<2&&i>0?d="coords":d=n.shapeInfo.logicalShape.map((y,w)=>`coords.${h[w+u]}`).join(", ");let f="return outputValue;";const v=we(n.shapeInfo.logicalShape)===1,m=we(e.logicalShape)===1;if(i===1&&!v&&!m)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(v&&!m)o===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const y=i-2,w=i-1;a.indexOf(y)>-1&&a.indexOf(w)>-1?f="return vec4(outputValue.x);":a.indexOf(y)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(w)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${d});
      ${f}
    }
  `}function uoe(n,e){const t=n.name,r=t.charAt(0).toUpperCase()+t.slice(1),s="get"+r+"AtOutCoords",i=e.texShape,o=n.shapeInfo.texShape,a=n.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!n.shapeInfo.isUniform&&a===l&&n.shapeInfo.flatOffset==null&&Nt(o,i))return`
      float ${s}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const u=Ut(l),c=fL(n.shapeInfo.logicalShape,e.logicalShape),h=l-a;let d;const f=["x","y","z","w","u","v"];a===0?d="":l<2&&c.length>=1?d="coords = 0;":d=c.map(v=>`coords.${f[v+h]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=n.shapeInfo.logicalShape.map((v,g)=>`coords.${f[g+h]}`).join(", "),`
    float ${s}() {
      ${u} coords = getOutputCoords();
      ${d}
      return get${r}(${p});
    }
  `}function Ut(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function BC(n,e,t){const{newShape:r,keptDims:s}=ba(e),i=e.length,o=n&&i===3&&e[0]===1,a=o?e.slice(1):r,l=!n&&i>1&&!Nt(e,t)&&r.length<i||o;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:s}}function Sc(n,e){const t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function kc(n,e){return e.map(t=>n[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function coe(n,e,t,r){const s=t.map((c,h)=>{const d={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(d.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[h],shapeInfo:d}}),i=s.map(c=>c.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=_ie(s,o,e),l=rie(n.gl,a),u=n.createProgram(l);return me().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(u),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:i,outShapeInfo:o},gL(n,e,u)))}function gL(n,e,t){const r=[],s=[];let i,o,a,l=null,u=null;u=n.getUniformLocation(t,"NAN",!1),me().getNumber("WEBGL_VERSION")===1&&(l=n.getUniformLocation(t,"INFINITY",!1));const c=!1;for(const h of e.variableNames){const d={name:h,uniform:n.getUniformLocation(t,h,c),offset:n.getUniformLocation(t,`offset${h}`,c)};e.enableShapeUniforms&&(d.shape=n.getUniformLocation(t,`${h}Shape`,c),d.texShape=n.getUniformLocation(t,`${h}TexShape`,c)),r.push(d)}if(e.enableShapeUniforms&&(i=n.getUniformLocation(t,"outShape",c),a=n.getUniformLocation(t,"outShapeStrides",c),o=n.getUniformLocation(t,"outTexShape",c)),e.customUniforms)for(const h of e.customUniforms)s.push(n.getUniformLocation(t,h.name,c));return{variablesLocations:r,customUniformLocations:s,infLoc:l,nanLoc:u,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function zI(n,e){if(n.length!==e.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${e.length} inputs`);n.forEach((t,r)=>{const s=t.logicalShape,i=e[r],o=i.shape;if(!Nt(s,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${o} must match`);if(t.isUniform&&i.isUniform)return;const a=t.texShape,l=i.isUniform?null:i.texData.texShape;if(!Nt(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function hoe(n,e,t,r,s){e.program.enableShapeUniforms||(zI(e.inShapeInfos,t),zI([e.outShapeInfo],[r]));const i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?n.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):n.setOutputMatrixTexture(i.texture,o[0],o[1]),n.setProgram(e.webGLProgram),n.bindVertexArray(e.webGLProgram.vao),me().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&n.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&n.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<t.length;++l){const u=t[l],{uniform:c,offset:h,shape:d,texShape:f}=e.variablesLocations[l];if(d){const{uniformShape:p}=BC(e.program.packedInputs,u.shape,u.texData.texShape);switch(p.length){case 1:n.gl.uniform1iv(d,new Int32Array(p));break;case 2:n.gl.uniform2iv(d,new Int32Array(p));break;case 3:n.gl.uniform3iv(d,new Int32Array(p));break;case 4:n.gl.uniform4iv(d,new Int32Array(p));break}}if(f&&n.gl.uniform2i(f,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(we(u.shape)<2)n.gl.uniform1f(c,u.uniformValues[0]);else{let p=u.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),n.gl.uniform1fv(c,p)}continue}u.texData.slice!=null&&h!=null&&n.gl.uniform1i(h,u.texData.slice.flatOffset),n.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:n.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:n.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:n.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:n.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=Qe(r.shape);switch(r.shape.length){case 2:n.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:n.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:n.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&n.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],c=e.customUniformLocations[l],h=s[l];if(u.type==="float")n.gl.uniform1fv(c,h);else if(u.type==="vec2")n.gl.uniform2fv(c,h);else if(u.type==="vec3")n.gl.uniform3fv(c,h);else if(u.type==="vec4")n.gl.uniform4fv(c,h);else if(u.type==="int")n.gl.uniform1iv(c,h);else if(u.type==="ivec2")n.gl.uniform2iv(c,h);else if(u.type==="ivec3")n.gl.uniform3iv(c,h);else if(u.type==="ivec4")n.gl.uniform4iv(c,h);else throw Error(`uniform type ${u.type} is not supported yet.`)}n.executeProgram()}function doe(n,e,t){let r="";e.concat(t).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:h}=BC(n.packedInputs,o.shape,l);let d="",f="",p="";if(c.length===1&&n.packedInputs){const b=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];d=`${b[0]>1}_${b[1]>1}`}else if(c.length===2&&!n.packedInputs)f=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!n.packedInputs){const b=Qe(c);p=`${b[0]===l[1]}_${b[b.length-1]===l[1]}`}const v=o.shape.length,g=c.length===2&&Nt(o.shape,l),m=we(o.shape)===1,y=Ku(o.shape,t.shape),w=!n.packedInputs&&v===t.shape.length&&Nt(l,t.texData.texShape),x=n.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${v}_${w}_${u?h:""}_${c.length}_${m}_${y}_${g}_${d}_${f}_${p}_${x}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;r+=`${o.shape}_${l}_${a}`}});const s=n.userCode;let i=n.constructor.name;return i+="_"+r+"_"+s+`${me().getNumber("WEBGL_VERSION")}`,i}function vr(n){return me().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class foe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=nd.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Dr();this.outputShape=e,this.enableShapeUniforms=vr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Sv(["r","c","d"],e):zl(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class poe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=nd.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Dr();this.outputShape=e,this.enableShapeUniforms=vr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Sv(["r","c","d"],e):zl(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class moe{constructor(e){this.variableNames=["A"],this.outTexUsage=ms.DOWNLOAD;const t=Dr();this.outputShape=e,this.userCode=`
      ${dL}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class goe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=ms.DOWNLOAD;const t=Dr();this.outputShape=e,this.userCode=`
      ${dL}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const voe={R:0,G:1,B:2,A:3};class UI{constructor(e,t=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Dr();this.outputShape=e,this.enableShapeUniforms=vr(this.outputShape.length);let i="result";t&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<r.length;a++){const l=r[a];o+=`
          if(offset == ${a}) {
            result = values[${voe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?MC():PC(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${o}
        }
        ${s.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yoe{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Dr();this.outputShape=e,this.enableShapeUniforms=vr(this.outputShape.length);let s="",i="result";t&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;s+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?MC():PC(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xoe(n){const e=Dr(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return nie(n,t)}function woe(n){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return aie(n,e)}function boe(n){const e=new Uint16Array([0,1,2,2,1,3]);return lie(n,e)}function Gf(n,e,t,r,s,i){cie(e,t);const o=uie(n),a=n.TEXTURE_2D;return Ue(n,()=>n.bindTexture(a,o)),Ue(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),Ue(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),Ue(n,()=>n.texParameteri(a,n.TEXTURE_MIN_FILTER,n.NEAREST)),Ue(n,()=>n.texParameteri(a,n.TEXTURE_MAG_FILTER,n.NEAREST)),me().getNumber("WEBGL_VERSION")===1?Ue(n,()=>n.texImage2D(a,0,r,e,t,0,s,i,null)):Ue(n,()=>n.texStorage2D(a,1,r,e,t)),Ue(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:o,texShape:[t,e]}}function vL(n){return n.internalFormatFloat}function Coe(n,e,t,r){const[s,i]=Vf(e,t);return Gf(n,s,i,vL(r),r.textureFormatFloat,n.FLOAT)}function yL(n){return n.internalFormatHalfFloat}function Soe(n,e,t,r){const[s,i]=Vf(e,t);return Gf(n,s,i,yL(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function xL(n){return n.downloadTextureFormat}function koe(n,e,t,r){const[s,i]=Vf(e,t);return Gf(n,s,i,xL(r),n.RGBA,n.UNSIGNED_BYTE)}function wL(n){return n.internalFormatPackedFloat}function Eoe(n,e,t,r){const[s,i]=wc(e,t);return Gf(n,s,i,wL(r),n.RGBA,n.FLOAT)}function bL(n){return n.internalFormatPackedHalfFloat}function Ioe(n,e,t,r){const[s,i]=wc(e,t);return Gf(n,s,i,bL(r),n.RGBA,r.textureTypeHalfFloat)}function Toe(n,e,t){return Ue(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),PI(n,e,"clipSpacePos",t,3,20,0)&&PI(n,e,"uv",t,2,20,12)}function _oe(n,e,t,r,s,i){Ue(n,()=>n.bindTexture(n.TEXTURE_2D,e));let o,a,l;s instanceof Uint8Array?(o=new Uint8Array(t*r*4),a=n.UNSIGNED_BYTE,l=n.RGBA):(o=new Float32Array(t*r*4),a=n.FLOAT,l=i.internalFormatPackedFloat),o.set(s),me().getNumber("WEBGL_VERSION")===2?Ue(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,r,n.RGBA,a,o)):Ue(n,()=>n.texImage2D(n.TEXTURE_2D,0,l,t,r,0,n.RGBA,a,o)),Ue(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Noe(n,e,t){Ue(n,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?me().getNumber("WEBGL_VERSION")===2?Ue(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):Ue(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):me().getNumber("WEBGL_VERSION")===2?Ue(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):Ue(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),Ue(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function $oe(n,e,t,r){const s=n.createBuffer();Ue(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,s));const a=4*4*e*t;return Ue(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,a,n.STREAM_READ)),Ue(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,0)),Ue(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),s}function Doe(n,e,t){const r=n,s=new Float32Array(t);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function Aoe(n,e,t,r){const[s,i]=Vf(e,t),o=4,a=new Uint8Array(Xse(e*t,o));return Ue(n,()=>n.readPixels(0,0,s,i,r.downloadTextureFormat,n.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Roe(n,e,t,r,s,i,o,a){const l=n,u=new Float32Array(Yse(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function Ooe(n,e,t){const r=new Float32Array(e*t*4);return Ue(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class By{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=me().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,Hse(t,e)):this.gl=xi(t),e=this.gl,me().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>Ue(i,()=>i.createVertexArray()),this.bindVertexArray=o=>Ue(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>Ue(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>Ue(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ue(e,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>Ue(e,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>Ue(e,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>Ue(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),me().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=Tp(this.gl,i),Vs(this.gl,o))this.textureHalfFloatExtension=Tp(this.gl,o);else if(me().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Vs(this.gl,s))this.colorBufferHalfFloatExtension=Tp(this.gl,s);else if(me().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Vs(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Vs(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=woe(this.gl),this.indexBuffer=boe(this.gl),this.framebuffer=hie(this.gl),this.textureConfig=LC(this.gl,this.textureHalfFloatExtension)}get debug(){return me().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Ue(e,()=>e.finish()),Ue(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Ue(e,()=>e.deleteFramebuffer(this.framebuffer)),Ue(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Ue(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Ue(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),Coe(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),Soe(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),koe(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),Noe(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,r,s){this.throwIfDisposed(),_oe(this.gl,e,t,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),Ioe(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),Eoe(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(MI(this.gl,this.framebuffer),this.outputTexture=null),Ue(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,r){return this.downloadMatrixDriver(e,()=>Aoe(this.gl,t,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,r,s,i,o){return Roe(this.gl,e,t,r,s,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return Doe(this.gl,e,t)}createBufferFromTexture(e,t,r){this.bindTextureToFrameBuffer(e);const s=$oe(this.gl,t,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,r;if(me().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,i=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const o=s.clientWaitSync(i,0,0);return o===s.ALREADY_SIGNALED||o===s.CONDITION_SATISFIED},t=i}else me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(t,me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:t,isFencePassed:r}}downloadMatrixFromPackedTexture(e,t,r){return this.downloadMatrixDriver(e,()=>Ooe(this.gl,t,r))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=xoe(t));const r=iie(t);Ue(t,()=>t.attachShader(r,this.vertexShader)),Ue(t,()=>t.attachShader(r,e)),oie(t,r);const s=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&Fy(t,s),s}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;Ue(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Toe(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Ue(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Fy(this.gl,this.program),Ue(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,r=!0){return this.throwIfDisposed(),r?fie(this.gl,e,t):pie(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),Ue(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,r){this.throwIfDisposed(),this.throwIfNoProgram(),mie(this.gl,e,t,r)}setOutputMatrixTexture(e,t,r){this.setOutputMatrixTextureDriver(e,r,t)}setOutputPackedMatrixTexture(e,t,r){this.throwIfDisposed();const[s,i]=wc(t,r);this.setOutputMatrixTextureDriver(e,s,i)}setOutputMatrixWriteRegion(e,t,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,t)}setOutputPackedMatrixWriteRegion(e,t,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Fy(this.gl,this.program),_p(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ue(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ue(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Tp(this.gl,me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,r=this.getQueryTimerExtensionWebGL2();t.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await IE(()=>this.disposed||this.isQueryAvailable(e,me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=Foe(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:r}=this.itemsToPoll[t];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in me().platform&&(r=me().platform.setTimeoutCustom.bind(me().platform)),IE(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Ly(this.gl,e,this.framebuffer),this.debug&&_p(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Ly(this.gl,this.outputTexture,this.framebuffer),this.debug&&_p(this.gl)):MI(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const r=t();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,t,r){this.throwIfDisposed();const s=this.gl;Ly(s,e,this.framebuffer),this.debug&&_p(s),this.outputTexture=e,Ue(s,()=>s.viewport(0,0,t,r)),Ue(s,()=>s.scissor(0,0,t,r))}setOutputMatrixWriteRegionDriver(e,t,r,s){this.throwIfDisposed(),Ue(this.gl,()=>this.gl.scissor(e,t,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Foe(n){let e=0;for(;e<n.length&&n[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Loe,bincountImpl:CL,bincountReduceImpl:Poe,bitwiseAndImpl:Moe,castImpl:Boe,ceilImpl:zoe,concatImpl:Uoe,equalImpl:Voe,expImpl:Woe,expm1Impl:Goe,floorImpl:joe,gatherNdImpl:Hoe,gatherV2Impl:qoe,greaterImpl:Koe,greaterEqualImpl:Xoe,lessImpl:Yoe,lessEqualImpl:Zoe,linSpaceImpl:Qoe,logImpl:Joe,maxImpl:eae,maximumImpl:tae,minimumImpl:nae,multiplyImpl:rae,negImpl:sae,notEqualImpl:iae,prodImpl:oae,raggedGatherImpl:aae,raggedRangeImpl:lae,raggedTensorToTensorImpl:uae,rangeImpl:cae,rsqrtImpl:hae,scatterImpl:dae,sigmoidImpl:fae,simpleAbsImpl:SL,sliceImpl:pae,sparseFillEmptyRowsImpl:mae,sparseReshapeImpl:gae,sparseSegmentReductionImpl:kL,sqrtImpl:vae,staticRegexReplaceImpl:yae,stridedSliceImpl:xae,stringNGramsImpl:wae,stringSplitImpl:bae,stringToHashBucketFastImpl:Cae,subImpl:Sae,tileImpl:kae,topKImpl:Eae,transposeImpl:zC,uniqueImpl:Iae}=NJ;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EL(n,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${n}.${t}`)}function kr(n,e){return e===1?[n]:EL(n,e)}function Tae(n,e){if(n===1)return"rc";let t="";for(let r=0;r<n;r++)t+=e[r],r<n-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ae{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=vr(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=kr("rc",this.rank),r=Ut(this.rank),s=this.getOutOfBoundsCondition(t),i=this.getSetup(t),o=this.getOutput(t);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let i=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;t.push(i)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let r=this.rank-2;r<this.rank;r++)t+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IL{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=vr(this.outputShape.length);let r="";for(let s=0;s<4;s++){let i="thisRC = rc;";s%2===1&&(i+="thisRC.z += 1;"),s>1&&(i+="thisRC.y += 1;"),r+=`
        ${i}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${Nae(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?MC():PC(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function Nae(n,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Tie(["r","c","d"],"inputShape"):zl(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $ae{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,r){const s=WI(t,r),i=GI(e,s,r);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=VI(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let a;return s===nr.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===nr.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===nr.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===nr.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===nr.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,t,r,s){if(this.freeTextures==null)return;const i=WI(r,s),o=GI(t,i,s);o in this.freeTextures||(this.freeTextures[o]=[]);const a=VI(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,s),l=me().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const u=this.usedTextures[o],c=u&&u.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Dae(n,e){const t=n;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===n.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function VI(n,e,t,r,s){const i=Aae(e,r);let o;if(s){const[l,u]=wc(n[0],n[1]);o=l*u}else{const[l,u]=Vf(n[0],n[1]);o=l*u}const a=Dae(t,i);return o*a}function Aae(n,e){switch(n){case nr.PACKED_2X2_FLOAT32:return wL(e);case nr.PACKED_2X2_FLOAT16:return bL(e);case nr.UNPACKED_FLOAT32:return vL(e);case nr.UNPACKED_FLOAT16:return yL(e);case nr.PACKED_4X1_UNSIGNED_BYTE:return xL(e);default:throw new Error(`Unknown physical texture type ${n}`)}}function Rae(n){return me().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?nr.PACKED_2X2_FLOAT32:nr.UNPACKED_FLOAT32:n?nr.PACKED_2X2_FLOAT16:nr.UNPACKED_FLOAT16}function WI(n,e){if(n===ms.UPLOAD)return nr.PACKED_2X2_FLOAT32;if(n===ms.RENDER||n==null)return Rae(e);if(n===ms.DOWNLOAD||n===ms.PIXELS)return nr.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function GI(n,e,t){return`${n[0]}_${n[1]}_${e}_${t}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pi{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=vr(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Ys="if (isnan(x)) return x;",Oae="return x;",jI="return abs(x);",Fae="return (x >= 0.0) ? x : (exp(x) - 1.0);",Lae=Ys+`
  return (x < 0.0) ? 0.0 : x;
`,Pae=Ys+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Bo="return x;",Mae="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bae="return x;",zae=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Uae=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Vae=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Wae="return 1.0 / (1.0 + exp(-1.0 * x));";class qo{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=vr(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gae{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=vr(this.outputShape.length);const t=e.length,r=kr("rc",t),s=Ut(t),i=Tae(t,r),o=r.slice(-2),a=t<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jae=YA,Hae=1e-7,qae=1e-4,Dp={};function Kae(n){return n in Dp||(Dp[n]={}),Dp[n]}const Xae=me().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),Yae=600;function Zae(){return me().global.screen==null?1024:me().global.screen.height*me().global.screen.width*window.devicePixelRatio*Yae/1024/1024}class kv extends Jw{nextDataId(){return kv.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!me().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof By)t=e;else{const r=xi(me().getNumber("WEBGL_VERSION"),e);t=new By(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=xi(me().getNumber("WEBGL_VERSION"));t=new By(r),this.binaryCache=Kae(me().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new $ae(this.gpgpu),this.numMBBeforeWarning=Zae(),this.texData=new xD(this,Ni())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,r,s,i,o){const a=this.makeTensorInfo(t,r),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[s,i]},l.texShape=[s,i];const u=Np(t),c=new UI(u,!1,o),h=this.runWebGLProgram(c,[a],r,[[s,i]]);return h.shape=t,l.texture=null,this.disposeIntermediateTensorInfo(a),h.dataId}write(e,t,r){if((me().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||me().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:t,dtype:r,values:e,usage:ms.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,r,s,i){if(me().getBool("DEBUG")&&this.checkNumericalProblems(t),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:t,usage:ms.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:i,slice:o,shape:a,isPacked:l}=t;if(o!=null){let d;l?d=new qo(a,Bo):d=new Pi(a,Bo);const f=this.runWebGLProgram(d,[{dataId:e,shape:a,dtype:s}],s),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=Or());let h;if(s==="complex64"){const d=this.readSync(i.real.dataId),f=this.readSync(i.imag.dataId);h=bo(d,f)}else h=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=Or()-c),this.convertAndCacheOnCPU(e,h)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(v=>p.push(v))}const t=this.texData.get(e),{values:r,shape:s,slice:i,dtype:o,complexTensorInfos:a,isPacked:l}=t;if(i!=null){let p;l?p=new qo(s,Bo):p=new Pi(s,Bo);const v=this.runWebGLProgram(p,[{dataId:e,shape:s,dtype:o}],o),g=this.read(v.dataId);return this.disposeIntermediateTensorInfo(v),g}if(r!=null)return this.convertAndCacheOnCPU(e);if(me().getBool("DEBUG")&&!me().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&me().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(o!=="complex64"&&me().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const p=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(p.texture.texture,...Ip(s))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let h;if(o==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),v=p[0],g=p[1];h=bo(v,g)}else if(u==null)h=this.getValuesFromTexture(e);else{const p=we(s);h=this.gpgpu.downloadFloat32MatrixFromBuffer(u,p)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const p=this.gpgpu.gl;Ue(p,()=>p.deleteBuffer(u))}const d=this.convertAndCacheOnCPU(e,h),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(d)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Ni().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e,t={}){const r=this.texData.get(e),{values:s,shape:i,slice:o,dtype:a,isPacked:l,texture:u}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let f;l?f=new qo(i,Bo):f=new Pi(i,Bo);const p=this.runWebGLProgram(f,[{dataId:e,shape:i,dtype:a}],a),v=this.readToGPU(p,t);return this.disposeIntermediateTensorInfo(p),v}if(u==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,t.customTexShape),h=Ni().makeTensorFromTensorInfo(c),d=this.texData.get(c.dataId);return Object.assign({tensorRef:h},d.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const r=t.map(s=>ca(s));return pt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return pt(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const r=e[t];if(!eie(r))throw me().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:r,isPacked:s}=this.texData.get(e),i=we(t);if(me().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const d=this.decode(e),f=this.texData.get(d.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...Ip(t)).subarray(0,i);return this.disposeIntermediateTensorInfo(d),p}const o=me().getBool("WEBGL_PACK")&&s===!0,a=o?Np(t):t,l=o?new goe(a):new moe(a),u=this.runWebGLProgram(l,[{shape:a,dtype:r,dataId:e}],"float32"),c=this.texData.get(u.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(u),h}timerAvailable(){return me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const i=hl(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=hl(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=t,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=b5(l),a.getExtraProfileInfo=()=>l.map((u,c)=>({name:o[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Or(),endMs:null}}endTimer(e){return me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Or(),e)}async getQueryTime(e){if(me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,t),this.disposeData(r.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:r,texShape:s,usage:i,isPacked:o,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),t!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(t,s,i,o)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=Xae){return me().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&we(r.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){fs("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return jae(e.shape,t)}packedUnaryOp(e,t,r){const s=new qo(e.shape,t),i=this.compileAndRun(s,[e],r);return Ni().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=SL(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(me().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,jI,e.dtype);const t=new Pi(e.shape,jI),r=this.compileAndRun(t,[e]);return Ni().makeTensorFromTensorInfo(r)}makeTensorInfo(e,t,r){let s;if(t==="string"&&r!=null&&r.length>0&&_d(r[0])){const i=r.map(o=>sa(o));s=this.write(i,e,t)}else s=this.write(r,e,t);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:t}}makeOutput(e,t,r){return Ni().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,r),this)}unpackTensor(e){const t=new Gae(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new _ae(e.shape),r=!0;return this.runWebGLProgram(t,[e],e.dtype,null,r)}packedReshape(e,t){const r=[tc(e.shape),...nc(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},i=[tc(t),...nc(t)],o=new IL(i,r),a=!0,l=[r],u=this.runWebGLProgram(o,[s],e.dtype,l,a);return{dataId:u.dataId,shape:t,dtype:u.dtype}}decode(e,t){const r=this.texData.get(e),{isPacked:s,shape:i,dtype:o}=r;if(t!=null){const d=we(i),f=t[0]*t[1]*4;O(d<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=Np(i);let l;s?l=new poe(a):l=new foe(a);const u=!0,c=[t??Ip(a)],h=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:e}],o,c,u,t);return{dtype:o,shape:i,dataId:h.dataId}}runWebGLProgram(e,t,r,s,i=!1,o){const a=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===nd.DENSE){const m=o??Ip(e.outputShape);l.texShape=m.map(y=>y*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),we(a.shape)===0)return l.values=pr(a.dtype,0),a;const u=[],c=t.map(m=>{if(m.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let y=this.texData.get(m.dataId);if(y.texture==null){if(!e.packedInputs&&we(m.shape)<=me().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:m.shape,texData:null,isUniform:!0,uniformValues:y.values};e.packedInputs&&(y.isPacked=!0,y.shape=m.shape)}if(this.uploadToGPU(m.dataId),!!y.isPacked!=!!e.packedInputs)m=y.isPacked?this.unpackTensor(m):this.packTensor(m),u.push(m),y=this.texData.get(m.dataId);else if(y.isPacked&&!ng(y.shape,m.shape)){const w=m,x=m.shape;m.shape=y.shape,m=this.packedReshape(m,x),u.push(m),y=this.texData.get(m.dataId),w.shape=x}return{shape:m.shape,texData:y,isUniform:!1}});this.uploadToGPU(a.dataId);const h={shape:a.shape,texData:l,isUniform:!1},d=doe(e,c,h),f=this.getAndSaveBinary(d,()=>coe(this.gpgpu,e,c,h)),p=this.activeTimers!=null;let v;p&&(v=this.startTimer()),me().get("ENGINE_COMPILE_ONLY")||hoe(this.gpgpu,f,c,h,s),u.forEach(m=>this.disposeIntermediateTensorInfo(m)),p&&(v=this.endTimer(v),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(v)}));const g=me().getNumber("WEBGL_FLUSH_THRESHOLD");if(g>0){const m=Or();m-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=m)}if(!me().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const m=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),m}return a}compileAndRun(e,t,r,s,i=!1){return r=r||t[0].dtype,this.runWebGLProgram(e,t,r,s,i)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(me().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=pe(()=>{if(!me().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=me().getBool("DEBUG");me().set("DEBUG",!1);const t=this.abs(At(1e-8)).dataSync()[0];if(me().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Hae:qae}uploadToGPU(e){const t=this.texData.get(e),{shape:r,dtype:s,values:i,texture:o,usage:a,isPacked:l}=t;if(o!=null)return;const u=this.activeTimers!=null;let c;u&&(c=Or());let h=t.texShape;if(h==null&&(h=yie(r,l),t.texShape=h),i!=null){const d=Np(r);let f,p=h[1],v=h[0];const g=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!g)&&([p,v]=wc(h[0],h[1])),l?f=new yoe(d,g):f=new UI(d,g);const m=g?[v,p]:h,y=this.makeTensorInfo(m,s),w=this.texData.get(y.dataId);g?w.usage=ms.PIXELS:w.usage=ms.UPLOAD,w.texShape=m,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),p,v,i);const x=[[v,p]],b=!0,C=this.runWebGLProgram(f,[y],s,x,b),k=this.texData.get(C.dataId);t.texShape=k.texShape,t.isPacked=k.isPacked,t.usage=k.usage,me().get("ENGINE_COMPILE_ONLY")?this.disposeData(C.dataId):(t.texture=k.texture,t.values=null,this.texData.delete(C.dataId)),this.disposeIntermediateTensorInfo(y),u&&(this.uploadWaitMs+=Or()-c)}else{const d=this.acquireTexture(h,a,s,l);t.texture=d}}convertAndCacheOnCPU(e,t){const r=this.texData.get(e),{dtype:s}=r;return t!=null&&(r.values=Qae(t,s)),r.values}acquireTexture(e,t,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,s)}computeBytes(e,t){return e[0]*e[1]*Nm(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(t),s(!0)}catch(i){throw i}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await mR(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(hL(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:r,infLoc:s,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:l}=gL(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,t,r){e.channels=e.channels||"RGBA";const{texture:s,height:i,width:o,channels:a}=e,l=Ni().backend;if(!l.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(s,t,r,i,o,a);return Ni().makeTensorFromDataId(u,t,r,l)}}kv.nextDataId=0;function Qae(n,e){if(e==="float32"||e==="complex64")return n;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let r=0;r<t.length;++r)t[r]=Math.round(n[r]);return t}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dA()&&bA("webgl",()=>new kv,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UC=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Sl{constructor(e,t,r){this.variableNames=["A","B"],this.outputShape=ut(t,r),this.enableShapeUniforms=vr(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vl=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Ec{constructor(e,t,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ut(t,r);const i=this.outputShape.length;this.enableShapeUniforms=vr(i);let o="";if(s)if(i===0||we(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${Ut(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=kr("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ss(n){const{inputs:e,backend:t}=n,{x:r}=e;return t.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Jae={kernelName:Xd,backendName:"webgl",kernelFunc:ss};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $a(n){const{inputs:e,backend:t}=n,{real:r,imag:s}=e,i=t.makeTensorInfo(r.shape,"complex64"),o=t.texData.get(i.dataId),a=ss({inputs:{x:r},backend:t}),l=ss({inputs:{x:s},backend:t});return o.complexTensorInfos={real:a,imag:l},i}const ele={kernelName:db,backendName:"webgl",kernelFunc:$a};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TL="return (a < 0.) ? b * a : a;",_L=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function tle(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{alpha:i}=r,o=t.makeTensorInfo([],"float32",Ca(i,"float32")),a=me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ec(_L,s.shape,o.shape):new Sl(TL,s.shape,o.shape),l=t.runWebGLProgram(a,[s,o],"float32");return t.disposeIntermediateTensorInfo(o),l}const nle={kernelName:x0,backendName:"webgl",kernelFunc:tle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NL="return (a < 0.) ? b * a : a;",$L=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function rle(n){const{inputs:e,backend:t}=n,{x:r,alpha:s}=e,i=me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ec($L,r.shape,s.shape):new Sl(NL,r.shape,s.shape);return t.runWebGLProgram(i,[r,s],"float32")}const sle={kernelName:M0,backendName:"webgl",kernelFunc:rle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ic="if (isnan(x)) return x;";function St({opSnippet:n,packedOpSnippet:e,cpuKernelImpl:t,dtype:r}){return({inputs:s,backend:i})=>{const{x:o}=s,a=i,l=r||o.dtype;if(a.shouldExecuteOnCPU([o])&&t!=null){const h=a.texData.get(o.dataId),d=t(h.values,l);return a.makeTensorInfo(o.shape,l,d)}const u=me().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new qo(o.shape,e):c=new Pi(o.shape,n),a.runWebGLProgram(c,[o],l)}}function ur({opSnippet:n,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:i}){return({inputs:o,backend:a})=>{const{a:l,b:u}=o,c=a;if(r&&l.dtype==="complex64"){const p=c.texData.get(l.dataId),v=c.texData.get(u.dataId),[g,m]=[[p.complexTensorInfos.real,v.complexTensorInfos.real],[p.complexTensorInfos.imag,v.complexTensorInfos.imag]].map(w=>{const[x,b]=w,C={dataId:x.dataId,dtype:x.dtype,shape:l.shape},k={dataId:b.dataId,dtype:b.dtype,shape:u.shape},E=new Sl(n,l.shape,u.shape);return c.runWebGLProgram(E,[C,k],ns(x.dtype,b.dtype))}),y=$a({inputs:{real:g,imag:m},backend:c});return c.disposeIntermediateTensorInfo(g),c.disposeIntermediateTensorInfo(m),y}const h=i||ns(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&s!=null){const p=c.texData.get(l.dataId).values,v=c.texData.get(u.dataId).values,g=l.dtype==="string"?Co(p):p,m=l.dtype==="string"?Co(v):v,[y,w]=s(l.shape,u.shape,g,m,h),x=c.makeTensorInfo(w,h),b=c.texData.get(x.dataId);return b.values=y,x}const d=me().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return d?f=new Ec(e,l.shape,u.shape,t):f=new Sl(n,l.shape,u.shape),c.runWebGLProgram(f,[l,u],h)}}function rd(n,e=!1){if(n==="linear")return e?Bae:Oae;if(n==="relu")return e?Uae:Lae;if(n==="elu")return e?zae:Fae;if(n==="relu6")return e?Vae:Pae;if(n==="prelu")return e?$L:NL;if(n==="leakyrelu")return e?_L:TL;if(n==="sigmoid")return e?Wae:Mae;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DL{constructor(e,t,r,s=!1,i=!1,o=!1,a=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=vr(this.outputShape.length);const c=s?e[1]:e[2],h=Math.ceil(c/2),d=s?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",p=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],v=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let g="",m="";a&&(l?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:u?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:g=`vec4 activation(vec4 x) {
          ${a}
        }`,m="result = activation(result);");const y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let w="rc.x",x="rc.x";e[0]<t[0]?w=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(x=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${h}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${w};
        int batchB = ${x};
        for (int i = 0; i < ${h}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${v[0]});
          result += (${p[1]} * ${v[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${y}

        ${m}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HI={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class qI{constructor(e,t,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ut(t,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KI="return a * b;";function VC(n){const{inputs:e,backend:t}=n,{a:r,b:s}=e,i=ns(r.dtype,s.dtype);if(r.dtype==="complex64"){const a=t.texData.get(r.dataId),l=t.texData.get(s.dataId),u=new qI(HI.REAL,r.shape,s.shape),c=new qI(HI.IMAG,r.shape,s.shape),h=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],d=t.runWebGLProgram(u,h,"float32"),f=t.runWebGLProgram(c,h,"float32"),p=$a({inputs:{real:d,imag:f},backend:t});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(f),p}if(t.shouldExecuteOnCPU([r,s])){const a=t.texData.get(r.dataId),l=t.texData.get(s.dataId),[u,c]=rae(r.shape,s.shape,a.values,l.values,i),h=t.makeTensorInfo(c,i),d=t.texData.get(h.dataId);return d.values=u,h}let o;return me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new Ec(KI,r.shape,s.shape):o=new Sl(KI,r.shape,s.shape),t.runWebGLProgram(o,[r,s],i)}const ile={kernelName:sf,backendName:"webgl",kernelFunc:VC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ole(n,e,t){const r=[tc(n.shape),...nc(n.shape)],s={dtype:n.dtype,shape:r,dataId:n.dataId},i=[tc(e),...nc(e)],o=new IL(i,r),a=!0,l=[r],u=t.runWebGLProgram(o,[s],n.dtype,l,a);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Be(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{shape:i}=r,o=t,a=we(s.shape),l=bD(i,a),u=we(l);O(a===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const c=o.texData.get(s.dataId);return c.isPacked&&!ng(s.shape,l)&&!(c.texture!==null&&ng(c.shape,l))?ole(s,l,o):(o.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype})}const ale={kernelName:z0,backendName:"webgl",kernelFunc:Be};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XI{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];const a=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(t!=null){const h=1/t;u=`sumValue += dot(values * ${ju(h)?h.toPrecision(2):h}, ones);`}let c="";i%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lle{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];let a="0.0",l="";t==="prod"?a="1.0":t==="min"?(a="1.0 / 1e-20",l="min"):t==="max"&&(a="-1.0 / 1e-20",l="max");let u=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,h=r%4;let d=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";t==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):t==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";i%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${c};
        if (${h===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ule(n){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:n[1],r=lv(t);e.push({inSize:t,windowSize:r,outSize:Math.ceil(t/r)})}return e}function Wl(n,e,t,r){const s=ule(n.shape);let i=n;for(let o=0;o<s.length;o++){const{inSize:a,windowSize:l,outSize:u}=s[o];let c,h;t==="mean"?c=o===0?new XI({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:u},a):new XI({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:u}):c=new lle({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:u},t),h=i,i=r.runWebGLProgram(c,[i],e),h.dataId!==n.dataId&&r.disposeIntermediateTensorInfo(h)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cle{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[t[o]];this.outputShape=r,this.rank=r.length;const s=Ut(this.rank),i=hle(t);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function hle(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<n.length;s++)r[n[s]]=t[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dle{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let c=0;c<r.length;c++)r[c]=e[t[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=Ut(this.rank),i=EL("rc",this.rank),o=new Array(this.rank);for(let c=0;c<t.length;c++)o[t[c]]=i[c];const a=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ev(n,e,t){const r=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new dle(n.shape,e):new cle(n.shape,e);return t.runWebGLProgram(r,[n],n.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fle(n,e,t,r){const s=e,i=n.shape.length,o=mt(s,n.shape);let a=o;const l=un(a,i),u=l!=null;let c=n;u&&(c=Ev(n,l,r),a=wn(a.length,i)),lr("sum",a,i);const[h,d]=Jn(c.shape,a);let f=h;t&&(f=Rn(h,o));const p=we(d),g=we(n.shape)/p,m=Be({inputs:{x:c},attrs:{shape:[g,p]},backend:r}),y=qb(n.dtype),w=Wl(m,y,"sum",r),x=Be({inputs:{x:w},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(w),u&&r.disposeIntermediateTensorInfo(c),x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iv(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r;return fle(s,i,o,t)}const ple={kernelName:H0,backendName:"webgl",kernelFunc:Iv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _r(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{perm:i}=r,o=t,a=s.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=s.shape[i[c]];let u;if(o.shouldExecuteOnCPU([s])){const h=o.texData.get(s.dataId).values,d=zC(h,s.shape,s.dtype,i,l);u=o.makeTensorInfo(l,s.dtype);const f=o.texData.get(u.dataId);f.values=d}else u=Ev(s,i,o);return u}const mle={kernelName:Du,backendName:"webgl",kernelFunc:_r};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AL=1e3;function rg({a:n,b:e,transposeA:t,transposeB:r,backend:s,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const u=n.shape.length,c=e.shape.length,h=t?n.shape[u-2]:n.shape[u-1],d=r?e.shape[c-1]:e.shape[c-2],f=t?n.shape[u-1]:n.shape[u-2],p=r?e.shape[c-2]:e.shape[c-1],v=n.shape.slice(0,-2),g=e.shape.slice(0,-2),m=we(v),y=we(g),x=ut(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);O(h===d,()=>`Error in matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${r} must match.`);const b=t?[m,h,f]:[m,f,h],C=r?[y,p,d]:[y,d,p],k=Be({inputs:{x:n},backend:s,attrs:{shape:b}}),E=Be({inputs:{x:e},backend:s,attrs:{shape:C}}),T=[k,E],_=Math.max(m,y),A=t?k.shape[1]:k.shape[2],P=i!=null,j=o!=null,X=l==="leakyrelu",F=l!=null?rd(l,!0):null,M=P||j||X||F!=null;let W;if((f===1||p===1)&&A>AL&&M===!1){let z=k,K=E;t&&(z=_r({inputs:{x:k},backend:s,attrs:{perm:[0,2,1]}}),T.push(z)),r&&(K=_r({inputs:{x:E},backend:s,attrs:{perm:[0,2,1]}}),T.push(K));const ie=p!==1,V=p===1;let Z=z;ie&&(Z=Be({inputs:{x:z},backend:s,attrs:{shape:[_,A,1]}}),T.push(Z));const de=p===1?2:1;let ge=K;V&&(ge=Be({inputs:{x:K},backend:s,attrs:{shape:[_,1,A]}}),T.push(ge));const ye=VC({inputs:{a:Z,b:ge},backend:s});W=Iv({inputs:{x:ye},backend:s,attrs:{axis:de,keepDims:!0}}),T.push(ye)}else{const z=ns(n.dtype,e.dtype),K=new DL(b,C,[_,f,p],t,r,P,F,j,X),ie=[k,E];if(i!=null&&ie.push(i),j&&ie.push(o),X){const V=s.makeTensorInfo([],"float32",Ca(a,"float32"));ie.push(V),T.push(V)}W=s.runWebGLProgram(K,ie,z)}const D=Be({inputs:{x:W},backend:s,attrs:{shape:x}});T.push(W);for(const z of T)s.disposeIntermediateTensorInfo(z);return D}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gle(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:h}=r;return rg({a:s,b:i,transposeA:l,transposeB:u,backend:t,bias:o,preluActivationWeights:a,leakyreluAlpha:h,activation:c})}const vle={kernelName:$m,backendName:"webgl",kernelFunc:gle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YI="return abs(x);";function yle(n){const{inputs:e,backend:t}=n,{x:r}=e;if(t.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const i=t.texData.get(r.dataId),o=SL(i.values);return t.makeTensorInfo(r.shape,r.dtype,o)}let s;return me().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new qo(r.shape,YI):s=new Pi(r.shape,YI),t.runWebGLProgram(s,[r],r.dtype)}const xle={kernelName:Jg,backendName:"webgl",kernelFunc:yle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wle=Ys+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,ble=St({opSnippet:wle}),Cle={kernelName:Nd,backendName:"webgl",kernelFunc:ble};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sle=Ys+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,kle=St({opSnippet:Sle}),Ele={kernelName:$d,backendName:"webgl",kernelFunc:kle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZI="return a + b;",Ile=ur({opSnippet:ZI,packedOpSnippet:ZI,supportsComplex:!0,cpuKernelImpl:Loe}),Tle={kernelName:pc,backendName:"webgl",kernelFunc:Ile};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _le{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`float v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nle{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`vec4 v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xp(n){const{inputs:e,backend:t}=n,r=e;if(r.length===1)return ss({inputs:{x:r[0]},backend:t});if(r.length>me().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),u=Xp({inputs:r.slice(0,l),backend:t}),c=Xp({inputs:r.slice(l),backend:t});return Xp({inputs:[u,c],backend:t})}const s=r.map(l=>l.dtype).reduce((l,u)=>ns(l,u)),i=r.map(l=>l.shape),a=me().getBool("WEBGL_PACK")?new Nle(r[0].shape,i):new _le(r[0].shape,i);return t.runWebGLProgram(a,r,s)}const $le={kernelName:ib,backendName:"webgl",kernelFunc:Xp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dle(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=mt(i,s.shape);let u=l;const c=un(u,a);let h=s;c!=null&&(h=_r({inputs:{x:s},backend:t,attrs:{perm:c}}),u=wn(u.length,a)),lr("all",u,a);const[d,f]=Jn(h.shape,u),p=we(f),v=Be({inputs:{x:h},backend:t,attrs:{shape:[-1,p]}}),g=Wl(v,v.dtype,"all",t);let m;if(o){const y=Rn(d,l);m=Be({inputs:{x:g},backend:t,attrs:{shape:y}})}else m=Be({inputs:{x:g},backend:t,attrs:{shape:d}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(g),c!=null&&t.disposeIntermediateTensorInfo(h),m}const Ale={kernelName:ob,backendName:"webgl",kernelFunc:Dle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rle(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=mt(i,s.shape);let u=l;const c=un(u,a);let h=s;c!=null&&(h=_r({inputs:{x:s},backend:t,attrs:{perm:c}}),u=wn(u.length,a)),lr("any",u,a);const[d,f]=Jn(h.shape,u),p=we(f),v=Be({inputs:{x:h},backend:t,attrs:{shape:[-1,p]}}),g=Wl(v,v.dtype,"any",t);let m;if(o){const y=Rn(d,l);m=Be({inputs:{x:g},backend:t,attrs:{shape:y}})}else m=Be({inputs:{x:g},backend:t,attrs:{shape:d}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(g),c!=null&&t.disposeIntermediateTensorInfo(h),m}const Ole={kernelName:ab,backendName:"webgl",kernelFunc:Rle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fle{constructor(e,t,r){this.variableNames=["A"];const{windowSize:s,batchSize:i,outSize:o}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=t==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lle{constructor(e,t,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,O(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/t);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,u=Ut(l),c=kr("coords",l);let h,d;if(o===1){d=l+1;const E=Ut(d);h=`
        ${E} sourceLocR = ${E}(${c.join()}, 0);
        ++${c[l-1]};
        ${E} sourceLocG = ${E}(${c.join()}, 0);
        ++${c[l-2]};
        ${E} sourceLocA = ${E}(${c.join()}, 0);
        --${c[l-1]};
        ${E} sourceLocB = ${E}(${c.join()}, 0);
        --${c[l-2]};`}else d=l,h=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,d),p="."+f[d-1],v=f.map(E=>"int "+E),g=kr("sourceLocR",d-1).concat("inIdx.r"),m=kr("sourceLocG",d-1).concat("inIdx.g"),y=kr("sourceLocB",d-1).concat("inIdx.b"),w=kr("sourceLocA",d-1).concat("inIdx.a"),x=r==="max"?"greaterThan":"lessThan",b=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${m.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${w.join()})));`,C=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${m.join()}) : 0.,
            hasNextRow ? getAChannel(${y.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${w.join()}) : 0.)`,k=s?"":`
      float getBestIndicesAChannel(${v.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${v.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${k}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${a[l-2]-1};
        ${h}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${C};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${b}
          vec4 candidate = ${C};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${x}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RL(n,e,t,r=null){let s=e.shape[0],i=e.shape[1];r!=null&&(s=r.shape[0],i=r.shape[1]);const o=lv(i),a={windowSize:o,inSize:i,batchSize:s,outSize:Math.ceil(i/o)},l=new Fle(a,t,r==null),u=[e];r!=null&&u.push(r);const c=n.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const h=RL(n,e,t,c);return n.disposeIntermediateTensorInfo(c),h}function OL(n,e,t,r=null){const s=r!=null?r.shape:e.shape,i=s[s.length-1],o=lv(i),a=new Lle(s,o,t,r==null),l=r==null?[e]:[e,r],u=n.runWebGLProgram(a,l,"int32");if(u.shape.length===e.shape.length){const c=OL(n,e,t,u);return n.disposeIntermediateTensorInfo(u),c}return u}function FL(n,e,t,r){const s=[t];if(lr("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!me().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=n.texData.get(e.dataId),a=o!==null&&o.isPacked;let l=e;a&&(l=n.unpackTensor(e),i.push(l));const[u,c]=Jn(l.shape,s),h=we(c),d=Be({inputs:{x:l},backend:n,attrs:{shape:[-1,h]}});i.push(d);const f=RL(n,d,r);i.push(f);const p=Be({inputs:{x:f},backend:n,attrs:{shape:u}});return i.forEach(v=>n.disposeIntermediateTensorInfo(v)),p}return OL(n,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ple(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;let o=mt(i,s.shape);const a=un(o,s.shape.length);let l=s;const u=[];a!=null&&(l=_r({inputs:{x:s},backend:t,attrs:{perm:a}}),u.push(l),o=wn(o.length,l.shape.length)),lr("argMax",[o[0]],l.shape.length);const c=FL(t,l,o[0],"max");return u.forEach(h=>t.disposeIntermediateTensorInfo(h)),c}const Mle={kernelName:e0,backendName:"webgl",kernelFunc:Ple};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ble(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;let o=mt(i,s.shape);const a=un(o,s.shape.length);let l=s;const u=[];a!=null&&(l=_r({inputs:{x:s},backend:t,attrs:{perm:a}}),u.push(l),o=wn(o.length,l.shape.length)),lr("argMin",[o[0]],l.shape.length);const c=FL(t,l,o[0],"min");return u.forEach(h=>t.disposeIntermediateTensorInfo(h)),c}const zle={kernelName:t0,backendName:"webgl",kernelFunc:Ble};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ule=Ys+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Vle=St({opSnippet:Ule}),Wle={kernelName:Dd,backendName:"webgl",kernelFunc:Vle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gle=Ys+"return log(x + sqrt(x * x + 1.0));",jle=St({opSnippet:Gle}),Hle={kernelName:Ad,backendName:"webgl",kernelFunc:jle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qle=Ys+`
  return atan(x);
`,Kle=St({opSnippet:qle}),Xle={kernelName:Rd,backendName:"webgl",kernelFunc:Kle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yle=UC+`
  return atan(a, b);
`,Zle=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Vl+`
  return result;
`,Qle=ur({opSnippet:Yle,packedOpSnippet:Zle}),Jle={kernelName:Fd,backendName:"webgl",kernelFunc:Qle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eue=Ys+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,tue=St({opSnippet:eue}),nue={kernelName:Od,backendName:"webgl",kernelFunc:tue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sd{constructor(e,t,r,s=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const v=t==="avg",g=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,m=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let y="0.0";if(v||(y="-1.0 / 1e-20"),r){const E=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${h};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${E} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?i?g:m:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let x=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(x="avgValue / max(count, 1.0)");const b=Math.floor(o/4)*4,C=o%4,k=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${h};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${b}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${k}
          }

          int xC = xCCorner + ${b};
          if (${C===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${k}
          } else if (${C===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${k}
          } else if (${C===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${k}
          }
        }
        setOutput(${x});
      }
    `}}class WC{constructor(e,t,r,s=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,h=e.dilationHeight,d=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,v=e.effectiveFilterWidth,g=e.padInfo.front,m=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const w=t==="avg";let x="0.0";if(w||(x="-1.0 / 1e-20"),r){const _=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${u});
        const ivec3 pads = ivec3(${g}, ${m}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${h}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${v};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${_} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${v} +
                      wR * ${v} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let C=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(C="avgValue / max(count, 1.0)");const k=Math.floor(o/4)*4,E=o%4,T=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${u});
      const ivec3 pads = ivec3(${g}, ${m}, ${y});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${h}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${k}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${T}
            }

            int xC = xCCorner + ${k};
            if (${E===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${T}
            } else if (${E===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${T}
            } else if (${E===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${T}
            }
          }
        }
        setOutput(${C});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rue(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;Wf(s,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;O(gr(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ks(s.shape,i,o,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&Nt(c.inShape,c.outShape))return ss({inputs:{x:s},backend:t});const h=new sd(c,"avg",!1);return t.runWebGLProgram(h,[s],"float32")}const sue={kernelName:n0,backendName:"webgl",kernelFunc:rue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iue(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],h=To(s.shape,i,o,c,a,l,u),d=new WC(h,"avg",!1);return t.runWebGLProgram(d,[s],"float32")}const oue={kernelName:r0,backendName:"webgl",kernelFunc:iue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aue{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,h=u-1-e.padInfo.left,d=1/(t*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${h});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class lue{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,h=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=h-1-e.padInfo.front,v=d-1-e.padInfo.top,g=f-1-e.padInfo.left,m=1/(t*r*s);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${v}, ${g});
      const float avgMultiplier = float(${m});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uue(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,o=i,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,h=[1,1,1],d=To(o.shape,a,l,h,u,c),f=new lue(d);return t.runWebGLProgram(f,[s],o.dtype)}const cue={kernelName:ub,backendName:"webgl",kernelFunc:uue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hue(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,o=i;Wf([s,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=Ks(o.shape,a,l,1,u),h=new aue(c);return t.runWebGLProgram(h,[s],o.dtype)}const due={kernelName:lb,backendName:"webgl",kernelFunc:hue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fue(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;return rg({a:s,b:i,transposeA:o,transposeB:a,backend:t})}const pue={kernelName:s0,backendName:"webgl",kernelFunc:fue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mue{constructor(e,t,r,s,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],ut(e,t),ut(e,r);let a="0.0";s!=null&&(ut(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(ut(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gue{constructor(e,t,r,s,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ut(e,t),ut(e,r);let a="vec4(0.0)";s!=null&&(ut(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(ut(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vue=({inputs:n,backend:e,attrs:t})=>{const{x:r,mean:s,variance:i,offset:o,scale:a}=n;O(s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),O(o==null||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),O(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=t;l==null&&(l=.001);const u=[r,s,i];let c=null;o!=null&&(c=o.shape,u.push(o));let h=null;a!=null&&(h=a.shape,u.push(a));const d=me().getBool("WEBGL_PACK_NORMALIZATION")?new gue(r.shape,s.shape,i.shape,c,h,l):new mue(r.shape,s.shape,i.shape,c,h,l);return e.runWebGLProgram(d,u,u[0].dtype)},yue={kernelName:g0,backendName:"webgl",kernelFunc:vue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xue{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=Ut(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=wue(this.rank);let s;const i=e.map((o,a)=>`sourceLoc.${N1[a]} = start[${a}] + coords.${N1[a]};`);s=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const N1=["x","y","z","w","u","v"];function wue(n){if(n===1)return"sourceLoc";if(n<=6)return N1.slice(0,n).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bue{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=Ut(this.rank),r=kr("coords",this.rank),s=kr("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,o=`getChannel(getSource(${s.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${o};
        --${s[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${o};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${o};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((c,h)=>`start[${h}]`).join()});`:e.map((c,h)=>`${s[h]} = ${r[h]} + start[${h}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cue(n,e,t,r){const s=r.texData.get(n.dataId),i=r.makeTensorInfo(t,n.dtype),o=r.texData.get(i.dataId);Object.assign(o,s),o.refCount=1,o.shape=t,o.dtype=n.dtype;let a=M2(e,Qe(n.shape));s.slice&&(a+=s.slice.flatOffset),o.slice={flatOffset:a,origDataId:s.slice&&s.slice.origDataId||n.dataId};const l=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,l+1),i}function Tc(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,size:o}=r,[a,l]=av(s,i,o);if(F2(s,a,l),we(l)===0)return t.makeTensorInfo(l,s.dtype,[]);if(t.shouldExecuteOnCPU([s])||s.dtype==="string"){const h=t.texData.get(s.dataId),d=pae(h.values,a,l,s.shape,s.dtype);return t.makeTensorInfo(l,s.dtype,d)}const{isPacked:u}=t.texData.get(s.dataId),c=P2(s.shape,a,l);if(u||!c){const h=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new bue(l):new xue(l),d=[a];return t.runWebGLProgram(h,[s],s.dtype,d)}return t.uploadToGPU(s.dataId),Cue(s,a,l,t)}const Sue={kernelName:j0,backendName:"webgl",kernelFunc:Tc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kue=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,crops:o}=r;O(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((y,w)=>y*w),l=$f(s.shape,i,a),u=Df(l.length,i.length),c=Af(s.shape,i,a),h=W2(o,i.length),d=G2(c,o,i.length),f=[],p=Be({inputs:{x:s},backend:t,attrs:{shape:l}}),v=_r({inputs:{x:p},backend:t,attrs:{perm:u}}),g=Be({inputs:{x:v},backend:t,attrs:{shape:c}}),m=Tc({inputs:{x:g},backend:t,attrs:{begin:h,size:d}});return f.push(p),f.push(v),f.push(g),f.forEach(y=>t.disposeIntermediateTensorInfo(y)),m},Eue={kernelName:i0,backendName:"webgl",kernelFunc:kue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iue(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:o}=r,a=t.readSync(s.dataId),l=t.readSync(i.dataId),u=CL(a,l,i.dtype,i.shape,o);return t.makeTensorInfo([o],i.dtype,u)}const Tue={kernelName:cb,backendName:"webgl",kernelFunc:Iue};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ue=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Nue=`
  return float(int(a.r) & int(b.r));
`;function $ue(n){const{inputs:e,backend:t}=n,{a:r,b:s}=e,i=me().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=me().getNumber("WEBGL_VERSION");if(t.shouldExecuteOnCPU([r,s])||o===1){const l=t.texData.get(r.dataId).values,u=t.texData.get(s.dataId).values,[c,h]=Moe(r.shape,s.shape,l,u,r.dtype),d=t.makeTensorInfo(h,r.dtype),f=t.texData.get(d.dataId);return f.values=c,d}let a;return i?a=new Ec(_ue,r.shape,s.shape,!1):a=new Sl(Nue,r.shape,s.shape),t.runWebGLProgram(a,[r,s],r.dtype)}const Due={kernelName:hb,backendName:"webgl",kernelFunc:$ue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aue(n){const{inputs:e,backend:t}=n,{s0:r,s1:s}=e,i=t.readSync(r.dataId),o=t.readSync(s.dataId),a=ut(Array.from(i),Array.from(o));return t.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Rue={kernelName:TD,backendName:"webgl",kernelFunc:Aue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oue="return float(a != b);",LL=ur({opSnippet:Oue,cpuKernelImpl:iae,dtype:"bool"}),Fue={kernelName:R0,backendName:"webgl",kernelFunc:LL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jf(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.texData.get(r.dataId);return ss({inputs:{x:s.complexTensorInfos.real},backend:t})}const Lue={kernelName:Lb,backendName:"webgl",kernelFunc:jf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pue="return float(int(x));";function Mue(n,e){const t=new Pi(n.shape,Pue),r=e.runWebGLProgram(t,[n],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $1(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return ss({inputs:{x:s},backend:t});const o=Yn(s.shape),a=$1({inputs:{x:s},backend:t,attrs:{dtype:"float32"}}),l=$a({inputs:{real:a,imag:o},backend:t});return o.dispose(),t.disposeIntermediateTensorInfo(a),l}if(s.dtype==="complex64"){const o=jf({inputs:{input:s},backend:t}),a=$1({inputs:{x:o},backend:t,attrs:{dtype:i}});return t.disposeIntermediateTensorInfo(o),a}if(!CD(s.dtype,i)){const o=ss({inputs:{x:s},backend:t});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(t.shouldExecuteOnCPU([s])){const o=t.texData.get(s.dataId).values,[a,l,u]=Boe(o,s.shape,s.dtype,i);return t.makeTensorInfo(a,l,u)}if(i==="int32")return Mue(s,t);if(i==="bool"){const o=t.makeTensorInfo([],"bool",pr("bool",1)),l=LL({inputs:{a:s,b:o},backend:t});return t.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${i}`)}const Bue={kernelName:Ld,backendName:"webgl",kernelFunc:$1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QI="return ceil(x);",zue=St({opSnippet:QI,packedOpSnippet:QI,cpuKernelImpl:zoe}),Uue={kernelName:Pd,backendName:"webgl",kernelFunc:zue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vue{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wue{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gue(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{clipValueMin:i,clipValueMax:o}=r;let a;me().getBool("WEBGL_PACK_CLIP")?a=new Wue(s.shape):a=new Vue(s.shape);const l=[[i],[o]];return t.runWebGLProgram(a,[s],s.dtype,l)}const jue={kernelName:Md,backendName:"webgl",kernelFunc:Gue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hue{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JI(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function que(n){const{inputs:e,backend:t}=n,{x:r}=e,s=t.texData.get(r.dataId),i=new Hue(r.shape),o=[JI(r,s.complexTensorInfos.real),JI(r,s.complexTensorInfos.imag)];return t.runWebGLProgram(i,o,o[0].dtype)}const Kue={kernelName:o0,backendName:"webgl",kernelFunc:que};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xue{constructor(e){this.outputShape=[],this.outputShape=Gi(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let o=1;o<t.length;o++)t[o]=t[o-1]+e[o][1];const r=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<t.length;o++){const a=t[o-1];r.push(`else if (yC < ${t[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const s=t.length,i=t[t.length-1];r.push(`else setOutput(getT${s}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yue{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Gi(e,t);const r=this.outputShape,s=r.length,i=Ut(s),o=kr("coords",s),a=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((v,g)=>`T${g}`);const l=new Array(e.length-1);l[0]=e[0][t];for(let v=1;v<l.length;v++)l[v]=l[v-1]+e[v][t];const u=a[t],c=a.slice(-2),h=a.join();let d=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${h}), vec2(${c.join()}));
        }`;for(let v=1;v<l.length;v++){const g=l[v-1];d+=`
        if (${u} < ${l[v]}  && ${u} >= ${l[v-1]}) {
          return getChannel(
            getT${v}(${Ap(a,u,g)}),
            vec2(${Ap(c,u,g)}));
        }`}const f=l.length,p=l[l.length-1];d+=`
        return getChannel(
          getT${f}(${Ap(a,u,p)}),
          vec2(${Ap(c,u,p)}));`,this.userCode=`
      float getValue(${a.map(v=>"int "+v)}) {
        ${d}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[s-1]} = ${o[s-1]} + 1;
        if (${o[s-1]} < ${r[s-1]}) {
          result.g = getValue(${o});
        }

        ${o[s-2]} = ${o[s-2]} + 1;
        if (${o[s-2]} < ${r[s-2]}) {
          result.a = getValue(${o});
        }

        ${o[s-1]} = ${o[s-1]} - 1;
        if (${o[s-2]} < ${r[s-2]} &&
            ${o[s-1]} < ${r[s-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function Ap(n,e,t){const r=n.indexOf(e);return n.map((i,o)=>o===r?`${i} - ${t}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tv(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.texData.get(r.dataId);return ss({inputs:{x:s.complexTensorInfos.imag},backend:t})}const Zue={kernelName:_b,backendName:"webgl",kernelFunc:Tv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uh(n,e,t){const r=n[0].dtype;if(r==="complex64"){const f=n.map(y=>jf({inputs:{input:y},backend:t})),p=n.map(y=>Tv({inputs:{input:y},backend:t})),v=uh(f,e,t),g=uh(p,e,t),m=$a({inputs:{real:v,imag:g},backend:t});return f.forEach(y=>t.disposeIntermediateTensorInfo(y)),p.forEach(y=>t.disposeIntermediateTensorInfo(y)),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(g),m}let s=t.shouldExecuteOnCPU(n);if(r==="string"&&(s=!0),s){const f=n.map(x=>{const C=[-1,we(x.shape.slice(e))];return Be({inputs:{x},backend:t,attrs:{shape:C}})}),p=f.map(x=>({vals:t.readSync(x.dataId),shape:x.shape})),v=Gi(f.map(x=>x.shape),1),g=f[0].shape[0]===1,m=Uoe(p,v,r,g),y=Gi(n.map(x=>x.shape),e),w=t.makeTensorInfo(y,r,m);return f.forEach(x=>t.disposeIntermediateTensorInfo(x)),w}const i=n.filter(f=>we(f.shape)>0),o=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const f=o?new Pi(n[0].shape,Bo):new qo(n[0].shape,Bo);return t.runWebGLProgram(f,n,r)}const a=me().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const f=[];for(let v=0;v<i.length;v+=a){const g=i.slice(v,v+a);f.push(uh(g,e,t))}const p=uh(f,e,t);for(const v of f)t.disposeIntermediateTensorInfo(v);return p}if(o){const f=new Yue(i.map(p=>p.shape),e);return t.runWebGLProgram(f,i,r)}const{tensors2D:l,outShape:u}=Que(i,e,t),c=new Xue(l.map(f=>f.shape)),h=t.runWebGLProgram(c,l,r);l.forEach(f=>t.disposeIntermediateTensorInfo(f));const d=Be({inputs:{x:h},attrs:{shape:u},backend:t});return t.disposeIntermediateTensorInfo(h),d}function Que(n,e,t){const r=Gi(n.map(i=>i.shape),e);return{tensors2D:n.map(i=>Be({inputs:{x:i},attrs:{shape:[-1,we(i.shape.slice(e))]},backend:t})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PL(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r,i=mt(s,e[0].shape)[0],o=e.map(u=>u.shape);z2(o,i);const a=Gi(e.map(u=>u.shape),i);if(we(a)===0)return t.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>we(u.shape)>0);return l.length===1?ss({inputs:{x:l[0]},backend:t}):uh(l,i,t)}const Jue={kernelName:a0,backendName:"webgl",kernelFunc:PL};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ML{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,h=e.dilationWidth,d=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,v=e.inChannels%4,g=e.dataFormat==="channelsLast",m=g?1:2,y=g?2:3,w=g?3:1;let x="",b="";r&&(s?x=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?x=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:x=`
          float activation(float x) {
            ${r}
          }
        `,b="result = activation(result);");const C=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${x}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${w}];

        ivec2 xRCCorner =
            ivec2(coords[${m}], coords[${y}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${h};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${v===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${v===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${v===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${C}
        ${b}
        setOutput(result);
      }
    `}}class ece{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,h=e.filterDepth,d=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,v=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${t}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${h}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${v===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${v===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${v===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BL{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=vr(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,h=c;let d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<c;g++)d+=`
           vec4 xTexelC${g*2};
           int xTexelC${g*2}Ready;
           vec4 xTexelC${g*2+1};
           int xTexelC${g*2+1}Ready;
           vec4 xC${g};`;d+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let g=0;g<c;g++)d+=`
           xTexelC${g*2} = vec4(0.0);
           xTexelC${g*2}Ready = 0;
           xTexelC${g*2+1} = vec4(0.0);
           xTexelC${g*2+1}Ready = 0;
           xC${g} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let g=0;g<(h+1)/2;g++){const m=g*2;if(d+=`
           xC = xCCorner + ${m*l};
           `,a===1){if(m<c&&(o%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }
               `,l===1&&m>0?d+=`
                 xC${m} = vec4(xTexelC${m-2}.zw, xTexelC${m}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${m} = vec4(previous.zw, xTexelC${m}.xy);
                   } else {
                     xC${m} = vec4(0.0, 0.0, xTexelC${m}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }

                 xC${m} = xTexelC${m};
                 `,m+1<c)){const y=o%2===0?eb(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${y};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                     xTexelC${m+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${m+1}.zw = vec2(0.0);
                     }
                     xTexelC${m+1}Ready = 1;
                   }
                   `,l>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${m+1} = vec4(previous.zw, xTexelC${m+1}.xy);
                     } else {
                      xC${m+1} = vec4(0.0, 0.0, xTexelC${m+1}.xy);
                     }
                     `:d+=`
                     xC${m+1} = vec4(xTexelC${m}.zw, xTexelC${m+1}.xy);
                     `):y===1?d+=`
                     xC${m+1} = xTexelC${m};
                     `:d+=`
                     xCOffset = xC + ${y};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                       xTexelC${m+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${m+1}.zw = vec2(0.0);
                       }
                       xTexelC${m+1}Ready = 1;
                     }

                     xC${m+1} = xTexelC${m+1};
                     `}}else m<c&&(o%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${m+1}Ready == 0) {
                   xTexelC${m+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${m+1}.zw = vec2(0.0);
                   }
                   xTexelC${m+1}Ready = 1;
                 }

                 xC${m} = vec4(xTexelC${m}.zw, xTexelC${m+1}.zw);
               `,m+1<c&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${m+1} = vec4(xTexelC${m+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                   xTexelC${m+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${m+1}.zw = vec2(0.);
                   }
                   xTexelC${m+1}Ready = 1;
                 }

                 xC${m} = vec4(
                   xTexelC${m}.xy, xTexelC${m+1}.xy);
               `,m+1<c&&(d+=`
                   xC${m+1} = vec4(xTexelC${m}.zw, xTexelC${m+1}.zw);
                 `)));m<c&&(d+=`
             wTexel = getW(r, ${m}, d1, d2);
             dotProd += xC${m}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${m}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,m+1<c&&(d+=`
               wTexel = getW(r, ${m+1}, d1, d2);
               dotProd += xC${m+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${m+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let f="",p="";r&&(s?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:i?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:f=`vec4 activation(vec4 x) {
           ${r}
         }`,p="result = activation(result);");const v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${v}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tce{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=vr(this.outputShape.length);const{dataFormat:r}=t,s=Dr(),i=r==="channelsLast",o=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let h=0;h<=1;h++)u+=`
          blockIndex = rc.z + ${h};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+h}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+h}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sg(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function zL({x:n,filter:e,convInfo:t,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=n.shape,u=r.texData.get(n.dataId),c=t.inChannels,h=l[0]*l[1]*l[2],d=t.outChannels,f=t.dataFormat==="channelsLast",p=!1,v=!1;let g;const m=[];if(i!=null){const x=sg(i.shape,f);x!=null&&(i=Be({inputs:{x:i},backend:r,attrs:{shape:x}}),m.push(i))}if(s!=null){const x=sg(s.shape,f);x!=null&&(s=Be({inputs:{x:s},backend:r,attrs:{shape:x}}),m.push(s))}if(!((h===1||d===1)&&c>AL)&&u.isPacked&&f&&u.texture!=null&&l[2]%2!==0&&Nt(u.shape.slice(-3),l.slice(-3))){const x=l[0]*l[1]*(l[2]+1),b={dataId:n.dataId,shape:[1,x,t.inChannels],dtype:n.dtype},C=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,O(ng(u.shape,b.shape),()=>`packed reshape ${u.shape} to ${b.shape} isn't free`);const k=Be({inputs:{x:e},backend:r,attrs:{shape:[1,t.inChannels,t.outChannels]}});m.push(k);const E=rg({a:b,b:k,backend:r,transposeA:p,transposeB:v,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),T=r.texData.get(E.dataId);O(T.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=C,T.shape=t.outShape,g=ss({inputs:{x:E},backend:r}),g.shape=t.outShape,m.push(E)}else{const x=t.outHeight*t.outWidth,b=Be({inputs:{x:n},backend:r,attrs:{shape:f?[t.batchSize,x,t.inChannels]:[t.batchSize,t.inChannels,x]}}),C=Be({inputs:{x:e},backend:r,attrs:{shape:[1,t.inChannels,t.outChannels]}}),k=rg({a:f?b:C,b:f?C:b,transposeA:!f,transposeB:v,backend:r,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o});g=Be({inputs:{x:k},backend:r,attrs:{shape:t.outShape}}),m.push(b),m.push(C),m.push(k)}for(const x of m)r.disposeIntermediateTensorInfo(x);return g}function UL({x:n,filter:e,convInfo:t,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:h,outHeight:d,dataFormat:f}=t,p=f==="channelsLast",v=l*u*c,g=d*h,m=[t.batchSize,v,g],y=!0,w=!1,x=[];if(i!=null){const D=sg(i.shape,p);D!=null&&(i=Be({inputs:{x:i},backend:r,attrs:{shape:D}}),x.push(i))}if(s!=null){const D=sg(s.shape,p);D!=null&&(s=Be({inputs:{x:s},backend:r,attrs:{shape:D}}),x.push(s))}const b=Be({inputs:{x:e},backend:r,attrs:{shape:[1,v,we(e.shape)/v]}});x.push(b);const C=new tce(m,t),k=[n.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],E=r.runWebGLProgram(C,[n],"float32",k),T=Be({inputs:{x:E},backend:r,attrs:{shape:m}});x.push(E),x.push(T);const _=s!=null,A=i!=null,P=a==="leakyrelu",j=a?rd(a,!0):null,X=new DL(p?T.shape:b.shape,p?b.shape:T.shape,p?[t.batchSize,g,t.outChannels]:[t.batchSize,t.outChannels,g],y,w,_,j,A,P),F=p?[T,b]:[b,T];if(s&&F.push(s),A&&F.push(i),P){const D=r.makeTensorInfo([],"float32",Ca(o,"float32"));F.push(D),x.push(D)}const M=r.runWebGLProgram(X,F,"float32"),W=Be({inputs:{x:M},backend:r,attrs:{shape:t.outShape}});x.push(M);for(const D of x)r.disposeIntermediateTensorInfo(D);return W}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r,h=_o(l),d=ar(s.shape,i.shape,o,u,a,c,!1,h);let f;if(d.filterHeight===1&&d.filterWidth===1&&d.dilationHeight===1&&d.dilationWidth===1&&d.strideHeight===1&&d.strideWidth===1&&(d.padInfo.type==="SAME"||d.padInfo.type==="VALID"))f=zL({x:s,filter:i,convInfo:d,backend:t});else if(d.strideWidth<=2&&h==="channelsLast"&&me().getBool("WEBGL_EXP_CONV")){const v=new BL(d),g=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];f=t.runWebGLProgram(v,[s,i],"float32",g)}else if(me().getBool("WEBGL_CONV_IM2COL"))f=UL({x:s,filter:i,convInfo:d,backend:t});else{const v=new ML(d);f=t.runWebGLProgram(v,[s,i],"float32")}const p=Be({inputs:{x:f},backend:t,attrs:{shape:d.outShape}});return t.disposeIntermediateTensorInfo(f),p}const rce={kernelName:l0,backendName:"webgl",kernelFunc:nce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sce{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ice{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=t-1-e.padInfo.top,l=r-1-e.padInfo.left,u=o?1:2,c=o?2:3,h=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${h}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class oce{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ace{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=t-1-e.padInfo.front,u=r-1-e.padInfo.top,c=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,h=_o(l),d=ar(s.shape,c,o,1,a,u,!1,h),f=new sce(d);return t.runWebGLProgram(f,[s,i],"float32")}const uce={kernelName:fb,backendName:"webgl",kernelFunc:lce};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cce{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=vr(this.outputShape.length);const t=e.filterHeight,r=e.filterWidth,s=t-1-e.padInfo.top,i=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hce(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r,h=_o(u),d=ar(o,i.shape,a,1,l,c,!1,h);if(me().getBool("WEBGL_PACK")&&h==="channelsLast"){const f=[[d.strideHeight,d.strideWidth]],p=new cce(d);return t.runWebGLProgram(p,[s,i],"float32",f)}else{const f=new ice(d);return t.runWebGLProgram(f,[s,i],"float32")}}const dce={kernelName:u0,backendName:"webgl",kernelFunc:hce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r,u=ka(s.shape,i.shape,o,l,a),c=new ece(u);return t.runWebGLProgram(c,[s,i],"float32")}const pce={kernelName:c0,backendName:"webgl",kernelFunc:fce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:l}=r,u=ka(s.shape,l,o,1,a),c=new oce(u);return t.runWebGLProgram(c,[s,i],"float32")}const gce={kernelName:pb,backendName:"webgl",kernelFunc:mce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vce(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{pad:o,strides:a,inputShape:l}=r,u=ka(l,i.shape,a,1,o),c=new ace(u);return t.runWebGLProgram(c,[s,i],"float32")}const yce={kernelName:mb,backendName:"webgl",kernelFunc:vce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xce=Ic+`
  return cos(x);
`,wce=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Vl}
  return result;
`,bce=St({opSnippet:xce,packedOpSnippet:wce}),Cce={kernelName:Bd,backendName:"webgl",kernelFunc:bce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sce=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,kce=St({opSnippet:Sce}),Ece={kernelName:zd,backendName:"webgl",kernelFunc:kce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ice{constructor(e,t,r,s,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,u]=e,[c]=t,[h,d]=r;this.outputShape=[c,h,d,u];const f=s==="bilinear"?1:0,[p,v]=[`${a-1}.0`,`${l-1}.0`],[g,m,y]=h>1?[`${(a-1)/(h-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[w,x,b]=d>1?[`${(l-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${v} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${v}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${w});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${m};
        float width_scale = ${x};

        float in_y = ${y};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${b};
        if( in_x < 0.0 || in_x > ${v} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tce=n=>{const{inputs:e,backend:t,attrs:r}=n,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:u}=r,c=new Ice(s.shape,i.shape,a,l,u);return t.runWebGLProgram(c,[s,i,o],"float32")},_ce={kernelName:vb,backendName:"webgl",kernelFunc:Tce};var id;(function(n){n.Prod="*",n.Sum="+"})(id||(id={}));class eT{constructor(e,t,r,s){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===id.Prod?"1.0":"0.0",a=r?o:`getX(${tT(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=s?`end != ${l-1}`:"end != 0",c=s?"end + 1":"end - 1"):(u=s?`end + pow2 < ${l}`:"end >= pow2",c=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Ut(i)} coords = getOutputCoords();
        int end = ${nT(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${nT(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${tT(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function tT(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function nT(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VL(n,e,t,r,s,i){const o=e.shape.length,a=un([r],o);let l=e;a!=null&&(l=_r({inputs:{x:e},backend:t,attrs:{perm:a}}));const u=wn(1,o)[0];if(u!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let h=ss({inputs:{x:l},backend:t});for(let d=0;d<=Math.ceil(Math.log2(c))-1;d++){const f=new eT(n,l.shape,!1,i),p=[[d]],v=h;h=t.runWebGLProgram(f,[h],h.dtype,p),t.disposeIntermediateTensorInfo(v)}if(s){const d=new eT(n,l.shape,s,i),f=h;h=t.runWebGLProgram(d,[h],h.dtype),t.disposeIntermediateTensorInfo(f)}if(a!=null){const d=Ea(a),f=_r({inputs:{x:h},backend:t,attrs:{perm:d}});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(l),f}return h}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return VL(id.Prod,s,t,i,o,a)}const $ce={kernelName:gb,backendName:"webgl",kernelFunc:Nce};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return VL(id.Sum,s,t,i,o,a)}const Ace={kernelName:h0,backendName:"webgl",kernelFunc:Dce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r;if(s.shape.length===1){const l=t.readSync(s.dataId),u=t.readSync(i.dataId),c=CL(l,u,i.dtype,i.shape,o);return t.makeTensorInfo([o],i.dtype,c)}else if(s.shape.length===2){const l=t.bufferSync(s),u=t.bufferSync(i),c=Poe(l,u,o,a);return t.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const Oce={kernelName:yb,backendName:"webgl",kernelFunc:Rce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fce{constructor(e,t,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockSize:i,dataFormat:o}=r,a=s.shape[0],l=o==="NHWC"?s.shape[1]:s.shape[2],u=o==="NHWC"?s.shape[2]:s.shape[3],c=o==="NHWC"?s.shape[3]:s.shape[1],h=l*i,d=u*i,f=c/(i*i),p=o==="NHWC"?[a,h,d,f]:[a,f,h,d],v=new Fce(p,i,o);return t.runWebGLProgram(v,[s],s.dtype)}const Pce={kernelName:xb,backendName:"webgl",kernelFunc:Lce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WL{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=vr(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";r&&(s?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const h=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${h}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GL{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=vr(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,h=e.filterWidth,d=h;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let m=0;m<h;m++)f+=`
          vec4 xTexelC${m*2};
          int xTexelC${m*2}Ready;
          vec4 xTexelC${m*2+1};
          int xTexelC${m*2+1}Ready;
          vec4 xC${m};`;f+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let m=0;m<h;m++)f+=`
          xTexelC${m*2} = vec4(0.0);
          xTexelC${m*2}Ready = 0;
          xTexelC${m*2+1} = vec4(0.0);
          xTexelC${m*2+1}Ready = 0;
          xC${m} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let m=0;m<(d+1)/2;m++){const y=m*2;if(f+=`
          xC = xCCorner + ${y*u};
          `,l===1){if(y<h&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }
              `,u===1&&y>0?f+=`
                xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                  } else {
                    xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xC${y} = xTexelC${y};
                `,y+1<h)){const w=a%2===0?eb(u):u;u%2===0&&a%2===1||u%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${w};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                    xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${y+1}.zw = vec2(0.0);
                    }
                    xTexelC${y+1}Ready = 1;
                  }
                  `,u>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                    } else {
                     xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                    }
                    `:f+=`
                    xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                    `):w===1?f+=`
                    xC${y+1} = xTexelC${y};
                    `:f+=`
                    xCOffset = xC + ${w};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                      xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${y+1}.zw = vec2(0.0);
                      }
                      xTexelC${y+1}Ready = 1;
                    }

                    xC${y+1} = xTexelC${y+1};
                    `}}else y<h&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.0);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
              `,y+1<h&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(
                  xTexelC${y}.xy, xTexelC${y+1}.xy);
              `,y+1<h&&(f+=`
                  xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                `)));y<h&&(f+=`
            wTexel = getW(r, ${y}, d1, q);
            dotProd += xC${y} * vec4(wTexel.xz, wTexel.xz);
          `,y+1<h&&(f+=`
              wTexel = getW(r, ${y+1}, d1, q);
              dotProd += xC${y+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",v="";r&&(s?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:p=`vec4 activation(vec4 x) {
          ${r}
        }`,v="result = activation(result);");const g=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${v}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),O(gr(o,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const h=ar(s.shape,i.shape,o,c,a,u,!0);let d;me().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?d=new GL(h):d=new WL(h);const f=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return t.runWebGLProgram(d,[s,i],"float32",f)}const Bce={kernelName:d0,backendName:"webgl",kernelFunc:Mce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zce{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Uce{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=t-1-e.padInfo.top,a=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r,h=ar(s.shape,c,o,a,l,u,!0),d=new zce(h);return t.runWebGLProgram(d,[s,i],"float32")}const Wce={kernelName:wb,backendName:"webgl",kernelFunc:Vce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gce(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r,h=ar(c,i.shape,o,a,l,u,!0),d=new Uce(h);return t.runWebGLProgram(d,[s,i],"float32")}const jce={kernelName:bb,backendName:"webgl",kernelFunc:Gce};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hce{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qce(n){const{inputs:e,backend:t}=n,{x:r}=e,s=[...r.shape,...r.shape],i=we(r.shape),o=Be({inputs:{x:r},backend:t,attrs:{shape:[i]}}),a=new Hce(i),l=t.runWebGLProgram(a,[o],o.dtype),u=Be({inputs:{x:l},backend:t,attrs:{shape:s}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),u}const Kce={kernelName:_D,backendName:"webgl",kernelFunc:qce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xce{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:r,padInfo:s,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:h,left:d}=s;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${h}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r,u=Ef(s.shape,i.shape,o,a,"NHWC",l);let c;const h=new Xce(u);c=t.runWebGLProgram(h,[s,i],"float32");const d=Be({inputs:{x:c},backend:t,attrs:{shape:u.outShape}});return t.disposeIntermediateTensorInfo(c),d}const Zce={kernelName:f0,backendName:"webgl",kernelFunc:Yce};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qce(n){const{inputs:e,backend:t,attrs:r}=n,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:l}=Q2(s,i.length);eC(o.length,l,i);const{path:u,steps:c}=tC(a,l),h=c.length;let d=null,f=o.length;const p=[];for(let v=0;v<h;++v){for(const g of c[v]){const{permutationIndices:m,expandDims:y}=J2(f,l[g]);let w;nC(m)?w=i[g]:(w=_r({inputs:{x:i[g]},backend:t,attrs:{perm:m}}),p.push(w));const x=w.shape.slice();for(let b=0;b<y.length;++b)x.splice(y[b],0,1);Nt(w.shape,x)||(w=Be({inputs:{x:w},backend:t,attrs:{shape:x}}),p.push(w)),d===null?d=w:(d=VC({inputs:{a:w,b:d},backend:t}),p.push(d))}v<h-1&&(u[v]>=0&&(d=Iv({inputs:{x:d},backend:t,attrs:{axis:u[v]-(o.length-f),keepDims:!1}}),p.push(d)),f--)}for(const v of p)v!==d&&t.disposeIntermediateTensorInfo(v);return d}const Jce={kernelName:Cb,backendName:"webgl",kernelFunc:Qce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ehe="return (x >= 0.0) ? x : (exp(x) - 1.0);",the=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,nhe=St({opSnippet:ehe,packedOpSnippet:the}),rhe={kernelName:Vd,backendName:"webgl",kernelFunc:nhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const she="return (b >= 0.0) ? a : a * (b + 1.0);",ihe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,ohe=n=>{const{inputs:e,backend:t}=n,{dy:r,y:s}=e,i=me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ec(ihe,r.shape,s.shape):new Sl(she,r.shape,s.shape);return t.runWebGLProgram(i,[r,s],r.dtype)},ahe={kernelName:Sb,backendName:"webgl",kernelFunc:ohe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lhe=`
  return vec4(equal(a, b));
`,uhe="return float(a == b);",che=ur({opSnippet:uhe,packedOpSnippet:lhe,dtype:"bool",cpuKernelImpl:Voe}),hhe={kernelName:p0,backendName:"webgl",kernelFunc:che};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dhe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${j2};
  float a1 = ${H2};
  float a2 = ${q2};
  float a3 = ${K2};
  float a4 = ${X2};
  float a5 = ${Y2};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,fhe=St({opSnippet:dhe}),phe={kernelName:Wd,backendName:"webgl",kernelFunc:fhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mhe=Ic+`
  return exp(x);
`,ghe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,jL=St({opSnippet:mhe,packedOpSnippet:ghe,cpuKernelImpl:Woe,dtype:"float32"}),vhe={kernelName:Gd,backendName:"webgl",kernelFunc:jL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D1(n){const{inputs:e,attrs:t,backend:r}=n,{dim:s}=t,{input:i}=e,o=i.shape.length,a=i.shape.slice();let l=s;return s<0&&(O(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+s+1),a.splice(l,0,1),Be({inputs:{x:i},backend:r,attrs:{shape:a}})}const yhe={kernelName:m0,backendName:"webgl",kernelFunc:D1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rT="return exp(x) - 1.0;",xhe=St({opSnippet:rT,packedOpSnippet:rT,cpuKernelImpl:Goe}),whe={kernelName:jd,backendName:"webgl",kernelFunc:xhe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sT{constructor(e,t,r){this.variableNames=["real","imag"];const s=t[1];this.outputShape=t;const i=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${s}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HL(n,e,t){const r=t.texData.get(n.dataId),s=we(n.shape),i=n.shape[n.shape.length-1],o=s/i,a=Be({inputs:{x:n},backend:t,attrs:{shape:[o,i]}}),l=a.shape,u=new sT("real",l,e),c=new sT("imag",l,e),h=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],d=t.runWebGLProgram(u,h,"float32"),f=t.runWebGLProgram(c,h,"float32"),p=$a({inputs:{real:d,imag:f},backend:t});t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(f);const v=Be({inputs:{x:p},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(p),v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bhe(n){const{inputs:e,backend:t}=n,{input:r}=e;return HL(r,!1,t)}const Che={kernelName:kb,backendName:"webgl",kernelFunc:bhe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class She{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hf(n){const{backend:e,attrs:t}=n,{shape:r,value:s}=t;let{dtype:i}=t;if(i=i||dc(s),i==="string"){const o=vn(i,we(r));return o.fill(s),e.makeTensorInfo(r,i,o)}else{const o=new She(r,s),a=[[s]];return e.runWebGLProgram(o,[],i,a)}}const khe={kernelName:Eb,backendName:"webgl",kernelFunc:Hf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ehe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ihe={kernelName:Ib,backendName:"webgl",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,r=e,s=new Ehe(t.shape);return r.runWebGLProgram(s,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iT="return floor(x);",The=St({opSnippet:iT,packedOpSnippet:iT,cpuKernelImpl:joe}),_he={kernelName:Hd,backendName:"webgl",kernelFunc:The};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nhe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,$he=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,Dhe=ur({opSnippet:Nhe,packedOpSnippet:$he,dtype:"int32"}),Ahe={kernelName:qd,backendName:"webgl",kernelFunc:Dhe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rhe{constructor(e){this.variableNames=["A"];const t=Dr(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ohe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=Dr(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fhe={kernelName:L5,backendName:"webgl",kernelFunc:Lhe};let ru,zy=me().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Lhe(n){const{inputs:e,backend:t,attrs:r}=n;let{pixels:s}=e;const{numChannels:i}=r,o=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[l,u]=o?[s.videoWidth,s.videoHeight]:[s.width,s.height],c=[u,l],h=[u,l,i];if(a||o){const v=me().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(ru==null||v!==zy)&&(zy=v,ru=document.createElement("canvas").getContext("2d",{willReadFrequently:zy})),ru.canvas.width=l,ru.canvas.height=u,ru.drawImage(s,0,0,l,u),s=ru.canvas}const d=t.makeTensorInfo(c,"int32");t.texData.get(d.dataId).usage=ms.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(d.dataId),s);const f=me().getBool("WEBGL_PACK")?new Ohe(h):new Rhe(h),p=t.runWebGLProgram(f,[d],"int32");return t.disposeData(d.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Phe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r,v=_o(c),g=ar(s.shape,i.shape,l,h,u,d,!1,v);let m;const y=[],w=o!=null,x=a!=null,b=f==="leakyrelu",C=()=>{const E=[s,i],T=(_,A)=>{if(A==="NCHW"&&_.shape.length===1&&_.shape[0]!==1){const P=Be({inputs:{x:_},backend:t,attrs:{shape:[_.shape[0],1,1]}});return y.push(P),P}return _};if(w&&E.push(T(o,c)),x&&E.push(T(a,c)),b){const _=t.makeTensorInfo([],"float32",Ca(p,"float32"));E.push(_),y.push(_)}return E};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))m=zL({x:s,filter:i,convInfo:g,backend:t,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(g.strideWidth<=2&&v==="channelsLast"&&me().getBool("WEBGL_EXP_CONV")){const E=f?rd(f,!0):null,T=new BL(g,w,E,x,b),_=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],A=C();m=t.runWebGLProgram(T,A,"float32",_)}else if(me().getBool("WEBGL_CONV_IM2COL"))m=UL({x:s,filter:i,convInfo:g,backend:t,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const E=f?rd(f,!1):null,T=new ML(g,w,E,x,b),_=C();m=t.runWebGLProgram(T,_,"float32")}const k=Be({inputs:{x:m},backend:t,attrs:{shape:g.outShape}});return y.push(m),y.forEach(E=>t.disposeIntermediateTensorInfo(E)),k}const Mhe={kernelName:Dm,backendName:"webgl",kernelFunc:Phe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bhe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:h,activation:d,leakyreluAlpha:f}=r,p=[];let v=c;v==null&&(v=[1,1]),O(gr(l,v),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${v}'`);const g=ar(s.shape,i.shape,l,v,u,h,!0),m=me().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,y=d?rd(d,m):null,w=[s,i],x=o!=null,b=a!=null,C=d==="leakyrelu";if(x&&w.push(o),b&&w.push(a),C){const _=t.makeTensorInfo([],"float32",Ca(f,"float32"));w.push(_),p.push(_)}let k;m?k=new GL(g,x,y,b,C):k=new WL(g,x,y,b,C);const E=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],T=t.runWebGLProgram(k,w,"float32",E);return p.forEach(_=>t.disposeIntermediateTensorInfo(_)),T}const zhe={kernelName:qD,backendName:"webgl",kernelFunc:Bhe};class Uhe{constructor(e,t,r,s){this.sliceDim=e,this.strides=t,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const i=Ut(r.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vhe(n){const{inputs:e,backend:t}=n,{params:r,indices:s}=e,i=s.shape,o=i[i.length-1],a=we(r.shape),[l,u,c,h]=O2(r,s),d=Be({inputs:{x:s},backend:t,attrs:{shape:[u,o]}}),f=Be({inputs:{x:r},backend:t,attrs:{shape:[we(r.shape)/c,c]}});if(t.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const m=t.readSync(s.dataId),y=t.bufferSync(r),w=Hoe(m,y,r.dtype,u,o,c,h,r.shape,a);return t.makeTensorInfo(l,r.dtype,w.values)}const p=new Uhe(o,h,[u,c],r.shape),v=t.runWebGLProgram(p,[f,d],f.dtype),g=Be({inputs:{x:v},backend:t,attrs:{shape:l}});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(v),g}const Whe={kernelName:ND,backendName:"webgl",kernelFunc:Vhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ghe{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const r=Ut(this.rank),s=jhe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function jhe(n,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<n.length;s++)s===2?r.push("index"):r.push(`${t[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qL(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,indices:i}=e,{axis:o,batchDims:a}=r,l=mt(o,s.shape)[0];if(me().get("DEBUG")){const y=t.readSync(i.dataId),w=s.shape[l];for(let x=0;x<y.length;++x){const b=y[x];O(b<=w-1&&b>=0,()=>`GatherV2: the index value ${b} is not in [0, ${w-1}]`)}}const u=sC(s,i,l,a),c=we(i.shape),h=[],d=Be({inputs:{x:s},backend:t,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),f=Be({inputs:{x:i},backend:t,attrs:{shape:[u.batchSize,c/u.batchSize]}});h.push(d),h.push(f);const p=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(t.shouldExecuteOnCPU([s,i])||s.dtype==="string"){const y=t.bufferSync(f),w=t.bufferSync(d),x=qoe(w,y,p);return h.forEach(b=>t.disposeIntermediateTensorInfo(b)),t.makeTensorInfo(u.outputShape,x.dtype,x.values)}const v=new Ghe(d.shape,p),g=t.runWebGLProgram(v,[d,f],d.dtype);h.push(g);const m=Be({inputs:{x:g},backend:t,attrs:{shape:u.outputShape}});return h.forEach(y=>t.disposeIntermediateTensorInfo(y)),m}const Hhe={kernelName:v0,backendName:"webgl",kernelFunc:qL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qhe="return float(a > b);",Khe=`
  return vec4(greaterThan(a, b));
`,Xhe=ur({opSnippet:qhe,packedOpSnippet:Khe,cpuKernelImpl:Koe,dtype:"bool"}),Yhe={kernelName:y0,backendName:"webgl",kernelFunc:Xhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zhe="return float(a >= b);",Qhe=`
  return vec4(greaterThanEqual(a, b));
`,Jhe=ur({opSnippet:Zhe,packedOpSnippet:Qhe,dtype:"bool",cpuKernelImpl:Xoe}),ede={kernelName:Kd,backendName:"webgl",kernelFunc:Jhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tde(n){const{inputs:e,backend:t}=n,{input:r}=e;return HL(r,!0,t)}const nde={kernelName:Tb,backendName:"webgl",kernelFunc:tde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rde="return float(!isnan(x) && !isinf(x));",sde=St({opSnippet:rde,dtype:"bool"}),ide={kernelName:Yd,backendName:"webgl",kernelFunc:sde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ode="return float(isinf(x));",ade=St({opSnippet:ode,dtype:"bool"}),lde={kernelName:Zd,backendName:"webgl",kernelFunc:ade};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ude="return float(isnan(x));",cde=St({opSnippet:ude,dtype:"bool"}),hde={kernelName:Qd,backendName:"webgl",kernelFunc:cde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dde="return float(a < b);",fde=`
  return vec4(lessThan(a, b));
`,pde=ur({opSnippet:dde,packedOpSnippet:fde,cpuKernelImpl:Yoe,dtype:"bool"}),mde={kernelName:w0,backendName:"webgl",kernelFunc:pde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gde="return float(a <= b);",vde=`
  return vec4(lessThanEqual(a, b));
`,yde=ur({opSnippet:gde,packedOpSnippet:vde,cpuKernelImpl:Zoe,dtype:"bool"}),xde={kernelName:b0,backendName:"webgl",kernelFunc:yde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wde(n){const{backend:e,attrs:t}=n,{start:r,stop:s,num:i}=t,o=Qoe(r,s,i);return e.makeTensorInfo([o.length],"float32",o)}const bde={kernelName:$D,backendName:"webgl",kernelFunc:wde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cde=Ic+`
  return x < 0.0 ? 0./0. : log(x);
`,Sde=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,kde=St({opSnippet:Cde,packedOpSnippet:Sde,cpuKernelImpl:Joe}),Ede={kernelName:Jd,backendName:"webgl",kernelFunc:kde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ide=Ic+`
  return log(1.0 + x);
`,Tde=St({opSnippet:Ide}),_de={kernelName:ef,backendName:"webgl",kernelFunc:Tde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nde="return float(a >= 1.0 && b >= 1.0);",$de=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Dde=ur({opSnippet:Nde,packedOpSnippet:$de,dtype:"bool"}),Ade={kernelName:C0,backendName:"webgl",kernelFunc:Dde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rde="return float(!(x >= 1.0));",Ode=St({opSnippet:Rde}),Fde={kernelName:S0,backendName:"webgl",kernelFunc:Ode};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lde="return float(a >= 1.0 || b >= 1.0);",Pde=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,Mde=ur({opSnippet:Lde,packedOpSnippet:Pde,dtype:"bool"}),Bde={kernelName:k0,backendName:"webgl",kernelFunc:Mde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zde{constructor(e,t,r,s,i){this.variableNames=["x"],this.outputShape=[];const o=t,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ude{constructor(e,t,r,s,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=t,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vde=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=r,u=me().getBool("WEBGL_PACK_NORMALIZATION")?new Ude(s.shape,i,o,a,l):new zde(s.shape,i,o,a,l);return t.runWebGLProgram(u,[s],s.dtype)},Wde={kernelName:E0,backendName:"webgl",kernelFunc:Vde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gde{constructor(e,t,r,s,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=r,this.alpha=s,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jde=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r,h=new Gde(s.shape,a,l,u,c);return t.runWebGLProgram(h,[s,i,o],s.dtype)},Hde={kernelName:Nb,backendName:"webgl",kernelFunc:jde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qde(n,e,t,r){const s=we(e),o=we(n.shape)/s,a=Be({inputs:{x:n},attrs:{shape:[o,s]},backend:r}),l=Wl(a,n.dtype,"max",r),u=Be({inputs:{x:l},attrs:{shape:t},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KL(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reductionIndices:i,keepDims:o}=r,a=s.shape.length,l=mt(i,s.shape);let u=l;const c=un(u,a),h=c!=null,d=t.shouldExecuteOnCPU([s]);let f=s;if(h){if(d){const w=t.texData.get(f.dataId).values,x=new Array(a);for(let k=0;k<x.length;k++)x[k]=s.shape[c[k]];const b=zC(w,s.shape,s.dtype,c,x);f=t.makeTensorInfo(x,s.dtype);const C=t.texData.get(f.dataId);C.values=b}else f=Ev(s,c,t);u=wn(u.length,a)}lr("max",u,a);const[p,v]=Jn(f.shape,u);let g=p;o&&(g=Rn(p,l));let m;if(d){const w=t.texData.get(f.dataId).values,x=eae(w,we(v),g,s.dtype);m=t.makeTensorInfo(g,s.dtype);const b=t.texData.get(m.dataId);b.values=x}else m=qde(f,v,g,t);return h&&t.disposeIntermediateTensorInfo(f),m}const Kde={kernelName:I0,backendName:"webgl",kernelFunc:KL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xde=UC+`
  return max(a, b);
`,Yde=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Vl+`
  return result;
`,Zde=ur({opSnippet:Xde,packedOpSnippet:Yde,cpuKernelImpl:tae}),Qde={kernelName:tf,backendName:"webgl",kernelFunc:Zde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jde(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;Wf(s,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;O(gr(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ks(s.shape,i,o,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&Nt(c.inShape,c.outShape))return ss({inputs:{x:s},backend:t});const h=new sd(c,"max",!1);return t.runWebGLProgram(h,[s],s.dtype)}const efe={kernelName:T0,backendName:"webgl",kernelFunc:Jde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tfe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],h=To(s.shape,i,o,c,a,u,l),d=new WC(h,"max",!1);return t.runWebGLProgram(d,[s],s.dtype)}const nfe={kernelName:_0,backendName:"webgl",kernelFunc:tfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rfe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,l=o-1-e.padInfo.left,u=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class sfe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,h=l-1-e.padInfo.front,d=u-1-e.padInfo.top,f=c-1-e.padInfo.left,p=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${h}, ${d}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ife(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,o=i,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,h=[1,1,1],d=To(o.shape,a,l,h,u,c),f=new WC(d,"max",!0),p=t.runWebGLProgram(f,[o],o.dtype),v=new sfe(d),g=t.runWebGLProgram(v,[s,p],o.dtype);return t.disposeIntermediateTensorInfo(p),g}const ofe={kernelName:Db,backendName:"webgl",kernelFunc:ife};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function afe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i,output:o}=e,a=i;Wf([i,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:h}=r,d=Ks(a.shape,l,u,1,c,h),f=!0,p=new sd(d,"max",f),v=t.runWebGLProgram(p,[a],a.dtype),g=new rfe(d),m=t.runWebGLProgram(g,[s,v],a.dtype);return t.disposeIntermediateTensorInfo(v),m}const lfe={kernelName:$b,backendName:"webgl",kernelFunc:afe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ufe(n,e,t,r){let s=new sd(t,"max",!1);const i=r.runWebGLProgram(s,[n],"float32");s=new sd(t,"max",!0,!0,e);const o=r.runWebGLProgram(s,[n],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cfe={kernelName:DD,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=e,l=t;O(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];O(gr(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Ks(r.shape,s,i,u,o),[h,d]=ufe(r,a,c,l);return[h,d]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hfe(n,e,t,r){const s=we(e),o=we(n.shape)/s,a=Be({inputs:{x:n},attrs:{shape:[o,s]},backend:r}),l=Wl(a,"float32","mean",r),u=Be({inputs:{x:l},attrs:{shape:t},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dfe={kernelName:N0,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{keepDims:s,axis:i}=e,o=t,a=r.shape.length,l=mt(i,r.shape);let u=l;const c=un(u,a),h=c!=null,d=o.shouldExecuteOnCPU([r]),f=[];let p=r;if(h){if(d){const x=o.texData.get(p.dataId).values,b=new Array(a);for(let E=0;E<b.length;E++)b[E]=r.shape[c[E]];const C=zC(x,r.shape,r.dtype,c,b);p=o.makeTensorInfo(b,r.dtype);const k=o.texData.get(p.dataId);k.values=C}else p=Ev(r,c,o);f.push(p),u=wn(u.length,a)}lr("sum",u,a);const[v,g]=Jn(p.shape,u);let m=v;s&&(m=Rn(v,l));const y=hfe(p,g,m,o);for(const w of f)o.disposeIntermediateTensorInfo(w);return y}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ffe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=mt(i,s.shape);let u=l;const c=un(u,a);let h=s;c!=null&&(h=_r({inputs:{x:s},backend:t,attrs:{perm:c}}),u=wn(u.length,s.shape.length)),lr("min",u,a);const[d,f]=Jn(h.shape,u),p=we(f),v=Be({inputs:{x:h},backend:t,attrs:{shape:[-1,p]}}),g=Wl(v,v.dtype,"min",t);let m;if(o){const y=Rn(d,l);m=Be({inputs:{x:g},backend:t,attrs:{shape:y}})}else m=Be({inputs:{x:g},backend:t,attrs:{shape:d}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(g),c!=null&&t.disposeIntermediateTensorInfo(h),m}const pfe={kernelName:$0,backendName:"webgl",kernelFunc:ffe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mfe=UC+`
  return min(a, b);
`,gfe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Vl+`
  return result;
`,vfe=ur({opSnippet:mfe,packedOpSnippet:gfe,cpuKernelImpl:nae}),yfe={kernelName:nf,backendName:"webgl",kernelFunc:vfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xfe{constructor(e,t,r){this.variableNames=["x"],this.outputShape=t.map((c,h)=>c[0]+e[h]+c[1]);const s=e.length,i=Ut(s),o=t.map(c=>c[0]).join(","),a=t.map((c,h)=>c[0]+e[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),u=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wfe{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((p,v)=>p[0]+e[v]+p[1]);const s=e.length,i=Ut(s),o=t.map(p=>p[0]).join(","),a=t.map((p,v)=>p[0]+e[v]).join(","),l=kr("rc",s),u=kr("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,h=s===1?"source":`vec2(${u.slice(-2).join()})`,d=r==="reflect"?0:1;let f="";if(s===1){const p=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${h});
        ${l[s-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${h});
        }
      `}else{const p=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${h});
        ${l[s-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${h});
        }
        rc = outputLoc;
        ${l[s-2]} += 1;
        if(${l[s-2]} < ${this.outputShape[s-2]}) {
          ${p}
          result[2] = getChannel(getX(${u.join()}), ${h});
          ${l[s-1]} += 1;
          if(${c}) {
            ${p}
            result[3] = getChannel(getX(${u.join()}), ${h});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bfe=({inputs:n,backend:e,attrs:t})=>{const{x:r}=n,{paddings:s,mode:i}=t,o=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new wfe(r.shape,s,i):new xfe(r.shape,s,i);return e.runWebGLProgram(o,[r],r.dtype)},Cfe={kernelName:D0,backendName:"webgl",kernelFunc:bfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sfe=`if (b == 0.0) return NAN;
  return mod(a, b);`,kfe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Vl+`
  return result;
`,Efe=ur({opSnippet:Sfe,packedOpSnippet:kfe}),Ife={kernelName:rf,backendName:"webgl",kernelFunc:Efe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tfe{constructor(e,t,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _fe=`
if (a == b) {
  return 1.0;
};
return a / b;`,Nfe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,XL=ur({opSnippet:_fe,packedOpSnippet:Nfe,checkOutOfBounds:!0}),$fe={kernelName:Ud,backendName:"webgl",kernelFunc:XL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oT="return a - b;",YL=ur({opSnippet:oT,packedOpSnippet:oT,supportsComplex:!0,cpuKernelImpl:Sae}),Dfe={kernelName:wf,backendName:"webgl",kernelFunc:YL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZL(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{dim:i}=r,o=mt([i],s.shape),a=KL({inputs:{x:s},backend:t,attrs:{reductionIndices:o,keepDims:!1}}),l=Rn(a.shape,o),u=Be({inputs:{x:a},backend:t,attrs:{shape:l}}),c=YL({inputs:{a:s,b:u},backend:t}),h=jL({inputs:{x:c},backend:t}),d=Iv({inputs:{x:h},backend:t,attrs:{axis:o,keepDims:!1}}),f=Be({inputs:{x:d},backend:t,attrs:{shape:l}}),p=XL({inputs:{a:h,b:f},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(f),p}const Afe={kernelName:X0,backendName:"webgl",kernelFunc:ZL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rfe(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r,l=a?s:ZL({inputs:{logits:s},backend:t,attrs:{dim:s.shape.length-1}}),u=l.shape[0],c=l.shape[1],h=new Tfe(u,c,i),d=[[o]],f=t.runWebGLProgram(h,[l],"int32",d);return a||t.disposeIntermediateTensorInfo(l),f}const Ofe={kernelName:AD,backendName:"webgl",kernelFunc:Rfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ffe=Ys+`
  return -x;
`,Lfe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Pfe(n){const{inputs:e,backend:t}=n,{x:r}=e;if(t.shouldExecuteOnCPU([r])){const i=t.texData.get(r.dataId),[o,a]=sae(i.values,r.shape,r.dtype);return t.makeTensorInfo(a,r.dtype,o)}let s;return me().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new qo(r.shape,Lfe):s=new Pi(r.shape,Ffe),t.runWebGLProgram(s,[r],r.dtype)}const Mfe={kernelName:A0,backendName:"webgl",kernelFunc:Pfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bfe=_2;function zfe(n){fs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r,u=t.readSync(s.dataId),c=t.readSync(i.dataId),{selectedIndices:h}=Bfe(u,c,o,a,l);return t.makeTensorInfo([h.length],"int32",new Int32Array(h))}const Ufe={kernelName:Ab,backendName:"webgl",kernelFunc:zfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vfe=N2;function Wfe(n){fs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r,c=t.readSync(s.dataId),h=t.readSync(i.dataId),{selectedIndices:d,validOutputs:f}=Vfe(c,h,o,a,l,u);return[t.makeTensorInfo([d.length],"int32",new Int32Array(d)),t.makeTensorInfo([],"int32",new Int32Array([f]))]}const Gfe={kernelName:Rb,backendName:"webgl",kernelFunc:Wfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jfe=$2;function Hfe(n){fs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,c=t.readSync(s.dataId),h=t.readSync(i.dataId),d=o,f=a,p=l,v=u,{selectedIndices:g,selectedScores:m}=jfe(c,h,d,f,p,v);return[t.makeTensorInfo([g.length],"int32",new Int32Array(g)),t.makeTensorInfo([m.length],"float32",new Float32Array(m))]}const qfe={kernelName:Ob,backendName:"webgl",kernelFunc:Hfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kfe{constructor(e,t,r,s){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xfe=n=>{const{inputs:e,backend:t,attrs:r}=n,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:l}=r,u=we(s.shape),c=new Kfe(u,o,a,l),h=Be({inputs:{x:s},backend:t,attrs:{shape:[u]}}),d=t.runWebGLProgram(c,[h],i);t.disposeIntermediateTensorInfo(h);const f=[...s.shape,o],p=Be({inputs:{x:d},backend:t,attrs:{shape:f}});return t.disposeIntermediateTensorInfo(d),p},Yfe={kernelName:F0,backendName:"webgl",kernelFunc:Xfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ig(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="complex64"){const s=jf({inputs:{input:r},backend:t}),i=ig({inputs:{x:s},backend:t}),o=Tv({inputs:{input:r},backend:t}),a=ig({inputs:{x:o},backend:t}),l=$a({inputs:{real:i,imag:a},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),l}else return Hf({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:t})}const Zfe={kernelName:Q0,backendName:"webgl",kernelFunc:ig};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QL(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=jf({inputs:{input:r},backend:t}),i=QL({inputs:{x:s},backend:t}),o=Tv({inputs:{input:r},backend:t}),a=ig({inputs:{x:o},backend:t}),l=$a({inputs:{real:i,imag:a},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),l}else return Hf({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:t})}const Qfe={kernelName:O0,backendName:"webgl",kernelFunc:QL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jfe(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r;if(e.length===1)return D1({inputs:{input:e[0]},backend:t,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(c=>{tb(i,c.shape,"All tensors passed to stack must have matching shapes"),O(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const h=D1({inputs:{input:c},backend:t,attrs:{dim:s}});return a.push(h),h}),u=PL({inputs:l,backend:t,attrs:{axis:s}});return a.forEach(c=>t.disposeIntermediateTensorInfo(c)),u}const epe={kernelName:L0,backendName:"webgl",kernelFunc:Jfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tpe{constructor(e,t,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((u,c)=>u[0]+e[c]+u[1]);const s=e.length,i=Ut(s),o=t.map(u=>u[0]).join(","),a=t.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class npe{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((v,g)=>v[0]+e[g]+v[1]);const s=e.length,i=Ut(s),o=t.map(v=>v[0]).join(","),a=t.map((v,g)=>v[0]+e[g]).join(","),l=kr("rc",s),u=kr("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,h=s===1?"source":`vec2(${u.slice(-2).join()})`,d=[`${i} rc = outputLoc;`,`${l[s-1]} += 1;
       if(${c}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${l[s-2]} += 1;
       if(${l[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${l[s-1]} += 1;
         if(${c}) {`],f=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let v=0,g=s===1?2:4;v<g;v++)p+=`
        ${d[v]}
        if (${f}) {
          result[${v}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${v}] = getChannel(getX(${u.join()}), ${h});
        }
      `;p+=s===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JL=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{paddings:i,constantValue:o}=r;if(we(s.shape)===0){const u=i.map((c,h)=>c[0]+s.shape[h]+c[1]);return Hf({backend:t,attrs:{shape:u,value:o,dtype:s.dtype}})}const a=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new npe(s.shape,i,o):new tpe(s.shape,i,o),l=[[o]];return t.runWebGLProgram(a,[s],s.dtype,l)},rpe={kernelName:P0,backendName:"webgl",kernelFunc:JL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const spe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,ipe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Vl+`
  return result;
`,ope=ur({opSnippet:spe,packedOpSnippet:ipe}),ape={kernelName:of,backendName:"webgl",kernelFunc:ope};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lpe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=[],u=mt(i,s.shape);let c=u;const h=un(c,a);let d=s;h!=null&&(d=_r({inputs:{x:s},backend:t,attrs:{perm:h}}),c=wn(c.length,a),l.push(d)),lr("prod",c,a);let f;if(t.shouldExecuteOnCPU([d])){const p=t.texData.get(d.dataId).values,{outVals:v,outShape:g,outDtype:m}=oae(d.shape,d.dtype,p,c);f=t.makeTensorInfo(g,m,v)}else{const[p,v]=Jn(d.shape,c),g=we(v),m=Be({inputs:{x:d},backend:t,attrs:{shape:[-1,g]}}),y=qb(s.dtype),w=Wl(m,y,"prod",t);f=Be({inputs:{x:w},backend:t,attrs:{shape:p}}),l.push(m),l.push(w)}if(o){l.push(f);const p=Rn(f.shape,u);f=Be({inputs:{x:f},backend:t,attrs:{shape:p}})}return l.forEach(p=>t.disposeIntermediateTensorInfo(p)),f}const upe={kernelName:B0,backendName:"webgl",kernelFunc:lpe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cpe(n){const{inputs:e,backend:t,attrs:r}=n,{paramsNestedSplits:s,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=r,l=s.map(m=>t.readSync(m.dataId)),u=s.map(m=>m.shape),c=t.readSync(i.dataId),h=t.readSync(o.dataId),[d,f,p]=aae(l,u,c,i.shape,i.dtype,h,o.shape,a),v=d.map(m=>t.makeTensorInfo([m.length],"int32",m)),g=t.makeTensorInfo(p,i.dtype,f);return v.concat([g])}const hpe={kernelName:RD,backendName:"webgl",kernelFunc:cpe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dpe(n){const{inputs:e,backend:t}=n,{starts:r,limits:s,deltas:i}=e,o=t.readSync(r.dataId),a=t.readSync(s.dataId),l=t.readSync(i.dataId),[u,c]=lae(o,r.shape,r.dtype,a,s.shape,l,i.shape),h=t.makeTensorInfo([u.length],"int32",u),d=t.makeTensorInfo([c.length],r.dtype,c);return[h,d]}const fpe={kernelName:OD,backendName:"webgl",kernelFunc:dpe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ppe(n){const{inputs:e,backend:t,attrs:r}=n,{shape:s,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=t.readSync(s.dataId),c=t.readSync(i.dataId),h=t.readSync(o.dataId),d=a.map(g=>t.readSync(g.dataId)),f=a.map(g=>g.shape),[p,v]=uae(u,s.shape,c,i.shape,i.dtype,h,o.shape,d,f,l);return t.makeTensorInfo(p,i.dtype,v)}const mpe={kernelName:FD,backendName:"webgl",kernelFunc:ppe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eP=n=>{const{backend:e,attrs:t}=n,{start:r,stop:s,step:i,dtype:o}=t,a=cae(r,s,i,o);return e.makeTensorInfo([a.length],o,a)},gpe={kernelName:Fb,backendName:"webgl",kernelFunc:eP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vpe="return 1.0 / x;",ype=St({opSnippet:vpe}),xpe={kernelName:af,backendName:"webgl",kernelFunc:ype};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wpe=Ys+`
  return (x < 0.0) ? 0.0 : x;
`,bpe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Cpe=St({opSnippet:wpe,packedOpSnippet:bpe}),Spe={kernelName:lf,backendName:"webgl",kernelFunc:Cpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kpe=Ys+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Epe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Ipe=St({opSnippet:kpe,packedOpSnippet:Epe}),Tpe={kernelName:uf,backendName:"webgl",kernelFunc:Ipe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _pe{constructor(e,t,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,t,r,u];const c=[s&&t>1?a-1:a,s&&r>1?l-1:l],h=[s&&t>1?t-1:t,s&&r>1?r-1:r];let d;i?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/h[0]},
          ${c[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Npe{constructor(e,t,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,t,r,u];const c=[s&&t>1?a-1:a,s&&r>1?l-1:l],h=[s&&t>1?t-1:t,s&&r>1?r-1:r];let d;i?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/h[0]},
          ${c[1]/h[1]},
          ${c[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $pe(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[l,u]=a,c=me().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Npe(s.shape,l,u,i,o):new _pe(s.shape,l,u,i,o);return t.runWebGLProgram(c,[s],"float32")}const Dpe={kernelName:V0,backendName:"webgl",kernelFunc:$pe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ape{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,s,i]=t,[,o,a]=e,l=[r&&o>1?s-1:s,r&&a>1?i-1:i],u=[r&&o>1?o-1:o,r&&a>1?a-1:a],c=l[0]/u[0],h=l[1]/u[1],d=1/c,f=1/h,p=Math.ceil(d)*2+2,v=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${v});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rpe(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:o}=r,a=new Ape(i.shape,s.shape,o);return t.runWebGLProgram(a,[i],i.dtype)}const Ope={kernelName:Mb,backendName:"webgl",kernelFunc:Rpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fpe{constructor(e,t,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,t,r,u];const c=[s&&t>1?a-1:a,s&&r>1?l-1:l],h=[s&&t>1?t-1:t,s&&r>1?r-1:r],d=s?"0.5":"0.0";let f;i?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/h[0]},
          ${c[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lpe{constructor(e,t,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,t,r,u];const c=[s&&t>1?a-1:a,s&&r>1?l-1:l],h=[s&&t>1?t-1:t,s&&r>1?r-1:r],d=s?"0.5":"0.0";let f;i?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/h[0]},
          ${c[1]/h[1]},
          ${c[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ppe(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[l,u]=a,c=me().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Lpe(s.shape,l,u,i,o):new Fpe(s.shape,l,u,i,o);return t.runWebGLProgram(c,[s],s.dtype)}const Mpe={kernelName:U0,backendName:"webgl",kernelFunc:Ppe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bpe{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,s,i]=t,[,o,a]=e,l=[r&&o>1?s-1:s,r&&a>1?i-1:i],u=[r&&o>1?o-1:o,r&&a>1?a-1:a],c=l[0]/u[0],h=l[1]/u[1],d=1/c,f=1/h,p=Math.ceil(d)*2+2,v=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${v});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zpe(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:o}=r,a=new Bpe(i.shape,s.shape,o);return t.runWebGLProgram(a,[i],i.dtype)}const Upe={kernelName:Pb,backendName:"webgl",kernelFunc:zpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vpe{constructor(e,t){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=a=>t.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,l)=>s(l)).join(","),o=Ut(r);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wpe{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=kr("rc",r),i=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,a=Ut(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(s.slice())};
          if(${i}){
            result.g = ${u(s.slice())};
          }
          if(${o}) {
            result.b = ${c(s.slice())};
            if(${i}) {
              result.a = ${h(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return d(p)}function u(p){return p[r-1]="("+p[r-1]+" + 1)",d(p)}function c(p){return p[r-2]="("+p[r-2]+" + 1)",d(p)}function h(p){return p[r-1]="("+p[r-1]+" + 1)",p[r-2]="("+p[r-2]+" + 1)",d(p)}function d(p){const v=e.map((y,w)=>f(w,p)),g=v.join(","),m=v.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${m}))`}function f(p,v){return t.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${v[p]} - 1`:`${v[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gpe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dims:i}=r,o=s.shape.length,a=mt(i,s.shape);if(o===0)return ss({inputs:{x:s},backend:t});const l=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Wpe(s.shape,a):new Vpe(s.shape,a);return t.runWebGLProgram(l,[s],s.dtype)}const jpe={kernelName:W0,backendName:"webgl",kernelFunc:Gpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hpe{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let i="";typeof t=="number"?i=`float outputValue = ${t.toFixed(2)};`:i=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qpe={kernelName:jb,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,{radians:s,fillValue:i,center:o}=e,a=t,l=new Hpe(r.shape,i),[u,c]=V2(o,r.shape[1],r.shape[2]),h=[[u,c,Math.sin(s),Math.cos(s)]];return a.runWebGLProgram(l,[r],r.dtype,h)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kpe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,Xpe=St({opSnippet:Kpe}),Ype={kernelName:cf,backendName:"webgl",kernelFunc:Xpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zpe="return inversesqrt(x);",Qpe=St({opSnippet:Zpe,cpuKernelImpl:hae}),Jpe={kernelName:hf,backendName:"webgl",kernelFunc:Qpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GC{constructor(e,t,r,s,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const u=Ut(i.length),c=Ut(o.length);let h="";r===1?h="i":r===2&&(h="i, j");const d=`getIndices(${h})`;let f="";s===1?f="i":s===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let v="";l&&(v="coords[0], coords[1]");const g=`getDefaultValue(${v})`,m=t>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${m};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${g}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eme{constructor(e,t,r,s,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const u=Ut(i.length),c=Ut(o.length);let h="";r===1?h="i":r===2&&(h="i, j");const d=`getIndices(${h})`;let f="";s===1?f="i":s===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let v="";l&&(v="coords[0], coords[1]");const g=`getDefaultValue(${v})`,m=t>1?"strides[j]":"strides",y=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${m};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${y};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${g}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tme(n){const{inputs:e,backend:t,attrs:r}=n,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:h}=Pl(i,s,o),d=[h/u,u];if(h===0)return t.makeTensorInfo(o,s.dtype);const f=Be({inputs:{x:s},backend:t,attrs:{shape:[l,a]}}),p=Be({inputs:{x:i},backend:t,attrs:{shape:[l,u]}}),v=t.makeTensorInfo([],"float32",new Float32Array([0]));let g;me().getBool("WEBGL_PACK")?g=new eme(l,a,f.shape.length,p.shape.length,c,d):g=new GC(l,a,f.shape.length,p.shape.length,c,d);const m=t.runWebGLProgram(g,[p,f,v],p.dtype),y=Be({inputs:{x:m},backend:t,attrs:{shape:o}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(v),y}const nme={kernelName:LD,backendName:"webgl",kernelFunc:tme};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rme{constructor(e,t,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,a=me().getNumber("WEBGL_VERSION")===2?i:o,l=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sme(n){const{inputs:e,backend:t,attrs:r}=n,{sortedSequence:s,values:i}=e,{side:o}=r,a=new rme(s.shape[0],s.shape[1],i.shape[1],o),l=[[s.shape[1]]];return t.runWebGLProgram(a,[s,i],"int32",l)}const ime={kernelName:MD,backendName:"webgl",kernelFunc:sme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ome{constructor(e,t,r){this.variableNames=["c","a","b"],this.outputShape=t;let s,i;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)i="resRC",s="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<t.length;c++)u.push(`${a[c]}`),c<e&&l.push(`${a[c]}`);s=l.join(),i=u.join()}const o=Ut(r);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ame(n){const{inputs:e,backend:t}=n,{condition:r,t:s,e:i}=e,o=new ome(r.shape.length,s.shape,s.shape.length);return t.runWebGLProgram(o,[r,s,i],ns(s.dtype,i.dtype))}const lme={kernelName:G0,backendName:"webgl",kernelFunc:ame};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ume=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${uv};
  float scale = ${cv};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,cme=St({opSnippet:ume}),hme={kernelName:df,backendName:"webgl",kernelFunc:cme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dme=Ic+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,fme=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,pme=St({opSnippet:dme,packedOpSnippet:fme,cpuKernelImpl:fae}),mme={kernelName:gf,backendName:"webgl",kernelFunc:pme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gme=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,vme=St({opSnippet:gme}),yme={kernelName:mf,backendName:"webgl",kernelFunc:vme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xme=Ic+`
  return sin(x);
`,wme=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Vl}
  return result;
`,bme=St({opSnippet:xme,packedOpSnippet:wme}),Cme={kernelName:ff,backendName:"webgl",kernelFunc:bme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sme=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,kme=St({opSnippet:Sme}),Eme={kernelName:pf,backendName:"webgl",kernelFunc:kme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ime=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Tme=St({opSnippet:Ime}),_me={kernelName:vf,backendName:"webgl",kernelFunc:Tme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nme=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,paddings:o}=r;O(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((m,y)=>m*y),l=[[0,0]];l.push(...o);for(let m=1+i.length;m<s.shape.length;++m)l.push([0,0]);const u=[],c=JL({inputs:{x:s},backend:t,attrs:{paddings:l,constantValue:0}}),h=$f(c.shape,i,a,!1),d=Df(h.length,i.length,!1),f=Af(c.shape,i,a,!1),p=Be({inputs:{x:c},backend:t,attrs:{shape:h}}),v=_r({inputs:{x:p},backend:t,attrs:{perm:d}}),g=Be({inputs:{x:v},backend:t,attrs:{shape:f}});return u.push(c),u.push(p),u.push(v),u.forEach(m=>t.disposeIntermediateTensorInfo(m)),g},$me={kernelName:q0,backendName:"webgl",kernelFunc:Nme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dme(n){const{inputs:e,backend:t}=n,{indices:r,values:s,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=t.readSync(r.dataId),l=t.readSync(s.dataId),u=t.readSync(i.dataId),c=t.readSync(o.dataId)[0],[h,d,f,p,v]=mae(a,r.shape,r.dtype,l,s.dtype,u,c);return[t.makeTensorInfo(d,r.dtype,h),t.makeTensorInfo([d[0]],s.dtype,f),t.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),t.makeTensorInfo([v.length],r.dtype,new Int32Array(v))]}const Ame={kernelName:BD,backendName:"webgl",kernelFunc:Dme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rme(n){const{inputs:e,backend:t}=n,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(t.readSync(s.dataId)),a=t.readSync(r.dataId),l=Array.from(t.readSync(i.dataId)),[u,c,h]=gae(a,r.shape,r.dtype,o,l);return[t.makeTensorInfo(c,r.dtype,u),t.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}const Ome={kernelName:zD,backendName:"webgl",kernelFunc:Rme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fme(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=t.readSync(r.dataId),a=t.readSync(s.dataId),l=t.readSync(i.dataId),[u,c]=kL(o,r.shape,r.dtype,a,l,!0);return t.makeTensorInfo(c,r.dtype,u)}const Lme={kernelName:UD,backendName:"webgl",kernelFunc:Fme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pme(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=t.readSync(r.dataId),a=t.readSync(s.dataId),l=t.readSync(i.dataId),[u,c]=kL(o,r.shape,r.dtype,a,l);return t.makeTensorInfo(c,r.dtype,u)}const Mme={kernelName:VD,backendName:"webgl",kernelFunc:Pme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bme(n){const{inputs:e,backend:t,attrs:r}=n,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:h,outputSize:d}=Pl(i,s,a),f=!1;if(i.dtype==="string"){const m=t.bufferSync(s),y=t.bufferSync(i),w=ca(t.readSync(o.dataId)[0]),x=dae(m,y,a,d,c,u,l,h,w,f);return t.makeTensorInfo(a,x.dtype,x.values)}const p=new GC(u,l,s.shape.length,i.shape.length,h,[d,1],f),v=t.runWebGLProgram(p,[i,s,o],i.dtype),g=Be({inputs:{x:v},backend:t,attrs:{shape:a}});return t.disposeIntermediateTensorInfo(v),g}const zme={kernelName:WD,backendName:"webgl",kernelFunc:Bme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ume(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=mt(o,s.shape)[0],l=rC(s,i,a),u=s.shape.length,c=new Array(u).fill(0),h=s.shape.slice();return l.map(d=>{const f=[...h];f[a]=d;const p=Tc({inputs:{x:s},backend:t,attrs:{begin:c,size:f}});return c[a]+=d,p})}const Vme={kernelName:K0,backendName:"webgl",kernelFunc:Ume};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aT="return sqrt(x);",Wme=St({opSnippet:aT,packedOpSnippet:aT,cpuKernelImpl:vae}),Gme={kernelName:yf,backendName:"webgl",kernelFunc:Wme};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jme="return x * x;",Hme=St({opSnippet:jme}),qme={kernelName:Bb,backendName:"webgl",kernelFunc:Hme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lT="return (a - b) * (a - b);",Kme=ur({opSnippet:lT,packedOpSnippet:lT}),Xme={kernelName:xf,backendName:"webgl",kernelFunc:Kme};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yme(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const i=t.readSync(s.dataId),o=Co(i),a=yae(o,"string",r);return t.makeTensorInfo(s.shape,"string",a)}const Zme={kernelName:zb,backendName:"webgl",kernelFunc:Yme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qme({inputs:n,attrs:e,backend:t}){const{x:r}=n,s=Ys+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new Pi(r.shape,s);return t.runWebGLProgram(i,[r],r.dtype)}const Jme={kernelName:kf,backendName:"webgl",kernelFunc:Qme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ege{constructor(e,t,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,i=Ut(r.length),o=Ut(r.length);let a="";if(s===1)a="coords * strides + begin";else{let l=0;a=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${t});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tge(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:h,shrinkAxisMask:d}=r,{finalShapeSparse:f,finalShape:p,isIdentity:v,sliceDim0:g,isSimpleSlice:m,begin:y,end:w,strides:x}=B2(s.shape,i,o,a,l,u,c,h,d);let b;if(v)b=Be({inputs:{x:s},backend:t,attrs:{shape:p}});else if(g||m){O(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const k=L2(y,w,x),E=Tc({inputs:{x:s},backend:t,attrs:{begin:y,size:k}});b=Be({inputs:{x:E},backend:t,attrs:{shape:p}}),t.disposeIntermediateTensorInfo(E)}else if(t.shouldExecuteOnCPU([s])){const E=t.readSync(s.dataId),T=pt(s.shape,s.dtype,E),_=xae(f,T,x,y);b=t.makeTensorInfo(p,s.dtype,_.values)}else{const E=new ege(y,x,f);b=t.runWebGLProgram(E,[s],s.dtype)}const C=Be({inputs:{x:b},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(b),C}const nge={kernelName:Ub,backendName:"webgl",kernelFunc:tge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rge(n){const{inputs:e,backend:t,attrs:r}=n,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:h}=e,d=t.readSync(c.dataId),f=t.readSync(h.dataId),[p,v]=wae(d,f,s,i,o,a,l,u);return[t.makeTensorInfo([p.length],"string",p),t.makeTensorInfo(h.shape,"int32",v)]}const sge={kernelName:GD,backendName:"webgl",kernelFunc:rge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ige(n){const{inputs:e,backend:t,attrs:r}=n,{skipEmpty:s}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=t.readSync(i.dataId),l=t.readSync(o.dataId)[0],[u,c,h]=bae(a,l,s),d=c.length;return[t.makeTensorInfo([d,2],"int32",u),t.makeTensorInfo([d],"string",c),t.makeTensorInfo([2],"int32",new Int32Array(h))]}const oge={kernelName:jD,backendName:"webgl",kernelFunc:ige};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function age(n){const{inputs:e,backend:t,attrs:r}=n,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=t.readSync(i.dataId),a=Cae(o,s);return t.makeTensorInfo(i.shape,"int32",a)}const lge={kernelName:HD,backendName:"webgl",kernelFunc:age};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uge="return tan(x);",cge=St({opSnippet:uge}),hge={kernelName:bf,backendName:"webgl",kernelFunc:cge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dge=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,fge=St({opSnippet:dge}),pge={kernelName:Cf,backendName:"webgl",kernelFunc:fge};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mge(n){const{inputs:e,backend:t,attrs:r}=n,{tensor:s,indices:i,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:h}=Pl(o,i,s.shape),d=[h/u,u];if(h===0)return t.makeTensorInfo(s.shape,i.dtype);const f=Be({inputs:{x:i},backend:t,attrs:{shape:[l,a]}}),p=Be({inputs:{x:o},backend:t,attrs:{shape:[l,u]}}),v=Be({inputs:{x:s},backend:t,attrs:{shape:d}}),g=new GC(l,a,f.shape.length,p.shape.length,c,d,!1,!0),m=t.runWebGLProgram(g,[p,f,v],v.dtype),y=Be({inputs:{x:m},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(m),y}const gge={kernelName:PD,backendName:"webgl",kernelFunc:mge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vge{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[o]*t[o];this.outputShape=r,this.rank=r.length;const s=Ut(this.rank),i=yge(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function yge(n){const e=n.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${n[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<n.length;s++)r.push(`imod(${t[s]}, ${n[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tP(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reps:i}=r;if(s.dtype==="string"||s.shape.length>5){const l=t.readSync(s.dataId),u=s.dtype==="string"?l.map(d=>ca(d)):l,c=pt(s.shape,s.dtype,u),h=kae(c,i);return t.makeTensorInfo(h.shape,h.dtype,h.values)}const o=new vge(s.shape,i);return t.runWebGLProgram(o,[s],s.dtype)}const xge={kernelName:Sf,backendName:"webgl",kernelFunc:tP};class wge{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class bge{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fa(n,e){e!==null&&n.disposeIntermediateTensorInfo(e)}function uT(n){let e=1;for(;e<n;)e*=2;return e}function Cge(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{k:i,sorted:o}=r,a=me().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=me().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=s.shape,c=u[u.length-1];if(t.shouldExecuteOnCPU([s])||c<a||i>l){const _=t.readSync(s.dataId),[A,P]=Eae(_,u,s.dtype,i,o);return[t.makeTensorInfo(A.shape,A.dtype,A.values),t.makeTensorInfo(P.shape,P.dtype,P.values)]}if(i===0)return u[u.length-1]=0,[t.makeTensorInfo(u,s.dtype,[]),t.makeTensorInfo(u,"int32",[])];if(c===1)return[s,Hf({attrs:{shape:u,dtype:"int32",value:0},backend:t})];const h=t.texData.get(s.dataId),d=h!==null&&h.isPacked,f=d?t.unpackTensor(s):s,v=we(u)/c,g=Be({inputs:{x:f},attrs:{shape:[v,c]},backend:t});d&&Fa(t,f);const m=uT(i),y=uT(c);let w=null;const x=()=>w===null?[g,g]:[g,w],b=(_,A,P)=>{const j=x(),X=new wge(P),M=[[c],[w===null?1:0],[Number.NEGATIVE_INFINITY],[_],[A]],W=w;w=t.runWebGLProgram(X,j,"int32",M),Fa(t,W)};for(let _=1;_<m;_*=2){const A=_*2;for(let P=_;P>=1;P/=2)b(A,P,[v,y])}for(let _=y;_>m;_/=2){const A=x(),P=new bge([v,_/2]),X=[[c],[w===null?1:0],[m]],F=w;w=t.runWebGLProgram(P,A,"int32",X),Fa(t,F);const M=m/2,W=M*2;for(let D=M;D>=1;D/=2)b(W,D,w.shape)}let C=w;w=Tc({inputs:{x:w},backend:t,attrs:{begin:0,size:[v,i]}}),Fa(t,C);let k=qL({inputs:{x:g,indices:w},backend:t,attrs:{axis:1,batchDims:1}});Fa(t,g);const E=u.slice(0,-1);E.push(i),C=w,w=Be({inputs:{x:w},attrs:{shape:E},backend:t}),Fa(t,C);const T=k;return k=Be({inputs:{x:k},attrs:{shape:E},backend:t}),Fa(t,T),[k,w]}const Sge={kernelName:Vb,backendName:"webgl",kernelFunc:Cge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kge{constructor(e,t,r,s,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=r==="nearest"?1:2;let l;switch(s){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ege(n){const{inputs:e,backend:t,attrs:r}=n,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:u}=r,[c,h,d,f]=s.shape,[p,v]=u??[h,d],g=[c,p,v,f],m=new kge(h,d,o,a,l,g);return t.runWebGLProgram(m,[s,i],"float32")}const Ige={kernelName:Wb,backendName:"webgl",kernelFunc:Ege};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tge(n){const{inputs:e,attrs:t,backend:r}=n,{axis:s}=t,{x:i}=e;Wf(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(i.dataId),{outputValues:a,outputShape:l,indices:u}=Iae(o,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const _ge={kernelName:Gb,backendName:"webgl",kernelFunc:Tge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nge(n){const{inputs:e,backend:t,attrs:r}=n,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s,a=o.shape.length,l=s.shape[i],u=new Array(a-1);let c=0;for(let v=0;v<a;v++)v!==i&&(u[c++]=o.shape[v]);const h=[],d=new Array(a).fill(0),f=o.shape.slice();f[i]=1;const p=new Array(l);for(let v=0;v<p.length;v++){d[i]=v;const g=Tc({inputs:{x:o},backend:t,attrs:{begin:d,size:f}}),m=Be({inputs:{x:g},backend:t,attrs:{shape:u}});p[v]=m,h.push(g)}return h.forEach(v=>t.disposeIntermediateTensorInfo(v)),p}const $ge={kernelName:Y0,backendName:"webgl",kernelFunc:Nge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dge{constructor(e,t){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/r);this.outputShape=[s,a];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,h=r%4,d=`
        sumValue += dot(values, segFilter);
    `;let f="";i%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let p="";i%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${c};
        if (${h===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${h===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${h===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Age(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,segmentIds:i}=e,{numSegments:o}=r,a=s.shape.length,l=[];let u=0;const c=un([u],a);let h=s;c!=null&&(h=_r({inputs:{x:s},backend:t,attrs:{perm:c}}),l.push(h),u=wn(1,a)[0]);const d=MR(h.shape,u,o),f=we([h.shape[u]]),p=Be({inputs:{x:h},backend:t,attrs:{shape:[-1,f]}});l.push(p);const v=qb(s.dtype),g=(x,b,C,k,E)=>{const T=x.shape[0],_=x.shape[1],A=PR(_,E),P={windowSize:A,inSize:_,batchSize:T,numSegments:E},j=new Dge(P,b),X=t.compileAndRun(j,[x,C],k);if(l.push(X),X.shape[1]===E)return X;const F=eP({backend:t,attrs:{start:0,stop:E,step:1,dtype:"float32"}}),M=tP({inputs:{x:F},backend:t,attrs:{reps:[_/A]}});return l.push(F),l.push(M),g(X,b,M,k,E)},m=g(p,"unsortedSegmentSum",i,v,o),y=Be({inputs:{x:m},backend:t,attrs:{shape:d}});let w=y;if(c!=null){l.push(y);const x=Ea(c);w=_r({inputs:{x:w},backend:t,attrs:{perm:x}})}return l.forEach(x=>t.disposeIntermediateTensorInfo(x)),w}const Rge={kernelName:Z0,backendName:"webgl",kernelFunc:Age};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oge=[vle,xle,Cle,Ele,Tle,$le,Ale,Ole,Mle,zle,Wle,Hle,Xle,Jle,nue,sue,oue,cue,due,pue,yue,Eue,Tue,Due,Rue,Bue,Uue,jue,ele,Kue,Jue,rce,uce,dce,pce,gce,yce,Cce,Ece,_ce,$ce,Ace,Oce,Pce,Bce,Wce,jce,Kce,Zce,Jce,rhe,ahe,hhe,phe,vhe,yhe,whe,Che,khe,Ihe,_he,Ahe,Fhe,Mhe,zhe,Whe,Hhe,Yhe,ede,Jae,nde,Zue,ide,lde,hde,nle,mde,xde,bde,Ede,_de,Ade,Fde,Bde,Wde,Hde,Kde,Qde,efe,nfe,ofe,lfe,cfe,dfe,pfe,yfe,Cfe,Ife,Ofe,ile,Mfe,Ufe,Gfe,qfe,Fue,Yfe,Qfe,epe,rpe,ape,sle,upe,hpe,fpe,mpe,gpe,Lue,$fe,xpe,Spe,Tpe,ale,Dpe,Ope,Mpe,Upe,jpe,qpe,Ype,Jpe,nme,ime,lme,hme,mme,yme,Cme,Eme,Sue,Afe,_me,$me,Ame,Ome,Lme,Mme,zme,Vme,Gme,qme,Xme,Zme,Jme,nge,sge,oge,lge,Dfe,ple,hge,pge,gge,xge,Sge,Ige,mle,_ge,$ge,Rge,Zfe];for(const n of Oge)KD(n);async function Fge(){try{const n=await YZ("model/model.json");return console.log("Model successfully loaded!"),n}catch(n){return console.error("Error loading the model:",n),null}}function Lge(n){console.log(n);let e=n.toLowerCase();return e=e.replace(/[^a-zA-Z\s.!?,']/g," "),e=e.replace(/\s+[a-zA-Z]\s+/g," "),e=e.replace(/\s+/g," "),e}function Pge(n,e){const t=new Array(e).fill(0);return n.forEach((r,s)=>{t[s]=r}),t}async function Mge(){try{const e=await(await fetch("model/tokenizer.json")).json();return console.log("Tokenizer data loaded!"),e}catch(n){return console.error("Error loading the tokenizer:",n),null}}function Bge(n,e){if(!e)return console.error("Tokenizer data is not available."),[];const t=n.split(" "),r=[];return t.forEach(s=>{e[s]!==void 0&&r.push(e[s])}),r}function zge(n,e){const t=n.slice(),r=[];for(;t.length>e;)r.push(t.splice(0,e));return r.push(t),r}function Uge(n,e){if(n.length!==e.length)throw new Error("Arrays must have the same length.");const t=[];for(let r=0;r<n.length;r++)t.push(n[r]+e[r]);return t}async function Vge(n,e,t){if(!e)return console.error("Model is not available."),null;if(!t)return console.error("Tokenizer data is not available."),null;const r=["joy","anger","sadness","fear","neutral"],s=100;n=Lge(n);const i=Bge(n,t);console.log(i,"tokenizedTexts");const o=zge(i,s);console.log(o);const a=o[o.length-1],l=Pge(a,s);o[o.length-1]=l;let u=[0,0,0,0,0];for(let h=0;h<o.length;h++){const d=o[h],f=Kp([d],[1,s]),p=e.predict(f),v=Array.from(p.dataSync());u=Uge(u,v)}console.log("totalEmotionProbability :>> ",u);const c=u.indexOf(Math.max(...u));return r[c]}function Wge(n){var e="";switch(n){case"joy":e="0ra1sgdNkKatWh3LOMEGCa";break;case"sadness":e="2hi47ni1BUFQMoDKACjgTZ";break;case"fear":e="5EbEfrwJPJEe4gLneh6onP";break;case"anger":e="6QZnHBnKUjL1TCxzDk2V5o";break}return`https://open.spotify.com/embed/playlist/${e}?utm_source=generator`}function Gge({storyText:n,setIsLoading:e}){const[t,r]=Re.useState(""),[s,i]=Re.useState(!1);return Re.useEffect(()=>{if(!n.trim()){e(!1),i(!0);return}e(!0);async function a(){const l=await Fge(),u=await Mge(),c=await Vge(n,l,u);r(c),i(!1),e(!1),console.log(c,"prediction")}a()},[n,e]),at.jsx("div",{className:"spotifyContainer",children:at.jsxs("div",{id:"spotifyWrapper",className:`${s?"hide-embed":""}`,"data-is-down":s,children:[at.jsx("div",{id:"arrowUpDown",onClick:()=>i(o=>!o),children:at.jsx("i",{id:"arrowIcon",className:`fa-solid fa-arrow-${s?"up":"down"} fa-xl`,style:{color:"white"}})}),t===""||t==="neutral"?at.jsx("p",{style:{fontSize:"2rem",marginBottom:"10px",color:"white",margin:"auto 0"},children:t===""?"No Emotion":"Neutral"}):at.jsx("iframe",{id:"spotifyPlaylist",style:{borderRadius:"12px",width:"100%",height:"100%"},src:Wge(t),frameBorder:"0",allowFullScreen:"",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"},t)]})})}var nP={exports:{}};(function(n,e){(function(r,s){n.exports=s()})(typeof self<"u"?self:gn,function(){return function(t){var r={};function s(i){if(r[i])return r[i].exports;var o=r[i]={i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=t,s.c=r,s.d=function(i,o,a){s.o(i,o)||Object.defineProperty(i,o,{configurable:!1,enumerable:!0,get:a})},s.n=function(i){var o=i&&i.__esModule?function(){return i.default}:function(){return i};return s.d(o,"a",o),o},s.o=function(i,o){return Object.prototype.hasOwnProperty.call(i,o)},s.p="/",s(s.s=7)}([function(t,r,s){function i(o,a,l,u,c,h,d,f){if(!o){var p;if(a===void 0)p=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var v=[l,u,c,h,d,f],g=0;p=new Error(a.replace(/%s/g,function(){return v[g++]})),p.name="Invariant Violation"}throw p.framesToPop=1,p}}t.exports=i},function(t,r,s){function i(a){return function(){return a}}var o=function(){};o.thatReturns=i,o.thatReturnsFalse=i(!1),o.thatReturnsTrue=i(!0),o.thatReturnsNull=i(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(a){return a},t.exports=o},function(t,r,s){/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function l(c){if(c==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(c)}function u(){try{if(!Object.assign)return!1;var c=new String("abc");if(c[5]="de",Object.getOwnPropertyNames(c)[0]==="5")return!1;for(var h={},d=0;d<10;d++)h["_"+String.fromCharCode(d)]=d;var f=Object.getOwnPropertyNames(h).map(function(v){return h[v]});if(f.join("")!=="0123456789")return!1;var p={};return"abcdefghijklmnopqrst".split("").forEach(function(v){p[v]=v}),Object.keys(Object.assign({},p)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}t.exports=u()?Object.assign:function(c,h){for(var d,f=l(c),p,v=1;v<arguments.length;v++){d=Object(arguments[v]);for(var g in d)o.call(d,g)&&(f[g]=d[g]);if(i){p=i(d);for(var m=0;m<p.length;m++)a.call(d,p[m])&&(f[p[m]]=d[p[m]])}}return f}},function(t,r,s){var i=s(1),o=i;t.exports=o},function(t,r,s){var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";t.exports=i},function(t,r,s){var i={};t.exports=i},function(t,r,s){function i(o,a,l,u,c){}t.exports=i},function(t,r,s){Object.defineProperty(r,"__esModule",{value:!0});var i=Object.assign||function(x){for(var b=1;b<arguments.length;b++){var C=arguments[b];for(var k in C)Object.prototype.hasOwnProperty.call(C,k)&&(x[k]=C[k])}return x},o=function(){function x(b,C){for(var k=0;k<C.length;k++){var E=C[k];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(b,E.key,E)}}return function(b,C,k){return C&&x(b.prototype,C),k&&x(b,k),b}}(),a=s(8),l=p(a),u=s(11),c=p(u),h=s(14),d=f(h);function f(x){if(x&&x.__esModule)return x;var b={};if(x!=null)for(var C in x)Object.prototype.hasOwnProperty.call(x,C)&&(b[C]=x[C]);return b.default=x,b}function p(x){return x&&x.__esModule?x:{default:x}}function v(x,b){var C={};for(var k in x)b.indexOf(k)>=0||Object.prototype.hasOwnProperty.call(x,k)&&(C[k]=x[k]);return C}function g(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function m(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function y(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var w=function(x){y(b,x);function b(){var C,k,E,T;g(this,b);for(var _=arguments.length,A=Array(_),P=0;P<_;P++)A[P]=arguments[P];return T=(k=(E=m(this,(C=b.__proto__||Object.getPrototypeOf(b)).call.apply(C,[this].concat(A))),E),E.state={delayed:E.props.delay>0},k),m(E,T)}return o(b,[{key:"componentDidMount",value:function(){var k=this,E=this.props.delay,T=this.state.delayed;T&&(this.timeout=setTimeout(function(){k.setState({delayed:!1})},E))}},{key:"componentWillUnmount",value:function(){var k=this.timeout;k&&clearTimeout(k)}},{key:"render",value:function(){var k=this.props,E=k.color;k.delay;var T=k.type,_=k.height,A=k.width,P=v(k,["color","delay","type","height","width"]),j=this.state.delayed?"blank":T,X=d[j],F={fill:E,height:_,width:A};return l.default.createElement("div",i({style:F,dangerouslySetInnerHTML:{__html:X}},P))}}]),b}(a.Component);w.propTypes={color:c.default.string,delay:c.default.number,type:c.default.string,height:c.default.oneOfType([c.default.string,c.default.number]),width:c.default.oneOfType([c.default.string,c.default.number])},w.defaultProps={color:"#fff",delay:0,type:"balls",height:64,width:64},r.default=w},function(t,r,s){t.exports=s(9)},function(t,r,s){/** @license React v16.3.2
 * react.production.min.js
 *
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i=s(2),o=s(0),a=s(5),l=s(1),u=typeof Symbol=="function"&&Symbol.for,c=u?Symbol.for("react.element"):60103,h=u?Symbol.for("react.portal"):60106,d=u?Symbol.for("react.fragment"):60107,f=u?Symbol.for("react.strict_mode"):60108,p=u?Symbol.for("react.provider"):60109,v=u?Symbol.for("react.context"):60110,g=u?Symbol.for("react.async_mode"):60111,m=u?Symbol.for("react.forward_ref"):60112,y=typeof Symbol=="function"&&Symbol.iterator;function w(G){for(var J=arguments.length-1,fe="http://reactjs.org/docs/error-decoder.html?invariant="+G,ve=0;ve<J;ve++)fe+="&args[]="+encodeURIComponent(arguments[ve+1]);o(!1,"Minified React error #"+G+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",fe)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}};function b(G,J,fe){this.props=G,this.context=J,this.refs=a,this.updater=fe||x}b.prototype.isReactComponent={},b.prototype.setState=function(G,J){typeof G!="object"&&typeof G!="function"&&G!=null&&w("85"),this.updater.enqueueSetState(this,G,J,"setState")},b.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function C(){}C.prototype=b.prototype;function k(G,J,fe){this.props=G,this.context=J,this.refs=a,this.updater=fe||x}var E=k.prototype=new C;E.constructor=k,i(E,b.prototype),E.isPureReactComponent=!0;var T={current:null},_=Object.prototype.hasOwnProperty,A={key:!0,ref:!0,__self:!0,__source:!0};function P(G,J,fe){var ve=void 0,be={},$e=null,Pe=null;if(J!=null)for(ve in J.ref!==void 0&&(Pe=J.ref),J.key!==void 0&&($e=""+J.key),J)_.call(J,ve)&&!A.hasOwnProperty(ve)&&(be[ve]=J[ve]);var Ge=arguments.length-2;if(Ge===1)be.children=fe;else if(1<Ge){for(var Xe=Array(Ge),Je=0;Je<Ge;Je++)Xe[Je]=arguments[Je+2];be.children=Xe}if(G&&G.defaultProps)for(ve in Ge=G.defaultProps,Ge)be[ve]===void 0&&(be[ve]=Ge[ve]);return{$$typeof:c,type:G,key:$e,ref:Pe,props:be,_owner:T.current}}function j(G){return typeof G=="object"&&G!==null&&G.$$typeof===c}function X(G){var J={"=":"=0",":":"=2"};return"$"+(""+G).replace(/[=:]/g,function(fe){return J[fe]})}var F=/\/+/g,M=[];function W(G,J,fe,ve){if(M.length){var be=M.pop();return be.result=G,be.keyPrefix=J,be.func=fe,be.context=ve,be.count=0,be}return{result:G,keyPrefix:J,func:fe,context:ve,count:0}}function D(G){G.result=null,G.keyPrefix=null,G.func=null,G.context=null,G.count=0,10>M.length&&M.push(G)}function z(G,J,fe,ve){var be=typeof G;(be==="undefined"||be==="boolean")&&(G=null);var $e=!1;if(G===null)$e=!0;else switch(be){case"string":case"number":$e=!0;break;case"object":switch(G.$$typeof){case c:case h:$e=!0}}if($e)return fe(ve,G,J===""?"."+K(G,0):J),1;if($e=0,J=J===""?".":J+":",Array.isArray(G))for(var Pe=0;Pe<G.length;Pe++){be=G[Pe];var Ge=J+K(be,Pe);$e+=z(be,Ge,fe,ve)}else if(G===null||typeof G>"u"?Ge=null:(Ge=y&&G[y]||G["@@iterator"],Ge=typeof Ge=="function"?Ge:null),typeof Ge=="function")for(G=Ge.call(G),Pe=0;!(be=G.next()).done;)be=be.value,Ge=J+K(be,Pe++),$e+=z(be,Ge,fe,ve);else be==="object"&&(fe=""+G,w("31",fe==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":fe,""));return $e}function K(G,J){return typeof G=="object"&&G!==null&&G.key!=null?X(G.key):J.toString(36)}function ie(G,J){G.func.call(G.context,J,G.count++)}function V(G,J,fe){var ve=G.result,be=G.keyPrefix;G=G.func.call(G.context,J,G.count++),Array.isArray(G)?Z(G,ve,fe,l.thatReturnsArgument):G!=null&&(j(G)&&(J=be+(!G.key||J&&J.key===G.key?"":(""+G.key).replace(F,"$&/")+"/")+fe,G={$$typeof:c,type:G.type,key:J,ref:G.ref,props:G.props,_owner:G._owner}),ve.push(G))}function Z(G,J,fe,ve,be){var $e="";fe!=null&&($e=(""+fe).replace(F,"$&/")+"/"),J=W(J,$e,ve,be),G==null||z(G,"",V,J),D(J)}var de={Children:{map:function(G,J,fe){if(G==null)return G;var ve=[];return Z(G,ve,null,J,fe),ve},forEach:function(G,J,fe){if(G==null)return G;J=W(null,null,J,fe),G==null||z(G,"",ie,J),D(J)},count:function(G){return G==null?0:z(G,"",l.thatReturnsNull,null)},toArray:function(G){var J=[];return Z(G,J,null,l.thatReturnsArgument),J},only:function(G){return j(G)||w("143"),G}},createRef:function(){return{current:null}},Component:b,PureComponent:k,createContext:function(G,J){return J===void 0&&(J=null),G={$$typeof:v,_calculateChangedBits:J,_defaultValue:G,_currentValue:G,_changedBits:0,Provider:null,Consumer:null},G.Provider={$$typeof:p,_context:G},G.Consumer=G},forwardRef:function(G){return{$$typeof:m,render:G}},Fragment:d,StrictMode:f,unstable_AsyncMode:g,createElement:P,cloneElement:function(G,J,fe){G==null&&w("267",G);var ve=void 0,be=i({},G.props),$e=G.key,Pe=G.ref,Ge=G._owner;if(J!=null){J.ref!==void 0&&(Pe=J.ref,Ge=T.current),J.key!==void 0&&($e=""+J.key);var Xe=void 0;G.type&&G.type.defaultProps&&(Xe=G.type.defaultProps);for(ve in J)_.call(J,ve)&&!A.hasOwnProperty(ve)&&(be[ve]=J[ve]===void 0&&Xe!==void 0?Xe[ve]:J[ve])}if(ve=arguments.length-2,ve===1)be.children=fe;else if(1<ve){Xe=Array(ve);for(var Je=0;Je<ve;Je++)Xe[Je]=arguments[Je+2];be.children=Xe}return{$$typeof:c,type:G.type,key:$e,ref:Pe,props:be,_owner:Ge}},createFactory:function(G){var J=P.bind(null,G);return J.type=G,J},isValidElement:j,version:"16.3.2",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:T,assign:i}},ge=Object.freeze({default:de}),ye=ge&&de||ge;t.exports=ye.default?ye.default:ye},function(t,r,s){},function(t,r,s){t.exports=s(13)()},function(t,r,s){var i=s(1),o=s(0),a=s(3),l=s(2),u=s(4),c=s(6);t.exports=function(h,d){var f=typeof Symbol=="function"&&Symbol.iterator,p="@@iterator";function v(V){var Z=V&&(f&&V[f]||V[p]);if(typeof Z=="function")return Z}var g="<<anonymous>>",m={array:b("array"),bool:b("boolean"),func:b("function"),number:b("number"),object:b("object"),string:b("string"),symbol:b("symbol"),any:C(),arrayOf:k,element:E(),instanceOf:T,node:j(),objectOf:A,oneOf:_,oneOfType:P,shape:X,exact:F};function y(V,Z){return V===Z?V!==0||1/V===1/Z:V!==V&&Z!==Z}function w(V){this.message=V,this.stack=""}w.prototype=Error.prototype;function x(V){function Z(ge,ye,G,J,fe,ve,be){return J=J||g,ve=ve||G,be!==u&&d&&o(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types"),ye[G]==null?ge?ye[G]===null?new w("The "+fe+" `"+ve+"` is marked as required "+("in `"+J+"`, but its value is `null`.")):new w("The "+fe+" `"+ve+"` is marked as required in "+("`"+J+"`, but its value is `undefined`.")):null:V(ye,G,J,fe,ve)}var de=Z.bind(null,!1);return de.isRequired=Z.bind(null,!0),de}function b(V){function Z(de,ge,ye,G,J,fe){var ve=de[ge],be=D(ve);if(be!==V){var $e=z(ve);return new w("Invalid "+G+" `"+J+"` of type "+("`"+$e+"` supplied to `"+ye+"`, expected ")+("`"+V+"`."))}return null}return x(Z)}function C(){return x(i.thatReturnsNull)}function k(V){function Z(de,ge,ye,G,J){if(typeof V!="function")return new w("Property `"+J+"` of component `"+ye+"` has invalid PropType notation inside arrayOf.");var fe=de[ge];if(!Array.isArray(fe)){var ve=D(fe);return new w("Invalid "+G+" `"+J+"` of type "+("`"+ve+"` supplied to `"+ye+"`, expected an array."))}for(var be=0;be<fe.length;be++){var $e=V(fe,be,ye,G,J+"["+be+"]",u);if($e instanceof Error)return $e}return null}return x(Z)}function E(){function V(Z,de,ge,ye,G){var J=Z[de];if(!h(J)){var fe=D(J);return new w("Invalid "+ye+" `"+G+"` of type "+("`"+fe+"` supplied to `"+ge+"`, expected a single ReactElement."))}return null}return x(V)}function T(V){function Z(de,ge,ye,G,J){if(!(de[ge]instanceof V)){var fe=V.name||g,ve=ie(de[ge]);return new w("Invalid "+G+" `"+J+"` of type "+("`"+ve+"` supplied to `"+ye+"`, expected ")+("instance of `"+fe+"`."))}return null}return x(Z)}function _(V){if(!Array.isArray(V))return i.thatReturnsNull;function Z(de,ge,ye,G,J){for(var fe=de[ge],ve=0;ve<V.length;ve++)if(y(fe,V[ve]))return null;var be=JSON.stringify(V);return new w("Invalid "+G+" `"+J+"` of value `"+fe+"` "+("supplied to `"+ye+"`, expected one of "+be+"."))}return x(Z)}function A(V){function Z(de,ge,ye,G,J){if(typeof V!="function")return new w("Property `"+J+"` of component `"+ye+"` has invalid PropType notation inside objectOf.");var fe=de[ge],ve=D(fe);if(ve!=="object")return new w("Invalid "+G+" `"+J+"` of type "+("`"+ve+"` supplied to `"+ye+"`, expected an object."));for(var be in fe)if(fe.hasOwnProperty(be)){var $e=V(fe,be,ye,G,J+"."+be,u);if($e instanceof Error)return $e}return null}return x(Z)}function P(V){if(!Array.isArray(V))return i.thatReturnsNull;for(var Z=0;Z<V.length;Z++){var de=V[Z];if(typeof de!="function")return a(!1,"Invalid argument supplied to oneOfType. Expected an array of check functions, but received %s at index %s.",K(de),Z),i.thatReturnsNull}function ge(ye,G,J,fe,ve){for(var be=0;be<V.length;be++){var $e=V[be];if($e(ye,G,J,fe,ve,u)==null)return null}return new w("Invalid "+fe+" `"+ve+"` supplied to "+("`"+J+"`."))}return x(ge)}function j(){function V(Z,de,ge,ye,G){return M(Z[de])?null:new w("Invalid "+ye+" `"+G+"` supplied to "+("`"+ge+"`, expected a ReactNode."))}return x(V)}function X(V){function Z(de,ge,ye,G,J){var fe=de[ge],ve=D(fe);if(ve!=="object")return new w("Invalid "+G+" `"+J+"` of type `"+ve+"` "+("supplied to `"+ye+"`, expected `object`."));for(var be in V){var $e=V[be];if($e){var Pe=$e(fe,be,ye,G,J+"."+be,u);if(Pe)return Pe}}return null}return x(Z)}function F(V){function Z(de,ge,ye,G,J){var fe=de[ge],ve=D(fe);if(ve!=="object")return new w("Invalid "+G+" `"+J+"` of type `"+ve+"` "+("supplied to `"+ye+"`, expected `object`."));var be=l({},de[ge],V);for(var $e in be){var Pe=V[$e];if(!Pe)return new w("Invalid "+G+" `"+J+"` key `"+$e+"` supplied to `"+ye+"`.\nBad object: "+JSON.stringify(de[ge],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(V),null,"  "));var Ge=Pe(fe,$e,ye,G,J+"."+$e,u);if(Ge)return Ge}return null}return x(Z)}function M(V){switch(typeof V){case"number":case"string":case"undefined":return!0;case"boolean":return!V;case"object":if(Array.isArray(V))return V.every(M);if(V===null||h(V))return!0;var Z=v(V);if(Z){var de=Z.call(V),ge;if(Z!==V.entries){for(;!(ge=de.next()).done;)if(!M(ge.value))return!1}else for(;!(ge=de.next()).done;){var ye=ge.value;if(ye&&!M(ye[1]))return!1}}else return!1;return!0;default:return!1}}function W(V,Z){return V==="symbol"||Z["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&Z instanceof Symbol}function D(V){var Z=typeof V;return Array.isArray(V)?"array":V instanceof RegExp?"object":W(Z,V)?"symbol":Z}function z(V){if(typeof V>"u"||V===null)return""+V;var Z=D(V);if(Z==="object"){if(V instanceof Date)return"date";if(V instanceof RegExp)return"regexp"}return Z}function K(V){var Z=z(V);switch(Z){case"array":case"object":return"an "+Z;case"boolean":case"date":case"regexp":return"a "+Z;default:return Z}}function ie(V){return!V.constructor||!V.constructor.name?g:V.constructor.name}return m.checkPropTypes=c,m.PropTypes=m,m}},function(t,r,s){var i=s(1),o=s(0),a=s(4);t.exports=function(){function l(h,d,f,p,v,g){g!==a&&o(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}l.isRequired=l;function u(){return l}var c={array:l,bool:l,func:l,number:l,object:l,string:l,symbol:l,any:l,arrayOf:u,element:l,instanceOf:u,node:l,objectOf:u,oneOf:u,oneOfType:u,shape:u,exact:u};return c.checkPropTypes=i,c.PropTypes=c,c}},function(t,r,s){Object.defineProperty(r,"__esModule",{value:!0});var i=s(15);Object.defineProperty(r,"blank",{enumerable:!0,get:function(){return p(i).default}});var o=s(16);Object.defineProperty(r,"balls",{enumerable:!0,get:function(){return p(o).default}});var a=s(17);Object.defineProperty(r,"bars",{enumerable:!0,get:function(){return p(a).default}});var l=s(18);Object.defineProperty(r,"bubbles",{enumerable:!0,get:function(){return p(l).default}});var u=s(19);Object.defineProperty(r,"cubes",{enumerable:!0,get:function(){return p(u).default}});var c=s(20);Object.defineProperty(r,"cylon",{enumerable:!0,get:function(){return p(c).default}});var h=s(21);Object.defineProperty(r,"spin",{enumerable:!0,get:function(){return p(h).default}});var d=s(22);Object.defineProperty(r,"spinningBubbles",{enumerable:!0,get:function(){return p(d).default}});var f=s(23);Object.defineProperty(r,"spokes",{enumerable:!0,get:function(){return p(f).default}});function p(v){return v&&v.__esModule?v:{default:v}}},function(t,r){t.exports=`<svg class="icon-blank" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"></svg>
`},function(t,r){t.exports=`<svg class="icon-loading" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path transform="translate(-8 0)" d="M4 12 A4 4 0 0 0 4 20 A4 4 0 0 0 4 12"> 
    <animateTransform attributeName="transform" type="translate" values="-8 0; 2 0; 2 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.25;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(2 0)" d="M4 12 A4 4 0 0 0 4 20 A4 4 0 0 0 4 12"> 
    <animateTransform attributeName="transform" type="translate" values="2 0; 12 0; 12 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.35;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(12 0)" d="M4 12 A4 4 0 0 0 4 20 A4 4 0 0 0 4 12"> 
    <animateTransform attributeName="transform" type="translate" values="12 0; 22 0; 22 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.45;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(24 0)" d="M4 12 A4 4 0 0 0 4 20 A4 4 0 0 0 4 12"> 
    <animateTransform attributeName="transform" type="translate" values="22 0; 32 0; 32 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.55;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
</svg>
`},function(t,r){t.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path transform="translate(2)" d="M0 12 V20 H4 V12z"> 
    <animate attributeName="d" values="M0 12 V20 H4 V12z; M0 4 V28 H4 V4z; M0 12 V20 H4 V12z; M0 12 V20 H4 V12z" dur="1.2s" repeatCount="indefinite" begin="0" keytimes="0;.2;.5;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.8 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(8)" d="M0 12 V20 H4 V12z">
    <animate attributeName="d" values="M0 12 V20 H4 V12z; M0 4 V28 H4 V4z; M0 12 V20 H4 V12z; M0 12 V20 H4 V12z" dur="1.2s" repeatCount="indefinite" begin="0.2" keytimes="0;.2;.5;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.8 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(14)" d="M0 12 V20 H4 V12z">
    <animate attributeName="d" values="M0 12 V20 H4 V12z; M0 4 V28 H4 V4z; M0 12 V20 H4 V12z; M0 12 V20 H4 V12z" dur="1.2s" repeatCount="indefinite" begin="0.4" keytimes="0;.2;.5;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.8 0.4 0.8" calcMode="spline" />
  </path>
  <path transform="translate(20)" d="M0 12 V20 H4 V12z">
    <animate attributeName="d" values="M0 12 V20 H4 V12z; M0 4 V28 H4 V4z; M0 12 V20 H4 V12z; M0 12 V20 H4 V12z" dur="1.2s" repeatCount="indefinite" begin="0.6" keytimes="0;.2;.5;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.8 0.4 0.8" calcMode="spline" />
  </path>
  <path transform="translate(26)" d="M0 12 V20 H4 V12z">
    <animate attributeName="d" values="M0 12 V20 H4 V12z; M0 4 V28 H4 V4z; M0 12 V20 H4 V12z; M0 12 V20 H4 V12z" dur="1.2s" repeatCount="indefinite" begin="0.8" keytimes="0;.2;.5;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.8 0.4 0.8" calcMode="spline" />
  </path>
</svg>
`},function(t,r){t.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <circle transform="translate(8 0)" cx="0" cy="16" r="0"> 
    <animate attributeName="r" values="0; 4; 0; 0" dur="1.2s" repeatCount="indefinite" begin="0"
      keytimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="translate(16 0)" cx="0" cy="16" r="0"> 
    <animate attributeName="r" values="0; 4; 0; 0" dur="1.2s" repeatCount="indefinite" begin="0.3"
      keytimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="translate(24 0)" cx="0" cy="16" r="0"> 
    <animate attributeName="r" values="0; 4; 0; 0" dur="1.2s" repeatCount="indefinite" begin="0.6"
      keytimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" />
  </circle>
</svg>
`},function(t,r){t.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path transform="translate(-8 0)" d="M0 12 V20 H8 V12z"> 
    <animateTransform attributeName="transform" type="translate" values="-8 0; 2 0; 2 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.25;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(2 0)" d="M0 12 V20 H8 V12z"> 
    <animateTransform attributeName="transform" type="translate" values="2 0; 12 0; 12 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.35;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(12 0)" d="M0 12 V20 H8 V12z"> 
    <animateTransform attributeName="transform" type="translate" values="12 0; 22 0; 22 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.45;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(24 0)" d="M0 12 V20 H8 V12z"> 
    <animateTransform attributeName="transform" type="translate" values="22 0; 32 0; 32 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.55;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
</svg>
`},function(t,r){t.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path transform="translate(0 0)" d="M0 12 V20 H4 V12z">
    <animateTransform attributeName="transform" type="translate" values="0 0; 28 0; 0 0; 0 0" dur="1.5s" begin="0" repeatCount="indefinite" keytimes="0;0.3;0.6;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </path>
  <path opacity="0.5" transform="translate(0 0)" d="M0 12 V20 H4 V12z">
    <animateTransform attributeName="transform" type="translate" values="0 0; 28 0; 0 0; 0 0" dur="1.5s" begin="0.1s" repeatCount="indefinite" keytimes="0;0.3;0.6;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </path>
  <path opacity="0.25" transform="translate(0 0)" d="M0 12 V20 H4 V12z">
    <animateTransform attributeName="transform" type="translate" values="0 0; 28 0; 0 0; 0 0" dur="1.5s" begin="0.2s" repeatCount="indefinite" keytimes="0;0.3;0.6;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </path>
</svg>
`},function(t,r){t.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path opacity=".25" d="M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4"/>
  <path d="M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z">
    <animateTransform attributeName="transform" type="rotate" from="0 16 16" to="360 16 16" dur="0.8s" repeatCount="indefinite" />
  </path>
</svg>
`},function(t,r){t.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <circle cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(45 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.125s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(90 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.25s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(135 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.375s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(180 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.5s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(225 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.625s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(270 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.75s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(315 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.875s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(180 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.5s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
</svg>
`},function(t,r){t.exports=`<svg id="loading" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(0 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0"/>
  </path>
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(45 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.125s"/>
  </path>
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(90 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.25s"/>
  </path>
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(135 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.375s"/>
  </path>
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(180 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.5s"/>
  </path>
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(225 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.675s"/>
  </path>
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(270 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.75s"/>
  </path>
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(315 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.875s"/>
  </path>
</svg>
`}])})})(nP);var jge=nP.exports;const Hge=A1(jge),qge=()=>{const[n,e]=Re.useState(localStorage.getItem("epub-location")),[t,r]=Re.useState(!0),[s,i]=Re.useState(""),o=Re.useRef(null),a=Re.useRef(null),l=UN(),c=$w().state.book,h=v=>{if(console.log(v),typeof v=="string"){const g=v.match(/\/\d+\/\d+/);if(g)return g[0]}return null},d=v=>v.current?v.current.book:null,f=async v=>{const g=await v.loaded.spine;return new Promise((m,y)=>{g.each(async w=>{if(w.cfiBase===h(n))try{const b=(await w.load(v.load.bind(v))).querySelector("body");b?m(b.textContent):y(new Error("No body element found in the chapter."))}catch(x){y(x)}})})};Re.useEffect(()=>{const v=h(n);if(v!==o.current){o.current=v;const g=d(a);g&&f(g).then(m=>{console.log(m,"asd"),i(m)}).catch(m=>{console.error(m)})}},[n]);const p=()=>{l("/Emo-chan/")};return at.jsxs("div",{className:"app-container",children:[at.jsx("div",{className:"navbar-header",children:at.jsxs("div",{className:"logo",onClick:p,children:[" ",at.jsx("span",{role:"img","aria-label":"Emo-chan",className:"default-text",children:"(•ᴗ•❁)Emo-chan"}),at.jsx("span",{role:"img","aria-label":"Emo-chan",className:"hover-text",children:"(˃̵ᴗ˂̵❁)Emo-chan"})]})}),t&&at.jsxs("div",{className:"loading",children:[at.jsx(Hge,{type:"spin",color:"white",height:"auto",width:"10%"}),at.jsx("div",{className:"loading-text",children:"Emotion Analysis in Progress..."})]}),at.jsx(Gge,{storyText:s,setIsLoading:r}),at.jsx("div",{className:"reader-container",children:at.jsx(Fo.ReactReader,{location:n,locationChanged:e,url:c,getRendition:v=>{a.current=v},epubOptions:{allowPopups:!0,allowScriptedContent:!0},readerStyles:{...Fo.ReactReaderStyle,arrow:{...Fo.ReactReaderStyle.arrow,backgroundColor:"white",color:"black",fontWeight:100,fontFamily:"Playpen Sans"},tocArea:{...Fo.ReactReaderStyle.tocArea,backgroundColor:"white",color:"black"},tocAreaButton:{...Fo.ReactReaderStyle.tocAreaButton,backgroundColor:"white",color:"black",fontFamily:"Playpen Sans"},tocButtonBar:{...Fo.ReactReaderStyle.tocButtonBar,backgroundColor:"black"},tocButton:{...Fo.ReactReaderStyle.tocButton,backgroundColor:"white",color:"black"},tocButtonExpanded:{...Fo.ReactReaderStyle.tocButtonExpanded,backgroundColor:"white"}}})})]})};const Kge=tz([{path:"/Emo-chan/",element:at.jsx(hz,{})},{path:"/Emo-chan/App",element:at.jsx(qge,{})}]);Uy.createRoot(document.getElementById("root")).render(at.jsx(bT.StrictMode,{children:at.jsx(uz,{router:Kge})}));
