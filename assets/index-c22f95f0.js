function RT(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var yn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function OT(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var FT={exports:{}},bg={},LT={exports:{}},bt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gd=Symbol.for("react.element"),LP=Symbol.for("react.portal"),PP=Symbol.for("react.fragment"),MP=Symbol.for("react.strict_mode"),BP=Symbol.for("react.profiler"),zP=Symbol.for("react.provider"),UP=Symbol.for("react.context"),VP=Symbol.for("react.forward_ref"),WP=Symbol.for("react.suspense"),GP=Symbol.for("react.memo"),jP=Symbol.for("react.lazy"),fS=Symbol.iterator;function HP(t){return t===null||typeof t!="object"?null:(t=fS&&t[fS]||t["@@iterator"],typeof t=="function"?t:null)}var PT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},MT=Object.assign,BT={};function cc(t,e,n){this.props=t,this.context=e,this.refs=BT,this.updater=n||PT}cc.prototype.isReactComponent={};cc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};cc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function zT(){}zT.prototype=cc.prototype;function Jx(t,e,n){this.props=t,this.context=e,this.refs=BT,this.updater=n||PT}var eb=Jx.prototype=new zT;eb.constructor=Jx;MT(eb,cc.prototype);eb.isPureReactComponent=!0;var pS=Array.isArray,UT=Object.prototype.hasOwnProperty,tb={current:null},VT={key:!0,ref:!0,__self:!0,__source:!0};function WT(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)UT.call(e,r)&&!VT.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:gd,type:t,key:i,ref:o,props:s,_owner:tb.current}}function qP(t,e){return{$$typeof:gd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function nb(t){return typeof t=="object"&&t!==null&&t.$$typeof===gd}function KP(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var mS=/\/+/g;function Kv(t,e){return typeof t=="object"&&t!==null&&t.key!=null?KP(""+t.key):e.toString(36)}function jp(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case gd:case LP:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Kv(o,0):r,pS(s)?(n="",t!=null&&(n=t.replace(mS,"$&/")+"/"),jp(s,e,n,"",function(u){return u})):s!=null&&(nb(s)&&(s=qP(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(mS,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",pS(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+Kv(i,a);o+=jp(i,e,n,l,s)}else if(l=HP(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+Kv(i,a++),o+=jp(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function op(t,e,n){if(t==null)return t;var r=[],s=0;return jp(t,r,"","",function(i){return e.call(n,i,s++)}),r}function XP(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Wr={current:null},Hp={transition:null},YP={ReactCurrentDispatcher:Wr,ReactCurrentBatchConfig:Hp,ReactCurrentOwner:tb};bt.Children={map:op,forEach:function(t,e,n){op(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return op(t,function(){e++}),e},toArray:function(t){return op(t,function(e){return e})||[]},only:function(t){if(!nb(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};bt.Component=cc;bt.Fragment=PP;bt.Profiler=BP;bt.PureComponent=Jx;bt.StrictMode=MP;bt.Suspense=WP;bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YP;bt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=MT({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=tb.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)UT.call(e,l)&&!VT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:gd,type:t.type,key:s,ref:i,props:r,_owner:o}};bt.createContext=function(t){return t={$$typeof:UP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:zP,_context:t},t.Consumer=t};bt.createElement=WT;bt.createFactory=function(t){var e=WT.bind(null,t);return e.type=t,e};bt.createRef=function(){return{current:null}};bt.forwardRef=function(t){return{$$typeof:VP,render:t}};bt.isValidElement=nb;bt.lazy=function(t){return{$$typeof:jP,_payload:{_status:-1,_result:t},_init:XP}};bt.memo=function(t,e){return{$$typeof:GP,type:t,compare:e===void 0?null:e}};bt.startTransition=function(t){var e=Hp.transition;Hp.transition={};try{t()}finally{Hp.transition=e}};bt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};bt.useCallback=function(t,e){return Wr.current.useCallback(t,e)};bt.useContext=function(t){return Wr.current.useContext(t)};bt.useDebugValue=function(){};bt.useDeferredValue=function(t){return Wr.current.useDeferredValue(t)};bt.useEffect=function(t,e){return Wr.current.useEffect(t,e)};bt.useId=function(){return Wr.current.useId()};bt.useImperativeHandle=function(t,e,n){return Wr.current.useImperativeHandle(t,e,n)};bt.useInsertionEffect=function(t,e){return Wr.current.useInsertionEffect(t,e)};bt.useLayoutEffect=function(t,e){return Wr.current.useLayoutEffect(t,e)};bt.useMemo=function(t,e){return Wr.current.useMemo(t,e)};bt.useReducer=function(t,e,n){return Wr.current.useReducer(t,e,n)};bt.useRef=function(t){return Wr.current.useRef(t)};bt.useState=function(t){return Wr.current.useState(t)};bt.useSyncExternalStore=function(t,e,n){return Wr.current.useSyncExternalStore(t,e,n)};bt.useTransition=function(){return Wr.current.useTransition()};bt.version="18.2.0";LT.exports=bt;var Ce=LT.exports;const Ht=Qx(Ce),ZP=RT({__proto__:null,default:Ht},[Ce]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QP=Ce,JP=Symbol.for("react.element"),eM=Symbol.for("react.fragment"),tM=Object.prototype.hasOwnProperty,nM=QP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,rM={key:!0,ref:!0,__self:!0,__source:!0};function GT(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)tM.call(e,r)&&!rM.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:JP,type:t,key:i,ref:o,props:s,_owner:nM.current}}bg.Fragment=eM;bg.jsx=GT;bg.jsxs=GT;FT.exports=bg;var lt=FT.exports,o1={},jT={exports:{}},Ss={},HT={exports:{}},qT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,B){var X=D.length;D.push(B);e:for(;0<X;){var ie=X-1>>>1,G=D[ie];if(0<s(G,B))D[ie]=B,D[X]=G,X=ie;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var B=D[0],X=D.pop();if(X!==B){D[0]=X;e:for(var ie=0,G=D.length,Z=G>>>1;ie<Z;){var de=2*(ie+1)-1,ge=D[de],ye=de+1,j=D[ye];if(0>s(ge,X))ye<G&&0>s(j,ge)?(D[ie]=j,D[ye]=X,ie=ye):(D[ie]=ge,D[de]=X,ie=de);else if(ye<G&&0>s(j,X))D[ie]=j,D[ye]=X,ie=ye;else break e}}return B}function s(D,B){var X=D.sortIndex-B.sortIndex;return X!==0?X:D.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,d=3,f=!1,m=!1,v=!1,p=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(D){for(var B=n(u);B!==null;){if(B.callback===null)r(u);else if(B.startTime<=D)r(u),B.sortIndex=B.expirationTime,e(l,B);else break;B=n(u)}}function x(D){if(v=!1,b(D),!m)if(n(l)!==null)m=!0,M(w);else{var B=n(u);B!==null&&U(x,B.startTime-D)}}function w(D,B){m=!1,v&&(v=!1,g(E),E=-1),f=!0;var X=d;try{for(b(B),h=n(l);h!==null&&(!(h.expirationTime>B)||D&&!A());){var ie=h.callback;if(typeof ie=="function"){h.callback=null,d=h.priorityLevel;var G=ie(h.expirationTime<=B);B=t.unstable_now(),typeof G=="function"?h.callback=G:h===n(l)&&r(l),b(B)}else r(l);h=n(l)}if(h!==null)var Z=!0;else{var de=n(u);de!==null&&U(x,de.startTime-B),Z=!1}return Z}finally{h=null,d=X,f=!1}}var C=!1,S=null,E=-1,T=5,_=-1;function A(){return!(t.unstable_now()-_<T)}function L(){if(S!==null){var D=t.unstable_now();_=D;var B=!0;try{B=S(!0,D)}finally{B?W():(C=!1,S=null)}}else C=!1}var W;if(typeof y=="function")W=function(){y(L)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,R=K.port2;K.port1.onmessage=L,W=function(){R.postMessage(null)}}else W=function(){p(L,0)};function M(D){S=D,C||(C=!0,W())}function U(D,B){E=p(function(){D(t.unstable_now())},B)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,M(w))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(D){switch(d){case 1:case 2:case 3:var B=3;break;default:B=d}var X=d;d=B;try{return D()}finally{d=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,B){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var X=d;d=D;try{return B()}finally{d=X}},t.unstable_scheduleCallback=function(D,B,X){var ie=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?ie+X:ie):X=ie,D){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=X+G,D={id:c++,callback:B,priorityLevel:D,startTime:X,expirationTime:G,sortIndex:-1},X>ie?(D.sortIndex=X,e(u,D),n(l)===null&&D===n(u)&&(v?(g(E),E=-1):v=!0,U(x,X-ie))):(D.sortIndex=G,e(l,D),m||f||(m=!0,M(w))),D},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(D){var B=d;return function(){var X=d;d=B;try{return D.apply(this,arguments)}finally{d=X}}}})(qT);HT.exports=qT;var sM=HT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KT=Ce,ws=sM;function Re(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var XT=new Set,Fh={};function Dl(t,e){Vu(t,e),Vu(t+"Capture",e)}function Vu(t,e){for(Fh[t]=e,t=0;t<e.length;t++)XT.add(e[t])}var vo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),a1=Object.prototype.hasOwnProperty,iM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gS={},vS={};function oM(t){return a1.call(vS,t)?!0:a1.call(gS,t)?!1:iM.test(t)?vS[t]=!0:(gS[t]=!0,!1)}function aM(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function lM(t,e,n,r){if(e===null||typeof e>"u"||aM(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Gr(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var mr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){mr[t]=new Gr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];mr[e]=new Gr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){mr[t]=new Gr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){mr[t]=new Gr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){mr[t]=new Gr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){mr[t]=new Gr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){mr[t]=new Gr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){mr[t]=new Gr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){mr[t]=new Gr(t,5,!1,t.toLowerCase(),null,!1,!1)});var rb=/[\-:]([a-z])/g;function sb(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(rb,sb);mr[e]=new Gr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(rb,sb);mr[e]=new Gr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(rb,sb);mr[e]=new Gr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){mr[t]=new Gr(t,1,!1,t.toLowerCase(),null,!1,!1)});mr.xlinkHref=new Gr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){mr[t]=new Gr(t,1,!1,t.toLowerCase(),null,!0,!0)});function ib(t,e,n,r){var s=mr.hasOwnProperty(e)?mr[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(lM(e,n,s,r)&&(n=null),r||s===null?oM(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var To=KT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ap=Symbol.for("react.element"),pu=Symbol.for("react.portal"),mu=Symbol.for("react.fragment"),ob=Symbol.for("react.strict_mode"),l1=Symbol.for("react.profiler"),YT=Symbol.for("react.provider"),ZT=Symbol.for("react.context"),ab=Symbol.for("react.forward_ref"),u1=Symbol.for("react.suspense"),c1=Symbol.for("react.suspense_list"),lb=Symbol.for("react.memo"),Uo=Symbol.for("react.lazy"),QT=Symbol.for("react.offscreen"),yS=Symbol.iterator;function Pc(t){return t===null||typeof t!="object"?null:(t=yS&&t[yS]||t["@@iterator"],typeof t=="function"?t:null)}var mn=Object.assign,Xv;function ah(t){if(Xv===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Xv=e&&e[1]||""}return`
`+Xv+t}var Yv=!1;function Zv(t,e){if(!t||Yv)return"";Yv=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Yv=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ah(t):""}function uM(t){switch(t.tag){case 5:return ah(t.type);case 16:return ah("Lazy");case 13:return ah("Suspense");case 19:return ah("SuspenseList");case 0:case 2:case 15:return t=Zv(t.type,!1),t;case 11:return t=Zv(t.type.render,!1),t;case 1:return t=Zv(t.type,!0),t;default:return""}}function h1(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case mu:return"Fragment";case pu:return"Portal";case l1:return"Profiler";case ob:return"StrictMode";case u1:return"Suspense";case c1:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ZT:return(t.displayName||"Context")+".Consumer";case YT:return(t._context.displayName||"Context")+".Provider";case ab:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case lb:return e=t.displayName||null,e!==null?e:h1(t.type)||"Memo";case Uo:e=t._payload,t=t._init;try{return h1(t(e))}catch{}}return null}function cM(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return h1(e);case 8:return e===ob?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function da(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function JT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function hM(t){var e=JT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function lp(t){t._valueTracker||(t._valueTracker=hM(t))}function e_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=JT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function um(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function d1(t,e){var n=e.checked;return mn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function xS(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=da(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function t_(t,e){e=e.checked,e!=null&&ib(t,"checked",e,!1)}function f1(t,e){t_(t,e);var n=da(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?p1(t,e.type,n):e.hasOwnProperty("defaultValue")&&p1(t,e.type,da(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function bS(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function p1(t,e,n){(e!=="number"||um(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var lh=Array.isArray;function $u(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+da(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function m1(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Re(91));return mn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function wS(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Re(92));if(lh(n)){if(1<n.length)throw Error(Re(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:da(n)}}function n_(t,e){var n=da(e.value),r=da(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function CS(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function r_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function g1(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?r_(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var up,s_=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(up=up||document.createElement("div"),up.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=up.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Lh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var yh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dM=["Webkit","ms","Moz","O"];Object.keys(yh).forEach(function(t){dM.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),yh[e]=yh[t]})});function i_(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||yh.hasOwnProperty(t)&&yh[t]?(""+e).trim():e+"px"}function o_(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=i_(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var fM=mn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function v1(t,e){if(e){if(fM[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Re(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Re(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Re(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Re(62))}}function y1(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var x1=null;function ub(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var b1=null,Du=null,Au=null;function SS(t){if(t=xd(t)){if(typeof b1!="function")throw Error(Re(280));var e=t.stateNode;e&&(e=Eg(e),b1(t.stateNode,t.type,e))}}function a_(t){Du?Au?Au.push(t):Au=[t]:Du=t}function l_(){if(Du){var t=Du,e=Au;if(Au=Du=null,SS(t),e)for(t=0;t<e.length;t++)SS(e[t])}}function u_(t,e){return t(e)}function c_(){}var Qv=!1;function h_(t,e,n){if(Qv)return t(e,n);Qv=!0;try{return u_(t,e,n)}finally{Qv=!1,(Du!==null||Au!==null)&&(c_(),l_())}}function Ph(t,e){var n=t.stateNode;if(n===null)return null;var r=Eg(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Re(231,e,typeof n));return n}var w1=!1;if(vo)try{var Mc={};Object.defineProperty(Mc,"passive",{get:function(){w1=!0}}),window.addEventListener("test",Mc,Mc),window.removeEventListener("test",Mc,Mc)}catch{w1=!1}function pM(t,e,n,r,s,i,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var xh=!1,cm=null,hm=!1,C1=null,mM={onError:function(t){xh=!0,cm=t}};function gM(t,e,n,r,s,i,o,a,l){xh=!1,cm=null,pM.apply(mM,arguments)}function vM(t,e,n,r,s,i,o,a,l){if(gM.apply(this,arguments),xh){if(xh){var u=cm;xh=!1,cm=null}else throw Error(Re(198));hm||(hm=!0,C1=u)}}function Al(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function d_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function kS(t){if(Al(t)!==t)throw Error(Re(188))}function yM(t){var e=t.alternate;if(!e){if(e=Al(t),e===null)throw Error(Re(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return kS(s),t;if(i===r)return kS(s),e;i=i.sibling}throw Error(Re(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(Re(189))}}if(n.alternate!==r)throw Error(Re(190))}if(n.tag!==3)throw Error(Re(188));return n.stateNode.current===n?t:e}function f_(t){return t=yM(t),t!==null?p_(t):null}function p_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=p_(t);if(e!==null)return e;t=t.sibling}return null}var m_=ws.unstable_scheduleCallback,ES=ws.unstable_cancelCallback,xM=ws.unstable_shouldYield,bM=ws.unstable_requestPaint,Dn=ws.unstable_now,wM=ws.unstable_getCurrentPriorityLevel,cb=ws.unstable_ImmediatePriority,g_=ws.unstable_UserBlockingPriority,dm=ws.unstable_NormalPriority,CM=ws.unstable_LowPriority,v_=ws.unstable_IdlePriority,wg=null,Vi=null;function SM(t){if(Vi&&typeof Vi.onCommitFiberRoot=="function")try{Vi.onCommitFiberRoot(wg,t,void 0,(t.current.flags&128)===128)}catch{}}var pi=Math.clz32?Math.clz32:IM,kM=Math.log,EM=Math.LN2;function IM(t){return t>>>=0,t===0?32:31-(kM(t)/EM|0)|0}var cp=64,hp=4194304;function uh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function fm(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=uh(a):(i&=o,i!==0&&(r=uh(i)))}else o=n&~s,o!==0?r=uh(o):i!==0&&(r=uh(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-pi(e),s=1<<n,r|=t[n],e&=~s;return r}function TM(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _M(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-pi(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=TM(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function S1(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function y_(){var t=cp;return cp<<=1,!(cp&4194240)&&(cp=64),t}function Jv(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function vd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-pi(e),t[e]=n}function NM(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-pi(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function hb(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-pi(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Bt=0;function x_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var b_,db,w_,C_,S_,k1=!1,dp=[],Jo=null,ea=null,ta=null,Mh=new Map,Bh=new Map,Go=[],$M="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function IS(t,e){switch(t){case"focusin":case"focusout":Jo=null;break;case"dragenter":case"dragleave":ea=null;break;case"mouseover":case"mouseout":ta=null;break;case"pointerover":case"pointerout":Mh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bh.delete(e.pointerId)}}function Bc(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=xd(e),e!==null&&db(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function DM(t,e,n,r,s){switch(e){case"focusin":return Jo=Bc(Jo,t,e,n,r,s),!0;case"dragenter":return ea=Bc(ea,t,e,n,r,s),!0;case"mouseover":return ta=Bc(ta,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Mh.set(i,Bc(Mh.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Bh.set(i,Bc(Bh.get(i)||null,t,e,n,r,s)),!0}return!1}function k_(t){var e=Xa(t.target);if(e!==null){var n=Al(e);if(n!==null){if(e=n.tag,e===13){if(e=d_(n),e!==null){t.blockedOn=e,S_(t.priority,function(){w_(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function qp(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=E1(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);x1=r,n.target.dispatchEvent(r),x1=null}else return e=xd(n),e!==null&&db(e),t.blockedOn=n,!1;e.shift()}return!0}function TS(t,e,n){qp(t)&&n.delete(e)}function AM(){k1=!1,Jo!==null&&qp(Jo)&&(Jo=null),ea!==null&&qp(ea)&&(ea=null),ta!==null&&qp(ta)&&(ta=null),Mh.forEach(TS),Bh.forEach(TS)}function zc(t,e){t.blockedOn===e&&(t.blockedOn=null,k1||(k1=!0,ws.unstable_scheduleCallback(ws.unstable_NormalPriority,AM)))}function zh(t){function e(s){return zc(s,t)}if(0<dp.length){zc(dp[0],t);for(var n=1;n<dp.length;n++){var r=dp[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Jo!==null&&zc(Jo,t),ea!==null&&zc(ea,t),ta!==null&&zc(ta,t),Mh.forEach(e),Bh.forEach(e),n=0;n<Go.length;n++)r=Go[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Go.length&&(n=Go[0],n.blockedOn===null);)k_(n),n.blockedOn===null&&Go.shift()}var Ru=To.ReactCurrentBatchConfig,pm=!0;function RM(t,e,n,r){var s=Bt,i=Ru.transition;Ru.transition=null;try{Bt=1,fb(t,e,n,r)}finally{Bt=s,Ru.transition=i}}function OM(t,e,n,r){var s=Bt,i=Ru.transition;Ru.transition=null;try{Bt=4,fb(t,e,n,r)}finally{Bt=s,Ru.transition=i}}function fb(t,e,n,r){if(pm){var s=E1(t,e,n,r);if(s===null)uy(t,e,r,mm,n),IS(t,r);else if(DM(s,t,e,n,r))r.stopPropagation();else if(IS(t,r),e&4&&-1<$M.indexOf(t)){for(;s!==null;){var i=xd(s);if(i!==null&&b_(i),i=E1(t,e,n,r),i===null&&uy(t,e,r,mm,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else uy(t,e,r,null,n)}}var mm=null;function E1(t,e,n,r){if(mm=null,t=ub(r),t=Xa(t),t!==null)if(e=Al(t),e===null)t=null;else if(n=e.tag,n===13){if(t=d_(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return mm=t,null}function E_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wM()){case cb:return 1;case g_:return 4;case dm:case CM:return 16;case v_:return 536870912;default:return 16}default:return 16}}var Ho=null,pb=null,Kp=null;function I_(){if(Kp)return Kp;var t,e=pb,n=e.length,r,s="value"in Ho?Ho.value:Ho.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Kp=s.slice(t,1<r?1-r:void 0)}function Xp(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function fp(){return!0}function _S(){return!1}function ks(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?fp:_S,this.isPropagationStopped=_S,this}return mn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=fp)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=fp)},persist:function(){},isPersistent:fp}),e}var hc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mb=ks(hc),yd=mn({},hc,{view:0,detail:0}),FM=ks(yd),ey,ty,Uc,Cg=mn({},yd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gb,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Uc&&(Uc&&t.type==="mousemove"?(ey=t.screenX-Uc.screenX,ty=t.screenY-Uc.screenY):ty=ey=0,Uc=t),ey)},movementY:function(t){return"movementY"in t?t.movementY:ty}}),NS=ks(Cg),LM=mn({},Cg,{dataTransfer:0}),PM=ks(LM),MM=mn({},yd,{relatedTarget:0}),ny=ks(MM),BM=mn({},hc,{animationName:0,elapsedTime:0,pseudoElement:0}),zM=ks(BM),UM=mn({},hc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),VM=ks(UM),WM=mn({},hc,{data:0}),$S=ks(WM),GM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},HM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qM(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=HM[t])?!!e[t]:!1}function gb(){return qM}var KM=mn({},yd,{key:function(t){if(t.key){var e=GM[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Xp(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?jM[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gb,charCode:function(t){return t.type==="keypress"?Xp(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Xp(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),XM=ks(KM),YM=mn({},Cg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),DS=ks(YM),ZM=mn({},yd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gb}),QM=ks(ZM),JM=mn({},hc,{propertyName:0,elapsedTime:0,pseudoElement:0}),eB=ks(JM),tB=mn({},Cg,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),nB=ks(tB),rB=[9,13,27,32],vb=vo&&"CompositionEvent"in window,bh=null;vo&&"documentMode"in document&&(bh=document.documentMode);var sB=vo&&"TextEvent"in window&&!bh,T_=vo&&(!vb||bh&&8<bh&&11>=bh),AS=String.fromCharCode(32),RS=!1;function __(t,e){switch(t){case"keyup":return rB.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function N_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var gu=!1;function iB(t,e){switch(t){case"compositionend":return N_(e);case"keypress":return e.which!==32?null:(RS=!0,AS);case"textInput":return t=e.data,t===AS&&RS?null:t;default:return null}}function oB(t,e){if(gu)return t==="compositionend"||!vb&&__(t,e)?(t=I_(),Kp=pb=Ho=null,gu=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return T_&&e.locale!=="ko"?null:e.data;default:return null}}var aB={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function OS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!aB[t.type]:e==="textarea"}function $_(t,e,n,r){a_(r),e=gm(e,"onChange"),0<e.length&&(n=new mb("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var wh=null,Uh=null;function lB(t){U_(t,0)}function Sg(t){var e=xu(t);if(e_(e))return t}function uB(t,e){if(t==="change")return e}var D_=!1;if(vo){var ry;if(vo){var sy="oninput"in document;if(!sy){var FS=document.createElement("div");FS.setAttribute("oninput","return;"),sy=typeof FS.oninput=="function"}ry=sy}else ry=!1;D_=ry&&(!document.documentMode||9<document.documentMode)}function LS(){wh&&(wh.detachEvent("onpropertychange",A_),Uh=wh=null)}function A_(t){if(t.propertyName==="value"&&Sg(Uh)){var e=[];$_(e,Uh,t,ub(t)),h_(lB,e)}}function cB(t,e,n){t==="focusin"?(LS(),wh=e,Uh=n,wh.attachEvent("onpropertychange",A_)):t==="focusout"&&LS()}function hB(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Sg(Uh)}function dB(t,e){if(t==="click")return Sg(e)}function fB(t,e){if(t==="input"||t==="change")return Sg(e)}function pB(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var bi=typeof Object.is=="function"?Object.is:pB;function Vh(t,e){if(bi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!a1.call(e,s)||!bi(t[s],e[s]))return!1}return!0}function PS(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function MS(t,e){var n=PS(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=PS(n)}}function R_(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?R_(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function O_(){for(var t=window,e=um();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=um(t.document)}return e}function yb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function mB(t){var e=O_(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&R_(n.ownerDocument.documentElement,n)){if(r!==null&&yb(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=MS(n,i);var o=MS(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var gB=vo&&"documentMode"in document&&11>=document.documentMode,vu=null,I1=null,Ch=null,T1=!1;function BS(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;T1||vu==null||vu!==um(r)||(r=vu,"selectionStart"in r&&yb(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ch&&Vh(Ch,r)||(Ch=r,r=gm(I1,"onSelect"),0<r.length&&(e=new mb("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=vu)))}function pp(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var yu={animationend:pp("Animation","AnimationEnd"),animationiteration:pp("Animation","AnimationIteration"),animationstart:pp("Animation","AnimationStart"),transitionend:pp("Transition","TransitionEnd")},iy={},F_={};vo&&(F_=document.createElement("div").style,"AnimationEvent"in window||(delete yu.animationend.animation,delete yu.animationiteration.animation,delete yu.animationstart.animation),"TransitionEvent"in window||delete yu.transitionend.transition);function kg(t){if(iy[t])return iy[t];if(!yu[t])return t;var e=yu[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in F_)return iy[t]=e[n];return t}var L_=kg("animationend"),P_=kg("animationiteration"),M_=kg("animationstart"),B_=kg("transitionend"),z_=new Map,zS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ca(t,e){z_.set(t,e),Dl(e,[t])}for(var oy=0;oy<zS.length;oy++){var ay=zS[oy],vB=ay.toLowerCase(),yB=ay[0].toUpperCase()+ay.slice(1);Ca(vB,"on"+yB)}Ca(L_,"onAnimationEnd");Ca(P_,"onAnimationIteration");Ca(M_,"onAnimationStart");Ca("dblclick","onDoubleClick");Ca("focusin","onFocus");Ca("focusout","onBlur");Ca(B_,"onTransitionEnd");Vu("onMouseEnter",["mouseout","mouseover"]);Vu("onMouseLeave",["mouseout","mouseover"]);Vu("onPointerEnter",["pointerout","pointerover"]);Vu("onPointerLeave",["pointerout","pointerover"]);Dl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Dl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Dl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Dl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Dl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Dl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ch="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xB=new Set("cancel close invalid load scroll toggle".split(" ").concat(ch));function US(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,vM(r,e,void 0,t),t.currentTarget=null}function U_(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;US(s,a,u),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;US(s,a,u),i=l}}}if(hm)throw t=C1,hm=!1,C1=null,t}function rn(t,e){var n=e[A1];n===void 0&&(n=e[A1]=new Set);var r=t+"__bubble";n.has(r)||(V_(e,t,2,!1),n.add(r))}function ly(t,e,n){var r=0;e&&(r|=4),V_(n,t,r,e)}var mp="_reactListening"+Math.random().toString(36).slice(2);function Wh(t){if(!t[mp]){t[mp]=!0,XT.forEach(function(n){n!=="selectionchange"&&(xB.has(n)||ly(n,!1,t),ly(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[mp]||(e[mp]=!0,ly("selectionchange",!1,e))}}function V_(t,e,n,r){switch(E_(e)){case 1:var s=RM;break;case 4:s=OM;break;default:s=fb}n=s.bind(null,e,n,t),s=void 0,!w1||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function uy(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Xa(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}h_(function(){var u=i,c=ub(n),h=[];e:{var d=z_.get(t);if(d!==void 0){var f=mb,m=t;switch(t){case"keypress":if(Xp(n)===0)break e;case"keydown":case"keyup":f=XM;break;case"focusin":m="focus",f=ny;break;case"focusout":m="blur",f=ny;break;case"beforeblur":case"afterblur":f=ny;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=NS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=PM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=QM;break;case L_:case P_:case M_:f=zM;break;case B_:f=eB;break;case"scroll":f=FM;break;case"wheel":f=nB;break;case"copy":case"cut":case"paste":f=VM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=DS}var v=(e&4)!==0,p=!v&&t==="scroll",g=v?d!==null?d+"Capture":null:d;v=[];for(var y=u,b;y!==null;){b=y;var x=b.stateNode;if(b.tag===5&&x!==null&&(b=x,g!==null&&(x=Ph(y,g),x!=null&&v.push(Gh(y,x,b)))),p)break;y=y.return}0<v.length&&(d=new f(d,m,null,n,c),h.push({event:d,listeners:v}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&n!==x1&&(m=n.relatedTarget||n.fromElement)&&(Xa(m)||m[yo]))break e;if((f||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,f?(m=n.relatedTarget||n.toElement,f=u,m=m?Xa(m):null,m!==null&&(p=Al(m),m!==p||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=u),f!==m)){if(v=NS,x="onMouseLeave",g="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(v=DS,x="onPointerLeave",g="onPointerEnter",y="pointer"),p=f==null?d:xu(f),b=m==null?d:xu(m),d=new v(x,y+"leave",f,n,c),d.target=p,d.relatedTarget=b,x=null,Xa(c)===u&&(v=new v(g,y+"enter",m,n,c),v.target=b,v.relatedTarget=p,x=v),p=x,f&&m)t:{for(v=f,g=m,y=0,b=v;b;b=Ql(b))y++;for(b=0,x=g;x;x=Ql(x))b++;for(;0<y-b;)v=Ql(v),y--;for(;0<b-y;)g=Ql(g),b--;for(;y--;){if(v===g||g!==null&&v===g.alternate)break t;v=Ql(v),g=Ql(g)}v=null}else v=null;f!==null&&VS(h,d,f,v,!1),m!==null&&p!==null&&VS(h,p,m,v,!0)}}e:{if(d=u?xu(u):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var w=uB;else if(OS(d))if(D_)w=fB;else{w=hB;var C=cB}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(w=dB);if(w&&(w=w(t,u))){$_(h,w,n,c);break e}C&&C(t,d,u),t==="focusout"&&(C=d._wrapperState)&&C.controlled&&d.type==="number"&&p1(d,"number",d.value)}switch(C=u?xu(u):window,t){case"focusin":(OS(C)||C.contentEditable==="true")&&(vu=C,I1=u,Ch=null);break;case"focusout":Ch=I1=vu=null;break;case"mousedown":T1=!0;break;case"contextmenu":case"mouseup":case"dragend":T1=!1,BS(h,n,c);break;case"selectionchange":if(gB)break;case"keydown":case"keyup":BS(h,n,c)}var S;if(vb)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else gu?__(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(T_&&n.locale!=="ko"&&(gu||E!=="onCompositionStart"?E==="onCompositionEnd"&&gu&&(S=I_()):(Ho=c,pb="value"in Ho?Ho.value:Ho.textContent,gu=!0)),C=gm(u,E),0<C.length&&(E=new $S(E,t,null,n,c),h.push({event:E,listeners:C}),S?E.data=S:(S=N_(n),S!==null&&(E.data=S)))),(S=sB?iB(t,n):oB(t,n))&&(u=gm(u,"onBeforeInput"),0<u.length&&(c=new $S("onBeforeInput","beforeinput",null,n,c),h.push({event:c,listeners:u}),c.data=S))}U_(h,e)})}function Gh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function gm(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Ph(t,n),i!=null&&r.unshift(Gh(t,i,s)),i=Ph(t,e),i!=null&&r.push(Gh(t,i,s))),t=t.return}return r}function Ql(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function VS(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,s?(l=Ph(n,i),l!=null&&o.unshift(Gh(n,l,a))):s||(l=Ph(n,i),l!=null&&o.push(Gh(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var bB=/\r\n?/g,wB=/\u0000|\uFFFD/g;function WS(t){return(typeof t=="string"?t:""+t).replace(bB,`
`).replace(wB,"")}function gp(t,e,n){if(e=WS(e),WS(t)!==e&&n)throw Error(Re(425))}function vm(){}var _1=null,N1=null;function $1(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var D1=typeof setTimeout=="function"?setTimeout:void 0,CB=typeof clearTimeout=="function"?clearTimeout:void 0,GS=typeof Promise=="function"?Promise:void 0,SB=typeof queueMicrotask=="function"?queueMicrotask:typeof GS<"u"?function(t){return GS.resolve(null).then(t).catch(kB)}:D1;function kB(t){setTimeout(function(){throw t})}function cy(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),zh(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);zh(e)}function na(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function jS(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var dc=Math.random().toString(36).slice(2),Mi="__reactFiber$"+dc,jh="__reactProps$"+dc,yo="__reactContainer$"+dc,A1="__reactEvents$"+dc,EB="__reactListeners$"+dc,IB="__reactHandles$"+dc;function Xa(t){var e=t[Mi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[yo]||n[Mi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=jS(t);t!==null;){if(n=t[Mi])return n;t=jS(t)}return e}t=n,n=t.parentNode}return null}function xd(t){return t=t[Mi]||t[yo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function xu(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Re(33))}function Eg(t){return t[jh]||null}var R1=[],bu=-1;function Sa(t){return{current:t}}function sn(t){0>bu||(t.current=R1[bu],R1[bu]=null,bu--)}function Jt(t,e){bu++,R1[bu]=t.current,t.current=e}var fa={},_r=Sa(fa),ns=Sa(!1),al=fa;function Wu(t,e){var n=t.type.contextTypes;if(!n)return fa;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function rs(t){return t=t.childContextTypes,t!=null}function ym(){sn(ns),sn(_r)}function HS(t,e,n){if(_r.current!==fa)throw Error(Re(168));Jt(_r,e),Jt(ns,n)}function W_(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Re(108,cM(t)||"Unknown",s));return mn({},n,r)}function xm(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||fa,al=_r.current,Jt(_r,t),Jt(ns,ns.current),!0}function qS(t,e,n){var r=t.stateNode;if(!r)throw Error(Re(169));n?(t=W_(t,e,al),r.__reactInternalMemoizedMergedChildContext=t,sn(ns),sn(_r),Jt(_r,t)):sn(ns),Jt(ns,n)}var lo=null,Ig=!1,hy=!1;function G_(t){lo===null?lo=[t]:lo.push(t)}function TB(t){Ig=!0,G_(t)}function ka(){if(!hy&&lo!==null){hy=!0;var t=0,e=Bt;try{var n=lo;for(Bt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}lo=null,Ig=!1}catch(s){throw lo!==null&&(lo=lo.slice(t+1)),m_(cb,ka),s}finally{Bt=e,hy=!1}}return null}var wu=[],Cu=0,bm=null,wm=0,Ms=[],Bs=0,ll=null,ho=1,fo="";function Ua(t,e){wu[Cu++]=wm,wu[Cu++]=bm,bm=t,wm=e}function j_(t,e,n){Ms[Bs++]=ho,Ms[Bs++]=fo,Ms[Bs++]=ll,ll=t;var r=ho;t=fo;var s=32-pi(r)-1;r&=~(1<<s),n+=1;var i=32-pi(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ho=1<<32-pi(e)+s|n<<s|r,fo=i+t}else ho=1<<i|n<<s|r,fo=t}function xb(t){t.return!==null&&(Ua(t,1),j_(t,1,0))}function bb(t){for(;t===bm;)bm=wu[--Cu],wu[Cu]=null,wm=wu[--Cu],wu[Cu]=null;for(;t===ll;)ll=Ms[--Bs],Ms[Bs]=null,fo=Ms[--Bs],Ms[Bs]=null,ho=Ms[--Bs],Ms[Bs]=null}var xs=null,vs=null,un=!1,ci=null;function H_(t,e){var n=Us(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function KS(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,xs=t,vs=na(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,xs=t,vs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ll!==null?{id:ho,overflow:fo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Us(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,xs=t,vs=null,!0):!1;default:return!1}}function O1(t){return(t.mode&1)!==0&&(t.flags&128)===0}function F1(t){if(un){var e=vs;if(e){var n=e;if(!KS(t,e)){if(O1(t))throw Error(Re(418));e=na(n.nextSibling);var r=xs;e&&KS(t,e)?H_(r,n):(t.flags=t.flags&-4097|2,un=!1,xs=t)}}else{if(O1(t))throw Error(Re(418));t.flags=t.flags&-4097|2,un=!1,xs=t}}}function XS(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;xs=t}function vp(t){if(t!==xs)return!1;if(!un)return XS(t),un=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!$1(t.type,t.memoizedProps)),e&&(e=vs)){if(O1(t))throw q_(),Error(Re(418));for(;e;)H_(t,e),e=na(e.nextSibling)}if(XS(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Re(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){vs=na(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}vs=null}}else vs=xs?na(t.stateNode.nextSibling):null;return!0}function q_(){for(var t=vs;t;)t=na(t.nextSibling)}function Gu(){vs=xs=null,un=!1}function wb(t){ci===null?ci=[t]:ci.push(t)}var _B=To.ReactCurrentBatchConfig;function ai(t,e){if(t&&t.defaultProps){e=mn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Cm=Sa(null),Sm=null,Su=null,Cb=null;function Sb(){Cb=Su=Sm=null}function kb(t){var e=Cm.current;sn(Cm),t._currentValue=e}function L1(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ou(t,e){Sm=t,Cb=Su=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Qr=!0),t.firstContext=null)}function Ks(t){var e=t._currentValue;if(Cb!==t)if(t={context:t,memoizedValue:e,next:null},Su===null){if(Sm===null)throw Error(Re(308));Su=t,Sm.dependencies={lanes:0,firstContext:t}}else Su=Su.next=t;return e}var Ya=null;function Eb(t){Ya===null?Ya=[t]:Ya.push(t)}function K_(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Eb(e)):(n.next=s.next,s.next=n),e.interleaved=n,xo(t,r)}function xo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Vo=!1;function Ib(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function X_(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function mo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ra(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,It&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,xo(t,n)}return s=r.interleaved,s===null?(e.next=e,Eb(r)):(e.next=s.next,s.next=e),r.interleaved=e,xo(t,n)}function Yp(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hb(t,n)}}function YS(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function km(t,e,n,r){var s=t.updateQueue;Vo=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;o=0,c=u=l=null,a=i;do{var d=a.lane,f=a.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,v=a;switch(d=e,f=n,v.tag){case 1:if(m=v.payload,typeof m=="function"){h=m.call(f,h,d);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=v.payload,d=typeof m=="function"?m.call(f,h,d):m,d==null)break e;h=mn({},h,d);break e;case 2:Vo=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=s.effects,d===null?s.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=f,l=h):c=c.next=f,o|=d;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;d=a,a=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(1);if(c===null&&(l=h),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=c,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);cl|=o,t.lanes=o,t.memoizedState=h}}function ZS(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Re(191,s));s.call(r)}}}var Y_=new KT.Component().refs;function P1(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:mn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Tg={isMounted:function(t){return(t=t._reactInternals)?Al(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Br(),s=ia(t),i=mo(r,s);i.payload=e,n!=null&&(i.callback=n),e=ra(t,i,s),e!==null&&(mi(e,t,s,r),Yp(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Br(),s=ia(t),i=mo(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ra(t,i,s),e!==null&&(mi(e,t,s,r),Yp(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Br(),r=ia(t),s=mo(n,r);s.tag=2,e!=null&&(s.callback=e),e=ra(t,s,r),e!==null&&(mi(e,t,r,n),Yp(e,t,r))}};function QS(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Vh(n,r)||!Vh(s,i):!0}function Z_(t,e,n){var r=!1,s=fa,i=e.contextType;return typeof i=="object"&&i!==null?i=Ks(i):(s=rs(e)?al:_r.current,r=e.contextTypes,i=(r=r!=null)?Wu(t,s):fa),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Tg,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function JS(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Tg.enqueueReplaceState(e,e.state,null)}function M1(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=Y_,Ib(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Ks(i):(i=rs(e)?al:_r.current,s.context=Wu(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(P1(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Tg.enqueueReplaceState(s,s.state,null),km(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Vc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Re(309));var r=n.stateNode}if(!r)throw Error(Re(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;a===Y_&&(a=s.refs={}),o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Re(284));if(!n._owner)throw Error(Re(290,t))}return t}function yp(t,e){throw t=Object.prototype.toString.call(e),Error(Re(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ek(t){var e=t._init;return e(t._payload)}function Q_(t){function e(g,y){if(t){var b=g.deletions;b===null?(g.deletions=[y],g.flags|=16):b.push(y)}}function n(g,y){if(!t)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function r(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function s(g,y){return g=oa(g,y),g.index=0,g.sibling=null,g}function i(g,y,b){return g.index=b,t?(b=g.alternate,b!==null?(b=b.index,b<y?(g.flags|=2,y):b):(g.flags|=2,y)):(g.flags|=1048576,y)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,y,b,x){return y===null||y.tag!==6?(y=yy(b,g.mode,x),y.return=g,y):(y=s(y,b),y.return=g,y)}function l(g,y,b,x){var w=b.type;return w===mu?c(g,y,b.props.children,x,b.key):y!==null&&(y.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Uo&&ek(w)===y.type)?(x=s(y,b.props),x.ref=Vc(g,y,b),x.return=g,x):(x=nm(b.type,b.key,b.props,null,g.mode,x),x.ref=Vc(g,y,b),x.return=g,x)}function u(g,y,b,x){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=xy(b,g.mode,x),y.return=g,y):(y=s(y,b.children||[]),y.return=g,y)}function c(g,y,b,x,w){return y===null||y.tag!==7?(y=rl(b,g.mode,x,w),y.return=g,y):(y=s(y,b),y.return=g,y)}function h(g,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=yy(""+y,g.mode,b),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ap:return b=nm(y.type,y.key,y.props,null,g.mode,b),b.ref=Vc(g,null,y),b.return=g,b;case pu:return y=xy(y,g.mode,b),y.return=g,y;case Uo:var x=y._init;return h(g,x(y._payload),b)}if(lh(y)||Pc(y))return y=rl(y,g.mode,b,null),y.return=g,y;yp(g,y)}return null}function d(g,y,b,x){var w=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return w!==null?null:a(g,y,""+b,x);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ap:return b.key===w?l(g,y,b,x):null;case pu:return b.key===w?u(g,y,b,x):null;case Uo:return w=b._init,d(g,y,w(b._payload),x)}if(lh(b)||Pc(b))return w!==null?null:c(g,y,b,x,null);yp(g,b)}return null}function f(g,y,b,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return g=g.get(b)||null,a(y,g,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ap:return g=g.get(x.key===null?b:x.key)||null,l(y,g,x,w);case pu:return g=g.get(x.key===null?b:x.key)||null,u(y,g,x,w);case Uo:var C=x._init;return f(g,y,b,C(x._payload),w)}if(lh(x)||Pc(x))return g=g.get(b)||null,c(y,g,x,w,null);yp(y,x)}return null}function m(g,y,b,x){for(var w=null,C=null,S=y,E=y=0,T=null;S!==null&&E<b.length;E++){S.index>E?(T=S,S=null):T=S.sibling;var _=d(g,S,b[E],x);if(_===null){S===null&&(S=T);break}t&&S&&_.alternate===null&&e(g,S),y=i(_,y,E),C===null?w=_:C.sibling=_,C=_,S=T}if(E===b.length)return n(g,S),un&&Ua(g,E),w;if(S===null){for(;E<b.length;E++)S=h(g,b[E],x),S!==null&&(y=i(S,y,E),C===null?w=S:C.sibling=S,C=S);return un&&Ua(g,E),w}for(S=r(g,S);E<b.length;E++)T=f(S,g,E,b[E],x),T!==null&&(t&&T.alternate!==null&&S.delete(T.key===null?E:T.key),y=i(T,y,E),C===null?w=T:C.sibling=T,C=T);return t&&S.forEach(function(A){return e(g,A)}),un&&Ua(g,E),w}function v(g,y,b,x){var w=Pc(b);if(typeof w!="function")throw Error(Re(150));if(b=w.call(b),b==null)throw Error(Re(151));for(var C=w=null,S=y,E=y=0,T=null,_=b.next();S!==null&&!_.done;E++,_=b.next()){S.index>E?(T=S,S=null):T=S.sibling;var A=d(g,S,_.value,x);if(A===null){S===null&&(S=T);break}t&&S&&A.alternate===null&&e(g,S),y=i(A,y,E),C===null?w=A:C.sibling=A,C=A,S=T}if(_.done)return n(g,S),un&&Ua(g,E),w;if(S===null){for(;!_.done;E++,_=b.next())_=h(g,_.value,x),_!==null&&(y=i(_,y,E),C===null?w=_:C.sibling=_,C=_);return un&&Ua(g,E),w}for(S=r(g,S);!_.done;E++,_=b.next())_=f(S,g,E,_.value,x),_!==null&&(t&&_.alternate!==null&&S.delete(_.key===null?E:_.key),y=i(_,y,E),C===null?w=_:C.sibling=_,C=_);return t&&S.forEach(function(L){return e(g,L)}),un&&Ua(g,E),w}function p(g,y,b,x){if(typeof b=="object"&&b!==null&&b.type===mu&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case ap:e:{for(var w=b.key,C=y;C!==null;){if(C.key===w){if(w=b.type,w===mu){if(C.tag===7){n(g,C.sibling),y=s(C,b.props.children),y.return=g,g=y;break e}}else if(C.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Uo&&ek(w)===C.type){n(g,C.sibling),y=s(C,b.props),y.ref=Vc(g,C,b),y.return=g,g=y;break e}n(g,C);break}else e(g,C);C=C.sibling}b.type===mu?(y=rl(b.props.children,g.mode,x,b.key),y.return=g,g=y):(x=nm(b.type,b.key,b.props,null,g.mode,x),x.ref=Vc(g,y,b),x.return=g,g=x)}return o(g);case pu:e:{for(C=b.key;y!==null;){if(y.key===C)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(g,y.sibling),y=s(y,b.children||[]),y.return=g,g=y;break e}else{n(g,y);break}else e(g,y);y=y.sibling}y=xy(b,g.mode,x),y.return=g,g=y}return o(g);case Uo:return C=b._init,p(g,y,C(b._payload),x)}if(lh(b))return m(g,y,b,x);if(Pc(b))return v(g,y,b,x);yp(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(g,y.sibling),y=s(y,b),y.return=g,g=y):(n(g,y),y=yy(b,g.mode,x),y.return=g,g=y),o(g)):n(g,y)}return p}var ju=Q_(!0),J_=Q_(!1),bd={},Wi=Sa(bd),Hh=Sa(bd),qh=Sa(bd);function Za(t){if(t===bd)throw Error(Re(174));return t}function Tb(t,e){switch(Jt(qh,e),Jt(Hh,t),Jt(Wi,bd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:g1(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=g1(e,t)}sn(Wi),Jt(Wi,e)}function Hu(){sn(Wi),sn(Hh),sn(qh)}function eN(t){Za(qh.current);var e=Za(Wi.current),n=g1(e,t.type);e!==n&&(Jt(Hh,t),Jt(Wi,n))}function _b(t){Hh.current===t&&(sn(Wi),sn(Hh))}var fn=Sa(0);function Em(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var dy=[];function Nb(){for(var t=0;t<dy.length;t++)dy[t]._workInProgressVersionPrimary=null;dy.length=0}var Zp=To.ReactCurrentDispatcher,fy=To.ReactCurrentBatchConfig,ul=0,pn=null,Yn=null,rr=null,Im=!1,Sh=!1,Kh=0,NB=0;function wr(){throw Error(Re(321))}function $b(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!bi(t[n],e[n]))return!1;return!0}function Db(t,e,n,r,s,i){if(ul=i,pn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Zp.current=t===null||t.memoizedState===null?RB:OB,t=n(r,s),Sh){i=0;do{if(Sh=!1,Kh=0,25<=i)throw Error(Re(301));i+=1,rr=Yn=null,e.updateQueue=null,Zp.current=FB,t=n(r,s)}while(Sh)}if(Zp.current=Tm,e=Yn!==null&&Yn.next!==null,ul=0,rr=Yn=pn=null,Im=!1,e)throw Error(Re(300));return t}function Ab(){var t=Kh!==0;return Kh=0,t}function Ai(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rr===null?pn.memoizedState=rr=t:rr=rr.next=t,rr}function Xs(){if(Yn===null){var t=pn.alternate;t=t!==null?t.memoizedState:null}else t=Yn.next;var e=rr===null?pn.memoizedState:rr.next;if(e!==null)rr=e,Yn=t;else{if(t===null)throw Error(Re(310));Yn=t,t={memoizedState:Yn.memoizedState,baseState:Yn.baseState,baseQueue:Yn.baseQueue,queue:Yn.queue,next:null},rr===null?pn.memoizedState=rr=t:rr=rr.next=t}return rr}function Xh(t,e){return typeof e=="function"?e(t):e}function py(t){var e=Xs(),n=e.queue;if(n===null)throw Error(Re(311));n.lastRenderedReducer=t;var r=Yn,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,u=i;do{var c=u.lane;if((ul&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,pn.lanes|=c,cl|=c}u=u.next}while(u!==null&&u!==i);l===null?o=r:l.next=a,bi(r,e.memoizedState)||(Qr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,pn.lanes|=i,cl|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function my(t){var e=Xs(),n=e.queue;if(n===null)throw Error(Re(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);bi(i,e.memoizedState)||(Qr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function tN(){}function nN(t,e){var n=pn,r=Xs(),s=e(),i=!bi(r.memoizedState,s);if(i&&(r.memoizedState=s,Qr=!0),r=r.queue,Rb(iN.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||rr!==null&&rr.memoizedState.tag&1){if(n.flags|=2048,Yh(9,sN.bind(null,n,r,s,e),void 0,null),ir===null)throw Error(Re(349));ul&30||rN(n,e,s)}return s}function rN(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=pn.updateQueue,e===null?(e={lastEffect:null,stores:null},pn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function sN(t,e,n,r){e.value=n,e.getSnapshot=r,oN(e)&&aN(t)}function iN(t,e,n){return n(function(){oN(e)&&aN(t)})}function oN(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!bi(t,n)}catch{return!0}}function aN(t){var e=xo(t,1);e!==null&&mi(e,t,1,-1)}function tk(t){var e=Ai();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xh,lastRenderedState:t},e.queue=t,t=t.dispatch=AB.bind(null,pn,t),[e.memoizedState,t]}function Yh(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=pn.updateQueue,e===null?(e={lastEffect:null,stores:null},pn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function lN(){return Xs().memoizedState}function Qp(t,e,n,r){var s=Ai();pn.flags|=t,s.memoizedState=Yh(1|e,n,void 0,r===void 0?null:r)}function _g(t,e,n,r){var s=Xs();r=r===void 0?null:r;var i=void 0;if(Yn!==null){var o=Yn.memoizedState;if(i=o.destroy,r!==null&&$b(r,o.deps)){s.memoizedState=Yh(e,n,i,r);return}}pn.flags|=t,s.memoizedState=Yh(1|e,n,i,r)}function nk(t,e){return Qp(8390656,8,t,e)}function Rb(t,e){return _g(2048,8,t,e)}function uN(t,e){return _g(4,2,t,e)}function cN(t,e){return _g(4,4,t,e)}function hN(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function dN(t,e,n){return n=n!=null?n.concat([t]):null,_g(4,4,hN.bind(null,e,t),n)}function Ob(){}function fN(t,e){var n=Xs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$b(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function pN(t,e){var n=Xs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$b(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function mN(t,e,n){return ul&21?(bi(n,e)||(n=y_(),pn.lanes|=n,cl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Qr=!0),t.memoizedState=n)}function $B(t,e){var n=Bt;Bt=n!==0&&4>n?n:4,t(!0);var r=fy.transition;fy.transition={};try{t(!1),e()}finally{Bt=n,fy.transition=r}}function gN(){return Xs().memoizedState}function DB(t,e,n){var r=ia(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},vN(t))yN(e,n);else if(n=K_(t,e,n,r),n!==null){var s=Br();mi(n,t,r,s),xN(n,e,r)}}function AB(t,e,n){var r=ia(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(vN(t))yN(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,bi(a,o)){var l=e.interleaved;l===null?(s.next=s,Eb(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=K_(t,e,s,r),n!==null&&(s=Br(),mi(n,t,r,s),xN(n,e,r))}}function vN(t){var e=t.alternate;return t===pn||e!==null&&e===pn}function yN(t,e){Sh=Im=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function xN(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hb(t,n)}}var Tm={readContext:Ks,useCallback:wr,useContext:wr,useEffect:wr,useImperativeHandle:wr,useInsertionEffect:wr,useLayoutEffect:wr,useMemo:wr,useReducer:wr,useRef:wr,useState:wr,useDebugValue:wr,useDeferredValue:wr,useTransition:wr,useMutableSource:wr,useSyncExternalStore:wr,useId:wr,unstable_isNewReconciler:!1},RB={readContext:Ks,useCallback:function(t,e){return Ai().memoizedState=[t,e===void 0?null:e],t},useContext:Ks,useEffect:nk,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Qp(4194308,4,hN.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Qp(4194308,4,t,e)},useInsertionEffect:function(t,e){return Qp(4,2,t,e)},useMemo:function(t,e){var n=Ai();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ai();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=DB.bind(null,pn,t),[r.memoizedState,t]},useRef:function(t){var e=Ai();return t={current:t},e.memoizedState=t},useState:tk,useDebugValue:Ob,useDeferredValue:function(t){return Ai().memoizedState=t},useTransition:function(){var t=tk(!1),e=t[0];return t=$B.bind(null,t[1]),Ai().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=pn,s=Ai();if(un){if(n===void 0)throw Error(Re(407));n=n()}else{if(n=e(),ir===null)throw Error(Re(349));ul&30||rN(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,nk(iN.bind(null,r,i,t),[t]),r.flags|=2048,Yh(9,sN.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Ai(),e=ir.identifierPrefix;if(un){var n=fo,r=ho;n=(r&~(1<<32-pi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Kh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=NB++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},OB={readContext:Ks,useCallback:fN,useContext:Ks,useEffect:Rb,useImperativeHandle:dN,useInsertionEffect:uN,useLayoutEffect:cN,useMemo:pN,useReducer:py,useRef:lN,useState:function(){return py(Xh)},useDebugValue:Ob,useDeferredValue:function(t){var e=Xs();return mN(e,Yn.memoizedState,t)},useTransition:function(){var t=py(Xh)[0],e=Xs().memoizedState;return[t,e]},useMutableSource:tN,useSyncExternalStore:nN,useId:gN,unstable_isNewReconciler:!1},FB={readContext:Ks,useCallback:fN,useContext:Ks,useEffect:Rb,useImperativeHandle:dN,useInsertionEffect:uN,useLayoutEffect:cN,useMemo:pN,useReducer:my,useRef:lN,useState:function(){return my(Xh)},useDebugValue:Ob,useDeferredValue:function(t){var e=Xs();return Yn===null?e.memoizedState=t:mN(e,Yn.memoizedState,t)},useTransition:function(){var t=my(Xh)[0],e=Xs().memoizedState;return[t,e]},useMutableSource:tN,useSyncExternalStore:nN,useId:gN,unstable_isNewReconciler:!1};function qu(t,e){try{var n="",r=e;do n+=uM(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function gy(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function B1(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var LB=typeof WeakMap=="function"?WeakMap:Map;function bN(t,e,n){n=mo(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Nm||(Nm=!0,X1=r),B1(t,e)},n}function wN(t,e,n){n=mo(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){B1(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){B1(t,e),typeof r!="function"&&(sa===null?sa=new Set([this]):sa.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function rk(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new LB;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=YB.bind(null,t,e,n),e.then(t,t))}function sk(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ik(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=mo(-1,1),e.tag=2,ra(n,e,1))),n.lanes|=1),t)}var PB=To.ReactCurrentOwner,Qr=!1;function Fr(t,e,n,r){e.child=t===null?J_(e,null,n,r):ju(e,t.child,n,r)}function ok(t,e,n,r,s){n=n.render;var i=e.ref;return Ou(e,s),r=Db(t,e,n,r,i,s),n=Ab(),t!==null&&!Qr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,bo(t,e,s)):(un&&n&&xb(e),e.flags|=1,Fr(t,e,r,s),e.child)}function ak(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Vb(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,CN(t,e,i,r,s)):(t=nm(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Vh,n(o,r)&&t.ref===e.ref)return bo(t,e,s)}return e.flags|=1,t=oa(i,r),t.ref=e.ref,t.return=e,e.child=t}function CN(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Vh(i,r)&&t.ref===e.ref)if(Qr=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Qr=!0);else return e.lanes=t.lanes,bo(t,e,s)}return z1(t,e,n,r,s)}function SN(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jt(Eu,ms),ms|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Jt(Eu,ms),ms|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Jt(Eu,ms),ms|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Jt(Eu,ms),ms|=r;return Fr(t,e,s,n),e.child}function kN(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function z1(t,e,n,r,s){var i=rs(n)?al:_r.current;return i=Wu(e,i),Ou(e,s),n=Db(t,e,n,r,i,s),r=Ab(),t!==null&&!Qr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,bo(t,e,s)):(un&&r&&xb(e),e.flags|=1,Fr(t,e,n,s),e.child)}function lk(t,e,n,r,s){if(rs(n)){var i=!0;xm(e)}else i=!1;if(Ou(e,s),e.stateNode===null)Jp(t,e),Z_(e,n,r),M1(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Ks(u):(u=rs(n)?al:_r.current,u=Wu(e,u));var c=n.getDerivedStateFromProps,h=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&JS(e,o,r,u),Vo=!1;var d=e.memoizedState;o.state=d,km(e,r,o,s),l=e.memoizedState,a!==r||d!==l||ns.current||Vo?(typeof c=="function"&&(P1(e,n,c,r),l=e.memoizedState),(a=Vo||QS(e,n,a,r,d,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,X_(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:ai(e.type,a),o.props=u,h=e.pendingProps,d=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ks(l):(l=rs(n)?al:_r.current,l=Wu(e,l));var f=n.getDerivedStateFromProps;(c=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&JS(e,o,r,l),Vo=!1,d=e.memoizedState,o.state=d,km(e,r,o,s);var m=e.memoizedState;a!==h||d!==m||ns.current||Vo?(typeof f=="function"&&(P1(e,n,f,r),m=e.memoizedState),(u=Vo||QS(e,n,u,r,d,m,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,m,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,m,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),o.props=r,o.state=m,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return U1(t,e,n,r,i,s)}function U1(t,e,n,r,s,i){kN(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&qS(e,n,!1),bo(t,e,i);r=e.stateNode,PB.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ju(e,t.child,null,i),e.child=ju(e,null,a,i)):Fr(t,e,a,i),e.memoizedState=r.state,s&&qS(e,n,!0),e.child}function EN(t){var e=t.stateNode;e.pendingContext?HS(t,e.pendingContext,e.pendingContext!==e.context):e.context&&HS(t,e.context,!1),Tb(t,e.containerInfo)}function uk(t,e,n,r,s){return Gu(),wb(s),e.flags|=256,Fr(t,e,n,r),e.child}var V1={dehydrated:null,treeContext:null,retryLane:0};function W1(t){return{baseLanes:t,cachePool:null,transitions:null}}function IN(t,e,n){var r=e.pendingProps,s=fn.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Jt(fn,s&1),t===null)return F1(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Dg(o,r,0,null),t=rl(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=W1(n),e.memoizedState=V1,t):Fb(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return MB(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=oa(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=oa(a,i):(i=rl(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?W1(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=V1,r}return i=t.child,t=i.sibling,r=oa(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Fb(t,e){return e=Dg({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function xp(t,e,n,r){return r!==null&&wb(r),ju(e,t.child,null,n),t=Fb(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function MB(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=gy(Error(Re(422))),xp(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Dg({mode:"visible",children:r.children},s,0,null),i=rl(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ju(e,t.child,null,o),e.child.memoizedState=W1(o),e.memoizedState=V1,i);if(!(e.mode&1))return xp(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(Re(419)),r=gy(i,r,void 0),xp(t,e,o,r)}if(a=(o&t.childLanes)!==0,Qr||a){if(r=ir,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,xo(t,s),mi(r,t,s,-1))}return Ub(),r=gy(Error(Re(421))),xp(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=ZB.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,vs=na(s.nextSibling),xs=e,un=!0,ci=null,t!==null&&(Ms[Bs++]=ho,Ms[Bs++]=fo,Ms[Bs++]=ll,ho=t.id,fo=t.overflow,ll=e),e=Fb(e,r.children),e.flags|=4096,e)}function ck(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),L1(t.return,e,n)}function vy(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function TN(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Fr(t,e,r.children,n),r=fn.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ck(t,n,e);else if(t.tag===19)ck(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Jt(fn,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Em(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),vy(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Em(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}vy(e,!0,n,null,i);break;case"together":vy(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Jp(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function bo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),cl|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Re(153));if(e.child!==null){for(t=e.child,n=oa(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=oa(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function BB(t,e,n){switch(e.tag){case 3:EN(e),Gu();break;case 5:eN(e);break;case 1:rs(e.type)&&xm(e);break;case 4:Tb(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Jt(Cm,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Jt(fn,fn.current&1),e.flags|=128,null):n&e.child.childLanes?IN(t,e,n):(Jt(fn,fn.current&1),t=bo(t,e,n),t!==null?t.sibling:null);Jt(fn,fn.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return TN(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Jt(fn,fn.current),r)break;return null;case 22:case 23:return e.lanes=0,SN(t,e,n)}return bo(t,e,n)}var _N,G1,NN,$N;_N=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};G1=function(){};NN=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Za(Wi.current);var i=null;switch(n){case"input":s=d1(t,s),r=d1(t,r),i=[];break;case"select":s=mn({},s,{value:void 0}),r=mn({},r,{value:void 0}),i=[];break;case"textarea":s=m1(t,s),r=m1(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=vm)}v1(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Fh.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var l=r[u];if(a=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Fh.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&rn("scroll",t),i||a===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};$N=function(t,e,n,r){n!==r&&(e.flags|=4)};function Wc(t,e){if(!un)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Cr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function zB(t,e,n){var r=e.pendingProps;switch(bb(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cr(e),null;case 1:return rs(e.type)&&ym(),Cr(e),null;case 3:return r=e.stateNode,Hu(),sn(ns),sn(_r),Nb(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(vp(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ci!==null&&(Q1(ci),ci=null))),G1(t,e),Cr(e),null;case 5:_b(e);var s=Za(qh.current);if(n=e.type,t!==null&&e.stateNode!=null)NN(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Re(166));return Cr(e),null}if(t=Za(Wi.current),vp(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Mi]=e,r[jh]=i,t=(e.mode&1)!==0,n){case"dialog":rn("cancel",r),rn("close",r);break;case"iframe":case"object":case"embed":rn("load",r);break;case"video":case"audio":for(s=0;s<ch.length;s++)rn(ch[s],r);break;case"source":rn("error",r);break;case"img":case"image":case"link":rn("error",r),rn("load",r);break;case"details":rn("toggle",r);break;case"input":xS(r,i),rn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},rn("invalid",r);break;case"textarea":wS(r,i),rn("invalid",r)}v1(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&gp(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&gp(r.textContent,a,t),s=["children",""+a]):Fh.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&rn("scroll",r)}switch(n){case"input":lp(r),bS(r,i,!0);break;case"textarea":lp(r),CS(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=vm)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=r_(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Mi]=e,t[jh]=r,_N(t,e,!1,!1),e.stateNode=t;e:{switch(o=y1(n,r),n){case"dialog":rn("cancel",t),rn("close",t),s=r;break;case"iframe":case"object":case"embed":rn("load",t),s=r;break;case"video":case"audio":for(s=0;s<ch.length;s++)rn(ch[s],t);s=r;break;case"source":rn("error",t),s=r;break;case"img":case"image":case"link":rn("error",t),rn("load",t),s=r;break;case"details":rn("toggle",t),s=r;break;case"input":xS(t,r),s=d1(t,r),rn("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=mn({},r,{value:void 0}),rn("invalid",t);break;case"textarea":wS(t,r),s=m1(t,r),rn("invalid",t);break;default:s=r}v1(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?o_(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&s_(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Lh(t,l):typeof l=="number"&&Lh(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Fh.hasOwnProperty(i)?l!=null&&i==="onScroll"&&rn("scroll",t):l!=null&&ib(t,i,l,o))}switch(n){case"input":lp(t),bS(t,r,!1);break;case"textarea":lp(t),CS(t);break;case"option":r.value!=null&&t.setAttribute("value",""+da(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?$u(t,!!r.multiple,i,!1):r.defaultValue!=null&&$u(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=vm)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Cr(e),null;case 6:if(t&&e.stateNode!=null)$N(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Re(166));if(n=Za(qh.current),Za(Wi.current),vp(e)){if(r=e.stateNode,n=e.memoizedProps,r[Mi]=e,(i=r.nodeValue!==n)&&(t=xs,t!==null))switch(t.tag){case 3:gp(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&gp(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Mi]=e,e.stateNode=r}return Cr(e),null;case 13:if(sn(fn),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(un&&vs!==null&&e.mode&1&&!(e.flags&128))q_(),Gu(),e.flags|=98560,i=!1;else if(i=vp(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Re(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Re(317));i[Mi]=e}else Gu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Cr(e),i=!1}else ci!==null&&(Q1(ci),ci=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||fn.current&1?Jn===0&&(Jn=3):Ub())),e.updateQueue!==null&&(e.flags|=4),Cr(e),null);case 4:return Hu(),G1(t,e),t===null&&Wh(e.stateNode.containerInfo),Cr(e),null;case 10:return kb(e.type._context),Cr(e),null;case 17:return rs(e.type)&&ym(),Cr(e),null;case 19:if(sn(fn),i=e.memoizedState,i===null)return Cr(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Wc(i,!1);else{if(Jn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Em(t),o!==null){for(e.flags|=128,Wc(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Jt(fn,fn.current&1|2),e.child}t=t.sibling}i.tail!==null&&Dn()>Ku&&(e.flags|=128,r=!0,Wc(i,!1),e.lanes=4194304)}else{if(!r)if(t=Em(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Wc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!un)return Cr(e),null}else 2*Dn()-i.renderingStartTime>Ku&&n!==1073741824&&(e.flags|=128,r=!0,Wc(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Dn(),e.sibling=null,n=fn.current,Jt(fn,r?n&1|2:n&1),e):(Cr(e),null);case 22:case 23:return zb(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ms&1073741824&&(Cr(e),e.subtreeFlags&6&&(e.flags|=8192)):Cr(e),null;case 24:return null;case 25:return null}throw Error(Re(156,e.tag))}function UB(t,e){switch(bb(e),e.tag){case 1:return rs(e.type)&&ym(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Hu(),sn(ns),sn(_r),Nb(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _b(e),null;case 13:if(sn(fn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Re(340));Gu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return sn(fn),null;case 4:return Hu(),null;case 10:return kb(e.type._context),null;case 22:case 23:return zb(),null;case 24:return null;default:return null}}var bp=!1,kr=!1,VB=typeof WeakSet=="function"?WeakSet:Set,He=null;function ku(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){gn(t,e,r)}else n.current=null}function j1(t,e,n){try{n()}catch(r){gn(t,e,r)}}var hk=!1;function WB(t,e){if(_1=pm,t=O_(),yb(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,c=0,h=t,d=null;t:for(;;){for(var f;h!==n||s!==0&&h.nodeType!==3||(a=o+s),h!==i||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===t)break t;if(d===n&&++u===s&&(a=o),d===i&&++c===r&&(l=o),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(N1={focusedElem:t,selectionRange:n},pm=!1,He=e;He!==null;)if(e=He,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,He=t;else for(;He!==null;){e=He;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var v=m.memoizedProps,p=m.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?v:ai(e.type,v),p);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Re(163))}}catch(x){gn(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,He=t;break}He=e.return}return m=hk,hk=!1,m}function kh(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&j1(e,n,i)}s=s.next}while(s!==r)}}function Ng(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function H1(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function DN(t){var e=t.alternate;e!==null&&(t.alternate=null,DN(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Mi],delete e[jh],delete e[A1],delete e[EB],delete e[IB])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function AN(t){return t.tag===5||t.tag===3||t.tag===4}function dk(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||AN(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function q1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=vm));else if(r!==4&&(t=t.child,t!==null))for(q1(t,e,n),t=t.sibling;t!==null;)q1(t,e,n),t=t.sibling}function K1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(K1(t,e,n),t=t.sibling;t!==null;)K1(t,e,n),t=t.sibling}var fr=null,li=!1;function Oo(t,e,n){for(n=n.child;n!==null;)RN(t,e,n),n=n.sibling}function RN(t,e,n){if(Vi&&typeof Vi.onCommitFiberUnmount=="function")try{Vi.onCommitFiberUnmount(wg,n)}catch{}switch(n.tag){case 5:kr||ku(n,e);case 6:var r=fr,s=li;fr=null,Oo(t,e,n),fr=r,li=s,fr!==null&&(li?(t=fr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):fr.removeChild(n.stateNode));break;case 18:fr!==null&&(li?(t=fr,n=n.stateNode,t.nodeType===8?cy(t.parentNode,n):t.nodeType===1&&cy(t,n),zh(t)):cy(fr,n.stateNode));break;case 4:r=fr,s=li,fr=n.stateNode.containerInfo,li=!0,Oo(t,e,n),fr=r,li=s;break;case 0:case 11:case 14:case 15:if(!kr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&j1(n,e,o),s=s.next}while(s!==r)}Oo(t,e,n);break;case 1:if(!kr&&(ku(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){gn(n,e,a)}Oo(t,e,n);break;case 21:Oo(t,e,n);break;case 22:n.mode&1?(kr=(r=kr)||n.memoizedState!==null,Oo(t,e,n),kr=r):Oo(t,e,n);break;default:Oo(t,e,n)}}function fk(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new VB),e.forEach(function(r){var s=QB.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function ti(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:fr=a.stateNode,li=!1;break e;case 3:fr=a.stateNode.containerInfo,li=!0;break e;case 4:fr=a.stateNode.containerInfo,li=!0;break e}a=a.return}if(fr===null)throw Error(Re(160));RN(i,o,s),fr=null,li=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){gn(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ON(e,t),e=e.sibling}function ON(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ti(e,t),$i(t),r&4){try{kh(3,t,t.return),Ng(3,t)}catch(v){gn(t,t.return,v)}try{kh(5,t,t.return)}catch(v){gn(t,t.return,v)}}break;case 1:ti(e,t),$i(t),r&512&&n!==null&&ku(n,n.return);break;case 5:if(ti(e,t),$i(t),r&512&&n!==null&&ku(n,n.return),t.flags&32){var s=t.stateNode;try{Lh(s,"")}catch(v){gn(t,t.return,v)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&t_(s,i),y1(a,o);var u=y1(a,i);for(o=0;o<l.length;o+=2){var c=l[o],h=l[o+1];c==="style"?o_(s,h):c==="dangerouslySetInnerHTML"?s_(s,h):c==="children"?Lh(s,h):ib(s,c,h,u)}switch(a){case"input":f1(s,i);break;case"textarea":n_(s,i);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?$u(s,!!i.multiple,f,!1):d!==!!i.multiple&&(i.defaultValue!=null?$u(s,!!i.multiple,i.defaultValue,!0):$u(s,!!i.multiple,i.multiple?[]:"",!1))}s[jh]=i}catch(v){gn(t,t.return,v)}}break;case 6:if(ti(e,t),$i(t),r&4){if(t.stateNode===null)throw Error(Re(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(v){gn(t,t.return,v)}}break;case 3:if(ti(e,t),$i(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{zh(e.containerInfo)}catch(v){gn(t,t.return,v)}break;case 4:ti(e,t),$i(t);break;case 13:ti(e,t),$i(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Mb=Dn())),r&4&&fk(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(kr=(u=kr)||c,ti(e,t),kr=u):ti(e,t),$i(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(He=t,c=t.child;c!==null;){for(h=He=c;He!==null;){switch(d=He,f=d.child,d.tag){case 0:case 11:case 14:case 15:kh(4,d,d.return);break;case 1:ku(d,d.return);var m=d.stateNode;if(typeof m.componentWillUnmount=="function"){r=d,n=d.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(v){gn(r,n,v)}}break;case 5:ku(d,d.return);break;case 22:if(d.memoizedState!==null){mk(h);continue}}f!==null?(f.return=d,He=f):mk(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=i_("display",o))}catch(v){gn(t,t.return,v)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(v){gn(t,t.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ti(e,t),$i(t),r&4&&fk(t);break;case 21:break;default:ti(e,t),$i(t)}}function $i(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(AN(n)){var r=n;break e}n=n.return}throw Error(Re(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Lh(s,""),r.flags&=-33);var i=dk(t);K1(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=dk(t);q1(t,a,o);break;default:throw Error(Re(161))}}catch(l){gn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function GB(t,e,n){He=t,FN(t)}function FN(t,e,n){for(var r=(t.mode&1)!==0;He!==null;){var s=He,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||bp;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||kr;a=bp;var u=kr;if(bp=o,(kr=l)&&!u)for(He=s;He!==null;)o=He,l=o.child,o.tag===22&&o.memoizedState!==null?gk(s):l!==null?(l.return=o,He=l):gk(s);for(;i!==null;)He=i,FN(i),i=i.sibling;He=s,bp=a,kr=u}pk(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,He=i):pk(t)}}function pk(t){for(;He!==null;){var e=He;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:kr||Ng(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!kr)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:ai(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&ZS(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ZS(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&zh(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Re(163))}kr||e.flags&512&&H1(e)}catch(d){gn(e,e.return,d)}}if(e===t){He=null;break}if(n=e.sibling,n!==null){n.return=e.return,He=n;break}He=e.return}}function mk(t){for(;He!==null;){var e=He;if(e===t){He=null;break}var n=e.sibling;if(n!==null){n.return=e.return,He=n;break}He=e.return}}function gk(t){for(;He!==null;){var e=He;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ng(4,e)}catch(l){gn(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){gn(e,s,l)}}var i=e.return;try{H1(e)}catch(l){gn(e,i,l)}break;case 5:var o=e.return;try{H1(e)}catch(l){gn(e,o,l)}}}catch(l){gn(e,e.return,l)}if(e===t){He=null;break}var a=e.sibling;if(a!==null){a.return=e.return,He=a;break}He=e.return}}var jB=Math.ceil,_m=To.ReactCurrentDispatcher,Lb=To.ReactCurrentOwner,qs=To.ReactCurrentBatchConfig,It=0,ir=null,Un=null,pr=0,ms=0,Eu=Sa(0),Jn=0,Zh=null,cl=0,$g=0,Pb=0,Eh=null,Xr=null,Mb=0,Ku=1/0,ao=null,Nm=!1,X1=null,sa=null,wp=!1,qo=null,$m=0,Ih=0,Y1=null,em=-1,tm=0;function Br(){return It&6?Dn():em!==-1?em:em=Dn()}function ia(t){return t.mode&1?It&2&&pr!==0?pr&-pr:_B.transition!==null?(tm===0&&(tm=y_()),tm):(t=Bt,t!==0||(t=window.event,t=t===void 0?16:E_(t.type)),t):1}function mi(t,e,n,r){if(50<Ih)throw Ih=0,Y1=null,Error(Re(185));vd(t,n,r),(!(It&2)||t!==ir)&&(t===ir&&(!(It&2)&&($g|=n),Jn===4&&jo(t,pr)),ss(t,r),n===1&&It===0&&!(e.mode&1)&&(Ku=Dn()+500,Ig&&ka()))}function ss(t,e){var n=t.callbackNode;_M(t,e);var r=fm(t,t===ir?pr:0);if(r===0)n!==null&&ES(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&ES(n),e===1)t.tag===0?TB(vk.bind(null,t)):G_(vk.bind(null,t)),SB(function(){!(It&6)&&ka()}),n=null;else{switch(x_(r)){case 1:n=cb;break;case 4:n=g_;break;case 16:n=dm;break;case 536870912:n=v_;break;default:n=dm}n=WN(n,LN.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function LN(t,e){if(em=-1,tm=0,It&6)throw Error(Re(327));var n=t.callbackNode;if(Fu()&&t.callbackNode!==n)return null;var r=fm(t,t===ir?pr:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Dm(t,r);else{e=r;var s=It;It|=2;var i=MN();(ir!==t||pr!==e)&&(ao=null,Ku=Dn()+500,nl(t,e));do try{KB();break}catch(a){PN(t,a)}while(1);Sb(),_m.current=i,It=s,Un!==null?e=0:(ir=null,pr=0,e=Jn)}if(e!==0){if(e===2&&(s=S1(t),s!==0&&(r=s,e=Z1(t,s))),e===1)throw n=Zh,nl(t,0),jo(t,r),ss(t,Dn()),n;if(e===6)jo(t,r);else{if(s=t.current.alternate,!(r&30)&&!HB(s)&&(e=Dm(t,r),e===2&&(i=S1(t),i!==0&&(r=i,e=Z1(t,i))),e===1))throw n=Zh,nl(t,0),jo(t,r),ss(t,Dn()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(Re(345));case 2:Va(t,Xr,ao);break;case 3:if(jo(t,r),(r&130023424)===r&&(e=Mb+500-Dn(),10<e)){if(fm(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Br(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=D1(Va.bind(null,t,Xr,ao),e);break}Va(t,Xr,ao);break;case 4:if(jo(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-pi(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Dn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*jB(r/1960))-r,10<r){t.timeoutHandle=D1(Va.bind(null,t,Xr,ao),r);break}Va(t,Xr,ao);break;case 5:Va(t,Xr,ao);break;default:throw Error(Re(329))}}}return ss(t,Dn()),t.callbackNode===n?LN.bind(null,t):null}function Z1(t,e){var n=Eh;return t.current.memoizedState.isDehydrated&&(nl(t,e).flags|=256),t=Dm(t,e),t!==2&&(e=Xr,Xr=n,e!==null&&Q1(e)),t}function Q1(t){Xr===null?Xr=t:Xr.push.apply(Xr,t)}function HB(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!bi(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function jo(t,e){for(e&=~Pb,e&=~$g,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-pi(e),r=1<<n;t[n]=-1,e&=~r}}function vk(t){if(It&6)throw Error(Re(327));Fu();var e=fm(t,0);if(!(e&1))return ss(t,Dn()),null;var n=Dm(t,e);if(t.tag!==0&&n===2){var r=S1(t);r!==0&&(e=r,n=Z1(t,r))}if(n===1)throw n=Zh,nl(t,0),jo(t,e),ss(t,Dn()),n;if(n===6)throw Error(Re(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Va(t,Xr,ao),ss(t,Dn()),null}function Bb(t,e){var n=It;It|=1;try{return t(e)}finally{It=n,It===0&&(Ku=Dn()+500,Ig&&ka())}}function hl(t){qo!==null&&qo.tag===0&&!(It&6)&&Fu();var e=It;It|=1;var n=qs.transition,r=Bt;try{if(qs.transition=null,Bt=1,t)return t()}finally{Bt=r,qs.transition=n,It=e,!(It&6)&&ka()}}function zb(){ms=Eu.current,sn(Eu)}function nl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,CB(n)),Un!==null)for(n=Un.return;n!==null;){var r=n;switch(bb(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ym();break;case 3:Hu(),sn(ns),sn(_r),Nb();break;case 5:_b(r);break;case 4:Hu();break;case 13:sn(fn);break;case 19:sn(fn);break;case 10:kb(r.type._context);break;case 22:case 23:zb()}n=n.return}if(ir=t,Un=t=oa(t.current,null),pr=ms=e,Jn=0,Zh=null,Pb=$g=cl=0,Xr=Eh=null,Ya!==null){for(e=0;e<Ya.length;e++)if(n=Ya[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Ya=null}return t}function PN(t,e){do{var n=Un;try{if(Sb(),Zp.current=Tm,Im){for(var r=pn.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Im=!1}if(ul=0,rr=Yn=pn=null,Sh=!1,Kh=0,Lb.current=null,n===null||n.return===null){Jn=1,Zh=e,Un=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=pr,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=sk(o);if(f!==null){f.flags&=-257,ik(f,o,a,i,e),f.mode&1&&rk(i,u,e),e=f,l=u;var m=e.updateQueue;if(m===null){var v=new Set;v.add(l),e.updateQueue=v}else m.add(l);break e}else{if(!(e&1)){rk(i,u,e),Ub();break e}l=Error(Re(426))}}else if(un&&a.mode&1){var p=sk(o);if(p!==null){!(p.flags&65536)&&(p.flags|=256),ik(p,o,a,i,e),wb(qu(l,a));break e}}i=l=qu(l,a),Jn!==4&&(Jn=2),Eh===null?Eh=[i]:Eh.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=bN(i,l,e);YS(i,g);break e;case 1:a=l;var y=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(sa===null||!sa.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var x=wN(i,a,e);YS(i,x);break e}}i=i.return}while(i!==null)}zN(n)}catch(w){e=w,Un===n&&n!==null&&(Un=n=n.return);continue}break}while(1)}function MN(){var t=_m.current;return _m.current=Tm,t===null?Tm:t}function Ub(){(Jn===0||Jn===3||Jn===2)&&(Jn=4),ir===null||!(cl&268435455)&&!($g&268435455)||jo(ir,pr)}function Dm(t,e){var n=It;It|=2;var r=MN();(ir!==t||pr!==e)&&(ao=null,nl(t,e));do try{qB();break}catch(s){PN(t,s)}while(1);if(Sb(),It=n,_m.current=r,Un!==null)throw Error(Re(261));return ir=null,pr=0,Jn}function qB(){for(;Un!==null;)BN(Un)}function KB(){for(;Un!==null&&!xM();)BN(Un)}function BN(t){var e=VN(t.alternate,t,ms);t.memoizedProps=t.pendingProps,e===null?zN(t):Un=e,Lb.current=null}function zN(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=UB(n,e),n!==null){n.flags&=32767,Un=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Jn=6,Un=null;return}}else if(n=zB(n,e,ms),n!==null){Un=n;return}if(e=e.sibling,e!==null){Un=e;return}Un=e=t}while(e!==null);Jn===0&&(Jn=5)}function Va(t,e,n){var r=Bt,s=qs.transition;try{qs.transition=null,Bt=1,XB(t,e,n,r)}finally{qs.transition=s,Bt=r}return null}function XB(t,e,n,r){do Fu();while(qo!==null);if(It&6)throw Error(Re(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Re(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(NM(t,i),t===ir&&(Un=ir=null,pr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||wp||(wp=!0,WN(dm,function(){return Fu(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=qs.transition,qs.transition=null;var o=Bt;Bt=1;var a=It;It|=4,Lb.current=null,WB(t,n),ON(n,t),mB(N1),pm=!!_1,N1=_1=null,t.current=n,GB(n),bM(),It=a,Bt=o,qs.transition=i}else t.current=n;if(wp&&(wp=!1,qo=t,$m=s),i=t.pendingLanes,i===0&&(sa=null),SM(n.stateNode),ss(t,Dn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Nm)throw Nm=!1,t=X1,X1=null,t;return $m&1&&t.tag!==0&&Fu(),i=t.pendingLanes,i&1?t===Y1?Ih++:(Ih=0,Y1=t):Ih=0,ka(),null}function Fu(){if(qo!==null){var t=x_($m),e=qs.transition,n=Bt;try{if(qs.transition=null,Bt=16>t?16:t,qo===null)var r=!1;else{if(t=qo,qo=null,$m=0,It&6)throw Error(Re(331));var s=It;for(It|=4,He=t.current;He!==null;){var i=He,o=i.child;if(He.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(He=u;He!==null;){var c=He;switch(c.tag){case 0:case 11:case 15:kh(8,c,i)}var h=c.child;if(h!==null)h.return=c,He=h;else for(;He!==null;){c=He;var d=c.sibling,f=c.return;if(DN(c),c===u){He=null;break}if(d!==null){d.return=f,He=d;break}He=f}}}var m=i.alternate;if(m!==null){var v=m.child;if(v!==null){m.child=null;do{var p=v.sibling;v.sibling=null,v=p}while(v!==null)}}He=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,He=o;else e:for(;He!==null;){if(i=He,i.flags&2048)switch(i.tag){case 0:case 11:case 15:kh(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,He=g;break e}He=i.return}}var y=t.current;for(He=y;He!==null;){o=He;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,He=b;else e:for(o=y;He!==null;){if(a=He,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ng(9,a)}}catch(w){gn(a,a.return,w)}if(a===o){He=null;break e}var x=a.sibling;if(x!==null){x.return=a.return,He=x;break e}He=a.return}}if(It=s,ka(),Vi&&typeof Vi.onPostCommitFiberRoot=="function")try{Vi.onPostCommitFiberRoot(wg,t)}catch{}r=!0}return r}finally{Bt=n,qs.transition=e}}return!1}function yk(t,e,n){e=qu(n,e),e=bN(t,e,1),t=ra(t,e,1),e=Br(),t!==null&&(vd(t,1,e),ss(t,e))}function gn(t,e,n){if(t.tag===3)yk(t,t,n);else for(;e!==null;){if(e.tag===3){yk(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(sa===null||!sa.has(r))){t=qu(n,t),t=wN(e,t,1),e=ra(e,t,1),t=Br(),e!==null&&(vd(e,1,t),ss(e,t));break}}e=e.return}}function YB(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Br(),t.pingedLanes|=t.suspendedLanes&n,ir===t&&(pr&n)===n&&(Jn===4||Jn===3&&(pr&130023424)===pr&&500>Dn()-Mb?nl(t,0):Pb|=n),ss(t,e)}function UN(t,e){e===0&&(t.mode&1?(e=hp,hp<<=1,!(hp&130023424)&&(hp=4194304)):e=1);var n=Br();t=xo(t,e),t!==null&&(vd(t,e,n),ss(t,n))}function ZB(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),UN(t,n)}function QB(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Re(314))}r!==null&&r.delete(e),UN(t,n)}var VN;VN=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ns.current)Qr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Qr=!1,BB(t,e,n);Qr=!!(t.flags&131072)}else Qr=!1,un&&e.flags&1048576&&j_(e,wm,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Jp(t,e),t=e.pendingProps;var s=Wu(e,_r.current);Ou(e,n),s=Db(null,e,r,t,s,n);var i=Ab();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,rs(r)?(i=!0,xm(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ib(e),s.updater=Tg,e.stateNode=s,s._reactInternals=e,M1(e,r,t,n),e=U1(null,e,r,!0,i,n)):(e.tag=0,un&&i&&xb(e),Fr(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Jp(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=e4(r),t=ai(r,t),s){case 0:e=z1(null,e,r,t,n);break e;case 1:e=lk(null,e,r,t,n);break e;case 11:e=ok(null,e,r,t,n);break e;case 14:e=ak(null,e,r,ai(r.type,t),n);break e}throw Error(Re(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ai(r,s),z1(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ai(r,s),lk(t,e,r,s,n);case 3:e:{if(EN(e),t===null)throw Error(Re(387));r=e.pendingProps,i=e.memoizedState,s=i.element,X_(t,e),km(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=qu(Error(Re(423)),e),e=uk(t,e,r,n,s);break e}else if(r!==s){s=qu(Error(Re(424)),e),e=uk(t,e,r,n,s);break e}else for(vs=na(e.stateNode.containerInfo.firstChild),xs=e,un=!0,ci=null,n=J_(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Gu(),r===s){e=bo(t,e,n);break e}Fr(t,e,r,n)}e=e.child}return e;case 5:return eN(e),t===null&&F1(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,$1(r,s)?o=null:i!==null&&$1(r,i)&&(e.flags|=32),kN(t,e),Fr(t,e,o,n),e.child;case 6:return t===null&&F1(e),null;case 13:return IN(t,e,n);case 4:return Tb(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ju(e,null,r,n):Fr(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ai(r,s),ok(t,e,r,s,n);case 7:return Fr(t,e,e.pendingProps,n),e.child;case 8:return Fr(t,e,e.pendingProps.children,n),e.child;case 12:return Fr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Jt(Cm,r._currentValue),r._currentValue=o,i!==null)if(bi(i.value,o)){if(i.children===s.children&&!ns.current){e=bo(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=mo(-1,n&-n),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),L1(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Re(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),L1(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Fr(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Ou(e,n),s=Ks(s),r=r(s),e.flags|=1,Fr(t,e,r,n),e.child;case 14:return r=e.type,s=ai(r,e.pendingProps),s=ai(r.type,s),ak(t,e,r,s,n);case 15:return CN(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ai(r,s),Jp(t,e),e.tag=1,rs(r)?(t=!0,xm(e)):t=!1,Ou(e,n),Z_(e,r,s),M1(e,r,s,n),U1(null,e,r,!0,t,n);case 19:return TN(t,e,n);case 22:return SN(t,e,n)}throw Error(Re(156,e.tag))};function WN(t,e){return m_(t,e)}function JB(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Us(t,e,n,r){return new JB(t,e,n,r)}function Vb(t){return t=t.prototype,!(!t||!t.isReactComponent)}function e4(t){if(typeof t=="function")return Vb(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ab)return 11;if(t===lb)return 14}return 2}function oa(t,e){var n=t.alternate;return n===null?(n=Us(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function nm(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Vb(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case mu:return rl(n.children,s,i,e);case ob:o=8,s|=8;break;case l1:return t=Us(12,n,e,s|2),t.elementType=l1,t.lanes=i,t;case u1:return t=Us(13,n,e,s),t.elementType=u1,t.lanes=i,t;case c1:return t=Us(19,n,e,s),t.elementType=c1,t.lanes=i,t;case QT:return Dg(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case YT:o=10;break e;case ZT:o=9;break e;case ab:o=11;break e;case lb:o=14;break e;case Uo:o=16,r=null;break e}throw Error(Re(130,t==null?t:typeof t,""))}return e=Us(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function rl(t,e,n,r){return t=Us(7,t,r,e),t.lanes=n,t}function Dg(t,e,n,r){return t=Us(22,t,r,e),t.elementType=QT,t.lanes=n,t.stateNode={isHidden:!1},t}function yy(t,e,n){return t=Us(6,t,null,e),t.lanes=n,t}function xy(t,e,n){return e=Us(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function t4(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Jv(0),this.expirationTimes=Jv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jv(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Wb(t,e,n,r,s,i,o,a,l){return t=new t4(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Us(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ib(i),t}function n4(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pu,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function GN(t){if(!t)return fa;t=t._reactInternals;e:{if(Al(t)!==t||t.tag!==1)throw Error(Re(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(rs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Re(171))}if(t.tag===1){var n=t.type;if(rs(n))return W_(t,n,e)}return e}function jN(t,e,n,r,s,i,o,a,l){return t=Wb(n,r,!0,t,s,i,o,a,l),t.context=GN(null),n=t.current,r=Br(),s=ia(n),i=mo(r,s),i.callback=e??null,ra(n,i,s),t.current.lanes=s,vd(t,s,r),ss(t,r),t}function Ag(t,e,n,r){var s=e.current,i=Br(),o=ia(s);return n=GN(n),e.context===null?e.context=n:e.pendingContext=n,e=mo(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ra(s,e,o),t!==null&&(mi(t,s,o,i),Yp(t,s,o)),o}function Am(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function xk(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Gb(t,e){xk(t,e),(t=t.alternate)&&xk(t,e)}function r4(){return null}var HN=typeof reportError=="function"?reportError:function(t){console.error(t)};function jb(t){this._internalRoot=t}Rg.prototype.render=jb.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Re(409));Ag(t,e,null,null)};Rg.prototype.unmount=jb.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;hl(function(){Ag(null,t,null,null)}),e[yo]=null}};function Rg(t){this._internalRoot=t}Rg.prototype.unstable_scheduleHydration=function(t){if(t){var e=C_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Go.length&&e!==0&&e<Go[n].priority;n++);Go.splice(n,0,t),n===0&&k_(t)}};function Hb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Og(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function bk(){}function s4(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Am(o);i.call(u)}}var o=jN(e,r,t,0,null,!1,!1,"",bk);return t._reactRootContainer=o,t[yo]=o.current,Wh(t.nodeType===8?t.parentNode:t),hl(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var u=Am(l);a.call(u)}}var l=Wb(t,0,!1,null,null,!1,!1,"",bk);return t._reactRootContainer=l,t[yo]=l.current,Wh(t.nodeType===8?t.parentNode:t),hl(function(){Ag(e,l,n,r)}),l}function Fg(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Am(o);a.call(l)}}Ag(e,o,t,s)}else o=s4(n,e,t,s,r);return Am(o)}b_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=uh(e.pendingLanes);n!==0&&(hb(e,n|1),ss(e,Dn()),!(It&6)&&(Ku=Dn()+500,ka()))}break;case 13:hl(function(){var r=xo(t,1);if(r!==null){var s=Br();mi(r,t,1,s)}}),Gb(t,1)}};db=function(t){if(t.tag===13){var e=xo(t,134217728);if(e!==null){var n=Br();mi(e,t,134217728,n)}Gb(t,134217728)}};w_=function(t){if(t.tag===13){var e=ia(t),n=xo(t,e);if(n!==null){var r=Br();mi(n,t,e,r)}Gb(t,e)}};C_=function(){return Bt};S_=function(t,e){var n=Bt;try{return Bt=t,e()}finally{Bt=n}};b1=function(t,e,n){switch(e){case"input":if(f1(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Eg(r);if(!s)throw Error(Re(90));e_(r),f1(r,s)}}}break;case"textarea":n_(t,n);break;case"select":e=n.value,e!=null&&$u(t,!!n.multiple,e,!1)}};u_=Bb;c_=hl;var i4={usingClientEntryPoint:!1,Events:[xd,xu,Eg,a_,l_,Bb]},Gc={findFiberByHostInstance:Xa,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},o4={bundleType:Gc.bundleType,version:Gc.version,rendererPackageName:Gc.rendererPackageName,rendererConfig:Gc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:To.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=f_(t),t===null?null:t.stateNode},findFiberByHostInstance:Gc.findFiberByHostInstance||r4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cp.isDisabled&&Cp.supportsFiber)try{wg=Cp.inject(o4),Vi=Cp}catch{}}Ss.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=i4;Ss.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Hb(e))throw Error(Re(200));return n4(t,e,null,n)};Ss.createRoot=function(t,e){if(!Hb(t))throw Error(Re(299));var n=!1,r="",s=HN;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Wb(t,1,!1,null,null,n,!1,r,s),t[yo]=e.current,Wh(t.nodeType===8?t.parentNode:t),new jb(e)};Ss.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Re(188)):(t=Object.keys(t).join(","),Error(Re(268,t)));return t=f_(e),t=t===null?null:t.stateNode,t};Ss.flushSync=function(t){return hl(t)};Ss.hydrate=function(t,e,n){if(!Og(e))throw Error(Re(200));return Fg(null,t,e,!0,n)};Ss.hydrateRoot=function(t,e,n){if(!Hb(t))throw Error(Re(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=HN;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=jN(e,null,t,1,n??null,s,!1,i,o),t[yo]=e.current,Wh(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Rg(e)};Ss.render=function(t,e,n){if(!Og(e))throw Error(Re(200));return Fg(null,t,e,!1,n)};Ss.unmountComponentAtNode=function(t){if(!Og(t))throw Error(Re(40));return t._reactRootContainer?(hl(function(){Fg(null,null,t,!1,function(){t._reactRootContainer=null,t[yo]=null})}),!0):!1};Ss.unstable_batchedUpdates=Bb;Ss.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Og(n))throw Error(Re(200));if(t==null||t._reactInternals===void 0)throw Error(Re(38));return Fg(t,e,n,!1,r)};Ss.version="18.2.0-next-9e3b772b8-20220608";function qN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qN)}catch(t){console.error(t)}}qN(),jT.exports=Ss;var KN=jT.exports,wk=KN;o1.createRoot=wk.createRoot,o1.hydrateRoot=wk.hydrateRoot;var XN={};Object.defineProperty(XN,"__esModule",{value:!0});var a4=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},l4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u4=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c4=Ce,by=p4(c4),h4=KN,d4=f4(h4);function f4(t){return t&&t.__esModule?t:{default:t}}function p4(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function m4(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}function g4(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v4(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function y4(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var x4=function(t){y4(e,t);function e(n){g4(this,e);var r=v4(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n));r.handleChange=function(i){var o=Array.prototype.slice.call(i.target.files),a=(r.props.as||"url").toLowerCase();Promise.all(o.map(function(l){return new Promise(function(u,c){var h=new FileReader;switch(h.onload=function(d){u([d,l])},a){case"binary":{h.readAsBinaryString(l);break}case"buffer":{h.readAsArrayBuffer(l);break}case"text":{h.readAsText(l);break}case"url":{h.readAsDataURL(l);break}}})})).then(function(l){r.props.onChange(i,l)})},r.triggerInput=function(){var i=d4.default.findDOMNode(r._reactFileReaderInput);i&&i.click()};var s=(typeof window>"u"?"undefined":l4(window))==="object"?window:{};return(!s.File||!s.FileReader||!s.FileList||!s.Blob)&&console.warn("[react-file-reader-input] Some file APIs detected as not supported. File reader functionality may not fully work."),r}return u4(e,[{key:"render",value:function(){var r=this,s=this.props;s.as;var i=s.children,o=s.style,a=m4(s,["as","children","style"]),l=i?{position:"absolute",top:"-9999px"}:{};return by.createElement("div",{className:"_react-file-reader-input",onClick:this.triggerInput,style:o},by.createElement("input",a4({},a,{type:"file",ref:function(c){r._reactFileReaderInput=c},onChange:this.handleChange,onClick:function(){r._reactFileReaderInput.value=null},style:l})),i)}}]),e}(by.Component),b4=XN.default=x4;/**
 * @remix-run/router v1.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vn(){return vn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vn.apply(this,arguments)}var Nn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Nn||(Nn={}));const Ck="popstate";function w4(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Qh("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:wd(s)}return S4(e,n,null,t)}function xt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function dl(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function C4(){return Math.random().toString(36).substr(2,8)}function Sk(t,e){return{usr:t.state,key:t.key,idx:e}}function Qh(t,e,n,r){return n===void 0&&(n=null),vn({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?_o(e):e,{state:n,key:e&&e.key||r||C4()})}function wd(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function _o(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function S4(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=Nn.Pop,l=null,u=c();u==null&&(u=0,o.replaceState(vn({},o.state,{idx:u}),""));function c(){return(o.state||{idx:null}).idx}function h(){a=Nn.Pop;let p=c(),g=p==null?null:p-u;u=p,l&&l({action:a,location:v.location,delta:g})}function d(p,g){a=Nn.Push;let y=Qh(v.location,p,g);n&&n(y,p),u=c()+1;let b=Sk(y,u),x=v.createHref(y);try{o.pushState(b,"",x)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;s.location.assign(x)}i&&l&&l({action:a,location:v.location,delta:1})}function f(p,g){a=Nn.Replace;let y=Qh(v.location,p,g);n&&n(y,p),u=c();let b=Sk(y,u),x=v.createHref(y);o.replaceState(b,"",x),i&&l&&l({action:a,location:v.location,delta:0})}function m(p){let g=s.location.origin!=="null"?s.location.origin:s.location.href,y=typeof p=="string"?p:wd(p);return xt(g,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,g)}let v={get action(){return a},get location(){return t(s,o)},listen(p){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Ck,h),l=p,()=>{s.removeEventListener(Ck,h),l=null}},createHref(p){return e(s,p)},createURL:m,encodeLocation(p){let g=m(p);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:d,replace:f,go(p){return o.go(p)}};return v}var $n;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})($n||($n={}));const k4=new Set(["lazy","caseSensitive","path","id","index","children"]);function E4(t){return t.index===!0}function J1(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((s,i)=>{let o=[...n,i],a=typeof s.id=="string"?s.id:o.join("-");if(xt(s.index!==!0||!s.children,"Cannot specify children on an index route"),xt(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),E4(s)){let l=vn({},s,e(s),{id:a});return r[a]=l,l}else{let l=vn({},s,e(s),{id:a,children:void 0});return r[a]=l,s.children&&(l.children=J1(s.children,e,o,r)),l}})}function Iu(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?_o(e):e,s=Cd(r.pathname||"/",n);if(s==null)return null;let i=YN(t);T4(i);let o=null;for(let a=0;o==null&&a<i.length;++a)o=L4(i[a],B4(s));return o}function I4(t,e){let{route:n,pathname:r,params:s}=t;return{id:n.id,pathname:r,params:s,data:e[n.id],handle:n.handle}}function YN(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(xt(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=aa([r,l.relativePath]),c=n.concat(l);i.children&&i.children.length>0&&(xt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),YN(i.children,e,c,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:O4(u,i.index),routesMeta:c})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of ZN(i.path))s(i,o,l)}),e}function ZN(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=ZN(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function T4(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:F4(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const _4=/^:\w+$/,N4=3,$4=2,D4=1,A4=10,R4=-2,kk=t=>t==="*";function O4(t,e){let n=t.split("/"),r=n.length;return n.some(kk)&&(r+=R4),e&&(r+=$4),n.filter(s=>!kk(s)).reduce((s,i)=>s+(_4.test(i)?N4:i===""?D4:A4),r)}function F4(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function L4(t,e){let{routesMeta:n}=t,r={},s="/",i=[];for(let o=0;o<n.length;++o){let a=n[o],l=o===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",c=P4({path:a.relativePath,caseSensitive:a.caseSensitive,end:l},u);if(!c)return null;Object.assign(r,c.params);let h=a.route;i.push({params:r,pathname:aa([s,c.pathname]),pathnameBase:W4(aa([s,c.pathnameBase])),route:h}),c.pathnameBase!=="/"&&(s=aa([s,c.pathnameBase]))}return i}function P4(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=M4(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((u,c,h)=>{let{paramName:d,isOptional:f}=c;if(d==="*"){let v=a[h]||"";o=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const m=a[h];return f&&!m?u[d]=void 0:u[d]=z4(m||"",d),u},{}),pathname:i,pathnameBase:o,pattern:t}}function M4(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),dl(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function B4(t){try{return decodeURI(t)}catch(e){return dl(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function z4(t,e){try{return decodeURIComponent(t)}catch(n){return dl(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function Cd(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function U4(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?_o(t):t;return{pathname:n?n.startsWith("/")?n:V4(n,e):e,search:G4(r),hash:j4(s)}}function V4(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function wy(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function qb(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function QN(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=_o(t):(s=vn({},t),xt(!s.pathname||!s.pathname.includes("?"),wy("?","pathname","search",s)),xt(!s.pathname||!s.pathname.includes("#"),wy("#","pathname","hash",s)),xt(!s.search||!s.search.includes("#"),wy("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(r||o==null)a=n;else{let h=e.length-1;if(o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;s.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=U4(s,a),u=o&&o!=="/"&&o.endsWith("/"),c=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const aa=t=>t.join("/").replace(/\/\/+/g,"/"),W4=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),G4=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,j4=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Kb{constructor(e,n,r,s){s===void 0&&(s=!1),this.status=e,this.statusText=n||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function JN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const e$=["post","put","patch","delete"],H4=new Set(e$),q4=["get",...e$],K4=new Set(q4),X4=new Set([301,302,303,307,308]),Y4=new Set([307,308]),Cy={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Z4={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},jc={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},t$=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Q4=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),n$="remix-router-transitions";function J4(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;xt(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let $=t.detectErrorBoundary;s=V=>({hasErrorBoundary:$(V)})}else s=Q4;let i={},o=J1(t.routes,s,void 0,i),a,l=t.basename||"/",u=vn({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_prependBasename:!1},t.future),c=null,h=new Set,d=null,f=null,m=null,v=t.hydrationData!=null,p=Iu(o,t.history.location,l),g=null;if(p==null){let $=Ls(404,{pathname:t.history.location.pathname}),{matches:V,route:I}=Ak(o);p=V,g={[I.id]:$}}let y=!p.some($=>$.route.lazy)&&(!p.some($=>$.route.loader)||t.hydrationData!=null),b,x={historyAction:t.history.action,location:t.history.location,matches:p,initialized:y,navigation:Cy,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||g,fetchers:new Map,blockers:new Map},w=Nn.Pop,C=!1,S,E=!1,T=new Map,_=null,A=!1,L=!1,W=[],K=[],R=new Map,M=0,U=-1,D=new Map,B=new Set,X=new Map,ie=new Map,G=new Set,Z=new Map,de=new Map,ge=!1;function ye(){if(c=t.history.listen($=>{let{action:V,location:I,delta:ce}=$;if(ge){ge=!1;return}dl(de.size===0||ce!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Ee=Gt({currentLocation:x.location,nextLocation:I,historyAction:V});if(Ee&&ce!=null){ge=!0,t.history.go(ce*-1),nr(Ee,{state:"blocked",location:I,proceed(){nr(Ee,{state:"proceeding",proceed:void 0,reset:void 0,location:I}),t.history.go(ce)},reset(){let k=new Map(x.blockers);k.set(Ee,jc),fe({blockers:k})}});return}return Pe(V,I)}),n){cz(e,T);let $=()=>hz(e,T);e.addEventListener("pagehide",$),_=()=>e.removeEventListener("pagehide",$)}return x.initialized||Pe(Nn.Pop,x.location),b}function j(){c&&c(),_&&_(),h.clear(),S&&S.abort(),x.fetchers.forEach(($,V)=>Tt(V)),x.blockers.forEach(($,V)=>br(V))}function J($){return h.add($),()=>h.delete($)}function fe($,V){x=vn({},x,$);let I=[],ce=[];u.v7_fetcherPersist&&x.fetchers.forEach((Ee,k)=>{Ee.state==="idle"&&(G.has(k)?ce.push(k):I.push(k))}),h.forEach(Ee=>Ee(x,{deletedFetchers:ce,unstable_viewTransitionOpts:V})),u.v7_fetcherPersist&&(I.forEach(Ee=>x.fetchers.delete(Ee)),ce.forEach(Ee=>Tt(Ee)))}function ve($,V){var I,ce;let Ee=x.actionData!=null&&x.navigation.formMethod!=null&&ui(x.navigation.formMethod)&&x.navigation.state==="loading"&&((I=$.state)==null?void 0:I._isRedirect)!==!0,k;V.actionData?Object.keys(V.actionData).length>0?k=V.actionData:k=null:Ee?k=x.actionData:k=null;let se=V.loaderData?Dk(x.loaderData,V.loaderData,V.matches||[],V.errors):x.loaderData,re=x.blockers;re.size>0&&(re=new Map(re),re.forEach((ue,$e)=>re.set($e,jc)));let N=C===!0||x.navigation.formMethod!=null&&ui(x.navigation.formMethod)&&((ce=$.state)==null?void 0:ce._isRedirect)!==!0;a&&(o=a,a=void 0),A||w===Nn.Pop||(w===Nn.Push?t.history.push($,$.state):w===Nn.Replace&&t.history.replace($,$.state));let q;if(w===Nn.Pop){let ue=T.get(x.location.pathname);ue&&ue.has($.pathname)?q={currentLocation:x.location,nextLocation:$}:T.has($.pathname)&&(q={currentLocation:$,nextLocation:x.location})}else if(E){let ue=T.get(x.location.pathname);ue?ue.add($.pathname):(ue=new Set([$.pathname]),T.set(x.location.pathname,ue)),q={currentLocation:x.location,nextLocation:$}}fe(vn({},V,{actionData:k,loaderData:se,historyAction:w,location:$,initialized:!0,navigation:Cy,revalidation:"idle",restoreScrollPosition:Ne($,V.matches||x.matches),preventScrollReset:N,blockers:re}),q),w=Nn.Pop,C=!1,E=!1,A=!1,L=!1,W=[],K=[]}async function we($,V){if(typeof $=="number"){t.history.go($);return}let I=ex(x.location,x.matches,l,u.v7_prependBasename,$,V==null?void 0:V.fromRouteId,V==null?void 0:V.relative),{path:ce,submission:Ee,error:k}=Ek(u.v7_normalizeFormMethod,!1,I,V),se=x.location,re=Qh(x.location,ce,V&&V.state);re=vn({},re,t.history.encodeLocation(re));let N=V&&V.replace!=null?V.replace:void 0,q=Nn.Push;N===!0?q=Nn.Replace:N===!1||Ee!=null&&ui(Ee.formMethod)&&Ee.formAction===x.location.pathname+x.location.search&&(q=Nn.Replace);let ue=V&&"preventScrollReset"in V?V.preventScrollReset===!0:void 0,$e=Gt({currentLocation:se,nextLocation:re,historyAction:q});if($e){nr($e,{state:"blocked",location:re,proceed(){nr($e,{state:"proceeding",proceed:void 0,reset:void 0,location:re}),we($,V)},reset(){let Te=new Map(x.blockers);Te.set($e,jc),fe({blockers:Te})}});return}return await Pe(q,re,{submission:Ee,pendingError:k,preventScrollReset:ue,replace:V&&V.replace,enableViewTransition:V&&V.unstable_viewTransition})}function De(){if(at(),fe({revalidation:"loading"}),x.navigation.state!=="submitting"){if(x.navigation.state==="idle"){Pe(x.historyAction,x.location,{startUninterruptedRevalidation:!0});return}Pe(w||x.historyAction,x.navigation.location,{overrideNavigation:x.navigation})}}async function Pe($,V,I){S&&S.abort(),S=null,w=$,A=(I&&I.startUninterruptedRevalidation)===!0,ke(x.location,x.matches),C=(I&&I.preventScrollReset)===!0,E=(I&&I.enableViewTransition)===!0;let ce=a||o,Ee=I&&I.overrideNavigation,k=Iu(ce,V,l);if(!k){let Te=Ls(404,{pathname:V.pathname}),{matches:Fe,route:ot}=Ak(ce);Mn(),ve(V,{matches:Fe,loaderData:{},errors:{[ot.id]:Te}});return}if(x.initialized&&!L&&sz(x.location,V)&&!(I&&I.submission&&ui(I.submission.formMethod))){ve(V,{matches:k});return}S=new AbortController;let se=qc(t.history,V,S.signal,I&&I.submission),re,N;if(I&&I.pendingError)N={[Th(k).route.id]:I.pendingError};else if(I&&I.submission&&ui(I.submission.formMethod)){let Te=await Ge(se,V,I.submission,k,{replace:I.replace});if(Te.shortCircuited)return;re=Te.pendingActionData,N=Te.pendingActionError,Ee=Sy(V,I.submission),se=new Request(se.url,{signal:se.signal})}let{shortCircuited:q,loaderData:ue,errors:$e}=await Xe(se,V,k,Ee,I&&I.submission,I&&I.fetcherSubmission,I&&I.replace,re,N);q||(S=null,ve(V,vn({matches:k},re?{actionData:re}:{},{loaderData:ue,errors:$e})))}async function Ge($,V,I,ce,Ee){Ee===void 0&&(Ee={}),at();let k=lz(V,I);fe({navigation:k});let se,re=nx(ce,V);if(!re.route.action&&!re.route.lazy)se={type:$n.error,error:Ls(405,{method:$.method,pathname:V.pathname,routeId:re.route.id})};else if(se=await Hc("action",$,re,ce,i,s,l),$.signal.aborted)return{shortCircuited:!0};if(Lu(se)){let N;return Ee&&Ee.replace!=null?N=Ee.replace:N=se.location===x.location.pathname+x.location.search,await dt(x,se,{submission:I,replace:N}),{shortCircuited:!0}}if(_h(se)){let N=Th(ce,re.route.id);return(Ee&&Ee.replace)!==!0&&(w=Nn.Push),{pendingActionData:{},pendingActionError:{[N.route.id]:se.error}}}if(Qa(se))throw Ls(400,{type:"defer-action"});return{pendingActionData:{[re.route.id]:se.data}}}async function Xe($,V,I,ce,Ee,k,se,re,N){let q=ce||Sy(V,Ee),ue=Ee||k||Fk(q),$e=a||o,[Te,Fe]=Ik(t.history,x,I,ue,V,L,W,K,X,B,$e,l,re,N);if(Mn(ct=>!(I&&I.some(Dt=>Dt.route.id===ct))||Te&&Te.some(Dt=>Dt.route.id===ct)),U=++M,Te.length===0&&Fe.length===0){let ct=In();return ve(V,vn({matches:I,loaderData:{},errors:N||null},re?{actionData:re}:{},ct?{fetchers:new Map(x.fetchers)}:{})),{shortCircuited:!0}}if(!A){Fe.forEach(Dt=>{let Bn=x.fetchers.get(Dt.key),kt=Kc(void 0,Bn?Bn.data:void 0);x.fetchers.set(Dt.key,kt)});let ct=re||x.actionData;fe(vn({navigation:q},ct?Object.keys(ct).length===0?{actionData:null}:{actionData:ct}:{},Fe.length>0?{fetchers:new Map(x.fetchers)}:{}))}Fe.forEach(ct=>{R.has(ct.key)&&Pt(ct.key),ct.controller&&R.set(ct.key,ct.controller)});let ot=()=>Fe.forEach(ct=>Pt(ct.key));S&&S.signal.addEventListener("abort",ot);let{results:Kn,loaderResults:Rt,fetcherResults:vt}=await Lt(x.matches,I,Te,Fe,$);if($.signal.aborted)return{shortCircuited:!0};S&&S.signal.removeEventListener("abort",ot),Fe.forEach(ct=>R.delete(ct.key));let $t=Rk(Kn);if($t){if($t.idx>=Te.length){let ct=Fe[$t.idx-Te.length].key;B.add(ct)}return await dt(x,$t.result,{replace:se}),{shortCircuited:!0}}let{loaderData:jt,errors:Tn}=$k(x,I,Te,Rt,N,Fe,vt,Z);Z.forEach((ct,Dt)=>{ct.subscribe(Bn=>{(Bn||ct.done)&&Z.delete(Dt)})});let Ti=In(),_i=Ln(U),Yt=Ti||_i||Fe.length>0;return vn({loaderData:jt,errors:Tn},Yt?{fetchers:new Map(x.fetchers)}:{})}function Je($){return u.v7_fetcherPersist&&(ie.set($,(ie.get($)||0)+1),G.has($)&&G.delete($)),x.fetchers.get($)||Z4}function Ze($,V,I,ce){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");R.has($)&&Pt($);let Ee=a||o,k=ex(x.location,x.matches,l,u.v7_prependBasename,I,V,ce==null?void 0:ce.relative),se=Iu(Ee,k,l);if(!se){tt($,V,Ls(404,{pathname:k}));return}let{path:re,submission:N,error:q}=Ek(u.v7_normalizeFormMethod,!0,k,ce);if(q){tt($,V,q);return}let ue=nx(se,re);if(C=(ce&&ce.preventScrollReset)===!0,N&&ui(N.formMethod)){it($,V,re,ue,se,N);return}X.set($,{routeId:V,path:re}),dn($,V,re,ue,se,N)}async function it($,V,I,ce,Ee,k){if(at(),X.delete($),!ce.route.action&&!ce.route.lazy){let kt=Ls(405,{method:k.formMethod,pathname:I,routeId:V});tt($,V,kt);return}let se=x.fetchers.get($),re=uz(k,se);x.fetchers.set($,re),fe({fetchers:new Map(x.fetchers)});let N=new AbortController,q=qc(t.history,I,N.signal,k);R.set($,N);let ue=M,$e=await Hc("action",q,ce,Ee,i,s,l);if(q.signal.aborted){R.get($)===N&&R.delete($);return}if(G.has($)){x.fetchers.set($,zo(void 0)),fe({fetchers:new Map(x.fetchers)});return}if(Lu($e))if(R.delete($),U>ue){let kt=zo(void 0);x.fetchers.set($,kt),fe({fetchers:new Map(x.fetchers)});return}else{B.add($);let kt=Kc(k);return x.fetchers.set($,kt),fe({fetchers:new Map(x.fetchers)}),dt(x,$e,{fetcherSubmission:k})}if(_h($e)){tt($,V,$e.error);return}if(Qa($e))throw Ls(400,{type:"defer-action"});let Te=x.navigation.location||x.location,Fe=qc(t.history,Te,N.signal),ot=a||o,Kn=x.navigation.state!=="idle"?Iu(ot,x.navigation.location,l):x.matches;xt(Kn,"Didn't find any matches after fetcher action");let Rt=++M;D.set($,Rt);let vt=Kc(k,$e.data);x.fetchers.set($,vt);let[$t,jt]=Ik(t.history,x,Kn,k,Te,L,W,K,X,B,ot,l,{[ce.route.id]:$e.data},void 0);jt.filter(kt=>kt.key!==$).forEach(kt=>{let Ni=kt.key,rp=x.fetchers.get(Ni),sp=Kc(void 0,rp?rp.data:void 0);x.fetchers.set(Ni,sp),R.has(Ni)&&Pt(Ni),kt.controller&&R.set(Ni,kt.controller)}),fe({fetchers:new Map(x.fetchers)});let Tn=()=>jt.forEach(kt=>Pt(kt.key));N.signal.addEventListener("abort",Tn);let{results:Ti,loaderResults:_i,fetcherResults:Yt}=await Lt(x.matches,Kn,$t,jt,Fe);if(N.signal.aborted)return;N.signal.removeEventListener("abort",Tn),D.delete($),R.delete($),jt.forEach(kt=>R.delete(kt.key));let ct=Rk(Ti);if(ct){if(ct.idx>=$t.length){let kt=jt[ct.idx-$t.length].key;B.add(kt)}return dt(x,ct.result)}let{loaderData:Dt,errors:Bn}=$k(x,x.matches,$t,_i,void 0,jt,Yt,Z);if(x.fetchers.has($)){let kt=zo($e.data);x.fetchers.set($,kt)}Ln(Rt),x.navigation.state==="loading"&&Rt>U?(xt(w,"Expected pending action"),S&&S.abort(),ve(x.navigation.location,{matches:Kn,loaderData:Dt,errors:Bn,fetchers:new Map(x.fetchers)})):(fe({errors:Bn,loaderData:Dk(x.loaderData,Dt,Kn,Bn),fetchers:new Map(x.fetchers)}),L=!1)}async function dn($,V,I,ce,Ee,k){let se=x.fetchers.get($),re=Kc(k,se?se.data:void 0);x.fetchers.set($,re),fe({fetchers:new Map(x.fetchers)});let N=new AbortController,q=qc(t.history,I,N.signal);R.set($,N);let ue=M,$e=await Hc("loader",q,ce,Ee,i,s,l);if(Qa($e)&&($e=await i$($e,q.signal,!0)||$e),R.get($)===N&&R.delete($),q.signal.aborted)return;if(G.has($)){x.fetchers.set($,zo(void 0)),fe({fetchers:new Map(x.fetchers)});return}if(Lu($e))if(U>ue){let Fe=zo(void 0);x.fetchers.set($,Fe),fe({fetchers:new Map(x.fetchers)});return}else{B.add($),await dt(x,$e);return}if(_h($e)){tt($,V,$e.error);return}xt(!Qa($e),"Unhandled fetcher deferred data");let Te=zo($e.data);x.fetchers.set($,Te),fe({fetchers:new Map(x.fetchers)})}async function dt($,V,I){let{submission:ce,fetcherSubmission:Ee,replace:k}=I===void 0?{}:I;V.revalidate&&(L=!0);let se=Qh($.location,V.location,{_isRedirect:!0});if(xt(se,"Expected a location on the redirect navigation"),n){let Te=!1;if(V.reloadDocument)Te=!0;else if(t$.test(V.location)){const Fe=t.history.createURL(V.location);Te=Fe.origin!==e.location.origin||Cd(Fe.pathname,l)==null}if(Te){k?e.location.replace(V.location):e.location.assign(V.location);return}}S=null;let re=k===!0?Nn.Replace:Nn.Push,{formMethod:N,formAction:q,formEncType:ue}=$.navigation;!ce&&!Ee&&N&&q&&ue&&(ce=Fk($.navigation));let $e=ce||Ee;if(Y4.has(V.status)&&$e&&ui($e.formMethod))await Pe(re,se,{submission:vn({},$e,{formAction:V.location}),preventScrollReset:C});else{let Te=Sy(se,ce);await Pe(re,se,{overrideNavigation:Te,fetcherSubmission:Ee,preventScrollReset:C})}}async function Lt($,V,I,ce,Ee){let k=await Promise.all([...I.map(N=>Hc("loader",Ee,N,V,i,s,l)),...ce.map(N=>N.matches&&N.match&&N.controller?Hc("loader",qc(t.history,N.path,N.controller.signal),N.match,N.matches,i,s,l):{type:$n.error,error:Ls(404,{pathname:N.path})})]),se=k.slice(0,I.length),re=k.slice(I.length);return await Promise.all([Ok($,I,se,se.map(()=>Ee.signal),!1,x.loaderData),Ok($,ce.map(N=>N.match),re,ce.map(N=>N.controller?N.controller.signal:null),!0)]),{results:k,loaderResults:se,fetcherResults:re}}function at(){L=!0,W.push(...Mn()),X.forEach(($,V)=>{R.has(V)&&(K.push(V),Pt(V))})}function tt($,V,I){let ce=Th(x.matches,V);Tt($),fe({errors:{[ce.route.id]:I},fetchers:new Map(x.fetchers)})}function Tt($){let V=x.fetchers.get($);R.has($)&&!(V&&V.state==="loading"&&D.has($))&&Pt($),X.delete($),D.delete($),B.delete($),G.delete($),x.fetchers.delete($)}function En($){if(u.v7_fetcherPersist){let V=(ie.get($)||0)-1;V<=0?(ie.delete($),G.add($)):ie.set($,V)}else Tt($);fe({fetchers:new Map(x.fetchers)})}function Pt($){let V=R.get($);xt(V,"Expected fetch controller: "+$),V.abort(),R.delete($)}function Wt($){for(let V of $){let I=Je(V),ce=zo(I.data);x.fetchers.set(V,ce)}}function In(){let $=[],V=!1;for(let I of B){let ce=x.fetchers.get(I);xt(ce,"Expected fetcher: "+I),ce.state==="loading"&&(B.delete(I),$.push(I),V=!0)}return Wt($),V}function Ln($){let V=[];for(let[I,ce]of D)if(ce<$){let Ee=x.fetchers.get(I);xt(Ee,"Expected fetcher: "+I),Ee.state==="loading"&&(Pt(I),D.delete(I),V.push(I))}return Wt(V),V.length>0}function Pn($,V){let I=x.blockers.get($)||jc;return de.get($)!==V&&de.set($,V),I}function br($){x.blockers.delete($),de.delete($)}function nr($,V){let I=x.blockers.get($)||jc;xt(I.state==="unblocked"&&V.state==="blocked"||I.state==="blocked"&&V.state==="blocked"||I.state==="blocked"&&V.state==="proceeding"||I.state==="blocked"&&V.state==="unblocked"||I.state==="proceeding"&&V.state==="unblocked","Invalid blocker state transition: "+I.state+" -> "+V.state);let ce=new Map(x.blockers);ce.set($,V),fe({blockers:ce})}function Gt($){let{currentLocation:V,nextLocation:I,historyAction:ce}=$;if(de.size===0)return;de.size>1&&dl(!1,"A router only supports one blocker at a time");let Ee=Array.from(de.entries()),[k,se]=Ee[Ee.length-1],re=x.blockers.get(k);if(!(re&&re.state==="proceeding")&&se({currentLocation:V,nextLocation:I,historyAction:ce}))return k}function Mn($){let V=[];return Z.forEach((I,ce)=>{(!$||$(ce))&&(I.cancel(),V.push(ce),Z.delete(ce))}),V}function Ts($,V,I){if(d=$,m=V,f=I||null,!v&&x.navigation===Cy){v=!0;let ce=Ne(x.location,x.matches);ce!=null&&fe({restoreScrollPosition:ce})}return()=>{d=null,m=null,f=null}}function P($,V){return f&&f($,V.map(ce=>I4(ce,x.loaderData)))||$.key}function ke($,V){if(d&&m){let I=P($,V);d[I]=m()}}function Ne($,V){if(d){let I=P($,V),ce=d[I];if(typeof ce=="number")return ce}return null}function We($){i={},a=J1($,s,void 0,i)}return b={get basename(){return l},get state(){return x},get routes(){return o},get window(){return e},initialize:ye,subscribe:J,enableScrollRestoration:Ts,navigate:we,fetch:Ze,revalidate:De,createHref:$=>t.history.createHref($),encodeLocation:$=>t.history.encodeLocation($),getFetcher:Je,deleteFetcher:En,dispose:j,getBlocker:Pn,deleteBlocker:br,_internalFetchControllers:R,_internalActiveDeferreds:Z,_internalSetRoutes:We},b}function ez(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function ex(t,e,n,r,s,i,o){let a,l;if(i!=null&&o!=="path"){a=[];for(let c of e)if(a.push(c),c.route.id===i){l=c;break}}else a=e,l=e[e.length-1];let u=QN(s||".",qb(a).map(c=>c.pathnameBase),Cd(t.pathname,n)||t.pathname,o==="path");return s==null&&(u.search=t.search,u.hash=t.hash),(s==null||s===""||s===".")&&l&&l.route.index&&!Xb(u.search)&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),r&&n!=="/"&&(u.pathname=u.pathname==="/"?n:aa([n,u.pathname])),wd(u)}function Ek(t,e,n,r){if(!r||!ez(r))return{path:n};if(r.formMethod&&!az(r.formMethod))return{path:n,error:Ls(405,{method:r.formMethod})};let s=()=>({path:n,error:Ls(400,{type:"invalid-body"})}),i=r.formMethod||"get",o=t?i.toUpperCase():i.toLowerCase(),a=s$(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!ui(o))return s();let d=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((f,m)=>{let[v,p]=m;return""+f+v+"="+p+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:d}}}else if(r.formEncType==="application/json"){if(!ui(o))return s();try{let d=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:d,text:void 0}}}catch{return s()}}}xt(typeof FormData=="function","FormData is not available in this environment");let l,u;if(r.formData)l=tx(r.formData),u=r.formData;else if(r.body instanceof FormData)l=tx(r.body),u=r.body;else if(r.body instanceof URLSearchParams)l=r.body,u=Nk(l);else if(r.body==null)l=new URLSearchParams,u=new FormData;else try{l=new URLSearchParams(r.body),u=Nk(l)}catch{return s()}let c={formMethod:o,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:u,json:void 0,text:void 0};if(ui(c.formMethod))return{path:n,submission:c};let h=_o(n);return e&&h.search&&Xb(h.search)&&l.append("index",""),h.search="?"+l,{path:wd(h),submission:c}}function tz(t,e){let n=t;if(e){let r=t.findIndex(s=>s.route.id===e);r>=0&&(n=t.slice(0,r))}return n}function Ik(t,e,n,r,s,i,o,a,l,u,c,h,d,f){let m=f?Object.values(f)[0]:d?Object.values(d)[0]:void 0,v=t.createURL(e.location),p=t.createURL(s),g=f?Object.keys(f)[0]:void 0,b=tz(n,g).filter((w,C)=>{if(w.route.lazy)return!0;if(w.route.loader==null)return!1;if(nz(e.loaderData,e.matches[C],w)||o.some(T=>T===w.route.id))return!0;let S=e.matches[C],E=w;return Tk(w,vn({currentUrl:v,currentParams:S.params,nextUrl:p,nextParams:E.params},r,{actionResult:m,defaultShouldRevalidate:i||v.pathname+v.search===p.pathname+p.search||v.search!==p.search||r$(S,E)}))}),x=[];return l.forEach((w,C)=>{if(!n.some(A=>A.route.id===w.routeId))return;let S=Iu(c,w.path,h);if(!S){x.push({key:C,routeId:w.routeId,path:w.path,matches:null,match:null,controller:null});return}let E=e.fetchers.get(C),T=nx(S,w.path),_=!1;u.has(C)?_=!1:a.includes(C)?_=!0:E&&E.state!=="idle"&&E.data===void 0?_=i:_=Tk(T,vn({currentUrl:v,currentParams:e.matches[e.matches.length-1].params,nextUrl:p,nextParams:n[n.length-1].params},r,{actionResult:m,defaultShouldRevalidate:i})),_&&x.push({key:C,routeId:w.routeId,path:w.path,matches:S,match:T,controller:new AbortController})}),[b,x]}function nz(t,e,n){let r=!e||n.route.id!==e.route.id,s=t[n.route.id]===void 0;return r||s}function r$(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function Tk(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}async function _k(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let s=n[t.id];xt(s,"No route found in manifest");let i={};for(let o in r){let l=s[o]!==void 0&&o!=="hasErrorBoundary";dl(!l,'Route "'+s.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!l&&!k4.has(o)&&(i[o]=r[o])}Object.assign(s,i),Object.assign(s,vn({},e(s),{lazy:void 0}))}async function Hc(t,e,n,r,s,i,o,a){a===void 0&&(a={});let l,u,c,h=m=>{let v,p=new Promise((g,y)=>v=y);return c=()=>v(),e.signal.addEventListener("abort",c),Promise.race([m({request:e,params:n.params,context:a.requestContext}),p])};try{let m=n.route[t];if(n.route.lazy)if(m){let v,p=await Promise.all([h(m).catch(g=>{v=g}),_k(n.route,i,s)]);if(v)throw v;u=p[0]}else if(await _k(n.route,i,s),m=n.route[t],m)u=await h(m);else if(t==="action"){let v=new URL(e.url),p=v.pathname+v.search;throw Ls(405,{method:e.method,pathname:p,routeId:n.route.id})}else return{type:$n.data,data:void 0};else if(m)u=await h(m);else{let v=new URL(e.url),p=v.pathname+v.search;throw Ls(404,{pathname:p})}xt(u!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(m){l=$n.error,u=m}finally{c&&e.signal.removeEventListener("abort",c)}if(oz(u)){let m=u.status;if(X4.has(m)){let g=u.headers.get("Location");if(xt(g,"Redirects returned/thrown from loaders/actions must have a Location header"),!t$.test(g))g=ex(new URL(e.url),r.slice(0,r.indexOf(n)+1),o,!0,g);else if(!a.isStaticRequest){let y=new URL(e.url),b=g.startsWith("//")?new URL(y.protocol+g):new URL(g),x=Cd(b.pathname,o)!=null;b.origin===y.origin&&x&&(g=b.pathname+b.search+b.hash)}if(a.isStaticRequest)throw u.headers.set("Location",g),u;return{type:$n.redirect,status:m,location:g,revalidate:u.headers.get("X-Remix-Revalidate")!==null,reloadDocument:u.headers.get("X-Remix-Reload-Document")!==null}}if(a.isRouteRequest)throw{type:l===$n.error?$n.error:$n.data,response:u};let v,p=u.headers.get("Content-Type");return p&&/\bapplication\/json\b/.test(p)?v=await u.json():v=await u.text(),l===$n.error?{type:l,error:new Kb(m,u.statusText,v),headers:u.headers}:{type:$n.data,data:v,statusCode:u.status,headers:u.headers}}if(l===$n.error)return{type:l,error:u};if(iz(u)){var d,f;return{type:$n.deferred,deferredData:u,statusCode:(d=u.init)==null?void 0:d.status,headers:((f=u.init)==null?void 0:f.headers)&&new Headers(u.init.headers)}}return{type:$n.data,data:u}}function qc(t,e,n,r){let s=t.createURL(s$(e)).toString(),i={signal:n};if(r&&ui(r.formMethod)){let{formMethod:o,formEncType:a}=r;i.method=o.toUpperCase(),a==="application/json"?(i.headers=new Headers({"Content-Type":a}),i.body=JSON.stringify(r.json)):a==="text/plain"?i.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?i.body=tx(r.formData):i.body=r.formData}return new Request(s,i)}function tx(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function Nk(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function rz(t,e,n,r,s){let i={},o=null,a,l=!1,u={};return n.forEach((c,h)=>{let d=e[h].route.id;if(xt(!Lu(c),"Cannot handle redirect results in processLoaderData"),_h(c)){let f=Th(t,d),m=c.error;r&&(m=Object.values(r)[0],r=void 0),o=o||{},o[f.route.id]==null&&(o[f.route.id]=m),i[d]=void 0,l||(l=!0,a=JN(c.error)?c.error.status:500),c.headers&&(u[d]=c.headers)}else Qa(c)?(s.set(d,c.deferredData),i[d]=c.deferredData.data):i[d]=c.data,c.statusCode!=null&&c.statusCode!==200&&!l&&(a=c.statusCode),c.headers&&(u[d]=c.headers)}),r&&(o=r,i[Object.keys(r)[0]]=void 0),{loaderData:i,errors:o,statusCode:a||200,loaderHeaders:u}}function $k(t,e,n,r,s,i,o,a){let{loaderData:l,errors:u}=rz(e,n,r,s,a);for(let c=0;c<i.length;c++){let{key:h,match:d,controller:f}=i[c];xt(o!==void 0&&o[c]!==void 0,"Did not find corresponding fetcher result");let m=o[c];if(!(f&&f.signal.aborted))if(_h(m)){let v=Th(t.matches,d==null?void 0:d.route.id);u&&u[v.route.id]||(u=vn({},u,{[v.route.id]:m.error})),t.fetchers.delete(h)}else if(Lu(m))xt(!1,"Unhandled fetcher revalidation redirect");else if(Qa(m))xt(!1,"Unhandled fetcher deferred data");else{let v=zo(m.data);t.fetchers.set(h,v)}}return{loaderData:l,errors:u}}function Dk(t,e,n,r){let s=vn({},e);for(let i of n){let o=i.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(s[o]=e[o]):t[o]!==void 0&&i.route.loader&&(s[o]=t[o]),r&&r.hasOwnProperty(o))break}return s}function Th(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function Ak(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Ls(t,e){let{pathname:n,routeId:r,method:s,type:i}=e===void 0?{}:e,o="Unknown Server Error",a="Unknown @remix-run/router error";return t===400?(o="Bad Request",s&&n&&r?a="You made a "+s+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":i==="defer-action"?a="defer() is not supported in actions":i==="invalid-body"&&(a="Unable to encode submission body")):t===403?(o="Forbidden",a='Route "'+r+'" does not match URL "'+n+'"'):t===404?(o="Not Found",a='No route matches URL "'+n+'"'):t===405&&(o="Method Not Allowed",s&&n&&r?a="You made a "+s.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":s&&(a='Invalid request method "'+s.toUpperCase()+'"')),new Kb(t||500,o,new Error(a),!0)}function Rk(t){for(let e=t.length-1;e>=0;e--){let n=t[e];if(Lu(n))return{result:n,idx:e}}}function s$(t){let e=typeof t=="string"?_o(t):t;return wd(vn({},e,{hash:""}))}function sz(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function Qa(t){return t.type===$n.deferred}function _h(t){return t.type===$n.error}function Lu(t){return(t&&t.type)===$n.redirect}function iz(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function oz(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function az(t){return K4.has(t.toLowerCase())}function ui(t){return H4.has(t.toLowerCase())}async function Ok(t,e,n,r,s,i){for(let o=0;o<n.length;o++){let a=n[o],l=e[o];if(!l)continue;let u=t.find(h=>h.route.id===l.route.id),c=u!=null&&!r$(u,l)&&(i&&i[l.route.id])!==void 0;if(Qa(a)&&(s||c)){let h=r[o];xt(h,"Expected an AbortSignal for revalidating fetcher deferred result"),await i$(a,h,s).then(d=>{d&&(n[o]=d||n[o])})}}}async function i$(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:$n.data,data:t.deferredData.unwrappedData}}catch(s){return{type:$n.error,error:s}}return{type:$n.data,data:t.deferredData.data}}}function Xb(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function nx(t,e){let n=typeof e=="string"?_o(e).search:e.search;if(t[t.length-1].route.index&&Xb(n||""))return t[t.length-1];let r=qb(t);return r[r.length-1]}function Fk(t){let{formMethod:e,formAction:n,formEncType:r,text:s,formData:i,json:o}=t;if(!(!e||!n||!r)){if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:i,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function Sy(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function lz(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Kc(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function uz(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function zo(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function cz(t,e){try{let n=t.sessionStorage.getItem(n$);if(n){let r=JSON.parse(n);for(let[s,i]of Object.entries(r||{}))i&&Array.isArray(i)&&e.set(s,new Set(i||[]))}}catch{}}function hz(t,e){if(e.size>0){let n={};for(let[r,s]of e)n[r]=[...s];try{t.sessionStorage.setItem(n$,JSON.stringify(n))}catch(r){dl(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.18.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rm(){return Rm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Rm.apply(this,arguments)}const Lg=Ce.createContext(null),o$=Ce.createContext(null),Pg=Ce.createContext(null),Mg=Ce.createContext(null),fc=Ce.createContext({outlet:null,matches:[],isDataRoute:!1}),a$=Ce.createContext(null);function Bg(){return Ce.useContext(Mg)!=null}function Yb(){return Bg()||xt(!1),Ce.useContext(Mg).location}function l$(t){Ce.useContext(Pg).static||Ce.useLayoutEffect(t)}function u$(){let{isDataRoute:t}=Ce.useContext(fc);return t?Sz():dz()}function dz(){Bg()||xt(!1);let t=Ce.useContext(Lg),{basename:e,navigator:n}=Ce.useContext(Pg),{matches:r}=Ce.useContext(fc),{pathname:s}=Yb(),i=JSON.stringify(qb(r).map(l=>l.pathnameBase)),o=Ce.useRef(!1);return l$(()=>{o.current=!0}),Ce.useCallback(function(l,u){if(u===void 0&&(u={}),!o.current)return;if(typeof l=="number"){n.go(l);return}let c=QN(l,JSON.parse(i),s,u.relative==="path");t==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:aa([e,c.pathname])),(u.replace?n.replace:n.push)(c,u.state,u)},[e,n,i,s,t])}function fz(t,e,n){Bg()||xt(!1);let{navigator:r}=Ce.useContext(Pg),{matches:s}=Ce.useContext(fc),i=s[s.length-1],o=i?i.params:{};i&&i.pathname;let a=i?i.pathnameBase:"/";i&&i.route;let l=Yb(),u;if(e){var c;let v=typeof e=="string"?_o(e):e;a==="/"||(c=v.pathname)!=null&&c.startsWith(a)||xt(!1),u=v}else u=l;let h=u.pathname||"/",d=a==="/"?h:h.slice(a.length)||"/",f=Iu(t,{pathname:d}),m=yz(f&&f.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:aa([a,r.encodeLocation?r.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?a:aa([a,r.encodeLocation?r.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),s,n);return e&&m?Ce.createElement(Mg.Provider,{value:{location:Rm({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Nn.Pop}},m):m}function pz(){let t=Cz(),e=JN(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return Ce.createElement(Ce.Fragment,null,Ce.createElement("h2",null,"Unexpected Application Error!"),Ce.createElement("h3",{style:{fontStyle:"italic"}},e),n?Ce.createElement("pre",{style:s},n):null,i)}const mz=Ce.createElement(pz,null);class gz extends Ce.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?Ce.createElement(fc.Provider,{value:this.props.routeContext},Ce.createElement(a$.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function vz(t){let{routeContext:e,match:n,children:r}=t,s=Ce.useContext(Lg);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),Ce.createElement(fc.Provider,{value:e},r)}function yz(t,e,n){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let i=t,o=(r=n)==null?void 0:r.errors;if(o!=null){let a=i.findIndex(l=>l.route.id&&(o==null?void 0:o[l.route.id]));a>=0||xt(!1),i=i.slice(0,Math.min(i.length,a+1))}return i.reduceRight((a,l,u)=>{let c=l.route.id?o==null?void 0:o[l.route.id]:null,h=null;n&&(h=l.route.errorElement||mz);let d=e.concat(i.slice(0,u+1)),f=()=>{let m;return c?m=h:l.route.Component?m=Ce.createElement(l.route.Component,null):l.route.element?m=l.route.element:m=a,Ce.createElement(vz,{match:l,routeContext:{outlet:a,matches:d,isDataRoute:n!=null},children:m})};return n&&(l.route.ErrorBoundary||l.route.errorElement||u===0)?Ce.createElement(gz,{location:n.location,revalidation:n.revalidation,component:h,error:c,children:f(),routeContext:{outlet:null,matches:d,isDataRoute:!0}}):f()},null)}var c$=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(c$||{}),Om=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Om||{});function xz(t){let e=Ce.useContext(Lg);return e||xt(!1),e}function bz(t){let e=Ce.useContext(o$);return e||xt(!1),e}function wz(t){let e=Ce.useContext(fc);return e||xt(!1),e}function h$(t){let e=wz(),n=e.matches[e.matches.length-1];return n.route.id||xt(!1),n.route.id}function Cz(){var t;let e=Ce.useContext(a$),n=bz(Om.UseRouteError),r=h$(Om.UseRouteError);return e||((t=n.errors)==null?void 0:t[r])}function Sz(){let{router:t}=xz(c$.UseNavigateStable),e=h$(Om.UseNavigateStable),n=Ce.useRef(!1);return l$(()=>{n.current=!0}),Ce.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Rm({fromRouteId:e},i)))},[t,e])}function kz(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Nn.Pop,navigator:i,static:o=!1}=t;Bg()&&xt(!1);let a=e.replace(/^\/*/,"/"),l=Ce.useMemo(()=>({basename:a,navigator:i,static:o}),[a,i,o]);typeof r=="string"&&(r=_o(r));let{pathname:u="/",search:c="",hash:h="",state:d=null,key:f="default"}=r,m=Ce.useMemo(()=>{let v=Cd(u,a);return v==null?null:{location:{pathname:v,search:c,hash:h,state:d,key:f},navigationType:s}},[a,u,c,h,d,f,s]);return m==null?null:Ce.createElement(Pg.Provider,{value:l},Ce.createElement(Mg.Provider,{children:n,value:m}))}new Promise(()=>{});function Ez(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:Ce.createElement(t.Component),Component:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:Ce.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.18.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fm(){return Fm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Fm.apply(this,arguments)}function Iz(t,e){return J4({basename:e==null?void 0:e.basename,future:Fm({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:w4({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||Tz(),routes:t,mapRouteProperties:Ez,window:e==null?void 0:e.window}).initialize()}function Tz(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=Fm({},e,{errors:_z(e.errors)})),e}function _z(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,s]of e)if(s&&s.__type==="RouteErrorResponse")n[r]=new Kb(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let o=new i(s.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let i=new Error(s.message);i.stack="",n[r]=i}}else n[r]=s;return n}const Nz=Ce.createContext({isTransitioning:!1}),$z=Ce.createContext(new Map),Dz="startTransition",Lk=ZP[Dz];function Az(t){Lk?Lk(t):t()}class Rz{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function Oz(t){let{fallbackElement:e,router:n,future:r}=t,[s,i]=Ce.useState(n.state),[o,a]=Ce.useState(),[l,u]=Ce.useState({isTransitioning:!1}),[c,h]=Ce.useState(),[d,f]=Ce.useState(),[m,v]=Ce.useState(),p=Ce.useRef(new Map),{v7_startTransition:g}=r||{},y=Ce.useCallback(S=>{g?Az(S):S()},[g]),b=Ce.useCallback((S,E)=>{let{deletedFetchers:T,unstable_viewTransitionOpts:_}=E;T.forEach(A=>p.current.delete(A)),S.fetchers.forEach((A,L)=>{A.data!==void 0&&p.current.set(L,A.data)}),!_||n.window==null||typeof n.window.document.startViewTransition!="function"?y(()=>i(S)):d&&c?(c.resolve(),d.skipTransition(),v({state:S,currentLocation:_.currentLocation,nextLocation:_.nextLocation})):(a(S),u({isTransitioning:!0,currentLocation:_.currentLocation,nextLocation:_.nextLocation}))},[n.window,d,c,p,y]);Ce.useLayoutEffect(()=>n.subscribe(b),[n,b]),Ce.useEffect(()=>{l.isTransitioning&&h(new Rz)},[l.isTransitioning]),Ce.useEffect(()=>{if(c&&o&&n.window){let S=o,E=c.promise,T=n.window.document.startViewTransition(async()=>{y(()=>i(S)),await E});T.finished.finally(()=>{h(void 0),f(void 0),a(void 0),u({isTransitioning:!1})}),f(T)}},[y,o,c,n.window]),Ce.useEffect(()=>{c&&o&&s.location.key===o.location.key&&c.resolve()},[c,d,s.location,o]),Ce.useEffect(()=>{!l.isTransitioning&&m&&(a(m.state),u({isTransitioning:!0,currentLocation:m.currentLocation,nextLocation:m.nextLocation}),v(void 0))},[l.isTransitioning,m]);let x=Ce.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:S=>n.navigate(S),push:(S,E,T)=>n.navigate(S,{state:E,preventScrollReset:T==null?void 0:T.preventScrollReset}),replace:(S,E,T)=>n.navigate(S,{replace:!0,state:E,preventScrollReset:T==null?void 0:T.preventScrollReset})}),[n]),w=n.basename||"/",C=Ce.useMemo(()=>({router:n,navigator:x,static:!1,basename:w}),[n,x,w]);return Ce.createElement(Ce.Fragment,null,Ce.createElement(Lg.Provider,{value:C},Ce.createElement(o$.Provider,{value:s},Ce.createElement($z.Provider,{value:p.current},Ce.createElement(Nz.Provider,{value:l},Ce.createElement(kz,{basename:w,location:s.location,navigationType:s.historyAction,navigator:x},s.initialized?Ce.createElement(Fz,{routes:n.routes,state:s}):e))))),null)}function Fz(t){let{routes:e,state:n}=t;return fz(e,void 0,n)}var Pk;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Pk||(Pk={}));var Mk;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Mk||(Mk={}));const Lz=()=>{const t=u$(),e=[{id:1,title:"Alice's Adventures in Wonderland",author:"Lewis Carroll",cover:"e-books/alice.jpg",url:"e-books/alice.epub"},{id:2,title:"Grimms' Fairy Tales",author:"Jacob Grimm and Wilhelm Grimm",cover:"e-books/grimms.png",url:"e-books/grimms.epub"},{id:3,title:"The Happy Prince and Other Tales",author:"Oscar Wilde",cover:"e-books/happy_prince.jpg",url:"e-books/happy_prince.epub"},{id:4,title:"The Jungle Book",author:"Rudyard Kipling",cover:"e-books/jungle_book.jpg",url:"e-books/jungle_book.epub"}],n=(s,i)=>{if(i.length>0){const[o,a]=i[0];if(a.type!=="application/epub+zip")return alert("Unsupported type. Please upload an epub file.");console.log(a),console.log(o),t("/Emo-chan/App",{state:{book:o.target.result}})}},r=s=>{t("/Emo-chan/App",{state:{book:s}})};return lt.jsxs("div",{className:"home-page",children:[lt.jsx("div",{className:"navbar-header",children:lt.jsxs("div",{className:"logo",children:[" ",lt.jsx("span",{role:"img","aria-label":"Emo-chan",className:"default-text",children:"(•ᴗ•❁)Emo-chan"}),lt.jsx("span",{role:"img","aria-label":"Emo-chan",className:"hover-text",children:"(˃̵ᴗ˂̵❁)Emo-chan"})]})}),lt.jsxs("div",{className:"home-page-header",children:[lt.jsx("p",{style:{fontSize:"3rem",marginBottom:"10px"},children:"Transform your reading experience"}),lt.jsx("p",{style:{fontSize:"1.5rem",margin:"10px 0",fontWeight:"350"},children:"Emo-chan analyzes your E-book texts and recommends an emotionally relevant Spotify music based on the current chapter"}),lt.jsx("p",{style:{fontSize:"1.25rem",fontWeight:"350"},children:"Immerse yourself in a noise-free, emotion-enhanced literary journey"}),lt.jsx("p",{style:{fontSize:"1.25rem",fontWeight:"350"}})]}),lt.jsxs("div",{className:"upload",children:[lt.jsx("div",{className:"upload-header-title",children:"Have your own E-book?"}),lt.jsx("br",{}),lt.jsx(b4,{as:"buffer",onChange:n,children:lt.jsx("button",{className:"upload-button",children:"Upload E-book"})})]}),lt.jsxs("div",{className:"books",children:[lt.jsx("div",{className:"books-header",children:lt.jsx("div",{className:"books-header-title",children:"Choose a book"})}),lt.jsx("div",{className:"book-list",children:e.map(s=>lt.jsxs("div",{className:"book cover",onClick:()=>r(s.url),children:[lt.jsx("img",{src:`${s.cover}`,alt:s.title}),lt.jsxs("div",{className:"book-details",children:[lt.jsx("h3",{children:s.title}),lt.jsx("p",{children:s.author})]})]},s.id))})]}),lt.jsx("footer",{className:"copyright",children:"© 2023 CSRPITOY. All Rights Reserved."})]})};var ky={},zg={},d$={exports:{}},Pz="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Mz=Pz,Bz=Mz;function f$(){}function p$(){}p$.resetWarningCache=f$;var zz=function(){function t(r,s,i,o,a,l){if(l!==Bz){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:p$,resetWarningCache:f$};return n.PropTypes=n,n};d$.exports=zz();var m$=d$.exports,g$={},Sd={},rx={exports:{}},v$={exports:{}},Uz=void 0,y$=function(t){return t!==Uz&&t!==null},Vz=y$,Wz={object:!0,function:!0,undefined:!0},Gz=function(t){return Vz(t)?hasOwnProperty.call(Wz,typeof t):!1},jz=Gz,Hz=function(t){if(!jz(t))return!1;try{return t.constructor?t.constructor.prototype===t:!1}catch{return!1}},qz=Hz,Kz=function(t){if(typeof t!="function"||!hasOwnProperty.call(t,"length"))return!1;try{if(typeof t.length!="number"||typeof t.call!="function"||typeof t.apply!="function")return!1}catch{return!1}return!qz(t)},Xz=Kz,Yz=/^\s*class[\s{/}]/,Zz=Function.prototype.toString,Qz=function(t){return!(!Xz(t)||Yz.test(Zz.call(t)))},Jz=function(){var t=Object.assign,e;return typeof t!="function"?!1:(e={foo:"raz"},t(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")},Ey,Bk;function eU(){return Bk||(Bk=1,Ey=function(){try{return Object.keys("primitive"),!0}catch{return!1}}),Ey}var tU=function(){},nU=tU(),Zb=function(t){return t!==nU&&t!==null},Iy,zk;function rU(){if(zk)return Iy;zk=1;var t=Zb,e=Object.keys;return Iy=function(n){return e(t(n)?Object(n):n)},Iy}var Ty,Uk;function sU(){return Uk||(Uk=1,Ty=eU()()?Object.keys:rU()),Ty}var _y,Vk;function iU(){if(Vk)return _y;Vk=1;var t=Zb;return _y=function(e){if(!t(e))throw new TypeError("Cannot use null or undefined");return e},_y}var Ny,Wk;function oU(){if(Wk)return Ny;Wk=1;var t=sU(),e=iU(),n=Math.max;return Ny=function(r,s){var i,o,a=n(arguments.length,2),l;for(r=Object(e(r)),l=function(u){try{r[u]=s[u]}catch(c){i||(i=c)}},o=1;o<a;++o)s=arguments[o],t(s).forEach(l);if(i!==void 0)throw i;return r},Ny}var aU=Jz()?Object.assign:oU(),lU=Zb,uU=Array.prototype.forEach,cU=Object.create,hU=function(t,e){var n;for(n in t)e[n]=t[n]},dU=function(t){var e=cU(null);return uU.call(arguments,function(n){lU(n)&&hU(Object(n),e)}),e},$y="razdwatrzy",fU=function(){return typeof $y.contains!="function"?!1:$y.contains("dwa")===!0&&$y.contains("foo")===!1},Dy,Gk;function pU(){if(Gk)return Dy;Gk=1;var t=String.prototype.indexOf;return Dy=function(e){return t.call(this,e,arguments[1])>-1},Dy}var mU=fU()?String.prototype.contains:pU(),rm=y$,jk=Qz,x$=aU,b$=dU,Nh=mU,gU=v$.exports=function(t,e){var n,r,s,i,o;return arguments.length<2||typeof t!="string"?(i=e,e=t,t=null):i=arguments[2],rm(t)?(n=Nh.call(t,"c"),r=Nh.call(t,"e"),s=Nh.call(t,"w")):(n=s=!0,r=!1),o={value:e,configurable:n,enumerable:r,writable:s},i?x$(b$(i),o):o};gU.gs=function(t,e,n){var r,s,i,o;return typeof t!="string"?(i=n,n=e,e=t,t=null):i=arguments[3],rm(e)?jk(e)?rm(n)?jk(n)||(i=n,n=void 0):n=void 0:(i=e,e=n=void 0):e=void 0,rm(t)?(r=Nh.call(t,"c"),s=Nh.call(t,"e")):(r=!0,s=!1),o={get:e,set:n,configurable:r,enumerable:s},i?x$(b$(i),o):o};var vU=v$.exports,yU=function(t){if(typeof t!="function")throw new TypeError(t+" is not a function");return t};(function(t,e){var n=vU,r=yU,s=Function.prototype.apply,i=Function.prototype.call,o=Object.create,a=Object.defineProperty,l=Object.defineProperties,u=Object.prototype.hasOwnProperty,c={configurable:!0,enumerable:!1,writable:!0},h,d,f,m,v,p,g;h=function(y,b){var x;return r(b),u.call(this,"__ee__")?x=this.__ee__:(x=c.value=o(null),a(this,"__ee__",c),c.value=null),x[y]?typeof x[y]=="object"?x[y].push(b):x[y]=[x[y],b]:x[y]=b,this},d=function(y,b){var x,w;return r(b),w=this,h.call(this,y,x=function(){f.call(w,y,x),s.call(b,this,arguments)}),x.__eeOnceListener__=b,this},f=function(y,b){var x,w,C,S;if(r(b),!u.call(this,"__ee__"))return this;if(x=this.__ee__,!x[y])return this;if(w=x[y],typeof w=="object")for(S=0;C=w[S];++S)(C===b||C.__eeOnceListener__===b)&&(w.length===2?x[y]=w[S?0:1]:w.splice(S,1));else(w===b||w.__eeOnceListener__===b)&&delete x[y];return this},m=function(y){var b,x,w,C,S;if(u.call(this,"__ee__")&&(C=this.__ee__[y],!!C))if(typeof C=="object"){for(x=arguments.length,S=new Array(x-1),b=1;b<x;++b)S[b-1]=arguments[b];for(C=C.slice(),b=0;w=C[b];++b)s.call(w,this,S)}else switch(arguments.length){case 1:i.call(C,this);break;case 2:i.call(C,this,arguments[1]);break;case 3:i.call(C,this,arguments[1],arguments[2]);break;default:for(x=arguments.length,S=new Array(x-1),b=1;b<x;++b)S[b-1]=arguments[b];s.call(C,this,S)}},v={on:h,once:d,off:f,emit:m},p={on:n(h),once:n(d),off:n(f),emit:n(m)},g=l({},p),t.exports=e=function(y){return y==null?o(g):l(Object(y),p)},e.methods=v})(rx,rx.exports);var to=rx.exports,je={},kd={},No={},Ea={};function xU(t,e,n){if(n===void 0&&(n=Array.prototype),t&&typeof n.find=="function")return n.find.call(t,e);for(var r=0;r<t.length;r++)if(Object.prototype.hasOwnProperty.call(t,r)){var s=t[r];if(e.call(void 0,s,r,t))return s}}function Qb(t,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(t):t}var w$=Qb({HTML:"text/html",isHTML:function(t){return t===w$.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),C$=Qb({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(t){return t===C$.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});Ea.find=xU;Ea.freeze=Qb;Ea.MIME_TYPE=w$;Ea.NAMESPACE=C$;var S$=Ea,Gi=S$.find,Jh=S$.NAMESPACE;function bU(t){return t!==""}function wU(t){return t?t.split(/[\t\n\f\r ]+/).filter(bU):[]}function CU(t,e){return t.hasOwnProperty(e)||(t[e]=!0),t}function Hk(t){if(!t)return[];var e=wU(t);return Object.keys(e.reduce(CU,{}))}function SU(t){return function(e){return t&&t.indexOf(e)!==-1}}function Ed(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}function ls(t,e){var n=t.prototype;if(!(n instanceof e)){let s=function(){};var r=s;s.prototype=e.prototype,s=new s,Ed(n,s),t.prototype=n=s}n.constructor!=t&&(typeof t!="function"&&console.error("unknown Class:"+t),n.constructor=t)}var us={},gi=us.ELEMENT_NODE=1,Xu=us.ATTRIBUTE_NODE=2,Lm=us.TEXT_NODE=3,k$=us.CDATA_SECTION_NODE=4,E$=us.ENTITY_REFERENCE_NODE=5,kU=us.ENTITY_NODE=6,I$=us.PROCESSING_INSTRUCTION_NODE=7,T$=us.COMMENT_NODE=8,_$=us.DOCUMENT_NODE=9,N$=us.DOCUMENT_TYPE_NODE=10,wo=us.DOCUMENT_FRAGMENT_NODE=11,EU=us.NOTATION_NODE=12,Dr={},lr={};Dr.INDEX_SIZE_ERR=(lr[1]="Index size error",1);Dr.DOMSTRING_SIZE_ERR=(lr[2]="DOMString size error",2);var Yr=Dr.HIERARCHY_REQUEST_ERR=(lr[3]="Hierarchy request error",3);Dr.WRONG_DOCUMENT_ERR=(lr[4]="Wrong document",4);Dr.INVALID_CHARACTER_ERR=(lr[5]="Invalid character",5);Dr.NO_DATA_ALLOWED_ERR=(lr[6]="No data allowed",6);Dr.NO_MODIFICATION_ALLOWED_ERR=(lr[7]="No modification allowed",7);var $$=Dr.NOT_FOUND_ERR=(lr[8]="Not found",8);Dr.NOT_SUPPORTED_ERR=(lr[9]="Not supported",9);var qk=Dr.INUSE_ATTRIBUTE_ERR=(lr[10]="Attribute in use",10);Dr.INVALID_STATE_ERR=(lr[11]="Invalid state",11);Dr.SYNTAX_ERR=(lr[12]="Syntax error",12);Dr.INVALID_MODIFICATION_ERR=(lr[13]="Invalid modification",13);Dr.NAMESPACE_ERR=(lr[14]="Invalid namespace",14);Dr.INVALID_ACCESS_ERR=(lr[15]="Invalid access",15);function An(t,e){if(e instanceof Error)var n=e;else n=this,Error.call(this,lr[t]),this.message=lr[t],Error.captureStackTrace&&Error.captureStackTrace(this,An);return n.code=t,e&&(this.message=this.message+": "+e),n}An.prototype=Error.prototype;Ed(Dr,An);function go(){}go.prototype={length:0,item:function(t){return t>=0&&t<this.length?this[t]:null},toString:function(t,e){for(var n=[],r=0;r<this.length;r++)Tu(this[r],n,t,e);return n.join("")},filter:function(t){return Array.prototype.filter.call(this,t)},indexOf:function(t){return Array.prototype.indexOf.call(this,t)}};function Yu(t,e){this._node=t,this._refresh=e,Jb(this)}function Jb(t){var e=t._node._inc||t._node.ownerDocument._inc;if(t._inc!==e){var n=t._refresh(t._node);if(V$(t,"length",n.length),!t.$$length||n.length<t.$$length)for(var r=n.length;r in t;r++)Object.prototype.hasOwnProperty.call(t,r)&&delete t[r];Ed(n,t),t._inc=e}}Yu.prototype.item=function(t){return Jb(this),this[t]||null};ls(Yu,go);function Pm(){}function D$(t,e){for(var n=t.length;n--;)if(t[n]===e)return n}function Kk(t,e,n,r){if(r?e[D$(e,r)]=n:e[e.length++]=n,t){n.ownerElement=t;var s=t.ownerDocument;s&&(r&&O$(s,t,r),IU(s,t,n))}}function Xk(t,e,n){var r=D$(e,n);if(r>=0){for(var s=e.length-1;r<s;)e[r]=e[++r];if(e.length=s,t){var i=t.ownerDocument;i&&(O$(i,t,n),n.ownerElement=null)}}else throw new An($$,new Error(t.tagName+"@"+n))}Pm.prototype={length:0,item:go.prototype.item,getNamedItem:function(t){for(var e=this.length;e--;){var n=this[e];if(n.nodeName==t)return n}},setNamedItem:function(t){var e=t.ownerElement;if(e&&e!=this._ownerElement)throw new An(qk);var n=this.getNamedItem(t.nodeName);return Kk(this._ownerElement,this,t,n),n},setNamedItemNS:function(t){var e=t.ownerElement,n;if(e&&e!=this._ownerElement)throw new An(qk);return n=this.getNamedItemNS(t.namespaceURI,t.localName),Kk(this._ownerElement,this,t,n),n},removeNamedItem:function(t){var e=this.getNamedItem(t);return Xk(this._ownerElement,this,e),e},removeNamedItemNS:function(t,e){var n=this.getNamedItemNS(t,e);return Xk(this._ownerElement,this,n),n},getNamedItemNS:function(t,e){for(var n=this.length;n--;){var r=this[n];if(r.localName==e&&r.namespaceURI==t)return r}return null}};function A$(){}A$.prototype={hasFeature:function(t,e){return!0},createDocument:function(t,e,n){var r=new Id;if(r.implementation=this,r.childNodes=new go,r.doctype=n||null,n&&r.appendChild(n),e){var s=r.createElementNS(t,e);r.appendChild(s)}return r},createDocumentType:function(t,e,n){var r=new Ug;return r.name=t,r.nodeName=t,r.publicId=e||"",r.systemId=n||"",r}};function zt(){}zt.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(t,e){return Mm(this,t,e)},replaceChild:function(t,e){Mm(this,t,e,L$),e&&this.removeChild(e)},removeChild:function(t){return F$(this,t)},appendChild:function(t){return this.insertBefore(t,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(t){return sx(this.ownerDocument||this,this,t)},normalize:function(){for(var t=this.firstChild;t;){var e=t.nextSibling;e&&e.nodeType==Lm&&t.nodeType==Lm?(this.removeChild(e),t.appendData(e.data)):(t.normalize(),t=e)}},isSupported:function(t,e){return this.ownerDocument.implementation.hasFeature(t,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(t){for(var e=this;e;){var n=e._nsMap;if(n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)&&n[r]===t)return r}e=e.nodeType==Xu?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(t){for(var e=this;e;){var n=e._nsMap;if(n&&t in n&&Object.prototype.hasOwnProperty.call(n,t))return n[t];e=e.nodeType==Xu?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(t){var e=this.lookupPrefix(t);return e==null}};function R$(t){return t=="<"&&"&lt;"||t==">"&&"&gt;"||t=="&"&&"&amp;"||t=='"'&&"&quot;"||"&#"+t.charCodeAt()+";"}Ed(us,zt);Ed(us,zt.prototype);function ed(t,e){if(e(t))return!0;if(t=t.firstChild)do if(ed(t,e))return!0;while(t=t.nextSibling)}function Id(){this.ownerDocument=this}function IU(t,e,n){t&&t._inc++;var r=n.namespaceURI;r===Jh.XMLNS&&(e._nsMap[n.prefix?n.localName:""]=n.value)}function O$(t,e,n,r){t&&t._inc++;var s=n.namespaceURI;s===Jh.XMLNS&&delete e._nsMap[n.prefix?n.localName:""]}function ew(t,e,n){if(t&&t._inc){t._inc++;var r=e.childNodes;if(n)r[r.length++]=n;else{for(var s=e.firstChild,i=0;s;)r[i++]=s,s=s.nextSibling;r.length=i,delete r[r.length]}}}function F$(t,e){var n=e.previousSibling,r=e.nextSibling;return n?n.nextSibling=r:t.firstChild=r,r?r.previousSibling=n:t.lastChild=n,e.parentNode=null,e.previousSibling=null,e.nextSibling=null,ew(t.ownerDocument,t),e}function TU(t){return t&&(t.nodeType===zt.DOCUMENT_NODE||t.nodeType===zt.DOCUMENT_FRAGMENT_NODE||t.nodeType===zt.ELEMENT_NODE)}function _U(t){return t&&(ji(t)||tw(t)||Co(t)||t.nodeType===zt.DOCUMENT_FRAGMENT_NODE||t.nodeType===zt.COMMENT_NODE||t.nodeType===zt.PROCESSING_INSTRUCTION_NODE)}function Co(t){return t&&t.nodeType===zt.DOCUMENT_TYPE_NODE}function ji(t){return t&&t.nodeType===zt.ELEMENT_NODE}function tw(t){return t&&t.nodeType===zt.TEXT_NODE}function Yk(t,e){var n=t.childNodes||[];if(Gi(n,ji)||Co(e))return!1;var r=Gi(n,Co);return!(e&&r&&n.indexOf(r)>n.indexOf(e))}function Zk(t,e){var n=t.childNodes||[];function r(i){return ji(i)&&i!==e}if(Gi(n,r))return!1;var s=Gi(n,Co);return!(e&&s&&n.indexOf(s)>n.indexOf(e))}function NU(t,e,n){if(!TU(t))throw new An(Yr,"Unexpected parent node type "+t.nodeType);if(n&&n.parentNode!==t)throw new An($$,"child not in parent");if(!_U(e)||Co(e)&&t.nodeType!==zt.DOCUMENT_NODE)throw new An(Yr,"Unexpected node type "+e.nodeType+" for parent node type "+t.nodeType)}function $U(t,e,n){var r=t.childNodes||[],s=e.childNodes||[];if(e.nodeType===zt.DOCUMENT_FRAGMENT_NODE){var i=s.filter(ji);if(i.length>1||Gi(s,tw))throw new An(Yr,"More than one element or text in fragment");if(i.length===1&&!Yk(t,n))throw new An(Yr,"Element in fragment can not be inserted before doctype")}if(ji(e)&&!Yk(t,n))throw new An(Yr,"Only one element can be added and only after doctype");if(Co(e)){if(Gi(r,Co))throw new An(Yr,"Only one doctype is allowed");var o=Gi(r,ji);if(n&&r.indexOf(o)<r.indexOf(n))throw new An(Yr,"Doctype can only be inserted before an element");if(!n&&o)throw new An(Yr,"Doctype can not be appended since element is present")}}function L$(t,e,n){var r=t.childNodes||[],s=e.childNodes||[];if(e.nodeType===zt.DOCUMENT_FRAGMENT_NODE){var i=s.filter(ji);if(i.length>1||Gi(s,tw))throw new An(Yr,"More than one element or text in fragment");if(i.length===1&&!Zk(t,n))throw new An(Yr,"Element in fragment can not be inserted before doctype")}if(ji(e)&&!Zk(t,n))throw new An(Yr,"Only one element can be added and only after doctype");if(Co(e)){let l=function(u){return Co(u)&&u!==n};var a=l;if(Gi(r,l))throw new An(Yr,"Only one doctype is allowed");var o=Gi(r,ji);if(n&&r.indexOf(o)<r.indexOf(n))throw new An(Yr,"Doctype can only be inserted before an element")}}function Mm(t,e,n,r){NU(t,e,n),t.nodeType===zt.DOCUMENT_NODE&&(r||$U)(t,e,n);var s=e.parentNode;if(s&&s.removeChild(e),e.nodeType===wo){var i=e.firstChild;if(i==null)return e;var o=e.lastChild}else i=o=e;var a=n?n.previousSibling:t.lastChild;i.previousSibling=a,o.nextSibling=n,a?a.nextSibling=i:t.firstChild=i,n==null?t.lastChild=o:n.previousSibling=o;do i.parentNode=t;while(i!==o&&(i=i.nextSibling));return ew(t.ownerDocument||t,t),e.nodeType==wo&&(e.firstChild=e.lastChild=null),e}function DU(t,e){return e.parentNode&&e.parentNode.removeChild(e),e.parentNode=t,e.previousSibling=t.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:t.firstChild=e,t.lastChild=e,ew(t.ownerDocument,t,e),e}Id.prototype={nodeName:"#document",nodeType:_$,doctype:null,documentElement:null,_inc:1,insertBefore:function(t,e){if(t.nodeType==wo){for(var n=t.firstChild;n;){var r=n.nextSibling;this.insertBefore(n,e),n=r}return t}return Mm(this,t,e),t.ownerDocument=this,this.documentElement===null&&t.nodeType===gi&&(this.documentElement=t),t},removeChild:function(t){return this.documentElement==t&&(this.documentElement=null),F$(this,t)},replaceChild:function(t,e){Mm(this,t,e,L$),t.ownerDocument=this,e&&this.removeChild(e),ji(t)&&(this.documentElement=t)},importNode:function(t,e){return U$(this,t,e)},getElementById:function(t){var e=null;return ed(this.documentElement,function(n){if(n.nodeType==gi&&n.getAttribute("id")==t)return e=n,!0}),e},getElementsByClassName:function(t){var e=Hk(t);return new Yu(this,function(n){var r=[];return e.length>0&&ed(n.documentElement,function(s){if(s!==n&&s.nodeType===gi){var i=s.getAttribute("class");if(i){var o=t===i;if(!o){var a=Hk(i);o=e.every(SU(a))}o&&r.push(s)}}}),r})},createElement:function(t){var e=new fl;e.ownerDocument=this,e.nodeName=t,e.tagName=t,e.localName=t,e.childNodes=new go;var n=e.attributes=new Pm;return n._ownerElement=e,e},createDocumentFragment:function(){var t=new Vg;return t.ownerDocument=this,t.childNodes=new go,t},createTextNode:function(t){var e=new nw;return e.ownerDocument=this,e.appendData(t),e},createComment:function(t){var e=new rw;return e.ownerDocument=this,e.appendData(t),e},createCDATASection:function(t){var e=new sw;return e.ownerDocument=this,e.appendData(t),e},createProcessingInstruction:function(t,e){var n=new ow;return n.ownerDocument=this,n.tagName=n.nodeName=n.target=t,n.nodeValue=n.data=e,n},createAttribute:function(t){var e=new Bm;return e.ownerDocument=this,e.name=t,e.nodeName=t,e.localName=t,e.specified=!0,e},createEntityReference:function(t){var e=new iw;return e.ownerDocument=this,e.nodeName=t,e},createElementNS:function(t,e){var n=new fl,r=e.split(":"),s=n.attributes=new Pm;return n.childNodes=new go,n.ownerDocument=this,n.nodeName=e,n.tagName=e,n.namespaceURI=t,r.length==2?(n.prefix=r[0],n.localName=r[1]):n.localName=e,s._ownerElement=n,n},createAttributeNS:function(t,e){var n=new Bm,r=e.split(":");return n.ownerDocument=this,n.nodeName=e,n.name=e,n.namespaceURI=t,n.specified=!0,r.length==2?(n.prefix=r[0],n.localName=r[1]):n.localName=e,n}};ls(Id,zt);function fl(){this._nsMap={}}fl.prototype={nodeType:gi,hasAttribute:function(t){return this.getAttributeNode(t)!=null},getAttribute:function(t){var e=this.getAttributeNode(t);return e&&e.value||""},getAttributeNode:function(t){return this.attributes.getNamedItem(t)},setAttribute:function(t,e){var n=this.ownerDocument.createAttribute(t);n.value=n.nodeValue=""+e,this.setAttributeNode(n)},removeAttribute:function(t){var e=this.getAttributeNode(t);e&&this.removeAttributeNode(e)},appendChild:function(t){return t.nodeType===wo?this.insertBefore(t,null):DU(this,t)},setAttributeNode:function(t){return this.attributes.setNamedItem(t)},setAttributeNodeNS:function(t){return this.attributes.setNamedItemNS(t)},removeAttributeNode:function(t){return this.attributes.removeNamedItem(t.nodeName)},removeAttributeNS:function(t,e){var n=this.getAttributeNodeNS(t,e);n&&this.removeAttributeNode(n)},hasAttributeNS:function(t,e){return this.getAttributeNodeNS(t,e)!=null},getAttributeNS:function(t,e){var n=this.getAttributeNodeNS(t,e);return n&&n.value||""},setAttributeNS:function(t,e,n){var r=this.ownerDocument.createAttributeNS(t,e);r.value=r.nodeValue=""+n,this.setAttributeNode(r)},getAttributeNodeNS:function(t,e){return this.attributes.getNamedItemNS(t,e)},getElementsByTagName:function(t){return new Yu(this,function(e){var n=[];return ed(e,function(r){r!==e&&r.nodeType==gi&&(t==="*"||r.tagName==t)&&n.push(r)}),n})},getElementsByTagNameNS:function(t,e){return new Yu(this,function(n){var r=[];return ed(n,function(s){s!==n&&s.nodeType===gi&&(t==="*"||s.namespaceURI===t)&&(e==="*"||s.localName==e)&&r.push(s)}),r})}};Id.prototype.getElementsByTagName=fl.prototype.getElementsByTagName;Id.prototype.getElementsByTagNameNS=fl.prototype.getElementsByTagNameNS;ls(fl,zt);function Bm(){}Bm.prototype.nodeType=Xu;ls(Bm,zt);function Td(){}Td.prototype={data:"",substringData:function(t,e){return this.data.substring(t,t+e)},appendData:function(t){t=this.data+t,this.nodeValue=this.data=t,this.length=t.length},insertData:function(t,e){this.replaceData(t,0,e)},appendChild:function(t){throw new Error(lr[Yr])},deleteData:function(t,e){this.replaceData(t,e,"")},replaceData:function(t,e,n){var r=this.data.substring(0,t),s=this.data.substring(t+e);n=r+n+s,this.nodeValue=this.data=n,this.length=n.length}};ls(Td,zt);function nw(){}nw.prototype={nodeName:"#text",nodeType:Lm,splitText:function(t){var e=this.data,n=e.substring(t);e=e.substring(0,t),this.data=this.nodeValue=e,this.length=e.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}};ls(nw,Td);function rw(){}rw.prototype={nodeName:"#comment",nodeType:T$};ls(rw,Td);function sw(){}sw.prototype={nodeName:"#cdata-section",nodeType:k$};ls(sw,Td);function Ug(){}Ug.prototype.nodeType=N$;ls(Ug,zt);function P$(){}P$.prototype.nodeType=EU;ls(P$,zt);function M$(){}M$.prototype.nodeType=kU;ls(M$,zt);function iw(){}iw.prototype.nodeType=E$;ls(iw,zt);function Vg(){}Vg.prototype.nodeName="#document-fragment";Vg.prototype.nodeType=wo;ls(Vg,zt);function ow(){}ow.prototype.nodeType=I$;ls(ow,zt);function B$(){}B$.prototype.serializeToString=function(t,e,n){return z$.call(t,e,n)};zt.prototype.toString=z$;function z$(t,e){var n=[],r=this.nodeType==9&&this.documentElement||this,s=r.prefix,i=r.namespaceURI;if(i&&s==null){var s=r.lookupPrefix(i);if(s==null)var o=[{namespace:i,prefix:null}]}return Tu(this,n,t,e,o),n.join("")}function Qk(t,e,n){var r=t.prefix||"",s=t.namespaceURI;if(!s||r==="xml"&&s===Jh.XML||s===Jh.XMLNS)return!1;for(var i=n.length;i--;){var o=n[i];if(o.prefix===r)return o.namespace!==s}return!0}function Ay(t,e,n){t.push(" ",e,'="',n.replace(/[<&"]/g,R$),'"')}function Tu(t,e,n,r,s){if(s||(s=[]),r)if(t=r(t),t){if(typeof t=="string"){e.push(t);return}}else return;switch(t.nodeType){case gi:var i=t.attributes,o=i.length,g=t.firstChild,a=t.tagName;n=Jh.isHTML(t.namespaceURI)||n;var l=a;if(!n&&!t.prefix&&t.namespaceURI){for(var u,c=0;c<i.length;c++)if(i.item(c).name==="xmlns"){u=i.item(c).value;break}if(!u)for(var h=s.length-1;h>=0;h--){var d=s[h];if(d.prefix===""&&d.namespace===t.namespaceURI){u=d.namespace;break}}if(u!==t.namespaceURI)for(var h=s.length-1;h>=0;h--){var d=s[h];if(d.namespace===t.namespaceURI){d.prefix&&(l=d.prefix+":"+a);break}}}e.push("<",l);for(var f=0;f<o;f++){var m=i.item(f);m.prefix=="xmlns"?s.push({prefix:m.localName,namespace:m.value}):m.nodeName=="xmlns"&&s.push({prefix:"",namespace:m.value})}for(var f=0;f<o;f++){var m=i.item(f);if(Qk(m,n,s)){var v=m.prefix||"",p=m.namespaceURI;Ay(e,v?"xmlns:"+v:"xmlns",p),s.push({prefix:v,namespace:p})}Tu(m,e,n,r,s)}if(a===l&&Qk(t,n,s)){var v=t.prefix||"",p=t.namespaceURI;Ay(e,v?"xmlns:"+v:"xmlns",p),s.push({prefix:v,namespace:p})}if(g||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(a)){if(e.push(">"),n&&/^script$/i.test(a))for(;g;)g.data?e.push(g.data):Tu(g,e,n,r,s.slice()),g=g.nextSibling;else for(;g;)Tu(g,e,n,r,s.slice()),g=g.nextSibling;e.push("</",l,">")}else e.push("/>");return;case _$:case wo:for(var g=t.firstChild;g;)Tu(g,e,n,r,s.slice()),g=g.nextSibling;return;case Xu:return Ay(e,t.name,t.value);case Lm:return e.push(t.data.replace(/[<&]/g,R$).replace(/]]>/g,"]]&gt;"));case k$:return e.push("<![CDATA[",t.data,"]]>");case T$:return e.push("<!--",t.data,"-->");case N$:var y=t.publicId,b=t.systemId;if(e.push("<!DOCTYPE ",t.name),y)e.push(" PUBLIC ",y),b&&b!="."&&e.push(" ",b),e.push(">");else if(b&&b!=".")e.push(" SYSTEM ",b,">");else{var x=t.internalSubset;x&&e.push(" [",x,"]"),e.push(">")}return;case I$:return e.push("<?",t.target," ",t.data,"?>");case E$:return e.push("&",t.nodeName,";");default:e.push("??",t.nodeName)}}function U$(t,e,n){var r;switch(e.nodeType){case gi:r=e.cloneNode(!1),r.ownerDocument=t;case wo:break;case Xu:n=!0;break}if(r||(r=e.cloneNode(!1)),r.ownerDocument=t,r.parentNode=null,n)for(var s=e.firstChild;s;)r.appendChild(U$(t,s,n)),s=s.nextSibling;return r}function sx(t,e,n){var r=new e.constructor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var i=e[s];typeof i!="object"&&i!=r[s]&&(r[s]=i)}switch(e.childNodes&&(r.childNodes=new go),r.ownerDocument=t,r.nodeType){case gi:var o=e.attributes,a=r.attributes=new Pm,l=o.length;a._ownerElement=r;for(var u=0;u<l;u++)r.setAttributeNode(sx(t,o.item(u),!0));break;case Xu:n=!0}if(n)for(var c=e.firstChild;c;)r.appendChild(sx(t,c,n)),c=c.nextSibling;return r}function V$(t,e,n){t[e]=n}try{if(Object.defineProperty){let t=function(e){switch(e.nodeType){case gi:case wo:var n=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&n.push(t(e)),e=e.nextSibling;return n.join("");default:return e.nodeValue}};var L0e=t;Object.defineProperty(Yu.prototype,"length",{get:function(){return Jb(this),this.$$length}}),Object.defineProperty(zt.prototype,"textContent",{get:function(){return t(this)},set:function(e){switch(this.nodeType){case gi:case wo:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),V$=function(e,n,r){e["$$"+n]=r}}}catch{}No.DocumentType=Ug;No.DOMException=An;No.DOMImplementation=A$;No.Element=fl;No.Node=zt;No.NodeList=go;No.XMLSerializer=B$;var _d={},W$={};(function(t){var e=Ea.freeze;t.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=e({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"	",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),t.entityMap=t.HTML_ENTITIES})(W$);var aw={},td=Ea.NAMESPACE,ix=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Jk=new RegExp("[\\-\\.0-9"+ix.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),eE=new RegExp("^"+ix.source+Jk.source+"*(?::"+ix.source+Jk.source+"*)?$"),Xc=0,Fo=1,Jl=2,Yc=3,eu=4,tu=5,Zc=6,Sp=7;function Zu(t,e){this.message=t,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,Zu)}Zu.prototype=new Error;Zu.prototype.name=Zu.name;function G$(){}G$.prototype={parse:function(t,e,n){var r=this.domBuilder;r.startDocument(),j$(e,e={}),AU(t,e,n,r,this.errorHandler),r.endDocument()}};function AU(t,e,n,r,s){function i(M){if(M>65535){M-=65536;var U=55296+(M>>10),D=56320+(M&1023);return String.fromCharCode(U,D)}else return String.fromCharCode(M)}function o(M){var U=M.slice(1,-1);return U in n?n[U]:U.charAt(0)==="#"?i(parseInt(U.substr(1).replace("x","0x"))):(s.error("entity not found:"+M),M)}function a(M){if(M>v){var U=t.substring(v,M).replace(/&#?\w+;/g,o);d&&l(v),r.characters(U,0,M-v),v=M}}function l(M,U){for(;M>=c&&(U=h.exec(t));)u=U.index,c=u+U[0].length,d.lineNumber++;d.columnNumber=M-u+1}for(var u=0,c=0,h=/.*(?:\r\n?|\n)|.*$/g,d=r.locator,f=[{currentNSMap:e}],m={},v=0;;){try{var p=t.indexOf("<",v);if(p<0){if(!t.substr(v).match(/^\s*$/)){var g=r.doc,y=g.createTextNode(t.substr(v));g.appendChild(y),r.currentElement=y}return}switch(p>v&&a(p),t.charAt(p+1)){case"/":var A=t.indexOf(">",p+3),b=t.substring(p+2,A).replace(/[ \t\n\r]+$/g,""),x=f.pop();A<0?(b=t.substring(p+2).replace(/[\s<].*/,""),s.error("end tag name: "+b+" is not complete:"+x.tagName),A=p+1+b.length):b.match(/\s</)&&(b=b.replace(/[\s<].*/,""),s.error("end tag name: "+b+" maybe not complete"),A=p+1+b.length);var w=x.localNSMap,C=x.tagName==b,S=C||x.tagName&&x.tagName.toLowerCase()==b.toLowerCase();if(S){if(r.endElement(x.uri,x.localName,b),w)for(var E in w)Object.prototype.hasOwnProperty.call(w,E)&&r.endPrefixMapping(E);C||s.fatalError("end tag name: "+b+" is not match the current start tagName:"+x.tagName)}else f.push(x);A++;break;case"?":d&&l(p),A=PU(t,p,r);break;case"!":d&&l(p),A=LU(t,p,r,s);break;default:d&&l(p);var T=new H$,_=f[f.length-1].currentNSMap,A=RU(t,p,T,_,o,s),L=T.length;if(!T.closed&&FU(t,A,T.tagName,m)&&(T.closed=!0,n.nbsp||s.warning("unclosed xml attribute")),d&&L){for(var W=tE(d,{}),K=0;K<L;K++){var R=T[K];l(R.offset),R.locator=tE(d,{})}r.locator=W,nE(T,r,_)&&f.push(T),r.locator=d}else nE(T,r,_)&&f.push(T);td.isHTML(T.uri)&&!T.closed?A=OU(t,A,T.tagName,o,r):A++}}catch(M){if(M instanceof Zu)throw M;s.error("element parse error: "+M),A=-1}A>v?v=A:a(Math.max(p,v)+1)}}function tE(t,e){return e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber,e}function RU(t,e,n,r,s,i){function o(d,f,m){n.attributeNames.hasOwnProperty(d)&&i.fatalError("Attribute "+d+" redefined"),n.addValue(d,f,m)}for(var a,l,u=++e,c=Xc;;){var h=t.charAt(u);switch(h){case"=":if(c===Fo)a=t.slice(e,u),c=Yc;else if(c===Jl)c=Yc;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(c===Yc||c===Fo)if(c===Fo&&(i.warning('attribute value must after "="'),a=t.slice(e,u)),e=u+1,u=t.indexOf(h,e),u>0)l=t.slice(e,u).replace(/&#?\w+;/g,s),o(a,l,e-1),c=tu;else throw new Error("attribute value no end '"+h+"' match");else if(c==eu)l=t.slice(e,u).replace(/&#?\w+;/g,s),o(a,l,e),i.warning('attribute "'+a+'" missed start quot('+h+")!!"),e=u+1,c=tu;else throw new Error('attribute value must after "="');break;case"/":switch(c){case Xc:n.setTagName(t.slice(e,u));case tu:case Zc:case Sp:c=Sp,n.closed=!0;case eu:case Fo:break;case Jl:n.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return i.error("unexpected end of input"),c==Xc&&n.setTagName(t.slice(e,u)),u;case">":switch(c){case Xc:n.setTagName(t.slice(e,u));case tu:case Zc:case Sp:break;case eu:case Fo:l=t.slice(e,u),l.slice(-1)==="/"&&(n.closed=!0,l=l.slice(0,-1));case Jl:c===Jl&&(l=a),c==eu?(i.warning('attribute "'+l+'" missed quot(")!'),o(a,l.replace(/&#?\w+;/g,s),e)):((!td.isHTML(r[""])||!l.match(/^(?:disabled|checked|selected)$/i))&&i.warning('attribute "'+l+'" missed value!! "'+l+'" instead!!'),o(l,l,e));break;case Yc:throw new Error("attribute value missed!!")}return u;case"":h=" ";default:if(h<=" ")switch(c){case Xc:n.setTagName(t.slice(e,u)),c=Zc;break;case Fo:a=t.slice(e,u),c=Jl;break;case eu:var l=t.slice(e,u).replace(/&#?\w+;/g,s);i.warning('attribute "'+l+'" missed quot(")!!'),o(a,l,e);case tu:c=Zc;break}else switch(c){case Jl:n.tagName,(!td.isHTML(r[""])||!a.match(/^(?:disabled|checked|selected)$/i))&&i.warning('attribute "'+a+'" missed value!! "'+a+'" instead2!!'),o(a,a,e),e=u,c=Fo;break;case tu:i.warning('attribute space is required"'+a+'"!!');case Zc:c=Fo,e=u;break;case Yc:c=eu,e=u;break;case Sp:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function nE(t,e,n){for(var r=t.tagName,s=null,h=t.length;h--;){var i=t[h],o=i.qName,a=i.value,d=o.indexOf(":");if(d>0)var l=i.prefix=o.slice(0,d),u=o.slice(d+1),c=l==="xmlns"&&u;else u=o,l=null,c=o==="xmlns"&&"";i.localName=u,c!==!1&&(s==null&&(s={},j$(n,n={})),n[c]=s[c]=a,i.uri=td.XMLNS,e.startPrefixMapping(c,a))}for(var h=t.length;h--;){i=t[h];var l=i.prefix;l&&(l==="xml"&&(i.uri=td.XML),l!=="xmlns"&&(i.uri=n[l||""]))}var d=r.indexOf(":");d>0?(l=t.prefix=r.slice(0,d),u=t.localName=r.slice(d+1)):(l=null,u=t.localName=r);var f=t.uri=n[l||""];if(e.startElement(f,u,r,t),t.closed){if(e.endElement(f,u,r),s)for(l in s)Object.prototype.hasOwnProperty.call(s,l)&&e.endPrefixMapping(l)}else return t.currentNSMap=n,t.localNSMap=s,!0}function OU(t,e,n,r,s){if(/^(?:script|textarea)$/i.test(n)){var i=t.indexOf("</"+n+">",e),o=t.substring(e+1,i);if(/[&<]/.test(o))return/^script$/i.test(n)?(s.characters(o,0,o.length),i):(o=o.replace(/&#?\w+;/g,r),s.characters(o,0,o.length),i)}return e+1}function FU(t,e,n,r){var s=r[n];return s==null&&(s=t.lastIndexOf("</"+n+">"),s<e&&(s=t.lastIndexOf("</"+n)),r[n]=s),s<e}function j$(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}function LU(t,e,n,r){var s=t.charAt(e+2);switch(s){case"-":if(t.charAt(e+3)==="-"){var i=t.indexOf("-->",e+4);return i>e?(n.comment(t,e+4,i-e-4),i+3):(r.error("Unclosed comment"),-1)}else return-1;default:if(t.substr(e+3,6)=="CDATA["){var i=t.indexOf("]]>",e+9);return n.startCDATA(),n.characters(t,e+9,i-e-9),n.endCDATA(),i+3}var o=MU(t,e),a=o.length;if(a>1&&/!doctype/i.test(o[0][0])){var l=o[1][0],u=!1,c=!1;a>3&&(/^public$/i.test(o[2][0])?(u=o[3][0],c=a>4&&o[4][0]):/^system$/i.test(o[2][0])&&(c=o[3][0]));var h=o[a-1];return n.startDTD(l,u,c),n.endDTD(),h.index+h[0].length}}return-1}function PU(t,e,n){var r=t.indexOf("?>",e);if(r){var s=t.substring(e,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return s?(s[0].length,n.processingInstruction(s[1],s[2]),r+2):-1}return-1}function H$(){this.attributeNames={}}H$.prototype={setTagName:function(t){if(!eE.test(t))throw new Error("invalid tagName:"+t);this.tagName=t},addValue:function(t,e,n){if(!eE.test(t))throw new Error("invalid attribute:"+t);this.attributeNames[t]=this.length,this[this.length++]={qName:t,value:e,offset:n}},length:0,getLocalName:function(t){return this[t].localName},getLocator:function(t){return this[t].locator},getQName:function(t){return this[t].qName},getURI:function(t){return this[t].uri},getValue:function(t){return this[t].value}};function MU(t,e){var n,r=[],s=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(s.lastIndex=e,s.exec(t);n=s.exec(t);)if(r.push(n),n[1])return r}aw.XMLReader=G$;aw.ParseError=Zu;var BU=Ea,lw=No,rE=W$,q$=aw,zU=lw.DOMImplementation,sE=BU.NAMESPACE,UU=q$.ParseError,VU=q$.XMLReader;function K$(t){this.options=t||{locator:{}}}K$.prototype.parseFromString=function(t,e){var n=this.options,r=new VU,s=n.domBuilder||new Nd,i=n.errorHandler,o=n.locator,a=n.xmlns||{},l=/\/x?html?$/.test(e),u=l?rE.HTML_ENTITIES:rE.XML_ENTITIES;return o&&s.setDocumentLocator(o),r.errorHandler=WU(i,s,o),r.domBuilder=n.domBuilder||s,l&&(a[""]=sE.HTML),a.xml=a.xml||sE.XML,t&&typeof t=="string"?r.parse(t,a,u):r.errorHandler.error("invalid doc source"),s.doc};function WU(t,e,n){if(!t){if(e instanceof Nd)return e;t=e}var r={},s=t instanceof Function;n=n||{};function i(o){var a=t[o];!a&&s&&(a=t.length==2?function(l){t(o,l)}:t),r[o]=a&&function(l){a("[xmldom "+o+"]	"+l+ox(n))}||function(){}}return i("warning"),i("error"),i("fatalError"),r}function Nd(){this.cdata=!1}function nu(t,e){e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber}Nd.prototype={startDocument:function(){this.doc=new zU().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(t,e,n,r){var s=this.doc,i=s.createElementNS(t,n||e),o=r.length;kp(this,i),this.currentElement=i,this.locator&&nu(this.locator,i);for(var a=0;a<o;a++){var t=r.getURI(a),l=r.getValue(a),n=r.getQName(a),u=s.createAttributeNS(t,n);this.locator&&nu(r.getLocator(a),u),u.value=u.nodeValue=l,i.setAttributeNode(u)}},endElement:function(t,e,n){var r=this.currentElement;r.tagName,this.currentElement=r.parentNode},startPrefixMapping:function(t,e){},endPrefixMapping:function(t){},processingInstruction:function(t,e){var n=this.doc.createProcessingInstruction(t,e);this.locator&&nu(this.locator,n),kp(this,n)},ignorableWhitespace:function(t,e,n){},characters:function(t,e,n){if(t=iE.apply(this,arguments),t){if(this.cdata)var r=this.doc.createCDATASection(t);else var r=this.doc.createTextNode(t);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(t)&&this.doc.appendChild(r),this.locator&&nu(this.locator,r)}},skippedEntity:function(t){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(t){(this.locator=t)&&(t.lineNumber=0)},comment:function(t,e,n){t=iE.apply(this,arguments);var r=this.doc.createComment(t);this.locator&&nu(this.locator,r),kp(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(t,e,n){var r=this.doc.implementation;if(r&&r.createDocumentType){var s=r.createDocumentType(t,e,n);this.locator&&nu(this.locator,s),kp(this,s),this.doc.doctype=s}},warning:function(t){console.warn("[xmldom warning]	"+t,ox(this.locator))},error:function(t){console.error("[xmldom error]	"+t,ox(this.locator))},fatalError:function(t){throw new UU(t,this.locator)}};function ox(t){if(t)return`
@`+(t.systemId||"")+"#[line:"+t.lineNumber+",col:"+t.columnNumber+"]"}function iE(t,e,n){return typeof t=="string"?t.substr(e,n):t.length>=e+n||e?new java.lang.String(t,e,n)+"":t}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(t){Nd.prototype[t]=function(){return null}});function kp(t,e){t.currentElement?t.currentElement.appendChild(e):t.doc.appendChild(e)}_d.__DOMHandler=Nd;_d.DOMParser=K$;_d.DOMImplementation=lw.DOMImplementation;_d.XMLSerializer=lw.XMLSerializer;var X$=No;kd.DOMImplementation=X$.DOMImplementation;kd.XMLSerializer=X$.XMLSerializer;kd.DOMParser=_d.DOMParser;Object.defineProperty(je,"__esModule",{value:!0});je.RangeObject=void 0;je.blob2base64=gV;je.borders=nV;je.bounds=tV;je.createBase64Url=cV;je.createBlob=J$;je.createBlobUrl=lV;je.defaults=QU;je.defer=vV;je.documentHeight=KU;je.extend=JU;je.filterChildren=bV;je.findChildren=xV;je.getParentByTagName=wV;je.indexOfElementNode=oV;je.indexOfNode=uw;je.indexOfSorted=ax;je.indexOfTextNode=iV;je.insert=eV;je.isElement=XU;je.isFloat=YU;je.isNumber=Q$;je.isXml=aV;je.locationOf=zm;je.nodeBounds=rV;je.parents=lx;je.parse=dV;je.prefixed=ZU;je.qs=fV;je.qsa=eD;je.qsp=pV;je.querySelectorByType=yV;je.requestAnimationFrame=void 0;je.revokeBlobUrl=uV;je.sprint=mV;je.treeWalker=tD;je.type=hV;je.uuid=Z$;je.walk=cw;je.windowBounds=sV;var GU=kd;const jU=typeof window<"u"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1;je.requestAnimationFrame=jU;const HU=1,qU=3,Y$=typeof URL<"u"?URL:typeof window<"u"?window.URL||window.webkitURL||window.mozURL:void 0;function Z$(){var t=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var r=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(n=="x"?r:r&7|8).toString(16)});return e}function KU(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function XU(t){return!!(t&&t.nodeType==1)}function Q$(t){return!isNaN(parseFloat(t))&&isFinite(t)}function YU(t){let e=parseFloat(t);return Q$(t)===!1?!1:typeof t=="string"&&t.indexOf(".")>-1?!0:Math.floor(e)!==e}function ZU(t){var e=["Webkit","webkit","Moz","O","ms"],n=["-webkit-","-webkit-","-moz-","-o-","-ms-"],r=t.toLowerCase(),s=e.length;if(typeof document>"u"||typeof document.body.style[r]<"u")return t;for(var i=0;i<s;i++)if(typeof document.body.style[n[i]+r]<"u")return n[i]+r;return t}function QU(t){for(var e=1,n=arguments.length;e<n;e++){var r=arguments[e];for(var s in r)t[s]===void 0&&(t[s]=r[s])}return t}function JU(t){var e=[].slice.call(arguments,1);return e.forEach(function(n){n&&Object.getOwnPropertyNames(n).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}),t}function eV(t,e,n){var r=zm(t,e,n);return e.splice(r,0,t),r}function zm(t,e,n,r,s){var i=r||0,o=s||e.length,a=parseInt(i+(o-i)/2),l;return n||(n=function(u,c){if(u>c)return 1;if(u<c)return-1;if(u==c)return 0}),o-i<=0?a:(l=n(e[a],t),o-i===1?l>=0?a:a+1:l===0?a:l===-1?zm(t,e,n,a,o):zm(t,e,n,i,a))}function ax(t,e,n,r,s){var i=r||0,o=s||e.length,a=parseInt(i+(o-i)/2),l;return n||(n=function(u,c){if(u>c)return 1;if(u<c)return-1;if(u==c)return 0}),o-i<=0?-1:(l=n(e[a],t),o-i===1?l===0?a:-1:l===0?a:l===-1?ax(t,e,n,a,o):ax(t,e,n,i,a))}function tV(t){var e=window.getComputedStyle(t),n=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],s=0,i=0;return n.forEach(function(o){s+=parseFloat(e[o])||0}),r.forEach(function(o){i+=parseFloat(e[o])||0}),{height:i,width:s}}function nV(t){var e=window.getComputedStyle(t),n=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],s=0,i=0;return n.forEach(function(o){s+=parseFloat(e[o])||0}),r.forEach(function(o){i+=parseFloat(e[o])||0}),{height:i,width:s}}function rV(t){let e,n=t.ownerDocument;if(t.nodeType==Node.TEXT_NODE){let r=n.createRange();r.selectNodeContents(t),e=r.getBoundingClientRect()}else e=t.getBoundingClientRect();return e}function sV(){var t=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:t,bottom:e,width:t,height:e}}function uw(t,e){for(var n=t.parentNode,r=n.childNodes,s,i=-1,o=0;o<r.length&&(s=r[o],s.nodeType===e&&i++,s!=t);o++);return i}function iV(t){return uw(t,qU)}function oV(t){return uw(t,HU)}function aV(t){return["xml","opf","ncx"].indexOf(t)>-1}function J$(t,e){return new Blob([t],{type:e})}function lV(t,e){var n,r=J$(t,e);return n=Y$.createObjectURL(r),n}function uV(t){return Y$.revokeObjectURL(t)}function cV(t,e){var n,r;if(typeof t=="string")return n=btoa(t),r="data:"+e+";base64,"+n,r}function hV(t){return Object.prototype.toString.call(t).slice(8,-1)}function dV(t,e,n){var r,s;return typeof DOMParser>"u"||n?s=GU.DOMParser:s=DOMParser,t.charCodeAt(0)===65279&&(t=t.slice(1)),r=new s().parseFromString(t,e),r}function fV(t,e){var n;if(!t)throw new Error("No Element Provided");if(typeof t.querySelector<"u")return t.querySelector(e);if(n=t.getElementsByTagName(e),n.length)return n[0]}function eD(t,e){return typeof t.querySelector<"u"?t.querySelectorAll(e):t.getElementsByTagName(e)}function pV(t,e,n){var r,s;if(typeof t.querySelector<"u"){e+="[";for(var i in n)e+=i+"~='"+n[i]+"'";return e+="]",t.querySelector(e)}else if(r=t.getElementsByTagName(e),s=Array.prototype.slice.call(r,0).filter(function(o){for(var a in n)if(o.getAttribute(a)===n[a])return!0;return!1}),s)return s[0]}function mV(t,e){var n=t.ownerDocument||t;typeof n.createTreeWalker<"u"?tD(t,e,NodeFilter.SHOW_TEXT):cw(t,function(r){r&&r.nodeType===3&&e(r)})}function tD(t,e,n){var r=document.createTreeWalker(t,n,null,!1);let s;for(;s=r.nextNode();)e(s)}function cw(t,e){if(e(t))return!0;if(t=t.firstChild,t)do{if(cw(t,e))return!0;t=t.nextSibling}while(t)}function gV(t){return new Promise(function(e,n){var r=new FileReader;r.readAsDataURL(t),r.onloadend=function(){e(r.result)}})}function vV(){this.resolve=null,this.reject=null,this.id=Z$(),this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e}),Object.freeze(this)}function yV(t,e,n){var r;if(typeof t.querySelector<"u"&&(r=t.querySelector(`${e}[*|type="${n}"]`)),!r||r.length===0){r=eD(t,e);for(var s=0;s<r.length;s++)if(r[s].getAttributeNS("http://www.idpf.org/2007/ops","type")===n||r[s].getAttribute("epub:type")===n)return r[s]}else return r}function xV(t){for(var e=[],n=t.childNodes,r=0;r<n.length;r++){let s=n[r];s.nodeType===1&&e.push(s)}return e}function lx(t){for(var e=[t];t;t=t.parentNode)e.unshift(t);return e}function bV(t,e,n){for(var r=[],s=t.childNodes,i=0;i<s.length;i++){let o=s[i];if(o.nodeType===1&&o.nodeName.toLowerCase()===e){if(n)return o;r.push(o)}}if(!n)return r}function wV(t,e){let n;if(!(t===null||e===""))for(n=t.parentNode;n.nodeType===1;){if(n.tagName.toLowerCase()===e)return n;n=n.parentNode}}class CV{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,n){this.startContainer=e,this.startOffset=n,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,n){this.endContainer=e,this.endOffset=n,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let n=e.parentNode,r=Array.prototype.indexOf.call(n.childNodes,e);this.setStart(n,r),this.setEnd(n,r+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let n=e.nodeType===3?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,n)}_commonAncestorContainer(e,n){var r=lx(e||this.startContainer),s=lx(n||this.endContainer);if(r[0]==s[0]){for(var i=0;i<r.length;i++)if(r[i]!=s[i])return r[i-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}je.RangeObject=CV;var Rl={},no={};if(!nD)var nD={cwd:function(){return"/"}};function Di(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+t)}function oE(t,e){for(var n="",r=-1,s=0,i,o=0;o<=t.length;++o){if(o<t.length)i=t.charCodeAt(o);else{if(i===47)break;i=47}if(i===47){if(!(r===o-1||s===1))if(r!==o-1&&s===2){if(n.length<2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){for(var a=n.length-1,l=a;l>=0&&n.charCodeAt(l)!==47;--l);if(l!==a){l===-1?n="":n=n.slice(0,l),r=o,s=0;continue}}else if(n.length===2||n.length===1){n="",r=o,s=0;continue}}e&&(n.length>0?n+="/..":n="..")}else n.length>0?n+="/"+t.slice(r+1,o):n=t.slice(r+1,o);r=o,s=0}else i===46&&s!==-1?++s:s=-1}return n}function SV(t,e){var n=e.dir||e.root,r=e.base||(e.name||"")+(e.ext||"");return n?n===e.root?n+r:n+t+r:r}var sm={resolve:function(){for(var e="",n=!1,r,s=arguments.length-1;s>=-1&&!n;s--){var i;s>=0?i=arguments[s]:(r===void 0&&(r=nD.cwd()),i=r),Di(i),i.length!==0&&(e=i+"/"+e,n=i.charCodeAt(0)===47)}return e=oE(e,!n),n?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Di(e),e.length===0)return".";var n=e.charCodeAt(0)===47,r=e.charCodeAt(e.length-1)===47;return e=oE(e,!n),e.length===0&&!n&&(e="."),e.length>0&&r&&(e+="/"),n?"/"+e:e},isAbsolute:function(e){return Di(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,n=0;n<arguments.length;++n){var r=arguments[n];Di(r),r.length>0&&(e===void 0?e=r:e+="/"+r)}return e===void 0?".":sm.normalize(e)},relative:function(e,n){if(Di(e),Di(n),e===n||(e=sm.resolve(e),n=sm.resolve(n),e===n))return"";for(var r=1;r<e.length&&e.charCodeAt(r)===47;++r);for(var s=e.length,i=s-r,o=1;o<n.length&&n.charCodeAt(o)===47;++o);for(var a=n.length,l=a-o,u=i<l?i:l,c=-1,h=0;h<=u;++h){if(h===u){if(l>u){if(n.charCodeAt(o+h)===47)return n.slice(o+h+1);if(h===0)return n.slice(o+h)}else i>u&&(e.charCodeAt(r+h)===47?c=h:h===0&&(c=0));break}var d=e.charCodeAt(r+h),f=n.charCodeAt(o+h);if(d!==f)break;d===47&&(c=h)}var m="";for(h=r+c+1;h<=s;++h)(h===s||e.charCodeAt(h)===47)&&(m.length===0?m+="..":m+="/..");return m.length>0?m+n.slice(o+c):(o+=c,n.charCodeAt(o)===47&&++o,n.slice(o))},_makeLong:function(e){return e},dirname:function(e){if(Di(e),e.length===0)return".";for(var n=e.charCodeAt(0),r=n===47,s=-1,i=!0,o=e.length-1;o>=1;--o)if(n=e.charCodeAt(o),n===47){if(!i){s=o;break}}else i=!1;return s===-1?r?"/":".":r&&s===1?"//":e.slice(0,s)},basename:function(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');Di(e);var r=0,s=-1,i=!0,o;if(n!==void 0&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return"";var a=n.length-1,l=-1;for(o=e.length-1;o>=0;--o){var u=e.charCodeAt(o);if(u===47){if(!i){r=o+1;break}}else l===-1&&(i=!1,l=o+1),a>=0&&(u===n.charCodeAt(a)?--a===-1&&(s=o):(a=-1,s=l))}return r===s?s=l:s===-1&&(s=e.length),e.slice(r,s)}else{for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!i){r=o+1;break}}else s===-1&&(i=!1,s=o+1);return s===-1?"":e.slice(r,s)}},extname:function(e){Di(e);for(var n=-1,r=0,s=-1,i=!0,o=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!i){r=a+1;break}continue}s===-1&&(i=!1,s=a+1),l===46?n===-1?n=a:o!==1&&(o=1):n!==-1&&(o=-1)}return n===-1||s===-1||o===0||o===1&&n===s-1&&n===r+1?"":e.slice(n,s)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof e);return SV("/",e)},parse:function(e){Di(e);var n={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return n;var r=e.charCodeAt(0),s=r===47,i;s?(n.root="/",i=1):i=0;for(var o=-1,a=0,l=-1,u=!0,c=e.length-1,h=0;c>=i;--c){if(r=e.charCodeAt(c),r===47){if(!u){a=c+1;break}continue}l===-1&&(u=!1,l=c+1),r===46?o===-1?o=c:h!==1&&(h=1):o!==-1&&(h=-1)}return o===-1||l===-1||h===0||h===1&&o===l-1&&o===a+1?l!==-1&&(a===0&&s?n.base=n.name=e.slice(1,l):n.base=n.name=e.slice(a,l)):(a===0&&s?(n.name=e.slice(1,o),n.base=e.slice(1,l)):(n.name=e.slice(a,o),n.base=e.slice(a,l)),n.ext=e.slice(o,l)),a>0?n.dir=e.slice(0,a-1):s&&(n.dir="/"),n},sep:"/",delimiter:":",posix:null},Wg=sm;Object.defineProperty(no,"__esModule",{value:!0});no.default=void 0;var Ep=kV(Wg);function kV(t){return t&&t.__esModule?t:{default:t}}class EV{constructor(e){var n,r;n=e.indexOf("://"),n>-1&&(e=new URL(e).pathname),r=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=r.dir+"/",this.filename=r.base,this.extension=r.ext.slice(1)}parse(e){return Ep.default.parse(e)}isAbsolute(e){return Ep.default.isAbsolute(e||this.path)}isDirectory(e){return e.charAt(e.length-1)==="/"}resolve(e){return Ep.default.resolve(this.directory,e)}relative(e){var n=e&&e.indexOf("://")>-1;return n?e:Ep.default.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}var IV=EV;no.default=IV;Object.defineProperty(Rl,"__esModule",{value:!0});Rl.default=void 0;var aE=rD(no),lE=rD(Wg);function rD(t){return t&&t.__esModule?t:{default:t}}class TV{constructor(e,n){var r=e.indexOf("://")>-1,s=e,i;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=n,!r&&n!==!1&&typeof n!="string"&&window&&window.location&&(this.base=window.location.href),r||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,s=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch{this.Url=void 0,this.base&&(i=new aE.default(this.base),s=i.resolve(s))}this.Path=new aE.default(s),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var n=e.indexOf("://")>-1,r;return n?e:(r=lE.default.resolve(this.directory,e),this.origin+r)}relative(e){return lE.default.relative(e,this.directory)}toString(){return this.href}}var _V=TV;Rl.default=_V;var Gg={},jr={};Object.defineProperty(jr,"__esModule",{value:!0});jr.default=void 0;var Lo=je;const ru=1,Ns=3,NV=9;class ja{constructor(e,n,r){var s;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof ja))return new ja(e,n,r);if(typeof n=="string"?this.base=this.parseComponent(n):typeof n=="object"&&n.steps&&(this.base=n),s=this.checkType(e),s==="string")return this.str=e,(0,Lo.extend)(this,this.parse(e));if(s==="range")return(0,Lo.extend)(this,this.fromRange(e,this.base,r));if(s==="node")return(0,Lo.extend)(this,this.fromNode(e,this.base,r));if(s==="EpubCFI"&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":e&&typeof e=="object"&&((0,Lo.type)(e)==="Range"||typeof e.startContainer<"u")?"range":e&&typeof e=="object"&&typeof e.nodeType<"u"?"node":e&&typeof e=="object"&&e instanceof ja?"EpubCFI":!1}parse(e){var n={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},r,s,i;return typeof e!="string"?{spinePos:-1}:(e.indexOf("epubcfi(")===0&&e[e.length-1]===")"&&(e=e.slice(8,e.length-1)),r=this.getChapterComponent(e),r?(n.base=this.parseComponent(r),s=this.getPathComponent(e),n.path=this.parseComponent(s),i=this.getRange(e),i&&(n.range=!0,n.start=this.parseComponent(i[0]),n.end=this.parseComponent(i[1])),n.spinePos=n.base.steps[1].index,n):{spinePos:-1})}parseComponent(e){var n={steps:[],terminal:{offset:null,assertion:null}},r=e.split(":"),s=r[0].split("/"),i;return r.length>1&&(i=r[1],n.terminal=this.parseTerminal(i)),s[0]===""&&s.shift(),n.steps=s.map((function(o){return this.parseStep(o)}).bind(this)),n}parseStep(e){var n,r,s,i,o;if(i=e.match(/\[(.*)\]/),i&&i[1]&&(o=i[1]),r=parseInt(e),!isNaN(r))return r%2===0?(n="element",s=r/2-1):(n="text",s=(r-1)/2),{type:n,index:s,id:o||null}}parseTerminal(e){var n,r,s=e.match(/\[(.*)\]/);return s&&s[1]?(n=parseInt(e.split("[")[0]),r=s[1]):n=parseInt(e),(0,Lo.isNumber)(n)||(n=null),{offset:n,assertion:r}}getChapterComponent(e){var n=e.split("!");return n[0]}getPathComponent(e){var n=e.split("!");if(n[1])return n[1].split(",")[0]}getRange(e){var n=e.split(",");return n.length===3?[n[1],n[2]]:!1}getCharecterOffsetComponent(e){var n=e.split(":");return n[1]||""}joinSteps(e){return e?e.map(function(n){var r="";return n.type==="element"&&(r+=(n.index+1)*2),n.type==="text"&&(r+=1+2*n.index),n.id&&(r+="["+n.id+"]"),r}).join("/"):""}segmentString(e){var n="/";return n+=this.joinSteps(e.steps),e.terminal&&e.terminal.offset!=null&&(n+=":"+e.terminal.offset),e.terminal&&e.terminal.assertion!=null&&(n+="["+e.terminal.assertion+"]"),n}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+=")",e}compare(e,n){var r,s,i,o;if(typeof e=="string"&&(e=new ja(e)),typeof n=="string"&&(n=new ja(n)),e.spinePos>n.spinePos)return 1;if(e.spinePos<n.spinePos)return-1;e.range?(r=e.path.steps.concat(e.start.steps),i=e.start.terminal):(r=e.path.steps,i=e.path.terminal),n.range?(s=n.path.steps.concat(n.start.steps),o=n.start.terminal):(s=n.path.steps,o=n.path.terminal);for(var a=0;a<r.length;a++){if(!r[a])return-1;if(!s[a]||r[a].index>s[a].index)return 1;if(r[a].index<s[a].index)return-1}return r.length<s.length?-1:i.offset>o.offset?1:i.offset<o.offset?-1:0}step(e){var n=e.nodeType===Ns?"text":"element";return{id:e.id,tagName:e.tagName,type:n,index:this.position(e)}}filteredStep(e,n){var r=this.filter(e,n),s;if(r)return s=r.nodeType===Ns?"text":"element",{id:r.id,tagName:r.tagName,type:s,index:this.filteredPosition(r,n)}}pathTo(e,n,r){for(var s={steps:[],terminal:{offset:null,assertion:null}},i=e,o;i&&i.parentNode&&i.parentNode.nodeType!=NV;)r?o=this.filteredStep(i,r):o=this.step(i),o&&s.steps.unshift(o),i=i.parentNode;return n!=null&&n>=0&&(s.terminal.offset=n,s.steps[s.steps.length-1].type!="text"&&s.steps.push({type:"text",index:0})),s}equalStep(e,n){return!e||!n?!1:e.index===n.index&&e.id===n.id&&e.type===n.type}fromRange(e,n,r){var s={range:!1,base:{},path:{},start:null,end:null},i=e.startContainer,o=e.endContainer,a=e.startOffset,l=e.endOffset,u=!1;if(r&&(u=i.ownerDocument.querySelector("."+r)!=null),typeof n=="string"?(s.base=this.parseComponent(n),s.spinePos=s.base.steps[1].index):typeof n=="object"&&(s.base=n),e.collapsed)u&&(a=this.patchOffset(i,a,r)),s.path=this.pathTo(i,a,r);else{s.range=!0,u&&(a=this.patchOffset(i,a,r)),s.start=this.pathTo(i,a,r),u&&(l=this.patchOffset(o,l,r)),s.end=this.pathTo(o,l,r),s.path={steps:[],terminal:null};var c=s.start.steps.length,h;for(h=0;h<c&&this.equalStep(s.start.steps[h],s.end.steps[h]);h++)h===c-1?s.start.terminal===s.end.terminal&&(s.path.steps.push(s.start.steps[h]),s.range=!1):s.path.steps.push(s.start.steps[h]);s.start.steps=s.start.steps.slice(s.path.steps.length),s.end.steps=s.end.steps.slice(s.path.steps.length)}return s}fromNode(e,n,r){var s={range:!1,base:{},path:{},start:null,end:null};return typeof n=="string"?(s.base=this.parseComponent(n),s.spinePos=s.base.steps[1].index):typeof n=="object"&&(s.base=n),s.path=this.pathTo(e,null,r),s}filter(e,n){var r,s,i,o,a,l=!1;return e.nodeType===Ns?(l=!0,i=e.parentNode,r=e.parentNode.classList.contains(n)):(l=!1,r=e.classList.contains(n)),r&&l?(o=i.previousSibling,a=i.nextSibling,o&&o.nodeType===Ns?s=o:a&&a.nodeType===Ns&&(s=a),s||e):r&&!l?!1:e}patchOffset(e,n,r){if(e.nodeType!=Ns)throw new Error("Anchor must be a text node");var s=e,i=n;for(e.parentNode.classList.contains(r)&&(s=e.parentNode);s.previousSibling;){if(s.previousSibling.nodeType===ru)if(s.previousSibling.classList.contains(r))i+=s.previousSibling.textContent.length;else break;else i+=s.previousSibling.textContent.length;s=s.previousSibling}return i}normalizedMap(e,n,r){var s={},i=-1,o,a=e.length,l,u;for(o=0;o<a;o++)l=e[o].nodeType,l===ru&&e[o].classList.contains(r)&&(l=Ns),o>0&&l===Ns&&u===Ns?s[o]=i:n===l&&(i=i+1,s[o]=i),u=l;return s}position(e){var n,r;return e.nodeType===ru?(n=e.parentNode.children,n||(n=(0,Lo.findChildren)(e.parentNode)),r=Array.prototype.indexOf.call(n,e)):(n=this.textNodes(e.parentNode),r=n.indexOf(e)),r}filteredPosition(e,n){var r,s,i;return e.nodeType===ru?(r=e.parentNode.children,i=this.normalizedMap(r,ru,n)):(r=e.parentNode.childNodes,e.parentNode.classList.contains(n)&&(e=e.parentNode,r=e.parentNode.childNodes),i=this.normalizedMap(r,Ns,n)),s=Array.prototype.indexOf.call(r,e),i[s]}stepsToXpath(e){var n=[".","*"];return e.forEach(function(r){var s=r.index+1;r.id?n.push("*[position()="+s+" and @id='"+r.id+"']"):r.type==="text"?n.push("text()["+s+"]"):n.push("*["+s+"]")}),n.join("/")}stepsToQuerySelector(e){var n=["html"];return e.forEach(function(r){var s=r.index+1;r.id?n.push("#"+r.id):r.type==="text"||n.push("*:nth-child("+s+")")}),n.join(">")}textNodes(e,n){return Array.prototype.slice.call(e.childNodes).filter(function(r){return r.nodeType===Ns?!0:!!(n&&r.classList.contains(n))})}walkToNode(e,n,r){var s=n||document,i=s.documentElement,o,a,l=e.length,u;for(u=0;u<l&&(a=e[u],a.type==="element"?a.id?i=s.getElementById(a.id):(o=i.children||(0,Lo.findChildren)(i),i=o[a.index]):a.type==="text"&&(i=this.textNodes(i,r)[a.index]),!!i);u++);return i}findNode(e,n,r){var s=n||document,i,o;return!r&&typeof s.evaluate<"u"?(o=this.stepsToXpath(e),i=s.evaluate(o,s,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):r?i=this.walkToNode(e,s,r):i=this.walkToNode(e,s),i}fixMiss(e,n,r,s){var i=this.findNode(e.slice(0,-1),r,s),o=i.childNodes,a=this.normalizedMap(o,Ns,s),l,u,c=e[e.length-1].index;for(let h in a){if(!a.hasOwnProperty(h))return;if(a[h]===c)if(l=o[h],u=l.textContent.length,n>u)n=n-u;else{l.nodeType===ru?i=l.childNodes[0]:i=l;break}}return{container:i,offset:n}}toRange(e,n){var r=e||document,s,i,o,a,l,u=this,c,h,d=n?r.querySelector("."+n)!=null:!1,f;if(typeof r.createRange<"u"?s=r.createRange():s=new Lo.RangeObject,u.range?(i=u.start,c=u.path.steps.concat(i.steps),a=this.findNode(c,r,d?n:null),o=u.end,h=u.path.steps.concat(o.steps),l=this.findNode(h,r,d?n:null)):(i=u.path,c=u.path.steps,a=this.findNode(u.path.steps,r,d?n:null)),a)try{i.terminal.offset!=null?s.setStart(a,i.terminal.offset):s.setStart(a,0)}catch{f=this.fixMiss(c,i.terminal.offset,r,d?n:null),s.setStart(f.container,f.offset)}else return console.log("No startContainer found for",this.toString()),null;if(l)try{o.terminal.offset!=null?s.setEnd(l,o.terminal.offset):s.setEnd(l,0)}catch{f=this.fixMiss(h,u.end.terminal.offset,r,d?n:null),s.setEnd(f.container,f.offset)}return s}isCfiString(e){return typeof e=="string"&&e.indexOf("epubcfi(")===0&&e[e.length-1]===")"}generateChapterComponent(e,n,r){var s=parseInt(n),i=(e+1)*2,o="/"+i+"/";return o+=(s+1)*2,r&&(o+="["+r+"]"),o}collapse(e){this.range&&(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}var $V=ja;jr.default=$V;var pc={};Object.defineProperty(pc,"__esModule",{value:!0});pc.default=void 0;class DV{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if(typeof arguments[e]=="function")this.hooks.push(arguments[e]);else for(var n=0;n<arguments[e].length;++n)this.hooks.push(arguments[e][n])}deregister(e){let n;for(let r=0;r<this.hooks.length;r++)if(n=this.hooks[r],n===e){this.hooks.splice(r,1);break}}trigger(){var e=arguments,n=this.context,r=[];return this.hooks.forEach(function(s){try{var i=s.apply(n,e)}catch(o){console.log(o)}i&&typeof i.then=="function"&&r.push(i)}),Promise.all(r)}list(){return this.hooks}clear(){return this.hooks=[]}}var AV=DV;pc.default=AV;var jg={},ro={};Object.defineProperty(ro,"__esModule",{value:!0});ro.replaceBase=OV;ro.replaceCanonical=FV;ro.replaceLinks=PV;ro.replaceMeta=LV;ro.substitute=MV;var pl=je,RV=sD(Rl);sD(no);function sD(t){return t&&t.__esModule?t:{default:t}}function OV(t,e){var n,r,s=e.url,i=s.indexOf("://")>-1;t&&(r=(0,pl.qs)(t,"head"),n=(0,pl.qs)(r,"base"),n||(n=t.createElement("base"),r.insertBefore(n,r.firstChild)),!i&&window&&window.location&&(s=window.location.origin+s),n.setAttribute("href",s))}function FV(t,e){var n,r,s=e.canonical;t&&(n=(0,pl.qs)(t,"head"),r=(0,pl.qs)(n,"link[rel='canonical']"),r?r.setAttribute("href",s):(r=t.createElement("link"),r.setAttribute("rel","canonical"),r.setAttribute("href",s),n.appendChild(r)))}function LV(t,e){var n,r,s=e.idref;t&&(n=(0,pl.qs)(t,"head"),r=(0,pl.qs)(n,"link[property='dc.identifier']"),r?r.setAttribute("content",s):(r=t.createElement("meta"),r.setAttribute("name","dc.identifier"),r.setAttribute("content",s),n.appendChild(r)))}function PV(t,e){var n=t.querySelectorAll("a[href]");if(n.length)for(var r=(0,pl.qs)(t.ownerDocument,"base"),s=r?r.getAttribute("href"):void 0,i=(function(a){var l=a.getAttribute("href");if(l.indexOf("mailto:")!==0){var u=l.indexOf("://")>-1;if(u)a.setAttribute("target","_blank");else{var c;try{c=new RV.default(l,s)}catch{}a.onclick=function(){return c&&c.hash?e(c.Path.path+c.hash):e(c?c.Path.path:l),!1}}}}).bind(this),o=0;o<n.length;o++)i(n[o])}function MV(t,e,n){return e.forEach(function(r,s){r&&n[s]&&(r=r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),t=t.replace(new RegExp(r,"g"),n[s]))}),t}var Ol={};Object.defineProperty(Ol,"__esModule",{value:!0});Ol.default=void 0;var su=je,BV=zV(no);function zV(t){return t&&t.__esModule?t:{default:t}}function UV(t,e,n,r){var s=typeof window<"u"?window.URL:!1,i=s?"blob":"arraybuffer",o=new su.defer,a=new XMLHttpRequest,l=XMLHttpRequest.prototype,u;"overrideMimeType"in l||Object.defineProperty(l,"overrideMimeType",{value:function(){}}),n&&(a.withCredentials=!0),a.onreadystatechange=h,a.onerror=c,a.open("GET",t,!0);for(u in r)a.setRequestHeader(u,r[u]);e=="json"&&a.setRequestHeader("Accept","application/json"),e||(e=new BV.default(t).extension),e=="blob"&&(a.responseType=i),(0,su.isXml)(e)&&a.overrideMimeType("text/xml"),e=="binary"&&(a.responseType="arraybuffer"),a.send();function c(d){o.reject(d)}function h(){if(this.readyState===XMLHttpRequest.DONE){var d=!1;if((this.responseType===""||this.responseType==="document")&&(d=this.responseXML),this.status===200||this.status===0||d){var f;if(!this.response&&!d)return o.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),o.promise;if(this.status===403)return o.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),o.promise;d?f=this.responseXML:(0,su.isXml)(e)?f=(0,su.parse)(this.response,"text/xml"):e=="xhtml"?f=(0,su.parse)(this.response,"application/xhtml+xml"):e=="html"||e=="htm"?f=(0,su.parse)(this.response,"text/html"):e=="json"?f=JSON.parse(this.response):e=="blob"?s?f=this.response:f=new Blob([this.response]):f=this.response,o.resolve(f)}else o.reject({status:this.status,message:this.response,stack:new Error().stack})}}return o.promise}var VV=UV;Ol.default=VV;Object.defineProperty(jg,"__esModule",{value:!0});jg.default=void 0;var Ry=je,uE=hw(jr),cE=hw(pc),WV=ro,GV=hw(Ol),jV=kd;function hw(t){return t&&t.__esModule?t:{default:t}}class HV{constructor(e,n){this.idref=e.idref,this.linear=e.linear==="yes",this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,n?this.hooks=n:(this.hooks={},this.hooks.serialize=new cE.default(this),this.hooks.content=new cE.default(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var n=e||this.request||GV.default,r=new Ry.defer,s=r.promise;return this.contents?r.resolve(this.contents):n(this.url).then((function(i){return this.document=i,this.contents=i.documentElement,this.hooks.content.trigger(this.document,this)}).bind(this)).then((function(){r.resolve(this.contents)}).bind(this)).catch(function(i){r.reject(i)}),s}base(){return(0,WV.replaceBase)(this.document,this)}render(e){var n=new Ry.defer,r=n.promise;return this.output,this.load(e).then((function(s){var i=typeof navigator<"u"&&navigator.userAgent||"",o=i.indexOf("Trident")>=0,a;typeof XMLSerializer>"u"||o?a=jV.DOMParser:a=XMLSerializer;var l=new a;return this.output=l.serializeToString(s),this.output}).bind(this)).then((function(){return this.hooks.serialize.trigger(this.output,this)}).bind(this)).then((function(){n.resolve(this.output)}).bind(this)).catch(function(s){n.reject(s)}),r}find(e){var n=this,r=[],s=e.toLowerCase(),i=function(o){for(var a=o.textContent.toLowerCase(),l=n.document.createRange(),u,c,h=-1,d,f=150;c!=-1;)c=a.indexOf(s,h+1),c!=-1&&(l=n.document.createRange(),l.setStart(o,c),l.setEnd(o,c+s.length),u=n.cfiFromRange(l),o.textContent.length<f?d=o.textContent:(d=o.textContent.substring(c-f/2,c+f/2),d="..."+d+"..."),r.push({cfi:u,excerpt:d})),h=c};return(0,Ry.sprint)(n.document,function(o){i(o)}),r}search(e,n=5){if(typeof document.createTreeWalker>"u")return this.find(e);let r=[];const s=150,i=this,o=e.toLowerCase(),a=function(h){const m=h.reduce((v,p)=>v+p.textContent,"").toLowerCase().indexOf(o);if(m!=-1){const p=m+o.length;let g=0,y=0;if(m<h[0].length){let b;for(;g<h.length-1&&(y+=h[g].length,!(p<=y));)g+=1;let x=h[0],w=h[g],C=i.document.createRange();C.setStart(x,m);let S=h.slice(0,g).reduce((T,_)=>T+_.textContent.length,0);C.setEnd(w,S>p?p:p-S),b=i.cfiFromRange(C);let E=h.slice(0,g+1).reduce((T,_)=>T+_.textContent,"");E.length>s&&(E=E.substring(m-s/2,m+s/2),E="..."+E+"..."),r.push({cfi:b,excerpt:E})}}},l=document.createTreeWalker(i.document,NodeFilter.SHOW_TEXT,null,!1);let u,c=[];for(;u=l.nextNode();)c.push(u),c.length==n&&(a(c.slice(0,n)),c=c.slice(1,n));return c.length>0&&a(c),r}reconcileLayoutSettings(e){var n={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(r){var s=r.replace("rendition:",""),i=s.indexOf("-"),o,a;i!=-1&&(o=s.slice(0,i),a=s.slice(i+1),n[o]=a)}),n}cfiFromRange(e){return new uE.default(e,this.cfiBase).toString()}cfiFromElement(e){return new uE.default(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}var qV=HV;jg.default=qV;Object.defineProperty(Gg,"__esModule",{value:!0});Gg.default=void 0;var hE=dw(jr),dE=dw(pc),KV=dw(jg),Oy=ro;function dw(t){return t&&t.__esModule?t:{default:t}}class XV{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new dE.default,this.hooks.content=new dE.default,this.hooks.content.register(Oy.replaceBase),this.hooks.content.register(Oy.replaceCanonical),this.hooks.content.register(Oy.replaceMeta),this.epubcfi=new hE.default,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,n,r){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((s,i)=>{var o=this.manifest[s.idref],a;s.index=i,s.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,s.index,s.id),s.href&&(s.url=n(s.href,!0),s.canonical=r(s.href)),o&&(s.href=o.href,s.url=n(s.href,!0),s.canonical=r(s.href),o.properties.length&&s.properties.push.apply(s.properties,o.properties)),s.linear==="yes"?(s.prev=(function(){let l=s.index;for(;l>0;){let u=this.get(l-1);if(u&&u.linear)return u;l-=1}}).bind(this),s.next=(function(){let l=s.index;for(;l<this.spineItems.length-1;){let u=this.get(l+1);if(u&&u.linear)return u;l+=1}}).bind(this)):(s.prev=function(){},s.next=function(){}),a=new KV.default(s,this.hooks),this.append(a)}),this.loaded=!0}get(e){var n=0;if(typeof e>"u")for(;n<this.spineItems.length;){let r=this.spineItems[n];if(r&&r.linear)break;n+=1}else this.epubcfi.isCfiString(e)?n=new hE.default(e).spinePos:typeof e=="number"||isNaN(e)===!1?n=e:typeof e=="string"&&e.indexOf("#")===0?n=this.spineById[e.substring(1)]:typeof e=="string"&&(e=e.split("#")[0],n=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[n]||null}append(e){var n=this.spineItems.length;return e.index=n,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=n,this.spineByHref[encodeURI(e.href)]=n,this.spineByHref[e.href]=n,this.spineById[e.idref]=n,n}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(n,r){n.index=r}),0}remove(e){var n=this.spineItems.indexOf(e);if(n>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(n,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let n=this.get(e);if(n&&n.linear)return n;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let n=this.get(e);if(n&&n.linear)return n;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}var YV=XV;Gg.default=YV;var Hg={},pa={};Object.defineProperty(pa,"__esModule",{value:!0});pa.default=pa.Task=void 0;var Ip=je;class ZV{constructor(e){this._q=[],this.context=e,this.tick=Ip.requestAnimationFrame,this.running=!1,this.paused=!1}enqueue(){var e,n,r,s=[].shift.call(arguments),i=arguments;if(!s)throw new Error("No Task Provided");return typeof s=="function"?(e=new Ip.defer,n=e.promise,r={task:s,args:i,deferred:e,promise:n}):r={promise:s},this._q.push(r),this.paused==!1&&!this.running&&this.run(),r.promise}dequeue(){var e,n,r;if(this._q.length&&!this.paused){if(e=this._q.shift(),n=e.task,n)return r=n.apply(this.context,e.args),r&&typeof r.then=="function"?r.then((function(){e.deferred.resolve.apply(this.context,arguments)}).bind(this),(function(){e.deferred.reject.apply(this.context,arguments)}).bind(this)):(e.deferred.resolve.apply(this.context,r),e.promise);if(e.promise)return e.promise}else return e=new Ip.defer,e.deferred.resolve(),e.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new Ip.defer),this.tick.call(window,()=>{this._q.length?this.dequeue().then((function(){this.run()}).bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then((function(){return this.running=void 0,this.flush()}).bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}class QV{constructor(e,n,r){return function(){var s=arguments||[];return new Promise((i,o)=>{var a=function(l,u){!l&&u?o(u):i(l)};s.push(a),e.apply(r||this,s)})}}}pa.Task=QV;var JV=ZV;pa.default=JV;var or={};Object.defineProperty(or,"__esModule",{value:!0});or.EVENTS=or.EPUBJS_VERSION=or.DOM_EVENTS=void 0;const eW="0.3";or.EPUBJS_VERSION=eW;const tW=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"];or.DOM_EVENTS=tW;const nW={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};or.EVENTS=nW;Object.defineProperty(Hg,"__esModule",{value:!0});Hg.default=void 0;var La=je,rW=fw(pa),Po=fw(jr),sW=or,iW=fw(to);function fw(t){return t&&t.__esModule?t:{default:t}}class iD{constructor(e,n,r){this.spine=e,this.request=n,this.pause=r||100,this.q=new rW.default(this),this.epubcfi=new Po.default,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each((function(n){n.linear&&this.q.enqueue(this.process.bind(this),n)}).bind(this)),this.q.run().then((function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}).bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then((function(n){var r=new La.defer,s=this.parse(n,e.cfiBase);return this._locations=this._locations.concat(s),e.unload(),this.processingTimeout=setTimeout(()=>r.resolve(s),this.pause),r.promise}).bind(this))}parse(e,n,r){var s=[],i,o=e.ownerDocument,a=(0,La.qs)(o,"body"),l=0,u,c=r||this.break,h=function(d){var f=d.length,m,v=0;if(d.textContent.trim().length===0)return!1;for(l==0&&(i=this.createRange(),i.startContainer=d,i.startOffset=0),m=c-l,m>f&&(l+=f,v=f);v<f;)if(m=c-l,l===0&&(v+=1,i=this.createRange(),i.startContainer=d,i.startOffset=v),v+m>=f)l+=f-v,v=f;else{v+=m,i.endContainer=d,i.endOffset=v;let p=new Po.default(i,n).toString();s.push(p),l=0}u=d};if((0,La.sprint)(a,h.bind(this)),i&&i.startContainer&&u){i.endContainer=u,i.endOffset=u.length;let d=new Po.default(i,n).toString();s.push(d),l=0}return s}generateFromWords(e,n,r){var s=e?new Po.default(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each((function(i){i.linear&&(s?i.index>=s.spinePos&&this.q.enqueue(this.processWords.bind(this),i,n,s,r):this.q.enqueue(this.processWords.bind(this),i,n,s,r))}).bind(this)),this.q.run().then((function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}).bind(this))}processWords(e,n,r,s){return s&&this._locationsWords.length>=s?Promise.resolve():e.load(this.request).then((function(i){var o=new La.defer,a=this.parseWords(i,e,n,r),l=s-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(a.length>=s?a.slice(0,l):a),e.unload(),this.processingTimeout=setTimeout(()=>o.resolve(a),this.pause),o.promise}).bind(this))}countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,""),e=e.replace(/[ ]{2,}/gi," "),e=e.replace(/\n /,`
`),e.split(" ").length}parseWords(e,n,r,s){var i=n.cfiBase,o=[],a=e.ownerDocument,l=(0,La.qs)(a,"body"),u=r,c=s?s.spinePos!==n.index:!0,h;s&&n.index===s.spinePos&&(h=s.findNode(s.range?s.path.steps.concat(s.start.steps):s.path.steps,e.ownerDocument));var d=function(f){if(!c)if(f===h)c=!0;else return!1;if(f.textContent.length<10&&f.textContent.trim().length===0)return!1;var m=this.countWords(f.textContent),v,p=0;if(m===0)return!1;for(v=u-this._wordCounter,v>m&&(this._wordCounter+=m,p=m);p<m;)if(v=u-this._wordCounter,p+v>=m)this._wordCounter+=m-p,p=m;else{p+=v;let g=new Po.default(f,i);o.push({cfi:g.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return(0,La.sprint)(l,d.bind(this)),o}locationFromCfi(e){let n;return Po.default.prototype.isCfiString(e)&&(e=new Po.default(e)),this._locations.length===0?-1:(n=(0,La.locationOf)(e,this._locations,this.epubcfi.compare),n>this.total?this.total:n)}percentageFromCfi(e){if(this._locations.length===0)return null;var n=this.locationFromCfi(e);return this.percentageFromLocation(n)}percentageFromLocation(e){return!e||!this.total?0:e/this.total}cfiFromLocation(e){var n=-1;return typeof e!="number"&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(n=this._locations[e]),n}cfiFromPercentage(e){let n;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let r=new Po.default(this._locations[this.total]);return r.collapse(),r.toString()}return n=Math.ceil(this.total*e),this.cfiFromLocation(n)}load(e){return typeof e=="string"?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var n;if(typeof e=="string")this._currentCfi=e;else if(typeof e=="number")this._current=e;else return;this._locations.length!==0&&(typeof e=="string"?(n=this.locationFromCfi(e),this._current=n):n=e,this.emit(sW.EVENTS.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(n)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}(0,iW.default)(iD.prototype);var oW=iD;Hg.default=oW;var qg={};Object.defineProperty(qg,"__esModule",{value:!0});qg.default=void 0;var aW=uW(Wg),lW=je;function uW(t){return t&&t.__esModule?t:{default:t}}let cW=class{constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var n;if(!e)throw new Error("Container File Not Found");if(n=(0,lW.qs)(e,"rootfile"),!n)throw new Error("No RootFile Found");this.packagePath=n.getAttribute("full-path"),this.directory=aW.default.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}};var hW=cW;qg.default=hW;var Kg={};Object.defineProperty(Kg,"__esModule",{value:!0});Kg.default=void 0;var $s=je;class dW{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var n,r,s;if(!e)throw new Error("Package File Not Found");if(n=(0,$s.qs)(e,"metadata"),!n)throw new Error("No Metadata Found");if(r=(0,$s.qs)(e,"manifest"),!r)throw new Error("No Manifest Found");if(s=(0,$s.qs)(e,"spine"),!s)throw new Error("No Spine Found");return this.manifest=this.parseManifest(r),this.navPath=this.findNavPath(r),this.ncxPath=this.findNcxPath(r,s),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=(0,$s.indexOfElementNode)(s),this.spine=this.parseSpine(s,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(n),this.metadata.direction=s.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var n={};return n.title=this.getElementText(e,"title"),n.creator=this.getElementText(e,"creator"),n.description=this.getElementText(e,"description"),n.pubdate=this.getElementText(e,"date"),n.publisher=this.getElementText(e,"publisher"),n.identifier=this.getElementText(e,"identifier"),n.language=this.getElementText(e,"language"),n.rights=this.getElementText(e,"rights"),n.modified_date=this.getPropertyText(e,"dcterms:modified"),n.layout=this.getPropertyText(e,"rendition:layout"),n.orientation=this.getPropertyText(e,"rendition:orientation"),n.flow=this.getPropertyText(e,"rendition:flow"),n.viewport=this.getPropertyText(e,"rendition:viewport"),n.media_active_class=this.getPropertyText(e,"media:active-class"),n.spread=this.getPropertyText(e,"rendition:spread"),n}parseManifest(e){var n={},r=(0,$s.qsa)(e,"item"),s=Array.prototype.slice.call(r);return s.forEach(function(i){var o=i.getAttribute("id"),a=i.getAttribute("href")||"",l=i.getAttribute("media-type")||"",u=i.getAttribute("media-overlay")||"",c=i.getAttribute("properties")||"";n[o]={href:a,type:l,overlay:u,properties:c.length?c.split(" "):[]}}),n}parseSpine(e,n){var r=[],s=(0,$s.qsa)(e,"itemref"),i=Array.prototype.slice.call(s);return i.forEach(function(o,a){var l=o.getAttribute("idref"),u=o.getAttribute("properties")||"",c=u.length?u.split(" "):[],h={id:o.getAttribute("id"),idref:l,linear:o.getAttribute("linear")||"yes",properties:c,index:a};r.push(h)}),r}findUniqueIdentifier(e){var n=e.documentElement.getAttribute("unique-identifier");if(!n)return"";var r=e.getElementById(n);return r&&r.localName==="identifier"&&r.namespaceURI==="http://purl.org/dc/elements/1.1/"&&r.childNodes.length>0?r.childNodes[0].nodeValue.trim():""}findNavPath(e){var n=(0,$s.qsp)(e,"item",{properties:"nav"});return n?n.getAttribute("href"):!1}findNcxPath(e,n){var r=(0,$s.qsp)(e,"item",{"media-type":"application/x-dtbncx+xml"}),s;return r||(s=n.getAttribute("toc"),s&&(r=e.querySelector(`#${s}`))),r?r.getAttribute("href"):!1}findCoverPath(e){var n=(0,$s.qs)(e,"package");n.getAttribute("version");var r=(0,$s.qsp)(e,"item",{properties:"cover-image"});if(r)return r.getAttribute("href");var s=(0,$s.qsp)(e,"meta",{name:"cover"});if(s){var i=s.getAttribute("content"),o=e.getElementById(i);return o?o.getAttribute("href"):""}else return!1}getElementText(e,n){var r=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",n),s;return!r||r.length===0?"":(s=r[0],s.childNodes.length?s.childNodes[0].nodeValue:"")}getPropertyText(e,n){var r=(0,$s.qsp)(e,"meta",{property:n});return r&&r.childNodes.length?r.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let n=e.readingOrder||e.spine;return this.spine=n.map((r,s)=>(r.index=s,r.linear=r.linear||"yes",r)),e.resources.forEach((r,s)=>{this.manifest[s]=r,r.rel&&r.rel[0]==="cover"&&(this.coverPath=r.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((r,s)=>(r.label=r.title,r)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}var fW=dW;Kg.default=fW;var Xg={};Object.defineProperty(Xg,"__esModule",{value:!0});Xg.default=void 0;var hs=je;class pW{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let n=e.nodeType,r,s;n&&(r=(0,hs.qs)(e,"html"),s=(0,hs.qs)(e,"ncx")),n?r?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):s&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var n,r=0;r<e.length;r++)n=e[r],n.href&&(this.tocByHref[n.href]=r),n.id&&(this.tocById[n.id]=r),this.length++,n.subitems.length&&this.unpack(n.subitems)}get(e){var n;return e?(e.indexOf("#")===0?n=this.tocById[e.substring(1)]:e in this.tocByHref&&(n=this.tocByHref[e]),this.getByIndex(e,n,this.toc)):this.toc}getByIndex(e,n,r){if(r.length===0)return;const s=r[n];if(s&&(e===s.id||e===s.href))return s;{let i;for(let o=0;o<r.length&&(i=this.getByIndex(e,n,r[o].subitems),!i);++o);return i}}landmark(e){var n;return e?(n=this.landmarksByType[e],this.landmarks[n]):this.landmarks}parseNav(e){var n=(0,hs.querySelectorByType)(e,"nav","toc"),r=[];if(!n)return r;let s=(0,hs.filterChildren)(n,"ol",!0);return s&&(r=this.parseNavList(s)),r}parseNavList(e,n){const r=[];if(!e||!e.children)return r;for(let s=0;s<e.children.length;s++){const i=this.navItem(e.children[s],n);i&&r.push(i)}return r}navItem(e,n){let r=e.getAttribute("id")||void 0,s=(0,hs.filterChildren)(e,"a",!0)||(0,hs.filterChildren)(e,"span",!0);if(!s)return;let i=s.getAttribute("href")||"";r||(r=i);let o=s.textContent||"",a=[],l=(0,hs.filterChildren)(e,"ol",!0);return l&&(a=this.parseNavList(l,r)),{id:r,href:i,label:o,subitems:a,parent:n}}parseLandmarks(e){var n=(0,hs.querySelectorByType)(e,"nav","landmarks"),r=n?(0,hs.qsa)(n,"li"):[],s=r.length,i,o=[],a;if(!r||s===0)return o;for(i=0;i<s;++i)a=this.landmarkItem(r[i]),a&&(o.push(a),this.landmarksByType[a.type]=i);return o}landmarkItem(e){let n=(0,hs.filterChildren)(e,"a",!0);if(!n)return;let r=n.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,s=n.getAttribute("href")||"",i=n.textContent||"";return{href:s,label:i,type:r}}parseNcx(e){var n=(0,hs.qsa)(e,"navPoint"),r=n.length,s,i={},o=[],a,l;if(!n||r===0)return o;for(s=0;s<r;++s)a=this.ncxItem(n[s]),i[a.id]=a,a.parent?(l=i[a.parent],l.subitems.push(a)):o.push(a);return o}ncxItem(e){var n=e.getAttribute("id")||!1,r=(0,hs.qs)(e,"content"),s=r.getAttribute("src"),i=(0,hs.qs)(e,"navLabel"),o=i.textContent?i.textContent:"",a=[],l=e.parentNode,u;return l&&(l.nodeName==="navPoint"||l.nodeName.split(":").slice(-1)[0]==="navPoint")&&(u=l.getAttribute("id")),{id:n,href:s,label:o,subitems:a,parent:u}}load(e){return e.map(n=>(n.label=n.title,n.subitems=n.children?this.load(n.children):[],n))}forEach(e){return this.toc.forEach(e)}}var mW=pW;Xg.default=mW;var Yg={},mc={};Object.defineProperty(mc,"__esModule",{value:!0});mc.default=void 0;var Qc={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},gW=function(){var t,e,n,r,s={};for(t in Qc)if(Qc.hasOwnProperty(t)){for(e in Qc[t])if(Qc[t].hasOwnProperty(e))if(n=Qc[t][e],typeof n=="string")s[n]=t+"/"+e;else for(r=0;r<n.length;r++)s[n[r]]=t+"/"+e}return s}(),vW="text/plain";function yW(t){return t&&gW[t.split(".").pop().toLowerCase()]||vW}var xW={lookup:yW};mc.default=xW;Object.defineProperty(Yg,"__esModule",{value:!0});Yg.default=void 0;var fE=ro,Jc=je,bW=Zg(Rl),wW=Zg(mc),pE=Zg(no),CW=Zg(Wg);function Zg(t){return t&&t.__esModule?t:{default:t}}class SW{constructor(e,n){this.settings={replacements:n&&n.replacements||"base64",archive:n&&n.archive,resolver:n&&n.resolver,request:n&&n.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(n){return e[n]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if(e.type==="application/xhtml+xml"||e.type==="text/html")return!0}),this.assets=this.resources.filter(function(e){if(e.type!=="application/xhtml+xml"&&e.type!=="text/html")return!0}),this.css=this.resources.filter(function(e){if(e.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map((function(e){return e.href}).bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var n=new bW.default(e),r=wW.default.lookup(n.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(e,"blob").then(s=>(0,Jc.blob2base64)(s)).then(s=>(0,Jc.createBase64Url)(s,r)):this.settings.request(e,"blob").then(s=>(0,Jc.createBlobUrl)(s,r))}replacements(){if(this.settings.replacements==="none")return new Promise((function(n){n(this.urls)}).bind(this));var e=this.urls.map(n=>{var r=this.settings.resolver(n);return this.createUrl(r).catch(s=>(console.error(s),null))});return Promise.all(e).then(n=>(this.replacementUrls=n.filter(r=>typeof r=="string"),n))}replaceCss(e,n){var r=[];return e=e||this.settings.archive,n=n||this.settings.resolver,this.cssUrls.forEach((function(s){var i=this.createCssFile(s,e,n).then((function(o){var a=this.urls.indexOf(s);a>-1&&(this.replacementUrls[a]=o)}).bind(this));r.push(i)}).bind(this)),Promise.all(r)}createCssFile(e){var n;if(CW.default.isAbsolute(e))return new Promise(function(o){o()});var r=this.settings.resolver(e),s;this.settings.archive?s=this.settings.archive.getText(r):s=this.settings.request(r,"text");var i=this.urls.map(o=>{var a=this.settings.resolver(o),l=new pE.default(r).relative(a);return l});return s?s.then(o=>(o=(0,fE.substitute)(o,i,this.replacementUrls),this.settings.replacements==="base64"?n=(0,Jc.createBase64Url)(o,"text/css"):n=(0,Jc.createBlobUrl)(o,"text/css"),n),o=>new Promise(function(a){a()})):new Promise(function(o){o()})}relativeTo(e,n){return n=n||this.settings.resolver,this.urls.map((function(r){var s=n(r),i=new pE.default(e).relative(s);return i}).bind(this))}get(e){var n=this.urls.indexOf(e);if(n!==-1)return this.replacementUrls.length?new Promise((function(r,s){r(this.replacementUrls[n])}).bind(this)):this.createUrl(e)}substitute(e,n){var r;return n?r=this.relativeTo(n):r=this.urls,(0,fE.substitute)(e,r,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}var kW=SW;Yg.default=kW;var Qg={};Object.defineProperty(Qg,"__esModule",{value:!0});Qg.default=void 0;var EW=IW(jr),Ds=je;function IW(t){return t&&t.__esModule?t:{default:t}}class TW{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new EW.default,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var n=(0,Ds.qs)(e,"html"),r=(0,Ds.qs)(e,"ncx");if(n)return this.parseNav(e);if(r)return this.parseNcx(e)}parseNav(e){var n=(0,Ds.querySelectorByType)(e,"nav","page-list"),r=n?(0,Ds.qsa)(n,"li"):[],s=r.length,i,o=[],a;if(!r||s===0)return o;for(i=0;i<s;++i)a=this.item(r[i]),o.push(a);return o}parseNcx(e){var n=[],r=0,s,i,o,a=0;if(i=(0,Ds.qs)(e,"pageList"),!i||(o=(0,Ds.qsa)(i,"pageTarget"),a=o.length,!o||o.length===0))return n;for(r=0;r<a;++r)s=this.ncxItem(o[r]),n.push(s);return n}ncxItem(e){var n=(0,Ds.qs)(e,"navLabel"),r=(0,Ds.qs)(n,"text"),s=r.textContent,i=(0,Ds.qs)(e,"content"),o=i.getAttribute("src"),a=parseInt(s,10);return{href:o,page:a}}item(e){var n=(0,Ds.qs)(e,"a"),r=n.getAttribute("href")||"",s=n.textContent||"",i=parseInt(s),o=r.indexOf("epubcfi"),a,l,u;return o!=-1?(a=r.split("#"),l=a[0],u=a.length>1?a[1]:!1,{cfi:u,href:r,packageUrl:l,page:i}):{href:r,page:i}}process(e){e.forEach(function(n){this.pages.push(n.page),n.cfi&&this.locations.push(n.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var n=-1;if(this.locations.length===0)return-1;var r=(0,Ds.indexOfSorted)(e,this.locations,this.epubcfi.compare);return r!=-1?n=this.pages[r]:(r=(0,Ds.locationOf)(e,this.locations,this.epubcfi.compare),n=r-1>=0?this.pages[r-1]:this.pages[0],n!==void 0||(n=-1)),n}cfiFromPage(e){var n=-1;typeof e!="number"&&(e=parseInt(e));var r=this.pages.indexOf(e);return r!=-1&&(n=this.locations[r]),n}pageFromPercentage(e){var n=Math.round(this.totalPages*e);return n}percentageFromPage(e){var n=(e-this.firstPage)/this.totalPages;return Math.round(n*1e3)/1e3}percentageFromCfi(e){var n=this.pageFromCfi(e),r=this.percentageFromPage(n);return r}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}var _W=TW;Qg.default=_W;var gc={},$d={};Object.defineProperty($d,"__esModule",{value:!0});$d.default=void 0;var NW=je,$W=or,DW=AW(to);function AW(t){return t&&t.__esModule?t:{default:t}}class oD{constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread=e.spread!=="none",this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,e.flow==="scrolled"||e.flow==="scrolled-continuous"||e.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return typeof e<"u"&&(e==="scrolled"||e==="scrolled-continuous"||e==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(e,n){return e&&(this._spread=e!=="none",this.update({spread:this._spread})),n>=0&&(this._minSpreadWidth=n),this._spread}calculate(e,n,r){var s=1,i=r||0,o=e,a=n,l=Math.floor(o/12),u,c,h,d;this._spread&&o>=this._minSpreadWidth?s=2:s=1,this.name==="reflowable"&&this._flow==="paginated"&&!(r>=0)&&(i=l%2===0?l:l-1),this.name==="pre-paginated"&&(i=0),s>1?(u=o/s-i,h=u+i):(u=o,h=o),this.name==="pre-paginated"&&s>1&&(o=u),c=u*s+i,d=o,this.width=o,this.height=a,this.spreadWidth=c,this.pageWidth=h,this.delta=d,this.columnWidth=u,this.gap=i,this.divisor=s,this.update({width:o,height:a,spreadWidth:c,pageWidth:h,delta:d,columnWidth:u,gap:i,divisor:s})}format(e,n,r){var s;return this.name==="pre-paginated"?s=e.fit(this.columnWidth,this.height,n):this._flow==="paginated"?s=e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):r&&r==="horizontal"?s=e.size(null,this.height):s=e.size(this.width,null),s}count(e,n){let r,s;return this.name==="pre-paginated"?(r=1,s=1):this._flow==="paginated"?(n=n||this.delta,r=Math.ceil(e/n),s=r*this.divisor):(n=n||this.height,r=Math.ceil(e/n),s=r),{spreads:r,pages:s}}update(e){if(Object.keys(e).forEach(n=>{this.props[n]===e[n]&&delete e[n]}),Object.keys(e).length>0){let n=(0,NW.extend)(this.props,e);this.emit($W.EVENTS.LAYOUT.UPDATED,n,e)}}}(0,DW.default)(oD.prototype);var RW=oD;$d.default=RW;var Jg={};Object.defineProperty(Jg,"__esModule",{value:!0});Jg.default=void 0;var OW=FW(Rl);function FW(t){return t&&t.__esModule?t:{default:t}}class LW{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(e){if(e){if(typeof e=="string")return this.registerUrl("default",e);if(typeof e=="object")return this.registerRules("default",e)}}registerThemes(e){for(var n in e)e.hasOwnProperty(n)&&(typeof e[n]=="string"?this.registerUrl(n,e[n]):this.registerRules(n,e[n]))}registerCss(e,n){this._themes[e]={serialized:n},(this._injected[e]||e=="default")&&this.update(e)}registerUrl(e,n){var r=new OW.default(n);this._themes[e]={url:r.toString()},(this._injected[e]||e=="default")&&this.update(e)}registerRules(e,n){this._themes[e]={rules:n},(this._injected[e]||e=="default")&&this.update(e)}select(e){var n=this._current,r;this._current=e,this.update(e),r=this.rendition.getContents(),r.forEach(s=>{s.removeClass(n),s.addClass(e)})}update(e){var n=this.rendition.getContents();n.forEach(r=>{this.add(e,r)})}inject(e){var n=[],r=this._themes,s;for(var i in r)r.hasOwnProperty(i)&&(i===this._current||i==="default")&&(s=r[i],(s.rules&&Object.keys(s.rules).length>0||s.url&&n.indexOf(s.url)===-1)&&this.add(i,e),this._injected.push(i));this._current!="default"&&e.addClass(this._current)}add(e,n){var r=this._themes[e];!r||!n||(r.url?n.addStylesheet(r.url):r.serialized?(n.addStylesheetCss(r.serialized,e),r.injected=!0):r.rules&&(n.addStylesheetRules(r.rules,e),r.injected=!0))}override(e,n,r){var s=this.rendition.getContents();this._overrides[e]={value:n,priority:r===!0},s.forEach(i=>{i.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var n=this.rendition.getContents();delete this._overrides[e],n.forEach(r=>{r.css(e)})}overrides(e){var n=this._overrides;for(var r in n)n.hasOwnProperty(r)&&e.css(r,n[r].value,n[r].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}var PW=LW;Jg.default=PW;var Fl={},Dd={};Object.defineProperty(Dd,"__esModule",{value:!0});Dd.default=void 0;var Tp=MW(jr),mE=je;function MW(t){return t&&t.__esModule?t:{default:t}}class BW{constructor(e,n,r,s=!1){this.layout=e,this.horizontal=r==="horizontal",this.direction=n||"ltr",this._dev=s}section(e){var n=this.findRanges(e),r=this.rangeListToCfiList(e.section.cfiBase,n);return r}page(e,n,r,s){var i=e&&e.document?e.document.body:!1,o;if(i){if(o=this.rangePairToCfiPair(n,{start:this.findStart(i,r,s),end:this.findEnd(i,r,s)}),this._dev===!0){let a=e.document,l=new Tp.default(o.start).toRange(a),u=new Tp.default(o.end).toRange(a),c=a.defaultView.getSelection(),h=a.createRange();c.removeAllRanges(),h.setStart(l.startContainer,l.startOffset),h.setEnd(u.endContainer,u.endOffset),c.addRange(h)}return o}}walk(e,n){if(!(e&&e.nodeType===Node.TEXT_NODE)){var r={acceptNode:function(l){return l.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},s=r.acceptNode;s.acceptNode=r.acceptNode;for(var i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,s,!1),o,a;(o=i.nextNode())&&(a=n(o),!a););return a}}findRanges(e){for(var n=[],r=e.contents.scrollWidth(),s=Math.ceil(r/this.layout.spreadWidth),i=s*this.layout.divisor,o=this.layout.columnWidth,a=this.layout.gap,l,u,c=0;c<i.pages;c++)l=(o+a)*c,u=o*(c+1)+a*c,n.push({start:this.findStart(e.document.body,l,u),end:this.findEnd(e.document.body,l,u)});return n}findStart(e,n,r){for(var s=[e],i,o,a=e;s.length;)if(i=s.shift(),o=this.walk(i,l=>{var u,c,h,d,f;if(f=(0,mE.nodeBounds)(l),this.horizontal&&this.direction==="ltr"){if(u=this.horizontal?f.left:f.top,c=this.horizontal?f.right:f.bottom,u>=n&&u<=r)return l;if(c>n)return l;a=l,s.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(u=f.left,c=f.right,c<=r&&c>=n)return l;if(u<r)return l;a=l,s.push(l)}else{if(h=f.top,d=f.bottom,h>=n&&h<=r)return l;if(d>n)return l;a=l,s.push(l)}}),o)return this.findTextStartRange(o,n,r);return this.findTextStartRange(a,n,r)}findEnd(e,n,r){for(var s=[e],i,o=e,a;s.length;)if(i=s.shift(),a=this.walk(i,l=>{var u,c,h,d,f;if(f=(0,mE.nodeBounds)(l),this.horizontal&&this.direction==="ltr"){if(u=Math.round(f.left),c=Math.round(f.right),u>r&&o)return o;if(c>r)return l;o=l,s.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(u=Math.round(this.horizontal?f.left:f.top),c=Math.round(this.horizontal?f.right:f.bottom),c<n&&o)return o;if(u<n)return l;o=l,s.push(l)}else{if(h=Math.round(f.top),d=Math.round(f.bottom),h>r&&o)return o;if(d>r)return l;o=l,s.push(l)}}),a)return this.findTextEndRange(a,n,r);return this.findTextEndRange(o,n,r)}findTextStartRange(e,n,r){for(var s=this.splitTextNodeIntoRanges(e),i,o,a,l,u,c=0;c<s.length;c++)if(i=s[c],o=i.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(a=o.left,a>=n)return i}else if(this.horizontal&&this.direction==="rtl"){if(u=o.right,u<=r)return i}else if(l=o.top,l>=n)return i;return s[0]}findTextEndRange(e,n,r){for(var s=this.splitTextNodeIntoRanges(e),i,o,a,l,u,c,h,d=0;d<s.length;d++){if(o=s[d],a=o.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(l=a.left,u=a.right,l>r&&i)return i;if(u>r)return o}else if(this.horizontal&&this.direction==="rtl"){if(l=a.left,u=a.right,u<n&&i)return i;if(l<n)return o}else{if(c=a.top,h=a.bottom,c>r&&i)return i;if(h>r)return o}i=o}return s[s.length-1]}splitTextNodeIntoRanges(e,n){var r=[],s=e.textContent||"",i=s.trim(),o,a=e.ownerDocument,l=n||" ",u=i.indexOf(l);if(u===-1||e.nodeType!=Node.TEXT_NODE)return o=a.createRange(),o.selectNodeContents(e),[o];for(o=a.createRange(),o.setStart(e,0),o.setEnd(e,u),r.push(o),o=!1;u!=-1;)u=i.indexOf(l,u+1),u>0&&(o&&(o.setEnd(e,u),r.push(o)),o=a.createRange(),o.setStart(e,u+1));return o&&(o.setEnd(e,i.length),r.push(o)),r}rangePairToCfiPair(e,n){var r=n.start,s=n.end;r.collapse(!0),s.collapse(!1);let i=new Tp.default(r,e).toString(),o=new Tp.default(s,e).toString();return{start:i,end:o}}rangeListToCfiList(e,n){for(var r=[],s,i=0;i<n.length;i++)s=this.rangePairToCfiPair(e,n[i]),r.push(s);return r}axis(e){return e&&(this.horizontal=e==="horizontal"),this.horizontal}}var zW=BW;Dd.default=zW;Object.defineProperty(Fl,"__esModule",{value:!0});Fl.default=void 0;var UW=pw(to),ni=je,iu=pw(jr),gE=pw(Dd),VW=ro,io=or;function pw(t){return t&&t.__esModule?t:{default:t}}const aD=typeof navigator<"u",WW=aD&&/Chrome/.test(navigator.userAgent),vE=aD&&!WW&&/AppleWebKit/.test(navigator.userAgent),GW=1;class lD{constructor(e,n,r,s){this.epubcfi=new iu.default,this.document=e,this.documentElement=this.document.documentElement,this.content=n||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=s||0,this.cfiBase=r||"",this.epubReadingSystem("epub.js",io.EPUBJS_VERSION),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return io.DOM_EVENTS}width(e){var n=this.content;return e&&(0,ni.isNumber)(e)&&(e=e+"px"),e&&(n.style.width=e),parseInt(this.window.getComputedStyle(n).width)}height(e){var n=this.content;return e&&(0,ni.isNumber)(e)&&(e=e+"px"),e&&(n.style.height=e),parseInt(this.window.getComputedStyle(n).height)}contentWidth(e){var n=this.content||this.document.body;return e&&(0,ni.isNumber)(e)&&(e=e+"px"),e&&(n.style.width=e),parseInt(this.window.getComputedStyle(n).width)}contentHeight(e){var n=this.content||this.document.body;return e&&(0,ni.isNumber)(e)&&(e=e+"px"),e&&(n.style.height=e),parseInt(this.window.getComputedStyle(n).height)}textWidth(){let e,n,r=this.document.createRange(),s=this.content||this.document.body,i=(0,ni.borders)(s);return r.selectNodeContents(s),e=r.getBoundingClientRect(),n=e.width,i&&i.width&&(n+=i.width),Math.round(n)}textHeight(){let e,n,r=this.document.createRange(),s=this.content||this.document.body;return r.selectNodeContents(s),e=r.getBoundingClientRect(),n=e.bottom,Math.round(n)}scrollWidth(){var e=this.documentElement.scrollWidth;return e}scrollHeight(){var e=this.documentElement.scrollHeight;return e}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,n,r){var s=this.content||this.document.body;return n?s.style.setProperty(e,n,r?"important":""):s.style.removeProperty(e),this.window.getComputedStyle(s)[e]}viewport(e){var n=this.document.querySelector("meta[name='viewport']"),r={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},s=[],i={};if(n&&n.hasAttribute("content")){let o=n.getAttribute("content"),a=o.match(/width\s*=\s*([^,]*)/),l=o.match(/height\s*=\s*([^,]*)/),u=o.match(/initial-scale\s*=\s*([^,]*)/),c=o.match(/minimum-scale\s*=\s*([^,]*)/),h=o.match(/maximum-scale\s*=\s*([^,]*)/),d=o.match(/user-scalable\s*=\s*([^,]*)/);a&&a.length&&typeof a[1]<"u"&&(r.width=a[1]),l&&l.length&&typeof l[1]<"u"&&(r.height=l[1]),u&&u.length&&typeof u[1]<"u"&&(r.scale=u[1]),c&&c.length&&typeof c[1]<"u"&&(r.minimum=c[1]),h&&h.length&&typeof h[1]<"u"&&(r.maximum=h[1]),d&&d.length&&typeof d[1]<"u"&&(r.scalable=d[1])}return i=(0,ni.defaults)(e||{},r),e&&(i.width&&s.push("width="+i.width),i.height&&s.push("height="+i.height),i.scale&&s.push("initial-scale="+i.scale),i.scalable==="no"?(s.push("minimum-scale="+i.scale),s.push("maximum-scale="+i.scale),s.push("user-scalable="+i.scalable)):(i.scalable&&s.push("user-scalable="+i.scalable),i.minimum&&s.push("minimum-scale="+i.minimum),i.maximum&&s.push("minimum-scale="+i.maximum)),n||(n=this.document.createElement("meta"),n.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(n)),n.setAttribute("content",s.join(", ")),this.window.scrollTo(0,0)),i}expand(){this.emit(io.EVENTS.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver>"u"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),n=this.textHeight();(e!=this._size.width||n!=this._size.height)&&(this._size={width:e,height:n},this.onResize&&this.onResize(this._size),this.emit(io.EVENTS.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,n=(function(a){a.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}).bind(this),r=0;r<e.length;r+=1){var s;try{s=e[r].cssRules}catch{return}if(!s)return;for(var i=0;i<s.length;i+=1)if(s[i].media){var o=this.window.matchMedia(s[i].media.mediaText);o.addListener(n)}}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(n=>{this.resizeCheck()});let e={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,e)}imageLoadListeners(){for(var e=this.document.querySelectorAll("img"),n,r=0;r<e.length;r++)n=e[r],typeof n.naturalWidth<"u"&&n.naturalWidth===0&&(n.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then((function(){this.resizeCheck()}).bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,n){var r,s={left:0,top:0};if(!this.document)return s;if(this.epubcfi.isCfiString(e)){let i=new iu.default(e).toRange(this.document,n);if(i){try{if(!i.endContainer||i.startContainer==i.endContainer&&i.startOffset==i.endOffset){let o=i.startContainer.textContent.indexOf(" ",i.startOffset);o==-1&&(o=i.startContainer.textContent.length),i.setEnd(i.startContainer,o)}}catch(o){console.error("setting end offset to start container length failed",o)}if(i.startContainer.nodeType===Node.ELEMENT_NODE)r=i.startContainer.getBoundingClientRect(),s.left=r.left,s.top=r.top;else if(vE){let o=i.startContainer,a=new Range;try{o.nodeType===GW?r=o.getBoundingClientRect():i.startOffset+2<o.length?(a.setStart(o,i.startOffset),a.setEnd(o,i.startOffset+2),r=a.getBoundingClientRect()):i.startOffset-2>0?(a.setStart(o,i.startOffset-2),a.setEnd(o,i.startOffset),r=a.getBoundingClientRect()):r=o.parentNode.getBoundingClientRect()}catch(l){console.error(l,l.stack)}}else r=i.getBoundingClientRect()}}else if(typeof e=="string"&&e.indexOf("#")>-1){let i=e.substring(e.indexOf("#")+1),o=this.document.getElementById(i);if(o)if(vE){let a=new Range;a.selectNode(o),r=a.getBoundingClientRect()}else r=o.getBoundingClientRect()}return r&&(s.left=r.left,s.top=r.top),s}addStylesheet(e){return new Promise((function(n,r){var s,i=!1;if(!this.document){n(!1);return}if(s=this.document.querySelector("link[href='"+e+"']"),s){n(!0);return}s=this.document.createElement("link"),s.type="text/css",s.rel="stylesheet",s.href=e,s.onload=s.onreadystatechange=function(){!i&&(!this.readyState||this.readyState=="complete")&&(i=!0,setTimeout(()=>{n(!0)},1))},this.document.head.appendChild(s)}).bind(this))}_getStylesheetNode(e){var n;return e="epubjs-inserted-css-"+(e||""),this.document?(n=this.document.getElementById(e),n||(n=this.document.createElement("style"),n.id=e,this.document.head.appendChild(n)),n):!1}addStylesheetCss(e,n){if(!this.document||!e)return!1;var r;return r=this._getStylesheetNode(n),r.innerHTML=e,!0}addStylesheetRules(e,n){var r;if(!(!this.document||!e||e.length===0))if(r=this._getStylesheetNode(n).sheet,Object.prototype.toString.call(e)==="[object Array]")for(var s=0,i=e.length;s<i;s++){var o=1,a=e[s],l=e[s][0],u="";Object.prototype.toString.call(a[1][0])==="[object Array]"&&(a=a[1],o=0);for(var c=a.length;o<c;o++){var h=a[o];u+=h[0]+":"+h[1]+(h[2]?" !important":"")+`;
`}r.insertRule(l+"{"+u+"}",r.cssRules.length)}else Object.keys(e).forEach(f=>{const m=e[f];if(Array.isArray(m))m.forEach(v=>{const g=Object.keys(v).map(y=>`${y}:${v[y]}`).join(";");r.insertRule(`${f}{${g}}`,r.cssRules.length)});else{const p=Object.keys(m).map(g=>`${g}:${m[g]}`).join(";");r.insertRule(`${f}{${p}}`,r.cssRules.length)}})}addScript(e){return new Promise((function(n,r){var s,i=!1;if(!this.document){n(!1);return}s=this.document.createElement("script"),s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){!i&&(!this.readyState||this.readyState=="complete")&&(i=!0,setTimeout(function(){n(!0)},1))},this.document.head.appendChild(s)}).bind(this))}addClass(e){var n;this.document&&(n=this.content||this.document.body,n&&n.classList.add(e))}removeClass(e){var n;this.document&&(n=this.content||this.document.body,n&&n.classList.remove(e))}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),io.DOM_EVENTS.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){this.document&&(io.DOM_EVENTS.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout((function(){var n=this.window.getSelection();this.triggerSelectedEvent(n)}).bind(this),250)}triggerSelectedEvent(e){var n,r;e&&e.rangeCount>0&&(n=e.getRangeAt(0),n.collapsed||(r=new iu.default(n,this.cfiBase).toString(),this.emit(io.EVENTS.CONTENTS.SELECTED,r),this.emit(io.EVENTS.CONTENTS.SELECTED_RANGE,n)))}range(e,n){var r=new iu.default(e);return r.toRange(this.document,n)}cfiFromRange(e,n){return new iu.default(e,this.cfiBase,n).toString()}cfiFromNode(e,n){return new iu.default(e,this.cfiBase,n).toString()}map(e){var n=new gE.default(e);return n.section()}size(e,n){var r={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),r.width=e,this.css("padding","0 "+e/12+"px")),n>=0&&(this.height(n),r.height=n),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(r)}columns(e,n,r,s,i){let o=(0,ni.prefixed)("column-axis"),a=(0,ni.prefixed)("column-gap"),l=(0,ni.prefixed)("column-width"),u=(0,ni.prefixed)("column-fill"),h=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),i==="rtl"&&h==="horizontal"&&this.direction(i),this.width(e),this.height(n),this.viewport({width:e,height:n,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),h==="vertical"?(this.css("padding-top",s/2+"px",!0),this.css("padding-bottom",s/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(o,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",s/2+"px",!0),this.css("padding-right",s/2+"px",!0),this.css(o,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(u,"auto"),this.css(a,s+"px"),this.css(l,r+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,n,r){var s="scale("+e+")",i="";this.css("transform-origin","top left"),(n>=0||r>=0)&&(i=" translate("+(n||0)+"px, "+(r||0)+"px )"),this.css("transform",s+i)}fit(e,n,r){var s=this.viewport(),i=parseInt(s.width),o=parseInt(s.height),a=e/i,l=n/o,u=a<l?a:l;if(this.layoutStyle("paginated"),this.width(i),this.height(o),this.overflow("hidden"),this.scaler(u,0,0),this.css("background-size",i*u+"px "+o*u+"px"),this.css("background-color","transparent"),r&&r.properties.includes("page-spread-left")){var c=e-i*u;this.css("margin-left",c+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,n,r,s,i){var o=new gE.default(n,i);return o.page(this,e,r,s)}linksHandler(){(0,VW.replaceLinks)(this.content,e=>{this.emit(io.EVENTS.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let n=(0,ni.prefixed)("writing-mode");return e&&this.documentElement&&(this.documentElement.style[n]=e),this.window.getComputedStyle(this.documentElement)[n]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,n){return navigator.epubReadingSystem={name:e,version:n,layoutStyle:this.layoutStyle(),hasFeature:function(r){switch(r){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}(0,UW.default)(lD.prototype);var jW=lD;Fl.default=jW;var e0={};Object.defineProperty(e0,"__esModule",{value:!0});e0.default=void 0;var HW=uD(to),qW=uD(jr),yE=or;function uD(t){return t&&t.__esModule?t:{default:t}}class KW{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,n,r,s,i,o){let a=encodeURI(n+e),u=new qW.default(n).spinePos,c=new cD({type:e,cfiRange:n,data:r,sectionIndex:u,cb:s,className:i,styles:o});return this._annotations[a]=c,u in this._annotationsBySectionIndex?this._annotationsBySectionIndex[u].push(a):this._annotationsBySectionIndex[u]=[a],this.rendition.views().forEach(d=>{c.sectionIndex===d.index&&c.attach(d)}),c}remove(e,n){let r=encodeURI(e+n);if(r in this._annotations){let s=this._annotations[r];if(n&&s.type!==n)return;this.rendition.views().forEach(o=>{this._removeFromAnnotationBySectionIndex(s.sectionIndex,r),s.sectionIndex===o.index&&s.detach(o)}),delete this._annotations[r]}}_removeFromAnnotationBySectionIndex(e,n){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(r=>r!==n)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,n,r,s,i){return this.add("highlight",e,n,r,s,i)}underline(e,n,r,s,i){return this.add("underline",e,n,r,s,i)}mark(e,n,r){return this.add("mark",e,n,r)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let n=e.index;n in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[n].forEach(s=>{this._annotations[s].attach(e)})}clear(e){let n=e.index;n in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[n].forEach(s=>{this._annotations[s].detach(e)})}show(){}hide(){}}class cD{constructor({type:e,cfiRange:n,data:r,sectionIndex:s,cb:i,className:o,styles:a}){this.type=e,this.cfiRange=n,this.data=r,this.sectionIndex=s,this.mark=void 0,this.cb=i,this.className=o,this.styles=a}update(e){this.data=e}attach(e){let{cfiRange:n,data:r,type:s,mark:i,cb:o,className:a,styles:l}=this,u;return s==="highlight"?u=e.highlight(n,r,o,a,l):s==="underline"?u=e.underline(n,r,o,a,l):s==="mark"&&(u=e.mark(n,r,o)),this.mark=u,this.emit(yE.EVENTS.ANNOTATION.ATTACH,u),u}detach(e){let{cfiRange:n,type:r}=this,s;return e&&(r==="highlight"?s=e.unhighlight(n):r==="underline"?s=e.ununderline(n):r==="mark"&&(s=e.unmark(n))),this.mark=void 0,this.emit(yE.EVENTS.ANNOTATION.DETACH,s),s}text(){}}(0,HW.default)(cD.prototype);var XW=KW;e0.default=XW;var Ad={},Bi={},t0={};Object.defineProperty(t0,"__esModule",{value:!0});t0.createElement=hD;function hD(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}t0.default={createElement:hD};var Rd={};Object.defineProperty(Rd,"__esModule",{value:!0});Rd.proxyMouse=dD;Rd.clone=fD;Rd.default={proxyMouse:dD};function dD(t,e){function n(o){for(var a=e.length-1;a>=0;a--){var l=e[a],u=o.clientX,c=o.clientY;if(o.touches&&o.touches.length&&(u=o.touches[0].clientX,c=o.touches[0].clientY),!!YW(l,t,u,c)){l.dispatchEvent(fD(o));break}}}if(t.nodeName==="iframe"||t.nodeName==="IFRAME")try{this.target=t.contentDocument}catch{this.target=t}else this.target=t;for(var r=["mouseup","mousedown","click","touchstart"],s=0;s<r.length;s++){var i=r[s];this.target.addEventListener(i,function(o){return n(o)},!1)}}function fD(t){var e=Object.assign({},t,{bubbles:!1});try{return new MouseEvent(t.type,e)}catch{var n=document.createEvent("MouseEvents");return n.initMouseEvent(t.type,!1,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),n}}function YW(t,e,n,r){var s=e.getBoundingClientRect();function i(c,h,d){var f=c.top-s.top,m=c.left-s.left,v=f+c.height,p=m+c.width;return f<=d&&m<=h&&v>d&&p>h}var o=t.getBoundingClientRect();if(!i(o,n,r))return!1;for(var a=t.getClientRects(),l=0,u=a.length;l<u;l++)if(i(a[l],n,r))return!0;return!1}Object.defineProperty(Bi,"__esModule",{value:!0});Bi.Underline=Bi.Highlight=Bi.Mark=Bi.Pane=void 0;var ZW=function t(e,n,r){e===null&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,n);if(s===void 0){var i=Object.getPrototypeOf(e);return i===null?void 0:t(i,n,r)}else{if("value"in s)return s.value;var o=s.get;return o===void 0?void 0:o.call(r)}},n0=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),QW=t0,nd=pD(QW),JW=Rd,e8=pD(JW);function pD(t){return t&&t.__esModule?t:{default:t}}function mD(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function gD(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function r0(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Bi.Pane=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;r0(this,t),this.target=e,this.element=nd.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),e8.default.proxyMouse(this.target,this.marks),this.container=n,this.container.appendChild(this.element),this.render()}return n0(t,[{key:"addMark",value:function(n){var r=nd.default.createElement("g");return this.element.appendChild(r),n.bind(r,this.container),this.marks.push(n),n.render(),n}},{key:"removeMark",value:function(n){var r=this.marks.indexOf(n);if(r!==-1){var s=n.unbind();this.element.removeChild(s),this.marks.splice(r,1)}}},{key:"render",value:function(){s8(this.element,r8(this.target,this.container));var n=!0,r=!1,s=void 0;try{for(var i=this.marks[Symbol.iterator](),o;!(n=(o=i.next()).done);n=!0){var a=o.value;a.render()}}catch(l){r=!0,s=l}finally{try{!n&&i.return&&i.return()}finally{if(r)throw s}}}}]),t}();var t8=Bi.Mark=function(){function t(){r0(this,t),this.element=null}return n0(t,[{key:"bind",value:function(n,r){this.element=n,this.container=r}},{key:"unbind",value:function(){var n=this.element;return this.element=null,n}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(n){this.element&&this.element.dispatchEvent(n)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var n=[],r=this.element.firstChild;r;)n.push(r.getBoundingClientRect()),r=r.nextSibling;return n}},{key:"filteredRanges",value:function(){var n=Array.from(this.range.getClientRects());return n.filter(function(r){for(var s=0;s<n.length;s++){if(n[s]===r)return!0;var i=i8(n[s],r);if(i)return!1}return!0})}}]),t}(),n8=Bi.Highlight=function(t){gD(e,t);function e(n,r,s,i){r0(this,e);var o=mD(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.range=n,o.className=r,o.data=s||{},o.attributes=i||{},o}return n0(e,[{key:"bind",value:function(r,s){ZW(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bind",this).call(this,r,s);for(var i in this.data)this.data.hasOwnProperty(i)&&(this.element.dataset[i]=this.data[i]);for(var i in this.attributes)this.attributes.hasOwnProperty(i)&&this.element.setAttribute(i,this.attributes[i]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var r=this.element.ownerDocument.createDocumentFragment(),s=this.filteredRanges(),i=this.element.getBoundingClientRect(),o=this.container.getBoundingClientRect(),a=0,l=s.length;a<l;a++){var u=s[a],c=nd.default.createElement("rect");c.setAttribute("x",u.left-i.left+o.left),c.setAttribute("y",u.top-i.top+o.top),c.setAttribute("height",u.height),c.setAttribute("width",u.width),r.appendChild(c)}this.element.appendChild(r)}}]),e}(t8);Bi.Underline=function(t){gD(e,t);function e(n,r,s,i){return r0(this,e),mD(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,r,s,i))}return n0(e,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var r=this.element.ownerDocument.createDocumentFragment(),s=this.filteredRanges(),i=this.element.getBoundingClientRect(),o=this.container.getBoundingClientRect(),a=0,l=s.length;a<l;a++){var u=s[a],c=nd.default.createElement("rect");c.setAttribute("x",u.left-i.left+o.left),c.setAttribute("y",u.top-i.top+o.top),c.setAttribute("height",u.height),c.setAttribute("width",u.width),c.setAttribute("fill","none");var h=nd.default.createElement("line");h.setAttribute("x1",u.left-i.left+o.left),h.setAttribute("x2",u.left-i.left+o.left+u.width),h.setAttribute("y1",u.top-i.top+o.top+u.height-1),h.setAttribute("y2",u.top-i.top+o.top+u.height-1),h.setAttribute("stroke-width",1),h.setAttribute("stroke","black"),h.setAttribute("stroke-linecap","square"),r.appendChild(c),r.appendChild(h)}this.element.appendChild(r)}}]),e}(n8);function r8(t,e){var n=e.getBoundingClientRect(),r=t.getBoundingClientRect();return{top:r.top-n.top,left:r.left-n.left,height:t.scrollHeight,width:t.scrollWidth}}function s8(t,e){t.style.setProperty("top",e.top+"px","important"),t.style.setProperty("left",e.left+"px","important"),t.style.setProperty("height",e.height+"px","important"),t.style.setProperty("width",e.width+"px","important")}function i8(t,e){return e.right<=t.right&&e.left>=t.left&&e.top>=t.top&&e.bottom<=t.bottom}Object.defineProperty(Ad,"__esModule",{value:!0});Ad.default=void 0;var o8=mw(to),dr=je,a8=mw(jr),l8=mw(Fl),ds=or,_p=Bi;function mw(t){return t&&t.__esModule?t:{default:t}}class vD{constructor(e,n){this.settings=(0,dr.extend)({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},n||{}),this.id="epubjs-view-"+(0,dr.uuid)(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new a8.default,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var n=document.createElement("div");return n.classList.add("epub-view"),n.style.height="0px",n.style.width="0px",n.style.overflow="hidden",n.style.position="relative",n.style.display="block",e&&e=="horizontal"?n.style.flex="none":n.style.flex="initial",n}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=(0,dr.bounds)(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(e,n){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then((function(r){return this.load(r)}).bind(this)).then((function(){let r=this.contents.writingMode(),s;return this.settings.flow==="scrolled"?s=r.indexOf("vertical")===0?"horizontal":"vertical":s=r.indexOf("vertical")===0?"vertical":"horizontal",r.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(s),this.emit(ds.EVENTS.VIEWS.AXIS,s),this.setWritingMode(r),this.emit(ds.EVENTS.VIEWS.WRITING_MODE,r),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((i,o)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),i()})}).bind(this),(function(r){return this.emit(ds.EVENTS.VIEWS.LOAD_ERROR,r),new Promise((s,i)=>{i(r)})}).bind(this)).then((function(){this.emit(ds.EVENTS.VIEWS.RENDERED,this.section)}).bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,n){var r=e||this.settings.width,s=n||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",r,s):this.settings.axis==="horizontal"?this.lock("height",r,s):this.lock("width",r,s),this.settings.width=r,this.settings.height=s}lock(e,n,r){var s=(0,dr.borders)(this.element),i;this.iframe?i=(0,dr.borders)(this.iframe):i={width:0,height:0},e=="width"&&(0,dr.isNumber)(n)&&(this.lockedWidth=n-s.width-i.width),e=="height"&&(0,dr.isNumber)(r)&&(this.lockedHeight=r-s.height-i.height),e==="both"&&(0,dr.isNumber)(n)&&(0,dr.isNumber)(r)&&(this.lockedWidth=n-s.width-i.width,this.lockedHeight=r-s.height-i.height),this.displayed&&this.iframe&&this.expand()}expand(e){var n=this.lockedWidth,r=this.lockedHeight,s;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(n=this.layout.columnWidth,r=this.layout.height):this.settings.axis==="horizontal"?(n=this.contents.textWidth(),n%this.layout.pageWidth>0&&(n=Math.ceil(n/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(s=n/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&s%2>0&&(n+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(r=this.contents.textHeight(),this.settings.flow==="paginated"&&r%this.layout.height>0&&(r=Math.ceil(r/this.layout.height)*this.layout.height)),(this._needsReframe||n!=this._width||r!=this._height)&&this.reframe(n,r),this._expanding=!1)}reframe(e,n){var r;(0,dr.isNumber)(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),(0,dr.isNumber)(n)&&(this.element.style.height=n+"px",this.iframe.style.height=n+"px",this._height=n);let s=this.prevBounds?e-this.prevBounds.width:e,i=this.prevBounds?n-this.prevBounds.height:n;r={width:e,height:n,widthDelta:s,heightDelta:i},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let o;for(let a in this.marks)this.marks.hasOwnProperty(a)&&(o=this.marks[a],this.placeMark(o.element,o.range))}),this.onResize(this,r),this.emit(ds.EVENTS.VIEWS.RESIZED,r),this.prevBounds=r,this.elementBounds=(0,dr.bounds)(this.element)}load(e){var n=new dr.defer,r=n.promise;if(!this.iframe)return n.reject(new Error("No Iframe Available")),r;if(this.iframe.onload=(function(i){this.onLoad(i,n)}).bind(this),this.settings.method==="blobUrl")this.blobUrl=(0,dr.createBlobUrl)(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return n.reject(new Error("No Document Available")),r;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var s=this;MSApp.execUnsafeLocalFunction(function(){s.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return r}onLoad(e,n){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new l8.default(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var r=this.document.querySelector("link[rel='canonical']");r?r.setAttribute("href",this.section.canonical):(r=this.document.createElement("link"),r.setAttribute("rel","canonical"),r.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(r)),this.contents.on(ds.EVENTS.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(ds.EVENTS.CONTENTS.RESIZE,s=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),n.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,e=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var n=new dr.defer;return this.displayed?n.resolve(this):this.render(e).then((function(){this.emit(ds.EVENTS.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,n.resolve(this)}).bind(this),function(r){n.reject(r,this)}),n.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(ds.EVENTS.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(ds.EVENTS.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var n=this.contents.locationOf(e,this.settings.ignoreClass);return{left:n.left,top:n.top}}onDisplayed(e){}onResize(e,n){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=(0,dr.bounds)(this.element)),this.elementBounds}highlight(e,n={},r,s="epubjs-hl",i={}){if(!this.contents)return;const o=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},i);let a=this.contents.range(e),l=()=>{this.emit(ds.EVENTS.VIEWS.MARK_CLICKED,e,n)};n.epubcfi=e,this.pane||(this.pane=new _p.Pane(this.iframe,this.element));let u=new _p.Highlight(a,s,n,o),c=this.pane.addMark(u);return this.highlights[e]={mark:c,element:c.element,listeners:[l,r]},c.element.setAttribute("ref",s),c.element.addEventListener("click",l),c.element.addEventListener("touchstart",l),r&&(c.element.addEventListener("click",r),c.element.addEventListener("touchstart",r)),c}underline(e,n={},r,s="epubjs-ul",i={}){if(!this.contents)return;const o=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},i);let a=this.contents.range(e),l=()=>{this.emit(ds.EVENTS.VIEWS.MARK_CLICKED,e,n)};n.epubcfi=e,this.pane||(this.pane=new _p.Pane(this.iframe,this.element));let u=new _p.Underline(a,s,n,o),c=this.pane.addMark(u);return this.underlines[e]={mark:c,element:c.element,listeners:[l,r]},c.element.setAttribute("ref",s),c.element.addEventListener("click",l),c.element.addEventListener("touchstart",l),r&&(c.element.addEventListener("click",r),c.element.addEventListener("touchstart",r)),c}mark(e,n={},r){if(!this.contents)return;if(e in this.marks)return this.marks[e];let s=this.contents.range(e);if(!s)return;let i=s.commonAncestorContainer,o=i.nodeType===1?i:i.parentNode,a=u=>{this.emit(ds.EVENTS.VIEWS.MARK_CLICKED,e,n)};s.collapsed&&i.nodeType===1?(s=new Range,s.selectNodeContents(i)):s.collapsed&&(s=new Range,s.selectNodeContents(o));let l=this.document.createElement("a");return l.setAttribute("ref","epubjs-mk"),l.style.position="absolute",l.dataset.epubcfi=e,n&&Object.keys(n).forEach(u=>{l.dataset[u]=n[u]}),r&&(l.addEventListener("click",r),l.addEventListener("touchstart",r)),l.addEventListener("click",a),l.addEventListener("touchstart",a),this.placeMark(l,s),this.element.appendChild(l),this.marks[e]={element:l,range:s,listeners:[a,r]},o}placeMark(e,n){let r,s,i;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let a=n.getBoundingClientRect();r=a.top,s=a.right}else{let a=n.getClientRects(),l;for(var o=0;o!=a.length;o++)l=a[o],(!i||l.left<i)&&(i=l.left,s=Math.ceil(i/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,r=l.top)}e.style.top=`${r}px`,e.style.left=`${s}px`}unhighlight(e){let n;e in this.highlights&&(n=this.highlights[e],this.pane.removeMark(n.mark),n.listeners.forEach(r=>{r&&(n.element.removeEventListener("click",r),n.element.removeEventListener("touchstart",r))}),delete this.highlights[e])}ununderline(e){let n;e in this.underlines&&(n=this.underlines[e],this.pane.removeMark(n.mark),n.listeners.forEach(r=>{r&&(n.element.removeEventListener("click",r),n.element.removeEventListener("touchstart",r))}),delete this.underlines[e])}unmark(e){let n;e in this.marks&&(n=this.marks[e],this.element.removeChild(n.element),n.listeners.forEach(r=>{r&&(n.element.removeEventListener("click",r),n.element.removeEventListener("touchstart",r))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&(0,dr.revokeBlobUrl)(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}(0,o8.default)(vD.prototype);var u8=vD;Ad.default=u8;var vc={},s0={};Object.defineProperty(s0,"__esModule",{value:!0});s0.createDefiner=yD;s0.default=c8;function c8(){var t="reverse",e=yD();return document.body.appendChild(e),e.scrollLeft>0?t="default":typeof Element<"u"&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(t="negative")):(e.scrollLeft=1,e.scrollLeft===0&&(t="negative")),document.body.removeChild(e),t}function yD(){var t=document.createElement("div");t.dir="rtl",t.style.position="fixed",t.style.width="1px",t.style.height="1px",t.style.top="0px",t.style.left="0px",t.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var n=document.createElement("span");n.style.width="1px",n.style.display="inline-block";var r=document.createElement("span");return r.style.width="1px",r.style.display="inline-block",e.appendChild(n),e.appendChild(r),t.appendChild(e),t}var i0={};function h8(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var gw=h8,d8=typeof yn=="object"&&yn&&yn.Object===Object&&yn,f8=d8,p8=f8,m8=typeof self=="object"&&self&&self.Object===Object&&self,g8=p8||m8||Function("return this")(),xD=g8,v8=xD,y8=function(){return v8.Date.now()},x8=y8,b8=/\s/;function w8(t){for(var e=t.length;e--&&b8.test(t.charAt(e)););return e}var C8=w8,S8=C8,k8=/^\s+/;function E8(t){return t&&t.slice(0,S8(t)+1).replace(k8,"")}var I8=E8,T8=xD,_8=T8.Symbol,bD=_8,xE=bD,wD=Object.prototype,N8=wD.hasOwnProperty,$8=wD.toString,eh=xE?xE.toStringTag:void 0;function D8(t){var e=N8.call(t,eh),n=t[eh];try{t[eh]=void 0;var r=!0}catch{}var s=$8.call(t);return r&&(e?t[eh]=n:delete t[eh]),s}var A8=D8,R8=Object.prototype,O8=R8.toString;function F8(t){return O8.call(t)}var L8=F8,bE=bD,P8=A8,M8=L8,B8="[object Null]",z8="[object Undefined]",wE=bE?bE.toStringTag:void 0;function U8(t){return t==null?t===void 0?z8:B8:wE&&wE in Object(t)?P8(t):M8(t)}var V8=U8;function W8(t){return t!=null&&typeof t=="object"}var G8=W8,j8=V8,H8=G8,q8="[object Symbol]";function K8(t){return typeof t=="symbol"||H8(t)&&j8(t)==q8}var X8=K8,Y8=I8,CE=gw,Z8=X8,SE=0/0,Q8=/^[-+]0x[0-9a-f]+$/i,J8=/^0b[01]+$/i,e6=/^0o[0-7]+$/i,t6=parseInt;function n6(t){if(typeof t=="number")return t;if(Z8(t))return SE;if(CE(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=CE(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Y8(t);var n=J8.test(t);return n||e6.test(t)?t6(t.slice(2),n?2:8):Q8.test(t)?SE:+t}var r6=n6,s6=gw,Fy=x8,kE=r6,i6="Expected a function",o6=Math.max,a6=Math.min;function l6(t,e,n){var r,s,i,o,a,l,u=0,c=!1,h=!1,d=!0;if(typeof t!="function")throw new TypeError(i6);e=kE(e)||0,s6(n)&&(c=!!n.leading,h="maxWait"in n,i=h?o6(kE(n.maxWait)||0,e):i,d="trailing"in n?!!n.trailing:d);function f(C){var S=r,E=s;return r=s=void 0,u=C,o=t.apply(E,S),o}function m(C){return u=C,a=setTimeout(g,e),c?f(C):o}function v(C){var S=C-l,E=C-u,T=e-S;return h?a6(T,i-E):T}function p(C){var S=C-l,E=C-u;return l===void 0||S>=e||S<0||h&&E>=i}function g(){var C=Fy();if(p(C))return y(C);a=setTimeout(g,v(C))}function y(C){return a=void 0,d&&r?f(C):(r=s=void 0,o)}function b(){a!==void 0&&clearTimeout(a),u=0,r=l=s=a=void 0}function x(){return a===void 0?o:y(Fy())}function w(){var C=Fy(),S=p(C);if(r=arguments,s=this,l=C,S){if(a===void 0)return m(l);if(h)return clearTimeout(a),a=setTimeout(g,e),f(l)}return a===void 0&&(a=setTimeout(g,e)),o}return w.cancel=b,w.flush=x,w}var CD=l6,u6=CD,c6=gw,h6="Expected a function";function d6(t,e,n){var r=!0,s=!0;if(typeof t!="function")throw new TypeError(h6);return c6(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),u6(t,e,{leading:r,maxWait:e,trailing:s})}var f6=d6;Object.defineProperty(i0,"__esModule",{value:!0});i0.default=void 0;var fs=je,p6=m6(f6);function m6(t){return t&&t.__esModule?t:{default:t}}class g6{constructor(e){this.settings=e||{},this.id="epubjs-container-"+(0,fs.uuid)(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let n=e.height,r=e.width,s=e.overflow||!1,i=e.axis||"vertical",o=e.direction;(0,fs.extend)(this.settings,e),e.height&&(0,fs.isNumber)(e.height)&&(n=e.height+"px"),e.width&&(0,fs.isNumber)(e.width)&&(r=e.width+"px");let a=document.createElement("div");return a.id=this.id,a.classList.add("epub-container"),a.style.wordSpacing="0",a.style.lineHeight="0",a.style.verticalAlign="top",a.style.position="relative",i==="horizontal"&&(a.style.display="flex",a.style.flexDirection="row",a.style.flexWrap="nowrap"),r&&(a.style.width=r),n&&(a.style.height=n),s&&(s==="scroll"&&i==="vertical"?(a.style["overflow-y"]=s,a.style["overflow-x"]="hidden"):s==="scroll"&&i==="horizontal"?(a.style["overflow-y"]="hidden",a.style["overflow-x"]=s):a.style.overflow=s),o&&(a.dir=o,a.style.direction=o),o&&this.settings.fullsize&&(document.body.style.direction=o),a}wrap(e){var n=document.createElement("div");return n.style.visibility="hidden",n.style.overflow="hidden",n.style.width="0",n.style.height="0",n.appendChild(e),n}getElement(e){var n;if((0,fs.isElement)(e)?n=e:typeof e=="string"&&(n=document.getElementById(e)),!n)throw new Error("Not an Element");return n}attachTo(e){var n=this.getElement(e),r;if(n)return this.settings.hidden?r=this.wrapper:r=this.container,n.appendChild(r),this.element=n,n}getContainer(){return this.container}onResize(e){(!(0,fs.isNumber)(this.settings.width)||!(0,fs.isNumber)(this.settings.height))&&(this.resizeFunc=(0,p6.default)(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,n){var r;let s=e||this.settings.width,i=n||this.settings.height;e===null?(r=this.element.getBoundingClientRect(),r.width&&(e=Math.floor(r.width),this.container.style.width=e+"px")):(0,fs.isNumber)(e)?this.container.style.width=e+"px":this.container.style.width=e,n===null?(r=r||this.element.getBoundingClientRect(),r.height&&(n=r.height,this.container.style.height=n+"px")):(0,fs.isNumber)(n)?this.container.style.height=n+"px":this.container.style.height=n,(0,fs.isNumber)(e)||(e=this.container.clientWidth),(0,fs.isNumber)(n)||(n=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let o=(0,fs.windowBounds)(),a=window.getComputedStyle(document.body),l={left:parseFloat(a["padding-left"])||0,right:parseFloat(a["padding-right"])||0,top:parseFloat(a["padding-top"])||0,bottom:parseFloat(a["padding-bottom"])||0};return s||(e=o.width-l.left-l.right),(this.settings.fullsize&&!i||!i)&&(n=o.height-l.top-l.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:n-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return this.container.style.overflow!=="visible"&&(e=this.container&&this.container.getBoundingClientRect()),!e||!e.width||!e.height?(0,fs.windowBounds)():e}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,n){var r="#"+this.id+" ",s="";this.sheet||(this.sheet=this.getSheet()),n.forEach(function(i){for(var o in i)i.hasOwnProperty(o)&&(s+=o+":"+i[o]+";")}),this.sheet.insertRule(r+e+" {"+s+"}",0)}axis(e){e==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&(e==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):e==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}var v6=g6;i0.default=v6;var o0={};Object.defineProperty(o0,"__esModule",{value:!0});o0.default=void 0;class y6{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,n){return this._views.splice(n,0,e),this.container&&(n<this.container.children.length?this.container.insertBefore(e.element,this.container.children[n]):this.container.appendChild(e.element)),this.length++,e}remove(e){var n=this._views.indexOf(e);n>-1&&this._views.splice(n,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,n=this.length;if(this.length){for(var r=0;r<n;r++)e=this._views[r],this.destroy(e);this._views=[],this.length=0}}find(e){for(var n,r=this.length,s=0;s<r;s++)if(n=this._views[s],n.displayed&&n.section.index==e.index)return n}displayed(){for(var e=[],n,r=this.length,s=0;s<r;s++)n=this._views[s],n.displayed&&e.push(n);return e}show(){for(var e,n=this.length,r=0;r<n;r++)e=this._views[r],e.displayed&&e.show();this.hidden=!1}hide(){for(var e,n=this.length,r=0;r<n;r++)e=this._views[r],e.displayed&&e.hide();this.hidden=!0}}var x6=y6;o0.default=x6;Object.defineProperty(vc,"__esModule",{value:!0});vc.default=void 0;var b6=yc(to),ou=je,w6=yc(s0),EE=yc(Dd),C6=yc(pa),S6=yc(i0),k6=yc(o0),ps=or;function yc(t){return t&&t.__esModule?t:{default:t}}class SD{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new C6.default(this),this.settings=(0,ou.extend)(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),(0,ou.extend)(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,n){let r=e.tagName;typeof this.settings.fullsize>"u"&&r&&(r.toLowerCase()=="body"||r.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=n,this.settings.rtlScrollType=(0,w6.default)(),this.stage=new S6.default({width:n.width,height:n.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new k6.default(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",(function(n){this.destroy()}).bind(this)),this.settings.fullsize?e=window:e=this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:n}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout((function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(ps.EVENTS.MANAGERS.ORIENTATION_CHANGE,n)}).bind(this),500)}onResized(e){this.resize()}resize(e,n,r){let s=this.stage.size(e,n);if(this.winBounds=(0,ou.windowBounds)(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===s.width&&this._stageSize.height===s.height||(this._stageSize=s,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(ps.EVENTS.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},r))}createView(e,n){return new this.View(e,(0,ou.extend)(this.viewSettings,{forceRight:n}))}handleNextPrePaginated(e,n,r){let s;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(e||n.index===0)return;if(s=n.next(),s&&!s.properties.includes("page-spread-left"))return r.call(this,s)}}display(e,n){var r=new ou.defer,s=r.promise;(n===e.href||(0,ou.isNumber)(n))&&(n=void 0);var i=this.views.find(e);if(i&&e&&this.layout.name!=="pre-paginated"){let a=i.offset();if(this.settings.direction==="ltr")this.scrollTo(a.left,a.top,!0);else{let l=i.width();this.scrollTo(a.left+l,a.top,!0)}if(n){let l=i.locationOf(n),u=i.width();this.moveTo(l,u)}return r.resolve(),s}this.clear();let o=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(o=!0),this.add(e,o).then((function(a){if(n){let l=a.locationOf(n),u=a.width();this.moveTo(l,u)}}).bind(this),a=>{r.reject(a)}).then((function(){return this.handleNextPrePaginated(o,e,this.add)}).bind(this)).then((function(){this.views.show(),r.resolve()}).bind(this)),s}afterDisplayed(e){this.emit(ps.EVENTS.MANAGERS.ADDED,e)}afterResized(e){this.emit(ps.EVENTS.MANAGERS.RESIZE,e.section)}moveTo(e,n){var r=0,s=0;this.isPaginated?(r=Math.floor(e.left/this.layout.delta)*this.layout.delta,r+this.layout.delta>this.container.scrollWidth&&(r=this.container.scrollWidth-this.layout.delta),s=Math.floor(e.top/this.layout.delta)*this.layout.delta,s+this.layout.delta>this.container.scrollHeight&&(s=this.container.scrollHeight-this.layout.delta)):s=e.top,this.settings.direction==="rtl"&&(r=r+this.layout.delta,r=r-n),this.scrollTo(r,s,!0)}add(e,n){var r=this.createView(e,n);return this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(ps.EVENTS.VIEWS.AXIS,s=>{this.updateAxis(s)}),r.on(ps.EVENTS.VIEWS.WRITING_MODE,s=>{this.updateWritingMode(s)}),r.display(this.request)}append(e,n){var r=this.createView(e,n);return this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(ps.EVENTS.VIEWS.AXIS,s=>{this.updateAxis(s)}),r.on(ps.EVENTS.VIEWS.WRITING_MODE,s=>{this.updateWritingMode(s)}),r.display(this.request)}prepend(e,n){var r=this.createView(e,n);return r.on(ps.EVENTS.VIEWS.RESIZED,s=>{this.counter(s)}),this.views.prepend(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(ps.EVENTS.VIEWS.AXIS,s=>{this.updateAxis(s)}),r.on(ps.EVENTS.VIEWS.WRITING_MODE,s=>{this.updateWritingMode(s)}),r.display(this.request)}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e,n;let r=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!r||r==="ltr")?(this.scrollLeft=this.container.scrollLeft,n=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,n<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&r==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(n=this.container.scrollLeft,n>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):(n=this.container.scrollLeft+this.layout.delta*-1,n>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let s=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(s=!0),this.append(e,s).then((function(){return this.handleNextPrePaginated(s,e,this.append)}).bind(this),i=>i).then((function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}).bind(this))}}prev(){var e,n;let r=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!r||r==="ltr")?(this.scrollLeft=this.container.scrollLeft,n=this.container.scrollLeft,n>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&r==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(n=this.container.scrollLeft+this.container.offsetWidth,n<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):(n=this.container.scrollLeft,n<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let s=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof e.prev()!="object"&&(s=!0),this.prepend(e,s).then((function(){var i;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(i=e.prev(),i))return this.prepend(i)}).bind(this),i=>i).then((function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}).bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),n=this.container.getBoundingClientRect(),r=n.height<window.innerHeight?n.height:window.innerHeight,s=n.width<window.innerWidth?n.width:window.innerWidth,i=this.settings.axis==="vertical";this.settings.direction;let o=0,a=0;return this.settings.fullsize&&(o=i?window.scrollY:window.scrollX),e.map(u=>{let{index:c,href:h}=u.section,d=u.position(),f=u.width(),m=u.height(),v,p,g,y;i?(v=o+n.top-d.top+a,p=v+r-a,y=this.layout.count(m,r).pages,g=r):(v=o+n.left-d.left+a,p=v+s-a,y=this.layout.count(f,s).pages,g=s);let b=Math.ceil(v/g),x=[],w=Math.ceil(p/g);if(this.settings.direction==="rtl"&&!i){let E=b;b=y-w,w=y-E}x=[];for(var C=b;C<=w;C++){let E=C+1;x.push(E)}let S=this.mapping.page(u.contents,u.section.cfiBase,v,p);return{index:c,href:h,pages:x,totalPages:y,mapping:S}})}paginatedLocation(){let e=this.visible(),n=this.container.getBoundingClientRect(),r=0,s=0;return this.settings.fullsize&&(r=window.scrollX),e.map(o=>{let{index:a,href:l}=o.section,u,c=o.position(),h=o.width(),d,f,m;this.settings.direction==="rtl"?(u=n.right-r,m=Math.min(Math.abs(u-c.left),this.layout.width)-s,f=c.width-(c.right-u)-s,d=f-m):(u=n.left+r,m=Math.min(c.right-u,this.layout.width)-s,d=u-c.left+s,f=d+m),s+=m;let v=this.mapping.page(o.contents,o.section.cfiBase,d,f),p=this.layout.count(h).pages,g=Math.floor(d/this.layout.pageWidth),y=[],b=Math.floor(f/this.layout.pageWidth);if(g<0&&(g=0,b=b+1),this.settings.direction==="rtl"){let w=g;g=p-b,b=p-w}for(var x=g+1;x<=b;x++){let w=x;y.push(w)}return{index:a,href:l,pages:y,totalPages:p,mapping:v}})}isVisible(e,n,r,s){var i=e.position(),o=s||this.bounds();return this.settings.axis==="horizontal"&&i.right>o.left-n&&i.left<o.right+r?!0:this.settings.axis==="vertical"&&i.bottom>o.top-n&&i.top<o.bottom+r}visible(){for(var e=this.bounds(),n=this.views.displayed(),r=n.length,s=[],i,o,a=0;a<r;a++)o=n[a],i=this.isVisible(o,0,0,e),i===!0&&s.push(o);return s}scrollBy(e,n,r){let s=this.settings.direction==="rtl"?-1:1;r&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*s,n*s):(e&&(this.container.scrollLeft+=e*s),n&&(this.container.scrollTop+=n)),this.scrolled=!0}scrollTo(e,n,r){r&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,n):(this.container.scrollLeft=e,this.container.scrollTop=n),this.scrolled=!0}onScroll(){let e,n;this.settings.fullsize?(e=window.scrollY,n=window.scrollX):(e=this.container.scrollTop,n=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=n,this.ignore?this.ignore=!1:(this.emit(ps.EVENTS.MANAGERS.SCROLL,{top:e,left:n}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.emit(ps.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),20))}bounds(){var e;return e=this.stage.bounds(),e}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new EE.default(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(n){n&&n.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,n){!n&&e===this.settings.axis||(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new EE.default(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(e==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,n="auto"){let r=e==="paginated"||e==="auto";this.isPaginated=r,e==="scrolled-doc"||e==="scrolled-continuous"||e==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=r?"hidden":n,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(n){const r=n&&n.contents;r&&e.push(r)}),e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}(0,b6.default)(SD.prototype);var E6=SD;vc.default=E6;var Od={},a0={};Object.defineProperty(a0,"__esModule",{value:!0});a0.default=void 0;var IE=je,TE=or,I6=T6(to);function T6(t){return t&&t.__esModule?t:{default:t}}const _6=Math.PI/2,N6={easeOutSine:function(t){return Math.sin(t*_6)},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*Math.pow(t,5):.5*(Math.pow(t-2,5)+2)},easeInCubic:function(t){return Math.pow(t,3)}};class kD{constructor(e,n){this.settings=(0,IE.extend)({duration:80,minVelocity:.2,minDistance:10,easing:N6.easeInCubic},n||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(TE.EVENTS.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(TE.EVENTS.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let n=e.contents;["touchstart","touchmove","touchend"].forEach(r=>{n.on(r,s=>this.triggerViewEvent(s,n))})}triggerViewEvent(e,n){this.emit(e.type,e,n)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:n,screenY:r}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=n,this.startTouchY=r,this.startTime=this.now()),this.endTouchX=n,this.endTouchY=r,this.endTime=this.now()}onTouchMove(e){let{screenX:n,screenY:r}=e.touches[0],s=Math.abs(r-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&s<10&&(this.element.scrollLeft-=n-this.endTouchX),this.endTouchX=n,this.endTouchY=r,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let n=this.wasSwiped();n!==0?this.snap(n):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,n=this.endTouchX-this.startTouchX,r=Math.abs(n),s=this.endTime-this.startTime,i=n/s,o=this.settings.minVelocity;if(r<=this.settings.minDistance||r>=e)return 0;if(i>o)return-1;if(i<-o)return 1}needsSnap(){let e=this.scrollLeft,n=this.layout.pageWidth*this.layout.divisor;return e%n!==0}snap(e=0){let n=this.scrollLeft,r=this.layout.pageWidth*this.layout.divisor,s=Math.round(n/r)*r;return e&&(s+=e*r),this.smoothScrollTo(s)}smoothScrollTo(e){const n=new IE.defer,r=this.scrollLeft,s=this.now(),i=this.settings.duration,o=this.settings.easing;this.snapping=!0;function a(){const l=this.now(),u=Math.min(1,(l-s)/i);if(o(u),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,n.resolve();return}u<1?(window.requestAnimationFrame(a.bind(this)),this.scrollTo(r+(e-r)*u,0)):(this.scrollTo(e,0),this.snapping=!1,n.resolve())}return a.call(this),n.promise}scrollTo(e=0,n=0){this.fullsize?window.scroll(e,n):(this.scroller.scrollLeft=e,this.scroller.scrollTop=n)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}(0,I6.default)(kD.prototype);var $6=kD;a0.default=$6;Object.defineProperty(Od,"__esModule",{value:!0});Od.default=void 0;var Pa=je,_E=vw(vc),NE=vw(a0),As=or,D6=vw(CD);function vw(t){return t&&t.__esModule?t:{default:t}}class A6 extends _E.default{constructor(e){super(e),this.name="continuous",this.settings=(0,Pa.extend)(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),(0,Pa.extend)(this.settings,e.settings||{}),e.settings.gap!="undefined"&&e.settings.gap===0&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,n){return _E.default.prototype.display.call(this,e,n).then((function(){return this.fill()}).bind(this))}fill(e){var n=e||new Pa.defer;return this.q.enqueue(()=>this.check()).then(r=>{r?this.fill(n):n.resolve()}),n.promise}moveTo(e){var n=0,r=0;this.isPaginated?(n=Math.floor(e.left/this.layout.delta)*this.layout.delta,n+this.settings.offsetDelta):(r=e.top,e.top+this.settings.offsetDelta),(n>0||r>0)&&this.scrollBy(n,r,!0)}afterResized(e){this.emit(As.EVENTS.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var n=this.createView(e);return this.views.append(n),n.on(As.EVENTS.VIEWS.RESIZED,r=>{n.expanded=!0}),n.on(As.EVENTS.VIEWS.AXIS,r=>{this.updateAxis(r)}),n.on(As.EVENTS.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),n.onDisplayed=this.afterDisplayed.bind(this),n.onResize=this.afterResized.bind(this),n.display(this.request)}append(e){var n=this.createView(e);return n.on(As.EVENTS.VIEWS.RESIZED,r=>{n.expanded=!0}),n.on(As.EVENTS.VIEWS.AXIS,r=>{this.updateAxis(r)}),n.on(As.EVENTS.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),this.views.append(n),n.onDisplayed=this.afterDisplayed.bind(this),n}prepend(e){var n=this.createView(e);return n.on(As.EVENTS.VIEWS.RESIZED,r=>{this.counter(r),n.expanded=!0}),n.on(As.EVENTS.VIEWS.AXIS,r=>{this.updateAxis(r)}),n.on(As.EVENTS.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),this.views.prepend(n),n.onDisplayed=this.afterDisplayed.bind(this),n}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var n=this.bounds(),r=this.views.all(),s=r.length,i=typeof e<"u"?e:this.settings.offset||0,o,a,l=new Pa.defer,u=[],c=0;c<s;c++)if(a=r[c],o=this.isVisible(a,i,i,n),o===!0)if(a.displayed)a.show();else{let h=a.display(this.request).then(function(d){d.show()},d=>{a.hide()});u.push(h)}else this.q.enqueue(a.destroy.bind(a)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout((function(){this.q.enqueue(this.trim.bind(this))}).bind(this),250);return u.length?Promise.all(u).catch(h=>{l.reject(h)}):(l.resolve(),l.promise)}check(e,n){var r=new Pa.defer,s=[],i=this.settings.axis==="horizontal",o=this.settings.offset||0;e&&i&&(o=e),n&&!i&&(o=n);var a=this._bounds;let l=i?this.scrollLeft:this.scrollTop,u=i?Math.floor(a.width):a.height,c=i?this.container.scrollWidth:this.container.scrollHeight,h=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",d=this.settings.rtlScrollType,f=this.settings.direction==="rtl";this.settings.fullsize?(i&&f&&d==="negative"||!i&&f&&d==="default")&&(l=l*-1):(f&&d==="default"&&h==="horizontal"&&(l=c-u-l),f&&d==="negative"&&h==="horizontal"&&(l=l*-1));let m=()=>{let b=this.views.first(),x=b&&b.section.prev();x&&s.push(this.prepend(x))},v=()=>{let b=this.views.last(),x=b&&b.section.next();x&&s.push(this.append(x))},p=l+u+o,g=l-o;p>=c&&v(),g<0&&m();let y=s.map(b=>b.display(this.request));return s.length?Promise.all(y).then(()=>this.check()).then(()=>this.update(o),b=>b):(this.q.enqueue((function(){this.update()}).bind(this)),r.resolve(!1),r.promise)}trim(){for(var e=new Pa.defer,n=this.views.displayed(),r=n[0],s=n[n.length-1],i=this.views.indexOf(r),o=this.views.indexOf(s),a=this.views.slice(0,i),l=this.views.slice(o+1),u=0;u<a.length-1;u++)this.erase(a[u],a);for(var c=1;c<l.length;c++)this.erase(l[c]);return e.resolve(),e.promise}erase(e,n){var r,s;this.settings.fullsize?(r=window.scrollY,s=window.scrollX):(r=this.container.scrollTop,s=this.container.scrollLeft);var i=e.bounds();this.views.remove(e),n&&(this.settings.axis==="vertical"?this.scrollTo(0,r-i.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(s+Math.floor(i.width),0,!0):this.scrollTo(s,0,!0):this.scrollTo(s-Math.floor(i.width),0,!0))}addEventListeners(e){window.addEventListener("unload",(function(n){this.ignore=!0,this.destroy()}).bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new NE.default(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var e;this.tick=Pa.requestAnimationFrame;let n=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*n,this.scrollLeft=window.scrollX*n):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=(0,D6.default)(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,n,r=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(e=window.scrollY*r,n=window.scrollX*r):(e=this.container.scrollTop,n=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=n,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(n-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=n,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}).bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue((function(){return this.check()}).bind(this)),this.emit(As.EVENTS.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(As.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),this.settings.afterScrolledTimeout)}next(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}prev(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new NE.default(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}var R6=A6;Od.default=R6;Object.defineProperty(gc,"__esModule",{value:!0});gc.default=void 0;var O6=ki(to),th=je,Ma=ki(pc),$E=ki(jr),F6=ki(pa),L6=ki($d),P6=ki(Jg);ki(Fl);var M6=ki(e0),Zt=or,B6=ki(Ad),z6=ki(vc),U6=ki(Od);function ki(t){return t&&t.__esModule?t:{default:t}}class ED{constructor(e,n){this.settings=(0,th.extend)(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),(0,th.extend)(this.settings,n),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new Ma.default(this),this.hooks.serialize=new Ma.default(this),this.hooks.content=new Ma.default(this),this.hooks.unloaded=new Ma.default(this),this.hooks.layout=new Ma.default(this),this.hooks.render=new Ma.default(this),this.hooks.show=new Ma.default(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new P6.default(this),this.annotations=new M6.default(this),this.epubcfi=new $E.default,this.q=new F6.default(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new th.defer,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){var n;return typeof e=="string"&&e==="default"?n=z6.default:typeof e=="string"&&e==="continuous"?n=U6.default:n=e,n}requireView(e){var n;return typeof e=="string"&&e==="iframe"?n=B6.default:n=e,n}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(Zt.EVENTS.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(Zt.EVENTS.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(Zt.EVENTS.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(Zt.EVENTS.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(Zt.EVENTS.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(Zt.EVENTS.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue((function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit(Zt.EVENTS.RENDITION.ATTACHED)}).bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(this.book){this.epubcfi.isCfiString(e);var n=new th.defer,r=n.promise,s;return this.displaying=n,this.book.locations.length()&&(0,th.isFloat)(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),s=this.book.spine.get(e),s?(this.manager.display(s,e).then(()=>{n.resolve(s),this.displaying=void 0,this.emit(Zt.EVENTS.RENDITION.DISPLAYED,s),this.reportLocation()},i=>{this.emit(Zt.EVENTS.RENDITION.DISPLAY_ERROR,i)}),r):(n.reject(new Error("No Section Found")),r)}}afterDisplayed(e){e.on(Zt.EVENTS.VIEWS.MARK_CLICKED,(n,r)=>this.triggerMarkEvent(n,r,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit(Zt.EVENTS.RENDITION.RENDERED,e.section,e)}):this.emit(Zt.EVENTS.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit(Zt.EVENTS.RENDITION.REMOVED,e.section,e)})}onResized(e,n){this.emit(Zt.EVENTS.RENDITION.RESIZED,{width:e.width,height:e.height},n),this.location&&this.location.start&&this.display(n||this.location.start.cfi)}onOrientationChange(e){this.emit(Zt.EVENTS.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,n,r){e&&(this.settings.width=e),n&&(this.settings.height=n),this.manager.resize(e,n,r)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var n,r=this.settings.layout||e.layout||"reflowable",s=this.settings.spread||e.spread||"auto",i=this.settings.orientation||e.orientation||"auto",o=this.settings.flow||e.flow||"auto",a=e.viewport||"",l=this.settings.minSpreadWidth||e.minSpreadWidth||800,u=this.settings.direction||e.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),n={layout:r,spread:s,orientation:i,flow:o,viewport:a,minSpreadWidth:l,direction:u},n}flow(e){var n=e;(e==="scrolled"||e==="scrolled-doc"||e==="scrolled-continuous")&&(n="scrolled"),(e==="auto"||e==="paginated")&&(n="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(n),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(n),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new L6.default(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on(Zt.EVENTS.LAYOUT.UPDATED,(n,r)=>{this.emit(Zt.EVENTS.RENDITION.LAYOUT,n,r)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,n){this.settings.spread=e,n&&(this.settings.minSpreadWidth=n),this._layout&&this._layout.spread(e,n),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue((function(){requestAnimationFrame((function(){var r=this.manager.currentLocation();if(r&&r.then&&typeof r.then=="function")r.then((function(s){let i=this.located(s);!i||!i.start||!i.end||(this.location=i,this.emit(Zt.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(Zt.EVENTS.RENDITION.RELOCATED,this.location))}).bind(this));else if(r){let s=this.located(r);if(!s||!s.start||!s.end)return;this.location=s,this.emit(Zt.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(Zt.EVENTS.RENDITION.RELOCATED,this.location)}}).bind(this))}).bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then=="function")e.then((function(n){return this.located(n)}).bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let n=e[0],r=e[e.length-1],s={start:{index:n.index,href:n.href,cfi:n.mapping.start,displayed:{page:n.pages[0]||1,total:n.totalPages}},end:{index:r.index,href:r.href,cfi:r.mapping.end,displayed:{page:r.pages[r.pages.length-1]||1,total:r.totalPages}}},i=this.book.locations.locationFromCfi(n.mapping.start),o=this.book.locations.locationFromCfi(r.mapping.end);i!=null&&(s.start.location=i,s.start.percentage=this.book.locations.percentageFromLocation(i)),o!=null&&(s.end.location=o,s.end.percentage=this.book.locations.percentageFromLocation(o));let a=this.book.pageList.pageFromCfi(n.mapping.start),l=this.book.pageList.pageFromCfi(r.mapping.end);return a!=-1&&(s.start.page=a),l!=-1&&(s.end.page=l),r.index===this.book.spine.last().index&&s.end.displayed.page>=s.end.displayed.total&&(s.atEnd=!0),n.index===this.book.spine.first().index&&s.start.displayed.page===1&&(s.atStart=!0),s}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){Zt.DOM_EVENTS.forEach(n=>{e.on(n,r=>this.triggerViewEvent(r,e))}),e.on(Zt.EVENTS.CONTENTS.SELECTED,n=>this.triggerSelectedEvent(n,e))}triggerViewEvent(e,n){this.emit(e.type,e,n)}triggerSelectedEvent(e,n){this.emit(Zt.EVENTS.RENDITION.SELECTED,e,n)}triggerMarkEvent(e,n,r){this.emit(Zt.EVENTS.RENDITION.MARK_CLICKED,e,n,r)}getRange(e,n){var r=new $E.default(e),s=this.manager.visible().filter(function(i){if(r.spinePos===i.index)return!0});if(s.length)return s[0].contents.range(r,n)}adjustImages(e){if(this._layout.name==="pre-paginated")return new Promise(function(i){i()});let n=e.window.getComputedStyle(e.content,null),r=(e.content.offsetHeight-(parseFloat(n.paddingTop)+parseFloat(n.paddingBottom)))*.95,s=parseFloat(n.paddingLeft)+parseFloat(n.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-s+"px":"100%")+"!important","max-height":r+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-s+"px":"100%")+"!important","max-height":r+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(i,o){setTimeout(function(){i()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on(Zt.EVENTS.CONTENTS.LINK_CLICKED,n=>{let r=this.book.path.relative(n);this.display(r)})}injectStylesheet(e,n){let r=e.createElement("link");r.setAttribute("type","text/css"),r.setAttribute("rel","stylesheet"),r.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(r)}injectScript(e,n){let r=e.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",this.settings.script),r.textContent=" ",e.getElementsByTagName("head")[0].appendChild(r)}injectIdentifier(e,n){let r=this.book.packaging.metadata.identifier,s=e.createElement("meta");s.setAttribute("name","dc.relation.ispartof"),r&&s.setAttribute("content",r),e.getElementsByTagName("head")[0].appendChild(s)}}(0,O6.default)(ED.prototype);var V6=ED;gc.default=V6;var l0={};function Ko(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ID={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,s,i){function o(u,c){if(!s[u]){if(!r[u]){var h=typeof Ko=="function"&&Ko;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var f=s[u]={exports:{}};r[u][0].call(f.exports,function(m){var v=r[u][1][m];return o(v||m)},f,f.exports,n,r,s,i)}return s[u].exports}for(var a=typeof Ko=="function"&&Ko,l=0;l<i.length;l++)o(i[l]);return o}({1:[function(n,r,s){var i=n("./utils"),o=n("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var u=[],c,h,d,f,m,v,p,g=0,y=l.length,b=y,x=i.getTypeOf(l)!=="string";g<l.length;)b=y-g,x?(c=l[g++],h=g<y?l[g++]:0,d=g<y?l[g++]:0):(c=l.charCodeAt(g++),h=g<y?l.charCodeAt(g++):0,d=g<y?l.charCodeAt(g++):0),f=c>>2,m=(c&3)<<4|h>>4,v=b>1?(h&15)<<2|d>>6:64,p=b>2?d&63:64,u.push(a.charAt(f)+a.charAt(m)+a.charAt(v)+a.charAt(p));return u.join("")},s.decode=function(l){var u,c,h,d,f,m,v,p=0,g=0,y="data:";if(l.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");l=l.replace(/[^A-Za-z0-9+/=]/g,"");var b=l.length*3/4;if(l.charAt(l.length-1)===a.charAt(64)&&b--,l.charAt(l.length-2)===a.charAt(64)&&b--,b%1!==0)throw new Error("Invalid base64 input, bad content length.");var x;for(o.uint8array?x=new Uint8Array(b|0):x=new Array(b|0);p<l.length;)d=a.indexOf(l.charAt(p++)),f=a.indexOf(l.charAt(p++)),m=a.indexOf(l.charAt(p++)),v=a.indexOf(l.charAt(p++)),u=d<<2|f>>4,c=(f&15)<<4|m>>2,h=(m&3)<<6|v,x[g++]=u,m!==64&&(x[g++]=c),v!==64&&(x[g++]=h);return x}},{"./support":30,"./utils":32}],2:[function(n,r,s){var i=n("./external"),o=n("./stream/DataWorker"),a=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function u(c,h,d,f,m){this.compressedSize=c,this.uncompressedSize=h,this.crc32=d,this.compression=f,this.compressedContent=m}u.prototype={getContentWorker:function(){var c=new o(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),h=this;return c.on("end",function(){if(this.streamInfo.data_length!==h.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new o(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(c,h,d){return c.pipe(new a).pipe(new l("uncompressedSize")).pipe(h.compressWorker(d)).pipe(new l("compressedSize")).withStreamInfo("compression",h)},r.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,s){var i=n("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,s){var i=n("./utils");function o(){for(var c,h=[],d=0;d<256;d++){c=d;for(var f=0;f<8;f++)c=c&1?3988292384^c>>>1:c>>>1;h[d]=c}return h}var a=o();function l(c,h,d,f){var m=a,v=f+d;c=c^-1;for(var p=f;p<v;p++)c=c>>>8^m[(c^h[p])&255];return c^-1}function u(c,h,d,f){var m=a,v=f+d;c=c^-1;for(var p=f;p<v;p++)c=c>>>8^m[(c^h.charCodeAt(p))&255];return c^-1}r.exports=function(h,d){if(typeof h>"u"||!h.length)return 0;var f=i.getTypeOf(h)!=="string";return f?l(d|0,h,h.length,0):u(d|0,h,h.length,0)}},{"./utils":32}],5:[function(n,r,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(n,r,s){var i=null;typeof Promise<"u"?i=Promise:i=n("lie"),r.exports={Promise:i}},{lie:37}],7:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=n("pako"),a=n("./utils"),l=n("./stream/GenericWorker"),u=i?"uint8array":"array";s.magic="\b\0";function c(h,d){l.call(this,"FlateWorker/"+h),this._pako=null,this._pakoAction=h,this._pakoOptions=d,this.meta={}}a.inherits(c,l),c.prototype.processChunk=function(h){this.meta=h.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(u,h.data),!1)},c.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var h=this;this._pako.onData=function(d){h.push({data:d,meta:h.meta})}},s.compressWorker=function(h){return new c("Deflate",h)},s.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,s){var i=n("../utils"),o=n("../stream/GenericWorker"),a=n("../utf8"),l=n("../crc32"),u=n("../signature"),c=function(g,y){var b="",x;for(x=0;x<y;x++)b+=String.fromCharCode(g&255),g=g>>>8;return b},h=function(g,y){var b=g;return g||(b=y?16893:33204),(b&65535)<<16},d=function(g){return(g||0)&63},f=function(g,y,b,x,w,C){var S=g.file,E=g.compression,T=C!==a.utf8encode,_=i.transformTo("string",C(S.name)),A=i.transformTo("string",a.utf8encode(S.name)),L=S.comment,W=i.transformTo("string",C(L)),K=i.transformTo("string",a.utf8encode(L)),R=A.length!==S.name.length,M=K.length!==L.length,U,D,B="",X="",ie="",G=S.dir,Z=S.date,de={crc32:0,compressedSize:0,uncompressedSize:0};(!y||b)&&(de.crc32=g.crc32,de.compressedSize=g.compressedSize,de.uncompressedSize=g.uncompressedSize);var ge=0;y&&(ge|=8),!T&&(R||M)&&(ge|=2048);var ye=0,j=0;G&&(ye|=16),w==="UNIX"?(j=798,ye|=h(S.unixPermissions,G)):(j=20,ye|=d(S.dosPermissions)),U=Z.getUTCHours(),U=U<<6,U=U|Z.getUTCMinutes(),U=U<<5,U=U|Z.getUTCSeconds()/2,D=Z.getUTCFullYear()-1980,D=D<<4,D=D|Z.getUTCMonth()+1,D=D<<5,D=D|Z.getUTCDate(),R&&(X=c(1,1)+c(l(_),4)+A,B+="up"+c(X.length,2)+X),M&&(ie=c(1,1)+c(l(W),4)+K,B+="uc"+c(ie.length,2)+ie);var J="";J+=`
\0`,J+=c(ge,2),J+=E.magic,J+=c(U,2),J+=c(D,2),J+=c(de.crc32,4),J+=c(de.compressedSize,4),J+=c(de.uncompressedSize,4),J+=c(_.length,2),J+=c(B.length,2);var fe=u.LOCAL_FILE_HEADER+J+_+B,ve=u.CENTRAL_FILE_HEADER+c(j,2)+J+c(W.length,2)+"\0\0\0\0"+c(ye,4)+c(x,4)+_+B+W;return{fileRecord:fe,dirRecord:ve}},m=function(g,y,b,x,w){var C="",S=i.transformTo("string",w(x));return C=u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+c(g,2)+c(g,2)+c(y,4)+c(b,4)+c(S.length,2)+S,C},v=function(g){var y="";return y=u.DATA_DESCRIPTOR+c(g.crc32,4)+c(g.compressedSize,4)+c(g.uncompressedSize,4),y};function p(g,y,b,x){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=b,this.encodeFileName=x,this.streamFiles=g,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(p,o),p.prototype.push=function(g){var y=g.meta.percent||0,b=this.entriesCount,x=this._sources.length;this.accumulate?this.contentBuffer.push(g):(this.bytesWritten+=g.data.length,o.prototype.push.call(this,{data:g.data,meta:{currentFile:this.currentFile,percent:b?(y+100*(b-x-1))/b:100}}))},p.prototype.openedSource=function(g){this.currentSourceOffset=this.bytesWritten,this.currentFile=g.file.name;var y=this.streamFiles&&!g.file.dir;if(y){var b=f(g,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(g){this.accumulate=!1;var y=this.streamFiles&&!g.file.dir,b=f(g,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),y)this.push({data:v(g),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var g=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var b=this.bytesWritten-g,x=m(this.dirRecords.length,b,g,this.zipComment,this.encodeFileName);this.push({data:x,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(g){this._sources.push(g);var y=this;return g.on("data",function(b){y.processChunk(b)}),g.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),g.on("error",function(b){y.error(b)}),this},p.prototype.resume=function(){if(!o.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},p.prototype.error=function(g){var y=this._sources;if(!o.prototype.error.call(this,g))return!1;for(var b=0;b<y.length;b++)try{y[b].error(g)}catch{}return!0},p.prototype.lock=function(){o.prototype.lock.call(this);for(var g=this._sources,y=0;y<g.length;y++)g[y].lock()},r.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,s){var i=n("../compressions"),o=n("./ZipFileWorker"),a=function(l,u){var c=l||u,h=i[c];if(!h)throw new Error(c+" is not a valid compression method !");return h};s.generateWorker=function(l,u,c){var h=new o(u.streamFiles,c,u.platform,u.encodeFileName),d=0;try{l.forEach(function(f,m){d++;var v=a(m.options.compression,u.compression),p=m.options.compressionOptions||u.compressionOptions||{},g=m.dir,y=m.date;m._compressWorker(v,p).withStreamInfo("file",{name:f,dir:g,date:y,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(h)}),h.entriesCount=d}catch(f){h.error(f)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new i;for(var a in this)typeof this[a]!="function"&&(o[a]=this[a]);return o}}i.prototype=n("./object"),i.prototype.loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.1",i.loadAsync=function(o,a){return new i().loadAsync(o,a)},i.external=n("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,s){var i=n("./utils"),o=n("./external"),a=n("./utf8"),l=n("./zipEntries"),u=n("./stream/Crc32Probe"),c=n("./nodejsUtils");function h(d){return new o.Promise(function(f,m){var v=d.decompressed.getContentWorker().pipe(new u);v.on("error",function(p){m(p)}).on("end",function(){v.streamInfo.crc32!==d.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}r.exports=function(d,f){var m=this;return f=i.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),c.isNode&&c.isStream(d)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",d,!0,f.optimizedBinaryString,f.base64).then(function(v){var p=new l(f);return p.load(v),p}).then(function(p){var g=[o.Promise.resolve(p)],y=p.files;if(f.checkCRC32)for(var b=0;b<y.length;b++)g.push(h(y[b]));return o.Promise.all(g)}).then(function(p){for(var g=p.shift(),y=g.files,b=0;b<y.length;b++){var x=y[b],w=x.fileNameStr,C=i.resolve(x.fileNameStr);m.file(C,x.decompressed,{binary:!0,optimizedBinaryString:!0,date:x.date,dir:x.dir,comment:x.fileCommentStr.length?x.fileCommentStr:null,unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions,createFolders:f.createFolders}),x.dir||(m.file(C).unsafeOriginalName=w)}return g.zipComment.length&&(m.comment=g.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,s){var i=n("../utils"),o=n("../stream/GenericWorker");function a(l,u){o.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}i.inherits(a,o),a.prototype._bindStream=function(l){var u=this;this._stream=l,l.pause(),l.on("data",function(c){u.push({data:c,meta:{percent:0}})}).on("error",function(c){u.isPaused?this.generatedError=c:u.error(c)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},a.prototype.pause=function(){return o.prototype.pause.call(this)?(this._stream.pause(),!0):!1},a.prototype.resume=function(){return o.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},r.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,s){var i=n("readable-stream").Readable,o=n("../utils");o.inherits(a,i);function a(l,u,c){i.call(this,u),this._helper=l;var h=this;l.on("data",function(d,f){h.push(d)||h._helper.pause(),c&&c(f)}).on("error",function(d){h.emit("error",d)}).on("end",function(){h.push(null)})}a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(n,r,s){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,o);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,o)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var o=new Buffer(i);return o.fill(0),o},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,r,s){var i=n("./utf8"),o=n("./utils"),a=n("./stream/GenericWorker"),l=n("./stream/StreamHelper"),u=n("./defaults"),c=n("./compressedObject"),h=n("./zipObject"),d=n("./generate"),f=n("./nodejsUtils"),m=n("./nodejs/NodejsStreamInputAdapter"),v=function(w,C,S){var E=o.getTypeOf(C),T,_=o.extend(S||{},u);_.date=_.date||new Date,_.compression!==null&&(_.compression=_.compression.toUpperCase()),typeof _.unixPermissions=="string"&&(_.unixPermissions=parseInt(_.unixPermissions,8)),_.unixPermissions&&_.unixPermissions&16384&&(_.dir=!0),_.dosPermissions&&_.dosPermissions&16&&(_.dir=!0),_.dir&&(w=g(w)),_.createFolders&&(T=p(w))&&y.call(this,T,!0);var A=E==="string"&&_.binary===!1&&_.base64===!1;(!S||typeof S.binary>"u")&&(_.binary=!A);var L=C instanceof c&&C.uncompressedSize===0;(L||_.dir||!C||C.length===0)&&(_.base64=!1,_.binary=!0,C="",_.compression="STORE",E="string");var W=null;C instanceof c||C instanceof a?W=C:f.isNode&&f.isStream(C)?W=new m(w,C):W=o.prepareContent(w,C,_.binary,_.optimizedBinaryString,_.base64);var K=new h(w,W,_);this.files[w]=K},p=function(w){w.slice(-1)==="/"&&(w=w.substring(0,w.length-1));var C=w.lastIndexOf("/");return C>0?w.substring(0,C):""},g=function(w){return w.slice(-1)!=="/"&&(w+="/"),w},y=function(w,C){return C=typeof C<"u"?C:u.createFolders,w=g(w),this.files[w]||v.call(this,w,null,{dir:!0,createFolders:C}),this.files[w]};function b(w){return Object.prototype.toString.call(w)==="[object RegExp]"}var x={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(w){var C,S,E;for(C in this.files)E=this.files[C],S=C.slice(this.root.length,C.length),S&&C.slice(0,this.root.length)===this.root&&w(S,E)},filter:function(w){var C=[];return this.forEach(function(S,E){w(S,E)&&C.push(E)}),C},file:function(w,C,S){if(arguments.length===1)if(b(w)){var E=w;return this.filter(function(_,A){return!A.dir&&E.test(_)})}else{var T=this.files[this.root+w];return T&&!T.dir?T:null}else w=this.root+w,v.call(this,w,C,S);return this},folder:function(w){if(!w)return this;if(b(w))return this.filter(function(T,_){return _.dir&&w.test(T)});var C=this.root+w,S=y.call(this,C),E=this.clone();return E.root=S.name,E},remove:function(w){w=this.root+w;var C=this.files[w];if(C||(w.slice(-1)!=="/"&&(w+="/"),C=this.files[w]),C&&!C.dir)delete this.files[w];else for(var S=this.filter(function(T,_){return _.name.slice(0,w.length)===w}),E=0;E<S.length;E++)delete this.files[S[E].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(w){var C,S={};try{if(S=o.extend(w||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode}),S.type=S.type.toLowerCase(),S.compression=S.compression.toUpperCase(),S.type==="binarystring"&&(S.type="string"),!S.type)throw new Error("No output type specified.");o.checkSupport(S.type),(S.platform==="darwin"||S.platform==="freebsd"||S.platform==="linux"||S.platform==="sunos")&&(S.platform="UNIX"),S.platform==="win32"&&(S.platform="DOS");var E=S.comment||this.comment||"";C=d.generateWorker(this,S,E)}catch(T){C=new a("error"),C.error(T)}return new l(C,S.type||"string",S.mimeType)},generateAsync:function(w,C){return this.generateInternalStream(w).accumulate(C)},generateNodeStream:function(w,C){return w=w||{},w.type||(w.type="nodebuffer"),this.generateInternalStream(w).toNodejsStream(C)}};r.exports=x},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,s){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,s){var i=n("./DataReader"),o=n("../utils");function a(l){i.call(this,l);for(var u=0;u<this.data.length;u++)l[u]=l[u]&255}o.inherits(a,i),a.prototype.byteAt=function(l){return this.data[this.zero+l]},a.prototype.lastIndexOfSignature=function(l){for(var u=l.charCodeAt(0),c=l.charCodeAt(1),h=l.charCodeAt(2),d=l.charCodeAt(3),f=this.length-4;f>=0;--f)if(this.data[f]===u&&this.data[f+1]===c&&this.data[f+2]===h&&this.data[f+3]===d)return f-this.zero;return-1},a.prototype.readAndCheckSignature=function(l){var u=l.charCodeAt(0),c=l.charCodeAt(1),h=l.charCodeAt(2),d=l.charCodeAt(3),f=this.readData(4);return u===f[0]&&c===f[1]&&h===f[2]&&d===f[3]},a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(n,r,s){var i=n("../utils");function o(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l=0,u;for(this.checkOffset(a),u=this.index+a-1;u>=this.index;u--)l=(l<<8)+this.byteAt(u);return this.index+=a,l},readString:function(a){return i.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC((a>>25&127)+1980,(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(a&31)<<1))}},r.exports=o},{"../utils":32}],19:[function(n,r,s){var i=n("./Uint8ArrayReader"),o=n("../utils");function a(l){i.call(this,l)}o.inherits(a,i),a.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,s){var i=n("./DataReader"),o=n("../utils");function a(l){i.call(this,l)}o.inherits(a,i),a.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},a.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},a.prototype.readAndCheckSignature=function(l){var u=this.readData(4);return l===u},a.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(n,r,s){var i=n("./ArrayReader"),o=n("../utils");function a(l){i.call(this,l)}o.inherits(a,i),a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,s){var i=n("../utils"),o=n("../support"),a=n("./ArrayReader"),l=n("./StringReader"),u=n("./NodeBufferReader"),c=n("./Uint8ArrayReader");r.exports=function(h){var d=i.getTypeOf(h);return i.checkSupport(d),d==="string"&&!o.uint8array?new l(h):d==="nodebuffer"?new u(h):o.uint8array?new c(i.transformTo("uint8array",h)):new a(i.transformTo("array",h))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,s){var i=n("./GenericWorker"),o=n("../utils");function a(l){i.call(this,"ConvertWorker to "+l),this.destType=l}o.inherits(a,i),a.prototype.processChunk=function(l){this.push({data:o.transformTo(this.destType,l.data),meta:l.meta})},r.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,s){var i=n("./GenericWorker"),o=n("../crc32"),a=n("../utils");function l(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}a.inherits(l,i),l.prototype.processChunk=function(u){this.streamInfo.crc32=o(u.data,this.streamInfo.crc32||0),this.push(u)},r.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,s){var i=n("../utils"),o=n("./GenericWorker");function a(l){o.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(a,o),a.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}o.prototype.processChunk.call(this,l)},r.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,s){var i=n("../utils"),o=n("./GenericWorker"),a=16*1024;function l(u){o.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(h){c.dataIsReady=!0,c.data=h,c.max=h&&h.length||0,c.type=i.getTypeOf(h),c.isPaused||c._tickAndRepeat()},function(h){c.error(h)})}i.inherits(l,o),l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return o.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0):!1},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=a,c=null,h=Math.min(this.max,this.index+u);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,h);break;case"uint8array":c=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":c=this.data.slice(this.index,h);break}return this.index=h,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,s){function i(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return this.isFinished?!1:(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,a){return this._listeners[o].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,a){if(this._listeners[o])for(var l=0;l<this._listeners[o].length;l++)this._listeners[o][l].call(this,a)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var a=this;return o.on("data",function(l){a.processChunk(l)}),o.on("end",function(){a.end()}),o.on("error",function(l){a.error(l)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var o=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,a){return this.extraStreamInfo[o]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},r.exports=i},{}],29:[function(n,r,s){var i=n("../utils"),o=n("./ConvertWorker"),a=n("./GenericWorker"),l=n("../base64"),u=n("../support"),c=n("../external"),h=null;if(u.nodestream)try{h=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(p,g,y){switch(p){case"blob":return i.newBlob(i.transformTo("arraybuffer",g),y);case"base64":return l.encode(g);default:return i.transformTo(p,g)}}function f(p,g){var y,b=0,x=null,w=0;for(y=0;y<g.length;y++)w+=g[y].length;switch(p){case"string":return g.join("");case"array":return Array.prototype.concat.apply([],g);case"uint8array":for(x=new Uint8Array(w),y=0;y<g.length;y++)x.set(g[y],b),b+=g[y].length;return x;case"nodebuffer":return Buffer.concat(g);default:throw new Error("concat : unsupported type '"+p+"'")}}function m(p,g){return new c.Promise(function(y,b){var x=[],w=p._internalType,C=p._outputType,S=p._mimeType;p.on("data",function(E,T){x.push(E),g&&g(T)}).on("error",function(E){x=[],b(E)}).on("end",function(){try{var E=d(C,f(w,x),S);y(E)}catch(T){b(T)}x=[]}).resume()})}function v(p,g,y){var b=g;switch(g){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string";break}try{this._internalType=b,this._outputType=g,this._mimeType=y,i.checkSupport(b),this._worker=p.pipe(new o(b)),p.lock()}catch(x){this._worker=new a("error"),this._worker.error(x)}}v.prototype={accumulate:function(p){return m(this,p)},on:function(p,g){var y=this;return p==="data"?this._worker.on(p,function(b){g.call(y,b.data,b.meta)}):this._worker.on(p,function(){i.delay(g,arguments,y)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:this._outputType!=="nodebuffer"},p)}},r.exports=v},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var o=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,a=new o;a.append(i),s.blob=a.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!n("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,s){for(var i=n("./utils"),o=n("./support"),a=n("./nodejsUtils"),l=n("./stream/GenericWorker"),u=new Array(256),c=0;c<256;c++)u[c]=c>=252?6:c>=248?5:c>=240?4:c>=224?3:c>=192?2:1;u[254]=u[254]=1;var h=function(p){var g,y,b,x,w,C=p.length,S=0;for(x=0;x<C;x++)y=p.charCodeAt(x),(y&64512)===55296&&x+1<C&&(b=p.charCodeAt(x+1),(b&64512)===56320&&(y=65536+(y-55296<<10)+(b-56320),x++)),S+=y<128?1:y<2048?2:y<65536?3:4;for(o.uint8array?g=new Uint8Array(S):g=new Array(S),w=0,x=0;w<S;x++)y=p.charCodeAt(x),(y&64512)===55296&&x+1<C&&(b=p.charCodeAt(x+1),(b&64512)===56320&&(y=65536+(y-55296<<10)+(b-56320),x++)),y<128?g[w++]=y:y<2048?(g[w++]=192|y>>>6,g[w++]=128|y&63):y<65536?(g[w++]=224|y>>>12,g[w++]=128|y>>>6&63,g[w++]=128|y&63):(g[w++]=240|y>>>18,g[w++]=128|y>>>12&63,g[w++]=128|y>>>6&63,g[w++]=128|y&63);return g},d=function(p,g){var y;for(g=g||p.length,g>p.length&&(g=p.length),y=g-1;y>=0&&(p[y]&192)===128;)y--;return y<0||y===0?g:y+u[p[y]]>g?y:g},f=function(p){var g,y,b,x,w=p.length,C=new Array(w*2);for(y=0,g=0;g<w;){if(b=p[g++],b<128){C[y++]=b;continue}if(x=u[b],x>4){C[y++]=65533,g+=x-1;continue}for(b&=x===2?31:x===3?15:7;x>1&&g<w;)b=b<<6|p[g++]&63,x--;if(x>1){C[y++]=65533;continue}b<65536?C[y++]=b:(b-=65536,C[y++]=55296|b>>10&1023,C[y++]=56320|b&1023)}return C.length!==y&&(C.subarray?C=C.subarray(0,y):C.length=y),i.applyFromCharCode(C)};s.utf8encode=function(g){return o.nodebuffer?a.newBufferFrom(g,"utf-8"):h(g)},s.utf8decode=function(g){return o.nodebuffer?i.transformTo("nodebuffer",g).toString("utf-8"):(g=i.transformTo(o.uint8array?"uint8array":"array",g),f(g))};function m(){l.call(this,"utf-8 decode"),this.leftOver=null}i.inherits(m,l),m.prototype.processChunk=function(p){var g=i.transformTo(o.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var y=g;g=new Uint8Array(y.length+this.leftOver.length),g.set(this.leftOver,0),g.set(y,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var b=d(g),x=g;b!==g.length&&(o.uint8array?(x=g.subarray(0,b),this.leftOver=g.subarray(b,g.length)):(x=g.slice(0,b),this.leftOver=g.slice(b,g.length))),this.push({data:s.utf8decode(x),meta:p.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=m;function v(){l.call(this,"utf-8 encode")}i.inherits(v,l),v.prototype.processChunk=function(p){this.push({data:s.utf8encode(p.data),meta:p.meta})},s.Utf8EncodeWorker=v},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,s){var i=n("./support"),o=n("./base64"),a=n("./nodejsUtils"),l=n("./external");n("setimmediate");function u(p){var g=null;return i.uint8array?g=new Uint8Array(p.length):g=new Array(p.length),h(p,g)}s.newBlob=function(p,g){s.checkSupport("blob");try{return new Blob([p],{type:g})}catch{try{var y=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,b=new y;return b.append(p),b.getBlob(g)}catch{throw new Error("Bug : can't construct the Blob.")}}};function c(p){return p}function h(p,g){for(var y=0;y<p.length;++y)g[y]=p.charCodeAt(y)&255;return g}var d={stringifyByChunk:function(p,g,y){var b=[],x=0,w=p.length;if(w<=y)return String.fromCharCode.apply(null,p);for(;x<w;)g==="array"||g==="nodebuffer"?b.push(String.fromCharCode.apply(null,p.slice(x,Math.min(x+y,w)))):b.push(String.fromCharCode.apply(null,p.subarray(x,Math.min(x+y,w)))),x+=y;return b.join("")},stringifyByChar:function(p){for(var g="",y=0;y<p.length;y++)g+=String.fromCharCode(p[y]);return g},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function f(p){var g=65536,y=s.getTypeOf(p),b=!0;if(y==="uint8array"?b=d.applyCanBeUsed.uint8array:y==="nodebuffer"&&(b=d.applyCanBeUsed.nodebuffer),b)for(;g>1;)try{return d.stringifyByChunk(p,y,g)}catch{g=Math.floor(g/2)}return d.stringifyByChar(p)}s.applyFromCharCode=f;function m(p,g){for(var y=0;y<p.length;y++)g[y]=p[y];return g}var v={};v.string={string:c,array:function(p){return h(p,new Array(p.length))},arraybuffer:function(p){return v.string.uint8array(p).buffer},uint8array:function(p){return h(p,new Uint8Array(p.length))},nodebuffer:function(p){return h(p,a.allocBuffer(p.length))}},v.array={string:f,array:c,arraybuffer:function(p){return new Uint8Array(p).buffer},uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return a.newBufferFrom(p)}},v.arraybuffer={string:function(p){return f(new Uint8Array(p))},array:function(p){return m(new Uint8Array(p),new Array(p.byteLength))},arraybuffer:c,uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return a.newBufferFrom(new Uint8Array(p))}},v.uint8array={string:f,array:function(p){return m(p,new Array(p.length))},arraybuffer:function(p){return p.buffer},uint8array:c,nodebuffer:function(p){return a.newBufferFrom(p)}},v.nodebuffer={string:f,array:function(p){return m(p,new Array(p.length))},arraybuffer:function(p){return v.nodebuffer.uint8array(p).buffer},uint8array:function(p){return m(p,new Uint8Array(p.length))},nodebuffer:c},s.transformTo=function(p,g){if(g||(g=""),!p)return g;s.checkSupport(p);var y=s.getTypeOf(g),b=v[y][p](g);return b},s.resolve=function(p){for(var g=p.split("/"),y=[],b=0;b<g.length;b++){var x=g[b];x==="."||x===""&&b!==0&&b!==g.length-1||(x===".."?y.pop():y.push(x))}return y.join("/")},s.getTypeOf=function(p){if(typeof p=="string")return"string";if(Object.prototype.toString.call(p)==="[object Array]")return"array";if(i.nodebuffer&&a.isBuffer(p))return"nodebuffer";if(i.uint8array&&p instanceof Uint8Array)return"uint8array";if(i.arraybuffer&&p instanceof ArrayBuffer)return"arraybuffer"},s.checkSupport=function(p){var g=i[p.toLowerCase()];if(!g)throw new Error(p+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(p){var g="",y,b;for(b=0;b<(p||"").length;b++)y=p.charCodeAt(b),g+="\\x"+(y<16?"0":"")+y.toString(16).toUpperCase();return g},s.delay=function(p,g,y){setImmediate(function(){p.apply(y||null,g||[])})},s.inherits=function(p,g){var y=function(){};y.prototype=g.prototype,p.prototype=new y},s.extend=function(){var p={},g,y;for(g=0;g<arguments.length;g++)for(y in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],y)&&typeof p[y]>"u"&&(p[y]=arguments[g][y]);return p},s.prepareContent=function(p,g,y,b,x){var w=l.Promise.resolve(g).then(function(C){var S=i.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1);return S&&typeof FileReader<"u"?new l.Promise(function(E,T){var _=new FileReader;_.onload=function(A){E(A.target.result)},_.onerror=function(A){T(A.target.error)},_.readAsArrayBuffer(C)}):C});return w.then(function(C){var S=s.getTypeOf(C);return S?(S==="arraybuffer"?C=s.transformTo("uint8array",C):S==="string"&&(x?C=o.decode(C):y&&b!==!0&&(C=u(C))),C):l.Promise.reject(new Error("Can't read the data of '"+p+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,s){var i=n("./reader/readerFor"),o=n("./utils"),a=n("./signature"),l=n("./zipEntry"),u=n("./support");function c(h){this.files=[],this.loadOptions=h}c.prototype={checkSignature:function(h){if(!this.reader.readAndCheckSignature(h)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(d)+", expected "+o.pretty(h)+")")}},isSignature:function(h,d){var f=this.reader.index;this.reader.setIndex(h);var m=this.reader.readString(4),v=m===d;return this.reader.setIndex(f),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength),d=u.uint8array?"uint8array":"array",f=o.transformTo(d,h);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var h=this.zip64EndOfCentralSize-44,d=0,f,m,v;d<h;)f=this.reader.readInt(2),m=this.reader.readInt(4),v=this.reader.readData(m),this.zip64ExtensibleData[f]={id:f,length:m,value:v}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var h,d;for(h=0;h<this.files.length;h++)d=this.files[h],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)h=new l({zip64:this.zip64},this.loadOptions),h.readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(h<0){var d=!this.isSignature(0,a.LOCAL_FILE_HEADER);throw d?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(h);var f=h;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,h=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),h<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(h),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var v=f-m;if(v>0)this.isSignature(f,a.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(h){this.reader=i(h)},load:function(h){this.prepareReader(h),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,s){var i=n("./reader/readerFor"),o=n("./utils"),a=n("./compressedObject"),l=n("./crc32"),u=n("./utf8"),c=n("./compressions"),h=n("./support"),d=0,f=3,m=function(p){for(var g in c)if(Object.prototype.hasOwnProperty.call(c,g)&&c[g].magic===p)return c[g];return null};function v(p,g){this.options=p,this.loadOptions=g}v.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(p){var g,y;if(p.skip(22),this.fileNameLength=p.readInt(2),y=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(y),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(g=m(this.compressionMethod),g===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,g,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var g=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(g),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),p===d&&(this.dosPermissions=this.externalFileAttributes&63),p===f&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=i(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var g=p.index+this.extraFieldsLength,y,b,x;for(this.extraFields||(this.extraFields={});p.index+4<g;)y=p.readInt(2),b=p.readInt(2),x=p.readData(b),this.extraFields[y]={id:y,length:b,value:x};p.setIndex(g)},handleUTF8:function(){var p=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var y=o.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(y)}var b=this.findExtraFieldUnicodeComment();if(b!==null)this.fileCommentStr=b;else{var x=o.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var g=i(p.value);return g.readInt(1)!==1||l(this.fileName)!==g.readInt(4)?null:u.utf8decode(g.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var g=i(p.value);return g.readInt(1)!==1||l(this.fileComment)!==g.readInt(4)?null:u.utf8decode(g.readData(p.length-5))}return null}},r.exports=v},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,s){var i=n("./stream/StreamHelper"),o=n("./stream/DataWorker"),a=n("./utf8"),l=n("./compressedObject"),u=n("./stream/GenericWorker"),c=function(m,v,p){this.name=m,this.dir=p.dir,this.date=p.date,this.comment=p.comment,this.unixPermissions=p.unixPermissions,this.dosPermissions=p.dosPermissions,this._data=v,this._dataBinary=p.binary,this.options={compression:p.compression,compressionOptions:p.compressionOptions}};c.prototype={internalStream:function(m){var v=null,p="string";try{if(!m)throw new Error("No output type specified.");p=m.toLowerCase();var g=p==="string"||p==="text";(p==="binarystring"||p==="text")&&(p="string"),v=this._decompressWorker();var y=!this._dataBinary;y&&!g&&(v=v.pipe(new a.Utf8EncodeWorker)),!y&&g&&(v=v.pipe(new a.Utf8DecodeWorker))}catch(b){v=new u("error"),v.error(b)}return new i(v,p,"")},async:function(m,v){return this.internalStream(m).accumulate(v)},nodeStream:function(m,v){return this.internalStream(m||"nodebuffer").toNodejsStream(v)},_compressWorker:function(m,v){if(this._data instanceof l&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var p=this._decompressWorker();return this._dataBinary||(p=p.pipe(new a.Utf8EncodeWorker)),l.createWorkerFrom(p,m,v)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<h.length;f++)c.prototype[h[f]]=d;r.exports=c},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,s){(function(i){var o=i.MutationObserver||i.WebKitMutationObserver,a;if(o){var l=0,u=new o(m),c=i.document.createTextNode("");u.observe(c,{characterData:!0}),a=function(){c.data=l=++l%2}}else if(!i.setImmediate&&typeof i.MessageChannel<"u"){var h=new i.MessageChannel;h.port1.onmessage=m,a=function(){h.port2.postMessage(0)}}else"document"in i&&"onreadystatechange"in i.document.createElement("script")?a=function(){var p=i.document.createElement("script");p.onreadystatechange=function(){m(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},i.document.documentElement.appendChild(p)}:a=function(){setTimeout(m,0)};var d,f=[];function m(){d=!0;for(var p,g,y=f.length;y;){for(g=f,f=[],p=-1;++p<y;)g[p]();y=f.length}d=!1}r.exports=v;function v(p){f.push(p)===1&&!d&&a()}}).call(this,typeof yn<"u"?yn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,s){var i=n("immediate");function o(){}var a={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];r.exports=h;function h(w){if(typeof w!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,w!==o&&v(this,w)}h.prototype.finally=function(w){if(typeof w!="function")return this;var C=this.constructor;return this.then(S,E);function S(T){function _(){return T}return C.resolve(w()).then(_)}function E(T){function _(){throw T}return C.resolve(w()).then(_)}},h.prototype.catch=function(w){return this.then(null,w)},h.prototype.then=function(w,C){if(typeof w!="function"&&this.state===u||typeof C!="function"&&this.state===l)return this;var S=new this.constructor(o);if(this.state!==c){var E=this.state===u?w:C;f(S,E,this.outcome)}else this.queue.push(new d(S,w,C));return S};function d(w,C,S){this.promise=w,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}d.prototype.callFulfilled=function(w){a.resolve(this.promise,w)},d.prototype.otherCallFulfilled=function(w){f(this.promise,this.onFulfilled,w)},d.prototype.callRejected=function(w){a.reject(this.promise,w)},d.prototype.otherCallRejected=function(w){f(this.promise,this.onRejected,w)};function f(w,C,S){i(function(){var E;try{E=C(S)}catch(T){return a.reject(w,T)}E===w?a.reject(w,new TypeError("Cannot resolve promise with itself")):a.resolve(w,E)})}a.resolve=function(w,C){var S=p(m,C);if(S.status==="error")return a.reject(w,S.value);var E=S.value;if(E)v(w,E);else{w.state=u,w.outcome=C;for(var T=-1,_=w.queue.length;++T<_;)w.queue[T].callFulfilled(C)}return w},a.reject=function(w,C){w.state=l,w.outcome=C;for(var S=-1,E=w.queue.length;++S<E;)w.queue[S].callRejected(C);return w};function m(w){var C=w&&w.then;if(w&&(typeof w=="object"||typeof w=="function")&&typeof C=="function")return function(){C.apply(w,arguments)}}function v(w,C){var S=!1;function E(L){S||(S=!0,a.reject(w,L))}function T(L){S||(S=!0,a.resolve(w,L))}function _(){C(T,E)}var A=p(_);A.status==="error"&&E(A.value)}function p(w,C){var S={};try{S.value=w(C),S.status="success"}catch(E){S.status="error",S.value=E}return S}h.resolve=g;function g(w){return w instanceof this?w:a.resolve(new this(o),w)}h.reject=y;function y(w){var C=new this(o);return a.reject(C,w)}h.all=b;function b(w){var C=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=w.length,E=!1;if(!S)return this.resolve([]);for(var T=new Array(S),_=0,A=-1,L=new this(o);++A<S;)W(w[A],A);return L;function W(K,R){C.resolve(K).then(M,function(U){E||(E=!0,a.reject(L,U))});function M(U){T[R]=U,++_===S&&!E&&(E=!0,a.resolve(L,T))}}}h.race=x;function x(w){var C=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=w.length,E=!1;if(!S)return this.resolve([]);for(var T=-1,_=new this(o);++T<S;)A(w[T]);return _;function A(L){C.resolve(L).then(function(W){E||(E=!0,a.resolve(_,W))},function(W){E||(E=!0,a.reject(_,W))})}}},{immediate:36}],38:[function(n,r,s){var i=n("./lib/utils/common").assign,o=n("./lib/deflate"),a=n("./lib/inflate"),l=n("./lib/zlib/constants"),u={};i(u,o,a,l),r.exports=u},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,s){var i=n("./zlib/deflate"),o=n("./utils/common"),a=n("./utils/strings"),l=n("./zlib/messages"),u=n("./zlib/zstream"),c=Object.prototype.toString,h=0,d=4,f=0,m=1,v=2,p=-1,g=0,y=8;function b(S){if(!(this instanceof b))return new b(S);this.options=o.assign({level:p,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:""},S||{});var E=this.options;E.raw&&E.windowBits>0?E.windowBits=-E.windowBits:E.gzip&&E.windowBits>0&&E.windowBits<16&&(E.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var T=i.deflateInit2(this.strm,E.level,E.method,E.windowBits,E.memLevel,E.strategy);if(T!==f)throw new Error(l[T]);if(E.header&&i.deflateSetHeader(this.strm,E.header),E.dictionary){var _;if(typeof E.dictionary=="string"?_=a.string2buf(E.dictionary):c.call(E.dictionary)==="[object ArrayBuffer]"?_=new Uint8Array(E.dictionary):_=E.dictionary,T=i.deflateSetDictionary(this.strm,_),T!==f)throw new Error(l[T]);this._dict_set=!0}}b.prototype.push=function(S,E){var T=this.strm,_=this.options.chunkSize,A,L;if(this.ended)return!1;L=E===~~E?E:E===!0?d:h,typeof S=="string"?T.input=a.string2buf(S):c.call(S)==="[object ArrayBuffer]"?T.input=new Uint8Array(S):T.input=S,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new o.Buf8(_),T.next_out=0,T.avail_out=_),A=i.deflate(T,L),A!==m&&A!==f)return this.onEnd(A),this.ended=!0,!1;(T.avail_out===0||T.avail_in===0&&(L===d||L===v))&&(this.options.to==="string"?this.onData(a.buf2binstring(o.shrinkBuf(T.output,T.next_out))):this.onData(o.shrinkBuf(T.output,T.next_out)))}while((T.avail_in>0||T.avail_out===0)&&A!==m);return L===d?(A=i.deflateEnd(this.strm),this.onEnd(A),this.ended=!0,A===f):(L===v&&(this.onEnd(f),T.avail_out=0),!0)},b.prototype.onData=function(S){this.chunks.push(S)},b.prototype.onEnd=function(S){S===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=S,this.msg=this.strm.msg};function x(S,E){var T=new b(E);if(T.push(S,!0),T.err)throw T.msg||l[T.err];return T.result}function w(S,E){return E=E||{},E.raw=!0,x(S,E)}function C(S,E){return E=E||{},E.gzip=!0,x(S,E)}s.Deflate=b,s.deflate=x,s.deflateRaw=w,s.gzip=C},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,s){var i=n("./zlib/inflate"),o=n("./utils/common"),a=n("./utils/strings"),l=n("./zlib/constants"),u=n("./zlib/messages"),c=n("./zlib/zstream"),h=n("./zlib/gzheader"),d=Object.prototype.toString;function f(p){if(!(this instanceof f))return new f(p);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},p||{});var g=this.options;g.raw&&g.windowBits>=0&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),g.windowBits>=0&&g.windowBits<16&&!(p&&p.windowBits)&&(g.windowBits+=32),g.windowBits>15&&g.windowBits<48&&(g.windowBits&15||(g.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var y=i.inflateInit2(this.strm,g.windowBits);if(y!==l.Z_OK)throw new Error(u[y]);this.header=new h,i.inflateGetHeader(this.strm,this.header)}f.prototype.push=function(p,g){var y=this.strm,b=this.options.chunkSize,x=this.options.dictionary,w,C,S,E,T,_,A=!1;if(this.ended)return!1;C=g===~~g?g:g===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof p=="string"?y.input=a.binstring2buf(p):d.call(p)==="[object ArrayBuffer]"?y.input=new Uint8Array(p):y.input=p,y.next_in=0,y.avail_in=y.input.length;do{if(y.avail_out===0&&(y.output=new o.Buf8(b),y.next_out=0,y.avail_out=b),w=i.inflate(y,l.Z_NO_FLUSH),w===l.Z_NEED_DICT&&x&&(typeof x=="string"?_=a.string2buf(x):d.call(x)==="[object ArrayBuffer]"?_=new Uint8Array(x):_=x,w=i.inflateSetDictionary(this.strm,_)),w===l.Z_BUF_ERROR&&A===!0&&(w=l.Z_OK,A=!1),w!==l.Z_STREAM_END&&w!==l.Z_OK)return this.onEnd(w),this.ended=!0,!1;y.next_out&&(y.avail_out===0||w===l.Z_STREAM_END||y.avail_in===0&&(C===l.Z_FINISH||C===l.Z_SYNC_FLUSH))&&(this.options.to==="string"?(S=a.utf8border(y.output,y.next_out),E=y.next_out-S,T=a.buf2string(y.output,S),y.next_out=E,y.avail_out=b-E,E&&o.arraySet(y.output,y.output,S,E,0),this.onData(T)):this.onData(o.shrinkBuf(y.output,y.next_out))),y.avail_in===0&&y.avail_out===0&&(A=!0)}while((y.avail_in>0||y.avail_out===0)&&w!==l.Z_STREAM_END);return w===l.Z_STREAM_END&&(C=l.Z_FINISH),C===l.Z_FINISH?(w=i.inflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===l.Z_OK):(C===l.Z_SYNC_FLUSH&&(this.onEnd(l.Z_OK),y.avail_out=0),!0)},f.prototype.onData=function(p){this.chunks.push(p)},f.prototype.onEnd=function(p){p===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg};function m(p,g){var y=new f(g);if(y.push(p,!0),y.err)throw y.msg||u[y.err];return y.result}function v(p,g){return g=g||{},g.raw=!0,m(p,g)}s.Inflate=f,s.inflate=m,s.inflateRaw=v,s.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var c=u.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var h in c)c.hasOwnProperty(h)&&(l[h]=c[h])}}return l},s.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var o={arraySet:function(l,u,c,h,d){if(u.subarray&&l.subarray){l.set(u.subarray(c,c+h),d);return}for(var f=0;f<h;f++)l[d+f]=u[c+f]},flattenChunks:function(l){var u,c,h,d,f,m;for(h=0,u=0,c=l.length;u<c;u++)h+=l[u].length;for(m=new Uint8Array(h),d=0,u=0,c=l.length;u<c;u++)f=l[u],m.set(f,d),d+=f.length;return m}},a={arraySet:function(l,u,c,h,d){for(var f=0;f<h;f++)l[d+f]=u[c+f]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,o)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,a))},s.setTyped(i)},{}],42:[function(n,r,s){var i=n("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new i.Buf8(256),u=0;u<256;u++)l[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;l[254]=l[254]=1,s.string2buf=function(h){var d,f,m,v,p,g=h.length,y=0;for(v=0;v<g;v++)f=h.charCodeAt(v),(f&64512)===55296&&v+1<g&&(m=h.charCodeAt(v+1),(m&64512)===56320&&(f=65536+(f-55296<<10)+(m-56320),v++)),y+=f<128?1:f<2048?2:f<65536?3:4;for(d=new i.Buf8(y),p=0,v=0;p<y;v++)f=h.charCodeAt(v),(f&64512)===55296&&v+1<g&&(m=h.charCodeAt(v+1),(m&64512)===56320&&(f=65536+(f-55296<<10)+(m-56320),v++)),f<128?d[p++]=f:f<2048?(d[p++]=192|f>>>6,d[p++]=128|f&63):f<65536?(d[p++]=224|f>>>12,d[p++]=128|f>>>6&63,d[p++]=128|f&63):(d[p++]=240|f>>>18,d[p++]=128|f>>>12&63,d[p++]=128|f>>>6&63,d[p++]=128|f&63);return d};function c(h,d){if(d<65537&&(h.subarray&&a||!h.subarray&&o))return String.fromCharCode.apply(null,i.shrinkBuf(h,d));for(var f="",m=0;m<d;m++)f+=String.fromCharCode(h[m]);return f}s.buf2binstring=function(h){return c(h,h.length)},s.binstring2buf=function(h){for(var d=new i.Buf8(h.length),f=0,m=d.length;f<m;f++)d[f]=h.charCodeAt(f);return d},s.buf2string=function(h,d){var f,m,v,p,g=d||h.length,y=new Array(g*2);for(m=0,f=0;f<g;){if(v=h[f++],v<128){y[m++]=v;continue}if(p=l[v],p>4){y[m++]=65533,f+=p-1;continue}for(v&=p===2?31:p===3?15:7;p>1&&f<g;)v=v<<6|h[f++]&63,p--;if(p>1){y[m++]=65533;continue}v<65536?y[m++]=v:(v-=65536,y[m++]=55296|v>>10&1023,y[m++]=56320|v&1023)}return c(y,m)},s.utf8border=function(h,d){var f;for(d=d||h.length,d>h.length&&(d=h.length),f=d-1;f>=0&&(h[f]&192)===128;)f--;return f<0||f===0?d:f+l[h[f]]>d?f:d}},{"./common":41}],43:[function(n,r,s){function i(o,a,l,u){for(var c=o&65535|0,h=o>>>16&65535|0,d=0;l!==0;){d=l>2e3?2e3:l,l-=d;do c=c+a[u++]|0,h=h+c|0;while(--d);c%=65521,h%=65521}return c|h<<16|0}r.exports=i},{}],44:[function(n,r,s){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,s){function i(){for(var l,u=[],c=0;c<256;c++){l=c;for(var h=0;h<8;h++)l=l&1?3988292384^l>>>1:l>>>1;u[c]=l}return u}var o=i();function a(l,u,c,h){var d=o,f=h+c;l^=-1;for(var m=h;m<f;m++)l=l>>>8^d[(l^u[m])&255];return l^-1}r.exports=a},{}],46:[function(n,r,s){var i=n("../utils/common"),o=n("./trees"),a=n("./adler32"),l=n("./crc32"),u=n("./messages"),c=0,h=1,d=3,f=4,m=5,v=0,p=1,g=-2,y=-3,b=-5,x=-1,w=1,C=2,S=3,E=4,T=0,_=2,A=8,L=9,W=15,K=8,R=29,M=256,U=M+1+R,D=30,B=19,X=2*U+1,ie=15,G=3,Z=258,de=Z+G+1,ge=32,ye=42,j=69,J=73,fe=91,ve=103,we=113,De=666,Pe=1,Ge=2,Xe=3,Je=4,Ze=3;function it(k,se){return k.msg=u[se],se}function dn(k){return(k<<1)-(k>4?9:0)}function dt(k){for(var se=k.length;--se>=0;)k[se]=0}function Lt(k){var se=k.state,re=se.pending;re>k.avail_out&&(re=k.avail_out),re!==0&&(i.arraySet(k.output,se.pending_buf,se.pending_out,re,k.next_out),k.next_out+=re,se.pending_out+=re,k.total_out+=re,k.avail_out-=re,se.pending-=re,se.pending===0&&(se.pending_out=0))}function at(k,se){o._tr_flush_block(k,k.block_start>=0?k.block_start:-1,k.strstart-k.block_start,se),k.block_start=k.strstart,Lt(k.strm)}function tt(k,se){k.pending_buf[k.pending++]=se}function Tt(k,se){k.pending_buf[k.pending++]=se>>>8&255,k.pending_buf[k.pending++]=se&255}function En(k,se,re,N){var q=k.avail_in;return q>N&&(q=N),q===0?0:(k.avail_in-=q,i.arraySet(se,k.input,k.next_in,q,re),k.state.wrap===1?k.adler=a(k.adler,se,q,re):k.state.wrap===2&&(k.adler=l(k.adler,se,q,re)),k.next_in+=q,k.total_in+=q,q)}function Pt(k,se){var re=k.max_chain_length,N=k.strstart,q,ue,$e=k.prev_length,Te=k.nice_match,Fe=k.strstart>k.w_size-de?k.strstart-(k.w_size-de):0,ot=k.window,Kn=k.w_mask,Rt=k.prev,vt=k.strstart+Z,$t=ot[N+$e-1],jt=ot[N+$e];k.prev_length>=k.good_match&&(re>>=2),Te>k.lookahead&&(Te=k.lookahead);do if(q=se,!(ot[q+$e]!==jt||ot[q+$e-1]!==$t||ot[q]!==ot[N]||ot[++q]!==ot[N+1])){N+=2,q++;do;while(ot[++N]===ot[++q]&&ot[++N]===ot[++q]&&ot[++N]===ot[++q]&&ot[++N]===ot[++q]&&ot[++N]===ot[++q]&&ot[++N]===ot[++q]&&ot[++N]===ot[++q]&&ot[++N]===ot[++q]&&N<vt);if(ue=Z-(vt-N),N=vt-Z,ue>$e){if(k.match_start=se,$e=ue,ue>=Te)break;$t=ot[N+$e-1],jt=ot[N+$e]}}while((se=Rt[se&Kn])>Fe&&--re!==0);return $e<=k.lookahead?$e:k.lookahead}function Wt(k){var se=k.w_size,re,N,q,ue,$e;do{if(ue=k.window_size-k.lookahead-k.strstart,k.strstart>=se+(se-de)){i.arraySet(k.window,k.window,se,se,0),k.match_start-=se,k.strstart-=se,k.block_start-=se,N=k.hash_size,re=N;do q=k.head[--re],k.head[re]=q>=se?q-se:0;while(--N);N=se,re=N;do q=k.prev[--re],k.prev[re]=q>=se?q-se:0;while(--N);ue+=se}if(k.strm.avail_in===0)break;if(N=En(k.strm,k.window,k.strstart+k.lookahead,ue),k.lookahead+=N,k.lookahead+k.insert>=G)for($e=k.strstart-k.insert,k.ins_h=k.window[$e],k.ins_h=(k.ins_h<<k.hash_shift^k.window[$e+1])&k.hash_mask;k.insert&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[$e+G-1])&k.hash_mask,k.prev[$e&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=$e,$e++,k.insert--,!(k.lookahead+k.insert<G)););}while(k.lookahead<de&&k.strm.avail_in!==0)}function In(k,se){var re=65535;for(re>k.pending_buf_size-5&&(re=k.pending_buf_size-5);;){if(k.lookahead<=1){if(Wt(k),k.lookahead===0&&se===c)return Pe;if(k.lookahead===0)break}k.strstart+=k.lookahead,k.lookahead=0;var N=k.block_start+re;if((k.strstart===0||k.strstart>=N)&&(k.lookahead=k.strstart-N,k.strstart=N,at(k,!1),k.strm.avail_out===0)||k.strstart-k.block_start>=k.w_size-de&&(at(k,!1),k.strm.avail_out===0))return Pe}return k.insert=0,se===f?(at(k,!0),k.strm.avail_out===0?Xe:Je):(k.strstart>k.block_start&&(at(k,!1),k.strm.avail_out===0),Pe)}function Ln(k,se){for(var re,N;;){if(k.lookahead<de){if(Wt(k),k.lookahead<de&&se===c)return Pe;if(k.lookahead===0)break}if(re=0,k.lookahead>=G&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+G-1])&k.hash_mask,re=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),re!==0&&k.strstart-re<=k.w_size-de&&(k.match_length=Pt(k,re)),k.match_length>=G)if(N=o._tr_tally(k,k.strstart-k.match_start,k.match_length-G),k.lookahead-=k.match_length,k.match_length<=k.max_lazy_match&&k.lookahead>=G){k.match_length--;do k.strstart++,k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+G-1])&k.hash_mask,re=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart;while(--k.match_length!==0);k.strstart++}else k.strstart+=k.match_length,k.match_length=0,k.ins_h=k.window[k.strstart],k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+1])&k.hash_mask;else N=o._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++;if(N&&(at(k,!1),k.strm.avail_out===0))return Pe}return k.insert=k.strstart<G-1?k.strstart:G-1,se===f?(at(k,!0),k.strm.avail_out===0?Xe:Je):k.last_lit&&(at(k,!1),k.strm.avail_out===0)?Pe:Ge}function Pn(k,se){for(var re,N,q;;){if(k.lookahead<de){if(Wt(k),k.lookahead<de&&se===c)return Pe;if(k.lookahead===0)break}if(re=0,k.lookahead>=G&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+G-1])&k.hash_mask,re=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),k.prev_length=k.match_length,k.prev_match=k.match_start,k.match_length=G-1,re!==0&&k.prev_length<k.max_lazy_match&&k.strstart-re<=k.w_size-de&&(k.match_length=Pt(k,re),k.match_length<=5&&(k.strategy===w||k.match_length===G&&k.strstart-k.match_start>4096)&&(k.match_length=G-1)),k.prev_length>=G&&k.match_length<=k.prev_length){q=k.strstart+k.lookahead-G,N=o._tr_tally(k,k.strstart-1-k.prev_match,k.prev_length-G),k.lookahead-=k.prev_length-1,k.prev_length-=2;do++k.strstart<=q&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+G-1])&k.hash_mask,re=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart);while(--k.prev_length!==0);if(k.match_available=0,k.match_length=G-1,k.strstart++,N&&(at(k,!1),k.strm.avail_out===0))return Pe}else if(k.match_available){if(N=o._tr_tally(k,0,k.window[k.strstart-1]),N&&at(k,!1),k.strstart++,k.lookahead--,k.strm.avail_out===0)return Pe}else k.match_available=1,k.strstart++,k.lookahead--}return k.match_available&&(N=o._tr_tally(k,0,k.window[k.strstart-1]),k.match_available=0),k.insert=k.strstart<G-1?k.strstart:G-1,se===f?(at(k,!0),k.strm.avail_out===0?Xe:Je):k.last_lit&&(at(k,!1),k.strm.avail_out===0)?Pe:Ge}function br(k,se){for(var re,N,q,ue,$e=k.window;;){if(k.lookahead<=Z){if(Wt(k),k.lookahead<=Z&&se===c)return Pe;if(k.lookahead===0)break}if(k.match_length=0,k.lookahead>=G&&k.strstart>0&&(q=k.strstart-1,N=$e[q],N===$e[++q]&&N===$e[++q]&&N===$e[++q])){ue=k.strstart+Z;do;while(N===$e[++q]&&N===$e[++q]&&N===$e[++q]&&N===$e[++q]&&N===$e[++q]&&N===$e[++q]&&N===$e[++q]&&N===$e[++q]&&q<ue);k.match_length=Z-(ue-q),k.match_length>k.lookahead&&(k.match_length=k.lookahead)}if(k.match_length>=G?(re=o._tr_tally(k,1,k.match_length-G),k.lookahead-=k.match_length,k.strstart+=k.match_length,k.match_length=0):(re=o._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++),re&&(at(k,!1),k.strm.avail_out===0))return Pe}return k.insert=0,se===f?(at(k,!0),k.strm.avail_out===0?Xe:Je):k.last_lit&&(at(k,!1),k.strm.avail_out===0)?Pe:Ge}function nr(k,se){for(var re;;){if(k.lookahead===0&&(Wt(k),k.lookahead===0)){if(se===c)return Pe;break}if(k.match_length=0,re=o._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++,re&&(at(k,!1),k.strm.avail_out===0))return Pe}return k.insert=0,se===f?(at(k,!0),k.strm.avail_out===0?Xe:Je):k.last_lit&&(at(k,!1),k.strm.avail_out===0)?Pe:Ge}function Gt(k,se,re,N,q){this.good_length=k,this.max_lazy=se,this.nice_length=re,this.max_chain=N,this.func=q}var Mn;Mn=[new Gt(0,0,0,0,In),new Gt(4,4,8,4,Ln),new Gt(4,5,16,8,Ln),new Gt(4,6,32,32,Ln),new Gt(4,4,16,16,Pn),new Gt(8,16,32,32,Pn),new Gt(8,16,128,128,Pn),new Gt(8,32,128,256,Pn),new Gt(32,128,258,1024,Pn),new Gt(32,258,258,4096,Pn)];function Ts(k){k.window_size=2*k.w_size,dt(k.head),k.max_lazy_match=Mn[k.level].max_lazy,k.good_match=Mn[k.level].good_length,k.nice_match=Mn[k.level].nice_length,k.max_chain_length=Mn[k.level].max_chain,k.strstart=0,k.block_start=0,k.lookahead=0,k.insert=0,k.match_length=k.prev_length=G-1,k.match_available=0,k.ins_h=0}function P(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=A,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(X*2),this.dyn_dtree=new i.Buf16((2*D+1)*2),this.bl_tree=new i.Buf16((2*B+1)*2),dt(this.dyn_ltree),dt(this.dyn_dtree),dt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(ie+1),this.heap=new i.Buf16(2*U+1),dt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*U+1),dt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ke(k){var se;return!k||!k.state?it(k,g):(k.total_in=k.total_out=0,k.data_type=_,se=k.state,se.pending=0,se.pending_out=0,se.wrap<0&&(se.wrap=-se.wrap),se.status=se.wrap?ye:we,k.adler=se.wrap===2?0:1,se.last_flush=c,o._tr_init(se),v)}function Ne(k){var se=ke(k);return se===v&&Ts(k.state),se}function We(k,se){return!k||!k.state||k.state.wrap!==2?g:(k.state.gzhead=se,v)}function $(k,se,re,N,q,ue){if(!k)return g;var $e=1;if(se===x&&(se=6),N<0?($e=0,N=-N):N>15&&($e=2,N-=16),q<1||q>L||re!==A||N<8||N>15||se<0||se>9||ue<0||ue>E)return it(k,g);N===8&&(N=9);var Te=new P;return k.state=Te,Te.strm=k,Te.wrap=$e,Te.gzhead=null,Te.w_bits=N,Te.w_size=1<<Te.w_bits,Te.w_mask=Te.w_size-1,Te.hash_bits=q+7,Te.hash_size=1<<Te.hash_bits,Te.hash_mask=Te.hash_size-1,Te.hash_shift=~~((Te.hash_bits+G-1)/G),Te.window=new i.Buf8(Te.w_size*2),Te.head=new i.Buf16(Te.hash_size),Te.prev=new i.Buf16(Te.w_size),Te.lit_bufsize=1<<q+6,Te.pending_buf_size=Te.lit_bufsize*4,Te.pending_buf=new i.Buf8(Te.pending_buf_size),Te.d_buf=1*Te.lit_bufsize,Te.l_buf=(1+2)*Te.lit_bufsize,Te.level=se,Te.strategy=ue,Te.method=re,Ne(k)}function V(k,se){return $(k,se,A,W,K,T)}function I(k,se){var re,N,q,ue;if(!k||!k.state||se>m||se<0)return k?it(k,g):g;if(N=k.state,!k.output||!k.input&&k.avail_in!==0||N.status===De&&se!==f)return it(k,k.avail_out===0?b:g);if(N.strm=k,re=N.last_flush,N.last_flush=se,N.status===ye)if(N.wrap===2)k.adler=0,tt(N,31),tt(N,139),tt(N,8),N.gzhead?(tt(N,(N.gzhead.text?1:0)+(N.gzhead.hcrc?2:0)+(N.gzhead.extra?4:0)+(N.gzhead.name?8:0)+(N.gzhead.comment?16:0)),tt(N,N.gzhead.time&255),tt(N,N.gzhead.time>>8&255),tt(N,N.gzhead.time>>16&255),tt(N,N.gzhead.time>>24&255),tt(N,N.level===9?2:N.strategy>=C||N.level<2?4:0),tt(N,N.gzhead.os&255),N.gzhead.extra&&N.gzhead.extra.length&&(tt(N,N.gzhead.extra.length&255),tt(N,N.gzhead.extra.length>>8&255)),N.gzhead.hcrc&&(k.adler=l(k.adler,N.pending_buf,N.pending,0)),N.gzindex=0,N.status=j):(tt(N,0),tt(N,0),tt(N,0),tt(N,0),tt(N,0),tt(N,N.level===9?2:N.strategy>=C||N.level<2?4:0),tt(N,Ze),N.status=we);else{var $e=A+(N.w_bits-8<<4)<<8,Te=-1;N.strategy>=C||N.level<2?Te=0:N.level<6?Te=1:N.level===6?Te=2:Te=3,$e|=Te<<6,N.strstart!==0&&($e|=ge),$e+=31-$e%31,N.status=we,Tt(N,$e),N.strstart!==0&&(Tt(N,k.adler>>>16),Tt(N,k.adler&65535)),k.adler=1}if(N.status===j)if(N.gzhead.extra){for(q=N.pending;N.gzindex<(N.gzhead.extra.length&65535)&&!(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>q&&(k.adler=l(k.adler,N.pending_buf,N.pending-q,q)),Lt(k),q=N.pending,N.pending===N.pending_buf_size));)tt(N,N.gzhead.extra[N.gzindex]&255),N.gzindex++;N.gzhead.hcrc&&N.pending>q&&(k.adler=l(k.adler,N.pending_buf,N.pending-q,q)),N.gzindex===N.gzhead.extra.length&&(N.gzindex=0,N.status=J)}else N.status=J;if(N.status===J)if(N.gzhead.name){q=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>q&&(k.adler=l(k.adler,N.pending_buf,N.pending-q,q)),Lt(k),q=N.pending,N.pending===N.pending_buf_size)){ue=1;break}N.gzindex<N.gzhead.name.length?ue=N.gzhead.name.charCodeAt(N.gzindex++)&255:ue=0,tt(N,ue)}while(ue!==0);N.gzhead.hcrc&&N.pending>q&&(k.adler=l(k.adler,N.pending_buf,N.pending-q,q)),ue===0&&(N.gzindex=0,N.status=fe)}else N.status=fe;if(N.status===fe)if(N.gzhead.comment){q=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>q&&(k.adler=l(k.adler,N.pending_buf,N.pending-q,q)),Lt(k),q=N.pending,N.pending===N.pending_buf_size)){ue=1;break}N.gzindex<N.gzhead.comment.length?ue=N.gzhead.comment.charCodeAt(N.gzindex++)&255:ue=0,tt(N,ue)}while(ue!==0);N.gzhead.hcrc&&N.pending>q&&(k.adler=l(k.adler,N.pending_buf,N.pending-q,q)),ue===0&&(N.status=ve)}else N.status=ve;if(N.status===ve&&(N.gzhead.hcrc?(N.pending+2>N.pending_buf_size&&Lt(k),N.pending+2<=N.pending_buf_size&&(tt(N,k.adler&255),tt(N,k.adler>>8&255),k.adler=0,N.status=we)):N.status=we),N.pending!==0){if(Lt(k),k.avail_out===0)return N.last_flush=-1,v}else if(k.avail_in===0&&dn(se)<=dn(re)&&se!==f)return it(k,b);if(N.status===De&&k.avail_in!==0)return it(k,b);if(k.avail_in!==0||N.lookahead!==0||se!==c&&N.status!==De){var Fe=N.strategy===C?nr(N,se):N.strategy===S?br(N,se):Mn[N.level].func(N,se);if((Fe===Xe||Fe===Je)&&(N.status=De),Fe===Pe||Fe===Xe)return k.avail_out===0&&(N.last_flush=-1),v;if(Fe===Ge&&(se===h?o._tr_align(N):se!==m&&(o._tr_stored_block(N,0,0,!1),se===d&&(dt(N.head),N.lookahead===0&&(N.strstart=0,N.block_start=0,N.insert=0))),Lt(k),k.avail_out===0))return N.last_flush=-1,v}return se!==f?v:N.wrap<=0?p:(N.wrap===2?(tt(N,k.adler&255),tt(N,k.adler>>8&255),tt(N,k.adler>>16&255),tt(N,k.adler>>24&255),tt(N,k.total_in&255),tt(N,k.total_in>>8&255),tt(N,k.total_in>>16&255),tt(N,k.total_in>>24&255)):(Tt(N,k.adler>>>16),Tt(N,k.adler&65535)),Lt(k),N.wrap>0&&(N.wrap=-N.wrap),N.pending!==0?v:p)}function ce(k){var se;return!k||!k.state?g:(se=k.state.status,se!==ye&&se!==j&&se!==J&&se!==fe&&se!==ve&&se!==we&&se!==De?it(k,g):(k.state=null,se===we?it(k,y):v))}function Ee(k,se){var re=se.length,N,q,ue,$e,Te,Fe,ot,Kn;if(!k||!k.state||(N=k.state,$e=N.wrap,$e===2||$e===1&&N.status!==ye||N.lookahead))return g;for($e===1&&(k.adler=a(k.adler,se,re,0)),N.wrap=0,re>=N.w_size&&($e===0&&(dt(N.head),N.strstart=0,N.block_start=0,N.insert=0),Kn=new i.Buf8(N.w_size),i.arraySet(Kn,se,re-N.w_size,N.w_size,0),se=Kn,re=N.w_size),Te=k.avail_in,Fe=k.next_in,ot=k.input,k.avail_in=re,k.next_in=0,k.input=se,Wt(N);N.lookahead>=G;){q=N.strstart,ue=N.lookahead-(G-1);do N.ins_h=(N.ins_h<<N.hash_shift^N.window[q+G-1])&N.hash_mask,N.prev[q&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=q,q++;while(--ue);N.strstart=q,N.lookahead=G-1,Wt(N)}return N.strstart+=N.lookahead,N.block_start=N.strstart,N.insert=N.lookahead,N.lookahead=0,N.match_length=N.prev_length=G-1,N.match_available=0,k.next_in=Fe,k.input=ot,k.avail_in=Te,N.wrap=$e,v}s.deflateInit=V,s.deflateInit2=$,s.deflateReset=Ne,s.deflateResetKeep=ke,s.deflateSetHeader=We,s.deflate=I,s.deflateEnd=ce,s.deflateSetDictionary=Ee,s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,s){function i(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}r.exports=i},{}],48:[function(n,r,s){var i=30,o=12;r.exports=function(l,u){var c,h,d,f,m,v,p,g,y,b,x,w,C,S,E,T,_,A,L,W,K,R,M,U,D;c=l.state,h=l.next_in,U=l.input,d=h+(l.avail_in-5),f=l.next_out,D=l.output,m=f-(u-l.avail_out),v=f+(l.avail_out-257),p=c.dmax,g=c.wsize,y=c.whave,b=c.wnext,x=c.window,w=c.hold,C=c.bits,S=c.lencode,E=c.distcode,T=(1<<c.lenbits)-1,_=(1<<c.distbits)-1;e:do{C<15&&(w+=U[h++]<<C,C+=8,w+=U[h++]<<C,C+=8),A=S[w&T];t:for(;;){if(L=A>>>24,w>>>=L,C-=L,L=A>>>16&255,L===0)D[f++]=A&65535;else if(L&16){W=A&65535,L&=15,L&&(C<L&&(w+=U[h++]<<C,C+=8),W+=w&(1<<L)-1,w>>>=L,C-=L),C<15&&(w+=U[h++]<<C,C+=8,w+=U[h++]<<C,C+=8),A=E[w&_];n:for(;;){if(L=A>>>24,w>>>=L,C-=L,L=A>>>16&255,L&16){if(K=A&65535,L&=15,C<L&&(w+=U[h++]<<C,C+=8,C<L&&(w+=U[h++]<<C,C+=8)),K+=w&(1<<L)-1,K>p){l.msg="invalid distance too far back",c.mode=i;break e}if(w>>>=L,C-=L,L=f-m,K>L){if(L=K-L,L>y&&c.sane){l.msg="invalid distance too far back",c.mode=i;break e}if(R=0,M=x,b===0){if(R+=g-L,L<W){W-=L;do D[f++]=x[R++];while(--L);R=f-K,M=D}}else if(b<L){if(R+=g+b-L,L-=b,L<W){W-=L;do D[f++]=x[R++];while(--L);if(R=0,b<W){L=b,W-=L;do D[f++]=x[R++];while(--L);R=f-K,M=D}}}else if(R+=b-L,L<W){W-=L;do D[f++]=x[R++];while(--L);R=f-K,M=D}for(;W>2;)D[f++]=M[R++],D[f++]=M[R++],D[f++]=M[R++],W-=3;W&&(D[f++]=M[R++],W>1&&(D[f++]=M[R++]))}else{R=f-K;do D[f++]=D[R++],D[f++]=D[R++],D[f++]=D[R++],W-=3;while(W>2);W&&(D[f++]=D[R++],W>1&&(D[f++]=D[R++]))}}else if(L&64){l.msg="invalid distance code",c.mode=i;break e}else{A=E[(A&65535)+(w&(1<<L)-1)];continue n}break}}else if(L&64)if(L&32){c.mode=o;break e}else{l.msg="invalid literal/length code",c.mode=i;break e}else{A=S[(A&65535)+(w&(1<<L)-1)];continue t}break}}while(h<d&&f<v);W=C>>3,h-=W,C-=W<<3,w&=(1<<C)-1,l.next_in=h,l.next_out=f,l.avail_in=h<d?5+(d-h):5-(h-d),l.avail_out=f<v?257+(v-f):257-(f-v),c.hold=w,c.bits=C}},{}],49:[function(n,r,s){var i=n("../utils/common"),o=n("./adler32"),a=n("./crc32"),l=n("./inffast"),u=n("./inftrees"),c=0,h=1,d=2,f=4,m=5,v=6,p=0,g=1,y=2,b=-2,x=-3,w=-4,C=-5,S=8,E=1,T=2,_=3,A=4,L=5,W=6,K=7,R=8,M=9,U=10,D=11,B=12,X=13,ie=14,G=15,Z=16,de=17,ge=18,ye=19,j=20,J=21,fe=22,ve=23,we=24,De=25,Pe=26,Ge=27,Xe=28,Je=29,Ze=30,it=31,dn=32,dt=852,Lt=592,at=15,tt=at;function Tt($){return($>>>24&255)+($>>>8&65280)+(($&65280)<<8)+(($&255)<<24)}function En(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Pt($){var V;return!$||!$.state?b:(V=$.state,$.total_in=$.total_out=V.total=0,$.msg="",V.wrap&&($.adler=V.wrap&1),V.mode=E,V.last=0,V.havedict=0,V.dmax=32768,V.head=null,V.hold=0,V.bits=0,V.lencode=V.lendyn=new i.Buf32(dt),V.distcode=V.distdyn=new i.Buf32(Lt),V.sane=1,V.back=-1,p)}function Wt($){var V;return!$||!$.state?b:(V=$.state,V.wsize=0,V.whave=0,V.wnext=0,Pt($))}function In($,V){var I,ce;return!$||!$.state||(ce=$.state,V<0?(I=0,V=-V):(I=(V>>4)+1,V<48&&(V&=15)),V&&(V<8||V>15))?b:(ce.window!==null&&ce.wbits!==V&&(ce.window=null),ce.wrap=I,ce.wbits=V,Wt($))}function Ln($,V){var I,ce;return $?(ce=new En,$.state=ce,ce.window=null,I=In($,V),I!==p&&($.state=null),I):b}function Pn($){return Ln($,tt)}var br=!0,nr,Gt;function Mn($){if(br){var V;for(nr=new i.Buf32(512),Gt=new i.Buf32(32),V=0;V<144;)$.lens[V++]=8;for(;V<256;)$.lens[V++]=9;for(;V<280;)$.lens[V++]=7;for(;V<288;)$.lens[V++]=8;for(u(h,$.lens,0,288,nr,0,$.work,{bits:9}),V=0;V<32;)$.lens[V++]=5;u(d,$.lens,0,32,Gt,0,$.work,{bits:5}),br=!1}$.lencode=nr,$.lenbits=9,$.distcode=Gt,$.distbits=5}function Ts($,V,I,ce){var Ee,k=$.state;return k.window===null&&(k.wsize=1<<k.wbits,k.wnext=0,k.whave=0,k.window=new i.Buf8(k.wsize)),ce>=k.wsize?(i.arraySet(k.window,V,I-k.wsize,k.wsize,0),k.wnext=0,k.whave=k.wsize):(Ee=k.wsize-k.wnext,Ee>ce&&(Ee=ce),i.arraySet(k.window,V,I-ce,Ee,k.wnext),ce-=Ee,ce?(i.arraySet(k.window,V,I-ce,ce,0),k.wnext=ce,k.whave=k.wsize):(k.wnext+=Ee,k.wnext===k.wsize&&(k.wnext=0),k.whave<k.wsize&&(k.whave+=Ee))),0}function P($,V){var I,ce,Ee,k,se,re,N,q,ue,$e,Te,Fe,ot,Kn,Rt=0,vt,$t,jt,Tn,Ti,_i,Yt,ct,Dt=new i.Buf8(4),Bn,kt,Ni=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!$||!$.state||!$.output||!$.input&&$.avail_in!==0)return b;I=$.state,I.mode===B&&(I.mode=X),se=$.next_out,Ee=$.output,N=$.avail_out,k=$.next_in,ce=$.input,re=$.avail_in,q=I.hold,ue=I.bits,$e=re,Te=N,ct=p;e:for(;;)switch(I.mode){case E:if(I.wrap===0){I.mode=X;break}for(;ue<16;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}if(I.wrap&2&&q===35615){I.check=0,Dt[0]=q&255,Dt[1]=q>>>8&255,I.check=a(I.check,Dt,2,0),q=0,ue=0,I.mode=T;break}if(I.flags=0,I.head&&(I.head.done=!1),!(I.wrap&1)||(((q&255)<<8)+(q>>8))%31){$.msg="incorrect header check",I.mode=Ze;break}if((q&15)!==S){$.msg="unknown compression method",I.mode=Ze;break}if(q>>>=4,ue-=4,Yt=(q&15)+8,I.wbits===0)I.wbits=Yt;else if(Yt>I.wbits){$.msg="invalid window size",I.mode=Ze;break}I.dmax=1<<Yt,$.adler=I.check=1,I.mode=q&512?U:B,q=0,ue=0;break;case T:for(;ue<16;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}if(I.flags=q,(I.flags&255)!==S){$.msg="unknown compression method",I.mode=Ze;break}if(I.flags&57344){$.msg="unknown header flags set",I.mode=Ze;break}I.head&&(I.head.text=q>>8&1),I.flags&512&&(Dt[0]=q&255,Dt[1]=q>>>8&255,I.check=a(I.check,Dt,2,0)),q=0,ue=0,I.mode=_;case _:for(;ue<32;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}I.head&&(I.head.time=q),I.flags&512&&(Dt[0]=q&255,Dt[1]=q>>>8&255,Dt[2]=q>>>16&255,Dt[3]=q>>>24&255,I.check=a(I.check,Dt,4,0)),q=0,ue=0,I.mode=A;case A:for(;ue<16;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}I.head&&(I.head.xflags=q&255,I.head.os=q>>8),I.flags&512&&(Dt[0]=q&255,Dt[1]=q>>>8&255,I.check=a(I.check,Dt,2,0)),q=0,ue=0,I.mode=L;case L:if(I.flags&1024){for(;ue<16;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}I.length=q,I.head&&(I.head.extra_len=q),I.flags&512&&(Dt[0]=q&255,Dt[1]=q>>>8&255,I.check=a(I.check,Dt,2,0)),q=0,ue=0}else I.head&&(I.head.extra=null);I.mode=W;case W:if(I.flags&1024&&(Fe=I.length,Fe>re&&(Fe=re),Fe&&(I.head&&(Yt=I.head.extra_len-I.length,I.head.extra||(I.head.extra=new Array(I.head.extra_len)),i.arraySet(I.head.extra,ce,k,Fe,Yt)),I.flags&512&&(I.check=a(I.check,ce,Fe,k)),re-=Fe,k+=Fe,I.length-=Fe),I.length))break e;I.length=0,I.mode=K;case K:if(I.flags&2048){if(re===0)break e;Fe=0;do Yt=ce[k+Fe++],I.head&&Yt&&I.length<65536&&(I.head.name+=String.fromCharCode(Yt));while(Yt&&Fe<re);if(I.flags&512&&(I.check=a(I.check,ce,Fe,k)),re-=Fe,k+=Fe,Yt)break e}else I.head&&(I.head.name=null);I.length=0,I.mode=R;case R:if(I.flags&4096){if(re===0)break e;Fe=0;do Yt=ce[k+Fe++],I.head&&Yt&&I.length<65536&&(I.head.comment+=String.fromCharCode(Yt));while(Yt&&Fe<re);if(I.flags&512&&(I.check=a(I.check,ce,Fe,k)),re-=Fe,k+=Fe,Yt)break e}else I.head&&(I.head.comment=null);I.mode=M;case M:if(I.flags&512){for(;ue<16;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}if(q!==(I.check&65535)){$.msg="header crc mismatch",I.mode=Ze;break}q=0,ue=0}I.head&&(I.head.hcrc=I.flags>>9&1,I.head.done=!0),$.adler=I.check=0,I.mode=B;break;case U:for(;ue<32;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}$.adler=I.check=Tt(q),q=0,ue=0,I.mode=D;case D:if(I.havedict===0)return $.next_out=se,$.avail_out=N,$.next_in=k,$.avail_in=re,I.hold=q,I.bits=ue,y;$.adler=I.check=1,I.mode=B;case B:if(V===m||V===v)break e;case X:if(I.last){q>>>=ue&7,ue-=ue&7,I.mode=Ge;break}for(;ue<3;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}switch(I.last=q&1,q>>>=1,ue-=1,q&3){case 0:I.mode=ie;break;case 1:if(Mn(I),I.mode=j,V===v){q>>>=2,ue-=2;break e}break;case 2:I.mode=de;break;case 3:$.msg="invalid block type",I.mode=Ze}q>>>=2,ue-=2;break;case ie:for(q>>>=ue&7,ue-=ue&7;ue<32;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}if((q&65535)!==(q>>>16^65535)){$.msg="invalid stored block lengths",I.mode=Ze;break}if(I.length=q&65535,q=0,ue=0,I.mode=G,V===v)break e;case G:I.mode=Z;case Z:if(Fe=I.length,Fe){if(Fe>re&&(Fe=re),Fe>N&&(Fe=N),Fe===0)break e;i.arraySet(Ee,ce,k,Fe,se),re-=Fe,k+=Fe,N-=Fe,se+=Fe,I.length-=Fe;break}I.mode=B;break;case de:for(;ue<14;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}if(I.nlen=(q&31)+257,q>>>=5,ue-=5,I.ndist=(q&31)+1,q>>>=5,ue-=5,I.ncode=(q&15)+4,q>>>=4,ue-=4,I.nlen>286||I.ndist>30){$.msg="too many length or distance symbols",I.mode=Ze;break}I.have=0,I.mode=ge;case ge:for(;I.have<I.ncode;){for(;ue<3;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}I.lens[Ni[I.have++]]=q&7,q>>>=3,ue-=3}for(;I.have<19;)I.lens[Ni[I.have++]]=0;if(I.lencode=I.lendyn,I.lenbits=7,Bn={bits:I.lenbits},ct=u(c,I.lens,0,19,I.lencode,0,I.work,Bn),I.lenbits=Bn.bits,ct){$.msg="invalid code lengths set",I.mode=Ze;break}I.have=0,I.mode=ye;case ye:for(;I.have<I.nlen+I.ndist;){for(;Rt=I.lencode[q&(1<<I.lenbits)-1],vt=Rt>>>24,$t=Rt>>>16&255,jt=Rt&65535,!(vt<=ue);){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}if(jt<16)q>>>=vt,ue-=vt,I.lens[I.have++]=jt;else{if(jt===16){for(kt=vt+2;ue<kt;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}if(q>>>=vt,ue-=vt,I.have===0){$.msg="invalid bit length repeat",I.mode=Ze;break}Yt=I.lens[I.have-1],Fe=3+(q&3),q>>>=2,ue-=2}else if(jt===17){for(kt=vt+3;ue<kt;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}q>>>=vt,ue-=vt,Yt=0,Fe=3+(q&7),q>>>=3,ue-=3}else{for(kt=vt+7;ue<kt;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}q>>>=vt,ue-=vt,Yt=0,Fe=11+(q&127),q>>>=7,ue-=7}if(I.have+Fe>I.nlen+I.ndist){$.msg="invalid bit length repeat",I.mode=Ze;break}for(;Fe--;)I.lens[I.have++]=Yt}}if(I.mode===Ze)break;if(I.lens[256]===0){$.msg="invalid code -- missing end-of-block",I.mode=Ze;break}if(I.lenbits=9,Bn={bits:I.lenbits},ct=u(h,I.lens,0,I.nlen,I.lencode,0,I.work,Bn),I.lenbits=Bn.bits,ct){$.msg="invalid literal/lengths set",I.mode=Ze;break}if(I.distbits=6,I.distcode=I.distdyn,Bn={bits:I.distbits},ct=u(d,I.lens,I.nlen,I.ndist,I.distcode,0,I.work,Bn),I.distbits=Bn.bits,ct){$.msg="invalid distances set",I.mode=Ze;break}if(I.mode=j,V===v)break e;case j:I.mode=J;case J:if(re>=6&&N>=258){$.next_out=se,$.avail_out=N,$.next_in=k,$.avail_in=re,I.hold=q,I.bits=ue,l($,Te),se=$.next_out,Ee=$.output,N=$.avail_out,k=$.next_in,ce=$.input,re=$.avail_in,q=I.hold,ue=I.bits,I.mode===B&&(I.back=-1);break}for(I.back=0;Rt=I.lencode[q&(1<<I.lenbits)-1],vt=Rt>>>24,$t=Rt>>>16&255,jt=Rt&65535,!(vt<=ue);){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}if($t&&!($t&240)){for(Tn=vt,Ti=$t,_i=jt;Rt=I.lencode[_i+((q&(1<<Tn+Ti)-1)>>Tn)],vt=Rt>>>24,$t=Rt>>>16&255,jt=Rt&65535,!(Tn+vt<=ue);){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}q>>>=Tn,ue-=Tn,I.back+=Tn}if(q>>>=vt,ue-=vt,I.back+=vt,I.length=jt,$t===0){I.mode=Pe;break}if($t&32){I.back=-1,I.mode=B;break}if($t&64){$.msg="invalid literal/length code",I.mode=Ze;break}I.extra=$t&15,I.mode=fe;case fe:if(I.extra){for(kt=I.extra;ue<kt;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}I.length+=q&(1<<I.extra)-1,q>>>=I.extra,ue-=I.extra,I.back+=I.extra}I.was=I.length,I.mode=ve;case ve:for(;Rt=I.distcode[q&(1<<I.distbits)-1],vt=Rt>>>24,$t=Rt>>>16&255,jt=Rt&65535,!(vt<=ue);){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}if(!($t&240)){for(Tn=vt,Ti=$t,_i=jt;Rt=I.distcode[_i+((q&(1<<Tn+Ti)-1)>>Tn)],vt=Rt>>>24,$t=Rt>>>16&255,jt=Rt&65535,!(Tn+vt<=ue);){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}q>>>=Tn,ue-=Tn,I.back+=Tn}if(q>>>=vt,ue-=vt,I.back+=vt,$t&64){$.msg="invalid distance code",I.mode=Ze;break}I.offset=jt,I.extra=$t&15,I.mode=we;case we:if(I.extra){for(kt=I.extra;ue<kt;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}I.offset+=q&(1<<I.extra)-1,q>>>=I.extra,ue-=I.extra,I.back+=I.extra}if(I.offset>I.dmax){$.msg="invalid distance too far back",I.mode=Ze;break}I.mode=De;case De:if(N===0)break e;if(Fe=Te-N,I.offset>Fe){if(Fe=I.offset-Fe,Fe>I.whave&&I.sane){$.msg="invalid distance too far back",I.mode=Ze;break}Fe>I.wnext?(Fe-=I.wnext,ot=I.wsize-Fe):ot=I.wnext-Fe,Fe>I.length&&(Fe=I.length),Kn=I.window}else Kn=Ee,ot=se-I.offset,Fe=I.length;Fe>N&&(Fe=N),N-=Fe,I.length-=Fe;do Ee[se++]=Kn[ot++];while(--Fe);I.length===0&&(I.mode=J);break;case Pe:if(N===0)break e;Ee[se++]=I.length,N--,I.mode=J;break;case Ge:if(I.wrap){for(;ue<32;){if(re===0)break e;re--,q|=ce[k++]<<ue,ue+=8}if(Te-=N,$.total_out+=Te,I.total+=Te,Te&&($.adler=I.check=I.flags?a(I.check,Ee,Te,se-Te):o(I.check,Ee,Te,se-Te)),Te=N,(I.flags?q:Tt(q))!==I.check){$.msg="incorrect data check",I.mode=Ze;break}q=0,ue=0}I.mode=Xe;case Xe:if(I.wrap&&I.flags){for(;ue<32;){if(re===0)break e;re--,q+=ce[k++]<<ue,ue+=8}if(q!==(I.total&4294967295)){$.msg="incorrect length check",I.mode=Ze;break}q=0,ue=0}I.mode=Je;case Je:ct=g;break e;case Ze:ct=x;break e;case it:return w;case dn:default:return b}return $.next_out=se,$.avail_out=N,$.next_in=k,$.avail_in=re,I.hold=q,I.bits=ue,(I.wsize||Te!==$.avail_out&&I.mode<Ze&&(I.mode<Ge||V!==f))&&Ts($,$.output,$.next_out,Te-$.avail_out),$e-=$.avail_in,Te-=$.avail_out,$.total_in+=$e,$.total_out+=Te,I.total+=Te,I.wrap&&Te&&($.adler=I.check=I.flags?a(I.check,Ee,Te,$.next_out-Te):o(I.check,Ee,Te,$.next_out-Te)),$.data_type=I.bits+(I.last?64:0)+(I.mode===B?128:0)+(I.mode===j||I.mode===G?256:0),($e===0&&Te===0||V===f)&&ct===p&&(ct=C),ct}function ke($){if(!$||!$.state)return b;var V=$.state;return V.window&&(V.window=null),$.state=null,p}function Ne($,V){var I;return!$||!$.state||(I=$.state,!(I.wrap&2))?b:(I.head=V,V.done=!1,p)}function We($,V){var I=V.length,ce,Ee,k;return!$||!$.state||(ce=$.state,ce.wrap!==0&&ce.mode!==D)?b:ce.mode===D&&(Ee=1,Ee=o(Ee,V,I,0),Ee!==ce.check)?x:(k=Ts($,V,I,I),k?(ce.mode=it,w):(ce.havedict=1,p))}s.inflateReset=Wt,s.inflateReset2=In,s.inflateResetKeep=Pt,s.inflateInit=Pn,s.inflateInit2=Ln,s.inflate=P,s.inflateEnd=ke,s.inflateGetHeader=Ne,s.inflateSetDictionary=We,s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,s){var i=n("../utils/common"),o=15,a=852,l=592,u=0,c=1,h=2,d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],f=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],v=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(g,y,b,x,w,C,S,E){var T=E.bits,_=0,A=0,L=0,W=0,K=0,R=0,M=0,U=0,D=0,B=0,X,ie,G,Z,de,ge=null,ye=0,j,J=new i.Buf16(o+1),fe=new i.Buf16(o+1),ve=null,we=0,De,Pe,Ge;for(_=0;_<=o;_++)J[_]=0;for(A=0;A<x;A++)J[y[b+A]]++;for(K=T,W=o;W>=1&&J[W]===0;W--);if(K>W&&(K=W),W===0)return w[C++]=1<<24|64<<16|0,w[C++]=1<<24|64<<16|0,E.bits=1,0;for(L=1;L<W&&J[L]===0;L++);for(K<L&&(K=L),U=1,_=1;_<=o;_++)if(U<<=1,U-=J[_],U<0)return-1;if(U>0&&(g===u||W!==1))return-1;for(fe[1]=0,_=1;_<o;_++)fe[_+1]=fe[_]+J[_];for(A=0;A<x;A++)y[b+A]!==0&&(S[fe[y[b+A]]++]=A);if(g===u?(ge=ve=S,j=19):g===c?(ge=d,ye-=257,ve=f,we-=257,j=256):(ge=m,ve=v,j=-1),B=0,A=0,_=L,de=C,R=K,M=0,G=-1,D=1<<K,Z=D-1,g===c&&D>a||g===h&&D>l)return 1;for(;;){De=_-M,S[A]<j?(Pe=0,Ge=S[A]):S[A]>j?(Pe=ve[we+S[A]],Ge=ge[ye+S[A]]):(Pe=32+64,Ge=0),X=1<<_-M,ie=1<<R,L=ie;do ie-=X,w[de+(B>>M)+ie]=De<<24|Pe<<16|Ge|0;while(ie!==0);for(X=1<<_-1;B&X;)X>>=1;if(X!==0?(B&=X-1,B+=X):B=0,A++,--J[_]===0){if(_===W)break;_=y[b+S[A]]}if(_>K&&(B&Z)!==G){for(M===0&&(M=K),de+=L,R=_-M,U=1<<R;R+M<W&&(U-=J[R+M],!(U<=0));)R++,U<<=1;if(D+=1<<R,g===c&&D>a||g===h&&D>l)return 1;G=B&Z,w[G]=K<<24|R<<16|de-C|0}}return B!==0&&(w[de+B]=_-M<<24|64<<16|0),E.bits=K,0}},{"../utils/common":41}],51:[function(n,r,s){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,s){var i=n("../utils/common"),o=4,a=0,l=1,u=2;function c(P){for(var ke=P.length;--ke>=0;)P[ke]=0}var h=0,d=1,f=2,m=3,v=258,p=29,g=256,y=g+1+p,b=30,x=19,w=2*y+1,C=15,S=16,E=7,T=256,_=16,A=17,L=18,W=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],K=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=512,D=new Array((y+2)*2);c(D);var B=new Array(b*2);c(B);var X=new Array(U);c(X);var ie=new Array(v-m+1);c(ie);var G=new Array(p);c(G);var Z=new Array(b);c(Z);function de(P,ke,Ne,We,$){this.static_tree=P,this.extra_bits=ke,this.extra_base=Ne,this.elems=We,this.max_length=$,this.has_stree=P&&P.length}var ge,ye,j;function J(P,ke){this.dyn_tree=P,this.max_code=0,this.stat_desc=ke}function fe(P){return P<256?X[P]:X[256+(P>>>7)]}function ve(P,ke){P.pending_buf[P.pending++]=ke&255,P.pending_buf[P.pending++]=ke>>>8&255}function we(P,ke,Ne){P.bi_valid>S-Ne?(P.bi_buf|=ke<<P.bi_valid&65535,ve(P,P.bi_buf),P.bi_buf=ke>>S-P.bi_valid,P.bi_valid+=Ne-S):(P.bi_buf|=ke<<P.bi_valid&65535,P.bi_valid+=Ne)}function De(P,ke,Ne){we(P,Ne[ke*2],Ne[ke*2+1])}function Pe(P,ke){var Ne=0;do Ne|=P&1,P>>>=1,Ne<<=1;while(--ke>0);return Ne>>>1}function Ge(P){P.bi_valid===16?(ve(P,P.bi_buf),P.bi_buf=0,P.bi_valid=0):P.bi_valid>=8&&(P.pending_buf[P.pending++]=P.bi_buf&255,P.bi_buf>>=8,P.bi_valid-=8)}function Xe(P,ke){var Ne=ke.dyn_tree,We=ke.max_code,$=ke.stat_desc.static_tree,V=ke.stat_desc.has_stree,I=ke.stat_desc.extra_bits,ce=ke.stat_desc.extra_base,Ee=ke.stat_desc.max_length,k,se,re,N,q,ue,$e=0;for(N=0;N<=C;N++)P.bl_count[N]=0;for(Ne[P.heap[P.heap_max]*2+1]=0,k=P.heap_max+1;k<w;k++)se=P.heap[k],N=Ne[Ne[se*2+1]*2+1]+1,N>Ee&&(N=Ee,$e++),Ne[se*2+1]=N,!(se>We)&&(P.bl_count[N]++,q=0,se>=ce&&(q=I[se-ce]),ue=Ne[se*2],P.opt_len+=ue*(N+q),V&&(P.static_len+=ue*($[se*2+1]+q)));if($e!==0){do{for(N=Ee-1;P.bl_count[N]===0;)N--;P.bl_count[N]--,P.bl_count[N+1]+=2,P.bl_count[Ee]--,$e-=2}while($e>0);for(N=Ee;N!==0;N--)for(se=P.bl_count[N];se!==0;)re=P.heap[--k],!(re>We)&&(Ne[re*2+1]!==N&&(P.opt_len+=(N-Ne[re*2+1])*Ne[re*2],Ne[re*2+1]=N),se--)}}function Je(P,ke,Ne){var We=new Array(C+1),$=0,V,I;for(V=1;V<=C;V++)We[V]=$=$+Ne[V-1]<<1;for(I=0;I<=ke;I++){var ce=P[I*2+1];ce!==0&&(P[I*2]=Pe(We[ce]++,ce))}}function Ze(){var P,ke,Ne,We,$,V=new Array(C+1);for(Ne=0,We=0;We<p-1;We++)for(G[We]=Ne,P=0;P<1<<W[We];P++)ie[Ne++]=We;for(ie[Ne-1]=We,$=0,We=0;We<16;We++)for(Z[We]=$,P=0;P<1<<K[We];P++)X[$++]=We;for($>>=7;We<b;We++)for(Z[We]=$<<7,P=0;P<1<<K[We]-7;P++)X[256+$++]=We;for(ke=0;ke<=C;ke++)V[ke]=0;for(P=0;P<=143;)D[P*2+1]=8,P++,V[8]++;for(;P<=255;)D[P*2+1]=9,P++,V[9]++;for(;P<=279;)D[P*2+1]=7,P++,V[7]++;for(;P<=287;)D[P*2+1]=8,P++,V[8]++;for(Je(D,y+1,V),P=0;P<b;P++)B[P*2+1]=5,B[P*2]=Pe(P,5);ge=new de(D,W,g+1,y,C),ye=new de(B,K,0,b,C),j=new de(new Array(0),R,0,x,E)}function it(P){var ke;for(ke=0;ke<y;ke++)P.dyn_ltree[ke*2]=0;for(ke=0;ke<b;ke++)P.dyn_dtree[ke*2]=0;for(ke=0;ke<x;ke++)P.bl_tree[ke*2]=0;P.dyn_ltree[T*2]=1,P.opt_len=P.static_len=0,P.last_lit=P.matches=0}function dn(P){P.bi_valid>8?ve(P,P.bi_buf):P.bi_valid>0&&(P.pending_buf[P.pending++]=P.bi_buf),P.bi_buf=0,P.bi_valid=0}function dt(P,ke,Ne,We){dn(P),We&&(ve(P,Ne),ve(P,~Ne)),i.arraySet(P.pending_buf,P.window,ke,Ne,P.pending),P.pending+=Ne}function Lt(P,ke,Ne,We){var $=ke*2,V=Ne*2;return P[$]<P[V]||P[$]===P[V]&&We[ke]<=We[Ne]}function at(P,ke,Ne){for(var We=P.heap[Ne],$=Ne<<1;$<=P.heap_len&&($<P.heap_len&&Lt(ke,P.heap[$+1],P.heap[$],P.depth)&&$++,!Lt(ke,We,P.heap[$],P.depth));)P.heap[Ne]=P.heap[$],Ne=$,$<<=1;P.heap[Ne]=We}function tt(P,ke,Ne){var We,$,V=0,I,ce;if(P.last_lit!==0)do We=P.pending_buf[P.d_buf+V*2]<<8|P.pending_buf[P.d_buf+V*2+1],$=P.pending_buf[P.l_buf+V],V++,We===0?De(P,$,ke):(I=ie[$],De(P,I+g+1,ke),ce=W[I],ce!==0&&($-=G[I],we(P,$,ce)),We--,I=fe(We),De(P,I,Ne),ce=K[I],ce!==0&&(We-=Z[I],we(P,We,ce)));while(V<P.last_lit);De(P,T,ke)}function Tt(P,ke){var Ne=ke.dyn_tree,We=ke.stat_desc.static_tree,$=ke.stat_desc.has_stree,V=ke.stat_desc.elems,I,ce,Ee=-1,k;for(P.heap_len=0,P.heap_max=w,I=0;I<V;I++)Ne[I*2]!==0?(P.heap[++P.heap_len]=Ee=I,P.depth[I]=0):Ne[I*2+1]=0;for(;P.heap_len<2;)k=P.heap[++P.heap_len]=Ee<2?++Ee:0,Ne[k*2]=1,P.depth[k]=0,P.opt_len--,$&&(P.static_len-=We[k*2+1]);for(ke.max_code=Ee,I=P.heap_len>>1;I>=1;I--)at(P,Ne,I);k=V;do I=P.heap[1],P.heap[1]=P.heap[P.heap_len--],at(P,Ne,1),ce=P.heap[1],P.heap[--P.heap_max]=I,P.heap[--P.heap_max]=ce,Ne[k*2]=Ne[I*2]+Ne[ce*2],P.depth[k]=(P.depth[I]>=P.depth[ce]?P.depth[I]:P.depth[ce])+1,Ne[I*2+1]=Ne[ce*2+1]=k,P.heap[1]=k++,at(P,Ne,1);while(P.heap_len>=2);P.heap[--P.heap_max]=P.heap[1],Xe(P,ke),Je(Ne,Ee,P.bl_count)}function En(P,ke,Ne){var We,$=-1,V,I=ke[0*2+1],ce=0,Ee=7,k=4;for(I===0&&(Ee=138,k=3),ke[(Ne+1)*2+1]=65535,We=0;We<=Ne;We++)V=I,I=ke[(We+1)*2+1],!(++ce<Ee&&V===I)&&(ce<k?P.bl_tree[V*2]+=ce:V!==0?(V!==$&&P.bl_tree[V*2]++,P.bl_tree[_*2]++):ce<=10?P.bl_tree[A*2]++:P.bl_tree[L*2]++,ce=0,$=V,I===0?(Ee=138,k=3):V===I?(Ee=6,k=3):(Ee=7,k=4))}function Pt(P,ke,Ne){var We,$=-1,V,I=ke[0*2+1],ce=0,Ee=7,k=4;for(I===0&&(Ee=138,k=3),We=0;We<=Ne;We++)if(V=I,I=ke[(We+1)*2+1],!(++ce<Ee&&V===I)){if(ce<k)do De(P,V,P.bl_tree);while(--ce!==0);else V!==0?(V!==$&&(De(P,V,P.bl_tree),ce--),De(P,_,P.bl_tree),we(P,ce-3,2)):ce<=10?(De(P,A,P.bl_tree),we(P,ce-3,3)):(De(P,L,P.bl_tree),we(P,ce-11,7));ce=0,$=V,I===0?(Ee=138,k=3):V===I?(Ee=6,k=3):(Ee=7,k=4)}}function Wt(P){var ke;for(En(P,P.dyn_ltree,P.l_desc.max_code),En(P,P.dyn_dtree,P.d_desc.max_code),Tt(P,P.bl_desc),ke=x-1;ke>=3&&P.bl_tree[M[ke]*2+1]===0;ke--);return P.opt_len+=3*(ke+1)+5+5+4,ke}function In(P,ke,Ne,We){var $;for(we(P,ke-257,5),we(P,Ne-1,5),we(P,We-4,4),$=0;$<We;$++)we(P,P.bl_tree[M[$]*2+1],3);Pt(P,P.dyn_ltree,ke-1),Pt(P,P.dyn_dtree,Ne-1)}function Ln(P){var ke=4093624447,Ne;for(Ne=0;Ne<=31;Ne++,ke>>>=1)if(ke&1&&P.dyn_ltree[Ne*2]!==0)return a;if(P.dyn_ltree[9*2]!==0||P.dyn_ltree[10*2]!==0||P.dyn_ltree[13*2]!==0)return l;for(Ne=32;Ne<g;Ne++)if(P.dyn_ltree[Ne*2]!==0)return l;return a}var Pn=!1;function br(P){Pn||(Ze(),Pn=!0),P.l_desc=new J(P.dyn_ltree,ge),P.d_desc=new J(P.dyn_dtree,ye),P.bl_desc=new J(P.bl_tree,j),P.bi_buf=0,P.bi_valid=0,it(P)}function nr(P,ke,Ne,We){we(P,(h<<1)+(We?1:0),3),dt(P,ke,Ne,!0)}function Gt(P){we(P,d<<1,3),De(P,T,D),Ge(P)}function Mn(P,ke,Ne,We){var $,V,I=0;P.level>0?(P.strm.data_type===u&&(P.strm.data_type=Ln(P)),Tt(P,P.l_desc),Tt(P,P.d_desc),I=Wt(P),$=P.opt_len+3+7>>>3,V=P.static_len+3+7>>>3,V<=$&&($=V)):$=V=Ne+5,Ne+4<=$&&ke!==-1?nr(P,ke,Ne,We):P.strategy===o||V===$?(we(P,(d<<1)+(We?1:0),3),tt(P,D,B)):(we(P,(f<<1)+(We?1:0),3),In(P,P.l_desc.max_code+1,P.d_desc.max_code+1,I+1),tt(P,P.dyn_ltree,P.dyn_dtree)),it(P),We&&dn(P)}function Ts(P,ke,Ne){return P.pending_buf[P.d_buf+P.last_lit*2]=ke>>>8&255,P.pending_buf[P.d_buf+P.last_lit*2+1]=ke&255,P.pending_buf[P.l_buf+P.last_lit]=Ne&255,P.last_lit++,ke===0?P.dyn_ltree[Ne*2]++:(P.matches++,ke--,P.dyn_ltree[(ie[Ne]+g+1)*2]++,P.dyn_dtree[fe(ke)*2]++),P.last_lit===P.lit_bufsize-1}s._tr_init=br,s._tr_stored_block=nr,s._tr_flush_block=Mn,s._tr_tally=Ts,s._tr_align=Gt},{"../utils/common":41}],53:[function(n,r,s){function i(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}r.exports=i},{}],54:[function(n,r,s){(function(i){(function(o,a){if(o.setImmediate)return;var l=1,u={},c=!1,h=o.document,d;function f(E){typeof E!="function"&&(E=new Function(""+E));for(var T=new Array(arguments.length-1),_=0;_<T.length;_++)T[_]=arguments[_+1];var A={callback:E,args:T};return u[l]=A,d(l),l++}function m(E){delete u[E]}function v(E){var T=E.callback,_=E.args;switch(_.length){case 0:T();break;case 1:T(_[0]);break;case 2:T(_[0],_[1]);break;case 3:T(_[0],_[1],_[2]);break;default:T.apply(a,_);break}}function p(E){if(c)setTimeout(p,0,E);else{var T=u[E];if(T){c=!0;try{v(T)}finally{m(E),c=!1}}}}function g(){d=function(E){process.nextTick(function(){p(E)})}}function y(){if(o.postMessage&&!o.importScripts){var E=!0,T=o.onmessage;return o.onmessage=function(){E=!1},o.postMessage("","*"),o.onmessage=T,E}}function b(){var E="setImmediate$"+Math.random()+"$",T=function(_){_.source===o&&typeof _.data=="string"&&_.data.indexOf(E)===0&&p(+_.data.slice(E.length))};o.addEventListener?o.addEventListener("message",T,!1):o.attachEvent("onmessage",T),d=function(_){o.postMessage(E+_,"*")}}function x(){var E=new MessageChannel;E.port1.onmessage=function(T){var _=T.data;p(_)},d=function(T){E.port2.postMessage(T)}}function w(){var E=h.documentElement;d=function(T){var _=h.createElement("script");_.onreadystatechange=function(){p(T),_.onreadystatechange=null,E.removeChild(_),_=null},E.appendChild(_)}}function C(){d=function(E){setTimeout(p,0,E)}}var S=Object.getPrototypeOf&&Object.getPrototypeOf(o);S=S&&S.setTimeout?S:o,{}.toString.call(o.process)==="[object process]"?g():y()?b():o.MessageChannel?x():h&&"onreadystatechange"in h.createElement("script")?w():C(),S.setImmediate=f,S.clearImmediate=m})(typeof self>"u"?typeof i>"u"?this:i:self)}).call(this,typeof yn<"u"?yn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(ID);var W6=ID.exports;Object.defineProperty(l0,"__esModule",{value:!0});l0.default=void 0;var au=je,G6=u0(Ol),DE=u0(mc),j6=u0(no),H6=u0(W6);function u0(t){return t&&t.__esModule?t:{default:t}}class q6{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new H6.default}catch{throw new Error("JSZip lib not loaded")}}open(e,n){return this.zip.loadAsync(e,{base64:n})}openUrl(e,n){return(0,G6.default)(e,"binary").then((function(r){return this.zip.loadAsync(r,{base64:n})}).bind(this))}request(e,n){var r=new au.defer,s,i=new j6.default(e);return n||(n=i.extension),n=="blob"?s=this.getBlob(e):s=this.getText(e),s?s.then((function(o){let a=this.handleResponse(o,n);r.resolve(a)}).bind(this)):r.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),r.promise}handleResponse(e,n){var r;return n=="json"?r=JSON.parse(e):(0,au.isXml)(n)?r=(0,au.parse)(e,"text/xml"):n=="xhtml"?r=(0,au.parse)(e,"application/xhtml+xml"):n=="html"||n=="htm"?r=(0,au.parse)(e,"text/html"):r=e,r}getBlob(e,n){var r=window.decodeURIComponent(e.substr(1)),s=this.zip.file(r);if(s)return n=n||DE.default.lookup(s.name),s.async("uint8array").then(function(i){return new Blob([i],{type:n})})}getText(e,n){var r=window.decodeURIComponent(e.substr(1)),s=this.zip.file(r);if(s)return s.async("string").then(function(i){return i})}getBase64(e,n){var r=window.decodeURIComponent(e.substr(1)),s=this.zip.file(r);if(s)return n=n||DE.default.lookup(s.name),s.async("base64").then(function(i){return"data:"+n+";base64,"+i})}createUrl(e,n){var r=new au.defer,s=window.URL||window.webkitURL||window.mozURL,i,o,a=n&&n.base64;return e in this.urlCache?(r.resolve(this.urlCache[e]),r.promise):(a?(o=this.getBase64(e),o&&o.then((function(l){this.urlCache[e]=l,r.resolve(l)}).bind(this))):(o=this.getBlob(e),o&&o.then((function(l){i=s.createObjectURL(l),this.urlCache[e]=i,r.resolve(i)}).bind(this))),o||r.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),r.promise)}revokeUrl(e){var n=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[e];r&&n.revokeObjectURL(r)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let n in this.urlCache)e.revokeObjectURL(n);this.zip=void 0,this.urlCache={}}}var K6=q6;l0.default=K6;var c0={},TD={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,s,i){function o(u,c){if(!s[u]){if(!r[u]){var h=typeof Ko=="function"&&Ko;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var f=s[u]={exports:{}};r[u][0].call(f.exports,function(m){var v=r[u][1][m];return o(v||m)},f,f.exports,n,r,s,i)}return s[u].exports}for(var a=typeof Ko=="function"&&Ko,l=0;l<i.length;l++)o(i[l]);return o}({1:[function(n,r,s){(function(i){var o=i.MutationObserver||i.WebKitMutationObserver,a;if(o){var l=0,u=new o(m),c=i.document.createTextNode("");u.observe(c,{characterData:!0}),a=function(){c.data=l=++l%2}}else if(!i.setImmediate&&typeof i.MessageChannel<"u"){var h=new i.MessageChannel;h.port1.onmessage=m,a=function(){h.port2.postMessage(0)}}else"document"in i&&"onreadystatechange"in i.document.createElement("script")?a=function(){var p=i.document.createElement("script");p.onreadystatechange=function(){m(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},i.document.documentElement.appendChild(p)}:a=function(){setTimeout(m,0)};var d,f=[];function m(){d=!0;for(var p,g,y=f.length;y;){for(g=f,f=[],p=-1;++p<y;)g[p]();y=f.length}d=!1}r.exports=v;function v(p){f.push(p)===1&&!d&&a()}}).call(this,typeof yn<"u"?yn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,r,s){var i=n(1);function o(){}var a={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];r.exports=h;function h(w){if(typeof w!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,w!==o&&v(this,w)}h.prototype.catch=function(w){return this.then(null,w)},h.prototype.then=function(w,C){if(typeof w!="function"&&this.state===u||typeof C!="function"&&this.state===l)return this;var S=new this.constructor(o);if(this.state!==c){var E=this.state===u?w:C;f(S,E,this.outcome)}else this.queue.push(new d(S,w,C));return S};function d(w,C,S){this.promise=w,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}d.prototype.callFulfilled=function(w){a.resolve(this.promise,w)},d.prototype.otherCallFulfilled=function(w){f(this.promise,this.onFulfilled,w)},d.prototype.callRejected=function(w){a.reject(this.promise,w)},d.prototype.otherCallRejected=function(w){f(this.promise,this.onRejected,w)};function f(w,C,S){i(function(){var E;try{E=C(S)}catch(T){return a.reject(w,T)}E===w?a.reject(w,new TypeError("Cannot resolve promise with itself")):a.resolve(w,E)})}a.resolve=function(w,C){var S=p(m,C);if(S.status==="error")return a.reject(w,S.value);var E=S.value;if(E)v(w,E);else{w.state=u,w.outcome=C;for(var T=-1,_=w.queue.length;++T<_;)w.queue[T].callFulfilled(C)}return w},a.reject=function(w,C){w.state=l,w.outcome=C;for(var S=-1,E=w.queue.length;++S<E;)w.queue[S].callRejected(C);return w};function m(w){var C=w&&w.then;if(w&&(typeof w=="object"||typeof w=="function")&&typeof C=="function")return function(){C.apply(w,arguments)}}function v(w,C){var S=!1;function E(L){S||(S=!0,a.reject(w,L))}function T(L){S||(S=!0,a.resolve(w,L))}function _(){C(T,E)}var A=p(_);A.status==="error"&&E(A.value)}function p(w,C){var S={};try{S.value=w(C),S.status="success"}catch(E){S.status="error",S.value=E}return S}h.resolve=g;function g(w){return w instanceof this?w:a.resolve(new this(o),w)}h.reject=y;function y(w){var C=new this(o);return a.reject(C,w)}h.all=b;function b(w){var C=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=w.length,E=!1;if(!S)return this.resolve([]);for(var T=new Array(S),_=0,A=-1,L=new this(o);++A<S;)W(w[A],A);return L;function W(K,R){C.resolve(K).then(M,function(U){E||(E=!0,a.reject(L,U))});function M(U){T[R]=U,++_===S&&!E&&(E=!0,a.resolve(L,T))}}}h.race=x;function x(w){var C=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=w.length,E=!1;if(!S)return this.resolve([]);for(var T=-1,_=new this(o);++T<S;)A(w[T]);return _;function A(L){C.resolve(L).then(function(W){E||(E=!0,a.resolve(_,W))},function(W){E||(E=!0,a.reject(_,W))})}}},{1:1}],3:[function(n,r,s){(function(i){typeof i.Promise!="function"&&(i.Promise=n(2))}).call(this,typeof yn<"u"?yn:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,r,s){var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O};function o(O,Y){if(!(O instanceof Y))throw new TypeError("Cannot call a class as a function")}function a(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var l=a();function u(){try{if(!l||!l.open)return!1;var O=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),Y=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!O||Y)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function c(O,Y){O=O||[],Y=Y||{};try{return new Blob(O,Y)}catch(ne){if(ne.name!=="TypeError")throw ne;for(var z=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,oe=new z,he=0;he<O.length;he+=1)oe.append(O[he]);return oe.getBlob(Y.type)}}typeof Promise>"u"&&n(3);var h=Promise;function d(O,Y){Y&&O.then(function(z){Y(null,z)},function(z){Y(z)})}function f(O,Y,z){typeof Y=="function"&&O.then(Y),typeof z=="function"&&O.catch(z)}function m(O){return typeof O!="string"&&(console.warn(O+" used as a key, but it is not a string."),O=String(O)),O}function v(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var p="local-forage-detect-blob-support",g=void 0,y={},b=Object.prototype.toString,x="readonly",w="readwrite";function C(O){for(var Y=O.length,z=new ArrayBuffer(Y),oe=new Uint8Array(z),he=0;he<Y;he++)oe[he]=O.charCodeAt(he);return z}function S(O){return new h(function(Y){var z=O.transaction(p,w),oe=c([""]);z.objectStore(p).put(oe,"key"),z.onabort=function(he){he.preventDefault(),he.stopPropagation(),Y(!1)},z.oncomplete=function(){var he=navigator.userAgent.match(/Chrome\/(\d+)/),ne=navigator.userAgent.match(/Edge\//);Y(ne||!he||parseInt(he[1],10)>=43)}}).catch(function(){return!1})}function E(O){return typeof g=="boolean"?h.resolve(g):S(O).then(function(Y){return g=Y,g})}function T(O){var Y=y[O.name],z={};z.promise=new h(function(oe,he){z.resolve=oe,z.reject=he}),Y.deferredOperations.push(z),Y.dbReady?Y.dbReady=Y.dbReady.then(function(){return z.promise}):Y.dbReady=z.promise}function _(O){var Y=y[O.name],z=Y.deferredOperations.pop();if(z)return z.resolve(),z.promise}function A(O,Y){var z=y[O.name],oe=z.deferredOperations.pop();if(oe)return oe.reject(Y),oe.promise}function L(O,Y){return new h(function(z,oe){if(y[O.name]=y[O.name]||G(),O.db)if(Y)T(O),O.db.close();else return z(O.db);var he=[O.name];Y&&he.push(O.version);var ne=l.open.apply(l,he);Y&&(ne.onupgradeneeded=function(Se){var _e=ne.result;try{_e.createObjectStore(O.storeName),Se.oldVersion<=1&&_e.createObjectStore(p)}catch(Oe){if(Oe.name==="ConstraintError")console.warn('The database "'+O.name+'" has been upgraded from version '+Se.oldVersion+" to version "+Se.newVersion+', but the storage "'+O.storeName+'" already exists.');else throw Oe}}),ne.onerror=function(Se){Se.preventDefault(),oe(ne.error)},ne.onsuccess=function(){var Se=ne.result;Se.onversionchange=function(_e){_e.target.close()},z(Se),_(O)}})}function W(O){return L(O,!1)}function K(O){return L(O,!0)}function R(O,Y){if(!O.db)return!0;var z=!O.db.objectStoreNames.contains(O.storeName),oe=O.version<O.db.version,he=O.version>O.db.version;if(oe&&(O.version!==Y&&console.warn('The database "'+O.name+`" can't be downgraded from version `+O.db.version+" to version "+O.version+"."),O.version=O.db.version),he||z){if(z){var ne=O.db.version+1;ne>O.version&&(O.version=ne)}return!0}return!1}function M(O){return new h(function(Y,z){var oe=new FileReader;oe.onerror=z,oe.onloadend=function(he){var ne=btoa(he.target.result||"");Y({__local_forage_encoded_blob:!0,data:ne,type:O.type})},oe.readAsBinaryString(O)})}function U(O){var Y=C(atob(O.data));return c([Y],{type:O.type})}function D(O){return O&&O.__local_forage_encoded_blob}function B(O){var Y=this,z=Y._initReady().then(function(){var oe=y[Y._dbInfo.name];if(oe&&oe.dbReady)return oe.dbReady});return f(z,O,O),z}function X(O){T(O);for(var Y=y[O.name],z=Y.forages,oe=0;oe<z.length;oe++){var he=z[oe];he._dbInfo.db&&(he._dbInfo.db.close(),he._dbInfo.db=null)}return O.db=null,W(O).then(function(ne){return O.db=ne,R(O)?K(O):ne}).then(function(ne){O.db=Y.db=ne;for(var Se=0;Se<z.length;Se++)z[Se]._dbInfo.db=ne}).catch(function(ne){throw A(O,ne),ne})}function ie(O,Y,z,oe){oe===void 0&&(oe=1);try{var he=O.db.transaction(O.storeName,Y);z(null,he)}catch(ne){if(oe>0&&(!O.db||ne.name==="InvalidStateError"||ne.name==="NotFoundError"))return h.resolve().then(function(){if(!O.db||ne.name==="NotFoundError"&&!O.db.objectStoreNames.contains(O.storeName)&&O.version<=O.db.version)return O.db&&(O.version=O.db.version+1),K(O)}).then(function(){return X(O).then(function(){ie(O,Y,z,oe-1)})}).catch(z);z(ne)}}function G(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Z(O){var Y=this,z={db:null};if(O)for(var oe in O)z[oe]=O[oe];var he=y[z.name];he||(he=G(),y[z.name]=he),he.forages.push(Y),Y._initReady||(Y._initReady=Y.ready,Y.ready=B);var ne=[];function Se(){return h.resolve()}for(var _e=0;_e<he.forages.length;_e++){var Oe=he.forages[_e];Oe!==Y&&ne.push(Oe._initReady().catch(Se))}var Le=he.forages.slice(0);return h.all(ne).then(function(){return z.db=he.db,W(z)}).then(function(Me){return z.db=Me,R(z,Y._defaultConfig.version)?K(z):Me}).then(function(Me){z.db=he.db=Me,Y._dbInfo=z;for(var Ye=0;Ye<Le.length;Ye++){var yt=Le[Ye];yt!==Y&&(yt._dbInfo.db=z.db,yt._dbInfo.version=z.version)}})}function de(O,Y){var z=this;O=m(O);var oe=new h(function(he,ne){z.ready().then(function(){ie(z._dbInfo,x,function(Se,_e){if(Se)return ne(Se);try{var Oe=_e.objectStore(z._dbInfo.storeName),Le=Oe.get(O);Le.onsuccess=function(){var Me=Le.result;Me===void 0&&(Me=null),D(Me)&&(Me=U(Me)),he(Me)},Le.onerror=function(){ne(Le.error)}}catch(Me){ne(Me)}})}).catch(ne)});return d(oe,Y),oe}function ge(O,Y){var z=this,oe=new h(function(he,ne){z.ready().then(function(){ie(z._dbInfo,x,function(Se,_e){if(Se)return ne(Se);try{var Oe=_e.objectStore(z._dbInfo.storeName),Le=Oe.openCursor(),Me=1;Le.onsuccess=function(){var Ye=Le.result;if(Ye){var yt=Ye.value;D(yt)&&(yt=U(yt));var Ot=O(yt,Ye.key,Me++);Ot!==void 0?he(Ot):Ye.continue()}else he()},Le.onerror=function(){ne(Le.error)}}catch(Ye){ne(Ye)}})}).catch(ne)});return d(oe,Y),oe}function ye(O,Y,z){var oe=this;O=m(O);var he=new h(function(ne,Se){var _e;oe.ready().then(function(){return _e=oe._dbInfo,b.call(Y)==="[object Blob]"?E(_e.db).then(function(Oe){return Oe?Y:M(Y)}):Y}).then(function(Oe){ie(oe._dbInfo,w,function(Le,Me){if(Le)return Se(Le);try{var Ye=Me.objectStore(oe._dbInfo.storeName);Oe===null&&(Oe=void 0);var yt=Ye.put(Oe,O);Me.oncomplete=function(){Oe===void 0&&(Oe=null),ne(Oe)},Me.onabort=Me.onerror=function(){var Ot=yt.error?yt.error:yt.transaction.error;Se(Ot)}}catch(Ot){Se(Ot)}})}).catch(Se)});return d(he,z),he}function j(O,Y){var z=this;O=m(O);var oe=new h(function(he,ne){z.ready().then(function(){ie(z._dbInfo,w,function(Se,_e){if(Se)return ne(Se);try{var Oe=_e.objectStore(z._dbInfo.storeName),Le=Oe.delete(O);_e.oncomplete=function(){he()},_e.onerror=function(){ne(Le.error)},_e.onabort=function(){var Me=Le.error?Le.error:Le.transaction.error;ne(Me)}}catch(Me){ne(Me)}})}).catch(ne)});return d(oe,Y),oe}function J(O){var Y=this,z=new h(function(oe,he){Y.ready().then(function(){ie(Y._dbInfo,w,function(ne,Se){if(ne)return he(ne);try{var _e=Se.objectStore(Y._dbInfo.storeName),Oe=_e.clear();Se.oncomplete=function(){oe()},Se.onabort=Se.onerror=function(){var Le=Oe.error?Oe.error:Oe.transaction.error;he(Le)}}catch(Le){he(Le)}})}).catch(he)});return d(z,O),z}function fe(O){var Y=this,z=new h(function(oe,he){Y.ready().then(function(){ie(Y._dbInfo,x,function(ne,Se){if(ne)return he(ne);try{var _e=Se.objectStore(Y._dbInfo.storeName),Oe=_e.count();Oe.onsuccess=function(){oe(Oe.result)},Oe.onerror=function(){he(Oe.error)}}catch(Le){he(Le)}})}).catch(he)});return d(z,O),z}function ve(O,Y){var z=this,oe=new h(function(he,ne){if(O<0){he(null);return}z.ready().then(function(){ie(z._dbInfo,x,function(Se,_e){if(Se)return ne(Se);try{var Oe=_e.objectStore(z._dbInfo.storeName),Le=!1,Me=Oe.openKeyCursor();Me.onsuccess=function(){var Ye=Me.result;if(!Ye){he(null);return}O===0||Le?he(Ye.key):(Le=!0,Ye.advance(O))},Me.onerror=function(){ne(Me.error)}}catch(Ye){ne(Ye)}})}).catch(ne)});return d(oe,Y),oe}function we(O){var Y=this,z=new h(function(oe,he){Y.ready().then(function(){ie(Y._dbInfo,x,function(ne,Se){if(ne)return he(ne);try{var _e=Se.objectStore(Y._dbInfo.storeName),Oe=_e.openKeyCursor(),Le=[];Oe.onsuccess=function(){var Me=Oe.result;if(!Me){oe(Le);return}Le.push(Me.key),Me.continue()},Oe.onerror=function(){he(Oe.error)}}catch(Me){he(Me)}})}).catch(he)});return d(z,O),z}function De(O,Y){Y=v.apply(this,arguments);var z=this.config();O=typeof O!="function"&&O||{},O.name||(O.name=O.name||z.name,O.storeName=O.storeName||z.storeName);var oe=this,he;if(!O.name)he=h.reject("Invalid arguments");else{var ne=O.name===z.name&&oe._dbInfo.db,Se=ne?h.resolve(oe._dbInfo.db):W(O).then(function(_e){var Oe=y[O.name],Le=Oe.forages;Oe.db=_e;for(var Me=0;Me<Le.length;Me++)Le[Me]._dbInfo.db=_e;return _e});O.storeName?he=Se.then(function(_e){if(_e.objectStoreNames.contains(O.storeName)){var Oe=_e.version+1;T(O);var Le=y[O.name],Me=Le.forages;_e.close();for(var Ye=0;Ye<Me.length;Ye++){var yt=Me[Ye];yt._dbInfo.db=null,yt._dbInfo.version=Oe}var Ot=new h(function(Mt,zn){var _n=l.open(O.name,Oe);_n.onerror=function(_s){var Lc=_n.result;Lc.close(),zn(_s)},_n.onupgradeneeded=function(){var _s=_n.result;_s.deleteObjectStore(O.storeName)},_n.onsuccess=function(){var _s=_n.result;_s.close(),Mt(_s)}});return Ot.then(function(Mt){Le.db=Mt;for(var zn=0;zn<Me.length;zn++){var _n=Me[zn];_n._dbInfo.db=Mt,_(_n._dbInfo)}}).catch(function(Mt){throw(A(O,Mt)||h.resolve()).catch(function(){}),Mt})}}):he=Se.then(function(_e){T(O);var Oe=y[O.name],Le=Oe.forages;_e.close();for(var Me=0;Me<Le.length;Me++){var Ye=Le[Me];Ye._dbInfo.db=null}var yt=new h(function(Ot,Mt){var zn=l.deleteDatabase(O.name);zn.onerror=function(){var _n=zn.result;_n&&_n.close(),Mt(zn.error)},zn.onblocked=function(){console.warn('dropInstance blocked for database "'+O.name+'" until all open connections are closed')},zn.onsuccess=function(){var _n=zn.result;_n&&_n.close(),Ot(_n)}});return yt.then(function(Ot){Oe.db=Ot;for(var Mt=0;Mt<Le.length;Mt++){var zn=Le[Mt];_(zn._dbInfo)}}).catch(function(Ot){throw(A(O,Ot)||h.resolve()).catch(function(){}),Ot})})}return d(he,Y),he}var Pe={_driver:"asyncStorage",_initStorage:Z,_support:u(),iterate:ge,getItem:de,setItem:ye,removeItem:j,clear:J,length:fe,key:ve,keys:we,dropInstance:De};function Ge(){return typeof openDatabase=="function"}var Xe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Je="~~local_forage_type~",Ze=/^~~local_forage_type~([^~]+)~/,it="__lfsc__:",dn=it.length,dt="arbf",Lt="blob",at="si08",tt="ui08",Tt="uic8",En="si16",Pt="si32",Wt="ur16",In="ui32",Ln="fl32",Pn="fl64",br=dn+dt.length,nr=Object.prototype.toString;function Gt(O){var Y=O.length*.75,z=O.length,oe,he=0,ne,Se,_e,Oe;O[O.length-1]==="="&&(Y--,O[O.length-2]==="="&&Y--);var Le=new ArrayBuffer(Y),Me=new Uint8Array(Le);for(oe=0;oe<z;oe+=4)ne=Xe.indexOf(O[oe]),Se=Xe.indexOf(O[oe+1]),_e=Xe.indexOf(O[oe+2]),Oe=Xe.indexOf(O[oe+3]),Me[he++]=ne<<2|Se>>4,Me[he++]=(Se&15)<<4|_e>>2,Me[he++]=(_e&3)<<6|Oe&63;return Le}function Mn(O){var Y=new Uint8Array(O),z="",oe;for(oe=0;oe<Y.length;oe+=3)z+=Xe[Y[oe]>>2],z+=Xe[(Y[oe]&3)<<4|Y[oe+1]>>4],z+=Xe[(Y[oe+1]&15)<<2|Y[oe+2]>>6],z+=Xe[Y[oe+2]&63];return Y.length%3===2?z=z.substring(0,z.length-1)+"=":Y.length%3===1&&(z=z.substring(0,z.length-2)+"=="),z}function Ts(O,Y){var z="";if(O&&(z=nr.call(O)),O&&(z==="[object ArrayBuffer]"||O.buffer&&nr.call(O.buffer)==="[object ArrayBuffer]")){var oe,he=it;O instanceof ArrayBuffer?(oe=O,he+=dt):(oe=O.buffer,z==="[object Int8Array]"?he+=at:z==="[object Uint8Array]"?he+=tt:z==="[object Uint8ClampedArray]"?he+=Tt:z==="[object Int16Array]"?he+=En:z==="[object Uint16Array]"?he+=Wt:z==="[object Int32Array]"?he+=Pt:z==="[object Uint32Array]"?he+=In:z==="[object Float32Array]"?he+=Ln:z==="[object Float64Array]"?he+=Pn:Y(new Error("Failed to get type for BinaryArray"))),Y(he+Mn(oe))}else if(z==="[object Blob]"){var ne=new FileReader;ne.onload=function(){var Se=Je+O.type+"~"+Mn(this.result);Y(it+Lt+Se)},ne.readAsArrayBuffer(O)}else try{Y(JSON.stringify(O))}catch(Se){console.error("Couldn't convert value into a JSON string: ",O),Y(null,Se)}}function P(O){if(O.substring(0,dn)!==it)return JSON.parse(O);var Y=O.substring(br),z=O.substring(dn,br),oe;if(z===Lt&&Ze.test(Y)){var he=Y.match(Ze);oe=he[1],Y=Y.substring(he[0].length)}var ne=Gt(Y);switch(z){case dt:return ne;case Lt:return c([ne],{type:oe});case at:return new Int8Array(ne);case tt:return new Uint8Array(ne);case Tt:return new Uint8ClampedArray(ne);case En:return new Int16Array(ne);case Wt:return new Uint16Array(ne);case Pt:return new Int32Array(ne);case In:return new Uint32Array(ne);case Ln:return new Float32Array(ne);case Pn:return new Float64Array(ne);default:throw new Error("Unkown type: "+z)}}var ke={serialize:Ts,deserialize:P,stringToBuffer:Gt,bufferToString:Mn};function Ne(O,Y,z,oe){O.executeSql("CREATE TABLE IF NOT EXISTS "+Y.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],z,oe)}function We(O){var Y=this,z={db:null};if(O)for(var oe in O)z[oe]=typeof O[oe]!="string"?O[oe].toString():O[oe];var he=new h(function(ne,Se){try{z.db=openDatabase(z.name,String(z.version),z.description,z.size)}catch(_e){return Se(_e)}z.db.transaction(function(_e){Ne(_e,z,function(){Y._dbInfo=z,ne()},function(Oe,Le){Se(Le)})},Se)});return z.serializer=ke,he}function $(O,Y,z,oe,he,ne){O.executeSql(z,oe,he,function(Se,_e){_e.code===_e.SYNTAX_ERR?Se.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[Y.storeName],function(Oe,Le){Le.rows.length?ne(Oe,_e):Ne(Oe,Y,function(){Oe.executeSql(z,oe,he,ne)},ne)},ne):ne(Se,_e)},ne)}function V(O,Y){var z=this;O=m(O);var oe=new h(function(he,ne){z.ready().then(function(){var Se=z._dbInfo;Se.db.transaction(function(_e){$(_e,Se,"SELECT * FROM "+Se.storeName+" WHERE key = ? LIMIT 1",[O],function(Oe,Le){var Me=Le.rows.length?Le.rows.item(0).value:null;Me&&(Me=Se.serializer.deserialize(Me)),he(Me)},function(Oe,Le){ne(Le)})})}).catch(ne)});return d(oe,Y),oe}function I(O,Y){var z=this,oe=new h(function(he,ne){z.ready().then(function(){var Se=z._dbInfo;Se.db.transaction(function(_e){$(_e,Se,"SELECT * FROM "+Se.storeName,[],function(Oe,Le){for(var Me=Le.rows,Ye=Me.length,yt=0;yt<Ye;yt++){var Ot=Me.item(yt),Mt=Ot.value;if(Mt&&(Mt=Se.serializer.deserialize(Mt)),Mt=O(Mt,Ot.key,yt+1),Mt!==void 0){he(Mt);return}}he()},function(Oe,Le){ne(Le)})})}).catch(ne)});return d(oe,Y),oe}function ce(O,Y,z,oe){var he=this;O=m(O);var ne=new h(function(Se,_e){he.ready().then(function(){Y===void 0&&(Y=null);var Oe=Y,Le=he._dbInfo;Le.serializer.serialize(Y,function(Me,Ye){Ye?_e(Ye):Le.db.transaction(function(yt){$(yt,Le,"INSERT OR REPLACE INTO "+Le.storeName+" (key, value) VALUES (?, ?)",[O,Me],function(){Se(Oe)},function(Ot,Mt){_e(Mt)})},function(yt){if(yt.code===yt.QUOTA_ERR){if(oe>0){Se(ce.apply(he,[O,Oe,z,oe-1]));return}_e(yt)}})})}).catch(_e)});return d(ne,z),ne}function Ee(O,Y,z){return ce.apply(this,[O,Y,z,1])}function k(O,Y){var z=this;O=m(O);var oe=new h(function(he,ne){z.ready().then(function(){var Se=z._dbInfo;Se.db.transaction(function(_e){$(_e,Se,"DELETE FROM "+Se.storeName+" WHERE key = ?",[O],function(){he()},function(Oe,Le){ne(Le)})})}).catch(ne)});return d(oe,Y),oe}function se(O){var Y=this,z=new h(function(oe,he){Y.ready().then(function(){var ne=Y._dbInfo;ne.db.transaction(function(Se){$(Se,ne,"DELETE FROM "+ne.storeName,[],function(){oe()},function(_e,Oe){he(Oe)})})}).catch(he)});return d(z,O),z}function re(O){var Y=this,z=new h(function(oe,he){Y.ready().then(function(){var ne=Y._dbInfo;ne.db.transaction(function(Se){$(Se,ne,"SELECT COUNT(key) as c FROM "+ne.storeName,[],function(_e,Oe){var Le=Oe.rows.item(0).c;oe(Le)},function(_e,Oe){he(Oe)})})}).catch(he)});return d(z,O),z}function N(O,Y){var z=this,oe=new h(function(he,ne){z.ready().then(function(){var Se=z._dbInfo;Se.db.transaction(function(_e){$(_e,Se,"SELECT key FROM "+Se.storeName+" WHERE id = ? LIMIT 1",[O+1],function(Oe,Le){var Me=Le.rows.length?Le.rows.item(0).key:null;he(Me)},function(Oe,Le){ne(Le)})})}).catch(ne)});return d(oe,Y),oe}function q(O){var Y=this,z=new h(function(oe,he){Y.ready().then(function(){var ne=Y._dbInfo;ne.db.transaction(function(Se){$(Se,ne,"SELECT key FROM "+ne.storeName,[],function(_e,Oe){for(var Le=[],Me=0;Me<Oe.rows.length;Me++)Le.push(Oe.rows.item(Me).key);oe(Le)},function(_e,Oe){he(Oe)})})}).catch(he)});return d(z,O),z}function ue(O){return new h(function(Y,z){O.transaction(function(oe){oe.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(he,ne){for(var Se=[],_e=0;_e<ne.rows.length;_e++)Se.push(ne.rows.item(_e).name);Y({db:O,storeNames:Se})},function(he,ne){z(ne)})},function(oe){z(oe)})})}function $e(O,Y){Y=v.apply(this,arguments);var z=this.config();O=typeof O!="function"&&O||{},O.name||(O.name=O.name||z.name,O.storeName=O.storeName||z.storeName);var oe=this,he;return O.name?he=new h(function(ne){var Se;O.name===z.name?Se=oe._dbInfo.db:Se=openDatabase(O.name,"","",0),O.storeName?ne({db:Se,storeNames:[O.storeName]}):ne(ue(Se))}).then(function(ne){return new h(function(Se,_e){ne.db.transaction(function(Oe){function Le(Ot){return new h(function(Mt,zn){Oe.executeSql("DROP TABLE IF EXISTS "+Ot,[],function(){Mt()},function(_n,_s){zn(_s)})})}for(var Me=[],Ye=0,yt=ne.storeNames.length;Ye<yt;Ye++)Me.push(Le(ne.storeNames[Ye]));h.all(Me).then(function(){Se()}).catch(function(Ot){_e(Ot)})},function(Oe){_e(Oe)})})}):he=h.reject("Invalid arguments"),d(he,Y),he}var Te={_driver:"webSQLStorage",_initStorage:We,_support:Ge(),iterate:I,getItem:V,setItem:Ee,removeItem:k,clear:se,length:re,key:N,keys:q,dropInstance:$e};function Fe(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function ot(O,Y){var z=O.name+"/";return O.storeName!==Y.storeName&&(z+=O.storeName+"/"),z}function Kn(){var O="_localforage_support_test";try{return localStorage.setItem(O,!0),localStorage.removeItem(O),!1}catch{return!0}}function Rt(){return!Kn()||localStorage.length>0}function vt(O){var Y=this,z={};if(O)for(var oe in O)z[oe]=O[oe];return z.keyPrefix=ot(O,Y._defaultConfig),Rt()?(Y._dbInfo=z,z.serializer=ke,h.resolve()):h.reject()}function $t(O){var Y=this,z=Y.ready().then(function(){for(var oe=Y._dbInfo.keyPrefix,he=localStorage.length-1;he>=0;he--){var ne=localStorage.key(he);ne.indexOf(oe)===0&&localStorage.removeItem(ne)}});return d(z,O),z}function jt(O,Y){var z=this;O=m(O);var oe=z.ready().then(function(){var he=z._dbInfo,ne=localStorage.getItem(he.keyPrefix+O);return ne&&(ne=he.serializer.deserialize(ne)),ne});return d(oe,Y),oe}function Tn(O,Y){var z=this,oe=z.ready().then(function(){for(var he=z._dbInfo,ne=he.keyPrefix,Se=ne.length,_e=localStorage.length,Oe=1,Le=0;Le<_e;Le++){var Me=localStorage.key(Le);if(Me.indexOf(ne)===0){var Ye=localStorage.getItem(Me);if(Ye&&(Ye=he.serializer.deserialize(Ye)),Ye=O(Ye,Me.substring(Se),Oe++),Ye!==void 0)return Ye}}});return d(oe,Y),oe}function Ti(O,Y){var z=this,oe=z.ready().then(function(){var he=z._dbInfo,ne;try{ne=localStorage.key(O)}catch{ne=null}return ne&&(ne=ne.substring(he.keyPrefix.length)),ne});return d(oe,Y),oe}function _i(O){var Y=this,z=Y.ready().then(function(){for(var oe=Y._dbInfo,he=localStorage.length,ne=[],Se=0;Se<he;Se++){var _e=localStorage.key(Se);_e.indexOf(oe.keyPrefix)===0&&ne.push(_e.substring(oe.keyPrefix.length))}return ne});return d(z,O),z}function Yt(O){var Y=this,z=Y.keys().then(function(oe){return oe.length});return d(z,O),z}function ct(O,Y){var z=this;O=m(O);var oe=z.ready().then(function(){var he=z._dbInfo;localStorage.removeItem(he.keyPrefix+O)});return d(oe,Y),oe}function Dt(O,Y,z){var oe=this;O=m(O);var he=oe.ready().then(function(){Y===void 0&&(Y=null);var ne=Y;return new h(function(Se,_e){var Oe=oe._dbInfo;Oe.serializer.serialize(Y,function(Le,Me){if(Me)_e(Me);else try{localStorage.setItem(Oe.keyPrefix+O,Le),Se(ne)}catch(Ye){(Ye.name==="QuotaExceededError"||Ye.name==="NS_ERROR_DOM_QUOTA_REACHED")&&_e(Ye),_e(Ye)}})})});return d(he,z),he}function Bn(O,Y){if(Y=v.apply(this,arguments),O=typeof O!="function"&&O||{},!O.name){var z=this.config();O.name=O.name||z.name,O.storeName=O.storeName||z.storeName}var oe=this,he;return O.name?he=new h(function(ne){O.storeName?ne(ot(O,oe._defaultConfig)):ne(O.name+"/")}).then(function(ne){for(var Se=localStorage.length-1;Se>=0;Se--){var _e=localStorage.key(Se);_e.indexOf(ne)===0&&localStorage.removeItem(_e)}}):he=h.reject("Invalid arguments"),d(he,Y),he}var kt={_driver:"localStorageWrapper",_initStorage:vt,_support:Fe(),iterate:Tn,getItem:jt,setItem:Dt,removeItem:ct,clear:$t,length:Yt,key:Ti,keys:_i,dropInstance:Bn},Ni=function(Y,z){return Y===z||typeof Y=="number"&&typeof z=="number"&&isNaN(Y)&&isNaN(z)},rp=function(Y,z){for(var oe=Y.length,he=0;he<oe;){if(Ni(Y[he],z))return!0;he++}return!1},sp=Array.isArray||function(O){return Object.prototype.toString.call(O)==="[object Array]"},Fc={},hS={},Zl={INDEXEDDB:Pe,WEBSQL:Te,LOCALSTORAGE:kt},_P=[Zl.INDEXEDDB._driver,Zl.WEBSQL._driver,Zl.LOCALSTORAGE._driver],ip=["dropInstance"],Gv=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ip),NP={description:"",driver:_P.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function $P(O,Y){O[Y]=function(){var z=arguments;return O.ready().then(function(){return O[Y].apply(O,z)})}}function jv(){for(var O=1;O<arguments.length;O++){var Y=arguments[O];if(Y)for(var z in Y)Y.hasOwnProperty(z)&&(sp(Y[z])?arguments[0][z]=Y[z].slice():arguments[0][z]=Y[z])}return arguments[0]}var DP=function(){function O(Y){o(this,O);for(var z in Zl)if(Zl.hasOwnProperty(z)){var oe=Zl[z],he=oe._driver;this[z]=he,Fc[he]||this.defineDriver(oe)}this._defaultConfig=jv({},NP),this._config=jv({},this._defaultConfig,Y),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return O.prototype.config=function(z){if((typeof z>"u"?"undefined":i(z))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var oe in z){if(oe==="storeName"&&(z[oe]=z[oe].replace(/\W/g,"_")),oe==="version"&&typeof z[oe]!="number")return new Error("Database version must be a number.");this._config[oe]=z[oe]}return"driver"in z&&z.driver?this.setDriver(this._config.driver):!0}else return typeof z=="string"?this._config[z]:this._config},O.prototype.defineDriver=function(z,oe,he){var ne=new h(function(Se,_e){try{var Oe=z._driver,Le=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!z._driver){_e(Le);return}for(var Me=Gv.concat("_initStorage"),Ye=0,yt=Me.length;Ye<yt;Ye++){var Ot=Me[Ye],Mt=!rp(ip,Ot);if((Mt||z[Ot])&&typeof z[Ot]!="function"){_e(Le);return}}var zn=function(){for(var Lc=function(OP){return function(){var FP=new Error("Method "+OP+" is not implemented by the current driver"),dS=h.reject(FP);return d(dS,arguments[arguments.length-1]),dS}},Hv=0,RP=ip.length;Hv<RP;Hv++){var qv=ip[Hv];z[qv]||(z[qv]=Lc(qv))}};zn();var _n=function(Lc){Fc[Oe]&&console.info("Redefining LocalForage driver: "+Oe),Fc[Oe]=z,hS[Oe]=Lc,Se()};"_support"in z?z._support&&typeof z._support=="function"?z._support().then(_n,_e):_n(!!z._support):_n(!0)}catch(_s){_e(_s)}});return f(ne,oe,he),ne},O.prototype.driver=function(){return this._driver||null},O.prototype.getDriver=function(z,oe,he){var ne=Fc[z]?h.resolve(Fc[z]):h.reject(new Error("Driver not found."));return f(ne,oe,he),ne},O.prototype.getSerializer=function(z){var oe=h.resolve(ke);return f(oe,z),oe},O.prototype.ready=function(z){var oe=this,he=oe._driverSet.then(function(){return oe._ready===null&&(oe._ready=oe._initDriver()),oe._ready});return f(he,z,z),he},O.prototype.setDriver=function(z,oe,he){var ne=this;sp(z)||(z=[z]);var Se=this._getSupportedDrivers(z);function _e(){ne._config.driver=ne.driver()}function Oe(Ye){return ne._extend(Ye),_e(),ne._ready=ne._initStorage(ne._config),ne._ready}function Le(Ye){return function(){var yt=0;function Ot(){for(;yt<Ye.length;){var Mt=Ye[yt];return yt++,ne._dbInfo=null,ne._ready=null,ne.getDriver(Mt).then(Oe).catch(Ot)}_e();var zn=new Error("No available storage method found.");return ne._driverSet=h.reject(zn),ne._driverSet}return Ot()}}var Me=this._driverSet!==null?this._driverSet.catch(function(){return h.resolve()}):h.resolve();return this._driverSet=Me.then(function(){var Ye=Se[0];return ne._dbInfo=null,ne._ready=null,ne.getDriver(Ye).then(function(yt){ne._driver=yt._driver,_e(),ne._wrapLibraryMethodsWithReady(),ne._initDriver=Le(Se)})}).catch(function(){_e();var Ye=new Error("No available storage method found.");return ne._driverSet=h.reject(Ye),ne._driverSet}),f(this._driverSet,oe,he),this._driverSet},O.prototype.supports=function(z){return!!hS[z]},O.prototype._extend=function(z){jv(this,z)},O.prototype._getSupportedDrivers=function(z){for(var oe=[],he=0,ne=z.length;he<ne;he++){var Se=z[he];this.supports(Se)&&oe.push(Se)}return oe},O.prototype._wrapLibraryMethodsWithReady=function(){for(var z=0,oe=Gv.length;z<oe;z++)$P(this,Gv[z])},O.prototype.createInstance=function(z){return new O(z)},O}(),AP=new DP;r.exports=AP},{3:3}]},{},[4])(4)})})(TD);var X6=TD.exports;Object.defineProperty(c0,"__esModule",{value:!0});c0.default=void 0;var oo=je,Y6=Fd(Ol),Ly=Fd(mc),Z6=Fd(no),Q6=Fd(to),AE=Fd(X6);function Fd(t){return t&&t.__esModule?t:{default:t}}class _D{constructor(e,n,r){this.urlCache={},this.storage=void 0,this.name=e,this.requester=n||Y6.default,this.resolver=r,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;typeof AE.default>"u"&&(e=AE.default),this.storage=e.createInstance({name:this.name})}catch{throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let n=navigator.onLine;this.online=n,n?this.emit("online",this):this.emit("offline",this)}add(e,n){let r=e.resources.map(s=>{let{href:i}=s,o=this.resolver(i),a=window.encodeURIComponent(o);return this.storage.getItem(a).then(l=>!l||n?this.requester(o,"binary").then(u=>this.storage.setItem(a,u)):l)});return Promise.all(r)}put(e,n,r){let s=window.encodeURIComponent(e);return this.storage.getItem(s).then(i=>i||this.requester(e,"binary",n,r).then(o=>this.storage.setItem(s,o)))}request(e,n,r,s){return this.online?this.requester(e,n,r,s).then(i=>(this.put(e),i)):this.retrieve(e,n)}retrieve(e,n){new oo.defer;var r,s=new Z6.default(e);return n||(n=s.extension),n=="blob"?r=this.getBlob(e):r=this.getText(e),r.then(i=>{var o=new oo.defer,a;return i?(a=this.handleResponse(i,n),o.resolve(a)):o.reject({message:"File not found in storage: "+e,stack:new Error().stack}),o.promise})}handleResponse(e,n){var r;return n=="json"?r=JSON.parse(e):(0,oo.isXml)(n)?r=(0,oo.parse)(e,"text/xml"):n=="xhtml"?r=(0,oo.parse)(e,"application/xhtml+xml"):n=="html"||n=="htm"?r=(0,oo.parse)(e,"text/html"):r=e,r}getBlob(e,n){let r=window.encodeURIComponent(e);return this.storage.getItem(r).then(function(s){if(s)return n=n||Ly.default.lookup(e),new Blob([s],{type:n})})}getText(e,n){let r=window.encodeURIComponent(e);return n=n||Ly.default.lookup(e),this.storage.getItem(r).then(function(s){var i=new oo.defer,o=new FileReader,a;if(s)return a=new Blob([s],{type:n}),o.addEventListener("loadend",()=>{i.resolve(o.result)}),o.readAsText(a,n),i.promise})}getBase64(e,n){let r=window.encodeURIComponent(e);return n=n||Ly.default.lookup(e),this.storage.getItem(r).then(s=>{var i=new oo.defer,o=new FileReader,a;if(s)return a=new Blob([s],{type:n}),o.addEventListener("loadend",()=>{i.resolve(o.result)}),o.readAsDataURL(a,n),i.promise})}createUrl(e,n){var r=new oo.defer,s=window.URL||window.webkitURL||window.mozURL,i,o,a=n&&n.base64;return e in this.urlCache?(r.resolve(this.urlCache[e]),r.promise):(a?(o=this.getBase64(e),o&&o.then((function(l){this.urlCache[e]=l,r.resolve(l)}).bind(this))):(o=this.getBlob(e),o&&o.then((function(l){i=s.createObjectURL(l),this.urlCache[e]=i,r.resolve(i)}).bind(this))),o||r.reject({message:"File not found in storage: "+e,stack:new Error().stack}),r.promise)}revokeUrl(e){var n=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[e];r&&n.revokeObjectURL(r)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let n in this.urlCache)e.revokeObjectURL(n);this.urlCache={},this.removeListeners()}}(0,Q6.default)(_D.prototype);var J6=_D;c0.default=J6;var h0={};Object.defineProperty(h0,"__esModule",{value:!0});h0.default=void 0;var RE=je;class e5{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const n=(0,RE.qs)(e,"display_options");return n?((0,RE.qsa)(n,"option").forEach(s=>{let i="";switch(s.childNodes.length&&(i=s.childNodes[0].nodeValue),s.attributes.name.value){case"interactive":this.interactive=i;break;case"fixed-layout":this.fixedLayout=i;break;case"open-to-spread":this.openToSpread=i;break;case"orientation-lock":this.orientationLock=i;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}var t5=e5;h0.default=t5;Object.defineProperty(Sd,"__esModule",{value:!0});Sd.default=void 0;var n5=Ar(to),ri=je,Mo=Ar(Rl),OE=Ar(no),r5=Ar(Gg),s5=Ar(Hg),i5=Ar(qg),FE=Ar(Kg),Py=Ar(Xg),o5=Ar(Yg),My=Ar(Qg),a5=Ar(gc),l5=Ar(l0),LE=Ar(Ol),u5=Ar(jr),c5=Ar(c0),By=Ar(h0),PE=or;function Ar(t){return t&&t.__esModule?t:{default:t}}const ME="META-INF/container.xml",h5="META-INF/com.apple.ibooks.display-options.xml",si={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class ND{constructor(e,n){typeof n>"u"&&typeof e!="string"&&!(e instanceof Blob)&&!(e instanceof ArrayBuffer)&&(n=e,e=void 0),this.settings=(0,ri.extend)(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),(0,ri.extend)(this.settings,n),this.opening=new ri.defer,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new ri.defer,spine:new ri.defer,metadata:new ri.defer,cover:new ri.defer,navigation:new ri.defer,pageList:new ri.defer,resources:new ri.defer,displayOptions:new ri.defer},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||LE.default,this.spine=new r5.default,this.locations=new s5.default(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(r=>{var s=new Error("Cannot load book at "+e);this.emit(PE.EVENTS.BOOK.OPEN_FAILED,s)})}open(e,n){var r,s=n||this.determineType(e);return s===si.BINARY?(this.archived=!0,this.url=new Mo.default("/",""),r=this.openEpub(e)):s===si.BASE64?(this.archived=!0,this.url=new Mo.default("/",""),r=this.openEpub(e,s)):s===si.EPUB?(this.archived=!0,this.url=new Mo.default("/",""),r=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):s==si.OPF?(this.url=new Mo.default(e),r=this.openPackaging(this.url.Path.toString())):s==si.MANIFEST?(this.url=new Mo.default(e),r=this.openManifest(this.url.Path.toString())):(this.url=new Mo.default(e),r=this.openContainer(ME).then(this.openPackaging.bind(this))),r}openEpub(e,n){return this.unarchive(e,n||this.settings.encoding).then(()=>this.openContainer(ME)).then(r=>this.openPackaging(r))}openContainer(e){return this.load(e).then(n=>(this.container=new i5.default(n),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new OE.default(e),this.load(e).then(n=>(this.packaging=new FE.default(n),this.unpack(this.packaging)))}openManifest(e){return this.path=new OE.default(e),this.load(e).then(n=>(this.packaging=new FE.default,this.packaging.load(n),this.unpack(this.packaging)))}load(e){var n=this.resolve(e);return this.archived?this.archive.request(n):this.request(n,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,n){if(e){var r=e,s=e.indexOf("://")>-1;return s?e:(this.path&&(r=this.path.resolve(e)),n!=!1&&this.url&&(r=this.url.resolve(r)),r)}}canonical(e){var n=e;return e?(this.settings.canonical?n=this.settings.canonical(e):n=this.resolve(e,!0),n):""}determineType(e){var n,r,s;if(this.settings.encoding==="base64")return si.BASE64;if(typeof e!="string")return si.BINARY;if(n=new Mo.default(e),r=n.path(),s=r.extension,s&&(s=s.replace(/\?.*$/,"")),!s)return si.DIRECTORY;if(s==="epub")return si.EPUB;if(s==="opf")return si.OPF;if(s==="json")return si.MANIFEST}unpack(e){this.package=e,this.packaging.metadata.layout===""?this.load(this.url.resolve(h5)).then(n=>{this.displayOptions=new By.default(n),this.loading.displayOptions.resolve(this.displayOptions)}).catch(n=>{this.displayOptions=new By.default,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new By.default,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new o5.default(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(n=>{console.error(n)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let n=e.navPath||e.ncxPath,r=e.toc;return r?new Promise((s,i)=>{this.navigation=new Py.default(r),e.pageList&&(this.pageList=new My.default(e.pageList)),s(this.navigation)}):n?this.load(n,"xml").then(s=>(this.navigation=new Py.default(s),this.pageList=new My.default(s),this.navigation)):new Promise((s,i)=>{this.navigation=new Py.default,this.pageList=new My.default,s(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,n){return this.rendition=new a5.default(this,n),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,n){return this.archive=new l5.default,this.archive.open(e,n)}store(e){let n=this.settings.replacements&&this.settings.replacements!=="none",r=this.url,s=this.settings.requestMethod||LE.default.bind(this);return this.storage=new c5.default(e,s,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let i=(o,a)=>{a.output=this.resources.substitute(o,a.url)};this.resources.settings.replacements=n||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new Mo.default("/",""),this.spine.hooks.serialize.register(i)}),this.storage.on("online",()=>{this.url=r,this.spine.hooks.serialize.deregister(i)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,n)=>{n.output=this.resources.substitute(e,n.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var n=new u5.default(e),r=this.spine.get(n.spinePos),s=this.load.bind(this);return r?r.load(s).then(function(i){var o=n.toRange(r.document);return o}):new Promise((i,o)=>{o("CFI could not be found")})}key(e){var n=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${PE.EPUBJS_VERSION}:${n}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}(0,n5.default)(ND.prototype);var d5=ND;Sd.default=d5;var d0={};Object.defineProperty(d0,"__esModule",{value:!0});d0.default=void 0;var $D=Ll(Sd),f5=Ll(gc),p5=Ll(jr),m5=Ll(Fl),g5=v5(je),DD=or;Ll(Ad);Ll(vc);Ll(Od);function AD(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(AD=function(r){return r?n:e})(t)}function v5(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=AD(e);if(n&&n.has(t))return n.get(t);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(i!=="default"&&Object.prototype.hasOwnProperty.call(t,i)){var o=s?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=t[i]}return r.default=t,n&&n.set(t,r),r}function Ll(t){return t&&t.__esModule?t:{default:t}}function Pl(t,e){return new $D.default(t,e)}Pl.VERSION=DD.EPUBJS_VERSION;typeof yn<"u"&&(yn.EPUBJS_VERSION=DD.EPUBJS_VERSION);Pl.Book=$D.default;Pl.Rendition=f5.default;Pl.Contents=m5.default;Pl.CFI=p5.default;Pl.utils=g5;var y5=Pl;d0.default=y5;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Book",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(t,"Contents",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"EpubCFI",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"Layout",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"Rendition",{enumerable:!0,get:function(){return r.default}}),t.default=void 0;var e=a(Sd),n=a(jr),r=a(gc),s=a(Fl),i=a($d),o=a(d0);function a(u){return u&&u.__esModule?u:{default:u}}var l=o.default;t.default=l})(g$);var Ld={};Object.defineProperty(Ld,"__esModule",{value:!0});Ld.EpubViewStyle=void 0;var x5={viewHolder:{position:"relative",height:"100%",width:"100%"},view:{height:"100%"}};Ld.EpubViewStyle=x5;Object.defineProperty(zg,"__esModule",{value:!0});zg.default=void 0;var Np=C5(Ce),Or=RD(m$),b5=RD(g$),w5=Ld;function RD(t){return t&&t.__esModule?t:{default:t}}function OD(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(OD=function(s){return s?n:e})(t)}function C5(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||ml(t)!=="object"&&typeof t!="function")return{default:t};var n=OD(e);if(n&&n.has(t))return n.get(t);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(i!=="default"&&Object.prototype.hasOwnProperty.call(t,i)){var o=s?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=t[i]}return r.default=t,n&&n.set(t,r),r}function ml(t){"@babel/helpers - typeof";return ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ml(t)}function BE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function S5(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?BE(Object(n),!0).forEach(function(r){hx(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):BE(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function k5(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,FD(r.key),r)}}function E5(t,e,n){return e&&zE(t.prototype,e),n&&zE(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function I5(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ux(t,e)}function ux(t,e){return ux=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},ux(t,e)}function T5(t){var e=N5();return function(){var r=Um(t),s;if(e){var i=Um(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return _5(this,s)}}function _5(t,e){if(e&&(ml(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cx(t)}function cx(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function N5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Um(t){return Um=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Um(t)}function hx(t,e,n){return e=FD(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FD(t){var e=$5(t,"string");return ml(e)==="symbol"?e:String(e)}function $5(t,e){if(ml(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(ml(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yw=function(t){I5(n,t);var e=T5(n);function n(r){var s;return k5(this,n),s=e.call(this,r),hx(cx(s),"onLocationChange",function(i){var o=s.props,a=o.location,l=o.locationChanged,u=i&&i.start;a!==u&&(s.location=u,l&&l(u))}),hx(cx(s),"handleKeyPress",function(i){var o=i.key;o&&o==="ArrowRight"&&s.nextPage(),o&&o==="ArrowLeft"&&s.prevPage()}),s.state={isLoaded:!1,toc:[]},s.viewerRef=Np.default.createRef(),s.location=r.location,s.book=s.rendition=s.prevPage=s.nextPage=null,s}return E5(n,[{key:"componentDidMount",value:function(){this.initBook(!0),document.addEventListener("keyup",this.handleKeyPress,!1)}},{key:"initBook",value:function(){var s=this,i=this.props,o=i.url,a=i.tocChanged,l=i.epubInitOptions;this.book&&this.book.destroy(),this.book=new b5.default(o,l),this.book.loaded.navigation.then(function(u){var c=u.toc;s.setState({isLoaded:!0,toc:c},function(){a&&a(c),s.initReader()})})}},{key:"componentWillUnmount",value:function(){this.book&&this.book.destroy(),this.book=this.rendition=this.prevPage=this.nextPage=null,document.removeEventListener("keyup",this.handleKeyPress,!1)}},{key:"shouldComponentUpdate",value:function(s){return!this.state.isLoaded||s.location!==this.props.location||s.location!==this.props.location}},{key:"componentDidUpdate",value:function(s){s.location!==this.props.location&&this.location!==this.props.location&&this.rendition.display(this.props.location),s.url!==this.props.url&&this.initBook()}},{key:"initReader",value:function(){var s=this,i=this.state.toc,o=this.props,a=o.location,l=o.epubOptions,u=o.getRendition,c=this.viewerRef.current;this.rendition=this.book.renderTo(c,S5({contained:!0,width:"100%",height:"100%"},l)),this.prevPage=function(){s.rendition.prev()},this.nextPage=function(){s.rendition.next()},this.registerEvents(),u&&u(this.rendition),typeof a=="string"||typeof a=="number"?this.rendition.display(a):i.length>0&&i[0].href?this.rendition.display(i[0].href):this.rendition.display()}},{key:"registerEvents",value:function(){var s=this.props,i=s.handleKeyPress,o=s.handleTextSelected;this.rendition.on("locationChanged",this.onLocationChange),this.rendition.on("keyup",i||this.handleKeyPress),o&&this.rendition.on("selected",o)}},{key:"renderBook",value:function(){var s=this.props.epubViewStyles;return Np.default.createElement("div",{ref:this.viewerRef,style:s.view})}},{key:"render",value:function(){var s=this.state.isLoaded,i=this.props,o=i.loadingView,a=i.epubViewStyles;return Np.default.createElement("div",{style:a.viewHolder},s&&this.renderBook()||o)}}]),n}(Np.Component);yw.defaultProps={loadingView:null,locationChanged:null,tocChanged:null,epubViewStyles:w5.EpubViewStyle,epubOptions:{},epubInitOptions:{}};yw.propTypes={url:Or.default.oneOfType([Or.default.string,Or.default.instanceOf(ArrayBuffer)]),loadingView:Or.default.element,location:Or.default.oneOfType([Or.default.string,Or.default.number]),locationChanged:Or.default.func,tocChanged:Or.default.func,epubViewStyles:Or.default.object,epubInitOptions:Or.default.object,epubOptions:Or.default.object,getRendition:Or.default.func,handleKeyPress:Or.default.func,handleTextSelected:Or.default.func};var D5=yw;zg.default=D5;var nh={};const LD="Left",PD="Right",MD="Up",BD="Down",_u={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},dx={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},UE="mousemove",VE="mouseup",A5="touchend",R5="touchmove",O5="touchstart";function F5(t,e,n,r){return t>e?n>0?PD:LD:r>0?BD:MD}function WE(t,e){if(e===0)return t;const n=Math.PI/180*e,r=t[0]*Math.cos(n)+t[1]*Math.sin(n),s=t[1]*Math.cos(n)-t[0]*Math.sin(n);return[r,s]}function L5(t,e){const n=c=>{const h="touches"in c;h&&c.touches.length>1||t((d,f)=>{f.trackMouse&&!h&&(document.addEventListener(UE,r),document.addEventListener(VE,o));const{clientX:m,clientY:v}=h?c.touches[0]:c,p=WE([m,v],f.rotationAngle);return f.onTouchStartOrOnMouseDown&&f.onTouchStartOrOnMouseDown({event:c}),Object.assign(Object.assign(Object.assign({},d),dx),{initial:p.slice(),xy:p,start:c.timeStamp||0})})},r=c=>{t((h,d)=>{const f="touches"in c;if(f&&c.touches.length>1)return h;if(c.timeStamp-h.start>d.swipeDuration)return h.swiping?Object.assign(Object.assign({},h),{swiping:!1}):h;const{clientX:m,clientY:v}=f?c.touches[0]:c,[p,g]=WE([m,v],d.rotationAngle),y=p-h.xy[0],b=g-h.xy[1],x=Math.abs(y),w=Math.abs(b),C=(c.timeStamp||0)-h.start,S=Math.sqrt(x*x+w*w)/(C||1),E=[y/(C||1),b/(C||1)],T=F5(x,w,y,b),_=typeof d.delta=="number"?d.delta:d.delta[T.toLowerCase()]||_u.delta;if(x<_&&w<_&&!h.swiping)return h;const A={absX:x,absY:w,deltaX:y,deltaY:b,dir:T,event:c,first:h.first,initial:h.initial,velocity:S,vxvy:E};A.first&&d.onSwipeStart&&d.onSwipeStart(A),d.onSwiping&&d.onSwiping(A);let L=!1;return(d.onSwiping||d.onSwiped||d[`onSwiped${T}`])&&(L=!0),L&&d.preventScrollOnSwipe&&d.trackTouch&&c.cancelable&&c.preventDefault(),Object.assign(Object.assign({},h),{first:!1,eventData:A,swiping:!0})})},s=c=>{t((h,d)=>{let f;if(h.swiping&&h.eventData){if(c.timeStamp-h.start<d.swipeDuration){f=Object.assign(Object.assign({},h.eventData),{event:c}),d.onSwiped&&d.onSwiped(f);const m=d[`onSwiped${f.dir}`];m&&m(f)}}else d.onTap&&d.onTap({event:c});return d.onTouchEndOrOnMouseUp&&d.onTouchEndOrOnMouseUp({event:c}),Object.assign(Object.assign(Object.assign({},h),dx),{eventData:f})})},i=()=>{document.removeEventListener(UE,r),document.removeEventListener(VE,o)},o=c=>{i(),s(c)},a=(c,h)=>{let d=()=>{};if(c&&c.addEventListener){const f=Object.assign(Object.assign({},_u.touchEventOptions),h.touchEventOptions),m=[[O5,n,f],[R5,r,Object.assign(Object.assign({},f),h.preventScrollOnSwipe?{passive:!1}:{})],[A5,s,f]];m.forEach(([v,p,g])=>c.addEventListener(v,p,g)),d=()=>m.forEach(([v,p])=>c.removeEventListener(v,p))}return d},u={ref:c=>{c!==null&&t((h,d)=>{if(h.el===c)return h;const f={};return h.el&&h.el!==c&&h.cleanUpTouch&&(h.cleanUpTouch(),f.cleanUpTouch=void 0),d.trackTouch&&c&&(f.cleanUpTouch=a(c,d)),Object.assign(Object.assign(Object.assign({},h),{el:c}),f)})}};return e.trackMouse&&(u.onMouseDown=n),[u,a]}function P5(t,e,n,r){return!e.trackTouch||!t.el?(t.cleanUpTouch&&t.cleanUpTouch(),Object.assign(Object.assign({},t),{cleanUpTouch:void 0})):t.cleanUpTouch?e.preventScrollOnSwipe!==n.preventScrollOnSwipe||e.touchEventOptions.passive!==n.touchEventOptions.passive?(t.cleanUpTouch(),Object.assign(Object.assign({},t),{cleanUpTouch:r(t.el,e)})):t:Object.assign(Object.assign({},t),{cleanUpTouch:r(t.el,e)})}function M5(t){const{trackMouse:e}=t,n=Ce.useRef(Object.assign({},dx)),r=Ce.useRef(Object.assign({},_u)),s=Ce.useRef(Object.assign({},r.current));s.current=Object.assign({},r.current),r.current=Object.assign(Object.assign({},_u),t);let i;for(i in _u)r.current[i]===void 0&&(r.current[i]=_u[i]);const[o,a]=Ce.useMemo(()=>L5(l=>n.current=l(n.current,r.current),{trackMouse:e}),[e]);return n.current=P5(n.current,r.current,s.current,a),o}const B5=Object.freeze(Object.defineProperty({__proto__:null,DOWN:BD,LEFT:LD,RIGHT:PD,UP:MD,useSwipeable:M5},Symbol.toStringTag,{value:"Module"})),z5=OT(B5);var Pd={};Object.defineProperty(Pd,"__esModule",{value:!0});Pd.ReactReaderStyle=void 0;var U5={container:{overflow:"hidden",position:"relative",height:"100%"},readerArea:{position:"relative",zIndex:1,height:"100%",width:"100%",backgroundColor:"#fff",transition:"all .3s ease"},containerExpanded:{transform:"translateX(256px)"},titleArea:{position:"absolute",top:20,left:50,right:50,textAlign:"center",color:"#999"},reader:{position:"absolute",top:50,left:50,bottom:20,right:50},swipeWrapper:{position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:200},prev:{left:1},next:{right:1},arrow:{outline:"none",border:"none",background:"none",position:"absolute",top:"50%",marginTop:-32,fontSize:64,padding:"0 10px",color:"#E2E2E2",fontFamily:"arial, sans-serif",cursor:"pointer",userSelect:"none",appearance:"none",fontWeight:"normal"},arrowHover:{color:"#777"},tocBackground:{position:"absolute",left:256,top:0,bottom:0,right:0,zIndex:1},tocArea:{position:"absolute",left:0,top:0,bottom:0,zIndex:0,width:256,overflowY:"auto",WebkitOverflowScrolling:"touch",background:"#f2f2f2",padding:"10px 0"},tocAreaButton:{userSelect:"none",appearance:"none",background:"none",border:"none",display:"block",fontFamily:"sans-serif",width:"100%",fontSize:".9em",textAlign:"left",padding:".9em 1em",borderBottom:"1px solid #ddd",color:"#aaa",boxSizing:"border-box",outline:"none",cursor:"pointer"},tocButton:{background:"none",border:"none",width:32,height:32,position:"absolute",top:10,left:10,borderRadius:2,outline:"none",cursor:"pointer"},tocButtonExpanded:{background:"#f2f2f2"},tocButtonBar:{position:"absolute",width:"60%",background:"#ccc",height:2,left:"50%",margin:"-1px -30%",top:"50%",transition:"all .5s ease"},tocButtonBarTop:{top:"35%"},tocButtonBottom:{top:"66%"},loadingView:{position:"absolute",top:"50%",left:"10%",right:"10%",color:"#ccc",textAlign:"center",margintop:"-.5em"}};Pd.ReactReaderStyle=U5;var GE;function V5(){if(GE)return nh;GE=1;function t(R){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},t(R)}Object.defineProperty(nh,"__esModule",{value:!0}),nh.default=void 0;var e=c(Ce),n=l(m$),r=z5,s=zD(),i=Pd,o=["children"],a=["title","showToc","loadingView","readerStyles","locationChanged","swipeable","epubViewStyles"];function l(R){return R&&R.__esModule?R:{default:R}}function u(R){if(typeof WeakMap!="function")return null;var M=new WeakMap,U=new WeakMap;return(u=function(B){return B?U:M})(R)}function c(R,M){if(!M&&R&&R.__esModule)return R;if(R===null||t(R)!=="object"&&typeof R!="function")return{default:R};var U=u(M);if(U&&U.has(R))return U.get(R);var D={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var X in R)if(X!=="default"&&Object.prototype.hasOwnProperty.call(R,X)){var ie=B?Object.getOwnPropertyDescriptor(R,X):null;ie&&(ie.get||ie.set)?Object.defineProperty(D,X,ie):D[X]=R[X]}return D.default=R,U&&U.set(R,D),D}function h(){return h=Object.assign?Object.assign.bind():function(R){for(var M=1;M<arguments.length;M++){var U=arguments[M];for(var D in U)Object.prototype.hasOwnProperty.call(U,D)&&(R[D]=U[D])}return R},h.apply(this,arguments)}function d(R,M){if(!(R instanceof M))throw new TypeError("Cannot call a class as a function")}function f(R,M){for(var U=0;U<M.length;U++){var D=M[U];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(R,S(D.key),D)}}function m(R,M,U){return M&&f(R.prototype,M),U&&f(R,U),Object.defineProperty(R,"prototype",{writable:!1}),R}function v(R,M){if(typeof M!="function"&&M!==null)throw new TypeError("Super expression must either be null or a function");R.prototype=Object.create(M&&M.prototype,{constructor:{value:R,writable:!0,configurable:!0}}),Object.defineProperty(R,"prototype",{writable:!1}),M&&p(R,M)}function p(R,M){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,B){return D.__proto__=B,D},p(R,M)}function g(R){var M=x();return function(){var D=w(R),B;if(M){var X=w(this).constructor;B=Reflect.construct(D,arguments,X)}else B=D.apply(this,arguments);return y(this,B)}}function y(R,M){if(M&&(t(M)==="object"||typeof M=="function"))return M;if(M!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return b(R)}function b(R){if(R===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R}function x(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function w(R){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(U){return U.__proto__||Object.getPrototypeOf(U)},w(R)}function C(R,M,U){return M=S(M),M in R?Object.defineProperty(R,M,{value:U,enumerable:!0,configurable:!0,writable:!0}):R[M]=U,R}function S(R){var M=E(R,"string");return t(M)==="symbol"?M:String(M)}function E(R,M){if(t(R)!=="object"||R===null)return R;var U=R[Symbol.toPrimitive];if(U!==void 0){var D=U.call(R,M||"default");if(t(D)!=="object")return D;throw new TypeError("@@toPrimitive must return a primitive value.")}return(M==="string"?String:Number)(R)}function T(R,M){if(R==null)return{};var U=_(R,M),D,B;if(Object.getOwnPropertySymbols){var X=Object.getOwnPropertySymbols(R);for(B=0;B<X.length;B++)D=X[B],!(M.indexOf(D)>=0)&&Object.prototype.propertyIsEnumerable.call(R,D)&&(U[D]=R[D])}return U}function _(R,M){if(R==null)return{};var U={},D=Object.keys(R),B,X;for(X=0;X<D.length;X++)B=D[X],!(M.indexOf(B)>=0)&&(U[B]=R[B]);return U}var A=function(M){var U=M.children,D=T(M,o),B=(0,r.useSwipeable)(D);return e.default.createElement("div",B,U)},L=function(R){v(U,R);var M=g(U);function U(){var D;d(this,U);for(var B=arguments.length,X=new Array(B),ie=0;ie<B;ie++)X[ie]=arguments[ie];return D=M.call.apply(M,[this].concat(X)),C(b(D),"setLocation",function(){D.props.setLocation(D.props.href)}),D}return m(U,[{key:"render",value:function(){var B=this,X=this.props,ie=X.label,G=X.styles,Z=X.subitems;return e.default.createElement("div",null,e.default.createElement("button",{onClick:this.setLocation,style:G},ie),Z&&Z.length>0&&e.default.createElement("div",{style:{paddingLeft:10}},Z.map(function(de,ge){return e.default.createElement(U,h({key:ge},B.props,de))})))}}]),U}(e.PureComponent);L.propTypes={label:n.default.string,href:n.default.string,setLocation:n.default.func,styles:n.default.object};var W=function(R){v(U,R);var M=g(U);function U(D){var B;return d(this,U),B=M.call(this,D),C(b(B),"toggleToc",function(){B.setState({expandedToc:!B.state.expandedToc})}),C(b(B),"next",function(){var X=B.readerRef.current;X.nextPage()}),C(b(B),"prev",function(){var X=B.readerRef.current;X.prevPage()}),C(b(B),"onTocChange",function(X){var ie=B.props.tocChanged;B.setState({toc:X},function(){return ie&&ie(X)})}),C(b(B),"setLocation",function(X){var ie=B.props.locationChanged;B.setState({expandedToc:!1},function(){return ie&&ie(X)})}),B.readerRef=e.default.createRef(),B.state={expandedToc:!1,toc:!1},B}return m(U,[{key:"renderToc",value:function(){var B=this,X=this.state,ie=X.toc,G=X.expandedToc,Z=this.props.readerStyles;return e.default.createElement("div",null,e.default.createElement("div",{style:Z.tocArea},e.default.createElement("div",{style:Z.toc},ie.map(function(de,ge){return e.default.createElement(L,h({},de,{key:ge,setLocation:B.setLocation,styles:Z.tocAreaButton}))}))),G&&e.default.createElement("div",{style:Z.tocBackground,onClick:this.toggleToc}))}},{key:"renderTocToggle",value:function(){var B=this.state.expandedToc,X=this.props.readerStyles;return e.default.createElement("button",{style:Object.assign({},X.tocButton,B?X.tocButtonExpanded:{}),onClick:this.toggleToc},e.default.createElement("span",{style:Object.assign({},X.tocButtonBar,X.tocButtonBarTop)}),e.default.createElement("span",{style:Object.assign({},X.tocButtonBar,X.tocButtonBottom)}))}},{key:"render",value:function(){var B=this.props,X=B.title,ie=B.showToc,G=B.loadingView,Z=B.readerStyles,de=B.locationChanged,ge=B.swipeable,ye=B.epubViewStyles,j=T(B,a),J=this.state,fe=J.toc,ve=J.expandedToc;return e.default.createElement("div",{style:Z.container},e.default.createElement("div",{style:Object.assign({},Z.readerArea,ve?Z.containerExpanded:{})},ie&&this.renderTocToggle(),e.default.createElement("div",{style:Z.titleArea},X),e.default.createElement(A,{onSwipedRight:this.prev,onSwipedLeft:this.next,trackMouse:!0},e.default.createElement("div",{style:Z.reader},e.default.createElement(s.EpubView,h({ref:this.readerRef,loadingView:G,epubViewStyles:ye},j,{tocChanged:this.onTocChange,locationChanged:de})),ge&&e.default.createElement("div",{style:Z.swipeWrapper}))),e.default.createElement("button",{style:Object.assign({},Z.arrow,Z.prev),onClick:this.prev},"‹"),e.default.createElement("button",{style:Object.assign({},Z.arrow,Z.next),onClick:this.next},"›")),ie&&fe&&this.renderToc())}}]),U}(e.PureComponent);W.defaultProps={loadingView:e.default.createElement("div",{style:i.ReactReaderStyle.loadingView},"Loading…"),locationChanged:null,tocChanged:null,showToc:!0,readerStyles:i.ReactReaderStyle},W.propTypes={title:n.default.string,loadingView:n.default.element,showToc:n.default.bool,locationChanged:n.default.func,tocChanged:n.default.func,readerStyles:n.default.object,epubViewStyles:n.default.object,swipeable:n.default.bool};var K=W;return nh.default=K,nh}var jE;function zD(){return jE||(jE=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"EpubView",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(t,"EpubViewStyle",{enumerable:!0,get:function(){return n.EpubViewStyle}}),Object.defineProperty(t,"ReactReader",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"ReactReaderStyle",{enumerable:!0,get:function(){return s.ReactReaderStyle}});var e=i(zg),n=Ld,r=i(V5()),s=Pd;function i(o){return o&&o.__esModule?o:{default:o}}}(ky)),ky}var Bo=zD();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W5=1e-7,G5=1e-4;class UD{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class xw{refCount(e){return Kr("refCount")}incRef(e){return Kr("incRef")}timerAvailable(){return!0}time(e){return Kr("time")}read(e){return Kr("read")}readSync(e){return Kr("readSync")}readToGPU(e,n){return Kr("readToGPU")}numDataIds(){return Kr("numDataIds")}disposeData(e,n){return Kr("disposeData")}write(e,n,r){return Kr("write")}move(e,n,r,s,i){return Kr("move")}createTensorFromGPUData(e,n,r){return Kr("createTensorFromGPUData")}memory(){return Kr("memory")}floatPrecision(){return Kr("floatPrecision")}epsilon(){return this.floatPrecision()===32?W5:G5}dispose(){return Kr("dispose")}}function Kr(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j5(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,hu(t,e,n)}function gl(t,e,n){return Math.max(t,Math.min(e,n))}function bw(t){return t%2===0?t:t+1}function hu(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function H5(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function F(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function ww(t,e,n=""){F(Nt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function VD(t){F(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function be(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function Nt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Qu(t){return t%1===0}function fx(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function Pu(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function HE(t,e=s=>0,n,r){return new Promise((s,i)=>{let o=0;const a=()=>{if(t()){s();return}o++;const l=e(o);if(n!=null&&o>=n){i();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function WD(t,e){let n=1,r=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const s=t.slice();return s[r]=e/n,s}function mt(t,e){const n=e.length;return t=t==null?e.map((r,s)=>s):[].concat(t),F(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),F(t.every(r=>Qu(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function Ia(t,e){const n=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||s?null:mt(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(i!=null){if(i[o]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(i[o]==null||i[o]>a)&&t[a]===1&&(n.push(t[a]),r.push(a)),i[o]<=a&&o++}t[a]!==1&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function gr(t,e){return xn(t,e)}function xn(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function q5(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function K5(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function GD(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Vm(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function X5(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function Md(t){return typeof t=="string"||t instanceof String}function Y5(t){return typeof t=="boolean"}function px(t){return typeof t=="number"}function xc(t){return Array.isArray(t)?xc(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":px(t)?"float32":Md(t)?"string":Y5(t)?"bool":"float32"}function mx(t){return!!(t&&t.constructor&&t.call&&t.apply)}function gx(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Qe(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function jD(t,e,n,r=!1){const s=new Array;if(e.length===1){const i=e[0]*(r?2:1);for(let o=0;o<i;o++)s[o]=n[t+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<i;l++)s[l]=jD(t+l*a,o,n,r)}return s}function vi(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((s,i)=>s*i)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return jD(0,t,e,n)}function Z5(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function Cw(t,e){const n=vr(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function vr(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function HD(t,e){const n=t.reduce((r,s)=>r*s,1);if(e==null||e==="float32")return vi(t,new Float32Array(n));if(e==="int32")return vi(t,new Int32Array(n));if(e==="bool")return vi(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function $o(t){t.forEach(e=>{F(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Hi(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=n[s]*t[s];return r}function bc(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(t/n[s]),t-=r[s]*n[s];return r[r.length-1]=t,r}function Sw(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qE="tfjsflags";class Q5{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=J5,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(me().getBool("IS_TEST")||me().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];me().getBool("IS_TEST")||me().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(Sw(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);qE in e&&e[qE].split(",").forEach(r=>{const[s,i]=r.split(":");this.urlFlags[s]=tG(s,i)})}}function J5(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(eG(e,r[0],r[1]),r.join("="))),e}function eG(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function tG(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function me(){return qD}let qD=null;function nG(t){qD=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let zy;function KD(){if(zy==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");zy=t}return zy}function rG(){const t=KD();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function kw(t,e){const n=rG();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const f0="Abs",Bd="Acos",zd="Acosh",wc="Add",Ew="AddN",Iw="All",Tw="Any",p0="ArgMax",m0="ArgMin",Ud="Asin",Vd="Asinh",Wd="Atan",Gd="Atanh",jd="Atan2",g0="AvgPool",_w="AvgPoolGrad",v0="AvgPool3D",Nw="AvgPool3DGrad",y0="BatchMatMul",x0="BatchToSpaceND",$w="Bincount",Dw="BitwiseAnd",sG="BroadcastTo",XD="BroadcastArgs",Hd="Cast",qd="Ceil",Kd="ClipByValue",Aw="Complex",b0="ComplexAbs",w0="Concat",C0="Conv2D",Rw="Conv2DBackpropFilter",S0="Conv2DBackpropInput",k0="Conv3D",Ow="Conv3DBackpropFilterV2",Fw="Conv3DBackpropInputV2",Xd="Cos",Yd="Cosh",Lw="Cumprod",E0="Cumsum",Pw="CropAndResize",Mw="DenseBincount",Bw="DepthToSpace",I0="DepthwiseConv2dNative",zw="DepthwiseConv2dNativeBackpropFilter",Uw="DepthwiseConv2dNativeBackpropInput",YD="Diag",T0="Dilation2D",vx="Dilation2DBackpropInput",yx="Dilation2DBackpropFilter",iG="Draw",Zd="RealDiv",Vw="Einsum",Qd="Elu",Ww="EluGrad",Jd="Erf",_0="Equal",ef="Exp",N0="ExpandDims",tf="Expm1",Gw="FFT",jw="Fill",Hw="FlipLeftRight",nf="Floor",rf="FloorDiv",$0="FusedBatchNorm",D0="GatherV2",ZD="GatherNd",A0="Greater",sf="GreaterEqual",of="Identity",qw="IFFT",Kw="Imag",af="IsFinite",lf="IsInf",uf="IsNan",R0="LeakyRelu",O0="Less",F0="LessEqual",QD="LinSpace",cf="Log",hf="Log1p",L0="LogicalAnd",P0="LogicalNot",M0="LogicalOr",oG="LogSoftmax",B0="LRN",Xw="LRNGrad",z0="Max",df="Maximum",U0="MaxPool",Yw="MaxPoolGrad",V0="MaxPool3D",Zw="MaxPool3DGrad",JD="MaxPoolWithArgmax",W0="Mean",G0="Min",ff="Minimum",j0="MirrorPad",pf="Mod",eA="Multinomial",mf="Multiply",H0="Neg",q0="NotEqual",Qw="NonMaxSuppressionV3",Jw="NonMaxSuppressionV4",e2="NonMaxSuppressionV5",K0="OnesLike",X0="OneHot",Y0="Pack",Z0="PadV2",gf="Pow",Q0="Prelu",J0="Prod",tA="RaggedGather",nA="RaggedRange",rA="RaggedTensorToTensor",t2="Range",n2="Real",vf="Reciprocal",yf="Relu",ev="Reshape",tv="ResizeNearestNeighbor",r2="ResizeNearestNeighborGrad",nv="ResizeBilinear",s2="ResizeBilinearGrad",xf="Relu6",rv="Reverse",bf="Round",wf="Rsqrt",sA="ScatterNd",iA="TensorScatterUpdate",oA="SearchSorted",sv="Select",Cf="Selu",iv="Slice",Sf="Sin",kf="Sinh",Ef="Sign",If="Sigmoid",Tf="Softplus",_f="Sqrt",ov="Sum",av="SpaceToBatchND",lv="SplitV",uv="Softmax",aA="SparseFillEmptyRows",lA="SparseReshape",uA="SparseSegmentMean",cA="SparseSegmentSum",hA="SparseToDense",Nf="SquaredDifference",i2="Square",o2="StaticRegexReplace",a2="StridedSlice",dA="StringNGrams",fA="StringSplit",pA="StringToHashBucketFast",$f="Sub",Df="Tan",Af="Tanh",Rf="Tile",l2="TopK",u2="Transform",Mu="Transpose",c2="Unique",cv="Unpack",hv="UnsortedSegmentSum",dv="ZerosLike",Of="Step",aG="FromPixels",h2="RotateWithOffset",Wm="_FusedMatMul",Gm="FusedConv2D",mA="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gs(...t){me().getBool("IS_TEST")||me().getBool("PROD")||console.warn(...t)}function lG(...t){me().getBool("IS_TEST")||me().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jm=kw("kernelRegistry",()=>new Map),xx=kw("gradRegistry",()=>new Map);function KE(t,e){const n=vA(t,e);return jm.get(n)}function XE(t){return xx.get(t)}function YE(t){const e=jm.entries(),n=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[i,o]=s,[a]=i.split("_");a===t&&n.push(o)}return n}function gA(t){const{kernelName:e,backendName:n}=t,r=vA(e,n);jm.has(r)&&gs(`The kernel '${e}' for backend '${n}' is already registered`),jm.set(r,t)}function uG(t){const{kernelName:e}=t;xx.has(e)&&me().getBool("DEBUG")&&gs(`Overriding the gradient for '${e}'`),xx.set(e,t)}function vA(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yA(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var xA=tn,Vs=null;try{Vs=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function tn(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}tn.prototype.__isLong__;Object.defineProperty(tn.prototype,"__isLong__",{value:!0});function cs(t){return(t&&t.__isLong__)===!0}tn.isLong=cs;var ZE={},QE={};function Ml(t,e){var n,r,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(r=QE[t],r)?r:(n=nn(t,(t|0)<0?-1:0,!0),s&&(QE[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(r=ZE[t],r)?r:(n=nn(t,t<0?-1:0,!1),s&&(ZE[t]=n),n))}tn.fromInt=Ml;function Ws(t,e){if(isNaN(t))return e?Ja:Gs;if(e){if(t<0)return Ja;if(t>=bA)return SA}else{if(t<=-eI)return Jr;if(t+1>=eI)return CA}return t<0?Ws(-t,e).neg():nn(t%Ju|0,t/Ju|0,e)}tn.fromNumber=Ws;function nn(t,e,n){return new tn(t,e,n)}tn.fromBits=nn;var Hm=Math.pow;function d2(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Gs;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return d2(t.substring(1),e,n).neg();for(var s=Ws(Hm(n,8)),i=Gs,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+a),n);if(a<8){var u=Ws(Hm(n,a));i=i.mul(u).add(Ws(l))}else i=i.mul(s),i=i.add(Ws(l))}return i.unsigned=e,i}tn.fromString=d2;function Ei(t,e){return typeof t=="number"?Ws(t,e):typeof t=="string"?d2(t,e):nn(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}tn.fromValue=Ei;var JE=65536,cG=1<<24,Ju=JE*JE,bA=Ju*Ju,eI=bA/2,tI=Ml(cG),Gs=Ml(0);tn.ZERO=Gs;var Ja=Ml(0,!0);tn.UZERO=Ja;var Nu=Ml(1);tn.ONE=Nu;var wA=Ml(1,!0);tn.UONE=wA;var bx=Ml(-1);tn.NEG_ONE=bx;var CA=nn(-1,2147483647,!1);tn.MAX_VALUE=CA;var SA=nn(-1,-1,!0);tn.MAX_UNSIGNED_VALUE=SA;var Jr=nn(0,-2147483648,!1);tn.MIN_VALUE=Jr;var ze=tn.prototype;ze.toInt=function(){return this.unsigned?this.low>>>0:this.low};ze.toNumber=function(){return this.unsigned?(this.high>>>0)*Ju+(this.low>>>0):this.high*Ju+(this.low>>>0)};ze.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Jr)){var n=Ws(e),r=this.div(n),s=r.mul(n).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=Ws(Hm(e,6),this.unsigned),o=this,a="";;){var l=o.div(i),u=o.sub(l.mul(i)).toInt()>>>0,c=u.toString(e);if(o=l,o.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}};ze.getHighBits=function(){return this.high};ze.getHighBitsUnsigned=function(){return this.high>>>0};ze.getLowBits=function(){return this.low};ze.getLowBitsUnsigned=function(){return this.low>>>0};ze.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Jr)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};ze.isZero=function(){return this.high===0&&this.low===0};ze.eqz=ze.isZero;ze.isNegative=function(){return!this.unsigned&&this.high<0};ze.isPositive=function(){return this.unsigned||this.high>=0};ze.isOdd=function(){return(this.low&1)===1};ze.isEven=function(){return(this.low&1)===0};ze.equals=function(e){return cs(e)||(e=Ei(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};ze.eq=ze.equals;ze.notEquals=function(e){return!this.eq(e)};ze.neq=ze.notEquals;ze.ne=ze.notEquals;ze.lessThan=function(e){return this.comp(e)<0};ze.lt=ze.lessThan;ze.lessThanOrEqual=function(e){return this.comp(e)<=0};ze.lte=ze.lessThanOrEqual;ze.le=ze.lessThanOrEqual;ze.greaterThan=function(e){return this.comp(e)>0};ze.gt=ze.greaterThan;ze.greaterThanOrEqual=function(e){return this.comp(e)>=0};ze.gte=ze.greaterThanOrEqual;ze.ge=ze.greaterThanOrEqual;ze.compare=function(e){if(cs(e)||(e=Ei(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ze.comp=ze.compare;ze.negate=function(){return!this.unsigned&&this.eq(Jr)?Jr:this.not().add(Nu)};ze.neg=ze.negate;ze.add=function(e){cs(e)||(e=Ei(e));var n=this.high>>>16,r=this.high&65535,s=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,h=0,d=0,f=0;return f+=i+u,d+=f>>>16,f&=65535,d+=s+l,h+=d>>>16,d&=65535,h+=r+a,c+=h>>>16,h&=65535,c+=n+o,c&=65535,nn(d<<16|f,c<<16|h,this.unsigned)};ze.subtract=function(e){return cs(e)||(e=Ei(e)),this.add(e.neg())};ze.sub=ze.subtract;ze.multiply=function(e){if(this.isZero())return Gs;if(cs(e)||(e=Ei(e)),Vs){var n=Vs.mul(this.low,this.high,e.low,e.high);return nn(n,Vs.get_high(),this.unsigned)}if(e.isZero())return Gs;if(this.eq(Jr))return e.isOdd()?Jr:Gs;if(e.eq(Jr))return this.isOdd()?Jr:Gs;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(tI)&&e.lt(tI))return Ws(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,u=e.low>>>16,c=e.low&65535,h=0,d=0,f=0,m=0;return m+=o*c,f+=m>>>16,m&=65535,f+=i*c,d+=f>>>16,f&=65535,f+=o*u,d+=f>>>16,f&=65535,d+=s*c,h+=d>>>16,d&=65535,d+=i*u,h+=d>>>16,d&=65535,d+=o*l,h+=d>>>16,d&=65535,h+=r*c+s*u+i*l+o*a,h&=65535,nn(f<<16|m,h<<16|d,this.unsigned)};ze.mul=ze.multiply;ze.divide=function(e){if(cs(e)||(e=Ei(e)),e.isZero())throw Error("division by zero");if(Vs){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?Vs.div_u:Vs.div_s)(this.low,this.high,e.low,e.high);return nn(n,Vs.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Ja:Gs;var r,s,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Ja;if(e.gt(this.shru(1)))return wA;i=Ja}else{if(this.eq(Jr)){if(e.eq(Nu)||e.eq(bx))return Jr;if(e.eq(Jr))return Nu;var o=this.shr(1);return r=o.div(e).shl(1),r.eq(Gs)?e.isNegative()?Nu:bx:(s=this.sub(e.mul(r)),i=r.add(s.div(e)),i)}else if(e.eq(Jr))return this.unsigned?Ja:Gs;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=Gs}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:Hm(2,a-48),u=Ws(r),c=u.mul(e);c.isNegative()||c.gt(s);)r-=l,u=Ws(r,this.unsigned),c=u.mul(e);u.isZero()&&(u=Nu),i=i.add(u),s=s.sub(c)}return i};ze.div=ze.divide;ze.modulo=function(e){if(cs(e)||(e=Ei(e)),Vs){var n=(this.unsigned?Vs.rem_u:Vs.rem_s)(this.low,this.high,e.low,e.high);return nn(n,Vs.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ze.mod=ze.modulo;ze.rem=ze.modulo;ze.not=function(){return nn(~this.low,~this.high,this.unsigned)};ze.and=function(e){return cs(e)||(e=Ei(e)),nn(this.low&e.low,this.high&e.high,this.unsigned)};ze.or=function(e){return cs(e)||(e=Ei(e)),nn(this.low|e.low,this.high|e.high,this.unsigned)};ze.xor=function(e){return cs(e)||(e=Ei(e)),nn(this.low^e.low,this.high^e.high,this.unsigned)};ze.shiftLeft=function(e){return cs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?nn(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):nn(0,this.low<<e-32,this.unsigned)};ze.shl=ze.shiftLeft;ze.shiftRight=function(e){return cs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?nn(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):nn(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ze.shr=ze.shiftRight;ze.shiftRightUnsigned=function(e){if(cs(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var r=this.low;return nn(r>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?nn(n,0,this.unsigned):nn(n>>>e-32,0,this.unsigned)};ze.shru=ze.shiftRightUnsigned;ze.shr_u=ze.shiftRightUnsigned;ze.toSigned=function(){return this.unsigned?nn(this.low,this.high,!1):this};ze.toUnsigned=function(){return this.unsigned?this:nn(this.low,this.high,!0)};ze.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ze.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ze.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};tn.fromBytes=function(e,n,r){return r?tn.fromBytesLE(e,n):tn.fromBytesBE(e,n)};tn.fromBytesLE=function(e,n){return new tn(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};tn.fromBytesBE=function(e,n){return new tn(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const kA=Qx(xA),hG=RT({__proto__:null,default:kA},[xA]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ha=kA||hG;function fv(t){return Ha.fromString(t,!0,16)}const EA=fv("c3a5c85c97cb3127"),Wa=fv("b492b66fbe98f273"),Er=fv("9ae16a3b2f90404f");function wx(t){return t.xor(t.shru(47))}function IA(t,e,n){const r=t.slice(e,e+n);return Ha.fromBytes(Array.from(r),!0,!0)}function qt(t,e){return IA(t,e,8)}function nI(t,e){return IA(t,e,4)}function Zn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function la(t,e,n=fv("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let s=e.xor(r).mul(n);return s=s.xor(s.shru(47)),s=s.mul(n),s}function dG(t,e,n,r,s,i){s=s.add(t),i=Zn(i.add(s).add(r),21);const o=s;return s=s.add(e),s=s.add(n),i=i.add(Zn(s,44)),[s.add(r),i.add(o)]}function $p(t,e,n,r){return dG(qt(t,e),qt(t,e+8),qt(t,e+16),qt(t,e+24),n,r)}function fG(t,e=t.length){if(e>=8){const n=Er.add(e*2),r=qt(t,0).add(Er),s=qt(t,e-8),i=Zn(s,37).mul(n).add(r),o=Zn(r,25).add(s).mul(n);return la(i,o,n)}if(e>=4){const n=Er.add(e*2),r=nI(t,0);return la(r.shl(3).add(e),nI(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],s=t[e-1],i=n+(r<<8),o=e+(s<<2);return wx(Er.mul(i).xor(EA.mul(o))).mul(Er)}return Er}function pG(t,e=t.length){const n=Er.add(e*2),r=qt(t,0).mul(Wa),s=qt(t,8),i=qt(t,e-8).mul(n),o=qt(t,e-16).mul(Er);return la(Zn(r.add(s),43).add(Zn(i,30)).add(o),r.add(Zn(s.add(Er),18)).add(i),n)}function mG(t,e=t.length){const n=Er.add(e*2),r=qt(t,0).mul(Er),s=qt(t,8),i=qt(t,e-8).mul(n),o=qt(t,e-16).mul(Er),a=Zn(r.add(s),43).add(Zn(i,30)).add(o),l=la(a,r.add(Zn(s.add(Er),18)).add(i),n),u=qt(t,16).mul(n),c=qt(t,24),h=a.add(qt(t,e-32)).mul(n),d=l.add(qt(t,e-24)).mul(n);return la(Zn(u.add(c),43).add(Zn(h,30)).add(d),u.add(Zn(c.add(r),18)).add(h),n)}function gG(t,e=t.length){const n=Ha.fromNumber(81,!0);if(e<=32)return e<=16?fG(t,e):pG(t,e);if(e<=64)return mG(t,e);let r=n,s=n.mul(Wa).add(113),i=wx(s.mul(Er).add(113)).mul(Er),o=[Ha.UZERO,Ha.UZERO],a=[Ha.UZERO,Ha.UZERO];r=r.mul(Er).add(qt(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do r=Zn(r.add(s).add(o[0]).add(qt(t,l+8)),37).mul(Wa),s=Zn(s.add(o[1]).add(qt(t,l+48)),42).mul(Wa),r=r.xor(a[1]),s=s.add(o[0]).add(qt(t,l+40)),i=Zn(i.add(a[0]),33).mul(Wa),o=$p(t,l,o[1].mul(Wa),r.add(a[0])),a=$p(t,l+32,i.add(a[1]),s.add(qt(t,l+16))),[i,r]=[r,i],l+=64;while(l!==u);const h=Wa.add(i.and(255).shl(1));return l=c,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),r=Zn(r.add(s).add(o[0]).add(qt(t,l+8)),37).mul(h),s=Zn(s.add(o[1]).add(qt(t,l+48)),42).mul(h),r=r.xor(a[1].mul(9)),s=s.add(o[0].mul(9).add(qt(t,l+40))),i=Zn(i.add(a[0]),33).mul(h),o=$p(t,l,o[1].mul(h),r.add(a[0])),a=$p(t,l+32,i.add(a[1]),s.add(qt(t,l+16))),[i,r]=[r,i],la(la(o[0],a[0],h).add(wx(s).mul(EA)).add(i),la(o[1],a[1],h).add(r),h)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ta(t,e){return e==="string"?ua(t):Bl([t],e)}function vG(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Bl(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=vl(t)),me().getBool("DEBUG")&&q5(t,e),vG(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Lr(){return me().platform.now()}function ua(t,e="utf-8"){return e=e||"utf-8",me().platform.encode(t,e)}function ma(t,e="utf-8"){return e=e||"utf-8",me().platform.decode(t,e)}function Ys(t){return me().platform.isTypedArray!=null?me().platform.isTypedArray(t):yA(t)}function vl(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||Sw(t)||t==null||Ys(t)&&n)e.push(t);else if(Array.isArray(t)||Ys(t))for(let r=0;r<t.length;++r)vl(t[r],e,n);else{let r=-1;for(const s of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)vl(t[s],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yG{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new bG)}profileKernel(e,n,r){let s;const i=()=>{s=r()};let o;const a=Lr();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const u of s)u.dataSync();o=Promise.resolve({kernelMs:Lr()-a})}if(me().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<s.length;u++){const c=s[u];c.data().then(h=>{xG(h,c.dtype,e)})}return{kernelName:e,outputs:s,inputs:n,timeMs:o.then(u=>u.kernelMs),extraInfo:o.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:s,inputs:i,extraInfo:o}=e;r.forEach(a=>{Promise.all([a.data(),s,o]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],i,l[2])})})}}function xG(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const s=t[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${n}'`),!0}return!1}class bG{logKernelProfile(e,n,r,s,i,o){const a=typeof s=="number"?Pu(`${s}ms`,9):s.error,l=Pu(e,25),u=n.rank,c=n.size,h=Pu(n.shape.toString(),14);let d="";for(const f in i){const m=i[f];if(m!=null){const v=m.shape||n.shape,p=v.length;d+=`${f}: ${p}D ${p>0?v:""} `}}console.log(`%c${l}	%c${a}	%c${u}D ${h}	%c${c}	%c${d}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wG(t,e,n){const r={},s={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const h in c){const d=c[h];let f=!1;for(let m=0;m<e.length;m++)if(r[d.id]){u.outputs.forEach(v=>r[v.id]=!0),f=!0,s[u.id]=!0;break}if(f)break}}const i={};i[n.id]=!0;const o={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let h=0;h<u.outputs.length;h++)if(i[u.outputs[h].id]){for(const d in c)i[c[d].id]=!0,o[u.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const u=t[l];if(s[u.id]&&o[u.id]){const c={};for(const d in u.inputs){const f=u.inputs[d];r[f.id]&&(c[d]=f)}const h=Object.assign({},u);h.inputs=c,h.outputs=u.outputs,a.push(h)}}return a}function CG(t,e,n,r){for(let s=e.length-1;s>=0;s--){const i=e[s],o=[];if(i.outputs.forEach(l=>{const u=t[l.id];u!=null?o.push(u):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const u=n(()=>a[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=i.inputs[l];if(!Nt(u.shape,c.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const h=t[c.id];t[c.id]=r(h,u),h.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rI=20,rh=3,Uy=7;function SG(t,e,n,r){const s=Qe(e),i=kG(t,e,n,s),o=e.length,a=im(t,e,n,s,i),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(u=>"    "+u).join(`
`)),l.join(`
`)}function kG(t,e,n,r){const s=be(e),i=r[r.length-1],o=new Array(i).fill(0),a=e.length,l=n==="complex64"?dh(t):t;if(a>1)for(let u=0;u<s/i;u++){const c=u*i;for(let h=0;h<i;h++)o[h]=Math.max(o[h],hh(l[c+h],0,n).length)}return o}function hh(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(Uy))} + ${parseFloat(t[1].toFixed(Uy))}j`:Md(t)?r=`'${t}'`:n==="bool"?r=TA(t):r=parseFloat(t.toFixed(Uy)).toString(),Pu(r,e)}function TA(t){return t===0?"false":"true"}function im(t,e,n,r,s,i=!0){const o=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const v=dh(t);return[hh(v[0],0,n)]}return n==="bool"?[TA(t[0])]:[t[0].toString()]}if(l===1){if(a>rI){const p=rh*o;let g=Array.from(t.slice(0,p)),y=Array.from(t.slice((a-rh)*o,a*o));return n==="complex64"&&(g=dh(g),y=dh(y)),["["+g.map((b,x)=>hh(b,s[x],n)).join(", ")+", ..., "+y.map((b,x)=>hh(b,s[a-rh+x],n)).join(", ")+"]"]}return["["+(n==="complex64"?dh(t):Array.from(t)).map((p,g)=>hh(p,s[g],n)).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),h=r[0]*o,d=[];if(a>rI){for(let v=0;v<rh;v++){const p=v*h,g=p+h;d.push(...im(t.slice(p,g),u,n,c,s,!1))}d.push("...");for(let v=a-rh;v<a;v++){const p=v*h,g=p+h;d.push(...im(t.slice(p,g),u,n,c,s,v===a-1))}}else for(let v=0;v<a;v++){const p=v*h,g=p+h;d.push(...im(t.slice(p,g),u,n,c,s,v===a-1))}const f=l===2?",":"";d[0]="["+(a>0?d[0]+f:"");for(let v=1;v<d.length-1;v++)d[v]=" "+d[v]+f;let m=`,
`;for(let v=2;v<l;v++)m+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(i?"":m),d}function dh(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ar{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=be(e),r!=null){const s=r.length;F(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||xn(n,this.size),this.strides=Qe(e)}set(e,...n){n.length===0&&(n=[0]),F(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const s of e){if(s<0||s>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return hi().makeTensor(this.values,this.shape,this.dtype)}}let hi=null,du=null;function EG(t){hi=t}function IG(t){du=t}class Rn{constructor(e,n,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=be(e),this.strides=Qe(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return du.buffer(this.shape,this.dtype,e)}bufferSync(){return du.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return vi(this.shape,e,this.dtype==="complex64")}arraySync(){return vi(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=hi().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>ma(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),hi().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=hi().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>ma(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await hi().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(hi().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return du.print(this,e)}clone(){return this.throwIfDisposed(),du.clone(this)}toString(e=!1){const n=this.dataSync();return SG(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),du.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),hi().makeVariable(this,e,n,r)}}Object.defineProperty(Rn,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function xe(){return kw("Tensor",()=>Rn)}xe();class qm extends Rn{constructor(e,n,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Nt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);hi().disposeTensor(this),this.dataId=e.dataId,hi().incRef(this,null)}dispose(){hi().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(qm,Symbol.hasInstance,{value:t=>t instanceof Rn&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var sI;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(sI||(sI={}));var Cx;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(Cx||(Cx={}));var Sx;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(Sx||(Sx={}));var kx;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(kx||(kx={}));var Ex;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(Ex||(Ex={}));const TG={float32:kx,int32:Cx,bool:Sx,complex64:Ex};function is(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return TG[t][e]}function f2(t){return is(t,"int32")}function _A(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function NA(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wn(t,e){if(t.dtype===e.dtype)return[t,e];const n=is(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function $A(t){const e=[];return DA(t,e,new Set),e}function DA(t,e,n){if(t==null)return;if(t instanceof Rn){e.push(t);return}if(!_G(t))return;const r=t;for(const s in r){const i=r[s];n.has(i)||(n.add(i),DA(i,e,n))}}function _G(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vy(t){return t.kernelName!=null}class iI{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class ec{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new iI}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(gs(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new yG(this.backendInstance),!0}setupRegisteredKernels(){YE(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){YE(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof xw)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,i=r.then(o=>s<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,gs(`Initialization of backend ${e} failed`),gs(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return gs(`Initialization of backend ${e} failed`),gs(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:s,asyncInit:i}=this.initializeBackend(r);if(i||s)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),s=r.backend,i=this.readSync(n),o=s.refCount(n);s.disposeData(n,!0),r.backend=e,e.move(n,i,r.shape,r.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=n(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,n,r){e();try{const s=r();return n(),s}catch(s){throw n(),s}}nextTensorId(){return ec.nextTensorId++}nextVariableId(){return ec.nextVariableId++}clone(e){const n=te.runKernel(of,{x:e}),r={x:e},s=o=>({x:()=>{const a="float32",l={x:o},u={dtype:a};return te.runKernel(Hd,l,u)}}),i=[];return this.addTapeNode(this.state.activeScope.name,r,[n],s,i,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(KE(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const s=this.backend.numDataIds();let i=0;r.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=s-n-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const s=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const u=Vy(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Vy(e)){const{kernelName:m,inputs:v,attrs:p}=e;this.backendName==null&&this.backend;const g=KE(m,this.backendName);F(g!=null,()=>`Cannot find registered kernel '${m}' for backend '${this.backendName}'`),a=()=>{const y=this.backend.numDataIds();l=g.kernelFunc({inputs:v,attrs:p,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(m,y,b);const x=b.map(w=>w.rank!=null?w:this.makeTensorFromTensorInfo(w));if(s){const w=this.getTensorsForGradient(m,v,x);r=this.saveTensorsForBackwardMode(w)}return x}}else{const{forwardFunc:m}=e,v=p=>{s&&(r=p.map(g=>this.keep(this.clone(g))))};a=()=>{const p=this.backend.numDataIds();l=this.tidy(()=>m(this.backend,v));const g=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,p,g),g}}const{inputs:c,attrs:h}=e,d=Vy(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(u,c,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),s&&this.addTapeNode(u,c,n,d,r,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(m=>c[m]!=null?c[m].shape:null),outputShapes:n.map(m=>m.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const s=XE(e);if(s!=null){const i=s.inputsToSave||[],o=s.outputsToSave||[];let a;s.saveAllInputs?(F(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(u=>n[u])):a=i.map(u=>n[u]);const l=r.filter((u,c)=>o[c]);return a.concat(l)}return[]}makeTensor(e,n,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let i=e;r==="string"&&Md(e[0])&&(i=e.map(l=>ua(l)));const o=s.write(i,n,r),a=new Rn(n,r,o,this.nextTensorId());if(this.trackTensor(a,s),r==="string"){const l=this.state.tensorInfo.get(o),u=X5(i);this.state.numBytes+=u-l.bytes,l.bytes=u}return a}makeTensorFromDataId(e,n,r,s){r=r||"float32";const i={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(i,s)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:s,dtype:i}=e,o=new Rn(s,i,r,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const i=new qm(e,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*Vm(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof qm||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*Vm(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,s,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:i},l=XE(e);l!=null&&(s=l.gradFunc),s!=null&&(a.gradient=u=>(u=u.map((c,h)=>{if(c==null){const d=r[h],f=vr(d.size,d.dtype);return this.makeTensor(f,d.shape,d.dtype)}return c}),s(u.length>1?u:u[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=$A(e),r=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!r.has(o.id)&&o.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===s.id&&this.track(i)})}gradients(e,n,r,s=!1){if(F(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));F(i instanceof Rn,()=>"The result y returned by f() must be a tensor.");const o=wG(this.state.activeTape,n,i);if(!s&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=r??NG(i.shape),CG(a,o,u=>this.tidy(u),$G);const l=n.map(u=>a[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return F(mx(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{F(n.every(a=>a instanceof Rn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};n.forEach((a,l)=>{s[l]=a});const i=(a,l)=>(r=e(...n,l),F(r.value instanceof Rn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),F(mx(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),o=(a,l)=>{const u=r.gradFunc(a,l),c=Array.isArray(u)?u:[u];F(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),F(c.every(d=>d instanceof Rn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const h={};return c.forEach((d,f)=>{h[f]=()=>d}),h};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Lr(),r=await this.backend.time(e);return r.wallMs=Lr()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new iI;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}ec.nextTensorId=0;ec.nextVariableId=0;function NG(t){const e=Cw(be(t),"float32");return te.makeTensor(e,t,"float32")}function AA(){const t=KD();if(t._tfengine==null){const e=new Q5(t);t._tfengine=new ec(e)}return nG(t._tfengine.ENV),EG(()=>t._tfengine),t._tfengine}const te=AA();function $G(t,e){const n={a:t,b:e};return te.runKernel(wc,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DG(){return typeof navigator<"u"&&navigator!=null}function RA(t){if(t||DG()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function OA(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ur=me();Ur.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Ur.registerFlag("IS_BROWSER",()=>OA());Ur.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Ur.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Ur.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Ur.registerFlag("PROD",()=>!1);Ur.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Ur.getBool("DEBUG"));Ur.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Ur.registerFlag("IS_TEST",()=>!1);Ur.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Ur.getBool("DEBUG"));Ur.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Ur.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Ur.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pv(t,e){let n=t;if(Ys(t))return e==="string"?[]:[t.length];if(_A(t)){const s=t.channels||"RGBA";return[t.height,t.width*s.length]}else if(NA(t))return[t.buffer.size/(e==null?4:Vm(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||Ys(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&me().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&FA(t,r,[]),r}function FA(t,e,n){if(n=n||[],!Array.isArray(t)&&!Ys(t)){F(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}F(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),F(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let s=0;s<t.length;++s)FA(t[s],r,n.concat(s))}function oI(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function H(t,e,n,r="numeric"){if(t instanceof Rn)return oI(r,t.dtype,e,n),t;let s=xc(t);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),oI(r,s,e,n),t==null||!Ys(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const i=pv(t,s);!Ys(t)&&!Array.isArray(t)&&(t=[t]);const a=s!=="string"?Bl(t,s):vl(t,[],!0);return te.makeTensor(a,i,s)}function LA(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((i,o)=>H(i,`${e}[${o}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AG="__op";function le(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+AG;const s=(...i)=>{te.startScope(n);try{const o=r(...i);return Sw(o)&&console.error("Cannot return a Promise inside of tidy."),te.endScope(o),o}catch(o){throw te.endScope(null),o}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RG(t,e){const n=H(t,"real","complex"),r=H(e,"imag","complex");ww(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:n,imag:r};return te.runKernel(Aw,s)}const yl=le({complex_:RG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mv(t,e,n,r){if(r==null)r=xc(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(NA(t)||_A(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return te.backend.createTensorFromGPUData(t,e||n,r)}if(!Ys(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){$o(e);const s=be(e),i=be(n);F(s===i,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${i}`);for(let o=0;o<n.length;++o){const a=n[o],l=o===n.length-1?a!==be(e.slice(o)):!0;F(n[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Ys(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?Bl(t,r):vl(t,[],!0),te.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $h(t,e,n){const r=pv(t,n);return mv(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aI={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class _a{static join(e){return new _a(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>Ys(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let r=0;r<e.length;r++){const s=e[r];r!==e.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=n+s.byteLength;this.shards.push({buffer:s,start:n,end:i}),n=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const s=n-e,i=new ArrayBuffer(s),o=new Uint8Array(i);let a=0;for(let l=r;l<this.shards.length;l++){const u=this.shards[l],h=e+a-u.start,d=a,m=Math.min(n,u.end)-u.start,v=new Uint8Array(u.buffer,h,m-h);if(o.set(v,d),a+=v.length,n<u.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(s){return e<s.start?-1:e>=s.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=OG(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function OG(t,e){let n=0,r=t.length;for(;n<=r;){const s=Math.floor((r-n)/2)+n,i=e(t[s]);if(i===0)return s;i<0?r=s:n=s+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Km=4;async function lI(t,e){const n=[],r=[],s=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<s.length;++o){const a=s[o],l=Array.isArray(t)?t[o].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const u={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async h=>{const d=await l.bytes(),f=d.reduce((p,g)=>p+g.length,0)+Km*d.length,m=new Uint8Array(f);let v=0;for(let p=0;p<d.length;p++){const g=d[p],y=new Uint8Array(new Uint32Array([g.length]).buffer);m.set(y,v),v+=Km,m.set(g,v),v+=g.length}h(m)});r.push(c)}else r.push(l.data());e!=null&&(u.group=e),n.push(u)}const i=await Promise.all(r);return{data:LG(i),specs:n}}function FG(t,e){const n=new _a(t),r={};let s,i=0;for(const o of e){const a=o.name,l=o.dtype,u=o.shape,c=be(u);let h;if("quantization"in o){const d=o.quantization;if(d.dtype==="uint8"||d.dtype==="uint16"){if(!("min"in d&&"scale"in d))throw new Error(`Weight ${o.name} with quantization ${d.dtype} doesn't have corresponding metadata min and scale.`)}else if(d.dtype==="float16"){if(l!=="float32")throw new Error(`Weight ${o.name} is quantized with ${d.dtype} which only supports weights of type float32 not ${l}.`)}else throw new Error(`Weight ${o.name} has unknown quantization dtype ${d.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const f=aI[d.dtype],m=n.slice(i,i+c*f),v=d.dtype==="uint8"?new Uint8Array(m):new Uint16Array(m);if(l==="float32")if(d.dtype==="uint8"||d.dtype==="uint16"){h=new Float32Array(v.length);for(let p=0;p<v.length;p++){const g=v[p];h[p]=g*d.scale+d.min}}else if(d.dtype==="float16")s===void 0&&(s=qG()),h=s(v);else throw new Error(`Unsupported quantization type ${d.dtype} for weight type float32.`);else if(l==="int32"){if(d.dtype!=="uint8"&&d.dtype!=="uint16")throw new Error(`Unsupported quantization type ${d.dtype} for weight type int32.`);h=new Int32Array(v.length);for(let p=0;p<v.length;p++){const g=v[p];h[p]=Math.round(g*d.scale+d.min)}}else throw new Error(`Unsupported dtype in weight '${a}': ${l}`);i+=c*f}else if(l==="string"){const d=be(o.shape);h=[];for(let f=0;f<d;f++){const m=new Uint32Array(n.slice(i,i+Km))[0];i+=Km;const v=new Uint8Array(n.slice(i,i+m));h.push(v),i+=m}}else{const d=aI[l],f=n.slice(i,i+c*d);if(l==="float32")h=new Float32Array(f);else if(l==="int32")h=new Int32Array(f);else if(l==="bool")h=new Uint8Array(f);else if(l==="complex64"){h=new Float32Array(f);const m=new Float32Array(h.length/2),v=new Float32Array(h.length/2);for(let y=0;y<m.length;y++)m[y]=h[y*2],v[y]=h[y*2+1];const p=$h(m,u,"float32"),g=$h(v,u,"float32");r[a]=yl(p,g),p.dispose(),g.dispose()}else throw new Error(`Unsupported dtype in weight '${a}': ${l}`);i+=c*d}l!=="complex64"&&(r[a]=$h(h,u,l))}return r}function LG(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const r=new Uint8Array(e);let s=0;return n.forEach(i=>{r.set(new Uint8Array(i.buffer),s),s+=i.byteLength}),r.buffer}const p2=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function uI(t){return p2?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function PG(t){if(p2)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function MG(t){if(p2){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function BG(t){return _a.join(t)}function zG(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function UG(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}async function VG(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),UG(t,n,r)}function m2(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:uI(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:uI(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new _a(t.weightData).byteLength}}function WG(t){const e=[];for(const n of t)e.push(...n.weights);return e}function GG(){const t=n=>{let r=n<<13,s=0;for(;!(r&8388608);)s-=8388608,r<<=1;return r&=-8388609,s+=947912704,r|s},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function jG(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function HG(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function qG(){const t=GG(),e=jG(),n=HG();return r=>{const s=new ArrayBuffer(4*r.length),i=new Uint32Array(s);for(let o=0;o<r.length;o++){const a=r[o],l=t[n[a>>10]+(a&1023)]+e[a>>10];i[o]=l}return new Float32Array(s)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Xn.instance==null&&(Xn.instance=new Xn),Xn.instance}static registerSaveRouter(e){Xn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Xn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Xn.getHandlers(e,"save")}static getLoadHandlers(e,n){return Xn.getHandlers(e,"load",n)}static getHandlers(e,n,r){const s=[];return(n==="load"?Xn.getInstance().loadRouters:Xn.getInstance().saveRouters).forEach(o=>{const a=o(e,r);a!==null&&s.push(a)}),s}}const KG=t=>Xn.getSaveHandlers(t),XG=(t,e)=>Xn.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ix="tensorflowjs",Tx=1,el="models_store",Xo="model_info_store";function PA(){if(!me().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function _x(t){const e=t.result;e.createObjectStore(el,{keyPath:"modelPath"}),e.createObjectStore(Xo,{keyPath:"modelPath"})}class xl{constructor(e){if(this.indexedDB=PA(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,s)=>{const i=this.indexedDB.open(Ix,Tx);i.onupgradeneeded=()=>_x(i),i.onsuccess=()=>{const o=i.result;if(n==null){const a=o.transaction(el,"readonly"),u=a.objectStore(el).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return o.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(u.result.modelArtifacts)},u.onerror=c=>(o.close(),s(u.error)),a.oncomplete=()=>o.close()}else{n.weightData=_a.join(n.weightData);const a=m2(n),l=o.transaction(Xo,"readwrite");let u=l.objectStore(Xo),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(d){return s(d)}let h;c.onsuccess=()=>{h=o.transaction(el,"readwrite");const d=h.objectStore(el);let f;try{f=d.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(m){return s(m)}f.onsuccess=()=>r({modelArtifactsInfo:a}),f.onerror=m=>{u=l.objectStore(Xo);const v=u.delete(this.modelPath);v.onsuccess=()=>(o.close(),s(f.error)),v.onerror=p=>(o.close(),s(f.error))}},c.onerror=d=>(o.close(),s(c.error)),l.oncomplete=()=>{h==null?o.close():h.oncomplete=()=>o.close()}}},i.onerror=o=>s(i.error)})}}xl.URL_SCHEME="indexeddb://";const MA=t=>me().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(xl.URL_SCHEME)?YG(t.slice(xl.URL_SCHEME.length)):null;Xn.registerSaveRouter(MA);Xn.registerLoadRouter(MA);function YG(t){return new xl(t)}function ZG(t){return t.startsWith(xl.URL_SCHEME)?t.slice(xl.URL_SCHEME.length):t}class QG{constructor(){this.indexedDB=PA()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(Ix,Tx);r.onupgradeneeded=()=>_x(r),r.onsuccess=()=>{const s=r.result,i=s.transaction(Xo,"readonly"),a=i.objectStore(Xo).getAll();a.onsuccess=()=>{const l={};for(const u of a.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},a.onerror=l=>(s.close(),n(a.error)),i.oncomplete=()=>s.close()},r.onerror=s=>n(r.error)})}async removeModel(e){return e=ZG(e),new Promise((n,r)=>{const s=this.indexedDB.open(Ix,Tx);s.onupgradeneeded=()=>_x(s),s.onsuccess=()=>{const i=s.result,o=i.transaction(Xo,"readwrite"),a=o.objectStore(Xo),l=a.get(e);let u;l.onsuccess=()=>{if(l.result==null)return i.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=a.delete(e),h=()=>{u=i.transaction(el,"readwrite");const f=u.objectStore(el).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=m=>r(l.error)};c.onsuccess=h,c.onerror=d=>(h(),i.close(),r(l.error))}},l.onerror=c=>(i.close(),r(l.error)),o.oncomplete=()=>{u==null?i.close():u.oncomplete=()=>i.close()}},s.onerror=i=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const co="/",fu="tensorflowjs_models",BA="info",JG="model_topology",ej="weight_specs",tj="weight_data",nj="model_metadata";function zA(t){return{info:[fu,t,BA].join(co),topology:[fu,t,JG].join(co),weightSpecs:[fu,t,ej].join(co),weightData:[fu,t,tj].join(co),modelMetadata:[fu,t,nj].join(co)}}function UA(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function rj(t){const e=t.split(co);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(co)}function sj(t){return t.startsWith(bl.URL_SCHEME)?t.slice(bl.URL_SCHEME.length):t}class bl{constructor(e){if(!me().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=zA(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=m2(e),i=_a.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,PG(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:s}}catch{throw UA(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=s;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=MG(o),n}}bl.URL_SCHEME="localstorage://";const VA=t=>me().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(bl.URL_SCHEME)?ij(t.slice(bl.URL_SCHEME.length)):null;Xn.registerSaveRouter(VA);Xn.registerLoadRouter(VA);function ij(t){return new bl(t)}class oj{constructor(){F(me().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),F(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=fu+co,r=co+BA;for(let s=0;s<this.LS.length;++s){const i=this.LS.key(s);if(i.startsWith(n)&&i.endsWith(r)){const o=rj(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=sj(e);const n=zA(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return UA(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cI="://";class Oi{constructor(){this.managers={}}static getInstance(){return Oi.instance==null&&(Oi.instance=new Oi),Oi.instance}static registerManager(e,n){F(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(cI)&&(e=e.slice(0,e.indexOf(cI))),F(e.length>0,()=>"scheme must not be an empty string.");const r=Oi.getInstance();F(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=Oi.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(Oi.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aj{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!me().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return yA(e)}}if(me().get("IS_BROWSER")){me().setPlatform("browser",new aj);try{Oi.registerManager(bl.URL_SCHEME,new oj)}catch{}try{Oi.registerManager(xl.URL_SCHEME,new QG)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lj={importFetch:()=>require("node-fetch")};let Wy;class uj{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return me().global.fetch!=null?me().global.fetch(e,n):(Wy==null&&(Wy=lj.importFetch()),Wy(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}me().get("IS_NODE")&&!me().get("IS_BROWSER")&&me().setPlatform("node",new uj);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pt(t,e="float32",n){return e=e||"float32",$o(t),new ar(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cj(t,e){const n=H(t,"x","cast");if(!K5(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},s={dtype:e};return te.runKernel(Hd,r,s)}const Ve=le({cast_:cj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hj(t){const n={x:H(t,"x","clone","string_or_numeric")};return te.runKernel(of,n)}const sl=le({clone_:hj});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dj(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */AA();const fj={buffer:pt,cast:Ve,clone:sl,print:dj};IG(fj);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ri(){return te}function Nx(){return te.memory()}function pe(t,e){return te.tidy(t,e)}function ft(t){$A(t).forEach(n=>n.dispose())}function qi(t){return te.keep(t)}function WA(t,e,n=1){return te.registerBackend(t,e,n)}function pj(){return te.backend}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mj(t,e){let n=H(t,"a","add"),r=H(e,"b","add");[n,r]=wn(n,r);const s={a:n,b:r};return te.runKernel(wc,s)}const Ae=le({add_:mj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gj(t,e){let n=H(t,"a","floorDiv"),r=H(e,"b","floorDiv");[n,r]=wn(n,r);const s={a:n,b:r};return te.runKernel(rf,s)}const GA=le({floorDiv_:gj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vj(t,e){let n=H(t,"a","div"),r=H(e,"b","div");if([n,r]=wn(n,r),n.dtype==="int32"&&r.dtype==="int32")return GA(n,r);const s={a:n,b:r},i={};return te.runKernel(Zd,s,i)}const nt=le({div_:vj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yj(t,e){let n=H(t,"a","mul"),r=H(e,"b","mul");[n,r]=wn(n,r);const s={a:n,b:r};return te.runKernel(mf,s)}const ee=le({mul_:yj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xj(t){const e=H(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return te.runKernel(b0,n)}else{const n={x:e};return te.runKernel(f0,n)}}const Sr=le({abs_:xj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bj(t){const n={x:H(t,"x","acos")};return te.runKernel(Bd,n)}const wj=le({acos_:bj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cj(t){const n={x:H(t,"x","acosh")};return te.runKernel(zd,n)}const Sj=le({acosh_:Cj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kj(t,e=null,n=!1){const s={x:H(t,"x","all","bool")},i={axis:e,keepDims:n};return te.runKernel(Iw,s,i)}const jA=le({all_:kj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ej(t,e=null,n=!1){const s={x:H(t,"x","any","bool")},i={axis:e,keepDims:n};return te.runKernel(Tw,s,i)}const $x=le({any_:Ej});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ij(t,e=0){const r={x:H(t,"x","argMax")},s={axis:e};return te.runKernel(p0,r,s)}const rd=le({argMax_:Ij});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tj(t,e=0){const r={x:H(t,"x","argMin")},s={axis:e};return te.runKernel(m0,r,s)}const _j=le({argMin_:Tj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nj(t){const n={x:H(t,"x","asin")};return te.runKernel(Ud,n)}const $j=le({asin_:Nj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dj(t){const n={x:H(t,"x","asinh")};return te.runKernel(Vd,n)}const Aj=le({asinh_:Dj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rj(t){const n={x:H(t,"x","atan")};return te.runKernel(Wd,n)}const Oj=le({atan_:Rj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fj(t,e){let n=H(t,"a","atan2"),r=H(e,"b","atan2");[n,r]=wn(n,r);const s={a:n,b:r};return te.runKernel(jd,s)}const Lj=le({atan2_:Fj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pj(t){const n={x:H(t,"x","atanh")};return te.runKernel(Gd,n)}const Mj=le({atanh_:Pj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ff(t,e,n,r,s="NHWC",i){const o=t[3],a=[...e,o],l=Ao(s);return ur(t,a,n,i,r,null,null,l)}function Qs(t,e,n,r,s,i,o="channelsLast"){const[a,l]=sd(e);let u;if(o==="channelsLast")u=[a,l,t[3],t[3]];else if(o==="channelsFirst")u=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return ur(t,u,n,r,s,i,!1,o)}function Do(t,e,n,r,s,i,o="NDHWC"){const[a,l,u]=Dx(e);let c,h;if(o==="NDHWC")h="channelsLast",c=[a,l,u,t[4],t[4]];else if(o==="NCDHW")h="channelsFirst",c=[a,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Na(t,c,n,r,s,!1,h,i)}function ur(t,e,n,r,s,i,o=!1,a="channelsLast"){let[l,u,c,h]=[-1,-1,-1,-1];if(a==="channelsLast")[l,u,c,h]=t;else if(a==="channelsFirst")[l,h,u,c]=t;else throw new Error(`Unknown dataFormat ${a}`);const[d,f,,m]=e,[v,p]=sd(n),[g,y]=sd(r),b=Bu(d,g),x=Bu(f,y),{padInfo:w,outHeight:C,outWidth:S}=Uj(s,u,c,v,p,b,x,i,a),E=o?m*h:m;let T;return a==="channelsFirst"?T=[l,E,C,S]:a==="channelsLast"&&(T=[l,C,S,E]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:c,inChannels:h,outHeight:C,outWidth:S,outChannels:E,padInfo:w,strideHeight:v,strideWidth:p,filterHeight:d,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:x,dilationHeight:g,dilationWidth:y,inShape:t,outShape:T,filterShape:e}}function Na(t,e,n,r,s,i=!1,o="channelsLast",a){let[l,u,c,h,d]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,u,c,h,d]=t;else if(o==="channelsFirst")[l,d,u,c,h]=t;else throw new Error(`Unknown dataFormat ${o}`);const[f,m,v,,p]=e,[g,y,b]=Dx(n),[x,w,C]=Dx(r),S=Bu(f,x),E=Bu(m,w),T=Bu(v,C),{padInfo:_,outDepth:A,outHeight:L,outWidth:W}=Vj(s,u,c,h,g,y,b,S,E,T,a),K=i?p*d:p;let R;return o==="channelsFirst"?R=[l,K,A,L,W]:o==="channelsLast"&&(R=[l,A,L,W,K]),{batchSize:l,dataFormat:o,inDepth:u,inHeight:c,inWidth:h,inChannels:d,outDepth:A,outHeight:L,outWidth:W,outChannels:K,padInfo:_,strideDepth:g,strideHeight:y,strideWidth:b,filterDepth:f,filterHeight:m,filterWidth:v,effectiveFilterDepth:S,effectiveFilterHeight:E,effectiveFilterWidth:T,dilationDepth:x,dilationHeight:w,dilationWidth:C,inShape:t,outShape:R,filterShape:e}}function Bj(t,e,n,r,s){r==null&&(r=g2(t,e,n));const i=t[0],o=t[1],a=id((i-e+2*r)/n+1,s),l=id((o-e+2*r)/n+1,s);return[a,l]}function zj(t,e,n,r,s,i){s==null&&(s=g2(t,e[0],r[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*s>=e[a]&&(o[a]=id((t[a]-e[a]+2*s)/r[a]+1,i));return o}function g2(t,e,n,r=1){const s=Bu(e,r);return Math.floor((t[0]*(n-1)-n+s)/2)}function sd(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Dx(t){return typeof t=="number"?[t,t,t]:t}function Bu(t,e){return e<=1?t:t+(t-1)*(e-1)}function Uj(t,e,n,r,s,i,o,a,l){let u,c,h;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=Bj([e,n],i,r,t,a);c=f[0],h=f[1]}else if(t==="same"){c=Math.ceil(e/r),h=Math.ceil(n/s);const d=Math.max(0,(c-1)*r+i-e),f=Math.max(0,(h-1)*s+o-n),m=Math.floor(d/2),v=d-m,p=Math.floor(f/2),g=f-p;u={top:m,bottom:v,left:p,right:g,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-i+1)/r),h=Math.ceil((n-o+1)/s);else if(typeof t=="object"){const d=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],m=l==="channelsLast"?t[2][0]:t[3][0],v=l==="channelsLast"?t[2][1]:t[3][1];u={top:d,bottom:f,left:m,right:v,type:d===0&&f===0&&m===0&&v===0?"VALID":"EXPLICIT"},c=id((e-i+d+f)/r+1,a),h=id((n-o+m+v)/s+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:h}}function Vj(t,e,n,r,s,i,o,a,l,u,c){let h,d,f,m;if(t==="valid"&&(t=0),typeof t=="number"){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const p=zj([e,n,r,1],[a,l,u],1,[s,i,o],t,c);d=p[0],f=p[1],m=p[2]}else if(t==="same"){d=Math.ceil(e/s),f=Math.ceil(n/i),m=Math.ceil(r/o);const v=(d-1)*s+a-e,p=(f-1)*i+l-n,g=(m-1)*o+u-r,y=Math.floor(v/2),b=v-y,x=Math.floor(p/2),w=p-x,C=Math.floor(g/2),S=g-C;h={top:x,bottom:w,left:C,right:S,front:y,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:h,outDepth:d,outHeight:f,outWidth:m}}function id(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function wl(t){const[e,n,r]=sd(t);return e===1&&n===1&&r===1}function yr(t,e){return wl(t)||wl(e)}function Cl(t){return sd(t).every(e=>e>0)}function Ao(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Hr(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")F(Qu(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{F(Qu(s),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${s}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wj(t,e){const r={x:H(t,"x","reshape","string_or_numeric")},s={shape:e};return te.runKernel(ev,r,s)}const ae=le({reshape_:Wj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gj(t,e,n,r,s){const i=H(t,"x","avgPool","float32"),o=1;F(yr(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=ae(i,[1,i.shape[0],i.shape[1],i.shape[2]])),F(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Hr("avgPool",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s};let h=te.runKernel(g0,u,c);return h=Ve(h,i.dtype),l?ae(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const v2=le({avgPool_:Gj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jj(t,e,n,r,s,i="NDHWC"){const o=H(t,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=ae(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),F(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),F(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),F(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Hr("avgPool3d",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:i};let h=te.runKernel(v0,u,c);return h=Ve(h,a.dtype),l?ae(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Hj=le({avgPool3d_:jj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qj(t,e=0){F(t.length>=1,()=>"Pass at least one tensor to concat");const n=LA(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return sl(n[0]);const r=n,s={axis:e};return te.runKernel(w0,r,s)}const zr=le({concat_:qj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kj(t,e,n=!1,r=!1){let s=H(t,"a","matMul"),i=H(e,"b","matMul");[s,i]=wn(s,i);const o={a:s,b:i},a={transposeA:n,transposeB:r};return te.runKernel(y0,o,a)}const _t=le({matMul_:Kj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xj(t){const n={x:H(t,"x","sigmoid","float32")};return te.runKernel(If,n)}const Cc=le({sigmoid_:Xj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yj(t,e,n){const r=H(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},i={begin:e,size:n};return te.runKernel(iv,s,i)}const Kt=le({slice_:Yj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zj(t){const n={x:H(t,"x","tanh","float32")};return te.runKernel(Af,n)}const y2=le({tanh_:Zj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qj(t,e,n){const r=H(t,"x","batchToSpaceND"),s=e.reduce((a,l)=>a*l);F(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),F(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),F(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const i={x:r},o={blockShape:e,crops:n};return te.runKernel(x0,i,o)}const x2=le({batchToSpaceND_:Qj});function Jj(t){let e;return t.rank===0||t.rank===1?e=ae(t,[1,1,1,t.size]):t.rank===2?e=ae(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=ae(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eH(t,e,n,r,s,i){i==null&&(i=.001);const o=H(t,"x","batchNorm"),a=H(e,"mean","batchNorm"),l=H(n,"variance","batchNorm");let u;s!=null&&(u=H(s,"scale","batchNorm"));let c;r!=null&&(c=H(r,"offset","batchNorm")),F(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),F(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),F(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:Jj(o),scale:u,offset:c,mean:a,variance:l},f={varianceEpsilon:i},m=te.runKernel($0,d,f);return ae(m,o.shape)}const gv=le({batchNorm_:eH});function tH(t,e,n,r,s,i){const o=H(t,"x","batchNorm"),a=H(e,"mean","batchNorm"),l=H(n,"variance","batchNorm");let u;s!=null&&(u=H(s,"scale","batchNorm"));let c;return r!=null&&(c=H(r,"offset","batchNorm")),F(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),F(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),F(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&F(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&F(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),gv(o,a,l,c,u,i)}const nH=le({batchNorm2d_:tH});function rH(t,e,n,r,s,i){const o=H(t,"x","batchNorm"),a=H(e,"mean","batchNorm"),l=H(n,"variance","batchNorm");let u;s!=null&&(u=H(s,"scale","batchNorm"));let c;return r!=null&&(c=H(r,"offset","batchNorm")),F(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),F(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),F(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&F(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&F(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),gv(o,a,l,c,u,i)}const sH=le({batchNorm3d_:rH});function iH(t,e,n,r,s,i){const o=H(t,"x","batchNorm"),a=H(e,"mean","batchNorm"),l=H(n,"variance","batchNorm");let u;s!=null&&(u=H(s,"scale","batchNorm"));let c;return r!=null&&(c=H(r,"offset","batchNorm")),F(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),F(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),F(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&F(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&F(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),gv(o,a,l,c,u,i)}const oH=le({batchNorm4d_:iH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aH(t,e,n){const r=H(t,"x","bincount"),s=H(e,"weights","bincount");F(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),F(n>=0,()=>`size must be non-negative, but got ${n}.`),F(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const i={x:r,weights:s},o={size:n};return te.runKernel($w,i,o)}const lH=le({bincount_:aH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uH(t,e){let n=H(t,"broadcastTo","x");const r=n.shape;if($o(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=ae(n,u)}const s=n.shape,i=Array.from(e);for(let u=e.length-1;u>=0;u--)if(s[u]===e[u])i[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(i.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return sl(n);const a={x:n},l={reps:i};return te.runKernel(Rf,a,l)}const Dh=le({broadcastTo_:uH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cH(t){const n={x:H(t,"x","ceil","float32")};return te.runKernel(qd,n)}const hH=le({ceil_:cH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vv(t,e,n){$o(t),n=n||xc(e);const r={shape:t,value:e,dtype:n};return te.runKernel(jw,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dH(t,e,n){const r=H(t,"x","clipByValue");if(F(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return vv(r.shape,e,r.dtype);const s={x:r},i={clipValueMin:e,clipValueMax:n};return te.runKernel(Kd,s,i)}const Cs=le({clipByValue_:dH});function fH(t){return zr(t,0)}const pH=le({concat1d_:fH});function mH(t,e){return zr(t,e)}const gH=le({concat2d_:mH});function vH(t,e){return zr(t,e)}const yH=le({concat3d_:vH});function xH(t,e){return zr(t,e)}const bH=le({concat4d_:xH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wH(t,e,n,r,s="NHWC",i=[1,1],o){const a=H(t,"x","conv2d","float32"),l=H(e,"filter","conv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=ae(a,[1,a.shape[0],a.shape[1],a.shape[2]])),F(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),F(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Hr("conv2d",r,o);const h=s==="NHWC"?u.shape[3]:u.shape[1];F(h===l.shape[2],()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${l.shape[2]}.`),F(yr(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),F(Cl(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),F(Cl(n),()=>"Error in conv2D: Strides should be larger than 0.");const d={x:u,filter:l},f={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},m=te.runKernel(C0,d,f);return c?ae(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const Sl=le({conv2d_:wH});function CH(t,e,n,r,s="NWC",i=1,o){const a=H(t,"x","conv1d"),l=H(e,"filter","conv1d");let u=a,c=!1;a.rank===2&&(c=!0,u=ae(a,[1,a.shape[0],a.shape[1]])),F(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),F(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Hr("conv1d",r,o),F(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),F(yr(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),F(Cl(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),F(Cl(n),()=>"Error in conv1D: Stride should be larger than 0."),F(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const h=ae(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=ae(u,[u.shape[0],1,u.shape[1],u.shape[2]]),p=Sl(d,h,[1,n],r,"NHWC",[1,i],o);return c?ae(p,[p.shape[2],p.shape[3]]):ae(p,[p.shape[0],p.shape[2],p.shape[3]])}const HA=le({conv1d_:CH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SH(t,e,n,r,s,i="NHWC",o){F(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,u=!1;e.rank===3&&(u=!0,l=ae(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),F(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),F(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),F(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=i==="NHWC"?a[3]:a[1],h=i==="NHWC"?l.shape[3]:l.shape[1];F(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),F(h===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${n.shape[3]}.`),Hr("conv2dDerInput",s,o);const d={dy:l,filter:n},f={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,inputShape:a},m=te.runKernel(S0,d,f);return u?ae(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const b2=le({conv2DBackpropInput_:SH});function kH(t,e,n,r,s,i){const o=H(t,"x","conv2dTranspose"),a=H(e,"filter","conv2dTranspose");return b2(n,o,a,r,s,"NHWC",i)}const qA=le({conv2dTranspose_:kH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EH(t,e,n,r,s="NDHWC",i=[1,1,1]){const o=H(t,"x","conv3d"),a=H(e,"filter","conv3d");let l=o,u=!1;o.rank===4&&(u=!0,l=ae(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),F(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),F(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),F(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),F(yr(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),F(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),F(Cl(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),F(Cl(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:a},h={strides:n,pad:r,dataFormat:s,dilations:i},d=te.runKernel(k0,c,h);return u?ae(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const IH=le({conv3d_:EH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TH(t,e,n,r,s){F(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,a=!1;e.rank===4&&(a=!0,o=ae(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],u=o.shape[4];F(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),F(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),F(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),F(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),F(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:o,filter:n},h={pad:s,strides:r,inputShape:i},d=te.runKernel(Fw,c,h);return a?ae(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const KA=le({conv3DBackpropInput_:TH});function _H(t,e,n,r,s){const i=H(t,"x","conv3dTranspose"),o=H(e,"filter","conv3dTranspose");return KA(n,i,o,r,s)}const NH=le({conv3dTranspose_:_H});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $H(t){const n={x:H(t,"x","cos","float32")};return te.runKernel(Xd,n)}const w2=le({cos_:$H});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DH(t){const n={x:H(t,"x","cosh","float32")};return te.runKernel(Yd,n)}const XA=le({cosh_:DH});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AH(t,e=0,n=!1,r=!1){const i={x:H(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:r};return te.runKernel(Lw,i,o)}const Ax=le({cumprod_:AH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RH(t,e=0,n=!1,r=!1){const i={x:H(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:r};return te.runKernel(E0,i,o)}const YA=le({cumsum_:RH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OH(t,e,n,r=!1){const s=H(t,"x","denseBincount"),i=H(e,"weights","denseBincount");F(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),F(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),F(n>=0,()=>`size must be non-negative, but got ${n}.`),F(i.size===s.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${i.shape}.`);const o={x:s,weights:i},a={size:n,binaryOutput:r};return te.runKernel(Mw,o,a)}const hI=le({denseBincount_:OH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FH(t,e,n="NHWC"){const r=H(t,"x","depthToSpace","float32"),s=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];F(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),F(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),F(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${r.shape}`),F(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${r.shape}`);const a={x:r},l={blockSize:e,dataFormat:n};return te.runKernel(Bw,a,l)}const LH=le({depthToSpace_:FH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PH(t,e,n,r,s="NHWC",i=[1,1],o){const a=H(t,"x","depthwiseConv2d","float32"),l=H(e,"filter","depthwiseConv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=ae(a,[1,a.shape[0],a.shape[1],a.shape[2]])),F(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),F(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const h=s==="NHWC"?u.shape[3]:u.shape[1];F(h===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${h}) must match the inChannels dimension in filter ${l.shape[2]}.`),Hr("depthwiseConv2d",r,o);const d={x:u,filter:l},f={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},m=te.runKernel(I0,d,f);return c?ae(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const C2=le({depthwiseConv2d_:PH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MH(t,e,n,r,s=[1,1],i="NHWC"){const o=H(t,"x","dilation2d"),a=H(e,"filter","dilation2d");F(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),F(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),F(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,u=!1;o.rank===3&&(l=ae(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=!0),F(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const c={x:l,filter:a},h={strides:n,pad:r,dilations:s},d=te.runKernel(T0,c,h);return u?ae(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const BH=le({dilation2d_:MH});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tc(t,e){const n=t.length,r=[];for(let s=0;s<n;s++){const i=n-1-s,o=t[i]||1;(e[e.length-1-s]||1)>1&&o===1&&r.unshift(i)}return r}function Hn(t,e){const n=[];for(let r=0;r<e.length;r++){const s=t[t.length-r-1],i=e.length-r-1,o=e[i];(s==null||s===1&&o>1)&&n.unshift(i)}return n}function ut(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let s=0;s<n;s++){let i=t[t.length-s-1];i==null&&(i=1);let o=e[e.length-s-1];if(o==null&&(o=1),i===1)r[n-s-1]=o;else if(o===1)r[n-s-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else r[n-s-1]=i}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zH(t,e){let n=H(t,"a","equal","string_or_numeric"),r=H(e,"b","equal","string_or_numeric");[n,r]=wn(n,r),ut(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(_0,s)}const Qi=le({equal_:zH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UH(t,e,n){const r=H(e,"a","where"),s=H(n,"b","where"),i=H(t,"condition","where","bool"),o=ut(ut(i.shape,r.shape),s.shape),a=Dh(i,o),l=Dh(r,o),u=Dh(s,o),c={condition:a,t:l,e:u};return te.runKernel(sv,c)}const Tr=le({where_:UH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VH(t){const n={x:H(t,"x","zerosLike")};return te.runKernel(dv,n)}const Ct=le({zerosLike_:VH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WH(t,e){let n=H(t,"a","div"),r=H(e,"b","div");[n,r]=wn(n,r);const s=nt(n,r),i=Ct(s),o=Qi(r,i);return Tr(o,i,s)}const GH=le({divNoNan_:WH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jH(t,e){const n=H(t,"t1","dot"),r=H(e,"t2","dot");F((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const s=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];if(F(s===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${i}.`),n.rank===1&&r.rank===1){const o=ae(n,[1,-1]),a=ae(r,[-1,1]),l=_t(o,a);return ae(l,[])}else if(n.rank===1&&r.rank===2){const o=ae(n,[1,-1]),a=ae(r,[r.shape[0],r.shape[1]]),l=_t(o,a);return ae(l,[l.size])}else if(n.rank===2&&r.rank===1){const o=ae(r,[-1,1]),a=_t(n,o);return ae(a,[a.size])}else{const o=ae(r,[r.shape[0],r.shape[1]]);return _t(n,o)}}const HH=le({dot_:jH});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qH(t,...e){const n=e.map((s,i)=>H(s,`tensors${i}`,"einsum")),r={equation:t};return te.runKernel(Vw,n,r)}const sh=le({einsum_:qH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KH(t){const n={x:H(t,"x","elu","float32")};return te.runKernel(Qd,n)}const yv=le({elu_:KH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XH(t){let e=H(t,"x","erf");F(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Ve(e,"float32"));const n={x:e};return te.runKernel(Jd,n)}const YH=le({erf_:XH});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S2(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function ZA(t,e,n){const r=t.length+e.length,s=[];let i=0,o=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?s.push(t[i++]):s.push(e[o++]);return s}function tr(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)e.indexOf(i)===-1&&n.push(t[i]);const s=e.map(i=>t[i]);return[n,s]}function Fn(t,e){const n=e.map(r=>1);return ZA(t,n,e)}function cr(t,e,n){F(S2(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function hn(t,e){if(S2(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function $a(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Cn(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZH(t,e=null,n=!1){const s={x:H(t,"x","max")},i={reductionIndices:e,keepDims:n};return te.runKernel(z0,s,i)}const yi=le({max_:ZH});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QH(t,e=null,n=!1){const s={x:H(t,"x","min")},i={axis:e,keepDims:n};return te.runKernel(G0,s,i)}const Xm=le({min_:QH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JH(t,e){let n=H(t,"base","pow"),r=H(e,"exp","pow");[n,r]=wn(n,r);const s={a:n,b:r};return te.runKernel(gf,s)}const nc=le({pow_:JH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function At(t,e){if((Ys(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Ys(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return mv(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eq(t){const n={x:H(t,"x","sqrt","float32")};return te.runKernel(_f,n)}const Nr=le({sqrt_:eq});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tq(t){const e=H(t,"x","square"),n={};return te.runKernel("Square",{x:e},n)}const en=le({square_:tq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nq(t,e=null,n=!1){let r=H(t,"x","sum");r.dtype==="bool"&&(r=Ve(r,"int32"));const s={x:r},i={axis:e,keepDims:n};return te.runKernel(ov,s,i)}const et=le({sum_:nq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rq(t,e="euclidean",n=null,r=!1){t=H(t,"x","norm");const s=QA(t,e,n);let i=s.shape;if(r){const o=mt(n,t.shape);i=Fn(s.shape,o)}return ae(s,i)}function QA(t,e,n=null){if(t.rank===0)return Sr(t);if(t.rank!==1&&n===null)return QA(ae(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return et(Sr(t),n);if(e===1/0)return yi(Sr(t),n);if(e===-1/0)return Xm(Sr(t),n);if(e==="euclidean"||e===2)return Nr(et(nc(Sr(t),At(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return yi(et(Sr(t),n[0]),n[1]-1);if(e===1/0)return yi(et(Sr(t),n[1]),n[0]);if(e===-1/0)return Xm(et(Sr(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Nr(et(en(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const xv=le({norm_:rq});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sq(t,e=null,n=!1){return xv(t,"euclidean",e,n)}const iq=le({euclideanNorm_:sq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oq(t){const n={x:H(t,"x","exp")};return te.runKernel(ef,n)}const So=le({exp_:oq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aq(t,e=0){const n=H(t,"x","expandDims","string_or_numeric");F(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},s={dim:e};return te.runKernel(N0,r,s)}const Pr=le({expandDims_:aq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lq(t){const n={x:H(t,"x","expm1")};return te.runKernel(tf,n)}const uq=le({expm1_:lq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cq(t,e){const n=H(t,"x","tile","string_or_numeric");F(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},s={reps:e};return te.runKernel(Rf,r,s)}const fi=le({tile_:cq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hq(t,e,n,r="float32"){e==null&&(e=t);const s=pt([t,e],r),i=t<=e?t:e;for(let a=0;a<i;++a)s.set(1,a,a);const o=ae(s.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return fi(Pr(o,0),[n[0],1,1]);if(n.length===2)return fi(Pr(Pr(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return fi(Pr(Pr(Pr(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const JA=le({eye_:hq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dq(t){const n={x:H(t,"x","floor","float32")};return te.runKernel(nf,n)}const bv=le({floor_:dq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fq(t,e,n=0,r=0){const s=H(t,"x","gather"),i=H(e,"indices","gather","int32"),o={x:s,indices:i},a={axis:n,batchDims:r};return te.runKernel(D0,o,a)}const k2=le({gather_:fq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pq(t,e){let n=H(t,"a","greater","string_or_numeric"),r=H(e,"b","greater","string_or_numeric");[n,r]=wn(n,r),ut(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(A0,s)}const Es=le({greater_:pq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mq(t,e){let n=H(t,"a","greaterEqual","string_or_numeric"),r=H(e,"b","greaterEqual","string_or_numeric");[n,r]=wn(n,r),ut(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(sf,s)}const zl=le({greaterEqual_:mq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gq(t){const n={input:H(t,"input","imag")};return te.runKernel(Kw,n)}const E2=le({imag_:gq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vq(t){const n={x:H(t,"x","isFinite")};return te.runKernel(af,n)}const yq=le({isFinite_:vq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xq(t){const n={x:H(t,"x","isInf")};return te.runKernel(lf,n)}const bq=le({isInf_:xq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wq(t){const n={x:H(t,"x","isNaN")};return te.runKernel(uf,n)}const Cq=le({isNaN_:wq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sq(t,e=.2){const r={x:H(t,"x","leakyRelu")},s={alpha:e};return te.runKernel(R0,r,s)}const I2=le({leakyRelu_:Sq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kq(t,e){let n=H(t,"a","less","string_or_numeric"),r=H(e,"b","less","string_or_numeric");[n,r]=wn(n,r),ut(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(O0,s)}const Ym=le({less_:kq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eq(t,e){let n=H(t,"a","lessEqual","string_or_numeric"),r=H(e,"b","lessEqual","string_or_numeric");[n,r]=wn(n,r),ut(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(F0,s)}const Sc=le({lessEqual_:Eq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iq(t,e=5,n=1,r=1,s=.5){const i=H(t,"x","localResponseNormalization");F(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),F(Qu(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=ae(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},u={depthRadius:e,bias:n,alpha:r,beta:s},c=te.runKernel(B0,l,u);return a?ae(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const Tq=le({localResponseNormalization_:Iq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _q(t){const n={x:H(t,"x","log","float32")};return te.runKernel(cf,n)}const Ji=le({log_:_q});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nq(t){const n={x:H(t,"x","log1p")};return te.runKernel(hf,n)}const eR=le({log1p_:Nq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $q(t,e){F(mx(t),()=>"The f passed in variableGrads(f) must be a function"),F(e==null||Array.isArray(e)&&e.every(u=>u instanceof qm),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in te.registeredVariables)e.push(te.registeredVariables[u])}const r=n?e.filter(u=>!u.trainable):null,s=e.length;e=e.filter(u=>u.trainable),F(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const i=!0,{value:o,grads:a}=te.gradients(t,e,null,i);F(a.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),F(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((u,c)=>{a[c]!=null&&(l[u.name]=a[c])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:o,grads:l}}function rc(t){return te.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dq(t){const n={x:H(t,"x","neg")};return te.runKernel(H0,n)}const bn=le({neg_:Dq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aq(t){const n={x:H(t,"x","softplus")};return te.runKernel(Tf,n)}const Lf=le({softplus_:Aq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rq(t){const e=H(t,"x","logSigmoid");return rc(r=>({value:bn(Lf(bn(r))),gradFunc:o=>ee(o,Cc(bn(r)))}))(e)}const Oq=le({logSigmoid_:Rq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fq(t,e){let n=H(t,"a","sub"),r=H(e,"b","sub");[n,r]=wn(n,r);const s={a:n,b:r};return te.runKernel($f,s)}const st=le({sub_:Fq});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lq(t,e=-1){const n=H(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return rc((s,i)=>{const a=yi(s,e,!0),l=st(s,a),u=st(Ve(l,"float32"),Ji(et(So(l),e,!0)));return i([u]),{value:u,gradFunc:(h,d)=>{const[f]=d,m=!0,v=So(f);return st(h,ee(et(h,e,m),v))}}})(n)}const tR=le({logSoftmax_:Lq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pq(t,e=null,n=!1){const r=H(t,"x","logSumExp"),s=mt(e,r.shape),i=yi(r,s,!0),o=st(r,i),a=So(o),l=et(a,s),u=Ji(l),c=Ae(ae(i,u.shape),u);if(n){const h=Fn(c.shape,s);return ae(c,h)}return c}const Mq=le({logSumExp_:Pq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bq(t,e){const n=H(t,"a","logicalAnd","bool"),r=H(e,"b","logicalAnd","bool");ut(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(L0,s)}const ko=le({logicalAnd_:Bq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zq(t){const n={x:H(t,"x","logicalNot","bool")};return te.runKernel(P0,n)}const T2=le({logicalNot_:zq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uq(t,e){const n=H(t,"a","logicalOr","bool"),r=H(e,"b","logicalOr","bool");ut(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(M0,s)}const nR=le({logicalOr_:Uq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vq(t,e){const n=H(t,"a","logicalXor","bool"),r=H(e,"b","logicalXor","bool");return ut(n.shape,r.shape),ko(nR(t,e),T2(ko(t,e)))}const Wq=le({logicalXor_:Vq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gq(t,e,n,r,s){const i=H(t,"x","maxPool"),o=1;let a=i,l=!1;i.rank===3&&(l=!0,a=ae(i,[1,i.shape[0],i.shape[1],i.shape[2]])),F(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),F(yr(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),Hr("maxPool",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s},h=te.runKernel(U0,u,c);return l?ae(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const _2=le({maxPool_:Gq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jq(t,e=[1,1,1],n,r,s,i="NDHWC"){const o=H(t,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=ae(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),F(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),F(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),Hr("maxPool3d",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:i},h=te.runKernel(V0,u,c);return l?ae(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Hq=le({maxPool3d_:jq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qq(t,e){let n=H(t,"a","maximum"),r=H(e,"b","maximum");[n,r]=wn(n,r),n.dtype==="bool"&&(n=Ve(n,"int32"),r=Ve(r,"int32")),ut(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(df,s)}const Da=le({maximum_:qq});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kq(t,e=null,n=!1){const s={x:H(t,"x","mean")},i={axis:e,keepDims:n};return te.runKernel(W0,s,i)}const On=le({mean_:Kq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qn(t,e="float32"){if($o(t),e==="complex64"){const r=Qn(t,"float32"),s=Qn(t,"float32");return yl(r,s)}const n=vr(be(t),e);return te.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ul(t,e="float32"){if($o(t),e==="complex64"){const r=Ul(t,"float32"),s=Qn(t,"float32");return yl(r,s)}const n=Cw(be(t),e);return te.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xq(t,e){let n=H(t,"a","minimum"),r=H(e,"b","minimum");[n,r]=wn(n,r),n.dtype==="bool"&&(n=Ve(n,"int32"),r=Ve(r,"int32")),ut(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(ff,s)}const od=le({minimum_:Xq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yq(t,e,n){F(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=H(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");F(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)F(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),F(e[a][0]>=0&&e[a][0]<=r.shape[a]-s&&e[a][1]>=0&&e[a][1]<=r.shape[a]-s,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-s} or less than 0 for input of shape ${r.shape}`);const i={paddings:e,mode:n},o={x:r};return te.runKernel(j0,o,i)}const Zq=le({mirrorPad_:Yq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qq(t,e){let n=H(t,"a","mod"),r=H(e,"b","mod");[n,r]=wn(n,r);const s={a:n,b:r};return te.runKernel(pf,s)}const Jq=le({mod_:Qq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e9(t,e=null,n=!1){t=H(t,"x","moments");const r=mt(e,t.shape),s=On(t,r,n);let i=s.shape;n||(i=Fn(s.shape,r));const o=en(st(Ve(t,"float32"),ae(s,i))),a=On(o,r,n);return{mean:s,variance:a}}const N2=le({moments_:e9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t9(t,e){let n=H(t,"a","notEqual","string_or_numeric"),r=H(e,"b","notEqual","string_or_numeric");[n,r]=wn(n,r),ut(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(q0,s)}const Zm=le({notEqual_:t9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n9(t,e,n=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:H(t,"indices","oneHot","int32")},a={dtype:s,depth:e,onValue:n,offValue:r};return te.runKernel(X0,o,a)}const rR=le({oneHot_:n9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r9(t){const n={x:H(t,"x","onesLike")};return te.runKernel(K0,n)}const Zs=le({onesLike_:r9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s9(t,e,n=0){const r=H(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},i={x:r};return te.runKernel(Z0,i,s)}const $2=le({pad_:s9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i9(t,e,n){const r=H(t,"x","spaceToBatchND");F(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),F(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),F(r.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},i={blockShape:e,paddings:n};return te.runKernel(av,s,i)}const D2=le({spaceToBatchND_:i9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o9(t,e,n,r,s,i,o){s==null&&(s=[1,1]),i==null&&(i=1),r===0&&(r="valid");const a=H(t,"x","maxPool");let l=a,u=!1;a.rank===3&&(u=!0,l=ae(a,[1,a.shape[0],a.shape[1],a.shape[2]])),F(yr(i,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${s}'`);const c=Qs(l.shape,e,i,s,r),h=[c.dilationHeight,c.dilationWidth];let d;r==="same"?d=l9([c.filterHeight,c.filterWidth],h):d=[[0,0],[0,0]];const f=h[0]===1&&h[1]===1,[m,v]=a9([c.inHeight,c.inWidth],h,d),p=f?r:"valid",g=f?l:D2(l,h,m),b=(n==="avg"?()=>v2(g,e,i,p,o):()=>_2(g,e,i,p,o))(),x=f?b:x2(b,h,v);return u?ae(x,[x.shape[1],x.shape[2],x.shape[3]]):x}function a9(t,e,n){const r=n.map(c=>c[0]),s=n.map(c=>c[1]),i=t.concat(r,s),o=e.map((c,h)=>(c-i[h]%c)%c),a=s.map((c,h)=>c+o[h]),l=e.map((c,h)=>[r[h],a[h]]),u=e.map((c,h)=>[0,o[h]]);return[l,u]}function l9(t,e){const r=t.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),s=r.map(o=>Math.floor(o/2)),i=r.map((o,a)=>o-s[a]);return r.map((o,a)=>[s[a],i[a]])}const u9=le({pool_:o9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c9(t,e){const n=H(t,"x","prelu"),r=H(e,"alpha","prelu"),s={x:n,alpha:r};return te.runKernel(Q0,s)}const A2=le({prelu_:c9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h9(t,e=null,n=!1){let r=H(t,"x","prod");r.dtype==="bool"&&(r=Ve(r,"int32"));const s={x:r},i={axis:e,keepDims:n};return te.runKernel(J0,s,i)}const d9=le({prod_:h9});var R2={exports:{}};R2.exports;(function(t){(function(e,n,r){function s(l){var u=this,c=a();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function i(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function o(l,u){var c=new s(l),h=u&&u.state,d=c.next;return d.int32=function(){return c.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&i(h,c),d.state=function(){return i(c,{})}),d}function a(){var l=4022871197,u=function(c){c=String(c);for(var h=0;h<c.length;h++){l+=c.charCodeAt(h);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.alea=o})(yn,t,!1)})(R2);var f9=R2.exports,O2={exports:{}};O2.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var u=new s(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(d+f)/(1<<21);while(m===0);return m},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&i(c,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor128=o})(yn,t,!1)})(O2);var p9=O2.exports,F2={exports:{}};F2.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var u=new s(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(d+f)/(1<<21);while(m===0);return m},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&i(c,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorwow=o})(yn,t,!1)})(F2);var m9=F2.exports,L2={exports:{}};L2.exports;(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var c=l.x,h=l.i,d,f;return d=c[h],d^=d>>>7,f=d^d<<24,d=c[h+1&7],f^=d^d>>>10,d=c[h+3&7],f^=d^d>>>3,d=c[h+4&7],f^=d^d<<7,d=c[h+7&7],d=d^d<<13,f^=d^d<<9,c[h]=f,l.i=h+1&7,f};function u(c,h){var d,f=[];if(h===(h|0))f[0]=h;else for(h=""+h,d=0;d<h.length;++d)f[d&7]=f[d&7]<<15^h.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],c.x=f,c.i=0,d=256;d>0;--d)c.next()}u(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(d+f)/(1<<21);while(m===0);return m},h.int32=u.next,h.quick=h,c&&(c.x&&i(c,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorshift7=o})(yn,t,!1)})(L2);var g9=L2.exports,P2={exports:{}};P2.exports;(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var c=l.w,h=l.X,d=l.i,f,m;return l.w=c=c+1640531527|0,m=h[d+34&127],f=h[d=d+1&127],m^=m<<13,f^=f<<17,m^=m>>>15,f^=f>>>12,m=h[d]=m^f,l.i=d,m+(c^c>>>16)|0};function u(c,h){var d,f,m,v,p,g=[],y=128;for(h===(h|0)?(f=h,h=null):(h=h+"\0",f=0,y=Math.max(y,h.length)),m=0,v=-32;v<y;++v)h&&(f^=h.charCodeAt((v+32)%h.length)),v===0&&(p=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,v>=0&&(p=p+1640531527|0,d=g[v&127]^=f+p,m=d==0?m+1:0);for(m>=128&&(g[(h&&h.length||0)&127]=-1),m=127,v=4*128;v>0;--v)f=g[m+34&127],d=g[m=m+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,g[m]=f^d;c.w=p,c.X=g,c.i=m}u(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(d+f)/(1<<21);while(m===0);return m},h.int32=u.next,h.quick=h,c&&(c.X&&i(c,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor4096=o})(yn,t,!1)})(P2);var v9=P2.exports,M2={exports:{}};M2.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.next=function(){var h=l.b,d=l.c,f=l.d,m=l.a;return h=h<<25^h>>>7^d,d=d-f|0,f=f<<24^f>>>8^m,m=m-h|0,l.b=h=h<<20^h>>>12^d,l.c=d=d-f|0,l.d=f<<16^d>>>16^m,l.a=m-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var u=new s(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(d+f)/(1<<21);while(m===0);return m},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&i(c,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.tychei=o})(yn,t,!1)})(M2);var y9=M2.exports,sR={exports:{}};const x9={},b9=Object.freeze(Object.defineProperty({__proto__:null,default:x9},Symbol.toStringTag,{value:"Module"})),w9=OT(b9);(function(t){(function(e,n,r){var s=256,i=6,o=52,a="random",l=r.pow(s,i),u=r.pow(2,o),c=u*2,h=s-1,d;function f(x,w,C){var S=[];w=w==!0?{entropy:!0}:w||{};var E=g(p(w.entropy?[x,b(n)]:x??y(),3),S),T=new m(S),_=function(){for(var A=T.g(i),L=l,W=0;A<u;)A=(A+W)*s,L*=s,W=T.g(1);for(;A>=c;)A/=2,L/=2,W>>>=1;return(A+W)/L};return _.int32=function(){return T.g(4)|0},_.quick=function(){return T.g(4)/4294967296},_.double=_,g(b(T.S),n),(w.pass||C||function(A,L,W,K){return K&&(K.S&&v(K,T),A.state=function(){return v(T,{})}),W?(r[a]=A,L):A})(_,E,"global"in w?w.global:this==r,w.state)}function m(x){var w,C=x.length,S=this,E=0,T=S.i=S.j=0,_=S.S=[];for(C||(x=[C++]);E<s;)_[E]=E++;for(E=0;E<s;E++)_[E]=_[T=h&T+x[E%C]+(w=_[E])],_[T]=w;(S.g=function(A){for(var L,W=0,K=S.i,R=S.j,M=S.S;A--;)L=M[K=h&K+1],W=W*s+M[h&(M[K]=M[R=h&R+L])+(M[R]=L)];return S.i=K,S.j=R,W})(s)}function v(x,w){return w.i=x.i,w.j=x.j,w.S=x.S.slice(),w}function p(x,w){var C=[],S=typeof x,E;if(w&&S=="object")for(E in x)try{C.push(p(x[E],w-1))}catch{}return C.length?C:S=="string"?x:x+"\0"}function g(x,w){for(var C=x+"",S,E=0;E<C.length;)w[h&E]=h&(S^=w[h&E]*19)+C.charCodeAt(E++);return b(w)}function y(){try{var x;return d&&(x=d.randomBytes)?x=x(s):(x=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(x)),b(x)}catch{var w=e.navigator,C=w&&w.plugins;return[+new Date,e,C,e.screen,b(n)]}}function b(x){return String.fromCharCode.apply(0,x)}if(g(r.random(),n),t.exports){t.exports=f;try{d=w9}catch{}}else r["seed"+a]=f})(typeof self<"u"?self:yn,[],Math)})(sR);var C9=sR.exports,S9=f9,k9=p9,E9=m9,I9=g9,T9=v9,_9=y9,Vl=C9;Vl.alea=S9;Vl.xor128=k9;Vl.xorwow=E9;Vl.xorshift7=I9;Vl.xor4096=T9;Vl.tychei=_9;var B2=Vl;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iR{constructor(e,n,r,s,i){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=B2.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,n,r=!1;for(;!r;){let s,i,o;do s=2*this.random()-1,i=2*this.random()-1,o=s*s+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*s*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class N9{constructor(e=0,n=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=B2.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $9(t,e=0,n=1,r,s){if($o(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const i=new iR(e,n,r,!1,s),o=pt(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const D9=le({randomNormal_:$9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A9(t,e=0,n=1,r="float32",s){$o(t);const i=pt(t,r),o=new N9(e,n,null,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Pf=le({randomUniform_:A9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ad(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const s={start:t,stop:e,step:n,dtype:r};return te.runKernel(t2,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R9(t){const n={input:H(t,"input","real")};return te.runKernel(n2,n)}const Qm=le({real_:R9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O9(t){const n={x:H(t,"x","reciprocal")};return te.runKernel(vf,n)}const F9=le({reciprocal_:O9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L9(t){const n={x:H(t,"x","relu")};return te.runKernel(yf,n)}const Wl=le({relu_:L9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P9(t){const n={x:H(t,"x","relu6")};return te.runKernel(xf,n)}const oR=le({relu6_:P9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M9(t,e){const r={x:H(t,"x","reverse")},s={dims:e};return te.runKernel(rv,r,s)}const kl=le({reverse_:M9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B9(t){const n={x:H(t,"x","round")};return te.runKernel(bf,n)}const aR=le({round_:B9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z9(t){const n={x:H(t,"x","rsqrt","float32")};return te.runKernel(wf,n)}const lR=le({rsqrt_:z9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U9(t){const n={x:H(t,"x","selu")};return te.runKernel(Cf,n)}const uR=le({selu_:U9});function V9(t,e,n,r,s,i=[1,1],o="NHWC"){const a=H(t,"x","separableConv2d"),l=H(e,"depthwiseFilter","separableConv2d"),u=H(n,"pointwiseFilter","separableConv2d");let c=a,h=!1;if(a.rank===3&&(h=!0,c=ae(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");F(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),F(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),F(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),F(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),F(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const d=l.shape[2],f=l.shape[3];F(u.shape[2]===d*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*f}, but got ${u.shape[2]}.`);const m=C2(c,l,r,s,o,i),p=Sl(m,u,1,"valid",o);return h?ae(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const cR=le({separableConv2d_:V9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W9(t){const n={x:H(t,"x","sign")};return te.runKernel(Ef,n)}const G9=le({sign_:W9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j9(t){const n={x:H(t,"x","sin","float32")};return te.runKernel(Sf,n)}const hR=le({sin_:j9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H9(t){const n={x:H(t,"x","sinh")};return te.runKernel(kf,n)}const dR=le({sinh_:H9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q9(t,e,n){const r=H(t,"x","slice1d");return F(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Kt(r,[e],[n])}const z2=le({slice1d_:q9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K9(t,e,n){const r=H(t,"x","slice2d");return F(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Kt(r,e,n)}const fR=le({slice2d_:K9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X9(t,e,n){const r=H(t,"x","slice3d");return F(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Kt(r,e,n)}const U2=le({slice3d_:X9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y9(t,e,n){const r=H(t,"x","slice4d");return F(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Kt(r,e,n)}const Jm=le({slice4d_:Y9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z9(t,e=-1){const n=H(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},s={dim:e};return te.runKernel(uv,r,s)}const V2=le({softmax_:Z9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q9(t){F(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return te.runKernel(Gw,e)}const pR=le({fft_:Q9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J9(t){F(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return te.runKernel(qw,e)}const Rx=le({ifft_:J9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e7(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const s=ae(t,[n,e]);r=Rx(s)}else{const s=[n,2*(e-1)],i=ae(Qm(t),[n,e]),o=ae(E2(t),[n,e]),a=kl(Kt(i,[0,1],[n,e-2]),1),l=ee(kl(Kt(o,[0,1],[n,e-2]),1),At(-1)),u=zr([i,a],1),c=zr([o,l],1),h=ae(yl(u,c),[s[0],s[1]]);r=Rx(h)}if(r=Qm(r),t.rank===3&&t.shape[0]!==0){const s=r,i=t.shape[0];r=ae(r,[i,r.shape[0]/i,r.shape[1]]),s.dispose()}return r}const t7=le({irfft_:e7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n7(t,e,n=0){const s={x:H(t,"x","split")},i={numOrSizeSplits:e,axis:n};return te.runKernel(lv,s,i)}const bs=le({split_:n7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r7(t,e){F(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let s;if(e!=null&&e<n){const m=t.shape.map(p=>0),v=t.shape.map(p=>p);v[t.shape.length-1]=e,s=Kt(t,m,v),n=e}else if(e!=null&&e>n){const m=t.shape.map(v=>v);m[t.shape.length-1]=e-n,s=zr([t,Qn(m)],t.shape.length-1),n=e}else s=t;const i=Ct(s),o=ae(yl(s,i),[r,n]),a=pR(o),l=Math.floor(n/2)+1,u=Qm(a),c=E2(a),h=bs(u,[l,n-l],u.shape.length-1),d=bs(c,[l,n-l],c.shape.length-1),f=s.shape.slice();return f[s.shape.length-1]=l,ae(yl(h[0],d[0]),f)}const s7=le({rfft_:r7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i7(t,e){let n=H(t,"a","squaredDifference"),r=H(e,"b","squaredDifference");[n,r]=wn(n,r),ut(n.shape,r.shape);const s={a:n,b:r},i={};return te.runKernel(Nf,s,i)}const o7=le({squaredDifference_:i7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a7(t,e){const n=H(t,"x","squeeze","string_or_numeric");return ae(n,Ia(n.shape,e).newShape)}const Mf=le({squeeze_:a7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l7(t,e=0){const n=LA(t,"tensors","stack","string_or_numeric");F(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&F(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,s={axis:e};return te.runKernel(Y0,r,s)}const ga=le({stack_:l7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u7(t,e=0){const r={x:H(t,"x","step")},s={alpha:e};return te.runKernel(Of,r,s)}const Bf=le({step_:u7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c7(t,e,n,r,s=0,i=0,o=0,a=0,l=0){const c={x:H(t,"x","stridedSlice","string_or_numeric")},h={begin:e,end:n,strides:r,beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return te.runKernel(a2,c,h)}const h7=le({stridedSlice_:c7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d7(t){const n={x:H(t,"x","tan","float32")};return te.runKernel(Df,n)}const f7=le({tan_:d7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function es(t,e){VD(t);const n=pv(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return mv(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function om(t,e,n){if(VD(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=pv(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return mv(t,e,r,n)}function mR(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${s}.`;if(n.rank<s)throw new Error(i+` update.rank < ${s}. `);if(t.length<r+(n.rank-s))throw new Error(i+` Output shape length < ${r+(n.rank-s)}`);if(n.rank!==s+t.length-r)throw new Error(i+` update.rank != ${s+t.length-r}`);for(let o=0;o<s;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-s;++o)if(n.shape[o+s]!==t[o+r])throw new Error(i+` updates.shape[${o+s}] (${n.shape[o+s]}) != shape[${o+s}] (${t[o+s]})`)}function p7(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}mR(n,e,t)}function Gl(t,e,n){const r=e.shape.length,s=r>1?e.shape[r-1]:1,i=n.length;let o=1;for(let h=s;h<i;++h)o*=n[h];const a=s<1?1:s,l=be(e.shape)/a,u=[...Qe(n.slice(0,s)),1],c=be(n);return{sliceRank:s,numUpdates:l,sliceSize:o,strides:u,outputSize:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m7(t,e=1,n=!0){const r=H(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const i={x:r},o={k:e,sorted:n},[a,l]=te.runKernel(l2,i,o);return{values:a,indices:l}}const g7=le({topk_:m7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v7(t,e=0,n=1,r,s){if($o(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new iR(e,n,r,!0,s),o=pt(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const gR=le({truncatedNormal_:v7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y7(t,e=0){const n=H(t,"x","unique","string_or_numeric");F(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},s={axis:e},[i,o]=te.runKernel(c2,r,s);return{values:i,indices:o}}const x7=le({unique_:y7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b7(t,e,n){const r=H(t,"x","unsortedSegmentSum"),s=H(e,"segmentIds","unsortedSegmentSum","int32");F(Qu(n),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:s},o={numSegments:n};return te.runKernel(hv,i,o)}const vR=le({unsortedSegmentSum_:b7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w7(t,e=0){const n=H(t,"x","unstack","string_or_numeric");F(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},s={axis:e};return te.runKernel(cv,r,s)}const El=le({unstack_:w7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C7(t,e=!0,n,r){return te.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yR(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const r=pt(t,"int32"),s=pt([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=r.indexToLoc(n[i]),a=i*t.length;s.values.set(o,a)}return s.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S7(t,e,n){const r=H(t,"x","transpose");if(e==null&&(e=r.shape.map((o,a)=>a).reverse()),F(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(o=>{F(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},i={perm:e};return r.dtype==="complex64"?pe(()=>{let o=Qm(r),a=E2(r);return o=te.runKernel(Mu,{x:o},i),a=te.runKernel(Mu,{x:a},i),n&&(a=bn(a)),yl(o,a)}):te.runKernel(Mu,s,i)}const wt=le({transpose_:S7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k7(t,e){if(e==null)return t.shape.slice();if(Nt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E7(t,e,n,r){const s=H(t,"x","dropout");if(F(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),F(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof Rn?s.clone():s;const i=k7(s,n),o=1-e,a=nt(bv(Ae(Pf(i,0,1,"float32",r),o)),o);return ee(s,a)}const I7=le({dropout_:E7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T7(t,e,n,r,s,i="NHWC",o){let a=t;t.rank===3&&(a=ae(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=ae(e,[1,e.shape[0],e.shape[1],e.shape[2]])),F(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),F(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),F(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=i==="NHWC"?a.shape[3]:a.shape[1],c=i==="NHWC"?l.shape[3]:l.shape[1];F(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),F(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),Hr("conv2dDerFilter",s,o);const h={x:a,dy:l},d={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,filterShape:n};return te.runKernel(Rw,h,d)}const W2=le({conv2DBackpropFilter_:T7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G2(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return ee(t,Bf(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function j2(t,e){let n=e;const r=Hn(t.shape,e.shape);return r.length>0&&(n=et(n,r)),ae(n,t.shape)}function H2(t,e,n,r){if(e==="linear")return t;if(e==="relu")return Wl(t);if(e==="elu")return yv(t);if(e==="relu6")return oR(t);if(e==="prelu")return A2(t,n);if(e==="leakyrelu")return I2(t,r);if(e==="sigmoid")return Cc(t);throw new Error(`Unknown fused activation ${e}.`)}const q2=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _7({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",q2(te.state.gradientDepth,l)===!1){F(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let C=Sl(t,e,n,r,s,i,o);return a!=null&&(C=Ae(C,a)),H2(C,l,u,c)}const h=H(t,"x","conv2d","float32"),d=H(e,"filter","conv2d","float32");let f=h,m=!1;h.rank===3&&(m=!0,f=ae(h,[1,h.shape[0],h.shape[1],h.shape[2]])),F(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),F(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),Hr("fused conv2d",r,o);const v=s==="NHWC"?f.shape[3]:f.shape[1];F(d.shape[2]===v,()=>`Error in conv2d: depth of input (${v}) must match input depth for filter ${d.shape[2]}.`),F(yr(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const p=ur(f.shape,d.shape,n,i,r,o);let g;a!=null&&(g=H(a,"bias","fused conv2d"),[g]=wn(g,h),s==="NHWC"?ut(p.outShape,g.shape):(F(g.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`),F(g.shape.length===0||g.shape[0]===p.outChannels||g.shape[0]===1,()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${p.outChannels})`)));let y;if(u!=null){const C=u.shape;if(F(C.length<=1||C.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${C.length}.`),C.length===1)F(C[0]===1||C[0]===p.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the number of output channels (${p.outChannels}).`);else if(C.length===3)try{ut(C,p.outShape)}catch{const E=`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the output shape of the conv2d (${p.outShape}).`;throw Error(E)}y=H(u,"prelu weights","fused conv2d")}const b=(C,S)=>{F(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[E,T,_,A]=S,L=G2(C,_,l);F(wl(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const W=b2(T.shape,L,E,n,r),K=W2(T,L,E.shape,n,r),R=[W,K];if(A!=null){const M=j2(A,L);R.push(M)}return R},x={x:f,filter:d,bias:g,preluActivationWeights:y},w={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:c};return a==null?rc((S,E,T)=>{let _=te.runKernel(Gm,x,w);return T([E,S,_]),m&&(_=ae(_,[_.shape[1],_.shape[2],_.shape[3]])),{value:_,gradFunc:b}})(f,d):rc((S,E,T,_)=>{let A=te.runKernel(Gm,x,w);return _([E,S,A,T]),m&&(A=ae(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:b}})(f,d,g)}const N7=le({fusedConv2d_:_7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $7(t,e,n,r,s,i=[1,1],o){let a=t;t.rank===3&&(a=ae(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=ae(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},c={strides:r,pad:s,dimRoundingMode:o,dilations:i,filterShape:n};return te.runKernel(zw,u,c)}const D7=le({depthwiseConv2dNativeBackpropFilter_:$7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A7(t,e,n,r,s,i=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=ae(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:n},c={strides:r,pad:s,dimRoundingMode:o,dilations:i,inputShape:t},h=te.runKernel(Uw,u,c);return l?ae(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const R7=le({depthwiseConv2dNativeBackpropInput_:A7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O7({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:s,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(q2(te.state.gradientDepth,i)===!1){let A=_t(t,e,n,r);return s!=null&&(A=Ae(A,s)),H2(A,i,o,a)}let l=H(t,"a","fused matMul"),u=H(e,"b","fused matMul");[l,u]=wn(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],h=r?u.shape[u.rank-1]:u.shape[u.rank-2],d=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?u.shape[u.rank-2]:u.shape[u.rank-1],m=l.shape.slice(0,-2),v=u.shape.slice(0,-2),p=be(m),g=be(v);F(c===h,()=>`Error in fused matMul: inner shapes (${c}) and (${h}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);const b=ut(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([d,f]),x=n?ae(l,[p,c,d]):ae(l,[p,d,c]),w=r?ae(u,[g,f,h]):ae(u,[g,h,f]);let C;s!=null&&(C=H(s,"bias","fused matMul"),[C]=wn(C,l),ut(b,C.shape));let S;o!=null&&(S=H(o,"prelu weights","fused matMul"));const E=(A,L)=>{const[W,K,R,M]=L,U=G2(ae(A,R.shape),R,i);let D,B;if(!n&&!r?(D=_t(U,K,!1,!0),B=_t(W,U,!0,!1)):!n&&r?(D=_t(U,K,!1,!1),B=_t(U,W,!0,!1)):n&&!r?(D=_t(K,U,!1,!0),B=_t(W,U,!1,!1)):(D=_t(K,U,!0,!0),B=_t(U,W,!0,!0)),s!=null){const X=j2(M,U);return[D,B,X]}else return[D,B]},T={a:x,b:w,bias:C,preluActivationWeights:S},_={transposeA:n,transposeB:r,activation:i,leakyreluAlpha:a};return s==null?rc((L,W,K)=>{const R=te.runKernel(Wm,T,_);return K([L,W,R]),{value:ae(R,b),gradFunc:E}})(x,w):rc((L,W,K,R)=>{const M=te.runKernel(Wm,T,_);return R([L,W,M,K]),{value:ae(M,b),gradFunc:E}})(x,w,C)}const dI=le({fusedMatMul_:O7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F7(t,e,n,r,s="bilinear",i=0){const o=H(t,"image","cropAndResize"),a=H(e,"boxes","cropAndResize","float32"),l=H(n,"boxInd","cropAndResize","int32"),u=a.shape[0];F(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),F(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`),F(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`),F(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),F(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),F(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const c={image:o,boxes:a,boxInd:l},h={method:s,extrapolationValue:i,cropSize:r};return te.runKernel(Pw,c,h)}const L7=le({cropAndResize_:F7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P7(t){const e=H(t,"image","flipLeftRight","float32");F(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return te.runKernel(Hw,n,{})}const M7=le({flipLeftRight_:P7});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B7(t){const e=H(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];F(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),F(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,n),s[n]=3,fi(e,s)}const z7=le({grayscaleToRGB_:B7});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U7(t){const e=H(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];F(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),F(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const s=e.dtype,i=Ve(e,"float32"),o=es([.2989,.587,.114]);let a;switch(e.rank){case 2:a=sh("ij,j->i",i,o);break;case 3:a=sh("ijk,k->ij",i,o);break;case 4:a=sh("ijkl,l->ijk",i,o);break;case 5:a=sh("ijklm,m->ijkl",i,o);break;case 6:a=sh("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=Pr(a,-1),Ve(a,s)}const V7=le({rgbToGrayscale_:U7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W7(t,e,n=0,r=.5){const s=H(t,"image","rotateWithOffset","float32");F(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const i={image:s},o={radians:e,fillValue:n,center:r};return te.runKernel(h2,i,o)}const G7=le({rotateWithOffset_:W7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kc(t,e,n,r,s,i){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),F(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),F(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),F(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),F(e.rank===1,()=>"scores must be a 1D tensor"),F(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),F(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j7(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const i=H(t,"boxes","nonMaxSuppression","float32"),o=H(e,"scores","nonMaxSuppression","float32"),a=kc(i,o,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:s};return te.runKernel(Qw,{boxes:i,scores:o},l)}const H7=le({nonMaxSuppression_:j7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q7(t,e,n){const r=K7(t,e,n),s=r<0?-(r+1):r;t.splice(s,0,e)}function K7(t,e,n){return Y7(t,e,n||X7)}function X7(t,e){return t>e?1:t<e?-1:0}function Y7(t,e,n){let r=0,s=t.length,i=0,o=!1;for(;r<s;){i=r+(s-r>>>1);const a=n(e,t[i]);a>0?r=i+1:(s=i,o=!a)}return o?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K2(t,e,n,r,s){return Z2(t,e,n,r,s,0)}function X2(t,e,n,r,s,i){return Z2(t,e,n,r,s,0,!1,i,!0)}function Y2(t,e,n,r,s,i){return Z2(t,e,n,r,s,i,!0)}function Z2(t,e,n,r,s,i,o=!1,a=!1,l=!1){const u=[];for(let p=0;p<e.length;p++)e[p]>s&&u.push({score:e[p],boxIndex:p,suppressBeginIndex:0});u.sort(fI);const c=i>0?-.5/i:0,h=[],d=[];for(;h.length<n&&u.length>0;){const p=u.pop(),{score:g,boxIndex:y,suppressBeginIndex:b}=p;if(g<s)break;let x=!1;for(let w=h.length-1;w>=b;--w){const C=Z7(t,y,h[w]);if(C>=r){x=!0;break}if(p.score=p.score*Q7(r,c,C),p.score<=s)break}p.suppressBeginIndex=h.length,x||(p.score===g?(h.push(y),d.push(p.score)):p.score>s&&q7(u,p,fI))}const f=h.length,m=n-f;a&&m>0&&(h.push(...new Array(m).fill(0)),d.push(...new Array(m).fill(0)));const v={selectedIndices:h};return o&&(v.selectedScores=d),l&&(v.validOutputs=f),v}function Z7(t,e,n){const r=t.subarray(e*4,e*4+4),s=t.subarray(n*4,n*4+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(s[0],s[2]),c=Math.min(s[1],s[3]),h=Math.max(s[0],s[2]),d=Math.max(s[1],s[3]),f=(a-i)*(l-o),m=(h-u)*(d-c);if(f<=0||m<=0)return 0;const v=Math.max(i,u),p=Math.max(o,c),g=Math.min(a,h),y=Math.min(l,d),b=Math.max(g-v,0)*Math.max(y-p,0);return b/(f+m-b)}function Q7(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function fI(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function J7(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const i=H(t,"boxes","nonMaxSuppressionAsync"),o=H(e,"scores","nonMaxSuppressionAsync"),a=kc(i,o,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),u=l[0],c=l[1],{selectedIndices:h}=K2(u,c,n,r,s);return i!==t&&i.dispose(),o!==e&&o.dispose(),es(h,"int32")}const eK=J7;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tK(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=H(t,"boxes","nonMaxSuppression"),a=H(e,"scores","nonMaxSuppression"),l=kc(o,a,n,r,s,i);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const u={boxes:o,scores:a},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:i},h=te.runKernel(e2,u,c);return{selectedIndices:h[0],selectedScores:h[1]}}const nK=le({nonMaxSuppressionWithScore_:tK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function rK(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=H(t,"boxes","nonMaxSuppressionAsync"),a=H(e,"scores","nonMaxSuppressionAsync"),l=kc(o,a,n,r,s,i);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const u=await Promise.all([o.data(),a.data()]),c=u[0],h=u[1],{selectedIndices:d,selectedScores:f}=Y2(c,h,n,r,s,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:es(d,"int32"),selectedScores:es(f)}}const sK=rK;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iK(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=H(t,"boxes","nonMaxSuppression"),a=H(e,"scores","nonMaxSuppression"),l=kc(o,a,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,h=l.scoreThreshold,d={boxes:o,scores:a},f={maxOutputSize:u,iouThreshold:c,scoreThreshold:h,padToMaxOutputSize:i},m=te.runKernel(Jw,d,f);return{selectedIndices:m[0],validOutputs:m[1]}}const oK=le({nonMaxSuppressionPadded_:iK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function aK(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=H(t,"boxes","nonMaxSuppressionAsync"),a=H(e,"scores","nonMaxSuppressionAsync"),l=kc(o,a,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,h=l.scoreThreshold,[d,f]=await Promise.all([o.data(),a.data()]),{selectedIndices:m,validOutputs:v}=X2(d,f,u,c,h,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:es(m,"int32"),validOutputs:At(v,"int32")}}const lK=aK;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uK(t,e,n=!1,r=!1){const s=H(t,"images","resizeBilinear");F(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),F(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),F(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=ae(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:r,size:e},u=te.runKernel(nv,a,l);return o?ae(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const xR=le({resizeBilinear_:uK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cK(t,e,n=!1,r=!1){const s=H(t,"images","resizeNearestNeighbor");F(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),F(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),F(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),F(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=ae(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:r,size:e},u=te.runKernel(tv,a,l);return o?ae(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const bR=le({resizeNearestNeighbor_:cK});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hK(t,e="binary",n=!1,r=.5){const s=H(t,"image","threshold"),i=.2989,o=.587,a=.114,l=s.shape[0]*s.shape[1];let u=ee(es([r]),255),c,h,d,f;if(F(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),F(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),F(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),F(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[c,h,d]=bs(s,[1,1,1],-1);const p=ee(c,i),g=ee(h,o),y=ee(d,a);f=Ae(Ae(p,g),y)}else f=t;if(e==="otsu"){const p=lH(Ve(aR(f),"int32"),$h([]),256);u=dK(p,l)}const m=n?Sc(f,u):Es(f,u);return Ve(ee(m,255),"int32")}function dK(t,e){let n=es([-1]),r=es([0]),s=es([0]),i,o,a,l,u,c;for(let h=0;h<t.size-1;h++){i=Kt(t,0,h+1),o=Kt(t,h+1),u=nt(et(i),e),c=nt(et(o),e);const d=et(ee(i,ad(0,i.size)));a=nt(d,et(i));const f=vv(o.shape,i.size),m=Ae(ad(0,o.size),f),v=ee(o,m);l=nt(et(v),et(o));const p=st(a,l),g=st(a,l),y=ee(u,c);s=ee(ee(y,p),g);const b=Es(s,r);r=Tr(b,s,r),n=Tr(b,es([h]),n)}return n}const fK=le({threshold_:hK});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pK(t,e,n="nearest",r="constant",s=0,i){const o=H(t,"image","transform","float32"),a=H(e,"transforms","transform","float32");F(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),F(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),F(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:a},u={interpolation:n,fillMode:r,fillValue:s,outputShape:i};return te.runKernel(u2,l,u)}const mK=le({transform_:pK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gK(t,e,n){const r=H(t,"a","bandPart");F(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[i,o]=r.shape.slice(-2);let a,l;typeof e=="number"?(F(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),F(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=H(e<0?i:e,"numLower","bandPart")):(F(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Tr(Ym(e,0),i,od(e,i))),typeof n=="number"?(F(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),F(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),l=H(n<0?o:n,"numUpper","bandPart")):(F(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Tr(Ym(n,0),o,od(n,o)));const u=ae(ad(0,i,1,"int32"),[-1,1]),c=ad(0,o,1,"int32"),h=st(u,c),d=ko(Sc(h,a),zl(h,bn(l))),f=Qn([i,o],r.dtype);return ae(ga(El(ae(r,[-1,i,o])).map(m=>Tr(d,m,f))),s)}const vK=le({bandPart_:gK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yK(t){let e;if(Array.isArray(t)){e=!1,F(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=t[0].shape[0];for(let i=1;i<t.length;++i)F(t[i].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${s})`)}else e=!0,t=bs(t,t.shape[0],0).map(s=>Mf(s,[0]));F(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let s=0;s<t.length;++s)n.push(te.tidy(()=>{let i=r[s];if(s>0)for(let o=0;o<s;++o){const a=ee(et(ee(n[o],i)),n[o]);i=st(i,a)}return nt(i,xv(i,"euclidean"))}));return e?ga(n,0):n}const xK=le({gramSchmidt_:yK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bK(t,e=!1){if(F(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return pI(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),r=El(ae(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),s=[],i=[];r.forEach(l=>{const[u,c]=pI(l,e);s.push(u),i.push(c)});const o=ae(ga(s,0),t.shape),a=ae(ga(i,0),t.shape);return[o,a]}}function pI(t,e=!1){return te.tidy(()=>{F(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let s=JA(n),i=sl(t);const o=om([[1]],[1,1]);let a=sl(o);const l=n>=r?r:n;for(let u=0;u<l;++u){const c=i,h=a,d=s;[a,i,s]=te.tidy(()=>{const f=Kt(i,[u,u],[n-u,1]),m=xv(f),v=Kt(i,[u,u],[1,1]),p=Tr(Es(v,0),om([[-1]]),om([[1]])),g=st(v,ee(p,m)),y=nt(f,g);y.shape[0]===1?a=sl(o):a=zr([o,Kt(y,[1,0],[y.shape[0]-1,y.shape[1]])],0);const b=bn(nt(_t(p,g),m)),x=Kt(i,[u,0],[n-u,r]),w=ee(b,a),C=wt(a);if(u===0)i=st(x,_t(w,_t(C,x)));else{const T=st(x,_t(w,_t(C,x)));i=zr([Kt(i,[0,0],[u,r]),T],0)}const S=wt(w),E=Kt(s,[0,u],[n,s.shape[1]-u]);if(u===0)s=st(E,_t(_t(E,a),S));else{const T=st(E,_t(_t(E,a),S));s=zr([Kt(s,[0,0],[n,u]),T],1)}return[a,i,s]}),ft([c,h,d])}return!e&&n>r&&(s=Kt(s,[0,0],[n,r]),i=Kt(i,[0,0],[r,r])),[s,i]})}const wK=le({qr_:bK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const po={flipLeftRight:M7,grayscaleToRGB:z7,resizeNearestNeighbor:bR,resizeBilinear:xR,rgbToGrayscale:V7,rotateWithOffset:G7,cropAndResize:L7,nonMaxSuppression:H7,nonMaxSuppressionAsync:eK,nonMaxSuppressionWithScore:nK,nonMaxSuppressionWithScoreAsync:sK,nonMaxSuppressionPadded:oK,nonMaxSuppressionPaddedAsync:lK,threshold:fK,transform:mK},CK={bandPart:vK,gramSchmidt:xK,qr:wK};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SK=new Map,kK=new Map;class Ec{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class zs{constructor(){this.classNameMap={}}static getMap(){return zs.instance==null&&(zs.instance=new zs),zs.instance}static register(e){zs.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Ie(t,e,n){F(t.className!=null,()=>"Class being registered does not have the static className property defined."),F(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),F(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const r=n,s=e+">"+r;return zs.register(t),SK.set(s,t),kK.set(t,s),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Aa extends Ec{minimize(e,n=!1,r){const{value:s,grads:i}=this.computeGradients(e,r);if(r!=null){const o=r.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return ft(i),n?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return $q(e,n)}dispose(){this.iterations_!=null&&ft(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:At(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Aa,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wR extends Aa{static get className(){return"Adadelta"}constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=te.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=te.registeredVariables[r],o=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:pe(()=>Ct(i).variable(o))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:pe(()=>Ct(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedGrads[s].variable,u=this.accumulatedUpdates[s].variable;pe(()=>{const c=Ae(ee(l,this.rho),ee(en(a),1-this.rho)),h=ee(nt(Nr(Ae(u,this.epsilon)),Nr(Ae(l,this.epsilon))),a),d=Ae(ee(u,this.rho),ee(en(h),1-this.rho));l.assign(c),u.assign(d);const f=Ae(ee(h,-this.learningRate),i);i.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(ft(this.accumulatedGrads.map(e=>e.variable)),ft(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CR extends Aa{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=te.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:pe(()=>vv(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const a=this.accumulatedGrads[s].variable;pe(()=>{const l=Ae(a,en(o));a.assign(l);const u=Ae(ee(nt(o,Nr(Ae(l,te.backend.epsilon()))),-this.learningRate),i);i.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&ft(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SR extends Aa{static get className(){return"Adam"}constructor(e,n,r,s=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],pe(()=>{this.accBeta1=At(n).variable(),this.accBeta2=At(r).variable()}),s==null&&(this.epsilon=te.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);pe(()=>{const r=st(1,this.accBeta1),s=st(1,this.accBeta2);n.forEach((i,o)=>{const a=te.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:pe(()=>Ct(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:pe(()=>Ct(a).variable(l))});const u=Array.isArray(e)?e[o].tensor:e[i];if(u==null)return;const c=this.accumulatedFirstMoment[o].variable,h=this.accumulatedSecondMoment[o].variable,d=Ae(ee(c,this.beta1),ee(u,1-this.beta1)),f=Ae(ee(h,this.beta2),ee(en(u),1-this.beta2)),m=nt(d,r),v=nt(f,s);c.assign(d),h.assign(f);const p=Ae(ee(nt(m,Ae(Nr(v),this.epsilon)),-this.learningRate),a);a.assign(p)}),this.accBeta1.assign(ee(this.accBeta1,this.beta1)),this.accBeta2.assign(ee(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&ft(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&ft(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),pe(()=>{this.accBeta1.assign(nc(this.beta1,this.iterations_+1)),this.accBeta2.assign(nc(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kR extends Aa{static get className(){return"Adamax"}constructor(e,n,r,s=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],pe(()=>{this.iteration=At(0).variable(),this.accBeta1=At(n).variable()}),s==null&&(this.epsilon=te.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);pe(()=>{const r=st(1,this.accBeta1),s=nt(-this.learningRate,Ae(ee(this.iteration,this.decay),1));n.forEach((i,o)=>{const a=te.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:Ct(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:Ct(a).variable(l)});const u=Array.isArray(e)?e[o].tensor:e[i];if(u==null)return;const c=this.accumulatedFirstMoment[o].variable,h=this.accumulatedWeightedInfNorm[o].variable,d=Ae(ee(c,this.beta1),ee(u,1-this.beta1)),f=ee(h,this.beta2),m=Sr(u),v=Da(f,m);c.assign(d),h.assign(v);const p=Ae(ee(nt(s,r),nt(d,Ae(v,this.epsilon))),a);a.assign(p)}),this.iteration.assign(Ae(this.iteration,1)),this.accBeta1.assign(ee(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&ft(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&ft(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q2 extends Aa{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const o=te.registeredVariables[r];pe(()=>{const a=Ae(ee(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=qi(At(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ER extends Q2{static get className(){return"Momentum"}constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=At(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=te.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:pe(()=>Ct(i).variable(!1))});const o=this.accumulations[s].variable,a=Array.isArray(e)?e[s].tensor:e[r];a!=null&&pe(()=>{let l;const u=Ae(ee(this.m,o),a);this.useNesterov?l=Ae(ee(this.c,Ae(a,ee(u,this.m))),i):l=Ae(ee(this.c,u),i),o.assign(u),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&ft(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IR extends Aa{static get className(){return"RMSProp"}constructor(e,n=.9,r=0,s=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,s==null&&(this.epsilon=te.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=te.registeredVariables[r],o=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:pe(()=>Ct(i).variable(o))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:pe(()=>Ct(i).variable(o))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:pe(()=>Ct(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedMeanSquares[s].variable,u=this.accumulatedMoments[s].variable;pe(()=>{const c=Ae(ee(l,this.decay),ee(en(a),1-this.decay));if(this.centered){const h=this.accumulatedMeanGrads[s].variable,d=Ae(ee(h,this.decay),ee(a,1-this.decay)),f=nt(ee(a,this.learningRate),Nr(st(c,Ae(en(d),this.epsilon)))),m=Ae(ee(u,this.momentum),f);l.assign(c),h.assign(d),u.assign(m);const v=st(i,m);i.assign(v)}else{const h=Ae(ee(l,this.decay),ee(en(a),1-this.decay)),d=Ae(ee(u,this.momentum),nt(ee(a,this.learningRate),Nr(Ae(h,this.epsilon))));l.assign(h),u.assign(d);const f=st(i,d);i.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&ft(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&ft(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&ft(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EK=[wR,CR,SR,kR,ER,IR,Q2];function IK(){for(const t of EK)Ie(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mI(t,e,n,r){o(t),n=n??0,r=r??1,a(n,r);let s=0;const i=l=>(l.then(u=>{const c=n+ ++s/t.length*(r-n);return e(c),u}),l);function o(l){F(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,u){F(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),F(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),F(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(t.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function TK(t,e){e==null&&(e={});const n=e.fetchFunc==null?me().platform.fetch:e.fetchFunc,r=t.map(h=>n(h,e.requestInit,{isBinary:!0})),s=0,i=.5,a=(e.onProgress==null?await Promise.all(r):await mI(r,e.onProgress,s,i)).map(h=>h.arrayBuffer()),l=.5,u=1;return e.onProgress==null?await Promise.all(a):await mI(a,e.onProgress,l,u)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _K="application/octet-stream",NK="application/json";class J2{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(F(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=me().platform.fetch,F(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&F(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=zG(e,r);if(n.body.append("model.json",new Blob([JSON.stringify(s)],{type:NK}),"model.json"),e.weightData!=null){const o=_a.join(e.weightData);n.body.append("model.weights.bin",new Blob([o],{type:_K}),"model.weights.bin")}const i=await this.fetch(this.path,n);if(i.ok)return{modelArtifactsInfo:m2(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const r=n.modelTopology,s=n.weightsManifest;if(r==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return VG(n,i=>this.loadWeights(i))}async loadWeights(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,s]=$K(n),i=this.weightPathPrefix||r,o=WG(e),a=[],l=[];for(const c of e)for(const h of c.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(h)):a.push(i+h+s);this.weightUrlConverter&&a.push(...await Promise.all(l));const u=await TK(a,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[o,u]}}J2.URL_SCHEME_REGEX=/^https?:\/\//;function $K(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),s=n>e?t.substring(n):"";return[r+"/",s]}function gI(t){return t.match(J2.URL_SCHEME_REGEX)!=null}const TR=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>gI(r)):n=gI(t),n)return _R(t,e)}return null};Xn.registerSaveRouter(TR);Xn.registerLoadRouter(TR);function _R(t,e){return new J2(t,e)}function DK(t,e){return _R(t,e)}function eC(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(be(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const s=e.shape,i=s[s.length-1];let o=1;for(let h=0;h<s.length-1;++h)o*=s[h];const a=t.shape,l=s.slice();l.pop();let u=1;for(let h=i;h<n;++h)u*=a[h],l.push(a[h]);const c=[...Qe(t.shape).map(h=>h/u),1].slice(0,i);return[l,o,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ox=-2,AK=-1;function tC(t,e,n){const r=t.shape.length;F(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),F(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)F(e[s]+n[s]<=t.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+n[s]}) would overflow input.shape[${s}] (${t.shape[s]})`)}function RK(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function nC(t,e,n){const r=[];for(let s=0;s<t.length;s++)r[s]=Math.ceil((e[s]-t[s])/n[s]);return r}function NR(t,e,n,r){const s=[...t];for(let i=s.length;i<r.length;i++)s.push(1);for(let i=0;i<n;i++)i===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function $R(t,e,n){return n<=t?n:n-(e-1)}function DR(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function OK(t,e,n,r,s,i,o,a,l){const u=t.length;let c=new Array(u),h=new Array(u),d=new Array(u);if(e.length&&n>0){const f=e[0],m=n+1;c=AR(o,f,m,r,t),h=RR(a,f,m,s,t),d=NR(i,f,m,t)}else for(let f=0;f<u;f++)c[f]=FR(o,r,i,t,f,l),h[f]=LR(a,s,i,t,f,l),d[f]=OR(i,f,l);return{begin:c,end:h,strides:d}}function AR(t,e,n,r,s){const i=[...s],o=DR(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const l=$R(e,n,a);let u=r[l];t&1<<l&&(u=0),i[a]=u}return i}function RR(t,e,n,r,s){const i=[...s],o=DR(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=$R(e,n,a);let u=r[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),i[a]=u}for(let a=0;a<i.length;a++){const l=s[a];i[a]<0&&(i[a]+=l),i[a]=gl(0,i[a],s[a])}return i}function OR(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function FR(t,e,n,r,s,i){let o=e[s];const a=n[s]||1;(t&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=r[s];return o<0&&(o+=l),o=gl(0,o,l-1),o}function LR(t,e,n,r,s,i){let o=e[s];const a=n[s]||1;(t&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=r[s];return o<0&&(o+=l),a>0?o=gl(0,o,l):o=gl(-1,o,l-1),o}function rC(t,e,n){let r=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(let s=r+1;s<n.length;s++)if(e[s]>0||n[s]!==t[s])return!1;return!0}function sC(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function wv(t,e,n){let r;const s=t.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(o=>{F(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(s).fill(-1):typeof n=="number"?i=[n,...new Array(s-1).fill(-1)]:n.length<s?i=n.concat(new Array(s-n.length).fill(-1)):i=n,i=i.map((o,a)=>o>=0?o:(F(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),t.shape[a]-r[a])),[r,i]}function iC(t,e,n,r,s,i,o,a,l){let u;if(r==null?(u=new Array(e.length),u.fill(1)):u=r,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const h={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let b=0;b<h.dims;b++)c&&1<<b&a&&h.numAddAxisAfterEllipsis++,1<<b&o&&(c=!0);c||(h.ellipsisMask|=1<<h.dims,h.dims++);const d={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};FK(h,d);let f=!0,m=!0,v=!0;const p=[],g=[];for(let b=0;b<t.length;++b){if(d.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const x=!!(d.shrinkAxisMask&1<<b),w=t[b];if(w===-1){p.push(x?1:-1);continue}const C=[d.beginMask&1<<b,d.endMask&1<<b],S=[d.strides[b]>0?0:-1,d.strides[b]>0?w:w-1];if(x&&d.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");v=v&&d.strides[b]===1;const E=!!(d.beginMask&1<<b&&d.endMask&1<<b);if(d.beginValid&&d.endValid){if(x){const L=d.begin[b]<0?w+d.begin[b]:d.begin[b];if(d.begin[b]=L,d.end[b]=d.begin[b]+1,L<0||L>=w)throw Error(`slice index ${d.begin[b]} of dimension ${b} out of bounds.`)}else d.begin[b]=vI(d.begin[b],0,d.strides[b],w,C,S),d.end[b]=vI(d.end[b],1,d.strides[b],w,C,S);const A=d.strides[b]===1&&d.begin[b]===0&&d.end[b]===w;f=f&&A,m=m&&(b===0&&d.strides[b]===1||A)}else f=f&&d.strides[b]===1&&E,m=m&&(b===0&&d.strides[b]===1||E);let T,_=!1;if(d.beginValid&&d.endValid?(T=d.end[b]-d.begin[b],_=!0):x?(T=1,_=!0):E&&w>=0&&(d.strides[b]<0?T=-w:T=w,_=!0),_){let A;T===0||T<0!=d.strides[b]<0?A=0:A=Math.trunc(T/d.strides[b])+(T%d.strides[b]!==0?1:0),p.push(A)}else p.push(-1)}for(let b=0;b<d.finalShapeGatherIndices.length;++b){const x=d.finalShapeGatherIndices[b];x>=0?g.push(p[x]):x===Ox&&g.push(1)}return{finalShapeSparse:g.filter((b,x)=>d.finalShapeGatherIndices[x]!==Ox),finalShape:g,isIdentity:f,sliceDim0:m,isSimpleSlice:v,begin:d.begin,end:d.end,strides:d.strides}}function FK(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const s=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<s;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(Ox),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(AK),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function vI(t,e,n,r,s,i){if(s[e])return n>0?i[e]:i[e+1&1];{const o=t<0?r+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const LK=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:tC,computeFlatOffset:sC,computeOutShape:nC,getNormalizedAxes:OK,isSliceContinous:rC,maskToAxes:RK,parseSliceParams:wv,sliceInfo:iC,startForAxis:FR,startIndicesWithElidedDims:AR,stopForAxis:LR,stopIndicesWithElidedDims:RR,stridesForAxis:OR,stridesWithElidedDims:NR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PK{static sgd(e){return new Q2(e)}static momentum(e,n,r=!1){return new ER(e,n,r)}static rmsprop(e,n=.9,r=0,s=null,i=!1){return new IR(e,n,r,s,i)}static adam(e=.001,n=.9,r=.999,s=null){return new SR(e,n,r,s)}static adadelta(e=.001,n=.95,r=null){return new wR(e,n,r)}static adamax(e=.002,n=.9,r=.999,s=null,i=0){return new kR(e,n,r,s,i)}static adagrad(e,n=.1){return new CR(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lu=PK;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MK=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t())();function PR(){return new Promise(t=>MK(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oC(t,e){const n=t[0].length;t.forEach((s,i)=>{F(s.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),F(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((s,i)=>{for(let o=0;o<n;o++)F(o===e||s[o]===r[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function Ki(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var di;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(di||(di={}));function MR(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let s=1;s<n.length;++s){const i=n[s],o=r[r.length-n.length+s],a=r[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+t}] = ${i} but shape[${s+t}] = ${a}`)}else r[o]=i}return r}function BR(t){const e={FIRST_DIM_SIZE:di.FIRST_DIM_SIZE,VALUE_ROWIDS:di.VALUE_ROWIDS,ROW_LENGTHS:di.ROW_LENGTHS,ROW_SPLITS:di.ROW_SPLITS,ROW_LIMITS:di.ROW_LIMITS,ROW_STARTS:di.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function zR(t){return t.length===0?0:t[0]===di.FIRST_DIM_SIZE?t.length-1:t.length}function UR(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(n,r-1);++s){const i=t[s],o=e[s+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-t.length}] = ${i} but ragged tensor input.flatValues.shape[${s-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aC=30;function Cv(t){return t<=aC?t:gx(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lC(t,e,n){const r=n*(typeof t=="number"?t:t[0]),s=e*(typeof t=="number"?t:t[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zf(t,e,n,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(t[0]/n),s=s.concat(t.slice(1));else{s=s.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)s=s.concat([t[o+1]/e[o],e[o]]);s=s.concat(t.slice(i+1))}return s}function Uf(t,e,n=!0){const r=[];if(n){r.push(e);for(let s=e+1;s<t;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):s.push(o);r.push(...s),r.push(0),r.push(...i)}return r}function Vf(t,e,n,r=!0){const s=[];r?s.push(t[0]/n):s.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?r?s.push(e[i-1]*t[i]):s.push(t[i]/e[i-1]):s.push(t[i]);return s}function uC(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function cC(t,e,n){const r=t.slice(0,1);for(let s=0;s<n;++s)r.push(t[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sv=1.7580993408473768,kv=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hC=.3275911,dC=.254829592,fC=-.284496736,pC=1.421413741,mC=-1.453152027,gC=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eo(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function VR(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function WR(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function GR(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function vC(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function jR(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function HR(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let s=0;s<Math.ceil(t/2);s++){const i=(e?2:-2)*Math.PI*(s/t);n[s]=Math.cos(i),r[s]=Math.sin(i)}return{real:n,imag:r}}function qR(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),s=Math.cos(r),i=Math.sin(r);return{real:s,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gy="->",BK=/->/g,yI=",",xI="...";function yC(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(BK,"").length)/Gy.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${Gy}").`);const[r,s]=t.split(Gy);F(r.indexOf(xI)===-1,()=>`The ellipsis notation ("${xI}") is not supported yet.`);const i=r.split(yI),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let d=0;d<s.length;++d){const f=s[d];if(!i.some(m=>m.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let d=0;d<r.length;++d){const f=r[d];a.indexOf(f)===-1&&f!==yI&&a.push(f)}const l=new Array(i.length);for(let d=0;d<o;++d){if(new Set(i[d].split("")).size!==i[d].length)throw new Error(`Found duplicate axes in input component ${i[d]}. Support for duplicate axes in input is not implemented yet.`);l[d]=[];for(let f=0;f<i[d].length;++f)l[d].push(a.indexOf(i[d][f]))}const u=a.length,c=s.length,h=[];for(let d=c;d<u;++d)h.push(d);return{allDims:a,summedDims:h,idDims:l}}function xC(t,e){let n=new Array(t);n.fill(-1);for(let s=0;s<e.length;++s)n[e[s]]=s;const r=[];for(let s=0;s<t;++s)n[s]===-1&&r.push(s);return n=n.filter(s=>s!==-1),{permutationIndices:n,expandDims:r}}function bC(t,e,n){const r=new Array(t);for(let s=0;s<n.length;++s){const i=n[s].shape;for(let o=0;o<e[s].length;++o)r[e[s][o]]===void 0?r[e[s][o]]=i[o]:F(r[e[s][o]]===i[o],()=>`Expected dimension ${r[e[s][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function wC(t,e){const n=t,r=[];let s=0;t.length===0&&n.push(-1),s=t.length+1;for(let o=0;o<s;++o)r.push([]);const i=[];for(let o=0;o<n.length;++o){const a=n[o],l=zK(e,a);for(const u of l)i.indexOf(u)===-1&&(r[o].push(u),i.push(u))}return{path:n,steps:r}}function CC(t){return t.every((e,n)=>e===n)}function zK(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function SC(t,e,n=0){let r=[];if(typeof e=="number")F(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const s=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);F(s<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[i]=t.shape[n]-o}F(t.shape[n]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KR(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function XR(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function YR(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZR(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function QR(t,e){return`size ${t} must be non-negative, not ${e}`}function JR(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function eO(t,e){const n=be(t),r=be(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function tO(t,e){const n=be(t),r=be(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fx(){return"segment ids must be >= 0"}function nO(){return"segment ids are not increasing"}function rO(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function sO(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iO(t,e){let n=!1,r;for(t<=aC?(r=t,n=!0):r=gx(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=gx(t,r+1);return r}function oO(t,e,n){const r=[],s=t.length;for(let i=0;i<s;i++)i!==e?r.push(t[i]):r.push(n);return r}function kC(t,e,n,r){const s=e.shape.length,i=t.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let h=0;h<r;++h)if(t.shape[h]!==e.shape[h])throw new Error(`x.shape[${h}]: ${t.shape[h]} should be equal to indices.shape[${h}]: ${e.shape[h]}.`);const o=t.shape[n],a=[];let l=1,u=1,c=1;for(let h=0;h<r;++h)a.push(t.shape[h]),l*=t.shape[h];for(let h=r;h<n;h++)a.push(t.shape[h]),u*=t.shape[h];for(let h=r;h<s;h++)a.push(e.shape[h]);for(let h=n+1;h<i;h++)a.push(t.shape[h]),c*=t.shape[h];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:o,outputShape:a}}const UK=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:kC,computeOutShape:oO,segOpComputeOptimalWindowSize:iO},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Io(t){try{return t.map(e=>ma(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function aO(t){return t.map(e=>ua(e))}const VK=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:dC,ERF_A2:fC,ERF_A3:pC,ERF_A4:mC,ERF_A5:gC,ERF_P:hC,PARALLELIZE_THRESHOLD:aC,get RowPartitionType(){return di},SELU_SCALE:kv,SELU_SCALEALPHA:Sv,applyActivation:H2,assertAndGetBroadcastShape:ut,assertAxesAreInnerMostDims:cr,assertParamsConsistent:oC,assignToTypedArray:jR,axesAreInnerMostDims:S2,calculateShapes:Gl,checkEinsumDimSizes:bC,checkPadOnDimRoundingMode:Hr,combineLocations:ZA,combineRaggedTensorToTensorShapes:MR,complexWithEvenIndex:WR,complexWithOddIndex:GR,computeConv2DInfo:ur,computeConv3DInfo:Na,computeDefaultPad:g2,computeDilation2DInfo:Ff,computeOptimalWindowSize:Cv,computeOutAndReduceShapes:tr,computeOutShape:Ki,computePool2DInfo:Qs,computePool3DInfo:Do,convertConv2DDataFormat:Ao,decodeEinsumEquation:yC,eitherStridesOrDilationsAreOne:yr,expandShapeToKeepDim:Fn,exponent:qR,exponents:HR,fromStringArrayToUint8:aO,fromUint8ToStringArray:Io,getAxesPermutation:hn,getBroadcastDims:tc,getComplexWithIndex:vC,getEinsumComputePath:wC,getEinsumPermutation:xC,getFusedBiasGradient:j2,getFusedDyActivation:G2,getImageCenter:lC,getInnerMostAxes:Cn,getPermuted:Uf,getRaggedRank:zR,getReductionAxes:Hn,getReshaped:zf,getReshapedPermuted:Vf,getRowPartitionTypesHelper:BR,getSliceBeginCoords:uC,getSliceSize:cC,getSparseFillEmptyRowsIndicesDenseShapeMismatch:KR,getSparseFillEmptyRowsNegativeIndexErrorMessage:XR,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:YR,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:JR,getSparseReshapeInputOutputMismatchErrorMessage:tO,getSparseReshapeInputOutputMultipleErrorMessage:eO,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:ZR,getSparseReshapeNegativeOutputDimErrorMessage:QR,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:sO,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:Fx,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:nO,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:rO,getUndoAxesPermutation:$a,isIdentityPermutation:CC,log:lG,mergeRealAndImagArrays:Eo,prepareAndValidate:eC,prepareSplitSize:SC,segment_util:UK,shouldFuse:q2,slice_util:LK,splitRealAndImagArrays:VR,stridesOrDilationsArePositive:Cl,tupleValuesAreOne:wl,upcastType:is,validateDefaultValueShape:UR,validateInput:p7,validateUpdateShape:mR,warn:gs},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */IK();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lO={kernelName:f0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(t,Bf(Ve(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WK={kernelName:Bd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=en(Ve(n,"float32")),s=Nr(st(At(1),r));return bn(nt(t,s))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GK={kernelName:zd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Nr(st(en(Ve(n,"float32")),1));return nt(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jK={kernelName:wc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=ut(n.shape,r.shape);return{a:()=>{let a=t;const l=Hn(n.shape,s);return l.length>0&&(a=et(a,l)),ae(a,n.shape)},b:()=>{let a=t;const l=Hn(r.shape,s);return l.length>0&&(a=et(a,l)),ae(a,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HK={kernelName:Ew,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((r,s)=>{n[s]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qK={kernelName:p0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ct(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KK={kernelName:m0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ct(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XK={kernelName:Ud,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>nt(t,Nr(st(At(1),en(Ve(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YK={kernelName:Vd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Nr(Ae(At(1),en(Ve(n,"float32"))));return nt(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZK={kernelName:jd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=ut(n.shape,r.shape);return{a:()=>{const a=Ae(en(n),en(r));let l=ee(t,nt(r,a));const u=Hn(n.shape,s);return u.length>0&&(l=et(l,u)),ae(l,n.shape)},b:()=>{const a=Ae(en(n),en(r));let l=bn(ee(t,nt(n,a)));const u=Hn(r.shape,s);return u.length>0&&(l=et(l,u)),ae(l,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QK={kernelName:Wd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>nt(t,Ae(en(Ve(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JK={kernelName:Gd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>nt(t,st(At(1),en(Ve(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eX(t,e,n,r,s,i){const o=H(t,"dy","avgPool3dGrad"),a=H(e,"input","avgPool3dGrad");let l=o,u=a,c=!1;a.rank===4&&(c=!0,l=ae(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),u=ae(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),F(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),F(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),Hr("avgPool3dGrad",s,i);const h={dy:l,input:u},d={filterSize:n,strides:r,pad:s,dimRoundingMode:i},f=te.runKernel(Nw,h,d);return c?ae(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const tX=le({avgPool3dGrad_:eX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nX={kernelName:v0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:i,pad:o,dimRoundingMode:a}=n;return{x:()=>tX(t,r,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rX(t,e,n,r,s){const i=H(t,"dy","avgPoolGrad"),o=H(e,"input","avgPoolGrad");F(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,l=i,u=!1;o.rank===3&&(u=!0,a=ae(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=ae(i,[1,i.shape[0],i.shape[1],i.shape[2]])),F(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),F(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const c={dy:l,input:a},h={filterSize:n,strides:r,pad:s},d=te.runKernel(_w,c,h);return u?ae(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const sX=le({avgPoolGrad_:rX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iX={kernelName:g0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:i,pad:o}=n;return{x:()=>sX(t,r,s,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oX={kernelName:y0,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,s]=e,{transposeA:i,transposeB:o}=n;return!i&&!o?{a:()=>_t(t,s,!1,!0),b:()=>_t(r,t,!0,!1)}:!i&&o?{a:()=>_t(t,s,!1,!1),b:()=>_t(t,r,!0,!1)}:i&&!o?{a:()=>_t(s,t,!1,!0),b:()=>_t(r,t,!1,!1)}:{a:()=>_t(s,t,!0,!0),b:()=>_t(t,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aX={kernelName:x0,gradFunc:(t,e,n)=>{const{blockShape:r,crops:s}=n;return{x:()=>D2(t,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lX={kernelName:sG,gradFunc:(t,e,n)=>{const r=n,s=r.inputShape,i=r.shape,o=Array.from(i);for(let l=s.length-1;l>=0;l--)if(s[l]===i[l])o[l]=1;else if(s[l]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>et(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uX={kernelName:Hd,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cX={kernelName:qd,gradFunc:t=>({x:()=>Ct(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hX={kernelName:Kd,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:s,clipValueMax:i}=n;return{x:()=>Tr(ko(zl(r,s),Sc(r,i)),t,Ct(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dX={kernelName:b0,inputsToSave:["x"],gradFunc:lO.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fX={kernelName:w0,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(l=>l.shape),{axis:s}=n,i=mt(s,e[0].shape)[0],o=r.map(l=>l[i]);return bs(t,o,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pX={kernelName:C0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{dilations:i,strides:o,pad:a,dataFormat:l}=n;return F(wl(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>b2(r.shape,t,s,o,a,l),filter:()=>W2(r,t,s.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mX={kernelName:S0,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{strides:i,pad:o,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>Sl(t,s,i,o,a,1,l),filter:()=>W2(t,r,s.shape,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gX(t,e,n,r,s){let i=t;t.rank===4&&(i=ae(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;o.rank===4&&(o=ae(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),F(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),F(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),F(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),F(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),F(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:i,dy:o},l={strides:r,pad:s,filterShape:n};return te.runKernel(Ow,a,l)}const vX=le({conv3DBackpropFilter_:gX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yX={kernelName:k0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:i}=n;F(wl(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[o,a]=e;return{x:()=>KA(o.shape,t,a,s,i),filter:()=>vX(o,t,a.shape,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xX={kernelName:Xd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(bn(hR(Ve(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bX={kernelName:Yd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(dR(Ve(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wX={kernelName:E0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s,exclusive:i,reverse:o}=n;return{x:()=>{const a=hn([s],r.rank);let l=YA(t,s,i,!o);return a!=null&&(l=wt(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CX={kernelName:I0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:i,dimRoundingMode:o}=n,a=r??[1,1];F(wl(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,u]=e;return F(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),F(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),F(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),F(yr(s,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${s} and dilations '${a}'.`),Hr("depthwiseConv2d",i,o),{x:()=>R7(l.shape,t,u,s,i,a,o),filter:()=>D7(l,t,u.shape,s,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SX={kernelName:T0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,i={x:r,filter:s,dy:t},o={x:r,filter:s,dy:t};return{x:()=>te.runKernel(vx,i,n),filter:()=>te.runKernel(yx,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kX={kernelName:Qd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>te.runKernel(Ww,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EX={kernelName:Jd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=ee(So(bn(en(n))),2/Math.sqrt(Math.PI));return{x:()=>ee(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IX={kernelName:ef,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TX={kernelName:N0,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>ae(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _X={kernelName:tf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(t,So(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NX={kernelName:nf,gradFunc:t=>({x:()=>Ct(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $X={kernelName:rf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=ut(n.shape,r.shape);return{a:()=>{const a=nt(t,Ve(r,"float32")),l=Hn(n.shape,s);return l.length>0?ae(et(a,l),n.shape):a},b:()=>{let a=ee(t,Ve(n,"float32"));const l=Hn(r.shape,s);l.length>0&&(a=ae(et(a,l),r.shape));const u=en(r);return bn(nt(a,Ve(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DX={kernelName:$0,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[s,i,o,a]=e,l=a??At(1),u=Hn(i.shape,s.shape),c=[];if(i.rank===1){for(let x=0;x<s.shape.length-1;++x)c.push(s.shape[x]);c.push(1)}const h=st(s,i),d=ee(t,l),f=lR(Ae(o,At(r))),m=ee(ee(ee(f,f),f),At(-.5));return{x:()=>i.rank===1?ae(ee(ee(t,fi(ae(f,[1,1,1,i.shape[0]]),c)),l),s.shape):ae(ee(ee(t,f),l),s.shape),mean:()=>{let x=ee(ee(f,At(-1)),d);return i.rank===1&&(x=et(x,u)),ae(x,i.shape)},variance:()=>{let x=ee(ee(m,h),d);return i.rank===1&&(x=et(x,u)),ae(x,i.shape)},scale:()=>{const x=ee(h,f);let w=ee(t,x);return i.rank===1&&(w=et(w,u)),ae(w,i.shape)},offset:()=>{let x=t;return i.rank===1&&(x=et(x,u)),ae(x,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AX={kernelName:D0,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,s]=e,{axis:i}=n,o=mt(i,r.shape)[0];return{x:()=>{const l=r.shape,u=s.size,c=l.slice(0,o),h=c.length,d=l.slice(i,l.length).slice(1),f=d.length,m=bI(0,h),v=bI(h+1,h+1+f),p=wI([c,[u],d]),g=ae(t,p),y=ae(s,[u]),b=wI([[h],m,v]),x=wt(g,b);let w=vR(x,y,r.shape[o]);const C=$a(b);return w=wt(w,C),w},indices:()=>s}}};function bI(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function wI(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RX={kernelName:sf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>Ct(n),b:()=>Ct(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OX={kernelName:of,gradFunc:t=>({x:()=>Ve(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FX={kernelName:af,gradFunc:t=>({x:()=>Ct(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LX={kernelName:lf,gradFunc:t=>({x:()=>Ct(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PX={kernelName:uf,gradFunc:t=>({x:()=>Ct(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MX={kernelName:R0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:s}=n,i=Es(r,0);return{x:()=>Tr(i,t,ee(t,s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BX={kernelName:hf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>nt(t,Ae(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zX={kernelName:cf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>nt(t,Ve(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UX={kernelName:oG,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n;return{logits:()=>{const o=So(r);return st(t,ee(et(t,s,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VX(t,e,n,r=5,s=1,i=1,o=.5){const a={x:t,y:e,dy:n},l={depthRadius:r,bias:s,alpha:i,beta:o};return te.runKernel(Xw,a,l)}const WX=le({localResponseNormalizationBackprop_:VX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GX={kernelName:B0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{depthRadius:i,bias:o,alpha:a,beta:l}=n;return{x:()=>WX(r,s,t,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uO(t,e,n,r){return e.rank<n.rank&&(e=ae(e,Fn(e.shape,r))),t.rank<n.rank&&(t=ae(t,Fn(t.shape,r))),{x:()=>ee(t,Ve(Qi(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CI={kernelName:z0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:s}=r,i=e[0],o=e[1],a=mt(s,i.shape),l=uO(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jX={kernelName:df,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>ee(t,Ve(zl(n,r),"float32")),b:()=>ee(t,Ve(Ym(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HX(t,e,n,r,s,i,o){const a=H(t,"dy","maxPool3dGrad"),l=H(e,"input","maxPool3dGrad"),u=H(n,"output","maxPool3dGrad");let c=a,h=l,d=u,f=!1;l.rank===4&&(f=!0,c=ae(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),h=ae(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=ae(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),F(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),F(h.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${h.rank}.`),F(d.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`),Hr("maxPool3dGrad",i,o);const m={dy:c,input:h,output:d},v={filterSize:r,strides:s,pad:i,dimRoundingMode:o},p=te.runKernel(Zw,m,v);return f?ae(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const qX=le({maxPool3dGrad_:HX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KX={kernelName:V0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=n;return{x:()=>qX(t,r,s,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XX(t,e,n,r,s,i,o){const a=H(t,"dy","maxPoolGrad"),l=H(e,"input","maxPoolGrad"),u=H(n,"output","maxPoolGrad");F(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),F(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),F(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Hr("maxPoolGrad",i,o);const c={dy:a,input:l,output:u},h={filterSize:r,strides:s,pad:i,dimRoundingMode:o};return te.runKernel(Yw,c,h)}const YX=le({maxPoolGrad_:XX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZX={kernelName:U0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:i,strides:o,pad:a}=n;return{x:()=>YX(t,r,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QX={kernelName:W0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n,i=mt(s,r.shape),a=tr(r.shape,i)[1],l=be(a);return{x:()=>{const c=r.shape.slice();i.forEach(f=>{c[f]=1});const h=ae(t,c);return nt(ee(h,Ul(r.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JX={kernelName:G0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:s}=r,[i,o]=e,a=mt(s,i.shape),l=uO(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eY={kernelName:ff,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>ee(t,Ve(Sc(n,r),"float32")),b:()=>ee(t,Ve(Es(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tY={kernelName:j0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,i=s.map(o=>o[0]);return{x:()=>Kt(t,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nY={kernelName:pf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=ut(n.shape,r.shape);return{a:()=>{const a=Hn(n.shape,s);return a.length>0?ae(et(t,a),n.shape):t},b:()=>{const a=ee(t,bn(bv(nt(n,r)))),l=Hn(r.shape,s);return l.length>0?ae(et(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rY={kernelName:mf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=ut(n.shape,r.shape);return{a:()=>{const a=ee(t,Ve(r,"float32")),l=Hn(n.shape,s);return l.length>0?ae(et(a,l),n.shape):a},b:()=>{const a=ee(t,Ve(n,"float32")),l=Hn(r.shape,s);return l.length>0?ae(et(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sY={kernelName:H0,gradFunc:t=>({x:()=>bn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iY={kernelName:X0,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>Qn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oY={kernelName:K0,gradFunc:t=>({x:()=>Ct(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aY={kernelName:Y0,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return El(t,r).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SI={kernelName:Z0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,i=s.map(o=>o[0]);return{x:()=>Kt(t,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lY={kernelName:gf,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,s]=e,i=n,o=r,a=ut(i.shape,o.shape);return{a:()=>{const c=Ve(o,"float32");let h=ee(t,ee(c,nc(i,st(c,At(1)))));const d=Hn(i.shape,a);return d.length>0&&(h=et(h,d)),ae(h,i.shape)},b:()=>{const c=Es(i,0),h=Tr(c,Ji(i),Ct(i));let d=ee(t,ee(s,h));const f=Hn(o.shape,a);return f.length>0&&(d=et(d,f)),ae(d,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uY={kernelName:Q0,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,s=Es(n,0);return{x:()=>Tr(s,t,ee(t,r)),alpha:()=>{let i=Tr(s,Ct(t),ee(t,n));const o=Hn(r.shape,t.shape);return o.length>0&&(i=et(i,o)),ae(i,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cY(t,e,n){const r=t.shape.slice();r[n]=1;const s=ae(e,r),i=Ax(t,n,!0,!1),o=Ax(t,n,!0,!0),a=ee(i,o);return ee(s,a)}function hY(t,e,n){const r=t.shape.length,s=r-n.length,i=hn(n,r);let o=t;i!=null&&(o=wt(t,i));const a=o.shape.slice(),u=a.splice(r-n.length,n.length).reduce((d,f)=>d*f,1);a.push(u);const c=o.reshape(a);let h=cY(c,e,s);if(h=h.reshape(o.shape),i!=null){const d=$a(i);h=wt(h,d)}return h}const dY={kernelName:J0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n;let i=[];return s==null?i=r.shape.map((o,a)=>a):typeof s=="number"?i=[s]:i=s,{x:()=>hY(r,t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fY={kernelName:Zd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=ut(n.shape,r.shape);return{a:()=>{const a=nt(t,Ve(r,"float32")),l=Hn(n.shape,s);return l.length>0?ae(et(a,l),n.shape):a},b:()=>{let a=ee(t,Ve(n,"float32"));const l=Hn(r.shape,s);l.length>0&&(a=ae(et(a,l),r.shape));const u=en(r);return bn(nt(a,Ve(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pY={kernelName:vf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>nt(t,bn(en(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mY={kernelName:xf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=ee(Sc(n,6),Bf(n));return{x:()=>ee(t,Ve(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gY={kernelName:yf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(t,Ve(Bf(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vY={kernelName:ev,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ae(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yY={kernelName:nv,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>te.runKernel(s2,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xY={kernelName:tv,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>te.runKernel(r2,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bY={kernelName:rv,gradFunc:(t,e,n)=>{const{dims:r}=n,s=mt(r,t.shape);return{x:()=>kl(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wY={kernelName:bf,gradFunc:t=>({x:()=>Ct(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CY={kernelName:wf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>bn(nt(t,ee(nc(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SY={kernelName:sv,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>Ve(Ct(n),"float32"),t:()=>ee(t,Ve(n,t.dtype)),e:()=>ee(t,Ve(T2(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kY={kernelName:Cf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Es(n,At(0)),s=At(Sv),i=At(kv),o=ee(t,i),a=ee(ee(t,s),So(Ve(n,"float32")));return Tr(r,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EY={kernelName:If,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(t,ee(n,st(At(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IY={kernelName:Ef,gradFunc:t=>({x:()=>Ct(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TY={kernelName:Sf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(w2(Ve(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Y={kernelName:kf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(XA(Ve(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NY={kernelName:iv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:s,size:i}=n,o=r.shape,[a,l]=wv(r,s,i),u=[];for(let c=0;c<t.rank;c++)u.push([a[c],o[c]-a[c]-l[c]]);return{x:()=>$2(t,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Y={kernelName:uv,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:s}=n,i=!0,o=ee(t,r);return{logits:()=>st(o,ee(et(o,[s],i),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DY={kernelName:Tf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(t,Cc(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kI={kernelName:av,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:s}=n;return{x:()=>x2(t,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EI={kernelName:lv,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>zr(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AY={kernelName:_f,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>nt(t,ee(Nr(Ve(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RY={kernelName:i2,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(t,ee(Ve(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OY={kernelName:Nf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=At(2);return{a:()=>ee(t,ee(s,st(n,r))),b:()=>ee(t,ee(s,st(r,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FY={kernelName:Of,gradFunc:t=>({x:()=>Ct(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LY={kernelName:$f,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=ut(n.shape,r.shape);return{a:()=>{let a=t;const l=Hn(n.shape,s);return l.length>0&&(a=et(a,l)),ae(a,n.shape)},b:()=>{let a=t;const l=Hn(r.shape,s);return l.length>0&&(a=et(a,l)),ae(bn(a),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PY={kernelName:ov,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,s=r.shape.slice(),{axis:i}=n;mt(i,r.shape).forEach(u=>{s[u]=1});const a=ae(t,s),l=ee(a,Ul(r.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MY={kernelName:Df,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>nt(t,en(w2(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BY={kernelName:Af,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(st(At(1),en(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zY={kernelName:Rf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:s}=n;return{x:()=>{let o=Ct(r);if(r.rank===1)for(let a=0;a<s[0];++a)o=Ae(o,Kt(t,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)o=Ae(o,Kt(t,[a*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let u=0;u<s[2];++u)o=Ae(o,Kt(t,[a*r.shape[0],l*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let u=0;u<s[2];++u)for(let c=0;c<s[3];++c)o=Ae(o,Kt(t,[a*r.shape[0],l*r.shape[1],u*r.shape[2],c*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UY={kernelName:Mu,gradFunc:(t,e,n)=>{const r=n,{perm:s}=r,i=$a(s);return{x:()=>wt(t,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VY={kernelName:cv,gradFunc:(t,e,n)=>{const r=n,{axis:s}=r;return{value:()=>ga(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WY={kernelName:hv,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>GY(t,n)}}};function GY(t,e){const n=Da(e,Ct(e)),r=k2(t,n);let s=zl(e,At(0,"int32"));const i=r.rank-s.rank;for(let a=0;a<i;++a)s=Pr(s,a+1);s=ko(s,Ul(r.shape,"bool"));const o=Ct(r);return Tr(s,r,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jY={kernelName:dv,gradFunc:t=>({x:()=>Ct(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HY=[lO,WK,GK,jK,HK,qK,KK,XK,YK,ZK,QK,JK,nX,iX,oX,aX,lX,uX,cX,hX,dX,fX,mX,pX,yX,xX,bX,wX,CX,SX,fY,kX,EX,IX,TX,_X,$X,NX,DX,AX,RX,OX,FX,LX,PX,MX,BX,zX,UX,GX,CI,CI,jX,KX,ZX,QX,JX,eY,tY,nY,rY,sY,iY,oY,aY,SI,SI,lY,uY,dY,pY,mY,gY,vY,yY,xY,bY,wY,CY,SY,kY,EY,IY,TY,_Y,NY,$Y,DY,kI,kI,EI,EI,AY,OY,RY,FY,LY,PY,MY,BY,zY,UY,VY,WY,jY];for(const t of HY)uG(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.abs=function(){return this.throwIfDisposed(),Sr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.acos=function(){return this.throwIfDisposed(),wj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.acosh=function(){return this.throwIfDisposed(),Sj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.add=function(t){return this.throwIfDisposed(),Ae(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.all=function(t,e){return this.throwIfDisposed(),jA(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.any=function(t,e){return this.throwIfDisposed(),$x(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.argMax=function(t){return this.throwIfDisposed(),rd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.argMin=function(t){return this.throwIfDisposed(),_j(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.asScalar=function(){return this.throwIfDisposed(),F(this.size===1,()=>"The array must have only 1 element."),ae(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.asType=function(t){return this.throwIfDisposed(),Ve(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.as1D=function(){return this.throwIfDisposed(),ae(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.as2D=function(t,e){return this.throwIfDisposed(),ae(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),ae(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),ae(this,[t,e,n,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.as5D=function(t,e,n,r,s){return this.throwIfDisposed(),ae(this,[t,e,n,r,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.asin=function(){return this.throwIfDisposed(),$j(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.asinh=function(){return this.throwIfDisposed(),Aj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.atan=function(){return this.throwIfDisposed(),Oj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.atan2=function(t){return this.throwIfDisposed(),Lj(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.atanh=function(){return this.throwIfDisposed(),Mj(this)};xe().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),v2(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),x2(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.batchNorm=function(t,e,n,r,s){return this.throwIfDisposed(),gv(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Dh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.cast=function(t){return this.throwIfDisposed(),Ve(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.ceil=function(){return this.throwIfDisposed(),hH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Cs(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof Rn&&(t=[t]),zr([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.conv1d=function(t,e,n,r,s,i){return this.throwIfDisposed(),HA(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.conv2dTranspose=function(t,e,n,r,s){return this.throwIfDisposed(),qA(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.conv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),Sl(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.cos=function(){return this.throwIfDisposed(),w2(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.cosh=function(){return this.throwIfDisposed(),XA(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),Ax(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),YA(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),LH(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.depthwiseConv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),C2(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.dilation2d=function(t,e,n,r,s){return this.throwIfDisposed(),BH(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.divNoNan=function(t){return this.throwIfDisposed(),GH(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.div=function(t){return this.throwIfDisposed(),nt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.dot=function(t){return this.throwIfDisposed(),HH(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.elu=function(){return this.throwIfDisposed(),yv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.equal=function(t){return this.throwIfDisposed(),Qi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.erf=function(){return this.throwIfDisposed(),YH(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),iq(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.exp=function(){return this.throwIfDisposed(),So(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.expandDims=function(t){return this.throwIfDisposed(),Pr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.expm1=function(){return this.throwIfDisposed(),uq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.fft=function(){return this.throwIfDisposed(),pR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.flatten=function(){return this.throwIfDisposed(),ae(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.floor=function(){return this.throwIfDisposed(),bv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.floorDiv=function(t){return this.throwIfDisposed(),GA(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.gather=function(t,e,n){return this.throwIfDisposed(),k2(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.greaterEqual=function(t){return this.throwIfDisposed(),zl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.greater=function(t){return this.throwIfDisposed(),Es(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.ifft=function(){return this.throwIfDisposed(),Rx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.irfft=function(){return this.throwIfDisposed(),t7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.isFinite=function(){return this.throwIfDisposed(),yq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.isInf=function(){return this.throwIfDisposed(),bq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.isNaN=function(){return this.throwIfDisposed(),Cq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.leakyRelu=function(t){return this.throwIfDisposed(),I2(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.lessEqual=function(t){return this.throwIfDisposed(),Sc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.less=function(t){return this.throwIfDisposed(),Ym(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),Tq(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.logSigmoid=function(){return this.throwIfDisposed(),Oq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.logSoftmax=function(t){return this.throwIfDisposed(),tR(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),Mq(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.log=function(){return this.throwIfDisposed(),Ji(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.log1p=function(){return this.throwIfDisposed(),eR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.logicalAnd=function(t){return this.throwIfDisposed(),ko(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.logicalNot=function(){return this.throwIfDisposed(),T2(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.logicalOr=function(t){return this.throwIfDisposed(),nR(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.logicalXor=function(t){return this.throwIfDisposed(),Wq(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),_t(this,t,e,n)};xe().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),_2(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.max=function(t,e){return this.throwIfDisposed(),yi(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.maximum=function(t){return this.throwIfDisposed(),Da(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.mean=function(t,e){return this.throwIfDisposed(),On(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.min=function(t,e){return this.throwIfDisposed(),Xm(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.minimum=function(t){return this.throwIfDisposed(),od(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),Zq(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.mod=function(t){return this.throwIfDisposed(),Jq(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.mul=function(t){return this.throwIfDisposed(),ee(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.neg=function(){return this.throwIfDisposed(),bn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.norm=function(t,e,n){return this.throwIfDisposed(),xv(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.notEqual=function(t){return this.throwIfDisposed(),Zm(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),rR(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.onesLike=function(){return this.throwIfDisposed(),Zs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.pad=function(t,e){return this.throwIfDisposed(),$2(this,t,e)};xe().prototype.pool=function(t,e,n,r,s,i){return this.throwIfDisposed(),u9(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.pow=function(t){return this.throwIfDisposed(),nc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.prelu=function(t){return this.throwIfDisposed(),A2(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.prod=function(t,e){return this.throwIfDisposed(),d9(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.reciprocal=function(){return this.throwIfDisposed(),F9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.relu=function(){return this.throwIfDisposed(),Wl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.relu6=function(){return this.throwIfDisposed(),oR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.reshapeAs=function(t){return this.throwIfDisposed(),ae(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.reshape=function(t){return this.throwIfDisposed(),ae(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),xR(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),bR(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.reverse=function(t){return this.throwIfDisposed(),kl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.rfft=function(){return this.throwIfDisposed(),s7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.round=function(){return this.throwIfDisposed(),aR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.rsqrt=function(){return this.throwIfDisposed(),lR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.selu=function(){return this.throwIfDisposed(),uR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.separableConv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),cR(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.sigmoid=function(){return this.throwIfDisposed(),Cc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.sign=function(){return this.throwIfDisposed(),G9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.sin=function(){return this.throwIfDisposed(),hR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.sinh=function(){return this.throwIfDisposed(),dR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.slice=function(t,e){return this.throwIfDisposed(),Kt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.softmax=function(t){return this.throwIfDisposed(),V2(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.softplus=function(){return this.throwIfDisposed(),Lf(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),D2(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.split=function(t,e){return this.throwIfDisposed(),bs(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.sqrt=function(){return this.throwIfDisposed(),Nr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.square=function(){return this.throwIfDisposed(),en(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.squaredDifference=function(t){return this.throwIfDisposed(),o7(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.squeeze=function(t){return this.throwIfDisposed(),Mf(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof Rn?[this,t]:[this,...t];return ga(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.step=function(t){return this.throwIfDisposed(),Bf(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.stridedSlice=function(t,e,n,r,s,i,o,a){return this.throwIfDisposed(),h7(this,t,e,n,r,s,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.sub=function(t){return this.throwIfDisposed(),st(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.sum=function(t,e){return this.throwIfDisposed(),et(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.tan=function(){return this.throwIfDisposed(),f7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.tanh=function(){return this.throwIfDisposed(),y2(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.tile=function(t){return this.throwIfDisposed(),fi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.toBool=function(){return this.throwIfDisposed(),Ve(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.toFloat=function(){return this.throwIfDisposed(),Ve(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.toInt=function(){return this.throwIfDisposed(),Ve(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.topk=function(t,e){return this.throwIfDisposed(),g7(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.transpose=function(t){return this.throwIfDisposed(),wt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.unique=function(t){return this.throwIfDisposed(),x7(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),vR(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.unstack=function(t){return this.throwIfDisposed(),El(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.where=function(t,e){return this.throwIfDisposed(),Tr(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xe().prototype.zerosLike=function(){return this.throwIfDisposed(),Ct(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Fi extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Fi.prototype)}}class js extends Error{constructor(e){super(e),Object.setPrototypeOf(this,js.prototype)}}class Q extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Q.prototype)}}class ht extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ht.prototype)}}class EC extends Error{constructor(e){super(e),Object.setPrototypeOf(this,EC.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class cO{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Il(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function Li(t,e){if(!t)throw new EC(e)}function II(t,e){let n=0;for(const r of t)r===e&&n++;return n}function Mr(t){return t.length===1?t[0]:t}function Qt(t){return Array.isArray(t)?t:[t]}function uo(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function qa(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let Rs={};function IC(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function Lx(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>Lx(e));else{const e=Object.keys(t);for(const n of e){const r=t[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?t[n]=r.value:Lx(r))}}}function Wf(t,e={},n={},r="object",s=!1){if(typeof t=="string"){const i=t;let o;if(i in n)o=n[i];else if(i in Rs)o=Rs[i];else if(o=e[i],o==null)throw new Q(`Unknown ${r}: ${t}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=t;if(i.className==null||i.config==null)throw new Q(`${r}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,l;if(o in n?[a,l]=n[o]:o in Rs?[a,l]=Rs.className:o in e&&([a,l]=e[o]),a==null)throw new Q(`Unknown ${r}: ${o}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const f of Object.keys(Rs))u[f]=Rs[f];for(const f of Object.keys(n))u[f]=n[f];const c=i.config;c.customObjects=u;const h=Object.assign({},Rs);for(const f of Object.keys(n))Rs[f]=n[f];Lx(i.config);const d=l(a,i.config,n,s);return Rs=Object.assign({},h),d}else{const u=Object.assign({},Rs);for(const h of Object.keys(n))Rs[h]=n[h];const c=new a(i.config);return Rs=Object.assign({},u),c}}}function qY(t,e){return t<e?-1:t>e?1:0}function Dp(t,e){return-1*qY(t,e)}function ca(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function KY(t){if(t==null)throw new Q(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function jl(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new Q(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function TC(t,e,n=0,r=1/0){return Li(n>=0),Li(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(s=>typeof s===e)}function er(t,e){Array.isArray(t)?(F(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,r)=>er(n,`element ${r+1} of ${e}`))):F(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${hO(t)}.`)}function hO(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>hO(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function XY(t,e,n){let r=n!=null?n():Lr(),s;return(...o)=>{const a=n!=null?n():Lr();return a-r<e||(r=a,s=t(...o)),s}}function dO(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let YY=0;function fO(){return YY++}const Ap={};function Ev(t=""){return t in Ap||(Ap[t]=0),Ap[t]+=1,t+Ap[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ZY=["channelsFirst","channelsLast"],QY=["nearest","bilinear"],JY=["valid","same","causal"],eZ=["max","avg"],tZ=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const uu=new Map;function Sn(t){jl(ZY,"DataFormat",t)}function nZ(t){jl(QY,"InterpolationFormat",t)}function Is(t){jl(JY,"PaddingMode",t)}function pO(t){jl(eZ,"PoolMode",t)}const Ah=[],TI="/";function il(t,e){Ah.push(t);try{const n=e();return Ah.pop(),n}catch(n){throw Ah.pop(),n}}function rZ(){return Ah.length===0?"":Ah.join(TI)+TI}function mO(t){if(!vO(t))throw new Error("Not a valid tensor name: '"+t+"'");return rZ()+t}function gO(t){if(!vO(t))throw new Error("Not a valid tensor name: '"+t+"'");uu.has(t)||uu.set(t,0);const e=uu.get(t);if(uu.set(t,uu.get(t)+1),e>0){const n=`${t}_${e}`;return uu.set(n,1),n}else return t}const sZ=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function vO(t){return!!t.match(sZ)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function iZ(t){return t===parseInt(t.toString(),10)}function ha(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let r=1;for(let s=e;s<n;++s)r*=t[s];return r}function sc(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function va(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function wi(t,e){if(e<t)throw new Q(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let jy;function Vn(){return jy==null&&(jy=pj().epsilon()),jy}function Ci(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xi(t,e){return Ve(t,e)}function Gf(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),ae(t,n)}function oZ(t,e){return pe(()=>{if(t.shape.length!==2)throw new Q(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=Gf(t,1);return Px(n,[1,e,1])})}function aZ(t){const e=[ha(t.shape)];return ae(t,e)}function lZ(t){if(t.rank<=1)throw new Q(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],ha(t.shape,1)];return ae(t,e)}function ol(t,e,n){return pe(()=>{switch(t.rank){case 1:return z2(t,e,n);case 2:return fR(t,[e,0],[n,t.shape[1]]);case 3:return U2(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return Jm(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return Kt(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return Kt(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new Q(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Hy(t,e,n){return pe(()=>{switch(t.rank){case 1:return z2(t,e,n);case 2:return fR(t,[0,e],[t.shape[0],n]);case 3:return U2(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return Jm(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new Q(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Rp(t,e,n,r){return pe(()=>{switch(t.rank){case 1:return z2(t,e,n);case 2:switch(r){case 1:return ol(t,e,n);case 2:return Hy(t,e,n);default:throw new Q(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return ol(t,e,n);case 2:return U2(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return Hy(t,e,n);default:throw new Q(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return ol(t,e,n);case 2:return Jm(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return Jm(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return Hy(t,e,n);default:throw new Q(`The axis is not within the rank of the tensor ${r}`)}default:throw new Q(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function _C(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),zr(t,e)}function _I(t,e){switch(t.rank){case 1:return pH([t,e]);case 2:return gH([t,e],0);case 3:return yH([t,e],0);case 4:return bH([t,e],0);default:throw new Q(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function Px(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new Q(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return fi(t,e)}function Iv(t,e=0,n=1,r,s){return D9(t,e,n,r,s)}function Yi(t,e,n,r){if(t.rank<2||e.rank<2)throw new ht(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const s=t.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(s!==i)throw new ht(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return dI({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?Mx(t.rank,r,Ci()):null,activation:n});{const s=t.shape.slice(),i=s.pop();t=ae(t,[-1,i]);const o=e.shape.slice(),a=o.pop(),l=o.pop(),u=[...o,a],c=Array.from({length:e.rank},(m,v)=>v===0?e.rank-2:v<=e.rank-2?v-1:v);e=ae(wt(e,c),[l,-1]);const h=[...s,...u];return ae(dI({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?Mx(t.rank,r,Ci()):null,activation:n}),h)}}function yO(t,e,n){return pe(()=>(Array.isArray(e)?e=es(e,"int32"):e=Ve(e,"int32"),k2(t,e,n)))}function jf(t){return ee(t,t)}function Mx(t,e,n){const r=e.shape;if(e.rank!==1&&e.rank!==t)throw new Q(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return r.length===1?ae(e,[1,r[0],1,1,1]):ae(e,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?ae(e,[1,1,1,1,r[0]]):ae(e,[1].concat(r))}else if(t===4){if(n==="channelsFirst")return r.length===1?ae(e,[1,r[0],1,1]):ae(e,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?ae(e,[1,1,1,r[0]]):ae(e,[1].concat(r))}else if(t===3){if(n==="channelsFirst")return r.length===1?ae(e,[1,r[0],1]):ae(e,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?ae(e,[1,1,r[0]]):ae(e,[1].concat(r))}else if(t<3)return e;throw new Q(`Unsupported input rank by biasAdd: ${e.rank}`)}function Ii(t,e,n){return pe(()=>(n==null&&(n=Ci()),Sn(n),Ae(t,Mx(t.rank,e,n))))}function uZ(t,e=1){if(e!==1)throw new ht(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return yv(t)}function cZ(t){return pe(()=>nt(t,Ae(Sr(t),1)))}function xO(t,e,n,r){return pe(()=>I7(t,e,n,r))}function hZ(t){return pe(()=>{const e=Ae(.5,ee(.2,t));return Cs(e,0,1)})}function Hf(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const dZ=["fanIn","fanOut","fanAvg"],fZ=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pZ(t){jl(dZ,"FanMode",t)}function mZ(t){jl(fZ,"Distribution",t)}class Js extends Ec{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class bO extends Js{apply(e,n){return Qn(e,n)}}bO.className="Zeros";Ie(bO);class NC extends Js{apply(e,n){return Ul(e,n)}}NC.className="Ones";Ie(NC);class wO extends Js{constructor(e){if(super(),typeof e!="object")throw new Q(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new Q(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return pe(()=>ee(At(this.value),Ul(e,n)))}getConfig(){return{value:this.value}}}wO.className="Constant";Ie(wO);class CO extends Js{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return Pf(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}CO.className="RandomUniform";Ie(CO);class SO extends Js{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new ht(`randomNormal does not support dType ${n}.`);return Iv(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}SO.className="RandomNormal";Ie(SO);class kO extends Js{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new ht(`truncatedNormal does not support dType ${n}.`);return gR(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}kO.className="TruncatedNormal";Ie(kO);class EO extends Js{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return pe(()=>{if(e.length!==2||e[0]!==e[1])throw new Q("Identity matrix initializer can only be used for 2D square matrices.");return ee(this.gain,JA(e[0]))})}getConfig(){return{gain:this.gain}}}EO.className="Identity";Ie(EO);function gZ(t,e="channelsLast"){let n,r;if(Sn(e),t.length===2)n=t[0],r=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const s=ha(t,2);n=t[1]*s,r=t[0]*s}else if(e==="channelsLast"){const s=ha(t,0,t.length-2);n=t[t.length-2]*s,r=t[t.length-1]*s}}else{const s=ha(t);n=Math.sqrt(s),r=Math.sqrt(s)}return[n,r]}class os extends Js{constructor(e){if(super(),e.scale<0)throw new Q(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,pZ(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,mZ(this.distribution),this.seed=e.seed}apply(e,n){const r=gZ(e),s=r[0],i=r[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,s):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(s+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new ht(`${this.getClassName()} does not support dType ${n}.`);return gR(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return Pf(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}os.className="VarianceScaling";Ie(os);class $C extends os{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return os.className}}$C.className="GlorotUniform";Ie($C);class DC extends os{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return os.className}}DC.className="GlorotNormal";Ie(DC);class AC extends os{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return os.className}}AC.className="HeNormal";Ie(AC);class RC extends os{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return os.className}}RC.className="HeUniform";Ie(RC);class OC extends os{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return os.className}}OC.className="LeCunNormal";Ie(OC);class FC extends os{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return os.className}}FC.className="LeCunUniform";Ie(FC);class IO extends Js{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return pe(()=>{if(e.length<2)throw new ht("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const r=be(e.slice(0,-1)),s=e[e.length-1],i=r*s;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(s,r),Math.min(s,r)],a=Iv(o,0,1,n,this.seed),l=CK.qr(a,!1);let u=l[0];const h=l[1].flatten().stridedSlice([0],[Math.min(s,r)*Math.min(s,r)],[Math.min(s,r)+1]);return u=ee(u,h.sign()),r<s&&(u=u.transpose()),ee(At(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}IO.className="Orthogonal";Ie(IO);const NI={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function $I(t,e={}){return Wf(t,zs.getMap().classNameMap,e,"initializer")}function cn(t){return IC(t)}function on(t){if(typeof t=="string"){const e=t in NI?NI[t]:t;if(e==="GlorotNormal")return new DC;if(e==="GlorotUniform")return new $C;if(e==="HeNormal")return new AC;if(e==="HeUniform")return new RC;if(e==="LeCunNormal")return new OC;if(e==="LeCunUniform")return new FC;{const n={};return n.className=e,n.config={},$I(n)}}else return t instanceof Js?t:$I(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Bx(t){return Array.isArray(t)&&Array.isArray(t[0])}function eg(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function rt(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new Q(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Et(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new Q(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tg(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((r,s)=>r*s);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const DI="Variable";class vZ{constructor(e,n="float32",r=DI,s=!0,i=null){this.dtype=n??"float32",this.shape=e.shape,this.id=fO(),r=r??DI,this.originalName=mO(r),this.name=gO(this.originalName),this.trainable_=s,this.constraint=i,this.val=C7(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),yZ(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function yZ(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function zx(t){return t.map(e=>e.read())}function LC(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Wn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class zi{constructor(e,n,r,s,i,o,a){this.dtype=e,this.shape=n,this.sourceLayer=r,this.inputs=s,this.callArgs=i,this.outputTensorIndex=a,this.id=fO(),o!=null&&(this.originalName=mO(o),this.name=gO(this.originalName)),this.rank=n.length}}let xZ=0,Tv=class{constructor(e,n){this.callArgs=n,this.id=xZ++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const r of e.inboundLayers)r!=null&&r.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},bZ=0;class gt extends Ec{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=bZ++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const r=this.getClassName();n=uo(r)+"_"+Ev(r)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let r;if(e.batchInputShape!=null)r=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),r=[i].concat(e.inputShape)}this.batchInputShape=r;let s=e.dtype;s==null&&(s=e.inputDType),s==null&&(s="float32"),this.dtype=s}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new js(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new Q(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Mr(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Mr(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Fi(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Fi(`Layer ${this.name} is not connected, no input to return.`);return Mr(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Fi(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Fi(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Mr(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){if(e=Qt(e),this.inputSpec==null||this.inputSpec.length===0)return;const n=Qt(this.inputSpec);if(e.length!==n.length)throw new Q(`Layer ${this.name} expects ${n.length} inputs, but it received ${e.length} input tensors. Input received: ${e}`);for(let r=0;r<e.length;r++){const s=e[r],i=n[r];if(i==null)continue;const o=s.rank;if(i.ndim!=null&&o!==i.ndim)throw new Q(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${o}`);if(i.maxNDim!=null&&o>i.maxNDim)throw new Q(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${o}`);if(i.minNDim!=null&&o<i.minNDim)throw new Q(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${o}.`);if(i.dtype!=null&&s.dtype!==i.dtype)throw new Q(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${s.dtype}.`);if(i.axes){const a=s.shape;for(const l in i.axes){const u=Number(l),c=i.axes[l],h=u>=0?a[u]:a[a.length+u];if(c!=null&&[c,null].indexOf(h)===-1)throw new Q(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${c} but got shape ${a}.`)}}if(i.shape!=null)for(let a=0;a<i.shape.length;++a){const l=i.shape[a],u=s.shape[a];if(l!=null&&u!=null&&l!==u)throw new Q(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${s.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const r=Qt(e);let s=!0;for(const o of r)if(!(o instanceof zi)){s=!1;break}let i=!0;for(const o of r)if(o instanceof zi){i=!1;break}if(s===i)throw new Q("Arguments to apply() must be all SymbolicTensors or all Tensors");return il(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of Qt(e))o.push(a.shape);this.build(Mr(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let o=this.call(e,n);const a=Qt(o),l=[];for(let u of a)r.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(o=Mr(l),this.activityRegularizer!=null)throw new ht("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=wZ(e),a=this.computeOutputShape(o);let l;const u=CZ(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((c,h)=>new zi(u,c,this,Qt(e),n,this.name,h)):l=new zi(u,a,this,Qt(e),n,this.name),this.addInboundNode(e,l,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new ht("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,s)=>{r!=null&&e[s]!=null&&e[s]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Fi(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const r=JSON.stringify(n.outputShapes);e.indexOf(r)===-1&&e.push(r)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new Fi(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new js(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return tg(this.weights)}build(e){this.built=!0}getWeights(e=!1){return zx(e?this.trainableWeights:this.weights)}setWeights(e){pe(()=>{const n=this.weights;if(n.length!==e.length)throw new Q(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const r=[],s=zx(n);for(let i=0;i<s.length;++i){const o=s[i],a=n[i],l=e[i];if(!Nt(o.shape,l.shape))throw new Q(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);r.push([a,l])}LC(r)})}addWeight(e,n,r,s,i,o,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new Q(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(s=l!=null?l():on("zeros"));const u=s.apply(n,r),c=new vZ(u,r,e,o,a);return u.dispose(),i!=null&&this.addLoss(()=>i.apply(c.read())),o==null&&(o=!0),o?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Qt(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}addInboundNode(e,n,r,s,i,o,a=null){const l=Qt(e);n=Qt(n),r=Qt(r),s=Qt(s),i=eg(i),o=eg(o);const u=[],c=[],h=[];for(const d of l)u.push(d.sourceLayer),c.push(d.nodeIndex),h.push(d.tensorIndex);new Tv({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:h,inputTensors:l,outputTensors:n,inputMasks:r,outputMasks:s,inputShapes:i,outputShapes:o},a);for(let d=0;d<n.length;d++)n[d].sourceLayer=this,n[d].nodeIndex=this.inboundNodes.length-1,n[d].tensorIndex=d}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function wZ(t){t=Qt(t);const e=[];for(const n of t)e.push(n.shape);return Mr(e)}function CZ(t){return"float32"}function TO(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const r=e.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{const s=[];for(let i=0;i<r.inboundLayers.length;i++){const o=r.inputTensors[i],a=r.inboundLayers[i],l=r.nodeIndices[i],u=TO(o,a,l);for(const c of u)s.indexOf(c)===-1&&s.push(c)}return s}}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class qf extends gt{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:Ev("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new Q("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new Q("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new Q("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=e.dtype||"float32";this.batchInputShape=n,this.dtype=r,this.inputSpec=[{shape:n}];const s=new zi(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new Tv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new Q(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}qf.className="InputLayer";Ie(qf);function SZ(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new Q("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new qf({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kZ(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return Ve(e,t.dtype)}catch{throw new Q(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Yo{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Yo)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,r){if(this.id2Value[e.id]==null)this.id2Value[e.id]=kZ(e,n),this.name2Id[e.name]=e.id,r!=null&&(this.id2Mask[e.id]=r);else throw new Q(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof zi){if(this.id2Value[e.id]==null)throw new Q(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new Q(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof zi){if(this.id2Value[e.id]==null)throw new Q(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new Q(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&ft(this.id2Mask)}}const ng=new cO,rg=new cO;function EZ(t){ng!=null&&ng.setMaxEntries(t),rg!=null&&rg.setMaxEntries(t)}function fh(t,e,n,r){const s=n==null?!1:n.training,i=Array.isArray(t),o=i?t:[t],a=o.map(m=>m.name),l=[],u=e.names();for(const m of a)u.indexOf(m)!==-1?l.push(e.getValue(m)):l.push(null);r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const c=a.join(",")+"|"+e.names().sort().join(",");let h=ng.get(c),d;if(h==null){const m=IZ(o,e);h=m.sorted,d=m.recipientCounts,ng.put(c,h),rg.put(c,d)}d={},s||Object.assign(d,rg.get(c));const f=new Yo(e);for(let m=0;m<h.length;++m){if(r!=null){const T=Nx().numTensors;T>r.maxNumTensors&&(r.maxNumTensors=T),T<r.minNumTensors&&(r.minNumTensors=T)}const v=h[m],p=v.sourceLayer;if(p instanceof qf)continue;const g=[],y=[],b=[];let x=!1;for(const T of v.inputs){const _=f.getValue(T),A=f.getMask(T);g.push(_),y.push(A),A!=null&&(x=!0),s||(d[T.name]--,d[T.name]===0&&!e.hasKey(T)&&a.indexOf(T.name)===-1&&!_.isDisposed&&T.sourceLayer.stateful!==!0&&b.push(_))}x&&(n=n||{},n.mask=y[0]);const w=Qt(p.apply(g,n));let C=null;p.supportsMasking&&(C=p.computeMask(g,y));const S=_Z(v),E=Array.isArray(S)?S:[S];for(let T=0;T<E.length;++T){f.hasKey(E[T])||f.add(E[T],w[T],Array.isArray(C)?C[0]:C);const _=a.indexOf(E[T].name);_!==-1&&(l[_]=w[T])}s||ft(b)}return f.disposeMasks(),i?l:l[0]}function IZ(t,e){F(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(t.length===1){const s=AI(t[0],e);n=s.sorted,r=s.recipientMap}else{const s=new Set;for(const i of t){const{sorted:o,recipientMap:a}=AI(i,e);for(const l of o)s.has(l.name)||(n.push(l),s.add(l.name));for(const l in a)r[l]==null&&(r[l]=new Set),a[l].forEach(u=>r[l].add(u))}}return{sorted:n,recipientCounts:TZ(r)}}function TZ(t){const e={};for(const n in t)e[n]=t[n].size;return e}function AI(t,e){const n=new Set,r=[],s={};for(const a of e.names())n.add(a);const i=[],o=[];for(i.push(t);i.length>0;){const a=i[i.length-1];if(n.has(a.name)){i.pop();continue}const l=o[o.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),r.push(a),n.add(a.name),l&&o.pop();else{o.push(i.length-1);for(const u of a.inputs)s[u.name]==null&&(s[u.name]=new Set),s[u.name].add(a.name),!n.has(u.name)&&i.push(u)}}return{sorted:r,recipientMap:s}}function _Z(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let r=0;r<t.sourceLayer.inboundNodes.length;++r)for(const s of t.sourceLayer.inboundNodes[r].outputTensors)if(s.id===t.id){n=r;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NZ=me();NZ.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,EZ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function PC(t,e){return pe(()=>Nr(et(ee(t,t),e,!0)))}class Kf extends Ec{getConfig(){return{}}}class _O extends Kf{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return pe(()=>{const n=PC(e,this.axis),r=Cs(n,0,this.maxValue);return ee(e,nt(r,Ae(Vn(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}_O.className="MaxNorm";Ie(_O);class NO extends Kf{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return pe(()=>nt(e,Ae(Vn(),PC(e,this.axis))))}getConfig(){return{axis:this.axis}}}NO.className="UnitNorm";Ie(NO);class $O extends Kf{apply(e){return Wl(e)}}$O.className="NonNeg";Ie($O);class DO extends Kf{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return pe(()=>{const n=PC(e,this.axis),r=Ae(ee(this.rate,Cs(n,this.minValue,this.maxValue)),ee(1-this.rate,n));return ee(e,nt(r,Ae(Vn(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}DO.className="MinMaxNorm";Ie(DO);const RI={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Gn(t){return IC(t)}function OI(t,e={}){return Wf(t,zs.getMap().classNameMap,e,"constraint")}function jn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in RI?RI[t]:t,config:{}};return OI(n)}else return t instanceof Kf?t:OI(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Ba(t){if(t==null)return;const e=[],n=[],r=[];for(const s in t){const i=t[s];if(typeof i!="number"){const o=i;e.push(o.data()),n.push(s),r.push(o)}}if(e.length>0){const s=await Promise.all(e);for(let i=0;i<s.length;++i)t[n[i]]=s[i][0];ft(r)}}function AO(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var FI;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(FI||(FI={}));const $Z=125;class ld{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class DZ{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class AZ extends ld{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const r=n.size==null?0:n.size;this.seen+=r;for(const s in n){const i=n[s];if(typeof i=="number")this.totals.hasOwnProperty(s)||(this.totals[s]=0),this.totals[s]=this.totals[s]+i*r;else{let o;s in this.totals?o=this.totals[s]:this.totals[s]=0;const a=pe(()=>Ae(this.totals[s],ee(i,r)));this.totals[s]=a,o!=null&&o.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:pe(()=>{const s=ee(nt(1,this.seen),this.totals[r]);n[r]=s,this.totals[r].dispose(),qi(n[r])}))}}class RZ extends ld{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])}async syncData(){const e=[],n=[],r=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];e.push(l.data()),n.push(i),r.push(a)}}const s=await Promise.all(e);for(let i=0;i<s.length;++i)this.history[n[i]][r[i]].dispose(),this.history[n[i]][r[i]]=s[i][0]}}class OZ extends ld{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||PR,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=$Z),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");px(this.yieldEvery)&&(this.maybeWait=XY(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,r){const s=[];this.yield!=null&&(await Ba(r),s.push(this.yield(e,n,r))),s.push(this.nextFrameFunc()),await Promise.all(s)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await Ba(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const r=[];this.epochEnd!=null&&(await Ba(n),r.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(e,n){this.batchBegin!=null&&(await Ba(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const r=[];this.batchEnd!=null&&(await Ba(n),r.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):px(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(r)}async onTrainBegin(e){this.trainBegin!=null&&(await Ba(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Ba(e),await this.trainEnd(e))}}function RO(t,e){return t==null&&(t={}),t instanceof ld?[t]:Array.isArray(t)&&t[0]instanceof ld?t:Qt(t).map(r=>new OZ(r,e))}class Fs{constructor(){}static registerCallbackConstructor(e,n){F(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),Fs.checkForDuplicate(n),Fs.constructors[e]==null&&(Fs.constructors[e]=[]),Fs.constructors[e].push(n)}static checkForDuplicate(e){for(const n in Fs.constructors)Fs.constructors[+n].forEach(s=>{if(s===e)throw new Q("Duplicate callback constructor.")})}static clear(){Fs.constructors={}}static createCallbacks(e){const n=[];for(const r in Fs.constructors){const s=+r;e>=s&&n.push(...Fs.constructors[s])}return n.map(r=>new r)}}Fs.constructors={};function OO(t,e,n,r,s,i,o,a,l){const u=new RZ,c=[new AZ,...Fs.createCallbacks(e)];t!=null&&c.push(...t),c.push(u);const h=new DZ(c);return h.setParams({epochs:n,initialEpoch:r,samples:s,steps:i,batchSize:o,verbose:e,doValidation:a,metrics:l}),{callbackList:h,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zi(t,e={},n=!1){return Wf(t,zs.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sg(t,e){return pe(()=>{t.dtype!=="float32"&&(t=Ve(t,"float32"));const n=et(jf(t),e,!0),r=vv(n.shape,Vn()),s=Nr(Da(n,r));return nt(t,s)})}function _v(t,e){return pe(()=>On(jf(st(e,t)),-1))}function MC(t,e){return pe(()=>On(Sr(st(e,t)),-1))}function BC(t,e){return pe(()=>{const n=st(t,e),r=Cs(Sr(t),Vn(),Number.MAX_VALUE),s=Sr(nt(n,r));return ee(100,On(s,-1))})}function FZ(t,e){return pe(()=>{const n=Cs(e,Vn(),Number.MAX_VALUE),r=Ji(Ae(1,n)),s=Cs(t,Vn(),Number.MAX_VALUE),i=Ji(Ae(1,s));return On(jf(st(r,i)),-1)})}function LZ(t,e){return pe(()=>{const n=Da(0,st(1,ee(t,e)));return On(jf(n),-1)})}function PZ(t,e){return pe(()=>{const n=Da(0,st(1,ee(t,e)));return On(n,-1)})}function MZ(t,e){return pe(()=>{const n=et(ee(t,e),-1),r=yi(ee(st(1,t),e),-1);return Da(0,Ae(1,st(r,n)))})}function BZ(t,e){return pe(()=>{const n=Math.log(2),r=st(e,t),s=st(Ae(r,Lf(ee(-2,r))),n);return On(s,-1)})}function ud(t,e,n=!1){return pe(()=>{if(n)e=V2(e);else{const r=et(e,e.shape.length-1,!0);e=nt(e,r)}return e=Cs(e,Vn(),1-Vn()),bn(et(ee(Ve(t,"float32"),Ji(e)),e.shape.length-1))})}function ig(t,e,n=!1){return pe(()=>{const r=Ve(bv(aZ(t)),"int32");e=Cs(e,Vn(),1-Vn());const s=e.shape,i=ae(rR(r,s[s.length-1]),s);return ud(i,e,n)})}function zZ(t,e){if(!Nt(t.shape,e.shape))throw new Q(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return pe(()=>{const n=Wl(e),r=bn(Sr(e));return Ae(st(n,ee(e,t)),eR(So(r)))})}function Nv(t,e){return pe(()=>{let n;return n=Cs(e,Vn(),1-Vn()),n=Ji(nt(n,st(1,n))),On(zZ(t,n),-1)})}function UZ(t,e){return pe(()=>{const n=Cs(t,Vn(),1),r=Cs(e,Vn(),1);return et(ee(t,Ji(nt(n,r))),-1)})}function VZ(t,e){return pe(()=>{const n=Ji(Ae(Vn(),e));return On(st(e,ee(t,n)),-1)})}function FO(t,e){return pe(()=>{const n=sg(t,-1),r=sg(e,-1),s=ee(n,r);return bn(et(s,-1))})}const og={meanSquaredError:_v,meanAbsoluteError:MC,meanAbsolutePercentageError:BC,meanSquaredLogarithmicError:FZ,squaredHinge:LZ,hinge:PZ,categoricalHinge:MZ,logcosh:BZ,categoricalCrossentropy:ud,sparseCategoricalCrossentropy:ig,binaryCrossentropy:Nv,kullbackLeiblerDivergence:UZ,poisson:VZ,cosineProximity:FO};function qy(t){if(typeof t=="string"){if(t in og)return og[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new Q(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function LO(t,e){return pe(()=>{const n=ee(.5,Zs(e)),r=Xi(Es(e,n),t.dtype);return On(Qi(t,r),-1)})}function PO(t,e){return pe(()=>Xi(Qi(rd(t,-1),rd(e,-1)),"float32"))}function WZ(t,e){return pe(()=>Ve(et(ko(Qi(t,1),Qi(e,1))),"float32"))}function GZ(t,e){return pe(()=>Ve(et(ko(Qi(t,0),Qi(e,1))),"float32"))}function jZ(t,e){return pe(()=>{const n=WZ(t,e),r=GZ(t,e),s=Ae(n,r);return Ve(Tr(Es(s,0),nt(n,s),0),"float32")})}function HZ(t,e){return Nv(t,e)}function qZ(t,e){return t.rank===e.rank&&(t=Mf(t,[t.rank-1])),e=rd(e,-1),e.dtype!==t.dtype&&(e=Ve(e,t.dtype)),Ve(Qi(t,e),"float32")}const KZ=_v,XZ=_v,YZ=MC,ZZ=MC,QZ=BC,JZ=BC,MO=ud,eQ=FO,BO=ig,ag={binaryAccuracy:LO,categoricalAccuracy:PO,precision:jZ,categoricalCrossentropy:MO,sparseCategoricalCrossentropy:BO,mse:KZ,MSE:XZ,mae:YZ,MAE:ZZ,mape:QZ,MAPE:JZ,cosine:eQ};function tQ(t){if(typeof t=="string"&&t in ag)return ag[t];if(typeof t!="string"&&t!=null)return t;throw new Q(`Unknown metric ${t}`)}function Op(t){if(Li(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(og))if(og[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(ag))if(ag[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nQ(t){const e={Adagrad:()=>lu.adagrad(.01),Adadelta:()=>lu.adadelta(1,.95,Vn()),Adam:()=>lu.adam(.001,.9,.999,Vn()),Adamax:()=>lu.adamax(.002,.9,.999,Vn(),0),RMSProp:()=>lu.rmsprop(.001,.9,0,Vn()),SGD:()=>lu.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new Q(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const LI=1*1024*1024;function PI(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!Ux(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const r=JSON.stringify(t);r.length>LI&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${LI}.`)}}function Ux(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!Ux(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!Ux(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rQ(t,e,n,r=console.log){const s=iQ(t),i=["Layer (type)","Input Shape","Output shape","Param #"];s?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(c=>Math.floor(e*c)));let o;if(!s){i.push("Receives inputs"),o=[];for(const c in t.nodesByDepth)o.push(...t.nodesByDepth[c])}r("_".repeat(e)),lg(i,n,r),r("=".repeat(e));const a=t.layers;for(let c=0;c<a.length;++c)s?oQ(a[c],n,r):aQ(a[c],n,o,r),r((c===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=sQ(t),u=tg(t.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(e))}function sQ(t){let e;return t.collectedTrainableWeights!=null?e=tg(t.collectedTrainableWeights):e=tg(t.trainableWeights),e}function iQ(t){let e=!0;const n=[],r=[];for(const s in t.nodesByDepth)n.push(t.nodesByDepth[s]);for(const s of n){if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){e=!1;break}r.push(...s)}if(e)for(const s of t.layers){let i=!1;for(const o of s.inboundNodes)if(r.indexOf(o)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function lg(t,e,n=console.log){let r="";for(let s=0;s<t.length;++s)s>0&&(r=r.slice(0,r.length-1)+" "),r+=t[s],r=r.slice(0,e[s]),r+=" ".repeat(e[s]-r.length);n(r)}function oQ(t,e,n){let r,s;try{s=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{s="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const i=t.name,o=t.getClassName(),a=[`${i} (${o})`,s,r,t.countParams().toString()];lg(a,e,n)}function aQ(t,e,n,r){let s,i;try{i=t.inboundNodes.map(h=>JSON.stringify(h.inputShapes)).join(",")}catch{i="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const o=[];for(const h of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(h)===-1))for(let d=0;d<h.inboundLayers.length;++d){const f=h.inboundLayers[d].name,m=h.nodeIndices[d],v=h.tensorIndices[d];o.push(`${f}[${m}][${v}]`)}const a=t.name,l=t.getClassName(),u=o.length===0?"":o[0],c=[`${a} (${l})`,i,s,t.countParams().toString(),u];lg(c,e,r);for(let h=1;h<o.length;++h)lg(["","","","",o[h]],e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zO(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function ug(t,e){if(t===null)return null;if(typeof t=="string")return qa(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const i=t[s];zO(e,s,i)?n.push(i):n.push(ug(i,e))}return n}else{const n={};for(const r of Object.keys(t)){const s=t[r];if(r==="name"&&typeof s=="string")n[r]=s;else{const i=qa(r);n[i]=ug(s,i)}}return n}}function Vx(t,e){if(t==null)return null;if(typeof t=="string")return uo(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const i=t[s];zO(e,s,i)?n.push(i):n.push(Vx(i,e))}return n}else{const n={};for(const r of Object.keys(t)){const s=t[r],i=uo(r);(r==="name"||r==="className")&&typeof s=="string"?n[i]=s:n[i]=Vx(s,r)}return n}}/** @license See the LICENSE file. */const UO="4.10.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class oi extends gt{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const y=this.getClassName().toLowerCase();this.name=Ev(y)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],ca(this.inputs).length!==this.inputs.length)throw new Q(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(y=>y.name)}`);ca(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(y=>y.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const b=y.sourceLayer,x=y.nodeIndex,w=y.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(x),this.outputLayersTensorIndices.push(w)}for(const y of this.inputs){const b=y.sourceLayer,x=y.nodeIndex,w=y.tensorIndex;Li(x===0,"input layer has >1 nodes"),Li(w===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(x),this.inputLayersTensorIndices.push(w)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const b=this.inputLayers[y];if(!(b instanceof qf))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${y} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(y=>y.shape),this.internalOutputShapes=this.outputs.map(y=>y.shape);const n={},r={},s={},i={},o={},a=[],l=(y,b,x,w,C,S)=>{(w==null||C==null||S==null)&&(w=y.sourceLayer,C=y.nodeIndex,S=y.tensorIndex);const E=w.inboundNodes[C];if(x.indexOf(E)!==-1)throw new js(`The tensor ${y.name} at layer "${w.name}" is part of a cycle.`);if(b.indexOf(E)!==-1)return;this.containerNodes.add(oi.nodeKey(w,C)),w.id in o||(o[w.id]=Object.keys(o).length),x.indexOf(E)===-1&&x.push(E);const T=E.inboundLayers.length;for(let _=0;_<T;_++){const A=E.inputTensors[_],L=E.inboundLayers[_],W=E.nodeIndices[_],K=E.tensorIndices[_];l(A,b,x,L,W,K)}for(b.push(E);x.indexOf(E)>=0;)x.splice(x.indexOf(E),1);a.push(E)},u=[],c=[];for(const y of this.outputs)l(y,u,c);const h=a.slice().reverse();for(const y of h){r[y.id]=y,y.id in n||(n[y.id]=0);let b=n[y.id];const x=s[y.outboundLayer.id]==null?0:s[y.outboundLayer.id];b=Math.max(b,x),s[y.outboundLayer.id]=b,i[y.outboundLayer.id]=y.outboundLayer,n[y.id]=b;for(let w=0;w<y.inboundLayers.length;w++){const C=y.inboundLayers[w],S=y.nodeIndices[w],E=C.inboundNodes[S],T=n[E.id]==null?0:n[E.id];n[E.id]=Math.max(b+1,T),r[E.id]=E}}const d={};for(const y in n){const b=n[y];b in d||(d[b]=[]),d[b].push(r[y])}const f={};for(const y in s){const b=s[y];b in f||(f[b]=[]),f[b].push(i[y])}let m=Object.keys(f).map(y=>parseInt(y,10)).sort(Dp);this.layers=[];for(const y of m){const b=f[y];b.sort((x,w)=>{const C=o[x.id],S=o[w.id];return C<S?-1:C>S?1:0});for(const x of b)x instanceof oi&&this.internalContainerRefs.push(x),this.layers.push(x)}this.layersByDepth=f,m=Object.keys(d).map(y=>parseInt(y,10)).sort(Dp);const v=this.inputs.slice(),p=[];for(const y of m)for(const b of d[y]){const x=b.outboundLayer;if(x!=null){for(const w of b.inputTensors)if(v.indexOf(w)===-1)throw new js(`Graph disconnected: cannot obtain value for tensor ${w} at layer "${x.name}". The following previous layers were accessed without issue: ${p}`);for(const w of b.outputTensors)v.push(w);p.push(x.name)}}this.nodesByDepth=d;const g=this.layers.map(y=>y.name);for(const y of g){const b=g.filter(x=>x===y).length;if(b!==1)throw new js(`The name "${y}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new Tv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(y=>null),outputMasks:this.outputs.map(y=>null),inputShapes:this.inputs.map(y=>y.shape),outputShapes:this.outputs.map(y=>y.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new Q("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.layers)n.push(...r.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const r={};let s=0;const i=Object.keys(e)[0].split("/"),o=!isNaN(parseInt(i[i.length-1],10));for(const l of this.layers)for(const[u,c]of l.weights.entries()){const h=o?`${c.name.split("/").slice(0,-1).join("/")+"/"}${u}`:c.originalName;if(r[h]!=null)throw new Q(`Duplicate weight name: ${h}`);r[h]=c,s++}const a=[];for(const l in e){let u=l;if(r[l]==null){const c=l.split("/");u=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(r[u]!=null)a.push([r[u],e[l]]);else if(n)throw new Q(`Provided weight data has no target variable: ${l}`);delete r[u]}if(n){const l=[];for(const u in r)l.push(u);if(l.length>0)throw new Q(`${l.length} of ${s} weights are not set: ${l}`)}LC(a)}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${UO}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const r=Vx(this.updatedConfig());return n?JSON.stringify(r):r}call(e,n){return pe(()=>{e=Qt(e);const r=new Yo;for(let s=0;s<this.inputs.length;++s)r.add(this.inputs[s],e[s]);return fh(this.outputs,r,n)})}computeMask(e,n){return pe(()=>{e=Qt(e);let r;return n==null?r=Il(null,e.length):r=Qt(n),this.runInternalGraph(e,r)[1]})}computeOutputShape(e){const n=eg(e);if(n.length!==this.inputLayers.length)throw new Q(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],u=n[a],c=l.name+"_0_0";r[c]=u}const s=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(Dp);if(s.length>1)for(const a of s){const l=this.nodesByDepth[a];for(const u of l){const c=u.outboundLayer;if(this.inputLayers.map(v=>v.id).indexOf(c.id)!==-1)continue;const h=[];for(let v=0;v<u.inboundLayers.length;v++){const p=u.inboundLayers[v],g=u.nodeIndices[v],y=u.tensorIndices[v],b=`${p.name}_${g}_${y}`,x=r[b];h.push(x)}const d=c.computeOutputShape(Mr(h)),f=eg(d),m=c.inboundNodes.indexOf(u);for(let v=0;v<f.length;v++){const p=`${c.name}_${m}_${v}`;r[p]=f[v]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],u=this.outputLayersNodeIndices[a],c=this.outputLayersTensorIndices[a],h=`${l.name}_${u}_${c}`;o.push(h)}for(let a=0;a<o.length;a++){const l=o[a];Li(l in r),i.push(r[l])}return Mr(i)}runInternalGraph(e,n){n==null&&(n=Il(null,e.length));const r={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],c=e[l],h=n[l];r[u.id]=[c,h]}const s=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Dp);for(const l of s){const u=this.nodesByDepth[l];for(const c of u){const h=c.outboundLayer,d=c.inputTensors,f=c.outputTensors,m=new Array;for(const v of d)v.id in r&&m.push(r[v.id]);if(m.length===d.length){let v={},p,g,y,b;if(c.callArgs!=null&&(v=c.callArgs),m.length===1){const[x,w]=m[0];v.mask==null&&(v.mask=w),y=Qt(h.call(x,v)),b=Qt(h.computeMask(x,w)),p=[x],g=[w]}else p=m.map(x=>x[0]),g=m.map(x=>x[1]),v.mask==null&&(v.mask=g),y=Qt(h.call(p,v)),b=Qt(h.computeMask(p,g));if(h.activityRegularizer)throw new ht("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let x=0;x<f.length;++x){const w=f[x],C=y[x],S=b[x];r[w.id]=[C,S]}}}}const i=[],o=[],a=[];for(const l of this.outputs){Li(l.id in r,`Could not compute output ${l.name} : ${l.id}`);const[u,c]=r[l.id];a.push(u.shape),i.push(u),o.push(c)}return[i,o,a]}buildNodeConversionMap(e){const n={};let r;for(const s of this.layers){r=s instanceof oi?1:0;for(let i=0;i<s.inboundNodes.length;i++){const o=oi.nodeKey(s,i);this.containerNodes.has(o)&&(n[o]=r,r+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new Q("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const r of this.layers)if(r.name===e)return r;throw new Q(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new Q(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return pe(()=>{const e=[];for(const n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){const s=oi.nodeKey(n,r);this.containerNodes.has(s)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),u=[];for(let h=0;h<o.inboundNodes.length;h++){const d=o.inboundNodes[h],f=oi.nodeKey(o,h);let m={};if(this.containerNodes.has(f)){if(d.callArgs)try{JSON.stringify(d.callArgs),m=d.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${d.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),m={}}if(d.inboundLayers.length>0){const v=[];for(let p=0;p<d.inboundLayers.length;p++){const g=d.inboundLayers[p],y=d.nodeIndices[p],b=d.tensorIndices[p],x=oi.nodeKey(g,y);let w=n[x];w==null&&(w=0),v.push([g.name,w,b,m])}u.push(v)}}}const c={};c.name=o.name,c.className=a,c.config=l,c.inboundNodes=u,r.push(c)}e.layers=r;const s=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],u=oi.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const h=this.inputLayersTensorIndices[o];s.push([a.name,c,h])}e.inputLayers=s;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],u=oi.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const h=this.outputLayersTensorIndices[o];i.push([a.name,c,h])}return e.outputLayers=i,e}static fromConfig(e,n,r={},s=!1){const i={},o={};function a(p,g){p.name in o?o[p.name].push(g):o[p.name]=[g]}function l(p,g){const y=[];let b;for(const x of g){const w=x[0],C=x[1],S=x[2];if(b=x[3]==null?{}:x[3],!(w in i)){a(p,g);return}const E=i[w];if(E.inboundNodes.length<=C){a(p,g);return}const T=E.inboundNodes[C];y.push(T.outputTensors[S])}y.length>0&&p.apply(Mr(y),b)}function u(p){const g=p.name,y=Zi(p,n.customObjects!=null?n.customObjects:{});y.setFastWeightInitDuringBuild(s),i[g]=y,p.inboundNodes.forEach(x=>{if(!(x instanceof Array))throw new Q(`Corrupted configuration, expected array for nodeData: ${x}`);a(y,x)})}const c=n.name,h=n.layers;for(const p of h)u(p);for(;!KY(o);)for(const p of h){const g=i[p.name];if(g.name in o){const y=o[g.name];delete o[g.name];for(const b of y)l(g,b)}}const d=[],f=[],m=n.inputLayers;for(const p of m){const g=p[0],y=p[1],b=p[2];Li(g in i);const w=i[g].inboundNodes[y].outputTensors;d.push(w[b])}const v=n.outputLayers;for(const p of v){const g=p[0],y=p[1],b=p[2];Li(g in i);const w=i[g].inboundNodes[y].outputTensors;f.push(w[b])}return new e({inputs:d,outputs:f,name:c})}get stateful(){if(this._stateful)throw new Q("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){pe(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lQ(t,e,n){const r=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>null);if(r===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const s=[];return e.forEach(i=>{i in t?s.push(t[i]):s.push(null)}),s}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function VO(t,e){return lQ(t,e,"classWeight")}async function WO(t,e,n,r){if(e!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){const s=pe(()=>{if(t.shape.length===1)return sl(t);if(t.shape.length===2){if(t.shape[1]>1)return rd(t,1);if(t.shape[1]===1)return ae(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await s.data());ft(s);const o=[];return i.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),es(o,"float32")}else return null}function uQ(t,e){return ee(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const cQ=32;function GO(t,e){let n,r;const s=e;n=s.xs,r=s.ys,F(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=MI("input",t.inputNames,n),o=MI("output",t.outputNames,r),a=i[0].shape[0];F(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),F(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<i.length;l++)F(i[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<o.length;l++)F(o[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:i,ys:o}}function MI(t,e,n){if(n instanceof Rn)return[n];if(Array.isArray(n))return F(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const r=[];for(const s of e){if(n[s]==null)throw new Q(`The feature data generated by the dataset lacks the required ${t} key '${s}'.`);r.push(n[s])}return r}}function hQ(t){if(t.length===3)throw new ht("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function dQ(t,e,n){const r=n.batchesPerEpoch!=null;if(F(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),F(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),F(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),F(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),F(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const s=n.validationData!=null;let i,o;if(s)if(BI(n.validationData))F(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const p=hQ(n.validationData);i=p.xs,o=p.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let u;s?u=l.slice().concat(l.map(p=>"val_"+p)):u=l.slice();const c=RO(n.callbacks,n.yieldEvery),h=n.verbose==null?1:n.verbose,{callbackList:d,history:f}=OO(c,h,n.epochs,null,null,fQ(e,n),null,s,u);d.setModel(t),t.history=f,await d.onTrainBegin(),t.stopTraining_=!1;let m=n.initialEpoch==null?0:n.initialEpoch,v=await e.iterator();for(;m<n.epochs;){const p={};await d.onEpochBegin(m);let g=0,y=0;for(r||(v=await e.iterator());!r||g<n.batchesPerEpoch;){const b=await v.next();if(r&&b.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${g} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(b.value!=null){const{xs:x,ys:w}=GO(t,b.value),C={};C.batch=y,C.size=x[0].shape[0],await d.onBatchBegin(y,C);const S=[];if(n.classWeight!=null){const _=VO(n.classWeight,t.outputNames);for(let A=0;A<_.length;++A)S.push(await WO(w[A],null,_[A]))}const E=x.concat(w).concat(S),T=a(E);ft(E);for(let _=0;_<l.length;++_){const A=l[_],L=T[_];C[A]=L,qi(L)}await d.onBatchEnd(y,C),AO(C),y++,g++}if(r?g>=n.batchesPerEpoch:b.done){if(s){let x;BI(n.validationData)?x=Qt(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):x=Qt(t.evaluate(i,o,{batchSize:n.validationBatchSize==null?cQ:n.validationBatchSize,verbose:0}));for(let w=0;w<t.metricsNames.length;++w)p[`val_${t.metricsNames[w]}`]=x[w]}break}if(t.stopTraining_)break}if(await d.onEpochEnd(m,p),m++,t.stopTraining_)break}return await d.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function fQ(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function BI(t){return typeof t.iterator=="function"}function pQ(t){return typeof t.next=="function"}async function mQ(t,e,n){n=n||{};const r=n.batches!=null,s=t.testFunction;let i=[];if(n.verbose>0)throw new ht("Verbose mode is not implemented yet.");F(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=pQ(e)?e:await e.iterator();let a=0,l=0;for(;!r||l<n.batches;){const u=await o.next();if(i=pe(()=>{if(u.value){const{xs:c,ys:h}=GO(t,u.value),d=c.concat(h),f=pe(()=>s(d));if(ft(d),l===0)for(let v=0;v<f.length;++v)i.push(At(0));const m=d[0].shape[0];for(let v=0;v<f.length;++v){const p=f[v],g=i[v];i[v]=pe(()=>Ae(i[v],ee(m,p))),l>0&&ft(g)}ft(f),a+=m,++l}return i}),u.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<i.length;++u){const c=i[u];i[u]=nt(i[u],a),ft(c)}return Mr(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ky(t){F(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function ih(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(r=>ol(r,e,n-e)):ol(t,e,n-e)}function Wx(t,e){return pe(()=>t==null?null:Array.isArray(t)?t.map(n=>Wx(n,e)):yO(t,e.dtype==="int32"?e:Ve(e,"int32")))}function Xy(t,e){const n=[];let r=0,s=null;for(;r<t;)s=r+e,s>=t&&(s=t),n.push([r,s]),r=s;return n}function jO(t){const e=[];t instanceof Rn&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(r.rank===1)e.push(Gf(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function ii(t,e){if(t==null)return;const n=[];if(e instanceof Rn)n.push(e.id);else if(Array.isArray(e))e.forEach(s=>n.push(s.id));else if(e!=null)for(const s in e){const i=e[s];n.push(i.id)}const r=[];if(t instanceof Rn)n.indexOf(t.id)===-1&&r.push(t);else if(Array.isArray(t))t.forEach(s=>{n.indexOf(s.id)===-1&&r.push(s)});else if(t!=null)for(const s in t){const i=t[s];n.indexOf(i.id)===-1&&r.push(i)}r.forEach(s=>{s.isDisposed||s.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gQ(t){return t instanceof Rn}function Gx(t){return Array.isArray(t)}function zI(t){return!gQ(t)&&!Gx(t)}function UI(t,e,n,r=!0,s=""){if(e==null||e.length===0){if(t!=null){let o=!1;if(Gx(t)&&t.length>0)o=!0;else if(zI(t)){for(const a in t)if(t.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new Q(`Error when checking model ${s} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(o=>null);let i;if(zI(t)){t=t,i=[];for(const o of e){if(t[o]==null)throw new Q(`No data provided for "${o}". Need data for each key in: ${e}`);i.push(t[o])}}else if(Gx(t)){if(t=t,t.length!==e.length)throw new Q(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);i=t}else{if(t=t,e.length>1)throw new Q(`The model ${s} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);i=[t]}if(i=jO(i),n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new Q(`Error when checking ${s}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[o].length;++l){if(l===0&&!r)continue;const u=a.shape[l],c=n[o][l];if(c!=null&&c>=0&&u!==c)throw new Q(`${s} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${s} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function vQ(t,e,n){const r=ca(t.map(i=>i.shape[0]));r.sort();const s=ca(e.map(i=>i.shape[0]));if(s.sort(),r.length>1)throw new Q(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(s.length>1)throw new Q(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(r.length>0&&s.length>0&&!Nt(r,s))throw new Q(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${s[0]} target sample(s).`)}function yQ(t,e,n){const r=[_v,Nv,ud];for(let s=0;s<t.length;++s){const i=t[s],o=e[s],a=n[s];if(o!=null){if(o===ud&&i.shape[i.shape.length-1]===1)throw new Q(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(o)!==-1){const l=i.shape.slice(1),u=a.slice(1);for(let c=0;c<l.length;++c){const h=l[c],d=u[c];if(d!=null&&h!==d)throw new Q(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function VI(t,e,n,r=!0,s=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new Q(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new Q(`The model expects ${e.length} ${s} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);i=[t]}if(n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new Q(`Error when checking ${s}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[o].length;++l){if(l===0&&!r)continue;const u=a.shape[l],c=n[o][l];if(c!=null&&c!==u)throw new Q(`Error when checking ${s}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function xQ(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(r=>n);{const r=[];for(const s of e){let i=n.hasOwnProperty(s)?n[s]:[];Array.isArray(i)||(i=[i]),r.push(i)}return r}}const bQ="layers-model";class zu extends oi{constructor(e){super(e),this.isTraining=!1}summary(e,n,r=console.log){if(!this.built)throw new Q("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");rQ(this,e,n,r)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=nQ(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Aa))throw new Q("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new Q(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(qy(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new Q(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>qy(a))}else{const o=qy(e.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const r=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],il("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const s=xQ(e.metrics,this.outputNames),i=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};il("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=s[o];(u=>{const c="";let h,d,f;for(const m of u){if(typeof m=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(m)!==-1){const p=this.internalOutputShapes[o];p[p.length-1]===1||this.lossFunctions[o]===Nv?["accuracy","acc"].indexOf(m)!==-1?d=LO:["crossentropy","ce"].indexOf(m)!==-1&&(d=HZ):this.lossFunctions[o]===ig?["accuracy","acc"].indexOf(m)!==-1?d=qZ:["crossentropy","ce"].indexOf(m)!==-1&&(d=BO):["accuracy","acc"].indexOf(m)!==-1?d=PO:["crossentropy","ce"].indexOf(m)!==-1&&(d=MO);let g;["accuracy","acc"].indexOf(m)!==-1?g="acc":["crossentropy","ce"].indexOf(m)!==-1&&(g="ce"),f=d,h=c+g}else f=tQ(m),h=c+Op(m);let v;il(h,()=>{v=f}),i(o,h,v)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,r={}){const s=r.batchSize==null?32:r.batchSize;Ky(s);const i=!0,o=this.standardizeUserDataXY(e,n,i,s);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,a,s,r.verbose,r.steps);return Mr(u)}finally{ii(o[0],e),ii(o[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),mQ(this,e,n)}checkNumSamples(e,n,r,s="steps"){let i;if(r!=null){if(i=null,n!=null)throw new Q(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new Q(`Either the input data should have a defined shape, or ${s} shoud be specified.`);return i}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new Q("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(n),s=r?n:[n],i=this.retrieveSymbolicTensors(s),o=new Yo;if(e instanceof Rn&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new Q(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],e[l])}else for(const l of this.inputs){const u=e[l.name];if(u==null)throw new Q(`No value is provided for the model's input ${l.name}`);o.add(l,u)}const a=fh(i,o);return r?a:a[0]}retrieveSymbolicTensors(e){const n=Il(null,e.length);let r=e.length;for(const s of this.layers){const i=Array.isArray(s.output)?s.output:[s.output],o=i.map(a=>a.name);for(let a=0;a<e.length;++a){const l=o.indexOf(e[a]);if(l!==-1&&(n[a]=i[l],r--),r===0)break}if(r===0)break}if(r>0){const s=[];throw n.forEach((i,o)=>{i==null&&s.push(e[o])}),new Q(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return n}predictLoop(e,n=32,r=!1){return pe(()=>{const s=this.checkNumSamples(e);if(r)throw new ht("Verbose predictLoop() is not implemented yet.");const i=Xy(s,n),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)pe(()=>{const u=i[a][0],c=i[a][1],h=ih(e,u,c),d=[];if(Array.isArray(h))for(let m=0;m<h.length;++m)d.push({key:this.inputs[m],value:h[m]});else d.push({key:this.inputs[0],value:h});const f=new Yo(d);return fh(this.outputs,f)}).forEach((u,c)=>o[c].push(u));return Mr(o.map(a=>zr(a,0)))})}predict(e,n={}){const r=jO(e);VI(r,this.inputNames,this.feedInputShapes,!1);try{const s=n.batchSize==null?32:n.batchSize;return Ky(s),this.predictLoop(r,s)}finally{ii(r,e)}}predictOnBatch(e){VI(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,r=!0,s){if(this.optimizer_==null)throw new js("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===ig?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=UI(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=UI(n,this.feedOutputNames,i,!1,"target"),vQ(e,n),yQ(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&s!=null&&s>0&&e[0].shape[0]%s!==0)throw new Q(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,r,s,i=!0,o){const[a,l]=this.standardizeUserDataXY(e,n,i,o);if(r!=null)throw new Error("sample weight is not supported yet.");let u=null;if(s!=null){const c=VO(s,this.outputNames);u=[];for(let h=0;h<c.length;++h)u.push(await WO(l[h],null,c[h]))}return[a,l,u]}testLoop(e,n,r,s=0,i){return pe(()=>{const o=this.checkNumSamples(n,r,i,"steps"),a=[];if(s>0)throw new ht("Verbose mode is not implemented yet.");if(i!=null)throw new ht("steps mode in testLoop() is not implemented yet");{const l=Xy(o,r),u=es(wi(0,o));for(let c=0;c<l.length;++c){const h=l[c][0],d=l[c][1],f=ol(u,h,d-h),m=Wx(n,f),v=e(m);if(c===0)for(let p=0;p<v.length;++p)a.push(At(0));for(let p=0;p<v.length;++p){const g=v[p];a[p]=Ae(a[p],ee(d-h,g))}}for(let c=0;c<a.length;++c)a[c]=nt(a[c],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let r=0;r<e.length;++r){const s=e[r];let i=s;if(II(e,s)>1){const o=II(e.slice(0,r),s);i+=`_${o}`}n.push(i)}return n}makeTrainFunction(){return e=>{const n=[],r=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const h=[];for(let v=0;v<this.inputs.length;++v)h.push({key:this.inputs[v],value:r[v]});const d=new Yo(h),f=fh(this.outputs,d,{training:!0});let m;for(let v=0;v<this.lossFunctions.length;++v){const p=this.lossFunctions[v];let g=p(s[v],f[v]);i[v]!=null&&(g=uQ(g,i[v]));const y=On(g);n.push(y),v===0?m=g:m=Ae(m,g)}for(let v=0;v<this.metricsTensors.length;++v){let p;if(this.outputs.length>1&&v<this.outputs.length)p=n[v];else{const g=this.metricsTensors[v][0],y=this.metricsTensors[v][1];p=On(g(s[y],f[y]))}qi(p),o.push(p)}return m=On(m),this.calculateLosses().forEach(v=>{m=Ae(m,v)}),m},l=this.collectedTrainableWeights.map(h=>h.read()),u=!0;return[this.optimizer_.minimize(a,u,l)].concat(o)}}makeTestFunction(){this.testFunction=e=>pe(()=>{const n=[];let r;const s=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let u=0;u<this.inputs.length;++u)o.push({key:this.inputs[u],value:s[u]});const a=new Yo(o),l=fh(this.outputs,a);for(let u=0;u<this.lossFunctions.length;++u){const c=this.lossFunctions[u],h=On(c(i[u],l[u]));u===0?r=h:r=Ae(r,h),n.push(r)}for(let u=0;u<this.metricsTensors.length;++u){const c=this.metricsTensors[u][0],h=this.metricsTensors[u][1],d=On(c(i[h],l[h]));n.push(d)}return n})}async fit(e,n,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let s,i,o,a,l,u,c,h,d;try{const f=r.batchSize==null?32:r.batchSize;Ky(f);const m=!1,v=await this.standardizeUserData(e,n,r.sampleWeight,r.classWeight,m,f);s=v[0],i=v[1],d=v[2];let p=!1,g;if(r.validationData!=null&&r.validationData.length>0){if(p=!0,r.validationData.length===2)l=r.validationData[0],u=r.validationData[1];else throw r.validationData.length===3?new ht("validationData including sample weights is not supported yet."):new Q(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const T=!0,_=await this.standardizeUserData(l,u,null,null,T,f);c=_[0],h=_[1],g=c.concat(h)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){p=!0;const T=Math.floor(s[0].shape[0]*(1-r.validationSplit)),_=s[0].shape[0];c=ih(s,T,_),o=s,s=ih(s,0,T),h=ih(i,T,_),a=i,i=ih(i,0,T),g=c.concat(h)}else r.validationSteps!=null&&(p=!0);const y=s.concat(i).concat(d);this.checkTrainableWeightsConsistency();const b=this.makeTrainFunction(),x=this.getDedupedMetricsNames();let w,C;p?(this.makeTestFunction(),w=this.testFunction,C=x.slice().concat(x.map(T=>"val_"+T))):(w=null,g=[],C=x.slice());const S=RO(r.callbacks,r.yieldEvery);return await this.fitLoop(b,y,x,f,r.epochs,r.verbose,S,w,g,r.shuffle,C,r.initialEpoch,null,null)}finally{this.isTraining=!1,ii(s,e),ii(i,n),ii(o,e),ii(a,n),ii(c,l),ii(h,u),d!=null&&ft(d)}}async fitLoop(e,n,r,s,i,o,a,l,u,c,h,d,f,m){s==null&&(s=32),i==null&&(i=1),c==null&&(c=!0),d==null&&(d=0);let v=!1;if(l!=null&&u!=null&&(v=!0),m!=null&&(v=!0,f==null))throw new Q("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const p=this.checkNumSamples(n,s,f,"steps_per_epoch");let g;p!=null&&(g=wi(0,p)),o==null&&(o=1);const{callbackList:y,history:b}=OO(a,o,i,d,p,f,s,v,h);y.setModel(this),this.history=b,await y.onTrainBegin(),this.stopTraining_=!1;for(let x=d;x<i;++x){await y.onEpochBegin(x);const w={};if(f!=null)throw new ht("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new ht("batch shuffling is not implemneted yet");c&&j5(g);const C=es(g),S=Xy(p,s);for(let E=0;E<S.length;++E){const T={};if(await y.onBatchBegin(E,T),pe(()=>{const _=S[E][0],A=S[E][1],L=ol(C,_,A-_);T.batch=E,T.size=A-_;const W=Wx(n,L),K=e(W);for(let R=0;R<r.length;++R){const M=r[R],U=K[R];T[M]=U,qi(U)}if(E===S.length-1&&v){const R=this.testLoop(l,u,s);for(let M=0;M<r.length;++M){const U=r[M],D=R[M];qi(D),w["val_"+U]=D}}}),await y.onBatchEnd(E,T),AO(T),this.stopTraining_)break}C.dispose()}if(await y.onEpochEnd(x,w),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return dQ(this,e,n)}async trainOnBatch(e,n){const r=await this.standardizeUserData(e,n),s=r[0],i=r[1],a=this.makeTrainFunction()(s.concat(i)),l=[];for(const u of a){const c=await u.data();l.push(c[0])}return ft(a),ii(r[0],e),ii(r[1],n),Mr(l)}getNamedWeights(e){const n=[],r=e!=null&&e.trainableOnly,s=r?this.trainableWeights:this.weights,i=this.getWeights(r);for(let o=0;o<s.length;++o)r&&!s[o].trainable||n.push({name:s[o].originalName,tensor:i[o]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=Nx().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-Nx().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=uo(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>uo(n))}else{const n=Object.keys(this.loss);e={};const r=this.loss;for(const s of n)if(typeof r[s]=="string")e[s]=uo(r[s]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[uo(Op(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>uo(Op(e)));{const e={};for(const n in this.metrics)e[n]=uo(Op(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=ug(e.optimizer_config),r=Zi(n);let s;if(typeof e.loss=="string")s=qa(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(o=>qa(o));else if(e.loss!=null){s={};for(const o in e.loss)s[o]=qa(e.loss[o])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(o=>qa(o));else if(e.metrics!=null){i={};for(const o in e.metrics)i[o]=qa(e.metrics[o])}this.compile({loss:s,metrics:i,optimizer:r})}async save(e,n){if(typeof e=="string"){const u=KG(e);if(u.length===0)throw new Q(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new Q(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new Q("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await lI(this.getNamedWeights(n)),s=!1,i=null,a={modelTopology:this.toJSON(i,s),format:bQ,generatedBy:`TensorFlow.js tfjs-layers v${UO}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:c,specs:h}=await lI(await this.optimizer.getWeights(),u);r.specs.push(...h),r.data=BG([r.data,c])}return this.userDefinedMetadata!=null&&(PI(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=r.data,a.weightSpecs=r.specs,e.save(a)}setUserDefinedMetadata(e){PI(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}zu.className="Model";Ie(zu);class HO extends zu{}HO.className="Functional";Ie(HO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function wQ(t,e){if(e==null&&(e={}),typeof t=="string"){const n=XG(t,e);if(n.length===0)n.push(DK(t,e));else if(n.length>1)throw new Q(`Found more than one (${n.length}) load handlers for URL '${t}'`);t=n[0]}return CQ(t,void 0,e)}async function CQ(t,e,n){if(n==null&&(n={}),t.load==null)throw new Q("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const r=await t.load();let s=r.modelTopology;s.model_config!=null&&(s=s.model_config);const i=n.strict==null?!0:n.strict,o=r.weightData!=null&&r.weightSpecs!=null&&i,a=Zi(ug(s),e,o),l=r.trainingConfig;if(l!=null&&a.loadTrainingConfig(l),r.userDefinedMetadata!=null&&a.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData!=null){if(r.weightSpecs==null)throw new Q("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:u,optimizerWeights:c}=SQ(r.weightData,r.weightSpecs);a.loadWeights(u,i),a.optimizer!=null&&c.length>0&&await a.optimizer.setWeights(c),ft(u),ft(c.map(h=>h.tensor))}return a}function SQ(t,e){const n=FG(t,e),r={},s=[];return e.forEach(i=>{i.group==="optimizer"?s.push({name:i.name,tensor:n[i.name]}):r[i.name]=n[i.name]}),{modelWeights:r,optimizerWeights:s}}class cd extends zu{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:Ev("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new Q(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof cd||e instanceof zu;let r;if(n){if(r=e,r.outputs.length!==1)throw new Q("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new Q("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new Q("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const s=SZ({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(e.inboundNodes.length!==1)throw new Q(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new Q("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=TO(this.outputs[0])}this.inboundNodes=[],new Tv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Il(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{const s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(Et(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new zu({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,r=console.log){this.built||this.build(),super.summary(e,n,r)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,r={}){if(!this.built)throw new js("The model needs to be compiled before being used.");return this.model.evaluate(e,n,r)}async evaluateDataset(e,n){if(!this.built)throw new js("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,r={}){if(!this.built)throw new js("The model needs to be compiled before being used.");return this.model.fit(e,n,r)}async fitDataset(e,n){if(!this.built)throw new js("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,r={},s=!1){let i,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new Q("Legacy serialization format not supported yet.");i=n}else F(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=n.layers,delete n.layers,o=n;const a=new e(o);if(!(a instanceof cd))throw new ht(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const c=Zi(l,void 0,s);s&&c.setFastWeightInitDuringBuild(!0),a.add(c)}return a}set stopTraining(e){if(this.model==null)throw new Q("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new Q("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const r={};r.className=n.getClassName(),r.config=n.getConfig(),e.push(r)}return{name:this.name,layers:e}}}cd.className="Sequential";Ie(cd);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let qr=class extends Ec{getConfig(){return{}}};class qO extends qr{apply(e,n=1){return uZ(e,n)}}qO.className="elu";Ie(qO);class KO extends qr{apply(e){return uR(e)}}KO.className="selu";Ie(KO);class XO extends qr{apply(e){return Wl(e)}}XO.className="relu";Ie(XO);class YO extends qr{apply(e){return pe(()=>od(6,Wl(e)))}}YO.className="relu6";Ie(YO);class ZO extends qr{apply(e){return e}}ZO.className="linear";Ie(ZO);class QO extends qr{apply(e){return Cc(e)}}QO.className="sigmoid";Ie(QO);class JO extends qr{apply(e){return hZ(e)}}JO.className="hardSigmoid";Ie(JO);class e3 extends qr{apply(e){return Lf(e)}}e3.className="softplus";Ie(e3);class t3 extends qr{apply(e){return cZ(e)}}t3.className="softsign";Ie(t3);class n3 extends qr{apply(e){return y2(e)}}n3.className="tanh";Ie(n3);let zC=class extends qr{apply(e,n=-1){return V2(e,n)}};zC.className="softmax";Ie(zC);class r3 extends qr{apply(e,n=-1){return tR(e,n)}}r3.className="logSoftmax";Ie(r3);class s3 extends qr{apply(e,n=1){return pe(()=>ee(Cc(ee(e,n)),e))}}s3.className="swish";Ie(s3);class i3 extends qr{apply(e){return pe(()=>ee(e,y2(Lf(e))))}}i3.className="mish";Ie(i3);function ya(t){return t.getClassName()}function Yy(t,e={}){return Wf(t,zs.getMap().classNameMap,e,"activation")}function xa(t){if(t==null){const e={};return e.className="linear",e.config={},Yy(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},Yy(e)}else return t instanceof qr?t:Yy(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kQ(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class o3 extends Ec{}class a3 extends o3{constructor(e){super(),kQ(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return pe(()=>{let n=Qn([1]);return this.hasL1&&(n=Ae(n,et(ee(this.l1,Sr(e))))),this.hasL2&&(n=Ae(n,et(ee(this.l2,jf(e))))),ae(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}a3.className="L1L2";Ie(a3);const WI={l1l2:"L1L2"};function Vt(t){return IC(t)}function GI(t,e={}){return Wf(t,zs.getMap().classNameMap,e,"regularizer")}function an(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in WI?WI[t]:t,config:{}};return GI(n)}else return t instanceof o3?t:GI(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class l3 extends gt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=rt(e);let r=Wl(e);return this.maxValue!=null&&(r=Cs(r,0,this.maxValue)),r}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}l3.className="ReLU";Ie(l3);class u3 extends gt{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=rt(e);return I2(r,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}u3.className="LeakyReLU";Ie(u3);class c3 extends gt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=on(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=an(e.alphaRegularizer),this.alphaConstraint=jn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new Q(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Et(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const s of this.sharedAxes)n[s-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let s=1;s<e.length;++s)r[s]=e[s];this.inputSpec=[new Wn({ndim:e.length,axes:r})],this.built=!0}call(e,n){return e=rt(e),A2(e,this.alpha.read())}getConfig(){const e={alphaInitializer:cn(this.alphaInitializer),alphaRegularizer:Vt(this.alphaRegularizer),alphaConstraint:Gn(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}c3.className="PReLU";Ie(c3);let h3=class extends gt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new ht(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=rt(e);return yv(r)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};h3.className="ELU";Ie(h3);class d3 extends gt{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const r=rt(e);return ee(r,Ve(Es(r,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}d3.className="ThresholdedReLU";Ie(d3);class f3 extends gt{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new zC().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){const r=rt(e);return this.softmax(r,this.axis)}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}f3.className="Softmax";Ie(f3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Uu(t,e,n){if(typeof t=="number")return Il(t,e);if(t.length!==e)throw new Q(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let r=0;r<e;++r){const s=t[r];if(!iZ(s))throw new Q(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${s}`)}return t}function xi(t,e,n,r,s=1){if(t==null)return t;const i=e+(e-1)*(s-1);let o;return n==="same"?o=t:o=t-i+1,Math.floor((o+r-1)/r)}function Pi(t,e,n,r){if(t==null)return null;if(r==="valid")t=t*e+va([n-e,0]);else if(r==="same")t=t*e;else throw new Q(`Unsupport padding mode: ${r}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function UC(t,e){return pe(()=>(Sn(e),e==="channelsFirst"?wt(t,[0,2,3,1]):t))}function p3(t,e){return pe(()=>(Sn(e),e==="channelsFirst"?wt(t,[0,2,3,4,1]):t))}function EQ(t,e,n,r=1,s="valid",i,o=1){return pe(()=>{if(i==null&&(i=Ci()),Sn(i),t.shape.length!==3)throw new Q(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new Q(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new Q(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if(i==="channelsFirst"&&(t=wt(t,[0,2,1])),s==="causal")throw new ht("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=HA(t,e,r,s==="same"?"same":"valid","NWC",o);return n!=null&&(a=Ii(a,n)),a})}function jI(t,e,n,r=[1,1],s="valid",i,o,a=null){return pe(()=>{if(i==null&&(i=Ci()),Sn(i),t.rank!==3&&t.rank!==4)throw new Q(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new Q(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=UC(t,i);if(s==="causal")throw new ht("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=N7({x:l,filter:e,strides:r,pad:s==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),i==="channelsFirst"&&(l=wt(l,[0,3,1,2])),l})}function IQ(t,e,n,r=[1,1,1],s="valid",i,o){return pe(()=>{if(i==null&&(i=Ci()),Sn(i),t.rank!==4&&t.rank!==5)throw new Q(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new Q(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=p3(t,i);if(s==="causal")throw new ht("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=IH(a,e,r,s==="same"?"same":"valid","NDHWC",o),n!=null&&(a=Ii(a,n)),i==="channelsFirst"&&(a=wt(a,[0,4,1,2,3])),a})}class $v extends gt{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",$v.verifyArgs(n),this.rank=e,er(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new ht(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Uu(n.kernelSize,e,"kernelSize"),this.strides=Uu(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,Is(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Sn(this.dataFormat),this.activation=xa(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=on(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=jn(n.biasConstraint),this.biasRegularizer=an(n.biasRegularizer),this.activityRegularizer=an(n.activityRegularizer),this.dilationRate=Uu(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new Q(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new Q(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new Q(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Li("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!TC(e.kernelSize,"number",1,3))throw new Q(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:ya(this.activation),useBias:this.useBias,biasInitializer:cn(this.biasInitializer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),biasConstraint:Gn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Ic extends $v{constructor(e,n){super(e,n),this.kernel=null,Ic.verifyArgs(n),this.filters=n.filters,er(this.filters,"filters"),this.kernelInitializer=on(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=jn(n.kernelConstraint),this.kernelRegularizer=an(n.kernelRegularizer)}build(e){e=Et(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new Q(`The channel dimension of the input should be defined. Found ${e[n]}`);const r=e[n],s=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(e,n){return pe(()=>{e=rt(e);let r;const s=this.bias==null?null:this.bias.read(),i=dO(this.activation.getClassName());if(i!=null&&this.rank===2)r=jI(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)r=EQ(e,this.kernel.read(),s,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=jI(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=IQ(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new ht("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(e){e=Et(e);const n=[],r=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<r.length;++i){const o=xi(r[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(o)}let s=[e[0]];return this.dataFormat==="channelsLast"?(s=s.concat(n),s.push(this.filters)):(s.push(this.filters),s=s.concat(n)),s}getConfig(){const e={filters:this.filters,kernelInitializer:cn(this.kernelInitializer),kernelRegularizer:Vt(this.kernelRegularizer),kernelConstraint:Gn(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new Q(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Xf extends Ic{constructor(e){super(2,e),Xf.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!TC(e.kernelSize,"number",1,2))throw new Q(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Xf.className="Conv2D";Ie(Xf);class Yf extends Ic{constructor(e){super(3,e),Yf.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new Q(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}Yf.className="Conv3D";Ie(Yf);class m3 extends Xf{constructor(e){if(super(e),this.inputSpec=[new Wn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new Q(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Et(e),e.length!==4)throw new Q("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new Q("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Wn({ndim:4,axes:{[n]:r}})],this.built=!0}call(e,n){return pe(()=>{let r=rt(e);if(r.shape.length!==4)throw new Q(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=s[o],u=s[a],c=this.kernelSize[0],h=this.kernelSize[1],d=this.strides[0],f=this.strides[1],m=Pi(l,d,c,this.padding),v=Pi(u,f,h,this.padding),p=[i,m,v,this.filters];this.dataFormat!=="channelsLast"&&(r=wt(r,[0,2,3,1]));let g=qA(r,this.kernel.read(),p,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(g=wt(g,[0,3,1,2])),this.bias!=null&&(g=Ii(g,this.bias.read(),this.dataFormat)),this.activation!=null&&(g=this.activation.apply(g)),g})}computeOutputShape(e){e=Et(e);const n=e.slice();let r,s,i;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3):(r=3,s=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return n[r]=this.filters,n[s]=Pi(n[s],l,o,this.padding),n[i]=Pi(n[i],u,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}m3.className="Conv2DTranspose";Ie(m3);class g3 extends Yf{constructor(e){if(super(e),this.inputSpec=[new Wn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new Q(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Et(e),e.length!==5)throw new Q("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new Q("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Wn({ndim:5,axes:{[n]:r}})],this.built=!0}call(e,n){return pe(()=>{let r=rt(e);if(r.shape.length!==5)throw new Q(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const u=s[l],c=s[o],h=s[a],d=this.kernelSize[0],f=this.kernelSize[1],m=this.kernelSize[2],v=this.strides[0],p=this.strides[1],g=this.strides[2],y=Pi(u,v,d,this.padding),b=Pi(c,p,f,this.padding),x=Pi(h,g,m,this.padding),w=[i,y,b,x,this.filters];this.dataFormat!=="channelsLast"&&(r=wt(r,[0,2,3,4,1]));let C=NH(r,this.kernel.read(),w,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(C=wt(C,[0,4,1,2,3])),this.bias!==null&&(C=Ii(C,this.bias.read(),this.dataFormat)),this.activation!==null&&(C=this.activation.apply(C)),C})}computeOutputShape(e){e=Et(e);const n=e.slice();let r,s,i,o;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3,o=4):(r=4,s=1,i=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],h=this.strides[1],d=this.strides[2];return n[r]=this.filters,n[s]=Pi(n[s],c,a,this.padding),n[i]=Pi(n[i],h,l,this.padding),n[o]=Pi(n[o],d,u,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}g3.className="Conv3DTranspose";Ie(g3);class v3 extends Ic{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new Q("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new Q("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new Q(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=on(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=an(n.depthwiseRegularizer),this.depthwiseConstraint=jn(n.depthwiseConstraint),this.pointwiseInitializer=on(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=an(n.pointwiseRegularizer),this.pointwiseConstraint=jn(n.pointwiseConstraint)}build(e){if(e=Et(e),e.length<this.rank+2)throw new Q(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new Q(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const r=e[n],s=this.kernelSize.concat([r,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(r*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new Wn({ndim:this.rank+2,axes:{[n]:r}})],this.built=!0}call(e,n){return pe(()=>{e=rt(e);let r;if(this.rank===1)throw new ht("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=wt(e,[0,2,3,1])),r=cR(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=Ii(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=wt(r,[0,3,1,2])),r})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=cn(this.depthwiseInitializer),e.pointwiseInitializer=cn(this.pointwiseInitializer),e.depthwiseRegularizer=Vt(this.depthwiseRegularizer),e.pointwiseRegularizer=Vt(this.pointwiseRegularizer),e.depthwiseConstraint=Gn(this.depthwiseConstraint),e.pointwiseConstraint=Gn(this.pointwiseConstraint),e}}v3.className="SeparableConv";class y3 extends v3{constructor(e){super(2,e)}}y3.className="SeparableConv2D";Ie(y3);class Dv extends Ic{constructor(e){super(1,e),Dv.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!TC(e.kernelSize,"number",1,1))throw new Q(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Dv.className="Conv1D";Ie(Dv);class x3 extends gt{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return pe(()=>{if(e=rt(e),this.dataFormat==="channelsLast"){const r=Rp(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Rp(r,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=Rp(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Rp(r,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}x3.className="Cropping2D";Ie(x3);class b3 extends gt{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Sn(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,nZ(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],r=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,r]}else{const n=e[1]==null?null:this.size[0]*e[1],r=e[2]==null?null:this.size[1]*e[2];return[e[0],n,r,e[3]]}}call(e,n){return pe(()=>{let r=rt(e);const s=r.shape;if(this.dataFormat==="channelsFirst"){r=wt(r,[0,2,3,1]);const i=this.size[0]*s[2],o=this.size[1]*s[3],a=this.interpolation==="nearest"?po.resizeNearestNeighbor(r,[i,o]):po.resizeBilinear(r,[i,o]);return wt(a,[0,3,1,2])}else{const i=this.size[0]*s[1],o=this.size[1]*s[2];return this.interpolation==="nearest"?po.resizeNearestNeighbor(r,[i,o]):po.resizeBilinear(r,[i,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}b3.className="UpSampling2D";Ie(b3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function TQ(t,e,n=[1,1],r="valid",s,i){return pe(()=>{s==null&&(s=Ci()),Sn(s);let o=UC(t,s);if(t.rank!==4)throw new Q(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new Q(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=C2(o,e,n,r==="same"?"same":"valid","NHWC",i),s==="channelsFirst"&&(o=wt(o,[0,3,1,2])),o})}class w3 extends $v{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=on(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=jn(e.depthwiseConstraint),this.depthwiseRegularizer=an(e.depthwiseRegularizer)}build(e){if(e=Et(e),e.length<4)throw new Q(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new Q(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const r=e[n],s=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",s,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return pe(()=>{e=rt(e);let r=TQ(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=Ii(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(e){e=Et(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=xi(n,this.kernelSize[0],this.padding,this.strides[0]),o=xi(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],s,i,o]:[e[0],i,o,s]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=cn(this.depthwiseInitializer),e.depthwiseRegularizer=Vt(this.depthwiseRegularizer),e.depthwiseConstraint=Gn(this.depthwiseRegularizer),e}}w3.className="DepthwiseConv2D";Ie(w3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function C3(t,e,n,r){if(Array.isArray(t)){if(e!=null||n!=null)throw new Q("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function s(i){return i==null||Array.isArray(i)?i:[i]}return e=s(e),n=s(n),{inputs:t,initialState:e,constants:n}}function S3(t,e,n,r=!1,s,i,o=!1,a=!1){return pe(()=>{const l=e.shape.length;if(l<3)throw new Q(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(wi(2,l));if(e=wt(e,u),i!=null)throw new ht("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),s!=null&&(s=Ve(Ve(s,"bool"),"float32"),s.rank===l-1&&(s=Pr(s,-1)),s=wt(s,u)),r&&(e=kl(e,0),s!=null&&(s=kl(s,0)));const c=[];let h,d=n;const f=e.shape[0],m=El(e);let v;s!=null&&(v=El(s));for(let g=0;g<f;++g){const y=m[g],b=pe(()=>t(y,d));if(s==null)h=b[0],d=b[1];else{const x=pe(()=>{const w=v[g],C=st(Zs(w),w),S=Ae(ee(b[0],w),ee(d[0],C)),E=d.map((T,_)=>Ae(ee(b[1][_],w),ee(T,C)));return{output:S,newStates:E}});h=x.output,d=x.newStates}a&&c.push(h)}let p;return a&&(p=ga(c,1)),[h,p,d]})}class Ra extends gt{constructor(e){super(e);let n;if(e.cell==null)throw new Q("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new GC({cells:e.cell}):n=e.cell,n.stateSize==null)throw new Q("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Wn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return wi(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){Bx(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const r=n[0];let s;if(this.returnSequences?s=[e[0],e[1],r]:s=[e[0],r],this.returnState){const i=[];for(const o of n)i.push([e[0],o]);return[s].concat(i)}else return s}computeMask(e,n){return pe(()=>{Array.isArray(n)&&(n=n[0]);const r=this.returnSequences?n:null;if(this.returnState){const s=this.states.map(i=>null);return[r].concat(s)}else return r})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<e;++r)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new ht("Constants support is not implemented in RNN yet.");Bx(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,r=e.slice(2);this.inputSpec[0]=new Wn({shape:[n,null,...r]});const s=[e[0]].concat(e.slice(2));this.cell.build(s);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!Nt(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new Q(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new Wn({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){pe(()=>{if(!this.stateful)throw new Fi("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new Q("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Qn([r,s])):this.states_=[Qn([r,this.cell.stateSize])];else if(e==null)ft(this.states_),this.keptStates!=null&&(ft(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Qn([r,s])):this.states_[0]=Qn([r,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Q(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):ft(this.states_);for(let s=0;s<this.states_.length;++s){const i=e[s],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,a=[r,o];if(!Nt(i.shape,a))throw new Q(`State ${s} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[s]=i}}this.states_=this.states_.map(s=>qi(s.clone()))})}apply(e,n){let r=n==null?null:n.initialState,s=n==null?null:n.constants;n==null&&(n={});const i=C3(e,r,s,this.numConstants);e=i.inputs,r=i.initialState,s=i.constants;let o=[],a=[];if(r!=null){n.initialState=r,o=o.concat(r),this.stateSpec=[];for(const u of r)this.stateSpec.push(new Wn({shape:u.shape}));a=a.concat(this.stateSpec)}if(s!=null&&(n.constants=s,o=o.concat(s),this.numConstants=s.length),o[0]instanceof zi){const u=[e].concat(o),c=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=c;const d=super.apply(u,n);return this.inputSpec=h,d}else return super.apply(e,n)}call(e,n){return pe(()=>{const r=n==null?null:n.mask,s=n==null?null:n.training;let i=n==null?null:n.initialState;e=rt(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new Q(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:s},u=S3((m,v)=>{const p=this.cell.call([m].concat(v),a);return[p[0],p.slice(1)]},e,i,this.goBackwards,r,null,this.unroll,this.returnSequences),c=u[0],h=u[1],d=u[2];this.stateful&&this.resetStates(d,s);const f=this.returnSequences?h:c;return this.returnState?[f].concat(d):f})}getInitialState(e){return pe(()=>{let n=Qn(e.shape);return n=et(n,[1,2]),n=Gf(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?Px(n,[1,r]):n):this.cell.stateSize>1?[Px(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===Ra.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),n)}static fromConfig(e,n,r={}){const s=n.cell,i=Zi(s,r);return new e(Object.assign(n,{cell:i}))}}Ra.className="RNN";Ie(Ra);class Av extends gt{}class VC extends Av{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,er(this.units,"units"),this.activation=xa(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=on(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=on(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=on(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=an(e.kernelRegularizer),this.recurrentRegularizer=an(e.recurrentRegularizer),this.biasRegularizer=an(e.biasRegularizer),this.kernelConstraint=jn(e.kernelConstraint),this.recurrentConstraint=jn(e.recurrentConstraint),this.biasConstraint=jn(e.biasConstraint),this.dropout=sc([1,va([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=sc([1,va([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Et(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return pe(()=>{if(e=e,e.length!==2)throw new Q(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let r=e[1];e=e[0];const s=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ba({ones:()=>Zs(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ba({ones:()=>Zs(r),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=Yi(ee(e,o),this.kernel.read()):i=Yi(e,this.kernel.read()),this.bias!=null&&(i=Ii(i,this.bias.read())),a!=null&&(r=ee(r,a));let l=Ae(i,Yi(r,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:ya(this.activation),useBias:this.useBias,kernelInitializer:cn(this.kernelInitializer),recurrentInitializer:cn(this.recurrentInitializer),biasInitializer:cn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Gn(this.kernelConstraint),recurrentConstraint:Gn(this.recurrentConstraint),biasConstraint:Gn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}VC.className="SimpleRNNCell";Ie(VC);class k3 extends Ra{constructor(e){e.cell=new VC(e),super(e)}call(e,n){return pe(()=>{this.cell.dropoutMask!=null&&(ft(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ft(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,n){return new e(n)}}k3.className="SimpleRNN";Ie(k3);class WC extends Av{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new Q("GRUCell does not support reset_after parameter set to true.");this.units=e.units,er(this.units,"units"),this.activation=xa(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=xa(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=on(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=on(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=on(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=an(e.kernelRegularizer),this.recurrentRegularizer=an(e.recurrentRegularizer),this.biasRegularizer=an(e.biasRegularizer),this.kernelConstraint=jn(e.kernelConstraint),this.recurrentConstraint=jn(e.recurrentConstraint),this.biasConstraint=jn(e.biasConstraint),this.dropout=sc([1,va([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=sc([1,va([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Et(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return pe(()=>{if(e=e,e.length!==2)throw new Q(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training==null?!1:n.training;let s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ba({ones:()=>Zs(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ba({ones:()=>Zs(s),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,u;0<this.dropout&&this.dropout<1&&(e=ee(e,i[0]));let c=Yi(e,this.kernel.read());this.useBias&&(c=Ii(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=ee(s,o[0]));const h=this.recurrentKernel.read(),[d,f]=bs(h,[2*this.units,this.units],h.rank-1),m=Yi(s,d),[v,p,g]=bs(c,3,c.rank-1),[y,b]=bs(m,2,m.rank-1);a=this.recurrentActivation.apply(Ae(v,y)),l=this.recurrentActivation.apply(Ae(p,b));const x=Yi(ee(l,s),f);u=this.activation.apply(Ae(g,x));const w=Ae(ee(a,s),ee(Ae(1,bn(a)),u));return[w,w]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:ya(this.activation),recurrentActivation:ya(this.recurrentActivation),useBias:this.useBias,kernelInitializer:cn(this.kernelInitializer),recurrentInitializer:cn(this.recurrentInitializer),biasInitializer:cn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Gn(this.kernelConstraint),recurrentConstraint:Gn(this.recurrentConstraint),biasConstraint:Gn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}WC.className="GRUCell";Ie(WC);class E3 extends Ra{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new WC(e),super(e)}call(e,n){return pe(()=>{this.cell.dropoutMask!=null&&(ft(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ft(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}E3.className="GRU";Ie(E3);class Rv extends Av{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,er(this.units,"units"),this.activation=xa(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=xa(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=on(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=on(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=on(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=an(e.kernelRegularizer),this.recurrentRegularizer=an(e.recurrentRegularizer),this.biasRegularizer=an(e.biasRegularizer),this.kernelConstraint=jn(e.kernelConstraint),this.recurrentConstraint=jn(e.recurrentConstraint),this.biasConstraint=jn(e.biasConstraint),this.dropout=sc([1,va([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=sc([1,va([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=Et(e);const r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let s;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;s=new(n=class extends Js{apply(l,u){const c=i.apply([o]),h=new NC().apply([o]),d=i.apply([o*2]);return _I(_I(c,h),d)}},n.className="CustomInit",n)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return pe(()=>{const r=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new Q(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ba({ones:()=>Zs(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ba({ones:()=>Zs(s),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,u,c,h;0<this.dropout&&this.dropout<1&&(e=ee(e,o[0]));let d=Yi(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=ee(s,a[0])),d=Ae(d,Yi(s,this.recurrentKernel.read())),this.useBias&&(d=Ii(d,this.bias.read()));const[f,m,v,p]=bs(d,4,d.rank-1);l=this.recurrentActivation.apply(f),u=this.recurrentActivation.apply(m),c=Ae(ee(u,i),ee(l,this.activation.apply(v))),h=this.recurrentActivation.apply(p);const g=ee(h,this.activation.apply(c));return[g,g,c]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:ya(this.activation),recurrentActivation:ya(this.recurrentActivation),useBias:this.useBias,kernelInitializer:cn(this.kernelInitializer),recurrentInitializer:cn(this.recurrentInitializer),biasInitializer:cn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Gn(this.kernelConstraint),recurrentConstraint:Gn(this.recurrentConstraint),biasConstraint:Gn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}Rv.className="LSTMCell";Ie(Rv);class I3 extends Ra{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Rv(e),super(e)}call(e,n){return pe(()=>{this.cell.dropoutMask!=null&&(ft(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ft(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}I3.className="LSTM";Ie(I3);class GC extends Av{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return pe(()=>{e=e;let r=e.slice(1);const s=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?s.push(r.splice(0,a.stateSize.length)):s.push(r.splice(0,1));s.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];r=s[a],a===0?o=[e[0]].concat(r):o=[o[0]].concat(r),o=l.call(o,n),i.push(o.slice(1))}r=[];for(const a of i.slice().reverse())r.push(...a);return[o[0]].concat(r)})}build(e){Bx(e)&&(e=e[0]),e=e;let n;this.cells.forEach((r,s)=>{il(`RNNCell_${s}`,()=>{r.build(e),Array.isArray(r.stateSize)?n=r.stateSize[0]:n=r.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=i=>({className:i.getClassName(),config:i.getConfig()}),s={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),s)}static fromConfig(e,n,r={}){const s=[];for(const i of n.cells)s.push(Zi(i,r));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.cells)n.push(...r.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return zx(e)}setWeights(e){const n=[];for(const r of this.cells){const s=r.weights.length,i=e.splice(s);for(let o=0;o<r.weights.length;++o)n.push([r.weights[o],i[o]])}LC(n)}}GC.className="StackedRNNCells";Ie(GC);function ba(t){const{ones:e,rate:n,training:r=!1,count:s=1,dropoutFunc:i}=t,o=()=>i!=null?i(e(),n):xO(e(),n),a=()=>Hf(o,e,r);return!s||s<=1?qi(a().clone()):Array(s).fill(void 0).map(a).map(u=>qi(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var _Q=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};class T3 extends Ra{constructor(e){if(e.unroll)throw new ht("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new ht("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Wn({ndim:5})]}call(e,n){return pe(()=>{if(this.cell.dropoutMask!=null&&(ft(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ft(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new Q("ConvRNN2D cell does not support constants");const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return pe(()=>{const{stateSize:n}=this.cell,r=e.shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)],o=Qn(i);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(e,n=!1){pe(()=>{if(!this.stateful)throw new Fi("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)];if(r[0]==null)throw new Q("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Qn(i)):this.states_=[Qn(i)];else if(e==null)ft(this.states_),this.keptStates!=null&&(ft(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Qn(i)):this.states_[0]=Qn(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Q(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):ft(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],u=i;if(!Nt(l.shape,u))throw new Q(`State ${a} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>qi(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:r,kernelSize:s,padding:i,strides:o,dilationRate:a}=this.cell,l=n==="channelsFirst",u=e[l?3:2],c=e[l?4:3],h=xi(u,s[0],i,o[0],a[0]),d=xi(c,s[1],i,o[1],a[1]);return[...e.slice(0,2),...l?[r,h,d]:[h,d,r]]}}T3.className="ConvRNN2D";class jC extends Rv{constructor(e){const{filters:n,kernelSize:r,strides:s,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,er(this.filters,"filters"),this.kernelSize=Uu(r,2,"kernelSize"),this.kernelSize.forEach(l=>er(l,"kernelSize")),this.strides=Uu(s||1,2,"strides"),this.strides.forEach(l=>er(l,"strides")),this.padding=i||"valid",Is(this.padding),this.dataFormat=o||"channelsLast",Sn(this.dataFormat),this.dilationRate=Uu(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>er(l,"dilationRate"))}build(e){var n;e=Et(e);const r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new Q(`The channel dimension of the input should be defined. Found ${e[r]}`);const s=e[r],i=4,o=this.kernelSize.concat([s,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,c=this.filters;l=new(n=class extends Js{apply(d,f){const m=u.apply([c]),v=Ul([c]),p=u.apply([c*2]);return _C([m,v,p])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return pe(()=>{if(e.length!==3)throw new Q(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training||!1,s=e[0],i=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ba({ones:()=>Zs(s),rate:this.dropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(X,ie,G)=>!ie||!ie[G]?X:ee(ie[G],X);let c=u(s,l,0),h=u(s,l,1),d=u(s,l,2),f=u(s,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ba({ones:()=>Zs(i),rate:this.recurrentDropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const m=this.recurrentDropoutMask;let v=u(i,m,0),p=u(i,m,1),g=u(i,m,2),y=u(i,m,3);const b=3,[x,w,C,S]=bs(this.kernel.read(),a,b),[E,T,_,A]=this.useBias?bs(this.bias.read(),a):[null,null,null,null];c=this.inputConv(c,x,E,this.padding),h=this.inputConv(h,w,T,this.padding),d=this.inputConv(d,C,_,this.padding),f=this.inputConv(f,S,A,this.padding);const[L,W,K,R]=bs(this.recurrentKernel.read(),a,b);v=this.recurrentConv(v,L),p=this.recurrentConv(p,W),g=this.recurrentConv(g,K),y=this.recurrentConv(y,R);const M=this.recurrentActivation.apply(Ae(c,v)),U=this.recurrentActivation.apply(Ae(h,p)),D=Ae(ee(U,o),ee(M,this.activation.apply(Ae(d,g)))),B=ee(this.recurrentActivation.apply(Ae(f,y)),this.activation.apply(D));return[B,B,D]})}getConfig(){const e=super.getConfig(),n=_Q(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(e,n,r,s){const i=Sl(e,n,this.strides,s||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?Ii(i,r,this.dataFormat):i}recurrentConv(e,n){return Sl(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}jC.className="ConvLSTM2DCell";Ie(jC);class _3 extends T3{constructor(e){const n=new jC(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}_3.className="ConvLSTM2D";Ie(_3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class HC extends gt{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,r=[];for(let s=0;s<this.noiseShape.length;++s)r.push(this.noiseShape[s]==null?n[s]:this.noiseShape[s]);return r}call(e,n){return pe(()=>{this.invokeCallHook(e,n);const r=rt(e);if(0<this.rate&&this.rate<1){const s=n.training==null?!1:n.training,i=this.getNoiseShape(r);return Hf(()=>xO(r,this.rate,i,this.seed),()=>r,s)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}HC.className="Dropout";Ie(HC);class N3 extends HC{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}N3.className="SpatialDropout1D";Ie(N3);class $3 extends gt{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,er(this.units,"units"),this.activation=xa(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=on(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=on(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=jn(e.kernelConstraint),this.biasConstraint=jn(e.biasConstraint),this.kernelRegularizer=an(e.kernelRegularizer),this.biasRegularizer=an(e.biasRegularizer),this.activityRegularizer=an(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Et(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=Et(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return pe(()=>{this.invokeCallHook(e,n);const r=rt(e),s=dO(this.activation.getClassName());let i;return s!=null?i=Yi(r,this.kernel.read(),s,this.bias?this.bias.read():null):(i=Yi(r,this.kernel.read()),this.bias!=null&&(i=Ii(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:ya(this.activation),useBias:this.useBias,kernelInitializer:cn(this.kernelInitializer),biasInitializer:cn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Gn(this.kernelConstraint),biasConstraint:Gn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}$3.className="Dense";Ie($3);class D3 extends gt{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Et(e);for(const n of e.slice(1))if(n==null)throw new Q(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],ha(e,1)]}call(e,n){return pe(()=>{this.invokeCallHook(e,n);let r=rt(e);if(this.dataFormat==="channelsFirst"&&r.rank>1){const s=[0];for(let i=2;i<r.rank;++i)s.push(i);s.push(1),r=wt(r,s)}return lZ(r)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}D3.className="Flatten";Ie(D3);class A3 extends gt{constructor(e){super(e),this.supportsMasking=!0,this.activation=xa(e.activation)}call(e,n){return pe(()=>{this.invokeCallHook(e,n);const r=rt(e);return this.activation.apply(r)})}getConfig(){const e={activation:ya(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}A3.className="Activation";Ie(A3);class R3 extends gt{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return pe(()=>(e=rt(e),oZ(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}R3.className="RepeatVector";Ie(R3);class O3 extends gt{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const r="Total size of new array must be unchanged.",s=n.slice();let i=1,o=null;for(let l=0;l<s.length;++l){const u=s[l];if(this.isUnknown(u))if(o===null)o=l;else throw new Q("Can only specifiy one unknown dimension.");else i*=u}const a=ha(e);if(o!==null){if(i===0||a%i!==0)throw new Q(r);s[o]=a/i}else if(a!==i)throw new Q(r);return s}computeOutputShape(e){let n=!1;for(let r=0;r<e.length;++r)if(this.isUnknown(e[r])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return pe(()=>{this.invokeCallHook(e,n);const r=rt(e),s=r.shape,i=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return ae(r,i)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}O3.className="Reshape";Ie(O3);class F3 extends gt{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=wi(1,e.dims.length+1);if(!Nt(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Wn({ndim:this.dims.length+1})]}computeOutputShape(e){e=Et(e);const n=e.slice();return this.dims.forEach((r,s)=>{n[s+1]=e[r]}),n}call(e,n){return wt(rt(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}F3.className="Permute";Ie(F3);class L3 extends gt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const r=rt(e),s=-1;return $x(Zm(r,this.maskValue),s)}call(e,n){return pe(()=>{this.invokeCallHook(e,n);const r=rt(e),s=-1,i=!0,o=$x(Zm(r,this.maskValue),s,i);return ee(r,Ve(o,r.dtype))})}}L3.className="Masking";Ie(L3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class P3 extends gt{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Qt(e.inputLength))}this.inputDim=e.inputDim,er(this.inputDim,"inputDim"),this.outputDim=e.outputDim,er(this.outputDim,"outputDim"),this.embeddingsInitializer=on(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=an(e.embeddingsRegularizer),this.activityRegularizer=an(e.activityRegularizer),this.embeddingsConstraint=jn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return pe(()=>this.maskZero?(e=rt(e),Zm(e,Ct(e))):null)}computeOutputShape(e){if(e=Et(e),this.inputLength==null)return[...e,this.outputDim];const n=Qt(this.inputLength);if(n.length!==e.length-1)throw new Q(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let r=0;for(let s=0;s<n.length;++s){const i=n[s],o=e[s+1];if(i!=null&&o!=null&&i!==o)throw new Q(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(n[r]=o),r++}}return[e[0],...n,this.outputDim]}call(e,n){return pe(()=>{this.invokeCallHook(e,n);let r=rt(e);r.dtype!=="int32"&&(r=Xi(r,"int32"));const s=yO(this.embeddings.read(),ae(r,[r.size]));return ae(s,Et(this.computeOutputShape(r.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:cn(this.embeddingsInitializer),embeddingsRegularizer:Vt(this.embeddingsRegularizer),activityRegularizer:Vt(this.activityRegularizer),embeddingsConstraint:Gn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}P3.className="Embedding";Ie(P3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Hl extends gt{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new ht}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const r=e.slice(0,e.length-n.length);for(let s=0;s<n.length;++s){const i=e[e.length-n.length+s],o=n[s];if(i==null||o==null||i<0||o<0)r.push(null);else if(i===1)r.push(o);else if(o===1)r.push(i);else{if(i!==o)throw new Q("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));r.push(i)}}return r}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Et(e)]),e=e,e.length<2)throw new Q(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const i of e)i!=null&&i[0]!==null&&n.push(i[0]);if(n=ca(n),n.length>1)throw new Q(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const o=e[i]==null?null:e[i].slice(1);r=this.computeElementwiseOpOutputShape(r,o)}const s=e.map(i=>i.length);e.indexOf(null)===-1&&ca(s).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return pe(()=>{if(e=e,this.reshapeRequired){const r=[],s=e.map(i=>i.rank);if(s.indexOf(null)===-1){const i=va(s);for(let o of e){const a=o.rank;for(let l=0;l<i-a;++l)o=Gf(o,1);r.push(o)}return this.mergeFunction(r)}else{let i=!1;for(const l of e){const u=l.rank;if(u==null){const c=l.shape,h=c[0],d=c.slice(1).concat([h]);let f=ae(l,[h].concat(ha(c.slice(1))));f=wt(f,[1,0]),f=ae(f,d),r.push(f),i=!0}else if(u>1){const c=wi(1,u).concat([0]);r.push(wt(l,c)),i=!0}else r.push(l)}let o=this.mergeFunction(r);const a=o.rank;if(i){if(a==null){const l=o.shape,u=l.length,c=l[u-1],h=[c].concat(l.slice(0,l.length-1));o=ae(wt(ae(o,[-1,c]),[1,0]),h)}else if(a>1){const l=[a-1].concat(wi(0,a-1));o=wt(o,l)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let s=1;s<e.length;++s){const i=e[s]==null?null:e[s].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let r=[];for(const s of e)s!=null&&s[0]!==null&&r.push(s[0]);return r=ca(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(e,n){return pe(()=>{if(n==null)return null;if(!Array.isArray(n))throw new Q("`mask` should be an Array");if(!Array.isArray(e))throw new Q("`inputs` should be an Array");if(n.length!==e.length)throw new Q(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(s=>s==null))return null;n=n.map(s=>s==null?s:Pr(s,0));let r=n[0];for(let s=1;s<n.length-1;++s)r=ko(r,n[s]);return r})}}class M3 extends Hl{constructor(e){super(e)}mergeFunction(e){return pe(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=Ae(n,e[r]);return n})}}M3.className="Add";Ie(M3);class B3 extends Hl{constructor(e){super(e)}mergeFunction(e){return pe(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=ee(n,e[r]);return n})}}B3.className="Multiply";Ie(B3);class z3 extends Hl{constructor(e){super(e)}mergeFunction(e){return pe(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=Ae(n,e[r]);return ee(1/e.length,n)})}}z3.className="Average";Ie(z3);class U3 extends Hl{constructor(e){super(e)}mergeFunction(e){return pe(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=Da(n,e[r]);return n})}}U3.className="Maximum";Ie(U3);class V3 extends Hl{constructor(e){super(e)}mergeFunction(e){return pe(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=od(n,e[r]);return n})}}V3.className="Minimum";Ie(V3);class W3 extends Hl{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new Q("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const s of e)if(s!=null){n=!1;break}if(n)return;const r=[];for(let s=0;s<e.length;++s){const i=e[s].slice();i.splice(this.axis,1);let o=!1;for(const a of r)if(Nt(a,i)){o=!0;break}o||r.push(i)}if(r.length>1)throw new Q("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return pe(()=>_C(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new Q("A `Concatenate` layer should be called on a list of inputs.");const n=e,r=n[0].slice(),s=this.axis<0?r.length+this.axis:this.axis;for(const i of n.slice(1)){if(r[s]==null||i[s]==null){r[s]=null;break}r[s]+=i[s]}return r}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new Q("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new Q("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new Q(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return pe(()=>{let r=!0;if(n.forEach(o=>{if(o!=null){r=!1;return}}),r)return null;const s=[];for(let o=0;o<e.length;++o)n[o]==null?s.push(Ve(Zs(e[o]),"bool")):n[o].rank<e[o].rank?s.push(Pr(n[o],-1)):s.push(n[o]);const i=zr(s,this.axis);return jA(i,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}W3.className="Concatenate";Ie(W3);function oh(t,e){for(;t<0;)t+=e;return t}function NQ(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new ht("batchDot is not implemented for tensors of 4D or higher rank yet");if(F(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),F(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new ht("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,s=e.shape.length;n==null&&(n=[r-1,s-2]);const i=n;return pe(()=>{let o;if(r>s){o=r-s;const l=[];for(let u=0;u<o;++u)l.push(1);e=ae(e,e.shape.concat(l))}else if(s>r){o=s-r;const l=[];for(let u=0;u<o;++u)l.push(1);t=ae(t,t.shape.concat(l))}else o=0;let a;if(t.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=et(ee(t,e),i[0]):a=et(ee(wt(t,[1,0]),e),i[1]);else{const l=i[0]!==t.shape.length-1,u=i[1]===e.shape.length-1;a=_t(t,e,l,u)}if(o>0){let l;r>s?l=r+s-3:l=r-1;const u=[];for(let c=l;c<l+o;++c)u.push(c);a=Mf(a,u)}return a.shape.length===1&&(a=Pr(a,1)),a})}class G3 extends Hl{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){F(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],r=e[1];if(n.length>3||r.length>3)throw new ht("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(n,r);if(n[s[0]]!==r[s[1]])throw new Q(`Dimension incompatibility: ${n[s[0]]} !== ${r[s[1]]}`)}mergeFunction(e){if(e.length!==2)throw new Q(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],r=e[1],s;return Array.isArray(this.axes)?s=this.axes.map((i,o)=>oh(i,e[o].shape.length)):s=[oh(this.axes,n.shape.length),oh(this.axes,r.shape.length)],this.normalize&&(n=sg(n,s[0]),r=sg(r,s[1])),NQ(n,r,s)}interpretAxes(e,n){let r;return Array.isArray(this.axes)?r=this.axes:r=[oh(this.axes,e.length),oh(this.axes,n.length)],r}computeOutputShape(e){F(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),r=e[1].slice();if(n.length>3||r.length>3)throw new ht("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(n,r);n.splice(s[0],1),r.splice(s[1],1),r.splice(0,1);const i=n.concat(r);return i.length===1&&i.push(1),i}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}G3.className="Dot";Ie(G3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class j3 extends gt{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return pe(()=>{this.invokeCallHook(e,n);const r=rt(e);return Hf(()=>Ae(Iv(r.shape,0,this.stddev),r),()=>r,n.training||!1)})}}j3.className="GaussianNoise";Ie(j3);class H3 extends gt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return pe(()=>{this.invokeCallHook(e,n);const r=rt(e);return this.rate>0&&this.rate<1?Hf(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return ee(r,Iv(r.shape,1,i))},()=>r,n.training||!1):r})}}H3.className="GaussianDropout";Ie(H3);class q3 extends gt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||rt(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return pe(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(e);return Hf(()=>{const i=rt(e),o=1.6732632423543772,a=1.0507009873554805,l=-o*a;let u=zl(Pf(r),this.rate);u=Xi(u,"float32");const c=((1-this.rate)*(1+this.rate*l**2))**-.5,h=-c*l*this.rate,d=Ae(ee(i,u),ee(Ae(u,-1),l));return Ae(ee(d,c),h)},()=>rt(e),n.training||!1)}return e})}}q3.className="AlphaDropout";Ie(q3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hd(t,e,n,r,s,i=.001){let o;if(t.rank===2)o=nH(t,e,n,r,s,i);else if(t.rank===3)o=sH(t,e,n,r,s,i);else if(t.rank===4)o=oH(t,e,n,r,s,i);else throw new ht(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return o}function $Q(t,e,n,r,s=.001){return pe(()=>{const i=N2(t,r),o=i.mean,a=i.variance;return[hd(t,o,a,n,e,s),o,a]})}function DQ(t,e,n,r,s=.001){return pe(()=>{const i=N2(t,r),o=i.mean,a=i.variance,l=[];for(const m of wi(0,t.rank))r.indexOf(m)!==-1?l.push(1):l.push(t.shape[m]);const u=ae(o,l),c=ae(a,l),h=e==null?null:ae(e,l),d=n==null?null:ae(n,l);return[hd(t,u,c,d,h,s),o,a]})}function AQ(t,e,n,r,s=.001){return Nt(r.slice().sort(),wi(0,t.rank-1))?$Q(t,e,n,r,s):DQ(t,e,n,r,s)}class K3 extends gt{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=on(e.betaInitializer||"zeros"),this.gammaInitializer=on(e.gammaInitializer||"ones"),this.movingMeanInitializer=on(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=on(e.movingVarianceInitializer||"ones"),this.betaConstraint=jn(e.betaConstraint),this.gammaConstraint=jn(e.gammaConstraint),this.betaRegularizer=an(e.betaRegularizer),this.gammaRegularizer=an(e.gammaRegularizer)}build(e){e=Et(e);const n=this.axis>=0?this.axis:this.axis+e.length,r=e[n];if(r==null)throw new Q(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Wn({ndim:e.length,axes:{[n]:r}})];const s=[r];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return pe(()=>{const r=n.training==null?!1:n.training,s=rt(e),i=s.shape,o=i.length,a=wi(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const u=Il(1,o);u[l]=i[l];const c=a.slice();c.sort();const h=!Nt(c,wi(0,o).slice(0,o-1)),d=()=>{if(h){const y=ae(this.movingMean.read(),u),b=ae(this.movingVariance.read(),u),x=this.center?ae(this.beta.read(),u):null,w=this.scale?ae(this.gamma.read(),u):null;return hd(s,y,b,x,w,this.epsilon)}else return hd(s,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return d();const[f,m,v]=AQ(s,this.gamma.read(),this.beta.read(),a,this.epsilon),p=(y,b,x)=>{pe(()=>{const w=1-x,C=y.read(),S=ee(st(C,b),w);y.write(st(C,S))})};return(()=>{p(this.movingMean,m,this.momentum),p(this.movingVariance,v,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:cn(this.betaInitializer),gammaInitializer:cn(this.gammaInitializer),movingMeanInitializer:cn(this.movingMeanInitializer),movingVarianceInitializer:cn(this.movingVarianceInitializer),betaRegularizer:Vt(this.betaRegularizer),gammaRegularizer:Vt(this.gammaRegularizer),betaConstraint:Gn(this.betaConstraint),gammaConstraint:Gn(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}K3.className="BatchNormalization";Ie(K3);class X3 extends gt{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=on(e.betaInitializer||"zeros"),this.gammaInitializer=on(e.gammaInitializer||"ones"),this.betaRegularizer=an(e.betaRegularizer),this.gammaRegularizer=an(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Et(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=n);for(const i of this.axis)if(i<0||i>=n)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==ca(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(i=>e[i]),s=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,s):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,s):this.beta=null,this.built=!0}call(e,n){const r=rt(e),s=r.shape,i=s.length;return pe(()=>{let{mean:a,variance:l}=N2(r,this.axis,!0);const u=Il(1,i);for(const v of this.axis)u[v]=s[v];const c=v=>v!=null&&v.shape.length!==i?ae(v,u):v;let h=this.scale?c(this.gamma.read()):null,d=this.center?c(this.beta.read()):null;const f=[],m=[];for(let v=0;v<i;++v)this.axis.indexOf(v)!==-1?(f.push(s[v]),m.push(1)):(f.push(1),m.push(s[v]));return a=fi(a,f),l=fi(l,f),h!=null&&(h=fi(h,m)),d!=null&&(d=fi(d,m)),hd(r,a,l,d,h,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:cn(this.betaInitializer),gammaInitializer:cn(this.gammaInitializer),betaRegularizer:Vt(this.betaRegularizer),gammaRegularizer:Vt(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}X3.className="LayerNormalization";Ie(X3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function RQ(t,e,n){return pe(()=>{if(t.rank!==4)throw new Q(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new Q("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Ci()),n!=="channelsLast"&&n!=="channelsFirst")throw new Q(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],e[0],e[1]]:r=[[0,0],e[0],e[1],[0,0]],$2(t,r)})}class Y3 extends gt{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Ci():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new Q(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,r;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],r=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new Q(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new Q(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);r=e.padding[1]}this.padding=[n,r]}this.inputSpec=[new Wn({ndim:4})]}computeOutputShape(e){e=Et(e);let n,r;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?r=e[3]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],e[1],n,r]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?r=e[2]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],n,r,e[3]])}call(e,n){return pe(()=>RQ(rt(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}Y3.className="ZeroPadding2D";Ie(Y3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ov(t,e,n,r,s,i){return pe(()=>{Sn(s),pO(i),Is(r),n==null&&(n=[1,1]),r==null&&(r="valid"),s==null&&(s=Ci()),i==null&&(i="max"),t=UC(t,s);let o;const a=r==="same"?"same":"valid";return i==="max"?o=_2(t,e,n,a):o=v2(t,e,n,a),s==="channelsFirst"&&(o=wt(o,[0,3,1,2])),o})}function Z3(t,e,n,r,s,i){return pe(()=>{Sn(s),pO(i),Is(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),s==null&&(s=Ci()),i==null&&(i="max"),t=p3(t,s);let o;const a=r==="same"?"same":"valid";return i==="max"?o=Hq(t,e,n,a):o=Hj(t,e,n,a),s==="channelsFirst"&&(o=wt(o,[0,4,1,2,3])),o})}class Q3 extends gt{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new Q(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(er(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new Q(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);er(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Is(this.padding),this.inputSpec=[new Wn({ndim:3})]}computeOutputShape(e){e=Et(e);const n=xi(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return pe(()=>{this.invokeCallHook(e,n),e=Gf(rt(e),2);const r=this.poolingFunction(rt(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Mf(r,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class J3 extends Q3{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Sn(i),Is(s),Ov(e,n,r,s,i,"max")}}J3.className="MaxPooling1D";Ie(J3);class eF extends Q3{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Sn(i),Is(s),Ov(e,n,r,s,i,"avg")}}eF.className="AveragePooling1D";Ie(eF);class tF extends gt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new Q(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];er(this.poolSize,"poolSize"),er(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Sn(this.dataFormat),Is(this.padding),this.inputSpec=[new Wn({ndim:4})]}computeOutputShape(e){e=Et(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=xi(n,this.poolSize[0],this.padding,this.strides[0]),r=xi(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r]:[e[0],n,r,e[3]]}call(e,n){return pe(()=>(this.invokeCallHook(e,n),this.poolingFunction(rt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class nF extends tF{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Sn(i),Is(s),Ov(e,n,r,s,i,"max")}}nF.className="MaxPooling2D";Ie(nF);class rF extends tF{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Sn(i),Is(s),Ov(e,n,r,s,i,"avg")}}rF.className="AveragePooling2D";Ie(rF);class sF extends gt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new Q(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];er(this.poolSize,"poolSize"),er(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Sn(this.dataFormat),Is(this.padding),this.inputSpec=[new Wn({ndim:5})]}computeOutputShape(e){e=Et(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=xi(n,this.poolSize[0],this.padding,this.strides[0]),r=xi(r,this.poolSize[1],this.padding,this.strides[1]),s=xi(s,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r,s]:[e[0],n,r,s,e[4]]}call(e,n){return pe(()=>(this.invokeCallHook(e,n),this.poolingFunction(rt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class iF extends sF{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Sn(i),Is(s),Z3(e,n,r,s,i,"max")}}iF.className="MaxPooling3D";Ie(iF);class oF extends sF{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Sn(i),Is(s),Z3(e,n,r,s,i,"avg")}}oF.className="AveragePooling3D";Ie(oF);class aF extends gt{constructor(e){super(e),this.inputSpec=[new Wn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new ht}}class lF extends aF{constructor(e){super(e||{})}call(e,n){return pe(()=>{const r=rt(e);return On(r,1)})}}lF.className="GlobalAveragePooling1D";Ie(lF);class uF extends aF{constructor(e){super(e||{})}call(e,n){return pe(()=>{const r=rt(e);return yi(r,1)})}}uF.className="GlobalMaxPooling1D";Ie(uF);class cF extends gt{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Sn(this.dataFormat),this.inputSpec=[new Wn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new ht}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class hF extends cF{call(e,n){return pe(()=>{const r=rt(e);return this.dataFormat==="channelsLast"?On(r,[1,2]):On(r,[2,3])})}}hF.className="GlobalAveragePooling2D";Ie(hF);class dF extends cF{call(e,n){return pe(()=>{const r=rt(e);return this.dataFormat==="channelsLast"?yi(r,[1,2]):yi(r,[2,3])})}}dF.className="GlobalMaxPooling2D";Ie(dF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fF extends gt{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,r={}){const s=n.layer,i=Zi(s,r);delete n.layer;const o={layer:i};return Object.assign(o,n),new e(o)}}class pF extends fF{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Et(e),e.length<3)throw new Q(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Et(e);const n=[e[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(n),s=e[1];return[r[0],s].concat(r.slice(1))}call(e,n){return pe(()=>(e=rt(e),S3((o,a)=>[rt(this.layer.call(o,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}pF.className="TimeDistributed";Ie(pF);function OQ(t){jl(tZ,"BidirectionalMergeMode",t)}const FQ="concat";class mF extends fF{constructor(e){super(e);const n=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=n,this.forwardLayer=Zi(r),n.goBackwards=n.goBackwards!==!0;const s={};if(s.className=e.layer.getClassName(),s.config=n,this.backwardLayer=Zi(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?FQ:e.mergeMode,OQ(this.mergeMode),e.weights)throw new ht("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,r=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let r,s,i;return this.returnState&&(i=n.slice(1)),r=n[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,s=[r]):this.mergeMode==null?s=[r,r.slice()]:s=[r],this.returnState?this.mergeMode==null?s.concat(i).concat(i.slice()):[r].concat(i).concat(i.slice()):Mr(s)}apply(e,n){let r=n==null?null:n.initialState,s=n==null?null:n.constants;n==null&&(n={});const i=C3(e,r,s,this.numConstants);if(e=i.inputs,r=i.initialState,s=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(r==null||r.length===0)&&s==null)return super.apply(e,n);const o=[],a=[];if(r!=null){const u=r.length;if(u%2>0)throw new Q("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,o.push(...r);const c=r.map(h=>new Wn({shape:h.shape}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),a.push(...c)}if(s!=null)throw new ht("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof zi;for(const u of o)if(u instanceof zi!==l)throw new Q("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[e].concat(o),c=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=c;const d=super.apply(u,n);return this.inputSpec=h,d}else return super.apply(e,n)}call(e,n){return pe(()=>{const r=n.initialState;let s,i;if(r==null)s=this.forwardLayer.call(e,n),i=this.backwardLayer.call(e,n);else{const l=r.slice(0,r.length/2),u=r.slice(r.length/2);s=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(n,{initialState:u}))}let o;this.returnState&&(Array.isArray(s)&&(o=s.slice(1).concat(i.slice(1))),s=s[0],i=i[0]),this.returnSequences&&(i=kl(i,1));let a;return this.mergeMode==="concat"?a=_C([s,i]):this.mergeMode==="sum"?a=Ae(s,i):this.mergeMode==="ave"?a=ee(.5,Ae(s,i)):this.mergeMode==="mul"?a=ee(s,i):this.mergeMode==null&&(a=[s,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){il(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),il(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[n,n]:r=n:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(r)?r.concat(i).concat(i):[r].concat(i).concat(i)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const r=Zi(n.layer);if(delete n.layer,n.numConstants!=null)throw new ht("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const s=n;return s.layer=r,new e(s)}}mF.className="Bidirectional";Ie(mF);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class gF extends gt{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return pe(()=>(e=rt(e),e.dtype!=="float32"&&(e=Xi(e,"float32")),Ae(ee(e,this.scale),this.offset)))}}gF.className="Rescaling";Ie(gF);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:LQ,cropAndResize:PQ}=po;class vF extends gt{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,r,s,i,o,a,l){return pe(()=>{let u,c=!1;const h=n/o,d=r/a,f=(s+n)/o,m=(i+r)/a,v=[h,d,f,m],p=[];e.rank===3?(c=!0,u=ga([e])):u=e;for(let w=0;w<u.shape[0];w++)p.push(v);const g=$h(p,[p.length,4]),y=ad(0,p.length,1,"int32"),x=PQ(u,g,y,[s,i],"nearest");return Xi(c?rt(El(x)):x,l)})}upsize(e,n,r,s){return pe(()=>{const i=LQ(e,[n,r]);return Xi(i,s)})}call(e,n){return pe(()=>{const r=rt(e),s=r.dtype,i=r.shape,o=i[i.length-3],a=i[i.length-2];let l=0;o!==this.height&&(l=Math.floor((o-this.height)/2));let u=0;return a!==this.width&&(u=Math.floor((a-this.width)/2),u===0&&(u=1)),l>=0&&u>=0?this.centerCrop(r,l,u,this.height,this.width,o,a,s):this.upsize(e,this.height,this.width,s)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Et(e);const n=e.length-3,r=e.length-2;return e[n]=this.height,e[r]=this.width,e}}vF.className="CenterCrop";Ie(vF);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function MQ(t,e,n,r){let s=rt(t);if(s.dtype!=="int32"&&(s=Xi(s,"int32")),e==="int")return s;const i=s.shape;if(s.rank===0&&(s=Pr(s,-1)),e==="oneHot"&&s.shape[s.shape.length-1]!==1&&(s=Pr(s,-1)),s.rank>2)throw new Q(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${s.rank}.`);const o=["multiHot","oneHot"].includes(e),a=s;let l;if(typeof r<"u"&&e==="count"?l=hI(a,r,n,o):l=hI(a,[],n,o),e!=="tfIdf")return l;if(r)return ee(l,r);throw new Q("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class yF extends gt{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=Et(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return pe(()=>{e=rt(e),e.dtype!=="int32"&&(e=Xi(e,"int32"));let r;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new Q(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);r=rt(n.countWeights)}const s=yi(e),i=Xm(e),o=Es(this.numTokens,s).bufferSync().get(0),a=zl(i,0).bufferSync().get(0);if(!(o&&a))throw new Q(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return MQ(e,this.outputMode,this.numTokens,r)})}}yF.className="CategoryEncoding";Ie(yF);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const BQ=["bilinear","nearest"],HI=new Set(BQ);class xF extends gt{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(HI.has(e.interpolation))this.interpolation=e.interpolation;else throw new Q(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Et(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return pe(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return po.resizeBilinear(e,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return po.resizeNearestNeighbor(e,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...HI]} are supported`)})}}xF.className="Resizing";Ie(xF);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class bF{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}bF.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class wF extends gt{constructor(e){super(e),this.randomGenerator=new bF(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}wF.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const zQ=["bilinear","nearest"],qI=new Set(zQ);class CF extends wF{constructor(e){super(e);const{factor:n,interpolation:r="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new Q(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new Q(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new Q(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(qI.has(r))this.interpolation=r;else throw new Q(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Et(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return pe(()=>{const r=rt(e);this.imgHeight=r.shape[r.shape.length-3];const s=r.shape[r.shape.length-2];this.widthFactor=Pf([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*s;i=Math.round(i);const o=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return po.resizeBilinear(e,o);case"nearest":return po.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...qI]} are supported`)}})}}CF.className="RandomWidth";Ie(CF);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UQ=me();UQ.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var KI;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(KI||(KI={}));var XI;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(XI||(XI={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var YI;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(YI||(YI={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qe(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&F(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VQ=yR;class Fv extends xw{nextDataId(){return Fv.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new UD(this,Ri())}write(e,n,r){this.firstUse&&(this.firstUse=!1,me().get("IS_NODE")&&gs(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:r,refCount:1}),s}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&Md(r[0])){const i=r.map(o=>ua(o));s=this.write(i,e,n)}else s=this.write(r,e,n);return{dataId:s,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,r,s,i){this.data.set(e,{values:n,dtype:s,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:r}=this.data.get(e);if(n==="complex64"){const s=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return Eo(s,i)}return Z5(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>ma(s));return pt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return pt(e.shape,e.dtype,n)}makeOutput(e,n,r){return Ri().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=Lr();return e(),{kernelMs:Lr()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){qe([e],"where");const n=this.readSync(e.dataId);return VQ(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Fv.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SF(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const WQ=t=>{const{x:e}=t.inputs,n=t.backend;qe(e,"abs");let r=new Float32Array(be(e.shape));const s=n.data.get(e.dataId).values;return r=SF(s),n.makeOutput(r,e.shape,e.dtype)},GQ={kernelName:f0,backendName:"cpu",kernelFunc:WQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kn(t){return(e,n,r,s,i)=>{const o=ut(e,n),a=o.length,l=Qe(o),u=be(o),c=gr(i,u),h=e.length,d=n.length,f=Qe(e),m=Qe(n),v=tc(e,o),p=tc(n,o);if(v.length+p.length===0)for(let g=0;g<c.length;++g)c[g]=t(r[g%r.length],s[g%s.length]);else for(let g=0;g<c.length;++g){const y=bc(g,a,l),b=y.slice(-h);v.forEach(S=>b[S]=0);const x=Hi(b,h,f),w=y.slice(-d);p.forEach(S=>w[S]=0);const C=Hi(w,d,m);c[g]=t(r[x],s[C])}return[c,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zr(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,a=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(s.shape,"float32",o)},a}const jQ={kernelName:Aw,backendName:"cpu",kernelFunc:Zr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cg(t,e,n="float32"){if(n==="complex64"){const s=cg(t,e,"float32"),i=cg(t,e,"float32");return Zr({inputs:{real:s,imag:i},backend:t})}const r=vr(be(e),n);return t.makeTensorInfo(e,n,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eo(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const HQ={kernelName:of,backendName:"cpu",kernelFunc:eo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tl(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,i)}const qQ={kernelName:n2,backendName:"cpu",kernelFunc:Tl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kF(t,e,n,r){if(r==="int32"){const s=Int32Array.from(t);return[e,"int32",s]}if(r==="bool"){const s=Bl([0],n),[i,o]=kn((a,l)=>a!==l?1:0)(e,[],t,s,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function wa(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return eo({inputs:{x:s},backend:n});const c=cg(n,s.shape,s.dtype),h=wa({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),d=Zr({inputs:{real:h,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),d}if(s.dtype==="complex64"){const c=Tl({inputs:{input:s},backend:n}),h=wa({inputs:{x:c},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(c),h}if(!GD(s.dtype,i)){const c=eo({inputs:{x:s},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:i}}const o=n.data.get(s.dataId).values,[a,l,u]=kF(o,s.shape,s.dtype,i);return n.makeTensorInfo(a,l,u)}const KQ={kernelName:Hd,backendName:"cpu",kernelFunc:wa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qn(t,e,n,r){return n==null?({inputs:s,backend:i})=>{const{a:o,b:a}=s,l=i;qe([o,a],t);const u=l.data.get(o.dataId).values,c=l.data.get(a.dataId).values,h=o.dtype==="string"?Io(u):u,d=o.dtype==="string"?Io(c):c,f=r||o.dtype,[m,v]=e(o.shape,a.shape,h,d,f);return l.makeTensorInfo(v,f,m)}:({inputs:s,backend:i})=>{const{a:o,b:a}=s,l=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const u=wa({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),h=c.complexTensorInfos.real,d=c.complexTensorInfos.imag,f=l.data.get(h.dataId).values,m=l.data.get(d.dataId).values,v=wa({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),p=l.data.get(v.dataId),g=p.complexTensorInfos.real,y=p.complexTensorInfos.imag,b=l.data.get(g.dataId).values,x=l.data.get(y.dataId).values,[w,C,S]=n(o.shape,a.shape,f,m,b,x),E=l.makeTensorInfo(S,"float32",w),T=l.makeTensorInfo(S,"float32",C),_=Zr({inputs:{real:E,imag:T},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(v),l.disposeIntermediateTensorInfo(E),l.disposeIntermediateTensorInfo(T),_}else{const u=l.data.get(o.dataId).values,c=l.data.get(a.dataId).values,h=r||o.dtype,[d,f]=e(o.shape,a.shape,u,c,h);return l.makeTensorInfo(f,h,d)}}}function qC(t){return(e,n,r,s,i,o)=>{const a=ut(e,n),l=be(a),u=a.length,c=Qe(a),h=gr("float32",l),d=gr("float32",l),f=tc(e,a),m=tc(n,a),v=Eo(r,s),p=Eo(i,o),g=e.length,y=Qe(e),b=n.length,x=Qe(n);if(f.length+m.length===0)for(let w=0;w<h.length;w++){const C=w%v.length,S=w%p.length,E=t(v[C*2],v[C*2+1],p[S*2],p[S*2+1]);h[w]=E.real,d[w]=E.imag}else for(let w=0;w<h.length;w++){const C=bc(w,u,c),S=C.slice(-g);f.forEach(L=>S[L]=0);const E=Hi(S,g,y),T=C.slice(-b);m.forEach(L=>T[L]=0);const _=Hi(T,b,x),A=t(v[E*2],v[E*2+1],p[_*2],p[_*2+1]);h[w]=A.real,d[w]=A.imag}return[h,d,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EF=kn((t,e)=>t+e),XQ=qC((t,e,n,r)=>({real:t+n,imag:e+r})),ic=qn(wc,EF,XQ),YQ={kernelName:wc,backendName:"cpu",kernelFunc:ic};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KC(t,e,n,r,s){const i=be(r),o=vr(s,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=s||(i>0?o[l]+=e[a]:o[l]+=1)}return o}function IF(t,e,n,r=!1){const s=t.shape[0],i=t.shape[1],o=pt([s,n],e.dtype);for(let a=0;a<s;a++)for(let l=0;l<i;l++){const u=t.get(a,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?o.set(1,a,u):e.size>0?o.set(o.get(a,u)+e.get(a,l),a,u):o.set(o.get(a,u)+1,a,u))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TF=kn((t,e)=>t&e),ZQ=qn(Dw,TF),QQ={kernelName:Dw,backendName:"cpu",kernelFunc:ZQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function so(t){return(e,n,r)=>{const s=xn(n,e.length);for(let i=0;i<e.length;++i)s[i]=t(e[i],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ft(t,e,n){const r=so(e);return Oa(t,r,n)}function Oa(t,e,n){return({inputs:r,attrs:s,backend:i})=>{const{x:o}=r;qe(o,t);const a=i,l=a.data.get(o.dataId).values;let u;if(o.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=Io(l)}else u=l;const c=n||o.dtype,h=e(u,c,s);return a.makeTensorInfo(o.shape,c,h)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _F=so(t=>Math.ceil(t)),JQ=Oa(qd,_F),eJ={kernelName:qd,backendName:"cpu",kernelFunc:JQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NF(t,e,n,r){const s=xn(n,be(e));if(r&&n!=="string"){let i=0;t.forEach(o=>{const a=be(o.shape);s.set(o.vals,i),i+=a})}else{let i=0;t.forEach(o=>{const a=n==="string"?Io(o.vals):o.vals;let l=0;for(let u=0;u<o.shape[0];++u){const c=u*e[1]+i;for(let h=0;h<o.shape[1];++h)s[c+h]=a[l++]}i+=o.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $F=kn((t,e)=>t===e?1:0),DF=qn(_0,$F,null,"bool"),tJ={kernelName:_0,backendName:"cpu",kernelFunc:DF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AF=so(t=>Math.exp(t)),RF=Oa(ef,AF,"float32"),nJ={kernelName:ef,backendName:"cpu",kernelFunc:RF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OF=so(t=>Math.expm1(t)),rJ=Oa(tf,OF),sJ={kernelName:tf,backendName:"cpu",kernelFunc:rJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FF=so(t=>Math.floor(t)),iJ=Oa(nf,FF),oJ={kernelName:nf,backendName:"cpu",kernelFunc:iJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LF=kn((t,e)=>Math.floor(t/e)),aJ=qn(rf,LF,null,"int32"),lJ={kernelName:rf,backendName:"cpu",kernelFunc:aJ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PF(t,e,n,r,s,i,o,a,l){const u=pt([r,i],n);for(let c=0;c<r;c++){const h=[];let d=0;for(let f=0;f<s;f++){const m=t[c*s+f];d+=m*o[f],h.push(m)}if(d<0||d>=l/i)throw new Error(`Invalid indices: ${h} does not index into ${a}`);for(let f=0;f<i;f++)u.values[c*i+f]=e.get(...e.indexToLoc(d*i+f))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MF(t,e,n){const r=pt(n,t.dtype);for(let s=0;s<r.size;++s){const o=r.indexToLoc(s).slice(),a=o[0],l=o[2],u=e.locToIndex([a,l]);o[2]=e.values[u];const c=t.locToIndex(o);0<=c&&c<t.values.length&&(r.values[s]=t.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BF=kn((t,e)=>t>e?1:0),uJ=qn(A0,BF,null,"bool"),cJ={kernelName:A0,backendName:"cpu",kernelFunc:uJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zF=kn((t,e)=>t>=e?1:0),hJ=qn(sf,zF,null,"bool"),dJ={kernelName:sf,backendName:"cpu",kernelFunc:hJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UF=kn((t,e)=>t<e?1:0),fJ=qn(O0,UF,null,"bool"),pJ={kernelName:O0,backendName:"cpu",kernelFunc:fJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VF=kn((t,e)=>t<=e?1:0),mJ=qn(F0,VF,null,"bool"),gJ={kernelName:F0,backendName:"cpu",kernelFunc:mJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WF(t,e,n){const r=(e-t)/(n-1),s=vr(n,"float32");s[0]=t;for(let i=1;i<s.length;i++)s[i]=s[i-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GF=so(t=>Math.log(t)),vJ=Oa(cf,GF),yJ={kernelName:cf,backendName:"cpu",kernelFunc:vJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jF(t,e,n,r){const s=gr(r,be(n));for(let i=0;i<s.length;++i){const o=i*e;let a=t[o];for(let l=0;l<e;++l){const u=t[o+l];(Number.isNaN(u)||u>a)&&(a=u)}s[i]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HF=kn((t,e)=>Math.max(t,e)),xJ=qn(df,HF),bJ={kernelName:df,backendName:"cpu",kernelFunc:xJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qF=kn((t,e)=>Math.min(t,e)),wJ=qn(ff,qF),CJ={kernelName:ff,backendName:"cpu",kernelFunc:wJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XC=kn((t,e)=>t*e),SJ=qC((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})),Lv=qn(mf,XC,SJ),kJ={kernelName:mf,backendName:"cpu",kernelFunc:Lv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KF(t,e,n){const r=Ta(-1,n);return XC([],e,r,t,n)}function EJ(t){const{inputs:e,backend:n}=t,{x:r}=e;qe(r,"neg");const s=n.data.get(r.dataId).values,[i,o]=KF(s,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,i)}const IJ={kernelName:H0,backendName:"cpu",kernelFunc:EJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XF=kn((t,e)=>t!==e?1:0),TJ=qn(q0,XF,null,"bool"),_J={kernelName:q0,backendName:"cpu",kernelFunc:TJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YC(t,e,n,r,s){const i=e.length,o=be(e),a=Qe(e),l=Qe(s),u=gr(n,be(s));for(let c=0;c<o;++c){const h=bc(c,i,a),d=new Array(h.length);for(let m=0;m<d.length;m++)d[m]=h[r[m]];const f=Hi(d,i,l);u[f]=t[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vr(t){const{inputs:e,attrs:n,backend:r}=t,{x:s}=e,{perm:i}=n;qe(s,"transpose");const o=s.shape.length,a=new Array(o);for(let h=0;h<a.length;h++)a[h]=s.shape[i[h]];const l=r.data.get(s.dataId).values,u=YC(l,s.shape,s.dtype,i,a);return{dataId:r.write(u,a,s.dtype),shape:a,dtype:s.dtype}}const NJ={kernelName:Mu,backendName:"cpu",kernelFunc:Vr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YF(t,e,n,r){const[s,i]=tr(t,r),o=is(e,"int32"),a=vr(be(s),o),l=be(i);for(let u=0;u<a.length;++u){const c=u*l;let h=1;for(let d=0;d<l;++d)h*=n[c+d];a[u]=h}return{outVals:a,outShape:s,outDtype:o}}function $J(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;qe(s,"prod");const a=s.shape.length,l=mt(i,s.shape),u=hn(l,a);let c=l,h=s;const d=[];u!=null&&(h=Vr({inputs:{x:s},backend:n,attrs:{perm:u}}),d.push(h),c=Cn(c.length,a));const f=n.data.get(h.dataId).values,{outVals:m,outShape:v,outDtype:p}=YF(h.shape,h.dtype,f,c);let g=v;return o&&(g=Fn(v,l)),d.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(g,p,m)}const DJ={kernelName:J0,backendName:"cpu",kernelFunc:$J};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AJ(t,e,n){t.forEach((r,s)=>{if(r<0||r>=n){const i=bc(s,e.length,Qe(e)).join(",");throw new Error(`indices[${i}] = ${r} is not in [0, ${n})`)}})}function RJ(t,e){for(let n=0;n<t.length;++n){const r=t[n],s=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function OJ(t,e,n,r){const s=[];let i=0;const o=e.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);RJ(n,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let h=1;h<l+1;++h)a[u].push(h*c)}for(let u=0;u<t.length;++u){let c=t[u],h=t[u]+1;for(let d=0;d<n.length;++d){const f=n[d],m=d+e.length-1;if(m>=0){const v=a[m],p=v[v.length-1]-f[c];for(let g=c;g<h;++g)a[m].push(f[g+1]+p)}c=f[c],h=f[h]}h!==c&&(s.push([c,h]),i+=h-c)}return{outSplits:a,valueSlices:s,numValues:i}}function FJ(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,s=xn("int32",r);e.push(s),t[n].forEach((i,o)=>s[o]=i)}return e}function ZI(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function LJ(t,e,n,r,s,i){const o=ZI(e,2)[1],a=ZI(i,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let h=0;h<r;++h)s[l*a+h]=t[c*o+h];++l}}function PJ(t,e,n,r,s){const i=e.slice();i[0]=s;const o=xn(n,be(i)),a=t.length,l=a===0?0:a/e[0];return LJ(t,e,r,l,o,i),[o,i]}function ZF(t,e,n,r,s,i,o,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(AJ(i,o,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:h,numValues:d}=OJ(i,o,t,u),f=FJ(c),m=PJ(n,r,s,h,d);return[f,m[0],m[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QI=2147483647;function QF(t,e,n,r,s,i,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=s.length===0,u=o.length===0,c=[];a||c.push(e[0]),l||c.push(s[0]),u||c.push(o[0]);for(let p=1;p<c.length;++p)if(c[p]!==c[p-1])throw new Error("starts, limits, and deltas must have the same shape");const h=c.length===0?1:c[0],d=xn("int32",h+1);d[0]=0;for(let p=0;p<h;++p){const g=a?t[0]:t[p],y=l?r[0]:r[p],b=u?i[0]:i[p];if(b===0)throw new Error("Requires delta != 0");let x;if(b>0&&y<g||b<0&&y>g)x=0;else if(x=Math.ceil(Math.abs((y-g)/b)),x>QI)throw new Error(`Requires ((limit - start) / delta) <= ${QI}`);d[p+1]=d[p]+x}const f=d[h],m=xn(n,f);let v=0;for(let p=0;p<h;++p){const g=d[p+1]-d[p];let y=a?t[0]:t[p];const b=u?i[0]:i[p];for(let x=0;x<g;++x)m[v++]=y,y+=b}return[d,m]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Os=di;class hg{constructor(e,n,r,s,i,o,a,l,u,c){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=s,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=BR(c),this.raggedRank=zR(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Os.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Os.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Os.VALUE_ROWIDS:return hg.getMaxWidthValueRowID(n);case Os.ROW_SPLITS:return hg.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Os[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let s=0;s<n-1;++s){const i=e[s+1]-e[s];i>r&&(r=i)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,s=e[0],i=0;for(let o=1;o<n;++o){const a=e[o];a!==s&&(s=a,i=Math.max(o-r,i),r=o)}return Math.max(n-r,i)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return eT(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;UR(r,n);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=MR(this.raggedRank,s,n);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,n,r){const s=Math.min(e,r),i=[];let o=0;for(let a=0;a<s;++a,o+=n)i.push(o);for(let a=s;a<e;++a)i.push(-1);return F(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,r,s){const i=e.length,o=[];for(let a=0;a<i-1;++a){const l=e[a+1]-e[a];let u=Math.min(s,l),c=n[a];c===-1&&(u=0);for(let h=0;h<u;++h)o.push(c),c+=r;for(let h=0;h<l-u;++h)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,r,s){const i=e.length,o=[];if(i===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];o.push(u);for(let c=1;c<i;++c){const h=e[c];if(h===l)u>=0&&(++a,a<s?u+=r:u=-1);else{if(a=0,l=h,h>=n.length)throw new Error(`Got nextValueRowId=${h} which is not less than ${n.length}`);u=n[h]}o.push(u)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,r,s){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case Os.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,r,s);case Os.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,r,s);default:throw new Error(`Unsupported partition type: ${Os[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Os.FIRST_DIM_SIZE:return e[0];case Os.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Os.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Os[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let l=s.length-2;l>=0;--l)s[l]=s[l+1]*r[l+1];const i=eT(r,!1),o=xn(this.valuesDType,be(i));if(s[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,s[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,s[u],r[u]);this.setOutput(this.raggedRank,l,o,i)}return[i,o]}setOutput(e,n,r,s){if(r.length===0)return;const i=this.values,o=r;let a=s.slice();a=a.slice(e+1);const l=be(a),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const m=this.defaultValueShape;pe(()=>{const v=ae(c,m);c=Dh(v,a).dataSync()})}let h=0,d=0,f=0;for(let m=0;m<=u;++m){let v=m<u?n[m]:-1;if(v===f){++f;continue}if(d<f){const p=i.subarray(h*l),g=o.subarray(d*l),y=(f-d)*l;JI(g,p,y)}if(m>=u){const p=r.length;v=Math.floor(p/l)}if(v>f)if(this.defaultValue.length===1)o.subarray(f*l,v*l).fill(this.defaultValue[0]),f=v;else for(;v>f;){const p=o.slice(f*l);JI(p,c,l),++f}v<0?(h=m+1,d=f):(h=m,d=f,f=d+1)}}}function JI(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function eT(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function JF(t,e,n,r,s,i,o,a,l,u){return new hg(t,e,n,r,s,i,o,a,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eL(t,e,n,r){const s=t===e,i=t<e&&n<0,o=e<t&&n>1;if(s||i||o)return vr(0,r);const a=Math.abs(Math.ceil((e-t)/n)),l=vr(a,r);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tL=so(t=>1/Math.sqrt(t)),MJ=Oa(wf,tL),BJ={kernelName:wf,backendName:"cpu",kernelFunc:MJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tl(t,e,n,r,s,i,o,a,l,u){const c=[r/s,s],h=t.values,d=e.values;if(r===0)return pt(n,e.dtype);const f=l instanceof ar?l:pt(c,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let m=0;m<i;m++){const v=[];let p=0;for(let g=0;g<o;g++){const y=h[m*o+g];v.push(y),p+=y*a[g]}if(p<0||p>=r/s)throw new Error(`Invalid indices: ${v} does not index into ${n}`);for(let g=0;g<s;g++)u?f.values[p*s+g]+=d[m*s+g]:f.values[p*s+g]=e.rank===0?d[0]:d[m*s+g]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zJ=so(t=>1/(1+Math.exp(-t))),nL=Ft(If,t=>1/(1+Math.exp(-t))),UJ={kernelName:If,backendName:"cpu",kernelFunc:nL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rL(t,e,n,r,s){const i=rC(r,e,n),o=be(n),a=Qe(r);if(i){const h=sC(e,a);return s==="string"?t.slice(h,h+o):t.subarray(h,h+o)}const l=s==="string"?Io(t):t,u=pt(r,s,l),c=pt(n,s);for(let h=0;h<c.size;++h){const d=c.indexToLoc(h),f=d.map((m,v)=>m+e[v]);c.set(u.get(...f),...d)}return s==="string"?aO(c.values):c.values}function _l(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,size:o}=r;qe(s,"slice");const[a,l]=wv(s,i,o);tC(s,a,l);const u=n.data.get(s.dataId).values,c=rL(u,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,c)}const VJ={kernelName:iv,backendName:"cpu",kernelFunc:_l};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sL(t,e,n,r,s,i,o){const a=e[0],l=i[0],u=new Array(l),c=new Array(a),h=e[1];if(l===0){if(a!==0)throw new Error(KR(a));const p=xn(n,0),g=xn(s,0);return[p,[0,h],g,u,c]}let d=!0,f=0;const m=new Array(l).fill(0);for(let p=0;p<a;++p){const g=t[p*h];if(g<0)throw new Error(XR(p,g));if(g>=l)throw new Error(YR(p,g,l));++m[g],d=d&&g>=f,f=g}let v=!0;for(let p=0;p<l;++p){const g=m[p]===0;u[p]=g,v=v&&!g,m[p]=Math.max(m[p],1),p>0&&(m[p]+=m[p-1])}if(v&&d){const p=t,g=r;for(let y=0;y<a;++y)c[y]=y;return[p,[a,h],g,u,c]}else{const p=m[l-1],g=xn(n,p*h),y=xn(s,p),b=new Array(l).fill(0);for(let x=0;x<a;++x){const w=t[x*h],C=b[w],S=(w===0?0:m[w-1])+C;b[w]++;for(let E=0;E<h;++E)g[S*h+E]=t[x*h+E];y[S]=r[x],c[x]=S}for(let x=0;x<l;++x)if(b[x]===0){const C=x===0?0:m[x-1];g[C*h+0]=x;for(let S=1;S<h;++S)g[C*h+S]=0;y[C]=o}return[g,[p,h],y,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iL(t,e,n,r,s){const i=be(r),o=e[0],a=s.length,l=[];let u=1,c=-1;for(let p=0;p<a;++p){const g=s[p];if(g===-1){if(c!==-1)throw new Error(ZR(c,p));c=p,l.push(1)}else{if(g<0)throw new Error(QR(p,g));u*=g,l.push(g)}}if(c!==-1){if(u<=0)throw new Error(JR());const p=Math.trunc(i/u);if(u*p!==i)throw new Error(eO(r,l));l[c]=p}if(be(l)!==i)throw new Error(tO(r,l));const d=r.length,f=[];if(d>0){f[d-1]=1;for(let p=d-2;p>=0;--p)f[p]=f[p+1]*r[p+1]}const m=[];if(a>0){m[a-1]=1;for(let p=a-2;p>=0;--p)m[p]=m[p+1]*l[p+1]}const v=xn(n,o*a);for(let p=0;p<o;++p){let g=0;for(let y=0;y<d;++y)g+=t[p*d+y]*f[y];for(let y=0;y<a;++y)v[p*a+y]=Math.trunc(g/m[y]),g%=m[y]}return[v,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZC(t,e,n,r,s,i=!1,o=0){const a=r.length,l=[e[0],t.length/e[0]],u=l[1],h=a>0?s[a-1]+1:0;if(h<0)throw new Error(Fx());const d=e.slice();d[0]=h;const f=d.reduce((b,x)=>b*x,1),m=xn(n,f);if(a===0)return h>0&&m.fill(o),[m,d];if(h<=0)throw new Error(Fx());let v=0,p=1,g=0,y=s[v];for(;;){let b=0;if(p<a){if(b=s[p],y===b){++p;continue}if(y>=b)throw new Error(nO())}if(y<0||y>=h)throw new Error(rO(y,h));y>g&&m.fill(o,g*u,y*u);for(let x=v;x<p;++x){const w=r[x];if(w<0||w>=l[0])throw new Error(sO(x,r[x],l[0]));for(let C=0;C<u;C++)m[y*u+C]+=t[w*u+C]}if(i)for(let x=0;x<u;x++)m[y*u+x]/=p-v;if(v=p,++p,g=y+1,y=b,p>a)break}return g<h&&m.fill(o,g*u,h*u),[m,d]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WJ=so(t=>Math.sqrt(t)),GJ=Ft(_f,t=>Math.sqrt(t)),jJ={kernelName:_f,backendName:"cpu",kernelFunc:GJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oL=kn((t,e)=>{const n=t-e;return n*n}),HJ=qn(Nf,oL),qJ={kernelName:Nf,backendName:"cpu",kernelFunc:HJ};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aL=so((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:s}=e;return t.replace(new RegExp(n,r?"g":""),s)}),KJ=Oa(o2,aL),XJ={kernelName:o2,backendName:"cpu",kernelFunc:KJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lL(t,e,n,r){const s=pt(t,e.dtype);for(let i=0;i<s.size;i++){const o=s.indexToLoc(i),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*n[l]+r[l];s.set(e.get(...a),...o)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YJ{constructor(e,n,r,s,i,o){this.separator=ua(e),this.nGramWidths=n,this.leftPad=ua(r),this.rightPad=ua(s),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,s,i,o){for(let a=0;a<i;++a){const l=this.getPadWidth(o),u=Math.max(0,l-a),c=Math.max(0,l-(i-(a+1))),h=o-(u+c),d=n+(u>0?0:a-l);let f=0;f+=u*this.leftPad.length;for(let y=0;y<h;++y)f+=e[d+y].length;f+=c*this.rightPad.length;const m=u+c+h-1;f+=m*this.separator.length,r[s+a]=new Uint8Array(f);const v=r[s+a];let p=0;const g=y=>y.forEach(b=>v[p++]=b);for(let y=0;y<u;++y)g(this.leftPad),g(this.separator);for(let y=0;y<h-1;++y)g(e[d+y]),g(this.separator);if(h>0){g(e[d+h-1]);for(let y=0;y<c;++y)g(this.separator),g(this.rightPad)}else{for(let y=0;y<c-1;++y)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,n){const r=e.length,s=n.length;if(s>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<s;++u){let c=n[u]>=l;if(c=c&&n[u]<=r,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${r}]`);l=n[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const i=s-1,o=xn("int32",s);if(r===0||s===0){const l=new Array(r);for(let u=0;u<=i;++u)o[u]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(h=>{c+=this.getNumNGrams(u,h)}),this.preserveShort&&u>0&&c===0&&(c=1),o[l]=o[l-1]+c}const a=new Array(o[i]);for(let l=0;l<i;++l){const u=n[l];let c=o[l];if(this.nGramWidths.forEach(h=>{const d=n[l+1]-n[l],f=this.getNumNGrams(d,h);this.createNGrams(e,u,a,c,f,h),c+=f}),this.preserveShort&&c===o[l]){const h=n[l+1]-n[l];if(h===0)continue;const d=h+2*this.padWidth,f=1;this.createNGrams(e,u,a,c,f,d)}}return[a,o]}}function uL(t,e,n,r,s,i,o,a){return new YJ(n,r,s,i,o,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZJ(t,e,n,r){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)r.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const a=t.subarray(0,o);(!n||a.length!==0)&&r.push(a),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&r.push(t);return}let s=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(s,i);(!n||o.length!==0)&&r.push(o),s=i+1}}function cL(t,e,n){const r=t.length,s=[];let i=0,o=0;const a=new Array(r);for(let d=0;d<r;++d){const f=s.length;ZJ(t[d],e,n,s);const m=s.length-f;a[d]=m,i+=m,o=Math.max(o,m)}const l=xn("int32",i*2),u=new Array(i),c=[r,o];let h=0;for(let d=0;d<r;++d)for(let f=0;f<a[d];++f)l[h*2]=d,l[h*2+1]=f,u[h]=s[h],++h;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hL(t,e){const n=xn("int32",t.length);for(let r=0;r<t.length;++r)n[r]=gG(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dL=kn((t,e)=>t-e),QJ=qC((t,e,n,r)=>({real:t-n,imag:e-r})),QC=qn($f,dL,QJ),JJ={kernelName:$f,backendName:"cpu",kernelFunc:QC};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fL(t,e){const n=new Array(t.rank);for(let s=0;s<n.length;s++)n[s]=t.shape[s]*e[s];const r=pt(n,t.dtype);for(let s=0;s<r.values.length;++s){const i=r.indexToLoc(s),o=new Array(t.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%t.shape[l];const a=t.locToIndex(o);r.values[s]=t.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ph=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function pL(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const a=r-n+1,l=e-n+1,u=Math.log(a),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(a-c)/a)*Math.sign(l-a/2),d=Math.max(n,Math.floor(e-l*c/a+h)),f=Math.min(r,Math.floor(e+(a-l)*c/a+h));pL(t,e,d,f)}const s=t[e];let i=n,o=r;for(hu(t,n,e),ph(t[r],s)>0&&hu(t,n,r);i<o;){for(hu(t,i,o),i++,o--;ph(t[i],s)<0;)i=i+1;for(;ph(t[o],s)>0;)o=o-1}ph(t[n],s)===0?hu(t,n,o):(o=o+1,hu(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}}function mL(t,e,n,r,s){const i=e[e.length-1],[o,a]=[t.length/i,i],l=gr(n,o*r),u=gr("int32",o*r);for(let h=0;h<o;h++){const d=h*a,f=t.subarray(d,d+a);let m=new Array(f.length);f.forEach((y,b)=>m[b]={value:y,index:b}),r<m.length&&(pL(m,r),m=m.slice(0,r)),s&&m.sort(ph);const v=h*r,p=l.subarray(v,v+r),g=u.subarray(v,v+r);for(let y=0;y<r;y++)p[y]=m[y].value,g[y]=m[y].index}const c=e.slice();return c[c.length-1]=r,[pt(c,n,l),pt(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gL(t,e,n,r){const s=mt(e,n)[0],i=[1,n[0],1];for(let m=0;m<s;m++)i[0]*=n[m];i[1]=n[s];for(let m=s+1;m<n.length;m++)i[2]*=n[m];const o=new Map,a=new Int32Array(n[s]),l=new ar(i,r,t),u=[],c=i[0]===1&&i[2]===1;for(let m=0;m<n[s];m++){let v;if(c)v=t[m].toString();else{const g=[];for(let y=0;y<i[0];y++)for(let b=0;b<i[2];b++)g.push(l.get(y,m,b));v=g.join(",")}const p=o.get(v);if(p!=null)a[m]=p;else{const g=o.size;o.set(v,g),a[m]=g,u.push(m)}}const h=i.slice();h[1]=o.size;const d=new ar(h,r);u.forEach((m,v)=>{for(let p=0;p<i[0];p++)for(let g=0;g<i[2];g++)d.set(l.get(p,m,g),p,v,g)});const f=n.slice();return f[s]=h[1],{outputValues:d.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eee=Object.freeze(Object.defineProperty({__proto__:null,addImpl:EF,bincountImpl:KC,bincountReduceImpl:IF,bitwiseAndImpl:TF,castImpl:kF,ceilImpl:_F,concatImpl:NF,equalImpl:$F,expImpl:AF,expm1Impl:OF,floorDivImpl:LF,floorImpl:FF,gatherNdImpl:PF,gatherV2Impl:MF,greaterEqualImpl:zF,greaterImpl:BF,lessEqualImpl:VF,lessImpl:UF,linSpaceImpl:WF,logImpl:GF,maxImpl:jF,maximumImpl:HF,minimumImpl:qF,multiplyImpl:XC,negImpl:KF,notEqualImpl:XF,prodImpl:YF,raggedGatherImpl:ZF,raggedRangeImpl:QF,raggedTensorToTensorImpl:JF,rangeImpl:eL,rsqrtImpl:tL,scatterImpl:tl,sigmoidImpl:zJ,simpleAbsImpl:SF,sliceImpl:rL,sparseFillEmptyRowsImpl:sL,sparseReshapeImpl:iL,sparseSegmentReductionImpl:ZC,sqrtImpl:WJ,squaredDifferenceImpl:oL,staticRegexReplaceImpl:aL,stridedSliceImpl:lL,stringNGramsImpl:uL,stringSplitImpl:cL,stringToHashBucketFastImpl:hL,subImpl:dL,tileImpl:fL,topKImpl:mL,transposeImpl:YC,uniqueImpl:gL},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */WA("cpu",()=>new Fv,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vL=Ft(Qd,t=>t>=0?t:Math.exp(t)-1),tee={kernelName:Qd,backendName:"cpu",kernelFunc:vL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yL(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:i}=r;qe([s],"leakyRelu");const o=be(s.shape),a=n.data.get(s.dataId).values,l=gr("float32",o);for(let u=0;u<a.length;u++)l[u]=a[u]<0?i*a[u]:a[u];return n.makeTensorInfo(s.shape,"float32",l)}const nee={kernelName:R0,backendName:"cpu",kernelFunc:yL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ree=kn((t,e)=>t<0?e*t:t);function xL(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e;qe([r,s],"prelu");const i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,[a,l]=ree(r.shape,s.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",a)}const see={kernelName:Q0,backendName:"cpu",kernelFunc:xL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bL=Ft(yf,t=>Math.max(0,t)),iee={kernelName:yf,backendName:"cpu",kernelFunc:bL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wL=Ft(xf,t=>Math.min(Math.max(0,t),6)),oee={kernelName:xf,backendName:"cpu",kernelFunc:wL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dg(t,e,n,r,s){if(n==="linear")return eo({inputs:{x:e},backend:t});if(n==="relu")return bL({inputs:{x:e},backend:t});if(n==="elu")return vL({inputs:{x:e},backend:t});if(n==="relu6")return wL({inputs:{x:e},backend:t});if(n==="prelu")return xL({inputs:{x:e,alpha:r},backend:t});if(n==="leakyrelu")return yL({inputs:{x:e},backend:t,attrs:{alpha:s}});if(n==="sigmoid")return nL({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xt(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:i}=r,o=be(s.shape),a=WD(i,o),l=be(a);F(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${s.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(s.dataId);const u=n.data.get(s.dataId);if(u.complexTensorInfos!=null){const c=u.complexTensorInfos.real,h=u.complexTensorInfos.imag;c.shape=a,h.shape=a}return{dataId:s.dataId,shape:a,dtype:s.dtype}}const aee={kernelName:ev,backendName:"cpu",kernelFunc:Xt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CL(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;qe([s,i],"matMul");const l=s.shape.length,u=i.shape.length,c=o?s.shape[l-2]:s.shape[l-1],h=a?i.shape[u-1]:i.shape[u-2],d=o?s.shape[l-1]:s.shape[l-2],f=a?i.shape[u-2]:i.shape[u-1],m=s.shape.slice(0,-2),v=i.shape.slice(0,-2),p=be(m),g=be(v),b=ut(s.shape.slice(0,-2),i.shape.slice(0,-2)).concat([d,f]);F(c===h,()=>`Error in matMul: inner shapes (${c}) and (${h}) of Tensors with shapes ${s.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const x=o?[p,c,d]:[p,d,c],w=a?[g,f,h]:[g,h,f],C=Xt({inputs:{x:s},backend:n,attrs:{shape:x}}),S=Xt({inputs:{x:i},backend:n,attrs:{shape:w}}),E=o?C.shape[1]:C.shape[2],T=o?C.shape[2]:C.shape[1],_=a?S.shape[1]:S.shape[2],A=Math.max(p,g),L=n.data.get(C.dataId).values,W=n.data.get(S.dataId).values,K=Qe(C.shape),R=Qe(S.shape),[M,U,D]=o?[K[0],1,K[1]]:[K[0],K[1],1],[B,X,ie]=a?[1,R[1],R[0]]:[R[1],1,R[0]],G=T*_,Z=pt([A,T,_],C.dtype),de=Z.values,ge=n.blockSize;for(let ye=0;ye<A;ye++){const j=ye%p,J=ye%g;for(let fe=0;fe<T;fe+=ge){const ve=Math.min(fe+ge,T);for(let we=0;we<_;we+=ge){const De=Math.min(we+ge,_);for(let Pe=0;Pe<E;Pe+=ge){const Ge=Math.min(Pe+ge,E);for(let Xe=fe;Xe<ve;Xe++)for(let Je=we;Je<De;Je++){let Ze=0;for(let it=Pe;it<Ge;it++){const dn=L[j*M+Xe*U+it*D],dt=W[it*B+Je*X+J*ie];Ze+=dn*dt}de[ye*G+(Xe*_+Je)]+=Ze}}}}}return n.disposeIntermediateTensorInfo(C),n.disposeIntermediateTensorInfo(S),n.makeTensorInfo(b,Z.dtype,Z.values)}const lee={kernelName:y0,backendName:"cpu",kernelFunc:CL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uee(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:h}=r;let d,f,m;const v=[];d=CL({inputs:{a:s,b:i},attrs:{transposeA:l,transposeB:u},backend:n}),o&&(f=ic({inputs:{a:d,b:o},backend:n}),v.push(d),d=f),c&&(m=dg(n,d,c,a,h),v.push(d),d=m);for(const g of v)n.disposeIntermediateTensorInfo(g);return d}const cee={kernelName:Wm,backendName:"cpu",kernelFunc:uee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hee=Ft(Bd,t=>Math.acos(t)),dee={kernelName:Bd,backendName:"cpu",kernelFunc:hee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fee=Ft(zd,t=>Math.acosh(t)),pee={kernelName:zd,backendName:"cpu",kernelFunc:fee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mee(t){const{inputs:e,backend:n}=t,r=e;qe(e,"addN");const s=r.map(a=>n.data.get(a.dataId).values),i=pt(r[0].shape,r[0].dtype),o=i.values;for(let a=0;a<r.length;a++){const l=s[a];for(let u=0;u<o.length;u++)o[u]+=l[u]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const gee={kernelName:Ew,backendName:"cpu",kernelFunc:mee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;qe(s,"all");const a=mt(i,s.shape);let l=a;const u=hn(l,s.shape.length);let c=s;u!=null&&(c=Vr({inputs:{x:s},backend:n,attrs:{perm:u}}),l=Cn(l.length,s.shape.length)),cr("all",l,c.shape.length);const[h,d]=tr(c.shape,l),f=be(d),m=vr(be(h),c.dtype),v=n.data.get(c.dataId).values;for(let g=0;g<m.length;++g){const y=g*f;let b=v[y];for(let x=0;x<f;++x){const w=v[y+x];b=b&&w}m[g]=b}u!=null&&n.disposeIntermediateTensorInfo(c);const p=n.makeTensorInfo(h,c.dtype,m);if(o){const g=Fn(h,a),y=Xt({inputs:{x:p},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(p),y}return p}const yee={kernelName:Iw,backendName:"cpu",kernelFunc:vee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;qe(s,"any");const a=mt(i,s.shape);let l=a;const u=hn(l,s.shape.length);let c=s;u!=null&&(c=Vr({inputs:{x:s},backend:n,attrs:{perm:u}}),l=Cn(l.length,s.shape.length)),cr("any",l,c.shape.length);const[h,d]=tr(c.shape,l),f=be(d),m=vr(be(h),c.dtype),v=n.data.get(c.dataId).values;for(let g=0;g<m.length;++g){const y=g*f;let b=v[y];for(let x=0;x<f;++x){const w=v[y+x];b=b||w}m[g]=b}u!=null&&n.disposeIntermediateTensorInfo(c);const p=n.makeTensorInfo(h,c.dtype,m);if(o){const g=Fn(h,a),y=Xt({inputs:{x:p},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(p),y}return p}const bee={kernelName:Tw,backendName:"cpu",kernelFunc:xee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;qe(s,"argMax");let o=mt(i,s.shape);const a=hn(o,s.shape.length);let l=s;const u=[];a!=null&&(l=Vr({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),o=Cn(o.length,l.shape.length)),o=[o[0]],cr("argMax",o,l.shape.length);const[c,h]=tr(l.shape,o),d=be(c),f=vr(d,"int32"),m=be(h),v=n.data.get(l.dataId).values;for(let p=0;p<f.length;++p){const g=p*m;let y=v[g],b=0;for(let x=0;x<m;++x){const w=v[g+x];w>y&&(y=w,b=x)}f[p]=b}return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),n.makeTensorInfo(c,"int32",f)}const Cee={kernelName:p0,backendName:"cpu",kernelFunc:wee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function See(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;qe(s,"argMin");let o=mt(i,s.shape);const a=hn(o,s.shape.length);let l=s;const u=[];a!=null&&(l=Vr({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),o=Cn(o.length,l.shape.length)),o=[o[0]],cr("argMin",o,l.shape.length);const[c,h]=tr(l.shape,o),d=be(c),f=vr(d,"int32"),m=be(h),v=n.data.get(l.dataId).values;for(let p=0;p<f.length;++p){const g=p*m;let y=v[g],b=0;for(let x=0;x<m;++x){const w=v[g+x];w<y&&(y=w,b=x)}f[p]=b}return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),n.makeTensorInfo(c,"int32",f)}const kee={kernelName:m0,backendName:"cpu",kernelFunc:See};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eee=Ft(Ud,t=>Math.asin(t)),Iee={kernelName:Ud,backendName:"cpu",kernelFunc:Eee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tee=Ft(Vd,t=>Math.asinh(t)),_ee={kernelName:Vd,backendName:"cpu",kernelFunc:Tee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nee=Ft(Wd,t=>Math.atan(t)),$ee={kernelName:Wd,backendName:"cpu",kernelFunc:Nee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dee=kn((t,e)=>Math.atan2(t,e)),Aee=qn(jd,Dee),Ree={kernelName:jd,backendName:"cpu",kernelFunc:Aee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oee=Ft(Gd,t=>Math.atanh(t)),Fee={kernelName:Gd,backendName:"cpu",kernelFunc:Oee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JC(t,e,n,r,s,i){const o=s.strideHeight,a=s.strideWidth,l=s.dilationHeight,u=s.dilationWidth,c=s.effectiveFilterHeight,h=s.effectiveFilterWidth,d=s.padInfo.top,f=s.padInfo.left,m=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=pt(s.outShape,n),p=v.values,g=s.outShape[1]*s.outShape[2]*s.outShape[3],y=s.outShape[2]*s.outShape[3],b=s.outShape[3];for(let x=0;x<s.batchSize;++x){const w=x*g,C=x*r[0];for(let S=0;S<s.inChannels;++S)for(let E=0;E<s.outHeight;++E){const T=E*o-d,_=Math.max(0,T),A=Math.min(s.inHeight,c+T),L=w+E*y;for(let W=0;W<s.outWidth;++W){const K=W*a-f,R=Math.max(0,K),M=Math.min(s.inWidth,h+K);let U=m,D=0,B=0;for(let ie=_;ie<A;ie+=l){const G=C+ie*r[1];for(let Z=R;Z<M;Z+=u){const de=G+Z*r[2],ge=t[de+S];i==="max"&&ge>U?U=ge:i==="avg"&&(D+=ge,B++)}if(isNaN(U))break}const X=L+W*b+S;p[X]=i==="avg"?D/B:U}}}return v}function SL(t,e,n,r,s=!1,i=!1){const o=pt(r.outShape,"int32"),a=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterHeight,d=r.effectiveFilterWidth,f=r.padInfo.top,m=r.padInfo.left,v=pt(e,n,t);for(let p=0;p<r.batchSize;++p)for(let g=0;g<r.inChannels;++g)for(let y=0;y<r.outHeight;++y){const b=y*a-f;let x=b;for(;x<0;)x+=u;const w=Math.min(r.inHeight,h+b);for(let C=0;C<r.outWidth;++C){const S=C*l-m;let E=S;for(;E<0;)E+=c;const T=Math.min(r.inWidth,d+S);let _=Number.NEGATIVE_INFINITY,A=-1;for(let L=x;L<w;L+=u){const W=L-b;for(let K=E;K<T;K+=c){const R=K-S,M=v.get(p,L,K,g);M>_&&(_=M,s?A=i?((p*r.inHeight+L)*r.inWidth+K)*r.inChannels+g:(L*r.inWidth+K)*r.inChannels+g:A=W*d+R)}}o.set(A,p,y,C,g)}}return o}function kL(t,e,n,r,s,i){const o=s.strideDepth,a=s.strideHeight,l=s.strideWidth,u=s.dilationDepth,c=s.dilationHeight,h=s.dilationWidth,d=s.effectiveFilterDepth,f=s.effectiveFilterHeight,m=s.effectiveFilterWidth,v=s.padInfo.front,p=s.padInfo.top,g=s.padInfo.left,y=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=pt(s.outShape,n),x=b.values,w=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],C=s.outShape[2]*s.outShape[3]*s.outShape[4],S=s.outShape[3]*s.outShape[4],E=s.outShape[4];for(let T=0;T<s.batchSize;++T){const _=T*w,A=T*r[0];for(let L=0;L<s.inChannels;++L)for(let W=0;W<s.outDepth;++W){const K=W*o-v;let R=K;for(;R<0;)R+=u;const M=Math.min(s.inDepth,d+K),U=_+W*C;for(let D=0;D<s.outHeight;++D){const B=D*a-p;let X=B;for(;X<0;)X+=c;const ie=Math.min(s.inHeight,f+B),G=U+D*S;for(let Z=0;Z<s.outWidth;++Z){const de=Z*l-g;let ge=de;for(;ge<0;)ge+=h;const ye=Math.min(s.inWidth,m+de),j=G+Z*E;let J=y,fe=0,ve=0;for(let De=R;De<M;De+=u){const Pe=A+De*r[1];for(let Ge=X;Ge<ie;Ge+=c){const Xe=Pe+Ge*r[2];for(let Je=ge;Je<ye;Je+=h){const Ze=Xe+Je*r[3],it=t[Ze+L];if(i==="max"&&it>J?J=it:i==="avg"&&(fe+=it,ve++),isNaN(J))break}if(isNaN(J))break}if(isNaN(J))break}const we=j+L;x[we]=i==="avg"?fe/Math.max(ve,1):J}}}}return b}function Lee(t,e){const n=pt(e.outShape,"int32"),r=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,f=e.padInfo.top,m=e.padInfo.left;for(let v=0;v<e.batchSize;++v)for(let p=0;p<e.inChannels;++p)for(let g=0;g<e.outDepth;++g){const y=g*r-d;let b=y;for(;b<0;)b+=o;const x=Math.min(e.inDepth,u+y);for(let w=0;w<e.outHeight;++w){const C=w*s-f;let S=C;for(;S<0;)S+=a;const E=Math.min(e.inHeight,c+C);for(let T=0;T<e.outWidth;++T){const _=T*i-m;let A=_;for(;A<0;)A+=l;const L=Math.min(e.inWidth,h+_);let W=Number.NEGATIVE_INFINITY,K=-1;for(let R=b;R<x;R+=o){const M=R-y;for(let U=S;U<E;U+=a){const D=U-C;for(let B=A;B<L;B+=l){const X=B-_,ie=t.get(v,R,U,B,p);ie>=W&&(W=ie,K=M*c*h+D*c+X)}}}n.set(K,v,g,w,T,p)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;qe(s,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;F(yr(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Qs(s.shape,i,o,u,a,l);let h;if(c.filterWidth===1&&c.filterHeight===1&&Nt(c.inShape,c.outShape))h=eo({inputs:{x:s},backend:n});else{const d=n.data.get(s.dataId).values,f=Qe(s.shape),m=JC(d,s.shape,s.dtype,f,c,"avg");h=n.makeTensorInfo(c.outShape,s.dtype,m.values)}return h}const Mee={kernelName:g0,backendName:"cpu",kernelFunc:Pee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r;qe(s,"avgPool3d");const c=Do(s.shape,i,o,1,a,l,u),h=n.data.get(s.dataId).values,d=kL(h,s.shape,s.dtype,Qe(s.shape),c,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}const zee={kernelName:v0,backendName:"cpu",kernelFunc:Bee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uee(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:u}=r;qe([s,i],"avgPool3DGrad");const c=Do(i.shape,o,a,1,l,u),h=c.strideDepth,d=c.strideHeight,f=c.strideWidth,m=c.filterDepth,v=c.filterHeight,p=c.filterWidth,g=c.dilationDepth,y=c.dilationHeight,b=c.dilationWidth,x=c.effectiveFilterDepth,w=c.effectiveFilterHeight,C=c.effectiveFilterWidth,S=x-1-c.padInfo.front,E=C-1-c.padInfo.left,T=w-1-c.padInfo.top,_=pt(i.shape,"float32"),A=1/(m*v*p),L=n.bufferSync(s);for(let W=0;W<c.batchSize;++W)for(let K=0;K<c.inChannels;++K)for(let R=0;R<c.inDepth;++R)for(let M=0;M<c.inHeight;++M)for(let U=0;U<c.inWidth;++U){const D=R-S,B=M-T,X=U-E;let ie=0;for(let G=0;G<x;G+=g){const Z=(D+G)/h;if(!(Z<0||Z>=c.outDepth||Math.floor(Z)!==Z))for(let de=0;de<w;de+=y){const ge=(B+de)/d;if(!(ge<0||ge>=c.outHeight||Math.floor(ge)!==ge))for(let ye=0;ye<C;ye+=b){const j=(X+ye)/f;if(j<0||j>=c.outWidth||Math.floor(j)!==j)continue;const J=L.get(W,Z,ge,j,K);ie+=J}}}_.set(ie*A,W,R,M,U,K)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const Vee={kernelName:Nw,backendName:"cpu",kernelFunc:Uee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wee(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i;qe([s,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=Qs(o.shape,a,l,1,u),h=c.strideHeight,d=c.strideWidth,f=c.filterHeight,m=c.filterWidth,v=c.dilationHeight,p=c.dilationWidth,g=c.effectiveFilterHeight,y=c.effectiveFilterWidth,b=y-1-c.padInfo.left,x=g-1-c.padInfo.top,w=pt(o.shape,"float32"),C=1/(f*m),S=n.data.get(s.dataId).values,E=pt(s.shape,"float32",S);for(let T=0;T<c.batchSize;++T)for(let _=0;_<c.inChannels;++_)for(let A=0;A<c.inHeight;++A)for(let L=0;L<c.inWidth;++L){const W=A-x,K=L-b;let R=0;for(let M=0;M<g;M+=v){const U=(W+M)/h;if(!(U<0||U>=c.outHeight||Math.floor(U)!==U))for(let D=0;D<y;D+=p){const B=(K+D)/d;if(B<0||B>=c.outWidth||Math.floor(B)!==B)continue;const X=E.get(T,U,B,_);R+=X}}w.set(R*C,T,A,L,_)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const Gee={kernelName:_w,backendName:"cpu",kernelFunc:Wee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,scale:i,offset:o,mean:a,variance:l}=e;F(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),F(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),F(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),qe([s,a,l,i,o],"batchNorm");let{varianceEpsilon:u}=r;u==null&&(u=.001);const c=n.data.get(s.dataId).values,h=n.data.get(a.dataId).values,d=n.data.get(l.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),m=o?n.data.get(o.dataId).values:new Float32Array([0]),v=new Float32Array(c.length),p=m.length,g=f.length,y=d.length,b=h.length;let x=0,w=0,C=0,S=0;for(let E=0;E<c.length;++E)v[E]=m[x++]+(c[E]-h[w++])*f[C++]/Math.sqrt(d[S++]+u),x>=p&&(x=0),w>=b&&(w=0),C>=g&&(C=0),S>=y&&(S=0);return n.makeTensorInfo(s.shape,s.dtype,v)}const Hee={kernelName:$0,backendName:"cpu",kernelFunc:jee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,crops:o}=r;qe([s],"batchToSpaceND");const a=i.reduce((g,y)=>g*y),l=zf(s.shape,i,a),u=Uf(l.length,i.length),c=Vf(s.shape,i,a),h=uC(o,i.length),d=cC(c,o,i.length),f=Xt({inputs:{x:s},backend:n,attrs:{shape:l}}),m=Vr({inputs:{x:f},backend:n,attrs:{perm:u}}),v=Xt({inputs:{x:m},backend:n,attrs:{shape:c}}),p=_l({inputs:{x:v},backend:n,attrs:{begin:h,size:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),p}const Kee={kernelName:x0,backendName:"cpu",kernelFunc:qee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xee(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o}=r,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,u=KC(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}const Yee={kernelName:$w,backendName:"cpu",kernelFunc:Xee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zee(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,a=ut(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Qee={kernelName:XD,backendName:"cpu",kernelFunc:Zee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jee=Ft(Kd,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),ete={kernelName:Kd,backendName:"cpu",kernelFunc:Jee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tte=t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(be(e.shape)),s=n.data.get(e.dataId),i=s.complexTensorInfos.real,o=s.complexTensorInfos.imag,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let u=0;u<a.length;u++){const c=a[u],h=l[u];r[u]=Math.hypot(c,h)}return n.makeOutput(r,e.shape,"float32")},nte={kernelName:b0,backendName:"cpu",kernelFunc:tte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oc(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,i)}const rte={kernelName:Kw,backendName:"cpu",kernelFunc:oc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ac(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,i=mt(s,e[0].shape)[0],o=e.map(v=>v.shape);oC(o,i);let a=Ki(e.map(v=>v.shape),i);if(be(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(v=>be(v.shape)>0);if(l.length===1)return eo({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const v=l.map(x=>Tl({inputs:{input:x},backend:n})),p=l.map(x=>oc({inputs:{input:x},backend:n})),g=ac({inputs:v,backend:n,attrs:{axis:i}}),y=ac({inputs:p,backend:n,attrs:{axis:i}}),b=Zr({inputs:{real:g,imag:y},backend:n});return v.forEach(x=>n.disposeIntermediateTensorInfo(x)),p.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),b}const u=l.map(v=>{const g=[-1,be(v.shape.slice(i))];return Xt({inputs:{x:v},backend:n,attrs:{shape:g}})}),c=u.map(v=>({vals:n.data.get(v.dataId).values,shape:v.shape}));a=Ki(u.map(v=>v.shape),1);const h=u[0].shape[0]===1,d=NF(c,a,e[0].dtype,h),f=Ki(l.map(v=>v.shape),i),m=n.makeTensorInfo(f,e[0].dtype,d);return u.forEach(v=>n.disposeIntermediateTensorInfo(v)),m}const ste={kernelName:w0,backendName:"cpu",kernelFunc:ac};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EL(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r;qe([s,i],"conv2d");const h=Ao(l),d=ur(s.shape,i.shape,o,u,a,c,!1,h),f=d.filterHeight,m=d.filterWidth,v=d.dilationHeight,p=d.dilationWidth,g=d.padInfo.left,y=d.padInfo.top,b=d.dataFormat==="channelsLast",x=new ar(d.outShape,s.dtype),w=Qe(s.shape),C=Qe(i.shape),S=w[0],E=b?w[1]:w[2],T=b?w[2]:1,_=b?1:w[1],A=x.strides[0],L=b?x.strides[1]:x.strides[2],W=b?x.strides[2]:1,K=b?1:x.strides[1],R=n.data.get(s.dataId).values,M=n.data.get(i.dataId).values,U=x.values;for(let D=0;D<d.batchSize;++D){const B=D*S,X=D*A;for(let ie=0;ie<d.outHeight;++ie){const G=X+ie*L,Z=ie*d.strideHeight-y;for(let de=0;de<f;++de){const ge=Z+de*v;if(ge<0||ge>=d.inHeight)continue;const ye=de*C[0],j=B+ge*E;for(let J=0;J<d.outWidth;++J){const fe=G+J*W,ve=J*d.strideWidth-g;for(let we=0;we<m;++we){const De=ve+we*p;if(De<0||De>=d.inWidth)continue;const Pe=ye+we*C[1],Ge=j+De*T;let Xe=Pe;for(let Je=0;Je<d.inChannels;++Je){const Ze=R[Ge+Je*_];for(let it=0;it<d.outChannels;++it)U[fe+it*K]+=Ze*M[Xe+it];Xe+=d.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,U)}const ite={kernelName:C0,backendName:"cpu",kernelFunc:EL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ote(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;qe([s,i],"conv2dBackpropFilter");const h=Ao(l),d=ur(s.shape,c,o,1,a,u,!1,h),{strideHeight:f,strideWidth:m,filterHeight:v,filterWidth:p}=d,g=d.dataFormat==="channelsLast",y=new ar(d.filterShape,"float32"),b=d.padInfo.left,x=d.padInfo.top,w=n.data.get(s.dataId).values,C=n.data.get(i.dataId).values,S=new ar(s.shape,s.dtype,w),E=new ar(i.shape,i.dtype,C);for(let T=0;T<v;++T){const _=Math.max(0,Math.ceil((x-T)/f)),A=Math.min(d.outHeight,(d.inHeight+x-T)/f);for(let L=0;L<p;++L){const W=Math.max(0,Math.ceil((b-L)/m)),K=Math.min(d.outWidth,(d.inWidth+b-L)/m);for(let R=0;R<d.inChannels;++R)for(let M=0;M<d.outChannels;++M){let U=0;for(let D=0;D<d.batchSize;++D)for(let B=_;B<A;++B){const X=T+B*f-x;for(let ie=W;ie<K;++ie){const G=L+ie*m-b;g?U+=S.get(D,X,G,R)*E.get(D,B,ie,M):U+=S.get(D,R,X,G)*E.get(D,M,B,ie)}}y.set(U,T,L,R,M)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const ate={kernelName:Rw,backendName:"cpu",kernelFunc:ote};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lte(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r;qe([s,i],"conv2dBackpropInput");const h=Qe(i.shape),d=Qe(s.shape);let f=Ao(u);const m=ur(o,i.shape,a,1,l,c,!1,f),v=new ar(m.inShape,"float32"),p=v.values,g=n.data.get(s.dataId).values,y=n.data.get(i.dataId).values,[b,x,w]=h,{batchSize:C,filterHeight:S,filterWidth:E,inChannels:T,inHeight:_,inWidth:A,outChannels:L,outHeight:W,outWidth:K,strideHeight:R,strideWidth:M}=m;f=m.dataFormat;const U=S-1-m.padInfo.top,D=E-1-m.padInfo.left,B=f==="channelsLast",X=v.strides[0],ie=B?v.strides[1]:v.strides[2],G=B?v.strides[2]:1,Z=B?1:v.strides[1],de=d[0],ge=B?d[1]:d[2],ye=B?d[2]:1,j=B?1:d[1];for(let J=0;J<C;++J)for(let fe=0;fe<T;++fe)for(let ve=0;ve<_;++ve){const we=ve-U,De=Math.max(0,Math.ceil(we/R)),Pe=Math.min(W,(S+we)/R);for(let Ge=0;Ge<A;++Ge){const Xe=Ge-D,Je=Math.max(0,Math.ceil(Xe/M)),Ze=Math.min(K,(E+Xe)/M);let it=0;for(let dt=De;dt<Pe;++dt){const Lt=dt*R-we;for(let at=Je;at<Ze;++at){const tt=at*M-Xe,Tt=de*J+ge*dt+ye*at,En=b*(S-1-Lt)+x*(E-1-tt)+w*fe;for(let Pt=0;Pt<L;++Pt){const Wt=g[Tt+j*Pt],In=y[En+Pt];it+=Wt*In}}}const dn=X*J+ie*ve+G*Ge+Z*fe;p[dn]=it}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const ute={kernelName:S0,backendName:"cpu",kernelFunc:lte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cte(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r;qe([s,i],"conv3d");const u=Na(s.shape,i.shape,o,l,a),{filterDepth:c,filterHeight:h,filterWidth:d,dilationDepth:f,dilationHeight:m,dilationWidth:v,padInfo:p}=u,g=p.front,y=p.left,b=p.top,x=new ar(u.outShape,s.dtype),w=n.data.get(s.dataId).values,C=n.data.get(i.dataId).values,S=x.values,E=Qe(s.shape),T=Qe(i.shape);for(let _=0;_<u.batchSize;++_){const A=_*E[0],L=_*x.strides[0];for(let W=0;W<u.outDepth;++W){const K=L+W*x.strides[1],R=W*u.strideDepth-g;for(let M=0;M<c;++M){const U=R+M*f;if(U<0||U>=u.inDepth)continue;const D=M*T[0],B=A+U*E[1];for(let X=0;X<u.outHeight;++X){const ie=K+X*x.strides[2],G=X*u.strideHeight-b;for(let Z=0;Z<h;++Z){const de=G+Z*m;if(de<0||de>=u.inHeight)continue;const ge=D+Z*T[1],ye=B+de*E[2];for(let j=0;j<u.outWidth;++j){const J=ie+j*u.outChannels,fe=j*u.strideWidth-y;for(let ve=0;ve<d;++ve){const we=fe+ve*v;if(we<0||we>=u.inWidth)continue;const De=ge+ve*T[2],Pe=ye+we*u.inChannels;let Ge=De;for(let Xe=0;Xe<u.inChannels;++Xe){const Je=w[Pe+Xe];for(let Ze=0;Ze<u.outChannels;++Ze)S[J+Ze]+=Je*C[Ge+Ze];Ge+=u.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const hte={kernelName:k0,backendName:"cpu",kernelFunc:cte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dte(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:l}=r;qe([s,i],"conv3dBackpropFilterV2");const u=Qe(s.shape),c=Qe(i.shape),h=Na(s.shape,l,o,1,a),d=h.strideDepth,f=h.strideHeight,m=h.strideWidth,v=h.filterDepth,p=h.filterHeight,g=h.filterWidth,y=new ar(h.filterShape,"float32"),b=y.values,[x,w,C,S]=y.strides,E=n.data.get(i.dataId).values,[T,_,A,L]=c,W=n.data.get(s.dataId).values,[K,R,M,U]=u,D=h.padInfo.front,B=h.padInfo.left,X=h.padInfo.top;for(let ie=0;ie<v;++ie){const G=Math.max(0,Math.ceil((D-ie)/d)),Z=Math.min(h.outDepth,(h.inDepth+D-ie)/d),de=ie*x;for(let ge=0;ge<p;++ge){const ye=Math.max(0,Math.ceil((X-ge)/f)),j=Math.min(h.outHeight,(h.inHeight+X-ge)/f),J=ge*w+de;for(let fe=0;fe<g;++fe){const ve=Math.max(0,Math.ceil((B-fe)/m)),we=Math.min(h.outWidth,(h.inWidth+B-fe)/m),De=fe*C+J;for(let Pe=0;Pe<h.inChannels;++Pe){const Ge=Pe*S+De;for(let Xe=0;Xe<h.outChannels;++Xe){let Je=0;for(let Ze=0;Ze<h.batchSize;++Ze){const it=Ze*K,dn=Ze*T;for(let dt=G;dt<Z;++dt){const at=(ie+dt*d-D)*R+it,tt=dt*_+dn;for(let Tt=ye;Tt<j;++Tt){const Pt=(ge+Tt*f-X)*M+at,Wt=Tt*A+tt;for(let In=ve;In<we;++In){const Pn=(fe+In*m-B)*U+Pt,br=In*L+Wt;Je+=W[Pn+Pe]*E[br+Xe]}}}}b[Ge+Xe]=Je}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const fte={kernelName:Ow,backendName:"cpu",kernelFunc:dte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pte(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{pad:o,strides:a,inputShape:l}=r;qe([s],"conv3dBackpropInputV2");const u=Qe(s.shape),c=Qe(i.shape),h=Na(l,i.shape,a,1,o),d=new ar(h.inShape,"float32"),f=d.values,[m,v,p,g]=d.strides,y=n.data.get(s.dataId).values,[b,x,w,C]=u,S=n.data.get(i.dataId).values,[E,T,_,A]=c,{batchSize:L,filterDepth:W,filterHeight:K,filterWidth:R,inChannels:M,inDepth:U,inHeight:D,inWidth:B,outChannels:X,outDepth:ie,outHeight:G,outWidth:Z,strideDepth:de,strideHeight:ge,strideWidth:ye}=h,j=W-1-h.padInfo.front,J=K-1-h.padInfo.top,fe=R-1-h.padInfo.left;for(let ve=0;ve<L;++ve)for(let we=0;we<M;++we)for(let De=0;De<U;++De){const Pe=De-j,Ge=Math.max(0,Math.ceil(Pe/de)),Xe=Math.min(ie,(W+Pe)/de);for(let Je=0;Je<D;++Je){const Ze=Je-J,it=Math.max(0,Math.ceil(Ze/ge)),dn=Math.min(G,(K+Ze)/ge);for(let dt=0;dt<B;++dt){const Lt=dt-fe,at=Math.max(0,Math.ceil(Lt/ye)),tt=Math.min(Z,(R+Lt)/ye);let Tt=0;for(let En=Ge;En<Xe;++En){const Pt=En*de-Pe;for(let Wt=it;Wt<dn;++Wt){const In=Wt*ge-Ze;for(let Ln=at;Ln<tt;++Ln){const Pn=Ln*ye-Lt,br=b*ve+x*En+w*Wt+C*Ln,nr=E*(W-1-Pt)+T*(K-1-In)+_*(R-1-Pn)+A*we;for(let Gt=0;Gt<X;++Gt){const Mn=y[br+Gt],Ts=S[nr+Gt];Tt+=Mn*Ts}}}}f[m*ve+v*De+p*Je+g*dt+we]=Tt}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}const mte={kernelName:Fw,backendName:"cpu",kernelFunc:pte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gte=Ft(Xd,t=>Math.cos(t)),vte={kernelName:Xd,backendName:"cpu",kernelFunc:gte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yte=Ft(Yd,t=>Math.cosh(t)),xte={kernelName:Yd,backendName:"cpu",kernelFunc:yte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bte(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:u}=r,[c,h,d,f]=s.shape,m=i.shape[0],[v,p]=a,g=pt([m,v,p,f],"float32"),y=n.data.get(i.dataId).values,b=n.data.get(o.dataId).values,x=n.data.get(s.dataId).values,w=Qe(s.shape),C=Qe(g.shape);for(let S=0;S<m;S++){const E=S*4,T=y[E],_=y[E+1],A=y[E+2],L=y[E+3],W=b[S];if(W>=c)continue;const K=v>1?(A-T)*(h-1)/(v-1):0,R=p>1?(L-_)*(d-1)/(p-1):0;for(let M=0;M<v;M++){const U=v>1?T*(h-1)+M*K:.5*(T+A)*(h-1);if(U<0||U>h-1){for(let D=0;D<p;D++)for(let B=0;B<f;B++){const X=B+D*C[2]+M*C[1]+S*C[0];g.values[X]=u}continue}if(l==="bilinear"){const D=Math.floor(U),B=Math.ceil(U),X=U-D;for(let ie=0;ie<p;ie++){const G=p>1?_*(d-1)+ie*R:.5*(_+L)*(d-1);if(G<0||G>d-1){for(let ye=0;ye<f;ye++){const j=ye+ie*C[2]+M*C[1]+S*C[0];g.values[j]=u}continue}const Z=Math.floor(G),de=Math.ceil(G),ge=G-Z;for(let ye=0;ye<f;ye++){let j=ye+Z*w[2]+D*w[1]+W*w[0];const J=x[j];j=ye+de*w[2]+D*w[1]+W*w[0];const fe=x[j];j=ye+Z*w[2]+B*w[1]+W*w[0];const ve=x[j];j=ye+de*w[2]+B*w[1]+W*w[0];const we=x[j],De=J+(fe-J)*ge,Pe=ve+(we-ve)*ge;j=ye+ie*C[2]+M*C[1]+S*C[0],g.values[j]=De+(Pe-De)*X}}}else for(let D=0;D<p;++D){const B=p>1?_*(d-1)+D*R:.5*(_+L)*(d-1);if(B<0||B>d-1){for(let G=0;G<f;G++){const Z=G+D*C[2]+M*C[1]+S*C[0];g.values[Z]=u}continue}const X=Math.round(B),ie=Math.round(U);for(let G=0;G<f;G++){const Z=G+X*w[2]+ie*w[1]+W*w[0],de=G+D*C[2]+M*C[1]+S*C[0];g.values[de]=x[Z]}}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const wte={kernelName:Pw,backendName:"cpu",kernelFunc:bte};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cte(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;qe(s,"cumprod");const l=hn([i],s.shape.length);let u=s;l!=null&&(u=Vr({inputs:{x:s},backend:n,attrs:{perm:l}}));const c=Cn(1,s.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const h=is(u.dtype,"int32"),d=Cw(be(u.shape),h),f=n.data.get(u.dataId).values,m=u.shape[u.shape.length-1],v=a?(g,y)=>g+m-y-1:(g,y)=>g+y;for(let g=0;g<f.length;g+=m)for(let y=0;y<m;y++){const b=v(g,y);if(y===0)d[b]=o?1:f[b];else{const x=v(g,y-1);d[b]=o?f[x]*d[x]:f[b]*d[x]}}const p=n.makeTensorInfo(u.shape,h,d);if(l!=null){const g=$a(l),y=Vr({inputs:{x:p},backend:n,attrs:{perm:g}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(u),y}return p}const Ste={kernelName:Lw,backendName:"cpu",kernelFunc:Cte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kte(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;qe(s,"cumsum");const l=hn([i],s.shape.length);let u=s;l!=null&&(u=Vr({inputs:{x:s},backend:n,attrs:{perm:l}}));const c=Cn(1,s.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const h=is(u.dtype,"int32"),d=vr(be(u.shape),h),f=n.data.get(u.dataId).values,m=u.shape[u.shape.length-1],v=a?(g,y)=>g+m-y-1:(g,y)=>g+y;for(let g=0;g<f.length;g+=m)for(let y=0;y<m;y++){const b=v(g,y);if(y===0)d[b]=o?0:f[b];else{const x=v(g,y-1);d[b]=o?f[x]+d[x]:f[b]+d[x]}}const p=n.makeTensorInfo(u.shape,h,d);if(l!=null){const g=$a(l),y=Vr({inputs:{x:p},backend:n,attrs:{perm:g}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(u),y}return p}const Ete={kernelName:E0,backendName:"cpu",kernelFunc:kte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ite(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r;if(s.shape.length===1){const l=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,c=KC(l,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}else if(s.shape.length===2){const l=n.bufferSync(s),u=n.bufferSync(i),c=IF(l,u,o,a);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const Tte={kernelName:Mw,backendName:"cpu",kernelFunc:Ite};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _te(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:i,dataFormat:o}=r;F(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=s.shape[0],l=s.shape[1],u=s.shape[2],c=s.shape[3],h=l*i,d=u*i,f=c/(i*i),m=n.data.get(s.dataId).values,v=new Float32Array(a*h*d*f);let p=0;for(let g=0;g<a;++g)for(let y=0;y<h;++y){const b=Math.floor(y/i),x=y%i;for(let w=0;w<d;++w){const C=Math.floor(w/i),S=w%i,E=(x*i+S)*f;for(let T=0;T<f;++T){const A=T+E+c*(C+u*(b+l*g));v[p++]=m[A]}}}return n.makeTensorInfo([a,h,d,f],s.dtype,v)}const Nte={kernelName:Bw,backendName:"cpu",kernelFunc:_te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IL(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:u}=r;qe([s,i],"depthwiseConv2DNative");const c=Qe(s.shape),h=Qe(i.shape);let d=l;d==null&&(d=[1,1]),F(yr(o,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${d}'`);const f=ur(s.shape,i.shape,o,d,a,u,!0),{filterHeight:m,filterWidth:v,dilationHeight:p,dilationWidth:g,padInfo:y}=f,b=y.left,x=y.top,w=f.outChannels/f.inChannels,C=new ar(f.outShape,s.dtype),S=n.data.get(s.dataId).values,E=n.data.get(i.dataId).values,T=C.values;for(let _=0;_<f.batchSize;++_){const A=_*c[0],L=_*C.strides[0];for(let W=0;W<f.outHeight;++W){const K=L+W*C.strides[1],R=W*f.strideHeight-x;for(let M=0;M<m;++M){const U=R+M*p;if(U<0||U>=f.inHeight)continue;const D=M*h[0],B=A+U*c[1];for(let X=0;X<f.outWidth;++X){const ie=K+X*C.strides[2],G=X*f.strideWidth-b;for(let Z=0;Z<v;++Z){const de=G+Z*g;if(de<0||de>=f.inWidth)continue;const ge=D+Z*h[1],ye=B+de*f.inChannels;let j=ie,J=ge;for(let fe=0;fe<f.inChannels;++fe){const ve=S[ye+fe];for(let we=0;we<w;++we)T[j+we]+=ve*E[J+we];j+=w,J+=w}}}}}}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const $te={kernelName:I0,backendName:"cpu",kernelFunc:IL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dte(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r;qe([s,i],"depthwiseConv2dNativeBackpropFilter");const h=ur(s.shape,c,o,a,l,u,!0),{strideHeight:d,strideWidth:f,filterHeight:m,filterWidth:v}=h,p=new ar(h.filterShape,"float32"),g=h.padInfo.left,y=h.padInfo.top,b=h.outChannels/h.inChannels,x=n.data.get(s.dataId).values,w=new ar(s.shape,s.dtype,x),C=n.data.get(i.dataId).values,S=new ar(i.shape,i.dtype,C);for(let E=0;E<m;++E){const T=Math.max(0,Math.ceil((y-E)/d)),_=Math.min(h.outHeight,(h.inHeight+y-E)/d);for(let A=0;A<v;++A){const L=Math.max(0,Math.ceil((g-A)/f)),W=Math.min(h.outWidth,(h.inWidth+g-A)/f);for(let K=0;K<h.outChannels;++K){const R=Math.trunc(K/b),M=K%b;let U=0;for(let D=0;D<h.batchSize;++D)for(let B=T;B<_;++B){const X=E+B*d-y;for(let ie=L;ie<W;++ie){const G=A+ie*f-g;U+=w.get(D,X,G,R)*S.get(D,B,ie,K)}}p.set(U,E,A,R,M)}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const Ate={kernelName:zw,backendName:"cpu",kernelFunc:Dte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rte(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r;qe([s,i],"depthwiseConv2DNativeBackpropInput");const h=Qe(s.shape),d=Qe(i.shape),f=ur(c,i.shape,o,a,l,u,!0),m=new ar(f.inShape,"float32"),v=m.values,[p,g,y]=m.strides,b=n.data.get(s.dataId).values,[x,w,C]=h,S=n.data.get(i.dataId).values,[E,T,_]=d,{batchSize:A,filterHeight:L,filterWidth:W,inChannels:K,inHeight:R,inWidth:M,outChannels:U,outHeight:D,outWidth:B,strideHeight:X,strideWidth:ie}=f,G=L-1-f.padInfo.top,Z=W-1-f.padInfo.left,de=U/K;for(let ge=0;ge<A;++ge)for(let ye=0;ye<K;++ye)for(let j=0;j<R;++j){const J=j-G,fe=Math.max(0,Math.ceil(J/X)),ve=Math.min(D,(L+J)/X);for(let we=0;we<M;++we){const De=we-Z,Pe=Math.max(0,Math.ceil(De/ie)),Ge=Math.min(B,(W+De)/ie);let Xe=0;for(let Je=fe;Je<ve;++Je){const Ze=Je*X-J;for(let it=Pe;it<Ge;++it){const dn=it*ie-De,dt=x*ge+w*Je+C*it,Lt=E*(L-1-Ze)+T*(W-1-dn)+_*ye;for(let at=0;at<de;++at){const tt=ye*de+at,Tt=b[dt+tt],En=S[Lt+at];Xe+=Tt*En}}}v[p*ge+g*j+y*we+ye]=Xe}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const Ote={kernelName:Uw,backendName:"cpu",kernelFunc:Rte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fte(t){const{inputs:e,backend:n}=t,{x:r}=e,s=be(r.shape),i=n.data.get(r.dataId).values,o=pt([s,s],r.dtype),a=o.values;for(let u=0;u<i.length;u++)a[u*s+u]=i[u];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const Lte={kernelName:YD,backendName:"cpu",kernelFunc:Fte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pte={kernelName:T0,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s}=t,{strides:i,pad:o,dilations:a}=n,l=e,u=l.data.get(r.dataId).values,c=r.shape.length,h=l.data.get(s.dataId).values,d=s.shape.length,{batchSize:f,inHeight:m,inWidth:v,inChannels:p,outHeight:g,outWidth:y,padInfo:b,strideHeight:x,strideWidth:w,filterHeight:C,filterWidth:S,dilationHeight:E,dilationWidth:T,outShape:_}=Ff(r.shape,s.shape,i,o,"NHWC",a),A=be(_),L=_.length,W=xn(r.dtype,A);for(let R=0;R<f;++R)for(let M=0;M<g;++M){const U=M*x-b.top;for(let D=0;D<y;++D){const B=D*w-b.left;for(let X=0;X<p;++X){let ie=Number.MIN_SAFE_INTEGER;for(let Z=0;Z<C;++Z){const de=U+Z*E;if(de>=0&&de<m)for(let ge=0;ge<S;++ge){const ye=B+ge*T;if(ye>=0&&ye<v){const j=Hi([R,de,ye,X],c,Qe(r.shape)),J=Hi([Z,ge,X],d,Qe(s.shape)),fe=u[j]+h[J];fe>ie&&(ie=fe)}}}const G=Hi([R,M,D,X],L,Qe(_));W[G]=ie}}}return{dataId:l.write(Bl(W,r.dtype),_,r.dtype),shape:_,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mte={kernelName:yx,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s,dy:i}=t,{strides:o,pad:a,dilations:l}=n,u=e,c=vi(r.shape,u.data.get(r.dataId).values),h=vi(s.shape,u.data.get(s.dataId).values),{batchSize:d,inHeight:f,inWidth:m,inChannels:v,outHeight:p,outWidth:g,padInfo:y,strideHeight:b,strideWidth:x,filterHeight:w,filterWidth:C,dilationHeight:S,dilationWidth:E,outShape:T}=Ff(r.shape,s.shape,o,a,"NHWC",l);F(i.rank===T.length,()=>`Error in ${yx}, dy must have the same rank as output ${T.length}, but got ${i.rank}`);const _=vi(T,u.data.get(i.dataId).values),A=HD(s.shape,s.dtype);for(let W=0;W<d;++W)for(let K=0;K<p;++K){const R=K*b-y.top;for(let M=0;M<g;++M){const U=M*x-y.left;for(let D=0;D<v;++D){let B=Number.MIN_SAFE_INTEGER,X=0,ie=0;for(let G=0;G<w;++G){const Z=R+G*S;if(Z>=0&&Z<f)for(let de=0;de<C;++de){const ge=U+de*E;if(ge>=0&&ge<m){const ye=c[W][Z][ge][D]+h[G][de][D];ye>B&&(B=ye,X=G,ie=de)}}}A[X][ie][D]+=_[W][K][M][D]}}}return{dataId:u.write(Bl(A,r.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bte={kernelName:vx,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s,dy:i}=t,{strides:o,pad:a,dilations:l}=n,u=e,c=vi(r.shape,u.data.get(r.dataId).values),h=vi(s.shape,u.data.get(s.dataId).values),{batchSize:d,inHeight:f,inWidth:m,inChannels:v,outHeight:p,outWidth:g,padInfo:y,strideHeight:b,strideWidth:x,filterHeight:w,filterWidth:C,dilationHeight:S,dilationWidth:E,outShape:T}=Ff(r.shape,s.shape,o,a,"NHWC",l);F(i.rank===T.length,()=>`Error in ${vx}, dy must have the same rank as output ${T.length}, but got ${i.rank}`);const _=vi(T,u.data.get(i.dataId).values),A=HD(r.shape,r.dtype);for(let W=0;W<d;++W)for(let K=0;K<p;++K){const R=K*b-y.top;for(let M=0;M<g;++M){const U=M*x-y.left;for(let D=0;D<v;++D){let B=Number.MIN_SAFE_INTEGER,X=R<0?0:R,ie=U<0?0:U;for(let G=0;G<w;++G){const Z=R+G*S;if(Z>=0&&Z<f)for(let de=0;de<C;++de){const ge=U+de*E;if(ge>=0&&ge<m){const ye=c[W][Z][ge][D]+h[G][de][D];ye>B&&(B=ye,X=Z,ie=ge)}}}A[W][X][ie][D]+=_[W][K][M][D]}}}return{dataId:u.write(Bl(A,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zte(t){const{inputs:e,backend:n,attrs:r}=t,{image:s}=e,{canvas:i,options:o}=r,{contextOptions:a,imageOptions:l}=o||{},u=(l==null?void 0:l.alpha)||1,c=(a==null?void 0:a.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const h=i.getContext(c,(a==null?void 0:a.contextAttributes)||{});if(h==null)throw new Error(`Could not get the context with ${c} type.`);const[d,f]=s.shape.slice(0,2),m=s.shape.length===2?1:s.shape[2],v=n.data.get(s.dataId).values,p=s.dtype==="float32"?255:1,g=new Uint8ClampedArray(f*d*4);for(let b=0;b<d*f;++b){const x=[0,0,0,255*u];for(let C=0;C<m;C++){const S=v[b*m+C];if(s.dtype==="float32"){if(S<0||S>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${S}.`)}else if(s.dtype==="int32"&&(S<0||S>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${S}.`);m===1?(x[0]=S*p,x[1]=S*p,x[2]=S*p):x[C]=S*p}const w=b*4;g[w+0]=Math.round(x[0]),g[w+1]=Math.round(x[1]),g[w+2]=Math.round(x[2]),g[w+3]=Math.round(x[3])}i.width=f,i.height=d;const y=new ImageData(g,f,d);return h.putImageData(y,0,0),s}const Ute={kernelName:iG,backendName:"cpu",kernelFunc:zte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zf(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;qe(s,"sum");let a;s.dtype==="bool"?a=wa({inputs:{x:s},backend:n,attrs:{dtype:"int32"}}):a=eo({inputs:{x:s},backend:n});const l=a.shape.length,u=mt(i,a.shape),c=hn(u,l);let h=u,d=a;c!=null&&(d=Vr({inputs:{x:a},backend:n,attrs:{perm:c}}),h=Cn(h.length,l)),cr("sum",h,d.shape.length);const[f,m]=tr(d.shape,h),v=is(d.dtype,"int32");let p=cg(n,f,v);const g=be(m),y=n.data.get(p.dataId).values,b=n.data.get(d.dataId).values;for(let x=0;x<y.length;++x){const w=x*g;let C=0;for(let S=0;S<g;++S)C+=b[w+S];y[x]=C}if(o){const x=Fn(p.shape,u),w=p;p=Xt({inputs:{x:p},backend:n,attrs:{shape:x}}),n.disposeIntermediateTensorInfo(w)}return n.disposeIntermediateTensorInfo(a),c!=null&&n.disposeIntermediateTensorInfo(d),p}const Vte={kernelName:ov,backendName:"cpu",kernelFunc:Zf};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wte(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:l}=yC(s,i.length);bC(o.length,l,i);const{path:u,steps:c}=wC(a,l),h=c.length;let d=null,f=o.length;const m=[];for(let v=0;v<h;++v){for(const p of c[v]){const{permutationIndices:g,expandDims:y}=xC(f,l[p]);let b;CC(g)?b=i[p]:(b=Vr({inputs:{x:i[p]},backend:n,attrs:{perm:g}}),m.push(b));const x=b.shape.slice();for(let w=0;w<y.length;++w)x.splice(y[w],0,1);Nt(b.shape,x)||(b=Xt({inputs:{x:b},backend:n,attrs:{shape:x}}),m.push(b)),d===null?d=b:(d=Lv({inputs:{a:b,b:d},backend:n}),m.push(d))}v<h-1&&(u[v]>=0&&(d=Zf({inputs:{x:d},backend:n,attrs:{axis:u[v]-(o.length-f),keepDims:!1}}),m.push(d)),f--)}for(const v of m)v!==d&&n.disposeIntermediateTensorInfo(v);return d}const Gte={kernelName:Vw,backendName:"cpu",kernelFunc:Wte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jte(t){const{inputs:e,backend:n}=t,{dy:r,y:s}=e;qe([r,s],"eluGrad");const i=new Float32Array(be(s.shape)),o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values;for(let l=0;l<o.length;++l){const u=o[l];u>=0?i[l]=a[l]:i[l]=a[l]*(u+1)}return n.makeTensorInfo(s.shape,"float32",i)}const Hte={kernelName:Ww,backendName:"cpu",kernelFunc:jte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qte=hC,Kte=dC,Xte=fC,Yte=pC,Zte=mC,Qte=gC,Jte=Ft(Jd,t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+qte*n);return e*(1-((((Qte*r+Zte)*r+Yte)*r+Xte)*r+Kte)*r*Math.exp(-n*n))}),ene={kernelName:Jd,backendName:"cpu",kernelFunc:Jte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fg(t){const{inputs:e,backend:n,attrs:r}=t,{input:s}=e,{dim:i}=r,o=s.shape.length,a=s.shape.slice();let l=i;return i<0&&(F(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),Xt({inputs:{x:s},backend:n,attrs:{shape:a}})}const tne={kernelName:N0,backendName:"cpu",kernelFunc:fg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nne=kn((t,e)=>t/e),eS=qn(Zd,nne),jx={kernelName:Zd,backendName:"cpu",kernelFunc:eS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TL(t,e,n){const r=t.shape,s=r[0],i=r[1],o=n.data.get(t.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,u=[s,i],c=be(u),h=gr("float32",c),d=gr("float32",c);for(let p=0;p<s;p++){const g=_l({inputs:{x:a},backend:n,attrs:{begin:[p,0],size:[1,i]}}),y=_l({inputs:{x:l},backend:n,attrs:{begin:[p,0],size:[1,i]}}),b=Zr({inputs:{real:g,imag:y},backend:n}),{real:x,imag:w}=rne(b,e,n),C=Eo(x,w);for(let S=0;S<i;S++){const E=vC(C,S);h[p*i+S]=E.real,d[p*i+S]=E.imag}n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b)}const f=n.makeTensorInfo(u,"float32",h),m=n.makeTensorInfo(u,"float32",d),v=Zr({inputs:{real:f,imag:m},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),v}function rne(t,e,n){const r=be(t.shape),s=n.data.get(t.dataId),i=n.data.get(s.complexTensorInfos.real.dataId).values,o=n.data.get(s.complexTensorInfos.imag.dataId).values;if(sne(r)){const a=Hx(i,o,r,e,n),l=[t.shape[0],t.shape[1]];if(e){const u=n.makeTensorInfo(l,"float32",a.real),c=n.makeTensorInfo(l,"float32",a.imag),h=n.makeTensorInfo([],"float32",Ta(r,"float32")),d=eo({inputs:{x:h},backend:n}),f=jx.kernelFunc({inputs:{a:u,b:h},backend:n}),m=jx.kernelFunc({inputs:{a:c,b:d},backend:n}),v=n.data.get(f.dataId).values,p=n.data.get(m.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),{real:v,imag:p}}return a}else{const a=Eo(i,o),l=ine(a,r,e);return VR(l)}}function sne(t){return(t&t-1)===0}function Hx(t,e,n,r,s){if(n===1)return{real:t,imag:e};const i=Eo(t,e),o=n/2,a=WR(i),l=a.real,u=a.imag,c=[l.length],h=s.makeTensorInfo(c,"float32",l),d=s.makeTensorInfo(c,"float32",u),f=Zr({inputs:{real:h,imag:d},backend:s}),m=GR(i),v=m.real,p=m.imag,g=[v.length],y=s.makeTensorInfo(g,"float32",v),b=s.makeTensorInfo(g,"float32",p),x=Zr({inputs:{real:y,imag:b},backend:s}),w=Hx(l,u,o,r,s),C=w.real,S=w.imag,E=[C.length],T=s.makeTensorInfo(E,"float32",C),_=s.makeTensorInfo(E,"float32",S),A=Zr({inputs:{real:T,imag:_},backend:s}),L=Hx(v,p,o,r,s),W=L.real,K=L.imag,R=[W.length],M=s.makeTensorInfo(R,"float32",W),U=s.makeTensorInfo(R,"float32",K),D=Zr({inputs:{real:M,imag:U},backend:s}),B=HR(n,r),X=[B.real.length],ie=s.makeTensorInfo(X,"float32",B.real),G=s.makeTensorInfo(X,"float32",B.imag),Z=Zr({inputs:{real:ie,imag:G},backend:s}),de=Lv({inputs:{a:Z,b:D},backend:s}),ge=ic({inputs:{a:A,b:de},backend:s}),ye=QC({inputs:{a:A,b:de},backend:s}),j=Tl({inputs:{input:ge},backend:s}),J=Tl({inputs:{input:ye},backend:s}),fe=oc({inputs:{input:ge},backend:s}),ve=oc({inputs:{input:ye},backend:s}),we=ac({inputs:[j,J],backend:s,attrs:{axis:0}}),De=ac({inputs:[fe,ve],backend:s,attrs:{axis:0}}),Pe=s.data.get(we.dataId).values,Ge=s.data.get(De.dataId).values;return s.disposeIntermediateTensorInfo(h),s.disposeIntermediateTensorInfo(d),s.disposeIntermediateTensorInfo(f),s.disposeIntermediateTensorInfo(y),s.disposeIntermediateTensorInfo(b),s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(T),s.disposeIntermediateTensorInfo(_),s.disposeIntermediateTensorInfo(A),s.disposeIntermediateTensorInfo(M),s.disposeIntermediateTensorInfo(U),s.disposeIntermediateTensorInfo(D),s.disposeIntermediateTensorInfo(ie),s.disposeIntermediateTensorInfo(G),s.disposeIntermediateTensorInfo(Z),s.disposeIntermediateTensorInfo(de),s.disposeIntermediateTensorInfo(ge),s.disposeIntermediateTensorInfo(ye),s.disposeIntermediateTensorInfo(j),s.disposeIntermediateTensorInfo(fe),s.disposeIntermediateTensorInfo(J),s.disposeIntermediateTensorInfo(ve),s.disposeIntermediateTensorInfo(we),s.disposeIntermediateTensorInfo(De),{real:Pe,imag:Ge}}function ine(t,e,n){const r=new Float32Array(e*2);for(let s=0;s<e;s++){let i=0,o=0;for(let a=0;a<e;a++){const l=qR(s*a,e,n),u=vC(t,a);i+=u.real*l.real-u.imag*l.imag,o+=u.real*l.imag+u.imag*l.real}n&&(i/=e,o/=e),jR(r,i,o,s)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function one(t){const{inputs:e,backend:n}=t,{input:r}=e,s=be(r.shape),i=r.shape[r.shape.length-1],o=s/i,a=Xt({inputs:{x:r},backend:n,attrs:{shape:[o,i]}}),l=TL(a,!1,n),u=Xt({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const ane={kernelName:Gw,backendName:"cpu",kernelFunc:one};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tS(t){const{backend:e,attrs:n}=t,{shape:r,value:s,dtype:i}=n,o=i||xc(s),a=xn(o,be(r));return une(a,s,o),e.makeTensorInfo(r,o,a)}const lne={kernelName:jw,backendName:"cpu",kernelFunc:tS};function une(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cne={kernelName:Hw,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,s=n,i=gr(r.dtype,be(r.shape)),[o,a,l,u]=r.shape,c=s.data.get(r.dataId).values;for(let d=0;d<o;d++){const f=d*l*a*u;for(let m=0;m<a;m++){const v=m*(l*u);for(let p=0;p<l;p++){const g=p*u;for(let y=0;y<u;y++){const b=Math.round(l-p-1),x=f+v+g+y;let w=c[x];if(b>=0&&b<l){const C=b*u,S=f+v+C+y;w=c[S]}i[x]=w}}}}return{dataId:s.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hne(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:m}=r;let v=EL({inputs:{x:s,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d}});if(o){const p=v;if(c==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const g=Xt({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});v=ic({inputs:{a:v,b:g},backend:n}),n.disposeIntermediateTensorInfo(g)}else v=ic({inputs:{a:v,b:o},backend:n});n.disposeIntermediateTensorInfo(p)}if(f){const p=v;if(c==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const g=Xt({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});v=dg(n,v,f,g,m),n.disposeIntermediateTensorInfo(g)}else v=dg(n,v,f,a,m);n.disposeIntermediateTensorInfo(p)}return v}const dne={kernelName:Gm,backendName:"cpu",kernelFunc:hne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fne(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:m}=r;let v=IL({inputs:{x:s,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d}});if(o){const p=v;v=ic({inputs:{a:v,b:o},backend:n}),n.disposeIntermediateTensorInfo(p)}if(f){const p=v;v=dg(n,v,f,a,m),n.disposeIntermediateTensorInfo(p)}return v}const pne={kernelName:mA,backendName:"cpu",kernelFunc:fne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mne(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,i=be(r.shape),o=s.shape,a=o[o.length-1],[l,u,c,h]=eC(r,s);if(u===0)return n.makeTensorInfo(l,r.dtype,[]);const d=n.data.get(s.dataId).values,f=n.bufferSync(r),m=PF(d,f,r.dtype,u,a,c,h,r.shape,i);return n.makeTensorInfo(l,r.dtype,m.values)}const gne={kernelName:ZD,backendName:"cpu",kernelFunc:mne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vne(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:i}=e,{axis:o,batchDims:a}=r;qe([s,i],"gatherV2");const l=mt(o,s.shape)[0],u=n.data.get(i.dataId).values,c=s.shape[l];for(let x=0;x<u.length;++x){const w=u[x];F(w<=c-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${c-1}]`)}let h=a;a==null&&(h=0);const d=be(i.shape),f=kC(s,i,l,h),m=Xt({inputs:{x:s},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),v=Xt({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,d/f.batchSize]}}),p=[f.batchSize,f.outerSize,d/f.batchSize,f.sliceSize],g=n.bufferSync(v),y=n.bufferSync(m),b=MF(y,g,p);return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),n.makeTensorInfo(f.outputShape,b.dtype,b.values)}const yne={kernelName:D0,backendName:"cpu",kernelFunc:vne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xne(t){const{inputs:e,backend:n}=t,{input:r}=e,s=be(r.shape),i=r.shape[r.shape.length-1],o=s/i,a=Xt({inputs:{x:r},backend:n,attrs:{shape:[o,i]}}),l=TL(a,!0,n),u=Xt({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const bne={kernelName:qw,backendName:"cpu",kernelFunc:xne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wne=Ft(af,t=>Number.isFinite(t)?1:0,"bool"),Cne={kernelName:af,backendName:"cpu",kernelFunc:wne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sne=Ft(lf,t=>Math.abs(t)===1/0?1:0,"bool"),kne={kernelName:lf,backendName:"cpu",kernelFunc:Sne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ene=Ft(uf,t=>Number.isNaN(t)?1:0,"bool"),Ine={kernelName:uf,backendName:"cpu",kernelFunc:Ene};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tne(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:i}=n,o=WF(r,s,i);return e.makeTensorInfo([o.length],"float32",o)}const _ne={kernelName:QD,backendName:"cpu",kernelFunc:Tne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nne=Ft(hf,t=>Math.log1p(t)),$ne={kernelName:hf,backendName:"cpu",kernelFunc:Nne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dne=kn((t,e)=>t&&e),Ane=qn(L0,Dne,null,"bool"),Rne={kernelName:L0,backendName:"cpu",kernelFunc:Ane};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const One=Ft(P0,t=>t?0:1,"bool"),Fne={kernelName:P0,backendName:"cpu",kernelFunc:One};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lne=kn((t,e)=>t||e),Pne=qn(M0,Lne,null,"bool"),Mne={kernelName:M0,backendName:"cpu",kernelFunc:Pne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bne(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=r;qe(s,"LRN");const u=s.shape[3],c=u-1,h=n.data.get(s.dataId).values,d=be(s.shape),f=new Float32Array(d);function m(v){const p=v%u;let g=v-p+Math.max(0,p-i);const y=v-p+Math.min(p+i,c);let b=0;for(;g<=y;g++){const x=h[g];b+=x*x}return b}for(let v=0;v<d;v++){const p=m(v),g=h[v]*Math.pow(o+a*p,-l);f[v]=g}return n.makeTensorInfo(s.shape,s.dtype,f)}const zne={kernelName:B0,backendName:"cpu",kernelFunc:Bne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Une(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r;qe(o,"LRNGrad");const h=be(o.shape),d=o.shape[3],f=n.data.get(o.dataId).values,m=n.data.get(s.dataId).values,v=n.data.get(i.dataId).values,p=new Float32Array(h),g=h;for(let y=0;y<g;y++){const b=y%d,x=y-b+Math.max(0,b-a),w=y-b+Math.min(d,b+a+1);let C=0;for(let S=x;S<w;S++)C+=Math.pow(m[S],2);C=u*C+l;for(let S=x;S<w;S++){let E=-2*u*c*m[S]*v[y]/C;y===S&&(E+=Math.pow(C,-c)),E*=f[y],p[S]+=E}}return n.makeTensorInfo(o.shape,s.dtype,p)}const Vne={kernelName:Xw,backendName:"cpu",kernelFunc:Une};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _L(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:i,keepDims:o}=r,a=n;let l=s.shape;const u=l.length,c=mt(i,l);let h=c;const d=hn(h,u);let f=a.data.get(s.dataId).values;if(d!=null){const x=new Array(u);for(let w=0;w<x.length;w++)x[w]=l[d[w]];f=YC(f,l,s.dtype,d,x),h=Cn(h.length,u),l=x}qe(s,"max"),cr("max",h,u);const[m,v]=tr(l,h),p=be(v),g=jF(f,p,m,s.dtype),y=a.write(g,m,s.dtype);let b=m;return o&&(b=Fn(m,c)),{dataId:y,shape:b,dtype:s.dtype}}const Wne={kernelName:z0,backendName:"cpu",kernelFunc:_L};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gne(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;qe(s,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;F(yr(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Qs(s.shape,i,o,u,a,l);let h;if(c.filterWidth===1&&c.filterHeight===1&&Nt(c.inShape,c.outShape))h=eo({inputs:{x:s},backend:n});else{const d=n.data.get(s.dataId).values,f=Qe(s.shape),m=JC(d,s.shape,s.dtype,f,c,"max");h=n.makeTensorInfo(c.outShape,s.dtype,m.values)}return h}const jne={kernelName:U0,backendName:"cpu",kernelFunc:Gne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hne(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r;qe(s,"maxPool3d");const c=Do(s.shape,i,o,1,a,l,u),h=n.data.get(s.dataId).values,d=kL(h,s.shape,s.dtype,Qe(s.shape),c,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}const qne={kernelName:V0,backendName:"cpu",kernelFunc:Hne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kne(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:u}=r;qe([s,i],"maxPool3DGrad");const c=Do(i.shape,o,a,1,l,u),h=n.bufferSync(i),d=Lee(h,c),f=c.strideDepth,m=c.strideHeight,v=c.strideWidth,p=c.dilationDepth,g=c.dilationHeight,y=c.dilationWidth,b=c.effectiveFilterDepth,x=c.effectiveFilterHeight,w=c.effectiveFilterWidth,C=b-1-c.padInfo.front,S=w-1-c.padInfo.left,E=x-1-c.padInfo.top,T=pt(i.shape,"float32"),_=n.bufferSync(s);for(let A=0;A<c.batchSize;++A)for(let L=0;L<c.inChannels;++L)for(let W=0;W<c.inDepth;++W)for(let K=0;K<c.inHeight;++K)for(let R=0;R<c.inWidth;++R){const M=W-C,U=K-E,D=R-S;let B=0;for(let X=0;X<b;X+=p){const ie=(M+X)/f;if(!(ie<0||ie>=c.outDepth||Math.floor(ie)!==ie))for(let G=0;G<x;G+=g){const Z=(U+G)/m;if(!(Z<0||Z>=c.outHeight||Math.floor(Z)!==Z))for(let de=0;de<w;de+=y){const ge=(D+de)/v;if(ge<0||ge>=c.outWidth||Math.floor(ge)!==ge)continue;const ye=b*x*w-1-d.get(A,ie,Z,ge,L),j=X*x*w+G*w+de,J=ye===j?1:0;if(J===0)continue;const fe=_.get(A,ie,Z,ge,L);B+=fe*J}}}T.set(B,A,W,K,R,L)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}const Xne={kernelName:Zw,backendName:"cpu",kernelFunc:Kne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yne(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i,output:o}=e,a=i;qe([i,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:h}=r,d=Qs(a.shape,l,u,1,c,h),f=n.data.get(a.dataId).values,m=pt(d.outShape,a.dtype,SL(f,a.shape,a.dtype,d).values),v=d.strideHeight,p=d.strideWidth,g=d.dilationHeight,y=d.dilationWidth,b=d.effectiveFilterHeight,x=d.effectiveFilterWidth,w=x-1-d.padInfo.left,C=b-1-d.padInfo.top,S=pt(a.shape,"float32"),E=n.data.get(s.dataId).values,T=pt(s.shape,"float32",E);for(let _=0;_<d.batchSize;++_)for(let A=0;A<d.inChannels;++A)for(let L=0;L<d.inHeight;++L)for(let W=0;W<d.inWidth;++W){const K=L-C,R=W-w;let M=0;for(let U=0;U<b;U+=g){const D=(K+U)/v;if(!(D<0||D>=d.outHeight||Math.floor(D)!==D))for(let B=0;B<x;B+=y){const X=(R+B)/p;if(X<0||X>=d.outWidth||Math.floor(X)!==X)continue;const ie=b*x-1-m.get(_,D,X,A),G=U*x+B,Z=ie===G?1:0;if(Z===0)continue;const de=T.get(_,D,X,A);M+=de*Z}}S.set(M,_,L,W,A)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const Zne={kernelName:Yw,backendName:"cpu",kernelFunc:Yne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qne(t,e,n,r,s){const i=Qe(e),o=JC(t,e,n,i,s,"max"),a=SL(t,e,n,s,!0,r);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jne={kernelName:JD,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;qe(r,"MaxPoolWithArgmax");const u=l.data.get(r.dataId).values,c=Qs(r.shape,s,i,[1,1],o),[h,d]=Qne(u,r.shape,r.dtype,a,c),f=l.write(h,c.outShape,r.dtype),m=l.write(d,c.outShape,r.dtype);return[{dataId:f,shape:c.outShape,dtype:r.dtype},{dataId:m,shape:c.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ere(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=mt(i,s.shape),u=tr(s.shape,a)[1],c=be(u),h=[],d=n.makeTensorInfo([],"float32",new Float32Array([c]));h.push(d);const f=wa({inputs:{x:s},backend:n,attrs:{dtype:"float32"}});h.push(f);const m=eS({inputs:{a:f,b:d},backend:n});h.push(m);const v=Zf({inputs:{x:m},backend:n,attrs:{axis:i,keepDims:o}});return h.forEach(p=>n.disposeIntermediateTensorInfo(p)),v}const tre={kernelName:W0,backendName:"cpu",kernelFunc:ere};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nre(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;qe(s,"min");const a=mt(i,s.shape);let l=a;const u=hn(l,s.shape.length);let c=s;u!=null&&(c=Vr({inputs:{x:s},backend:n,attrs:{perm:u}}),l=Cn(l.length,s.shape.length)),cr("min",l,c.shape.length);const[h,d]=tr(c.shape,l),f=be(d),m=vr(be(h),c.dtype),v=n.data.get(c.dataId).values;for(let g=0;g<m.length;++g){const y=g*f;let b=v[y];for(let x=0;x<f;++x){const w=v[y+x];(Number.isNaN(w)||w<b)&&(b=w)}m[g]=b}u!=null&&n.disposeIntermediateTensorInfo(c);const p=n.makeTensorInfo(h,c.dtype,m);if(o){const g=Fn(h,a),y=Xt({inputs:{x:p},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(p),y}return p}const rre={kernelName:G0,backendName:"cpu",kernelFunc:nre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sre(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,mode:o}=r;qe(s,"mirrorPad");const a=i.map((b,x)=>b[0]+s.shape[x]+b[1]),l=i.map(b=>b[0]),u=i.map((b,x)=>b[0]+s.shape[x]),c=o==="reflect"?0:1,h=n.data.get(s.dataId).values,d=s.shape.length,f=Qe(s.shape),m=be(a),v=a.length,p=Qe(a),g=gr(s.dtype,m);for(let b=0;b<m;b++){let x=bc(b,v,p);for(let C=0;C<v;C++)x[C]<l[C]?x[C]=l[C]*2-x[C]-c:x[C]>=u[C]&&(x[C]=(u[C]-1)*2-x[C]+c);x=x.map((C,S)=>C-l[S]);const w=Hi(x,d,f);g[b]=h[w]}return{dataId:n.write(g,a,s.dtype),shape:a,dtype:s.dtype}}const ire={kernelName:j0,backendName:"cpu",kernelFunc:sre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ore=kn((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),are=qn(pf,ore),lre={kernelName:pf,backendName:"cpu",kernelFunc:are};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NL(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:i}=r,o=s.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=mt([a],s.shape),u=_L({inputs:{x:s},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=Fn(u.shape,l),h=Xt({inputs:{x:u},backend:n,attrs:{shape:c}}),d=QC({inputs:{a:s,b:h},backend:n}),f=RF({inputs:{x:d},backend:n}),m=Zf({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),v=Xt({inputs:{x:m},backend:n,attrs:{shape:c}}),p=eS({inputs:{a:f,b:v},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),p}const ure={kernelName:uv,backendName:"cpu",kernelFunc:NL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cre(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r;qe(s,"multinomial");const l=a?s:NL({inputs:{logits:s},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],h=n.data.get(l.dataId).values,d=[u,i],f=vr(be(d),"int32");for(let m=0;m<u;++m){const v=m*c,p=new Float32Array(c-1);p[0]=h[v];for(let b=1;b<p.length;++b)p[b]=p[b-1]+h[v+b];const g=B2.alea(o.toString()),y=m*i;for(let b=0;b<i;++b){const x=g();f[y+b]=p.length;for(let w=0;w<p.length;w++)if(x<p[w]){f[y+b]=w;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(d,"int32",f)}const hre={kernelName:eA,backendName:"cpu",kernelFunc:cre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dre=K2;function fre(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r;qe(s,"NonMaxSuppression");const u=n.data.get(s.dataId).values,c=n.data.get(i.dataId).values,{selectedIndices:h}=dre(u,c,o,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const pre={kernelName:Qw,backendName:"cpu",kernelFunc:fre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mre=X2;function gre(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r;qe(s,"NonMaxSuppressionPadded");const c=n.data.get(s.dataId).values,h=n.data.get(i.dataId).values,{selectedIndices:d,validOutputs:f}=mre(c,h,o,a,l,u);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const vre={kernelName:Jw,backendName:"cpu",kernelFunc:gre};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yre=Y2;function xre(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r;qe(s,"NonMaxSuppressionWithScore");const c=n.data.get(s.dataId).values,h=n.data.get(i.dataId).values,d=o,f=a,m=l,v=u,{selectedIndices:p,selectedScores:g}=yre(c,h,d,f,m,v);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const bre={kernelName:e2,backendName:"cpu",kernelFunc:xre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wre(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:l}=r;qe(s,"oneHot");const u=be(s.shape),c=new Float32Array(u*o);c.fill(l);const h=n.data.get(s.dataId).values;for(let d=0;d<u;++d)h[d]>=0&&h[d]<o&&(c[d*o+h[d]]=a);return n.makeTensorInfo([...s.shape,o],i,c)}const Cre={kernelName:X0,backendName:"cpu",kernelFunc:wre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pg(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const s=Tl({inputs:{input:r},backend:n}),i=pg({inputs:{x:s},backend:n}),o=oc({inputs:{input:r},backend:n}),a=pg({inputs:{x:o},backend:n}),l=Zr({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return tS({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const Sre={kernelName:dv,backendName:"cpu",kernelFunc:pg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $L(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const s=Tl({inputs:{input:r},backend:n}),i=$L({inputs:{x:s},backend:n}),o=oc({inputs:{input:r},backend:n}),a=pg({inputs:{x:o},backend:n}),l=Zr({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return tS({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const kre={kernelName:K0,backendName:"cpu",kernelFunc:$L};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DL(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return fg({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(c=>{ww(i,c.shape,"All tensors passed to stack must have matching shapes"),F(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const h=fg({inputs:{input:c},backend:n,attrs:{dim:s}});return a.push(h),h}),u=ac({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const Ere={kernelName:Y0,backendName:"cpu",kernelFunc:DL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ire(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,constantValue:o}=r;qe(s,"pad");const a=i.map((y,b)=>y[0]+s.shape[b]+y[1]),l=i.map(y=>y[0]),u=n.data.get(s.dataId).values,c=be(s.shape),h=s.shape.length,d=Qe(s.shape),f=be(a),m=a.length,v=Qe(a),p=gr(s.dtype,f);o!==0&&p.fill(o);for(let y=0;y<c;y++){const x=bc(y,h,d).map((C,S)=>C+l[S]),w=Hi(x,m,v);p[w]=u[y]}return{dataId:n.write(p,a,s.dtype),shape:a,dtype:s.dtype}}const AL={kernelName:Z0,backendName:"cpu",kernelFunc:Ire};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tre=kn((t,e)=>Math.pow(t,e)),_re=qn(gf,Tre),Nre={kernelName:gf,backendName:"cpu",kernelFunc:_re};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $re(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:i,indices:o}=e,a=s.map(p=>n.data.get(p.dataId).values),l=s.map(p=>p.shape),u=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values,[h,d,f]=ZF(a,l,u,i.shape,i.dtype,c,o.shape),m=h.map(p=>n.makeTensorInfo([p.length],"int32",p)),v=n.makeTensorInfo(f,i.dtype,d);return m.concat([v])}const Dre={kernelName:tA,backendName:"cpu",kernelFunc:$re};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Are(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:i}=e,o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,[u,c]=QF(o,r.shape,r.dtype,a,s.shape,l,i.shape),h=n.makeTensorInfo([u.length],"int32",u),d=n.makeTensorInfo([c.length],r.dtype,c);return[h,d]}const Rre={kernelName:nA,backendName:"cpu",kernelFunc:Are};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ore(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=n.data.get(s.dataId).values,c=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values,d=a.map(p=>n.data.get(p.dataId).values),f=a.map(p=>p.shape),[m,v]=JF(u,s.shape,c,i.shape,i.dtype,h,o.shape,d,f,l);return n.makeTensorInfo(m,i.dtype,v)}const Fre={kernelName:rA,backendName:"cpu",kernelFunc:Ore};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lre(t){const{backend:e,attrs:n}=t,{start:r,stop:s,dtype:i,step:o}=n,a=eL(r,s,o,i);return e.makeTensorInfo([a.length],i,a)}const Pre={kernelName:t2,backendName:"cpu",kernelFunc:Lre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mre=Ft(vf,t=>1/t),Bre={kernelName:vf,backendName:"cpu",kernelFunc:Mre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zre(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r;qe(s,"resizeBilinear");const l=Qe(s.shape),[u,c]=a,[h,d,f,m]=s.shape,v=n.data.get(s.dataId).values,p=new Float32Array(be([h,u,c,m])),g=[i&&u>1?d-1:d,i&&c>1?f-1:f],y=[i&&u>1?u-1:u,i&&c>1?c-1:c];let b=0;const x=g[0]/y[0],w=g[1]/y[1];for(let C=0;C<h;C++)for(let S=0;S<u;S++){let E;o?E=x*(S+.5)-.5:E=x*S;const T=Math.max(0,Math.floor(E)),_=E-T,A=Math.min(d-1,Math.ceil(E)),L=C*l[0]+T*l[1],W=C*l[0]+A*l[1];for(let K=0;K<c;K++){let R;o?R=w*(K+.5)-.5:R=w*K;const M=Math.max(0,Math.floor(R)),U=R-M,D=Math.min(f-1,Math.ceil(R)),B=L+M*l[2],X=W+M*l[2],ie=L+D*l[2],G=W+D*l[2];for(let Z=0;Z<m;Z++){const de=v[B+Z],ge=v[X+Z],ye=v[ie+Z],j=v[G+Z],J=de+(ye-de)*U,fe=ge+(j-ge)*U,ve=J+(fe-J)*_;p[b++]=ve}}}return n.makeTensorInfo([h,u,c,m],"float32",p)}const Ure={kernelName:nv,backendName:"cpu",kernelFunc:zre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vre(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r;qe([i,s],"resizeBilinearGrad");const a=Qe(s.shape),[l,u,c,h]=s.shape,[,d,f]=i.shape,m=new Float32Array(l*u*c*h),v=[o&&d>1?u-1:u,o&&f>1?c-1:c],p=[o&&d>1?d-1:d,o&&f>1?f-1:f],g=v[0]/p[0],y=v[1]/p[1],b=n.data.get(i.dataId).values;let x=0;for(let w=0;w<l;w++){const C=w*a[0];for(let S=0;S<d;S++){const E=S*g,T=Math.floor(E),_=Math.min(Math.ceil(E),u-1),A=C+T*a[1],L=C+_*a[1],W=E-T,K=1-W;for(let R=0;R<f;R++){const M=R*y,U=Math.floor(M),D=Math.min(Math.ceil(M),c-1),B=M-U,X=1-B,ie=A+U*a[2],G=A+D*a[2],Z=L+U*a[2],de=L+D*a[2],ge=K*X,ye=K*B,j=W*X,J=W*B;for(let fe=0;fe<h;fe++){const ve=b[x++];m[ie+fe]+=ve*ge,m[G+fe]+=ve*ye,m[Z+fe]+=ve*j,m[de+fe]+=ve*J}}}}return n.makeTensorInfo([l,c,u,h],"float32",m)}const Wre={kernelName:s2,backendName:"cpu",kernelFunc:Vre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gre(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r;qe(s,"resizeNearestNeighbor");const l=Qe(s.shape),[u,c]=a,[h,d,f,m]=s.shape,v=n.data.get(s.dataId).values,p=new Float32Array(h*u*c*m),g=[i&&u>1?d-1:d,i&&c>1?f-1:f],y=[i&&u>1?u-1:u,i&&c>1?c-1:c],b=g[0]/y[0],x=g[1]/y[1];let w=0;for(let C=0;C<h;C++){const S=C*l[0];for(let E=0;E<u;E++){const T=o?b*(E+.5):b*E;let _=Math.min(d-1,i?Math.round(T):Math.floor(T));o&&(_=Math.max(0,_));const A=S+_*l[1];for(let L=0;L<c;L++){const W=o?x*(L+.5):x*L;let K=Math.min(f-1,i?Math.round(W):Math.floor(W));o&&(K=Math.max(0,K));const R=A+K*l[2];for(let M=0;M<m;M++){const U=v[R+M];p[w++]=U}}}}return n.makeTensorInfo([h,u,c,m],s.dtype,p)}const jre={kernelName:tv,backendName:"cpu",kernelFunc:Gre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hre(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r;qe([i,s],"resizeNearestNeighborGrad");const a=Qe(s.shape),l=Qe(i.shape),[u,c,h,d]=s.shape,[,f,m]=i.shape,v=new Float32Array(u*c*h*d),p=n.data.get(i.dataId).values,g=[o&&f>1?c-1:c,o&&m>1?h-1:h],y=[o&&f>1?f-1:f,o&&m>1?m-1:m],b=g[0]/y[0],x=g[1]/y[1],w=1/b,C=1/x,S=Math.ceil(w)*2+2,E=Math.ceil(C)*2+2;for(let T=0;T<u;T++){const _=T*a[0];for(let A=0;A<c;A++){const L=_+A*a[1],W=Math.floor(A*w),K=Math.floor(W-S/2);for(let R=0;R<h;R++){const M=L+R*a[2],U=Math.floor(R*C),D=Math.floor(U-E/2);for(let B=0;B<d;B++){let X=0;for(let ie=0;ie<S;ie++){const G=ie+K;if(G<0||G>=f)continue;const Z=_+G*l[1],de=G*b,ge=Math.min(c-1,o?Math.round(de):Math.floor(de));if(A===ge)for(let ye=0;ye<E;ye++){const j=ye+D;if(j<0||j>=m)continue;const J=Z+j*l[2],fe=j*x,ve=Math.min(h-1,o?Math.round(fe):Math.floor(fe));R===ve&&(X+=p[J+B])}}v[M+B]=X}}}}return n.makeTensorInfo(s.shape,s.dtype,v)}const qre={kernelName:r2,backendName:"cpu",kernelFunc:Hre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kre(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:i}=r;qe(s,"reverse");const o=s.shape.length,a=mt(i,s.shape);if(o===0)return eo({inputs:{x:s},backend:n});const l=new ar(s.shape,s.dtype),u=n.bufferSync(s);for(let c=0;c<l.size;c++){const h=l.indexToLoc(c),d=h.slice();a.forEach(f=>d[f]=s.shape[f]-1-d[f]),l.set(u.get(...d),...h)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const Xre={kernelName:rv,backendName:"cpu",kernelFunc:Kre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yre={kernelName:h2,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:i,center:o}=e,a=n,l=gr(r.dtype,be(r.shape)),[u,c,h,d]=r.shape,[f,m]=lC(o,c,h),v=255,p=Math.sin(s),g=Math.cos(s),y=a.data.get(r.dataId).values;for(let x=0;x<u;x++){const w=x*h*c*d;for(let C=0;C<c;C++){const S=C*(h*d);for(let E=0;E<h;E++){const T=E*d;for(let _=0;_<d;_++){const A=[u,C,E,_],L=A[2],W=A[1];let K=(L-f)*g-(W-m)*p,R=(L-f)*p+(W-m)*g;K=Math.round(K+f),R=Math.round(R+m);let M=i;if(typeof i!="number"&&(_===3?M=v:M=i[_]),K>=0&&K<h&&R>=0&&R<c){const D=R*(h*d),B=K*d,X=w+D+B+_;M=y[X]}const U=w+S+T+_;l[U]=M}}}}return{dataId:a.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zre=Ft(bf,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),Qre={kernelName:bf,backendName:"cpu",kernelFunc:Zre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jre(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:h}=Gl(i,s,o),d=!0,f=n.bufferSync(s),m=n.bufferSync(i),v=tl(f,m,o,h,u,l,a,c,0,d);return n.makeTensorInfo(o,v.dtype,v.values)}const ese={kernelName:sA,backendName:"cpu",kernelFunc:Jre};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tse(t,e){let n=0,r=t.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),t[s]<e?n=s+1:r=s;return r}function nse(t,e){let n=0,r=t.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),t[s]<=e?n=s+1:r=s;return r}function rse(t,e,n,r,s,i){const o=xn("int32",n*s);for(let a=0;a<n;++a){const l=t.slice(a*r,(a+1)*r),u=a*s;for(let c=0;c<s;++c)o[u+c]=i==="left"?tse(l,e[c+u]):nse(l,e[c+u])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sse(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:i}=e,{side:o}=r,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,u=rse(a,l,s.shape[0],s.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",u)}const ise={kernelName:oA,backendName:"cpu",kernelFunc:sse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ose(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:i}=e;qe([r,s,i],"select");const o=r.shape.length,a=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,c=is(s.dtype,i.dtype),h=vr(be(s.shape),c);let d=0;const f=o===0||o>1||s.shape.length===1?1:be(s.shape.slice(1));for(let m=0;m<a.length;m++)for(let v=0;v<f;v++)a[m]===1?h[d++]=l[m]:h[d++]=u[m];return n.makeTensorInfo(s.shape,c,h)}const ase={kernelName:sv,backendName:"cpu",kernelFunc:ose};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lse=Sv,use=kv,cse=Ft(Cf,t=>t>=0?use*t:lse*(Math.exp(t)-1)),hse={kernelName:Cf,backendName:"cpu",kernelFunc:cse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dse=Ft(Ef,t=>t<0?-1:t>0?1:0),fse={kernelName:Ef,backendName:"cpu",kernelFunc:dse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pse=Ft(Sf,t=>Math.sin(t)),mse={kernelName:Sf,backendName:"cpu",kernelFunc:pse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gse=Ft(kf,t=>Math.sinh(t)),vse={kernelName:kf,backendName:"cpu",kernelFunc:gse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yse=11920928955078125e-23,tT=Math.log(yse)+2,xse=Ft(Tf,t=>{const e=t>-tT,n=t<tT,r=Math.exp(t);let s;return n?s=r:e?s=t:s=Math.log(1+r),s}),bse={kernelName:Tf,backendName:"cpu",kernelFunc:xse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wse(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,paddings:o}=r;qe([s],"spaceToBatchND");const a=be(i),l=[[0,0]];l.push(...o);for(let C=1+i.length;C<s.shape.length;++C)l.push([0,0]);const u=AL.kernelFunc({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),c=zf(u.shape,i,a,!1),h=Uf(c.length,i.length,!1),d=Vf(u.shape,i,a,!1),v=Xt({inputs:{x:u},backend:n,attrs:{shape:c}}),y=Vr({inputs:{x:v},backend:n,attrs:{perm:h}}),w=Xt({inputs:{x:y},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),w}const Cse={kernelName:av,backendName:"cpu",kernelFunc:wse};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sse(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values[0],[h,d,f,m,v]=sL(a,r.shape,r.dtype,l,s.dtype,u,c);return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],s.dtype,f),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(p=>Number(p)))),n.makeTensorInfo([v.length],r.dtype,new Int32Array(v))]}const kse={kernelName:aA,backendName:"cpu",kernelFunc:Sse};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ese(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(s.dataId).values),a=n.data.get(r.dataId).values,l=Array.from(n.data.get(i.dataId).values),[u,c,h]=iL(a,r.shape,r.dtype,o,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}const Ise={kernelName:lA,backendName:"cpu",kernelFunc:Ese};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tse(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,[u,c]=ZC(o,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const _se={kernelName:uA,backendName:"cpu",kernelFunc:Tse};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nse(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,[u,c]=ZC(o,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}const $se={kernelName:cA,backendName:"cpu",kernelFunc:Nse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dse(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:h,outputSize:d}=Gl(i,s,a),f=!1,m=n.bufferSync(s);let v;switch(i.dtype){case"bool":{const p=n.bufferSync(i),g=!!n.data.get(o.dataId).values[0];v=tl(m,p,a,d,c,u,l,h,g,f);break}case"float32":{const p=n.bufferSync(i),g=n.data.get(o.dataId).values[0];v=tl(m,p,a,d,c,u,l,h,g,f);break}case"int32":{const p=n.bufferSync(i),g=n.data.get(o.dataId).values[0];v=tl(m,p,a,d,c,u,l,h,g,f);break}case"string":{const p=n.bufferSync(i),g=ma(n.data.get(o.dataId).values[0]);v=tl(m,p,a,d,c,u,l,h,g,f);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(a,v.dtype,v.values)}const Ase={kernelName:hA,backendName:"cpu",kernelFunc:Dse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rse(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=mt(o,s.shape)[0],l=SC(s,i,a),u=new Array(s.shape.length).fill(0),c=s.shape.slice();return l.map(h=>{const d=[...c];d[a]=h;const f=_l({inputs:{x:s},backend:n,attrs:{begin:u,size:d}});return u[a]+=h,f})}const Ose={kernelName:lv,backendName:"cpu",kernelFunc:Rse};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fse={kernelName:i2,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;qe(n,"square");const s=r.data.get(n.dataId).values,i=new Float32Array(s.length);for(let a=0;a<s.length;++a){const l=s[a];i[a]=l*l}return{dataId:r.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lse=Ft(Of,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),Pse={kernelName:Of,backendName:"cpu",kernelFunc:Lse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mse(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:h,shrinkAxisMask:d}=r;qe(s,"stridedSlice");const{finalShapeSparse:f,finalShape:m,isIdentity:v,sliceDim0:p,isSimpleSlice:g,begin:y,end:b,strides:x}=iC(s.shape,i,o,a,l,u,c,h,d);let w;if(v)w=Xt({inputs:{x:s},backend:n,attrs:{shape:m}});else if(p||g){F(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const C=nC(y,b,x),S=_l({inputs:{x:s},backend:n,attrs:{begin:y,size:C}});w=Xt({inputs:{x:S},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(S)}else{const C=n.bufferSync(s),S=lL(f,C,x,y);w=n.makeTensorInfo(m,S.dtype,S.values)}return w}const Bse={kernelName:a2,backendName:"cpu",kernelFunc:Mse};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zse(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:h}=e,d=n.data.get(c.dataId).values,f=n.data.get(h.dataId).values,[m,v]=uL(d,f,s,i,o,a,l,u);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(h.shape,"int32",v)]}const Use={kernelName:dA,backendName:"cpu",kernelFunc:zse};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vse(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[u,c,h]=cL(a,l,s),d=c.length;return[n.makeTensorInfo([d,2],"int32",u),n.makeTensorInfo([d],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const Wse={kernelName:fA,backendName:"cpu",kernelFunc:Vse};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gse(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,a=hL(o,s);return n.makeTensorInfo(i.shape,"int32",a)}const jse={kernelName:pA,backendName:"cpu",kernelFunc:Gse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hse=Ft(Df,t=>Math.tan(t)),qse={kernelName:Df,backendName:"cpu",kernelFunc:Hse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kse=Ft(Af,t=>Math.tanh(t)),Xse={kernelName:Af,backendName:"cpu",kernelFunc:Kse};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yse(t){const{inputs:e,backend:n}=t,{tensor:r,indices:s,updates:i}=e,{sliceRank:o,numUpdates:a,sliceSize:l,strides:u,outputSize:c}=Gl(i,s,r.shape),h=!1,d=n.bufferSync(s),f=n.bufferSync(i),m=n.bufferSync(r),v=tl(d,f,r.shape,c,l,a,o,u,m,h);return n.makeTensorInfo(r.shape,v.dtype,v.values)}const Zse={kernelName:iA,backendName:"cpu",kernelFunc:Yse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qse(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:i}=r;qe(s,"tile");const o=fL(n.bufferSync(s),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const Jse={kernelName:Rf,backendName:"cpu",kernelFunc:Qse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eie(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:i,sorted:o}=r;qe(s,"topk");const a=n.data.get(s.dataId).values,[l,u]=mL(a,s.shape,s.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const tie={kernelName:l2,backendName:"cpu",kernelFunc:eie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nie(t){const{inputs:e,attrs:n,backend:r}=t,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:u}=n,[c,h,d,f]=s.shape,[m,v]=u??[h,d],p=[c,m,v,f],g=Qe(s.shape),y=g[0],b=g[1],x=g[2],w=Qe(p),C=w[0],S=w[1],E=w[2],T=gr(s.dtype,be(p));T.fill(l);const _=r.data.get(s.dataId).values,A=r.data.get(i.dataId).values;for(let W=0;W<c;++W){const K=i.shape[0]===1?A:A.subarray(W*8,W*8+8);for(let R=0;R<m;++R)for(let M=0;M<v;++M)for(let U=0;U<f;++U){let D;const B=K[6]*M+K[7]*R+1;if(B===0)continue;const X=(K[0]*M+K[1]*R+K[2])/B,ie=(K[3]*M+K[4]*R+K[5])/B,G=nT(X,d,a),Z=nT(ie,h,a);switch(o){case"nearest":D=lie(_,h,d,y,b,x,W,Z,G,U,l);break;case"bilinear":D=uie(_,h,d,y,b,x,W,Z,G,U,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const de=W*C+R*S+M*E+U;T[de]=D}return r.makeTensorInfo(p,s.dtype,T)}return{dataId:r.write(T,p,s.dtype),shape:s.shape,dtype:s.dtype}}const rie={kernelName:u2,backendName:"cpu",kernelFunc:nie};function nT(t,e,n){switch(n){case"reflect":return sie(t,e);case"wrap":return iie(t,e);case"nearest":return aie(t,e);case"constant":default:return oie(t)}}function sie(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=2*e;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-e?n+r:-n-1}else if(n>e-1)if(e<=1)n=0;else{const r=2*e;n-=r*Math.trunc(n/r),n>=e&&(n=r-n-1)}return gl(0,n,e-1)}function iie(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=e-1;n+=e*(Math.trunc(-n/r)+1)}else if(n>e-1)if(e<=1)n=0;else{const r=e-1;n-=e*Math.trunc(n/r)}return gl(0,n,e-1)}function oie(t,e){return t}function aie(t,e){return gl(0,t,e-1)}function mh(t,e,n,r,s,i,o,a,l,u,c){const h=o*r+a*s+l*i+u;return 0<=a&&a<e&&0<=l&&l<n?t[h]:c}function lie(t,e,n,r,s,i,o,a,l,u,c){const h=Math.round(a),d=Math.round(l);return mh(t,e,n,r,s,i,o,h,d,u,c)}function uie(t,e,n,r,s,i,o,a,l,u,c){const h=Math.floor(a),d=Math.floor(l),f=h+1,m=d+1,v=(m-l)*mh(t,e,n,r,s,i,o,h,d,u,c)+(l-d)*mh(t,e,n,r,s,i,o,h,m,u,c),p=(m-l)*mh(t,e,n,r,s,i,o,f,d,u,c)+(l-d)*mh(t,e,n,r,s,i,o,f,m,u,c);return(f-a)*v+(a-h)*p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cie(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:i}=e;qe(i,"unique");const o=r.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:u}=gL(o,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const hie={kernelName:c2,backendName:"cpu",kernelFunc:cie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function die(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s.shape.length,a=s.shape[i],l=new Array(o-1);let u=0;for(let f=0;f<o;f++)f!==i&&(l[u++]=s.shape[f]);const c=new Array(o).fill(0),h=s.shape.slice();h[i]=1;const d=new Array(a);for(let f=0;f<d.length;f++){c[i]=f;const m=_l({inputs:{x:s},backend:n,attrs:{begin:c,size:h}});d[f]=Xt({inputs:{x:m},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(m)}return d}const fie={kernelName:cv,backendName:"cpu",kernelFunc:die};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pie(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:i}=e,{numSegments:o}=r;qe(s,"unsortedSegmentSum");const a=s.shape.length,l=i.shape.length,u=[],c=[],h=a-l;let d=i;for(let m=0;m<h;++m){const v=fg({inputs:{input:d},backend:n,attrs:{dim:m+1}});d=v,c.push(v)}for(let m=0;m<o;++m){const v=Ta(m,"int32"),p=n.makeTensorInfo([],"int32",v),g=DF({inputs:{a:p,b:d},backend:n}),y=wa({inputs:{x:g},backend:n,attrs:{dtype:"float32"}}),b=Lv({inputs:{a:y,b:s},backend:n}),x=Zf({inputs:{x:b},backend:n,attrs:{axis:0,keepDims:!1}});u.push(x),c.push(p),c.push(g),c.push(y),c.push(b),c.push(x)}const f=DL({inputs:u,backend:n,attrs:{axis:0}});return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}const mie={kernelName:hv,backendName:"cpu",kernelFunc:pie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gie=[cee,GQ,dee,pee,YQ,gee,yee,bee,Cee,kee,Iee,_ee,$ee,Ree,Fee,Mee,zee,Vee,Gee,lee,Hee,Kee,Yee,QQ,Qee,KQ,eJ,ete,jQ,nte,ste,ite,ate,ute,hte,fte,mte,vte,xte,wte,Ste,Ete,Tte,Nte,$te,Ate,Ote,Lte,Pte,Mte,Bte,Ute,Gte,tee,Hte,tJ,ene,nJ,tne,sJ,ane,lne,cne,oJ,lJ,dne,pne,gne,yne,cJ,dJ,HQ,bne,rte,Cne,kne,Ine,nee,pJ,gJ,_ne,yJ,$ne,Rne,Fne,Mne,zne,Vne,Wne,bJ,jne,qne,Xne,Zne,Jne,tre,rre,CJ,ire,lre,hre,kJ,IJ,pre,vre,bre,_J,Cre,kre,Ere,AL,Nre,see,DJ,Dre,Rre,Fre,Pre,qQ,jx,Bre,iee,oee,aee,Ure,Wre,jre,qre,Xre,Yre,Qre,BJ,ese,ise,ase,hse,UJ,fse,mse,vse,VJ,ure,bse,Cse,kse,Ise,_se,$se,Ase,Ose,jJ,Fse,qJ,XJ,Pse,Bse,Use,Wse,jse,JJ,Vte,qse,Xse,Zse,Jse,tie,rie,NJ,hie,fie,mie,Sre];for(const t of gie)gA(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ka={},Fp={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function vie(t,e){Ka[t]=e}function Si(t,e){if(!(t in Ka)||e!=null){const r=xie(t,e);if(r!==null)Ka[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=Ka[t];return n==null||n.isContextLost()?(delete Ka[t],Si(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Ka[t])}function yie(t){if(!me().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function xie(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??yie(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Ka[t]},!1),me().getBool("SOFTWARE_WEBGL_ENABLED")&&(Fp.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",Fp)||n.getContext("experimental-webgl",Fp):n.getContext("webgl2",Fp)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var dd;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(dd||(dd={}));var ys;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(ys||(ys={}));var sr;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(sr||(sr={}));function Qf(t,e){return[e,t]}function bie(t,e){return t*e}function Lp(t){const e=be(t),n=Math.ceil(e/4);return fx(n)}function Tc(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function wie(t,e){const[n,r]=Tc(t,e);return n*r*4}function nS(t,e){const n=t;let r,s,i,o,a,l,u,c,h,d;return me().getNumber("WEBGL_VERSION")===2?(r=n.R32F,s=n.R16F,i=n.RGBA16F,o=n.RGBA32F,a=n.RED,u=4,c=1,h=n.HALF_FLOAT,d=n.FLOAT,l=n.RGBA8):(r=t.RGBA,s=t.RGBA,i=t.RGBA,o=n.RGBA,a=t.RGBA,u=4,c=4,h=e!=null?e.HALF_FLOAT_OES:null,d=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:h,textureTypeFloat:d}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ue(t,e){const n=e();return me().getBool("DEBUG")&&Cie(t),n}function Cie(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+Iie(t,e))}const Sie=596e-10,kie=65504;function Eie(t){return!!(me().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||Sie<Math.abs(t)&&Math.abs(t)<kie)}function Iie(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Pp(t,e){return Ro(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function Tie(t,e){const n=Ro(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ue(t,()=>t.shaderSource(n,e)),Ue(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function _ie(t,e){const n=Ro(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ue(t,()=>t.shaderSource(n,e)),Ue(t,()=>t.compileShader(n)),me().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw RL(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const Nie=/ERROR: [0-9]+:([0-9]+):/g;function RL(t,e){const n=Nie.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],s=t.split(`
`),i=s.length.toString().length+2,o=s.map((h,d)=>Pu((d+1).toString(),i)+h);let a=0;for(let h=0;h<o.length;h++)a=Math.max(o[h].length,a);const l=o.slice(0,r-1),u=o.slice(r-1,r),c=o.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Pu(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function $ie(t){return Ro(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function Die(t,e){if(Ue(t,()=>t.linkProgram(e)),!me().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Zy(t,e){if(Ue(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function Aie(t,e){const n=Ro(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),Ue(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Rie(t,e){const n=Ro(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ue(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),Ue(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Oie(t){return Ro(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function Fie(t,e){const n=me().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,s=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function Lie(t){return Ro(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function rT(t,e,n,r,s,i,o){const a=t.getAttribLocation(e,n);return a===-1?!1:(Ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),Ue(t,()=>t.vertexAttribPointer(a,s,t.FLOAT,!1,i,o)),Ue(t,()=>t.enableVertexAttribArray(a)),!0)}function Pie(t,e,n){Vie(t,n),Ue(t,()=>t.activeTexture(t.TEXTURE0+n)),Ue(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function Mie(t,e,n){return Ro(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function Bie(t,e,n){return t.getUniformLocation(e,n)}function zie(t,e,n,r){Ue(t,()=>Pie(t,e,r)),Ue(t,()=>t.uniform1i(n,r))}function Qy(t,e,n){Ue(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),Ue(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function sT(t,e){Ue(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),Ue(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Mp(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Uie(t,e))}function Uie(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Ro(t,e,n){const r=Ue(t,()=>e());if(r==null)throw new Error(n);return r}function Vie(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const s=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${s}.`)}}function lc(t,e=2){return be(t.slice(0,t.length-e))}function uc(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Bp(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[lc(t),...uc(t)]),e}function Wie(t,e=!1){let n=me().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=me().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&me().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((a,l)=>l>=t.length-2?bw(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Ia(t).newShape);let s=be(t),i=null;t.length<=1&&s<=n?i=[1,s]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=lc(t);let l=2,u=2;t.length&&([l,u]=uc(t)),s=a*(l/2)*(u/2),i=fx(s).map(c=>c*2)}else i=fx(s);return i}function zp(t){return t%2===0}function mg(t,e){if(t=t.slice(-2),e=e.slice(-2),Nt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r||zp(n)&&zp(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&zp(t[0])&&zp(e[0])}let Jy,e1;function Gie(t){if(Jy==null){const e=Si(t);Jy=e.getParameter(e.MAX_TEXTURE_SIZE)}return Jy}function jie(t){if(e1==null){const e=Si(t);e1=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,e1)}function Hie(t){if(t===0)return 0;let e;const n=Si(t);return Hs(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Hs(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Hs(t,e){return t.getExtension(e)!=null}function iT(t){try{if(Si(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function qie(t){if(t===0)return!1;const e=Si(t);if(t===1){if(!Hs(e,"OES_texture_float"))return!1}else if(!Hs(e,"EXT_color_buffer_float"))return!1;return qx(e)}function Kie(t){if(t===0)return!1;const e=Si(t);if(t===1){if(!Hs(e,"OES_texture_float")||!Hs(e,"WEBGL_color_buffer_float"))return!1}else{if(Hs(e,"EXT_color_buffer_float"))return qx(e);const r="EXT_color_buffer_half_float";if(Hs(e,r)){const s=e.getExtension(r);return Xie(e,s)}return!1}return qx(e)}function qx(t){const e=nS(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const r=1,s=1;t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,r,s,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function Xie(t,e){const n=nS(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const s=1,i=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,s,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(o),a}function Yie(t){return t!==2?!1:Si(t).fenceSync!=null}function Jf(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&F(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ke=me();Ke.registerFlag("HAS_WEBGL",()=>Ke.getNumber("WEBGL_VERSION")>0);Ke.registerFlag("WEBGL_VERSION",()=>iT(2)?2:iT(1)?1:0);Ke.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ke.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ke.get("WEBGL_VERSION")===2);Ke.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ke.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ke.registerFlag("WEBGL_PACK",()=>Ke.getBool("HAS_WEBGL"));Ke.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_CLIP",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_PACK_REDUCE",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_CONV_IM2COL",()=>Ke.getBool("WEBGL_PACK"));Ke.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Gie(Ke.getNumber("WEBGL_VERSION")));Ke.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>jie(Ke.getNumber("WEBGL_VERSION")));Ke.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Ke.getNumber("WEBGL_VERSION");return t===0?0:Hie(t)});Ke.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ke.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!RA());Ke.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>qie(Ke.getNumber("WEBGL_VERSION")));Ke.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ke.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ke.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ke.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Kie(Ke.getNumber("WEBGL_VERSION")));Ke.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Yie(Ke.getNumber("WEBGL_VERSION")));Ke.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ke.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ke.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Ke.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>RA()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Ke.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ke.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ke.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ke.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ke.registerFlag("WEBGL_EXP_CONV",()=>!1);Ke.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ke.getBool("IS_TEST"));Ke.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ke.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ke.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ke.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rr(){let t,e,n,r,s,i,o,a,l,u;return me().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",s="texture",i="outputColor",o="out vec4 outputColor;",a=me().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",s="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:s,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ql(t,e,n="index"){const r=Qe(e);return r.map((s,i)=>{const o=`int ${t[i]} = ${n} / ${s}`,a=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${s}`:`index -= ${t[i]} * ${s}`;return`${o}; ${a};`}).join("")}function Pv(t,e,n="index"){const r=Qe(e);return r.map((s,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,a=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function Zie(t,e){const n=t.length,r=t.map(i=>`${e}[${i}]`),s=new Array(n-1);s[n-2]=r[n-1];for(let i=n-3;i>=0;--i)s[i]=`(${s[i+1]} * ${r[i+1]})`;return s}function Qie(t,e,n="index"){const r=t.map((i,o)=>o),s=Zie(r,e);return s.map((i,o)=>{const a=`int ${t[o]} = ${n} / ${s[o]}`,l=o===s.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${s[o]}`:`index -= ${t[o]} * ${s[o]}`;return`${a}; ${l};`}).join("")}function rS(t){const e=Qe(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function sS(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const OL=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:FL}=VK;function Jie(t,e,n){const r=[];if(t.forEach(f=>{const m=be(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?r.push(`uniform float ${f.name}${m>1?`[${m}]`:""};`):(r.push(`uniform sampler2D ${f.name};`),r.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:v}=iS(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(v.length){case 1:r.push(`uniform int ${f.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${f.name}Shape;`);break}r.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{r.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const s=r.join(`
`),i=t.map(f=>eoe(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,a=Rr(),l=roe(a);let u,c,h=ooe(a);return e.isPacked?(u=toe(e.logicalShape,o,n.enableShapeUniforms),c=ioe(a)):(u=noe(e.logicalShape,o,n.enableShapeUniforms),c=soe(a)),n.packedInputs&&(h+=coe),[h,l,c,s,u,i,n.userCode].join(`
`)}function _c(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return Coe(t,e);case 1:return koe(t,e);case 2:return Ioe(t,e);case 3:return _oe(t,e);case 4:return $oe(t,e);case 5:return Doe(t);case 6:return Aoe(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function LL(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return woe(t);case 1:return Soe(t,e);case 2:return Eoe(t,e);case 3:return Toe(t,e);default:return Noe(t,e)}}function eoe(t,e,n=!1,r){let s="";n?s+=LL(t,r):s+=_c(t,r);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?s+=Roe(t,e):s+=Ooe(t,e)),s}function toe(t,e,n){switch(t.length){case 0:return PL();case 1:return hoe(t,e,n);case 2:return xoe(t,e,n);case 3:return foe(t,e,n);default:return moe(t,e,n)}}function noe(t,e,n){switch(t.length){case 0:return PL();case 1:return doe(t,e,n);case 2:return boe(t,e,n);case 3:return poe(t,e,n);case 4:return goe(t,e,n);case 5:return voe(t,e);case 6:return yoe(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function roe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function soe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function ioe(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function ooe(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${aoe}
    ${loe}
    ${uoe}
  `}const aoe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,loe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,uoe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,coe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function PL(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function hoe(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function doe(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function foe(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[2]/2),i=s*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function poe(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Pv(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=ql(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function moe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[t.length-1]/2),i=s*Math.ceil(t[t.length-2]/2);let o=i,a="",l="b, r, c";for(let u=2;u<t.length-1;u++)o*=t[t.length-u-1],a=`
      int b${u} = index / ${o};
      index -= b${u} * ${o};
    `+a,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${t.length}(${l});
    }
  `}function goe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Pv(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=ql(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function voe(t,e){const n=ql(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function yoe(t,e){const n=ql(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function xoe(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Nt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function boe(t,e,n){return Nt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Kl(t){return`offset${t}`}function woe(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Rr();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function Coe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[s,i]=t.shapeInfo.texShape;if(s===1&&i===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Kl(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function Soe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape,i=Rr();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function koe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${Nc(t)}
      }
    `;const s=t.shapeInfo.texShape,i=s[0],o=s[1];if(o===1&&i===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Kl(n);return o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function Eoe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],l=Rr();if(i!=null&&Nt(n,i))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function Ioe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape;if(i!=null&&Nt(n,i)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const d=i[0],f=i[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:o,keptDims:a}=Ia(n),l=o;if(l.length<n.length){const d=$c(t,l),f=["row","col"];return`
      ${_c(d,e)}
      float ${s}(int row, int col) {
        return ${s}(${Dc(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Nc(t)}
      }
    `;const u=i[0],c=i[1],h=Kl(r);return c===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${h};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${h};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function Toe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const d=n.slice(1),f=[1,2],m=$c(t,d),v=["b","row","col"];return`
        ${LL(m,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${Dc(v,f)});
        }
      `}const a=Rr();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const l=o[0],u=o[1],c=Math.ceil(n[2]/2),h=c*Math.ceil(n[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${h}, ${c}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function _oe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],{newShape:a,keptDims:l}=Ia(n),u=a;if(u.length<n.length){const v=$c(t,u),p=["row","col","depth"];return`
        ${_c(v,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${Dc(p,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${Nc(t)}
      }
    `;const c=t.shapeInfo.texShape,h=c[0],d=c[1],f=t.shapeInfo.flatOffset;if(d===i&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${d}.0, ${h}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(d===o&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `;const m=Kl(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${m};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${m};
        vec2 uv = uvFromFlat(${h}, ${d}, index);
        return sampleTexture(${r}, uv);
      }
  `}function Noe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=Rr();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],c=l[1],h=Math.ceil(i[o-1]/2);let d=h*Math.ceil(i[o-2]/2),f="int b, int row, int col",m=`b * ${d} + (row / 2) * ${h} + (col / 2)`;for(let v=2;v<o-1;v++)f=`int b${v}, `+f,d*=i[o-v-1],m=`b${v} * ${d} + `+m;return`
    vec4 ${r}(${f}) {
      int index = ${m};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${s.texture2D}(${n}, uv);
    }
  `}function $oe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,a=n[1]*o,{newShape:l,keptDims:u}=Ia(n);if(l.length<n.length){const y=$c(t,l),b=["row","col","depth","depth2"];return`
      ${_c(y,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${Dc(b,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${Nc(t)}
      }
    `;const c=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],f=h[1],m=`int stride2 = ${r}Shape[3];`,v=`int stride1 = ${r}Shape[2] * stride2;`,p=`int stride0 = ${r}Shape[1] * stride1;`;if(f===a&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${m}
        ${v}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(f===i&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;const g=Kl(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${m}
      ${v}
      ${p}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${g});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${d}, ${f}, index + ${g});
      return sampleTexture(${r}, uv);
    }
  `}function Doe(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[4],i=e[3]*s,o=e[2]*i,a=e[1]*o,{newShape:l,keptDims:u}=Ia(e);if(l.length<e.length){const v=$c(t,l),p=["row","col","depth","depth2","depth3"];return`
      ${_c(v)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${Dc(p,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${s})) +
          depth3;
        ${Nc(t)}
      }
    `;const c=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],f=h[1];if(f===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===s&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=Kl(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${s} + depth3 + ${m};
      vec2 uv = uvFromFlat(${d}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Aoe(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:i}=Ia(e);if(s.length<e.length){const p=$c(t,s),g=["row","col","depth","depth2","depth3","depth4"];return`
      ${_c(p)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${Dc(g,i)});
      }
    `}const o=e[5],a=e[4]*o,l=e[3]*a,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Nc(t)}
      }
    `;const h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],m=d[1];if(m===c&&h==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(m===o&&h==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const v=Kl(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${v};
      vec2 uv = uvFromFlat(${f}, ${m}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Nc(t){const e=t.name,n=be(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function Roe(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=FL(t.shapeInfo.logicalShape,e.logicalShape),l=Ut(o),u=o-i;let c;const h=["x","y","z","w","u","v"];i===0?c="":o<2&&a.length>=1?c="coords = 0;":c=a.map(y=>`coords.${h[y+u]} = 0;`).join(`
`);let d="";o<2&&i>0?d="coords":d=t.shapeInfo.logicalShape.map((y,b)=>`coords.${h[b+u]}`).join(", ");let f="return outputValue;";const v=be(t.shapeInfo.logicalShape)===1,g=be(e.logicalShape)===1;if(i===1&&!v&&!g)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(v&&!g)o===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const y=i-2,b=i-1;a.indexOf(y)>-1&&a.indexOf(b)>-1?f="return vec4(outputValue.x);":a.indexOf(y)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(b)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${d});
      ${f}
    }
  `}function Ooe(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&Nt(o,i))return`
      float ${s}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=Ut(l),c=FL(t.shapeInfo.logicalShape,e.logicalShape),h=l-a;let d;const f=["x","y","z","w","u","v"];a===0?d="":l<2&&c.length>=1?d="coords = 0;":d=c.map(v=>`coords.${f[v+h]} = 0;`).join(`
`);let m="";return l<2&&a>0?m="coords":m=t.shapeInfo.logicalShape.map((v,p)=>`coords.${f[p+h]}`).join(", "),`
    float ${s}() {
      ${u} coords = getOutputCoords();
      ${d}
      return get${r}(${m});
    }
  `}function Ut(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function iS(t,e,n){const{newShape:r,keptDims:s}=Ia(e),i=e.length,o=t&&i===3&&e[0]===1,a=o?e.slice(1):r,l=!t&&i>1&&!Nt(e,n)&&r.length<i||o;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:s}}function $c(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Dc(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Foe(t,e,n,r){const s=n.map((c,h)=>{const d={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(d.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[h],shapeInfo:d}}),i=s.map(c=>c.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=Jie(s,o,e),l=_ie(t.gl,a),u=t.createProgram(l);return me().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:i,outShapeInfo:o},ML(t,e,u)))}function ML(t,e,n){const r=[],s=[];let i,o,a,l=null,u=null;u=t.getUniformLocation(n,"NAN",!1),me().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const h of e.variableNames){const d={name:h,uniform:t.getUniformLocation(n,h,c),offset:t.getUniformLocation(n,`offset${h}`,c)};e.enableShapeUniforms&&(d.shape=t.getUniformLocation(n,`${h}Shape`,c),d.texShape=t.getUniformLocation(n,`${h}TexShape`,c)),r.push(d)}if(e.enableShapeUniforms&&(i=t.getUniformLocation(n,"outShape",c),a=t.getUniformLocation(n,"outShapeStrides",c),o=t.getUniformLocation(n,"outTexShape",c)),e.customUniforms)for(const h of e.customUniforms)s.push(t.getUniformLocation(n,h.name,c));return{variablesLocations:r,customUniformLocations:s,infLoc:l,nanLoc:u,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function oT(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const s=n.logicalShape,i=e[r],o=i.shape;if(!Nt(s,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!Nt(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function Loe(t,e,n,r,s){e.program.enableShapeUniforms||(oT(e.inShapeInfos,n),oT([e.outShapeInfo],[r]));const i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),me().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const u=n[l],{uniform:c,offset:h,shape:d,texShape:f}=e.variablesLocations[l];if(d){const{uniformShape:m}=iS(e.program.packedInputs,u.shape,u.texData.texShape);switch(m.length){case 1:t.gl.uniform1iv(d,new Int32Array(m));break;case 2:t.gl.uniform2iv(d,new Int32Array(m));break;case 3:t.gl.uniform3iv(d,new Int32Array(m));break;case 4:t.gl.uniform4iv(d,new Int32Array(m));break}}if(f&&t.gl.uniform2i(f,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(be(u.shape)<2)t.gl.uniform1f(c,u.uniformValues[0]);else{let m=u.uniformValues;m instanceof Float32Array||(m=new Float32Array(m)),t.gl.uniform1fv(c,m)}continue}u.texData.slice!=null&&h!=null&&t.gl.uniform1i(h,u.texData.slice.flatOffset),t.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=Qe(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],c=e.customUniformLocations[l],h=s[l];if(u.type==="float")t.gl.uniform1fv(c,h);else if(u.type==="vec2")t.gl.uniform2fv(c,h);else if(u.type==="vec3")t.gl.uniform3fv(c,h);else if(u.type==="vec4")t.gl.uniform4fv(c,h);else if(u.type==="int")t.gl.uniform1iv(c,h);else if(u.type==="ivec2")t.gl.uniform2iv(c,h);else if(u.type==="ivec3")t.gl.uniform3iv(c,h);else if(u.type==="ivec4")t.gl.uniform4iv(c,h);else throw Error(`uniform type ${u.type} is not supported yet.`)}t.executeProgram()}function Poe(t,e,n){let r="";e.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:h}=iS(t.packedInputs,o.shape,l);let d="",f="",m="";if(c.length===1&&t.packedInputs){const w=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];d=`${w[0]>1}_${w[1]>1}`}else if(c.length===2&&!t.packedInputs)f=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const w=Qe(c);m=`${w[0]===l[1]}_${w[w.length-1]===l[1]}`}const v=o.shape.length,p=c.length===2&&Nt(o.shape,l),g=be(o.shape)===1,y=tc(o.shape,n.shape),b=!t.packedInputs&&v===n.shape.length&&Nt(l,n.texData.texShape),x=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${v}_${b}_${u?h:""}_${c.length}_${g}_${y}_${p}_${d}_${f}_${m}_${x}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;r+=`${o.shape}_${l}_${a}`}});const s=t.userCode;let i=t.constructor.name;return i+="_"+r+"_"+s+`${me().getNumber("WEBGL_VERSION")}`,i}function xr(t){return me().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Moe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=dd.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Rr();this.outputShape=e,this.enableShapeUniforms=xr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Pv(["r","c","d"],e):ql(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Boe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=dd.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Rr();this.outputShape=e,this.enableShapeUniforms=xr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Pv(["r","c","d"],e):ql(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zoe{constructor(e){this.variableNames=["A"],this.outTexUsage=ys.DOWNLOAD;const n=Rr();this.outputShape=e,this.userCode=`
      ${OL}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uoe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=ys.DOWNLOAD;const n=Rr();this.outputShape=e,this.userCode=`
      ${OL}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Voe={R:0,G:1,B:2,A:3};class aT{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Rr();this.outputShape=e,this.enableShapeUniforms=xr(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<r.length;a++){const l=r[a];o+=`
          if(offset == ${a}) {
            result = values[${Voe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?sS():rS(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${o}
        }
        ${s.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Woe{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Rr();this.outputShape=e,this.enableShapeUniforms=xr(this.outputShape.length);let s="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;s+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?sS():rS(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Goe(t){const e=Rr(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return Tie(t,n)}function joe(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return Aie(t,e)}function Hoe(t){const e=new Uint16Array([0,1,2,2,1,3]);return Rie(t,e)}function ep(t,e,n,r,s,i){Fie(e,n);const o=Oie(t),a=t.TEXTURE_2D;return Ue(t,()=>t.bindTexture(a,o)),Ue(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),Ue(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),Ue(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),Ue(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),me().getNumber("WEBGL_VERSION")===1?Ue(t,()=>t.texImage2D(a,0,r,e,n,0,s,i,null)):Ue(t,()=>t.texStorage2D(a,1,r,e,n)),Ue(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function BL(t){return t.internalFormatFloat}function qoe(t,e,n,r){const[s,i]=Qf(e,n);return ep(t,s,i,BL(r),r.textureFormatFloat,t.FLOAT)}function zL(t){return t.internalFormatHalfFloat}function Koe(t,e,n,r){const[s,i]=Qf(e,n);return ep(t,s,i,zL(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function UL(t){return t.downloadTextureFormat}function Xoe(t,e,n,r){const[s,i]=Qf(e,n);return ep(t,s,i,UL(r),t.RGBA,t.UNSIGNED_BYTE)}function VL(t){return t.internalFormatPackedFloat}function Yoe(t,e,n,r){const[s,i]=Tc(e,n);return ep(t,s,i,VL(r),t.RGBA,t.FLOAT)}function WL(t){return t.internalFormatPackedHalfFloat}function Zoe(t,e,n,r){const[s,i]=Tc(e,n);return ep(t,s,i,WL(r),t.RGBA,r.textureTypeHalfFloat)}function Qoe(t,e,n){return Ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),rT(t,e,"clipSpacePos",n,3,20,0)&&rT(t,e,"uv",n,2,20,12)}function Joe(t,e,n,r,s,i){Ue(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,a,l;s instanceof Uint8Array?(o=new Uint8Array(n*r*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(o=new Float32Array(n*r*4),a=t.FLOAT,l=i.internalFormatPackedFloat),o.set(s),me().getNumber("WEBGL_VERSION")===2?Ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,a,o)):Ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,a,o)),Ue(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function eae(t,e,n){Ue(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?me().getNumber("WEBGL_VERSION")===2?Ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):Ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):me().getNumber("WEBGL_VERSION")===2?Ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):Ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),Ue(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function tae(t,e,n,r){const s=t.createBuffer();Ue(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const a=4*4*e*n;return Ue(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),Ue(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),Ue(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}function nae(t,e,n){const r=t,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function rae(t,e,n,r){const[s,i]=Qf(e,n),o=4,a=new Uint8Array(bie(e*n,o));return Ue(t,()=>t.readPixels(0,0,s,i,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function sae(t,e,n,r,s,i,o,a){const l=t,u=new Float32Array(wie(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function iae(t,e,n){const r=new Float32Array(e*n*4);return Ue(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t1{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=me().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,vie(n,e)):this.gl=Si(n),e=this.gl,me().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>Ue(i,()=>i.createVertexArray()),this.bindVertexArray=o=>Ue(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>Ue(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>Ue(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ue(e,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>Ue(e,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>Ue(e,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>Ue(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),me().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=Pp(this.gl,i),Hs(this.gl,o))this.textureHalfFloatExtension=Pp(this.gl,o);else if(me().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Hs(this.gl,s))this.colorBufferHalfFloatExtension=Pp(this.gl,s);else if(me().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Hs(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Hs(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=joe(this.gl),this.indexBuffer=Hoe(this.gl),this.framebuffer=Lie(this.gl),this.textureConfig=nS(this.gl,this.textureHalfFloatExtension)}get debug(){return me().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Ue(e,()=>e.finish()),Ue(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Ue(e,()=>e.deleteFramebuffer(this.framebuffer)),Ue(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Ue(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Ue(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),qoe(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),Koe(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),Xoe(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),eae(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,s){this.throwIfDisposed(),Joe(this.gl,e,n,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),Zoe(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),Yoe(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(sT(this.gl,this.framebuffer),this.outputTexture=null),Ue(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>rae(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,s,i,o){return sae(this.gl,e,n,r,s,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return nae(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const s=tae(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(me().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,i=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const o=s.clientWaitSync(i,0,0);return o===s.ALREADY_SIGNALED||o===s.CONDITION_SATISFIED},n=i}else me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>iae(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=Goe(n));const r=$ie(n);Ue(n,()=>n.attachShader(r,this.vertexShader)),Ue(n,()=>n.attachShader(r,e)),Die(n,r);const s=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&Zy(n,s),s}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;Ue(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Qoe(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Ue(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Zy(this.gl,this.program),Ue(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?Mie(this.gl,e,n):Bie(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),Ue(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),zie(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[s,i]=Tc(n,r);this.setOutputMatrixTextureDriver(e,s,i)}setOutputMatrixWriteRegion(e,n,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,n)}setOutputPackedMatrixWriteRegion(e,n,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Zy(this.gl,this.program),Mp(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ue(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ue(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Pp(this.gl,me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await HE(()=>this.disposed||this.isQueryAvailable(e,me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=oae(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in me().platform&&(r=me().platform.setTimeoutCustom.bind(me().platform)),HE(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Qy(this.gl,e,this.framebuffer),this.debug&&Mp(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Qy(this.gl,this.outputTexture,this.framebuffer),this.debug&&Mp(this.gl)):sT(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const s=this.gl;Qy(s,e,this.framebuffer),this.debug&&Mp(s),this.outputTexture=e,Ue(s,()=>s.viewport(0,0,n,r)),Ue(s,()=>s.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,s){this.throwIfDisposed(),Ue(this.gl,()=>this.gl.scissor(e,n,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function oae(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:aae,bincountImpl:GL,bincountReduceImpl:lae,bitwiseAndImpl:uae,castImpl:cae,ceilImpl:hae,concatImpl:dae,equalImpl:fae,expImpl:pae,expm1Impl:mae,floorImpl:gae,gatherNdImpl:vae,gatherV2Impl:yae,greaterImpl:xae,greaterEqualImpl:bae,lessImpl:wae,lessEqualImpl:Cae,linSpaceImpl:Sae,logImpl:kae,maxImpl:Eae,maximumImpl:Iae,minimumImpl:Tae,multiplyImpl:_ae,negImpl:Nae,notEqualImpl:$ae,prodImpl:Dae,raggedGatherImpl:Aae,raggedRangeImpl:Rae,raggedTensorToTensorImpl:Oae,rangeImpl:Fae,rsqrtImpl:Lae,scatterImpl:Pae,sigmoidImpl:Mae,simpleAbsImpl:jL,sliceImpl:Bae,sparseFillEmptyRowsImpl:zae,sparseReshapeImpl:Uae,sparseSegmentReductionImpl:HL,sqrtImpl:Vae,staticRegexReplaceImpl:Wae,stridedSliceImpl:Gae,stringNGramsImpl:jae,stringSplitImpl:Hae,stringToHashBucketFastImpl:qae,subImpl:Kae,tileImpl:Xae,topKImpl:Yae,transposeImpl:oS,uniqueImpl:Zae}=eee;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qL(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function Ir(t,e){return e===1?[t]:qL(t,e)}function Qae(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jae{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=xr(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Ir("rc",this.rank),r=Ut(this.rank),s=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let i=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KL{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=xr(this.outputShape.length);let r="";for(let s=0;s<4;s++){let i="thisRC = rc;";s%2===1&&(i+="thisRC.z += 1;"),s>1&&(i+="thisRC.y += 1;"),r+=`
        ${i}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${ele(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?sS():rS(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function ele(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Qie(["r","c","d"],"inputShape"):ql(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tle{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,r){const s=uT(n,r),i=cT(e,s,r);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=lT(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let a;return s===sr.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===sr.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===sr.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===sr.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===sr.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,n,r,s){if(this.freeTextures==null)return;const i=uT(r,s),o=cT(n,i,s);o in this.freeTextures||(this.freeTextures[o]=[]);const a=lT(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,s),l=me().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const u=this.usedTextures[o],c=u&&u.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function nle(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function lT(t,e,n,r,s){const i=rle(e,r);let o;if(s){const[l,u]=Tc(t[0],t[1]);o=l*u}else{const[l,u]=Qf(t[0],t[1]);o=l*u}const a=nle(n,i);return o*a}function rle(t,e){switch(t){case sr.PACKED_2X2_FLOAT32:return VL(e);case sr.PACKED_2X2_FLOAT16:return WL(e);case sr.UNPACKED_FLOAT32:return BL(e);case sr.UNPACKED_FLOAT16:return zL(e);case sr.PACKED_4X1_UNSIGNED_BYTE:return UL(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function sle(t){return me().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?sr.PACKED_2X2_FLOAT32:sr.UNPACKED_FLOAT32:t?sr.PACKED_2X2_FLOAT16:sr.UNPACKED_FLOAT16}function uT(t,e){if(t===ys.UPLOAD)return sr.PACKED_2X2_FLOAT32;if(t===ys.RENDER||t==null)return sle(e);if(t===ys.DOWNLOAD||t===ys.PIXELS)return sr.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function cT(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ui{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=xr(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const ei="if (isnan(x)) return x;",ile="return x;",hT="return abs(x);",ole="return (x >= 0.0) ? x : (exp(x) - 1.0);",ale=ei+`
  return (x < 0.0) ? 0.0 : x;
`,lle=ei+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Wo="return x;",ule="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cle="return x;",hle=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,dle=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,fle=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ple="return 1.0 / (1.0 + exp(-1.0 * x));";class Zo{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=xr(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mle{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=xr(this.outputShape.length);const n=e.length,r=Ir("rc",n),s=Ut(n),i=Qae(n,r),o=r.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gle=yR,vle=1e-7,yle=1e-4,Up={};function xle(t){return t in Up||(Up[t]={}),Up[t]}const ble=me().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),wle=600;function Cle(){return me().global.screen==null?1024:me().global.screen.height*me().global.screen.width*window.devicePixelRatio*wle/1024/1024}class Mv extends xw{nextDataId(){return Mv.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!me().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof t1)n=e;else{const r=Si(me().getNumber("WEBGL_VERSION"),e);n=new t1(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=Si(me().getNumber("WEBGL_VERSION"));n=new t1(r),this.binaryCache=xle(me().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new tle(this.gpgpu),this.numMBBeforeWarning=Cle(),this.texData=new UD(this,Ri())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,s,i,o){const a=this.makeTensorInfo(n,r),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[s,i]},l.texShape=[s,i];const u=Bp(n),c=new aT(u,!1,o),h=this.runWebGLProgram(c,[a],r,[[s,i]]);return h.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),h.dataId}write(e,n,r){if((me().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||me().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:n,dtype:r,values:e,usage:ys.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,s,i){if(me().getBool("DEBUG")&&this.checkNumericalProblems(n),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:n,usage:ys.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:i,slice:o,shape:a,isPacked:l}=n;if(o!=null){let d;l?d=new Zo(a,Wo):d=new Ui(a,Wo);const f=this.runWebGLProgram(d,[{dataId:e,shape:a,dtype:s}],s),m=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),m}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=Lr());let h;if(s==="complex64"){const d=this.readSync(i.real.dataId),f=this.readSync(i.imag.dataId);h=Eo(d,f)}else h=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=Lr()-c),this.convertAndCacheOnCPU(e,h)}async read(e){if(this.pendingRead.has(e)){const m=this.pendingRead.get(e);return new Promise(v=>m.push(v))}const n=this.texData.get(e),{values:r,shape:s,slice:i,dtype:o,complexTensorInfos:a,isPacked:l}=n;if(i!=null){let m;l?m=new Zo(s,Wo):m=new Ui(s,Wo);const v=this.runWebGLProgram(m,[{dataId:e,shape:s,dtype:o}],o),p=this.read(v.dataId);return this.disposeIntermediateTensorInfo(v),p}if(r!=null)return this.convertAndCacheOnCPU(e);if(me().getBool("DEBUG")&&!me().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&me().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(o!=="complex64"&&me().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const m=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(m.texture.texture,...Lp(s))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let h;if(o==="complex64"){const m=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),v=m[0],p=m[1];h=Eo(v,p)}else if(u==null)h=this.getValuesFromTexture(e);else{const m=be(s);h=this.gpgpu.downloadFloat32MatrixFromBuffer(u,m)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const m=this.gpgpu.gl;Ue(m,()=>m.deleteBuffer(u))}const d=this.convertAndCacheOnCPU(e,h),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(m=>m(d)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Ri().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e,n={}){const r=this.texData.get(e),{values:s,shape:i,slice:o,dtype:a,isPacked:l,texture:u}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let f;l?f=new Zo(i,Wo):f=new Ui(i,Wo);const m=this.runWebGLProgram(f,[{dataId:e,shape:i,dtype:a}],a),v=this.readToGPU(m,n);return this.disposeIntermediateTensorInfo(m),v}if(u==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),h=Ri().makeTensorFromTensorInfo(c),d=this.texData.get(c.dataId);return Object.assign({tensorRef:h},d.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>ma(s));return pt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return pt(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!Eie(r))throw me().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:s}=this.texData.get(e),i=be(n);if(me().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const d=this.decode(e),f=this.texData.get(d.dataId),m=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...Lp(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(d),m}const o=me().getBool("WEBGL_PACK")&&s===!0,a=o?Bp(n):n,l=o?new Uoe(a):new zoe(a),u=this.runWebGLProgram(l,[{shape:a,dtype:r,dataId:e}],"float32"),c=this.texData.get(u.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(u),h}timerAvailable(){return me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const i=vl(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=vl(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=H5(l),a.getExtraProfileInfo=()=>l.map((u,c)=>({name:o[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Lr(),endMs:null}}endTimer(e){return me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Lr(),e)}async getQueryTime(e){if(me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:s,usage:i,isPacked:o,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(n,s,i,o)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=ble){return me().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&be(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){gs("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return gle(e.shape,n)}packedUnaryOp(e,n,r){const s=new Zo(e.shape,n),i=this.compileAndRun(s,[e],r);return Ri().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=jL(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(me().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,hT,e.dtype);const n=new Ui(e.shape,hT),r=this.compileAndRun(n,[e]);return Ri().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&Md(r[0])){const i=r.map(o=>ua(o));s=this.write(i,e,n)}else s=this.write(r,e,n);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:n}}makeOutput(e,n,r){return Ri().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new mle(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new Jae(e.shape),r=!0;return this.runWebGLProgram(n,[e],e.dtype,null,r)}packedReshape(e,n){const r=[lc(e.shape),...uc(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},i=[lc(n),...uc(n)],o=new KL(i,r),a=!0,l=[r],u=this.runWebGLProgram(o,[s],e.dtype,l,a);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:s,shape:i,dtype:o}=r;if(n!=null){const d=be(i),f=n[0]*n[1]*4;F(d<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=Bp(i);let l;s?l=new Boe(a):l=new Moe(a);const u=!0,c=[n??Lp(a)],h=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:e}],o,c,u,n);return{dtype:o,shape:i,dataId:h.dataId}}runWebGLProgram(e,n,r,s,i=!1,o){const a=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===dd.DENSE){const g=o??Lp(e.outputShape);l.texShape=g.map(y=>y*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),be(a.shape)===0)return l.values=gr(a.dtype,0),a;const u=[],c=n.map(g=>{if(g.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let y=this.texData.get(g.dataId);if(y.texture==null){if(!e.packedInputs&&be(g.shape)<=me().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:g.shape,texData:null,isUniform:!0,uniformValues:y.values};e.packedInputs&&(y.isPacked=!0,y.shape=g.shape)}if(this.uploadToGPU(g.dataId),!!y.isPacked!=!!e.packedInputs)g=y.isPacked?this.unpackTensor(g):this.packTensor(g),u.push(g),y=this.texData.get(g.dataId);else if(y.isPacked&&!mg(y.shape,g.shape)){const b=g,x=g.shape;g.shape=y.shape,g=this.packedReshape(g,x),u.push(g),y=this.texData.get(g.dataId),b.shape=x}return{shape:g.shape,texData:y,isUniform:!1}});this.uploadToGPU(a.dataId);const h={shape:a.shape,texData:l,isUniform:!1},d=Poe(e,c,h),f=this.getAndSaveBinary(d,()=>Foe(this.gpgpu,e,c,h)),m=this.activeTimers!=null;let v;m&&(v=this.startTimer()),me().get("ENGINE_COMPILE_ONLY")||Loe(this.gpgpu,f,c,h,s),u.forEach(g=>this.disposeIntermediateTensorInfo(g)),m&&(v=this.endTimer(v),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(v)}));const p=me().getNumber("WEBGL_FLUSH_THRESHOLD");if(p>0){const g=Lr();g-this.lastGlFlushTime>p&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!me().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const g=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),g}return a}compileAndRun(e,n,r,s,i=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,s,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(me().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=pe(()=>{if(!me().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=me().getBool("DEBUG");me().set("DEBUG",!1);const n=this.abs(At(1e-8)).dataSync()[0];if(me().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?vle:yle}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:s,values:i,texture:o,usage:a,isPacked:l}=n;if(o!=null)return;const u=this.activeTimers!=null;let c;u&&(c=Lr());let h=n.texShape;if(h==null&&(h=Wie(r,l),n.texShape=h),i!=null){const d=Bp(r);let f,m=h[1],v=h[0];const p=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!p)&&([m,v]=Tc(h[0],h[1])),l?f=new Woe(d,p):f=new aT(d,p);const g=p?[v,m]:h,y=this.makeTensorInfo(g,s),b=this.texData.get(y.dataId);p?b.usage=ys.PIXELS:b.usage=ys.UPLOAD,b.texShape=g,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),m,v,i);const x=[[v,m]],w=!0,C=this.runWebGLProgram(f,[y],s,x,w),S=this.texData.get(C.dataId);n.texShape=S.texShape,n.isPacked=S.isPacked,n.usage=S.usage,me().get("ENGINE_COMPILE_ONLY")?this.disposeData(C.dataId):(n.texture=S.texture,n.values=null,this.texData.delete(C.dataId)),this.disposeIntermediateTensorInfo(y),u&&(this.uploadWaitMs+=Lr()-c)}else{const d=this.acquireTexture(h,a,s,l);n.texture=d}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:s}=r;return n!=null&&(r.values=Sle(n,s)),r.values}acquireTexture(e,n,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,s)}computeBytes(e,n){return e[0]*e[1]*Vm(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(n),s(!0)}catch(i){throw i}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await PR(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(RL(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:s,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:l}=ML(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,r){e.channels=e.channels||"RGBA";const{texture:s,height:i,width:o,channels:a}=e,l=Ri().backend;if(!l.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(s,n,r,i,o,a);return Ri().makeTensorFromDataId(u,n,r,l)}}Mv.nextDataId=0;function Sle(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */OA()&&WA("webgl",()=>new Mv,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aS=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Nl{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=ut(n,r),this.enableShapeUniforms=xr(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xl=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Ac{constructor(e,n,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ut(n,r);const i=this.outputShape.length;this.enableShapeUniforms=xr(i);let o="";if(s)if(i===0||be(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${Ut(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Ir("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function as(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const kle={kernelName:of,backendName:"webgl",kernelFunc:as};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fa(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),a=as({inputs:{x:r},backend:n}),l=as({inputs:{x:s},backend:n});return o.complexTensorInfos={real:a,imag:l},i}const Ele={kernelName:Aw,backendName:"webgl",kernelFunc:Fa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XL="return (a < 0.) ? b * a : a;",YL=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Ile(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:i}=r,o=n.makeTensorInfo([],"float32",Ta(i,"float32")),a=me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ac(YL,s.shape,o.shape):new Nl(XL,s.shape,o.shape),l=n.runWebGLProgram(a,[s,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const Tle={kernelName:R0,backendName:"webgl",kernelFunc:Ile};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZL="return (a < 0.) ? b * a : a;",QL=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function _le(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,i=me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ac(QL,r.shape,s.shape):new Nl(ZL,r.shape,s.shape);return n.runWebGLProgram(i,[r,s],"float32")}const Nle={kernelName:Q0,backendName:"webgl",kernelFunc:_le};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rc="if (isnan(x)) return x;";function St({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:s,backend:i})=>{const{x:o}=s,a=i,l=r||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const h=a.texData.get(o.dataId),d=n(h.values,l);return a.makeTensorInfo(o.shape,l,d)}const u=me().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new Zo(o.shape,e):c=new Ui(o.shape,t),a.runWebGLProgram(c,[o],l)}}function hr({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:i}){return({inputs:o,backend:a})=>{const{a:l,b:u}=o,c=a;if(r&&l.dtype==="complex64"){const m=c.texData.get(l.dataId),v=c.texData.get(u.dataId),[p,g]=[[m.complexTensorInfos.real,v.complexTensorInfos.real],[m.complexTensorInfos.imag,v.complexTensorInfos.imag]].map(b=>{const[x,w]=b,C={dataId:x.dataId,dtype:x.dtype,shape:l.shape},S={dataId:w.dataId,dtype:w.dtype,shape:u.shape},E=new Nl(t,l.shape,u.shape);return c.runWebGLProgram(E,[C,S],is(x.dtype,w.dtype))}),y=Fa({inputs:{real:p,imag:g},backend:c});return c.disposeIntermediateTensorInfo(p),c.disposeIntermediateTensorInfo(g),y}const h=i||is(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&s!=null){const m=c.texData.get(l.dataId).values,v=c.texData.get(u.dataId).values,p=l.dtype==="string"?Io(m):m,g=l.dtype==="string"?Io(v):v,[y,b]=s(l.shape,u.shape,p,g,h),x=c.makeTensorInfo(b,h),w=c.texData.get(x.dataId);return w.values=y,x}const d=me().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return d?f=new Ac(e,l.shape,u.shape,n):f=new Nl(t,l.shape,u.shape),c.runWebGLProgram(f,[l,u],h)}}function fd(t,e=!1){if(t==="linear")return e?cle:ile;if(t==="relu")return e?dle:ale;if(t==="elu")return e?hle:ole;if(t==="relu6")return e?fle:lle;if(t==="prelu")return e?QL:ZL;if(t==="leakyrelu")return e?YL:XL;if(t==="sigmoid")return e?ple:ule;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JL{constructor(e,n,r,s=!1,i=!1,o=!1,a=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=xr(this.outputShape.length);const c=s?e[1]:e[2],h=Math.ceil(c/2),d=s?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",m=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],v=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let p="",g="";a&&(l?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:u?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:p=`vec4 activation(vec4 x) {
          ${a}
        }`,g="result = activation(result);");const y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let b="rc.x",x="rc.x";e[0]<n[0]?b=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(x=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${p}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${h}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${x};
        for (int i = 0; i < ${h}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${m[0]} * ${v[0]});
          result += (${m[1]} * ${v[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${y}

        ${g}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dT={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class fT{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ut(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pT="return a * b;";function lS(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,i=is(r.dtype,s.dtype);if(r.dtype==="complex64"){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),u=new fT(dT.REAL,r.shape,s.shape),c=new fT(dT.IMAG,r.shape,s.shape),h=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],d=n.runWebGLProgram(u,h,"float32"),f=n.runWebGLProgram(c,h,"float32"),m=Fa({inputs:{real:d,imag:f},backend:n});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),m}if(n.shouldExecuteOnCPU([r,s])){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),[u,c]=_ae(r.shape,s.shape,a.values,l.values,i),h=n.makeTensorInfo(c,i),d=n.texData.get(h.dataId);return d.values=u,h}let o;return me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new Ac(pT,r.shape,s.shape):o=new Nl(pT,r.shape,s.shape),n.runWebGLProgram(o,[r,s],i)}const $le={kernelName:mf,backendName:"webgl",kernelFunc:lS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dle(t,e,n){const r=[lc(t.shape),...uc(t.shape)],s={dtype:t.dtype,shape:r,dataId:t.dataId},i=[lc(e),...uc(e)],o=new KL(i,r),a=!0,l=[r],u=n.runWebGLProgram(o,[s],t.dtype,l,a);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Be(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:i}=r,o=n,a=be(s.shape),l=WD(i,a),u=be(l);F(a===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const c=o.texData.get(s.dataId);return c.isPacked&&!mg(s.shape,l)&&!(c.texture!==null&&mg(c.shape,l))?Dle(s,l,o):(o.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype})}const Ale={kernelName:ev,backendName:"webgl",kernelFunc:Be};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mT{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];const a=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(n!=null){const h=1/n;u=`sumValue += dot(values * ${Qu(h)?h.toPrecision(2):h}, ones);`}let c="";i%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rle{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,h=r%4;let d=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let m="";i%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${m}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${c};
        if (${h===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ole(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=Cv(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function Yl(t,e,n,r){const s=Ole(t.shape);let i=t;for(let o=0;o<s.length;o++){const{inSize:a,windowSize:l,outSize:u}=s[o];let c,h;n==="mean"?c=o===0?new mT({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},a):new mT({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u}):c=new Rle({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},n),h=i,i=r.runWebGLProgram(c,[i],e),h.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(h)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fle{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[n[o]];this.outputShape=r,this.rank=r.length;const s=Ut(this.rank),i=Lle(n);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function Lle(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<t.length;s++)r[t[s]]=n[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ple{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let c=0;c<r.length;c++)r[c]=e[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=Ut(this.rank),i=qL("rc",this.rank),o=new Array(this.rank);for(let c=0;c<n.length;c++)o[n[c]]=i[c];const a=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bv(t,e,n){const r=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ple(t.shape,e):new Fle(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mle(t,e,n,r){const s=e,i=t.shape.length,o=mt(s,t.shape);let a=o;const l=hn(a,i),u=l!=null;let c=t;u&&(c=Bv(t,l,r),a=Cn(a.length,i)),cr("sum",a,i);const[h,d]=tr(c.shape,a);let f=h;n&&(f=Fn(h,o));const m=be(d),p=be(t.shape)/m,g=Be({inputs:{x:c},attrs:{shape:[p,m]},backend:r}),y=f2(t.dtype),b=Yl(g,y,"sum",r),x=Be({inputs:{x:b},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(b),u&&r.disposeIntermediateTensorInfo(c),x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zv(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;return Mle(s,i,o,n)}const Ble={kernelName:ov,backendName:"webgl",kernelFunc:zv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $r(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:i}=r,o=n,a=s.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=s.shape[i[c]];let u;if(o.shouldExecuteOnCPU([s])){const h=o.texData.get(s.dataId).values,d=oS(h,s.shape,s.dtype,i,l);u=o.makeTensorInfo(l,s.dtype);const f=o.texData.get(u.dataId);f.values=d}else u=Bv(s,i,o);return u}const zle={kernelName:Mu,backendName:"webgl",kernelFunc:$r};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eP=1e3;function gg({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,h=n?t.shape[u-2]:t.shape[u-1],d=r?e.shape[c-1]:e.shape[c-2],f=n?t.shape[u-1]:t.shape[u-2],m=r?e.shape[c-2]:e.shape[c-1],v=t.shape.slice(0,-2),p=e.shape.slice(0,-2),g=be(v),y=be(p),x=ut(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,m]);F(h===d,()=>`Error in matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const w=n?[g,h,f]:[g,f,h],C=r?[y,m,d]:[y,d,m],S=Be({inputs:{x:t},backend:s,attrs:{shape:w}}),E=Be({inputs:{x:e},backend:s,attrs:{shape:C}}),T=[S,E],_=Math.max(g,y),A=n?S.shape[1]:S.shape[2],L=i!=null,W=o!=null,K=l==="leakyrelu",R=l!=null?fd(l,!0):null,M=L||W||K||R!=null;let U;if((f===1||m===1)&&A>eP&&M===!1){let B=S,X=E;n&&(B=$r({inputs:{x:S},backend:s,attrs:{perm:[0,2,1]}}),T.push(B)),r&&(X=$r({inputs:{x:E},backend:s,attrs:{perm:[0,2,1]}}),T.push(X));const ie=m!==1,G=m===1;let Z=B;ie&&(Z=Be({inputs:{x:B},backend:s,attrs:{shape:[_,A,1]}}),T.push(Z));const de=m===1?2:1;let ge=X;G&&(ge=Be({inputs:{x:X},backend:s,attrs:{shape:[_,1,A]}}),T.push(ge));const ye=lS({inputs:{a:Z,b:ge},backend:s});U=zv({inputs:{x:ye},backend:s,attrs:{axis:de,keepDims:!0}}),T.push(ye)}else{const B=is(t.dtype,e.dtype),X=new JL(w,C,[_,f,m],n,r,L,R,W,K),ie=[S,E];if(i!=null&&ie.push(i),W&&ie.push(o),K){const G=s.makeTensorInfo([],"float32",Ta(a,"float32"));ie.push(G),T.push(G)}U=s.runWebGLProgram(X,ie,B)}const D=Be({inputs:{x:U},backend:s,attrs:{shape:x}});T.push(U);for(const B of T)s.disposeIntermediateTensorInfo(B);return D}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ule(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:h}=r;return gg({a:s,b:i,transposeA:l,transposeB:u,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:h,activation:c})}const Vle={kernelName:Wm,backendName:"webgl",kernelFunc:Ule};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gT="return abs(x);";function Wle(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const i=n.texData.get(r.dataId),o=jL(i.values);return n.makeTensorInfo(r.shape,r.dtype,o)}let s;return me().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Zo(r.shape,gT):s=new Ui(r.shape,gT),n.runWebGLProgram(s,[r],r.dtype)}const Gle={kernelName:f0,backendName:"webgl",kernelFunc:Wle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jle=ei+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Hle=St({opSnippet:jle}),qle={kernelName:Bd,backendName:"webgl",kernelFunc:Hle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kle=ei+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Xle=St({opSnippet:Kle}),Yle={kernelName:zd,backendName:"webgl",kernelFunc:Xle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vT="return a + b;",Zle=hr({opSnippet:vT,packedOpSnippet:vT,supportsComplex:!0,cpuKernelImpl:aae}),Qle={kernelName:wc,backendName:"webgl",kernelFunc:Zle};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jle{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`float v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eue{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`vec4 v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function am(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return as({inputs:{x:r[0]},backend:n});if(r.length>me().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),u=am({inputs:r.slice(0,l),backend:n}),c=am({inputs:r.slice(l),backend:n});return am({inputs:[u,c],backend:n})}const s=r.map(l=>l.dtype).reduce((l,u)=>is(l,u)),i=r.map(l=>l.shape),a=me().getBool("WEBGL_PACK")?new eue(r[0].shape,i):new Jle(r[0].shape,i);return n.runWebGLProgram(a,r,s)}const tue={kernelName:Ew,backendName:"webgl",kernelFunc:am};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=mt(i,s.shape);let u=l;const c=hn(u,a);let h=s;c!=null&&(h=$r({inputs:{x:s},backend:n,attrs:{perm:c}}),u=Cn(u.length,a)),cr("all",u,a);const[d,f]=tr(h.shape,u),m=be(f),v=Be({inputs:{x:h},backend:n,attrs:{shape:[-1,m]}}),p=Yl(v,v.dtype,"all",n);let g;if(o){const y=Fn(d,l);g=Be({inputs:{x:p},backend:n,attrs:{shape:y}})}else g=Be({inputs:{x:p},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(p),c!=null&&n.disposeIntermediateTensorInfo(h),g}const rue={kernelName:Iw,backendName:"webgl",kernelFunc:nue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=mt(i,s.shape);let u=l;const c=hn(u,a);let h=s;c!=null&&(h=$r({inputs:{x:s},backend:n,attrs:{perm:c}}),u=Cn(u.length,a)),cr("any",u,a);const[d,f]=tr(h.shape,u),m=be(f),v=Be({inputs:{x:h},backend:n,attrs:{shape:[-1,m]}}),p=Yl(v,v.dtype,"any",n);let g;if(o){const y=Fn(d,l);g=Be({inputs:{x:p},backend:n,attrs:{shape:y}})}else g=Be({inputs:{x:p},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(p),c!=null&&n.disposeIntermediateTensorInfo(h),g}const iue={kernelName:Tw,backendName:"webgl",kernelFunc:sue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oue{constructor(e,n,r){this.variableNames=["A"];const{windowSize:s,batchSize:i,outSize:o}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aue{constructor(e,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,F(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,u=Ut(l),c=Ir("coords",l);let h,d;if(o===1){d=l+1;const E=Ut(d);h=`
        ${E} sourceLocR = ${E}(${c.join()}, 0);
        ++${c[l-1]};
        ${E} sourceLocG = ${E}(${c.join()}, 0);
        ++${c[l-2]};
        ${E} sourceLocA = ${E}(${c.join()}, 0);
        --${c[l-1]};
        ${E} sourceLocB = ${E}(${c.join()}, 0);
        --${c[l-2]};`}else d=l,h=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,d),m="."+f[d-1],v=f.map(E=>"int "+E),p=Ir("sourceLocR",d-1).concat("inIdx.r"),g=Ir("sourceLocG",d-1).concat("inIdx.g"),y=Ir("sourceLocB",d-1).concat("inIdx.b"),b=Ir("sourceLocA",d-1).concat("inIdx.a"),x=r==="max"?"greaterThan":"lessThan",w=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${p.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${b.join()})));`,C=`vec4(
            getAChannel(${p.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${y.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,S=s?"":`
      float getBestIndicesAChannel(${v.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${v.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${S}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${a[l-2]-1};
        ${h}
        ivec4 srcIdx = ivec4(sourceLocR${m}, sourceLocG${m},
          sourceLocB${m}, sourceLocA${m}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${C};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${w}
          vec4 candidate = ${C};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${x}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tP(t,e,n,r=null){let s=e.shape[0],i=e.shape[1];r!=null&&(s=r.shape[0],i=r.shape[1]);const o=Cv(i),a={windowSize:o,inSize:i,batchSize:s,outSize:Math.ceil(i/o)},l=new oue(a,n,r==null),u=[e];r!=null&&u.push(r);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const h=tP(t,e,n,c);return t.disposeIntermediateTensorInfo(c),h}function nP(t,e,n,r=null){const s=r!=null?r.shape:e.shape,i=s[s.length-1],o=Cv(i),a=new aue(s,o,n,r==null),l=r==null?[e]:[e,r],u=t.runWebGLProgram(a,l,"int32");if(u.shape.length===e.shape.length){const c=nP(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function rP(t,e,n,r){const s=[n];if(cr("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!me().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),a=o!==null&&o.isPacked;let l=e;a&&(l=t.unpackTensor(e),i.push(l));const[u,c]=tr(l.shape,s),h=be(c),d=Be({inputs:{x:l},backend:t,attrs:{shape:[-1,h]}});i.push(d);const f=tP(t,d,r);i.push(f);const m=Be({inputs:{x:f},backend:t,attrs:{shape:u}});return i.forEach(v=>t.disposeIntermediateTensorInfo(v)),m}return nP(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;let o=mt(i,s.shape);const a=hn(o,s.shape.length);let l=s;const u=[];a!=null&&(l=$r({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),o=Cn(o.length,l.shape.length)),cr("argMax",[o[0]],l.shape.length);const c=rP(n,l,o[0],"max");return u.forEach(h=>n.disposeIntermediateTensorInfo(h)),c}const uue={kernelName:p0,backendName:"webgl",kernelFunc:lue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;let o=mt(i,s.shape);const a=hn(o,s.shape.length);let l=s;const u=[];a!=null&&(l=$r({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),o=Cn(o.length,l.shape.length)),cr("argMin",[o[0]],l.shape.length);const c=rP(n,l,o[0],"min");return u.forEach(h=>n.disposeIntermediateTensorInfo(h)),c}const hue={kernelName:m0,backendName:"webgl",kernelFunc:cue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const due=ei+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,fue=St({opSnippet:due}),pue={kernelName:Ud,backendName:"webgl",kernelFunc:fue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mue=ei+"return log(x + sqrt(x * x + 1.0));",gue=St({opSnippet:mue}),vue={kernelName:Vd,backendName:"webgl",kernelFunc:gue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yue=ei+`
  return atan(x);
`,xue=St({opSnippet:yue}),bue={kernelName:Wd,backendName:"webgl",kernelFunc:xue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wue=aS+`
  return atan(a, b);
`,Cue=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Xl+`
  return result;
`,Sue=hr({opSnippet:wue,packedOpSnippet:Cue}),kue={kernelName:jd,backendName:"webgl",kernelFunc:Sue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eue=ei+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Iue=St({opSnippet:Eue}),Tue={kernelName:Gd,backendName:"webgl",kernelFunc:Iue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pd{constructor(e,n,r,s=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;const v=n==="avg",p=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let y="0.0";if(v||(y="-1.0 / 1e-20"),r){const E=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${m});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${h};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${E} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?i?p:g:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let x=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(x="avgValue / max(count, 1.0)");const w=Math.floor(o/4)*4,C=o%4,S=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${m});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${h};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${w}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${S}
          }

          int xC = xCCorner + ${w};
          if (${C===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${S}
          } else if (${C===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${S}
          } else if (${C===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${S}
          }
        }
        setOutput(${x});
      }
    `}}class uS{constructor(e,n,r,s=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,h=e.dilationHeight,d=e.dilationWidth,f=e.effectiveFilterDepth,m=e.effectiveFilterHeight,v=e.effectiveFilterWidth,p=e.padInfo.front,g=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const b=n==="avg";let x="0.0";if(b||(x="-1.0 / 1e-20"),r){const _=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${u});
        const ivec3 pads = ivec3(${p}, ${g}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${m};
                wR += ${h}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${v};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${_} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${m} * ${v} +
                      wR * ${v} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let C=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(C="avgValue / max(count, 1.0)");const S=Math.floor(o/4)*4,E=o%4,T=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${u});
      const ivec3 pads = ivec3(${p}, ${g}, ${y});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${m};
            wR += ${h}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${S}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${T}
            }

            int xC = xCCorner + ${S};
            if (${E===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${T}
            } else if (${E===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${T}
            } else if (${E===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${T}
            }
          }
        }
        setOutput(${C});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Jf(s,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;F(yr(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Qs(s.shape,i,o,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&Nt(c.inShape,c.outShape))return as({inputs:{x:s},backend:n});const h=new pd(c,"avg",!1);return n.runWebGLProgram(h,[s],"float32")}const Nue={kernelName:g0,backendName:"webgl",kernelFunc:_ue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],h=Do(s.shape,i,o,c,a,l,u),d=new uS(h,"avg",!1);return n.runWebGLProgram(d,[s],"float32")}const Due={kernelName:v0,backendName:"webgl",kernelFunc:$ue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Aue{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,h=u-1-e.padInfo.left,d=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${h});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Rue{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,h=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=h-1-e.padInfo.front,v=d-1-e.padInfo.top,p=f-1-e.padInfo.left,g=1/(n*r*s);this.userCode=`
      const ivec3 pads = ivec3(${m}, ${v}, ${p});
      const float avgMultiplier = float(${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oue(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,h=[1,1,1],d=Do(o.shape,a,l,h,u,c),f=new Rue(d);return n.runWebGLProgram(f,[s],o.dtype)}const Fue={kernelName:Nw,backendName:"webgl",kernelFunc:Oue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lue(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i;Jf([s,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=Qs(o.shape,a,l,1,u),h=new Aue(c);return n.runWebGLProgram(h,[s],o.dtype)}const Pue={kernelName:_w,backendName:"webgl",kernelFunc:Lue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mue(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;return gg({a:s,b:i,transposeA:o,transposeB:a,backend:n})}const Bue={kernelName:y0,backendName:"webgl",kernelFunc:Mue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zue{constructor(e,n,r,s,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],ut(e,n),ut(e,r);let a="0.0";s!=null&&(ut(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(ut(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uue{constructor(e,n,r,s,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ut(e,n),ut(e,r);let a="vec4(0.0)";s!=null&&(ut(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(ut(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vue=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:s,variance:i,offset:o,scale:a}=t;F(s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),F(o==null||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),F(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[r,s,i];let c=null;o!=null&&(c=o.shape,u.push(o));let h=null;a!=null&&(h=a.shape,u.push(a));const d=me().getBool("WEBGL_PACK_NORMALIZATION")?new Uue(r.shape,s.shape,i.shape,c,h,l):new zue(r.shape,s.shape,i.shape,c,h,l);return e.runWebGLProgram(d,u,u[0].dtype)},Wue={kernelName:$0,backendName:"webgl",kernelFunc:Vue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gue{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=Ut(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=jue(this.rank);let s;const i=e.map((o,a)=>`sourceLoc.${Kx[a]} = start[${a}] + coords.${Kx[a]};`);s=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const Kx=["x","y","z","w","u","v"];function jue(t){if(t===1)return"sourceLoc";if(t<=6)return Kx.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hue{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=Ut(this.rank),r=Ir("coords",this.rank),s=Ir("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,o=`getChannel(getSource(${s.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${o};
        --${s[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${o};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${o};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,h)=>`start[${h}]`).join()});`:e.map((c,h)=>`${s[h]} = ${r[h]} + start[${h}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function que(t,e,n,r){const s=r.texData.get(t.dataId),i=r.makeTensorInfo(n,t.dtype),o=r.texData.get(i.dataId);Object.assign(o,s),o.refCount=1,o.shape=n,o.dtype=t.dtype;let a=sC(e,Qe(t.shape));s.slice&&(a+=s.slice.flatOffset),o.slice={flatOffset:a,origDataId:s.slice&&s.slice.origDataId||t.dataId};const l=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,l+1),i}function Oc(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,size:o}=r,[a,l]=wv(s,i,o);if(tC(s,a,l),be(l)===0)return n.makeTensorInfo(l,s.dtype,[]);if(n.shouldExecuteOnCPU([s])||s.dtype==="string"){const h=n.texData.get(s.dataId),d=Bae(h.values,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,d)}const{isPacked:u}=n.texData.get(s.dataId),c=rC(s.shape,a,l);if(u||!c){const h=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Hue(l):new Gue(l),d=[a];return n.runWebGLProgram(h,[s],s.dtype,d)}return n.uploadToGPU(s.dataId),que(s,a,l,n)}const Kue={kernelName:iv,backendName:"webgl",kernelFunc:Oc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xue=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,crops:o}=r;F(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((y,b)=>y*b),l=zf(s.shape,i,a),u=Uf(l.length,i.length),c=Vf(s.shape,i,a),h=uC(o,i.length),d=cC(c,o,i.length),f=[],m=Be({inputs:{x:s},backend:n,attrs:{shape:l}}),v=$r({inputs:{x:m},backend:n,attrs:{perm:u}}),p=Be({inputs:{x:v},backend:n,attrs:{shape:c}}),g=Oc({inputs:{x:p},backend:n,attrs:{begin:h,size:d}});return f.push(m),f.push(v),f.push(p),f.forEach(y=>n.disposeIntermediateTensorInfo(y)),g},Yue={kernelName:x0,backendName:"webgl",kernelFunc:Xue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o}=r,a=n.readSync(s.dataId),l=n.readSync(i.dataId),u=GL(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}const Que={kernelName:$w,backendName:"webgl",kernelFunc:Zue};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jue=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,ece=`
  return float(int(a.r) & int(b.r));
`;function tce(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,i=me().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=me().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,s])||o===1){const l=n.texData.get(r.dataId).values,u=n.texData.get(s.dataId).values,[c,h]=uae(r.shape,s.shape,l,u,r.dtype),d=n.makeTensorInfo(h,r.dtype),f=n.texData.get(d.dataId);return f.values=c,d}let a;return i?a=new Ac(Jue,r.shape,s.shape,!1):a=new Nl(ece,r.shape,s.shape),n.runWebGLProgram(a,[r,s],r.dtype)}const nce={kernelName:Dw,backendName:"webgl",kernelFunc:tce};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rce(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,i=n.readSync(r.dataId),o=n.readSync(s.dataId),a=ut(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const sce={kernelName:XD,backendName:"webgl",kernelFunc:rce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ice="return float(a != b);",sP=hr({opSnippet:ice,cpuKernelImpl:$ae,dtype:"bool"}),oce={kernelName:q0,backendName:"webgl",kernelFunc:sP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tp(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return as({inputs:{x:s.complexTensorInfos.real},backend:n})}const ace={kernelName:n2,backendName:"webgl",kernelFunc:tp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lce="return float(int(x));";function uce(t,e){const n=new Ui(t.shape,lce),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xx(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return as({inputs:{x:s},backend:n});const o=Qn(s.shape),a=Xx({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),l=Fa({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),l}if(s.dtype==="complex64"){const o=tp({inputs:{input:s},backend:n}),a=Xx({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),a}if(!GD(s.dtype,i)){const o=as({inputs:{x:s},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([s])){const o=n.texData.get(s.dataId).values,[a,l,u]=cae(o,s.shape,s.dtype,i);return n.makeTensorInfo(a,l,u)}if(i==="int32")return uce(s,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",gr("bool",1)),l=sP({inputs:{a:s,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${i}`)}const cce={kernelName:Hd,backendName:"webgl",kernelFunc:Xx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yT="return ceil(x);",hce=St({opSnippet:yT,packedOpSnippet:yT,cpuKernelImpl:hae}),dce={kernelName:qd,backendName:"webgl",kernelFunc:hce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fce{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pce{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mce(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:i,clipValueMax:o}=r;let a;me().getBool("WEBGL_PACK_CLIP")?a=new pce(s.shape):a=new fce(s.shape);const l=[[i],[o]];return n.runWebGLProgram(a,[s],s.dtype,l)}const gce={kernelName:Kd,backendName:"webgl",kernelFunc:mce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vce{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xT(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function yce(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.texData.get(r.dataId),i=new vce(r.shape),o=[xT(r,s.complexTensorInfos.real),xT(r,s.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const xce={kernelName:b0,backendName:"webgl",kernelFunc:yce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bce{constructor(e){this.outputShape=[],this.outputShape=Ki(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];r.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const s=n.length,i=n[n.length-1];r.push(`else setOutput(getT${s}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wce{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ki(e,n);const r=this.outputShape,s=r.length,i=Ut(s),o=Ir("coords",s),a=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((v,p)=>`T${p}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let v=1;v<l.length;v++)l[v]=l[v-1]+e[v][n];const u=a[n],c=a.slice(-2),h=a.join();let d=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${h}), vec2(${c.join()}));
        }`;for(let v=1;v<l.length;v++){const p=l[v-1];d+=`
        if (${u} < ${l[v]}  && ${u} >= ${l[v-1]}) {
          return getChannel(
            getT${v}(${Vp(a,u,p)}),
            vec2(${Vp(c,u,p)}));
        }`}const f=l.length,m=l[l.length-1];d+=`
        return getChannel(
          getT${f}(${Vp(a,u,m)}),
          vec2(${Vp(c,u,m)}));`,this.userCode=`
      float getValue(${a.map(v=>"int "+v)}) {
        ${d}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[s-1]} = ${o[s-1]} + 1;
        if (${o[s-1]} < ${r[s-1]}) {
          result.g = getValue(${o});
        }

        ${o[s-2]} = ${o[s-2]} + 1;
        if (${o[s-2]} < ${r[s-2]}) {
          result.a = getValue(${o});
        }

        ${o[s-1]} = ${o[s-1]} - 1;
        if (${o[s-2]} < ${r[s-2]} &&
            ${o[s-1]} < ${r[s-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function Vp(t,e,n){const r=t.indexOf(e);return t.map((i,o)=>o===r?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uv(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return as({inputs:{x:s.complexTensorInfos.imag},backend:n})}const Cce={kernelName:Kw,backendName:"webgl",kernelFunc:Uv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gh(t,e,n){const r=t[0].dtype;if(r==="complex64"){const f=t.map(y=>tp({inputs:{input:y},backend:n})),m=t.map(y=>Uv({inputs:{input:y},backend:n})),v=gh(f,e,n),p=gh(m,e,n),g=Fa({inputs:{real:v,imag:p},backend:n});return f.forEach(y=>n.disposeIntermediateTensorInfo(y)),m.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(p),g}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const f=t.map(x=>{const C=[-1,be(x.shape.slice(e))];return Be({inputs:{x},backend:n,attrs:{shape:C}})}),m=f.map(x=>({vals:n.readSync(x.dataId),shape:x.shape})),v=Ki(f.map(x=>x.shape),1),p=f[0].shape[0]===1,g=dae(m,v,r,p),y=Ki(t.map(x=>x.shape),e),b=n.makeTensorInfo(y,r,g);return f.forEach(x=>n.disposeIntermediateTensorInfo(x)),b}const i=t.filter(f=>be(f.shape)>0),o=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const f=o?new Ui(t[0].shape,Wo):new Zo(t[0].shape,Wo);return n.runWebGLProgram(f,t,r)}const a=me().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const f=[];for(let v=0;v<i.length;v+=a){const p=i.slice(v,v+a);f.push(gh(p,e,n))}const m=gh(f,e,n);for(const v of f)n.disposeIntermediateTensorInfo(v);return m}if(o){const f=new wce(i.map(m=>m.shape),e);return n.runWebGLProgram(f,i,r)}const{tensors2D:l,outShape:u}=Sce(i,e,n),c=new bce(l.map(f=>f.shape)),h=n.runWebGLProgram(c,l,r);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const d=Be({inputs:{x:h},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(h),d}function Sce(t,e,n){const r=Ki(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>Be({inputs:{x:i},attrs:{shape:[-1,be(i.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iP(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,i=mt(s,e[0].shape)[0],o=e.map(u=>u.shape);oC(o,i);const a=Ki(e.map(u=>u.shape),i);if(be(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>be(u.shape)>0);return l.length===1?as({inputs:{x:l[0]},backend:n}):gh(l,i,n)}const kce={kernelName:w0,backendName:"webgl",kernelFunc:iP};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oP{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,h=e.dilationWidth,d=e.filterHeight,f=e.filterWidth,m=Math.floor(e.inChannels/4)*4,v=e.inChannels%4,p=e.dataFormat==="channelsLast",g=p?1:2,y=p?2:3,b=p?3:1;let x="",w="";r&&(s?x=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?x=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:x=`
          float activation(float x) {
            ${r}
          }
        `,w="result = activation(result);");const C=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${x}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${g}], coords[${y}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${h};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${m}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${p}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${v===1}) {

              if (${p}) {
                dotProd +=
                    getX(batch, xR, xC, ${m}) *
                    getW(wR, wC, ${m}, d2);
              } else {
                dotProd +=
                    getX(batch, ${m}, xR, xC) *
                    getW(wR, wC, ${m}, d2);
              }

            } else if (${v===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2)
              );

              if (${p}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${v===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2),
                getW(wR, wC, ${m} + 2, d2)
              );

              if (${p}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1),
                  getX(batch, xR, xC, ${m} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC),
                  getX(batch, ${m} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${C}
        ${w}
        setOutput(result);
      }
    `}}class Ece{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,h=e.filterDepth,d=e.filterHeight,f=e.filterWidth,m=Math.floor(e.inChannels/4)*4,v=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${h}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${m}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${v===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${m}) *
                  getW(wF, wR, wC, ${m}, d2);
              } else if (${v===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${v===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1),
                  getX(batch, xF, xR, xC, ${m} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2),
                  getW(wF, wR, wC, ${m} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aP{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=xr(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,h=c;let d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let p=0;p<c;p++)d+=`
           vec4 xTexelC${p*2};
           int xTexelC${p*2}Ready;
           vec4 xTexelC${p*2+1};
           int xTexelC${p*2+1}Ready;
           vec4 xC${p};`;d+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let p=0;p<c;p++)d+=`
           xTexelC${p*2} = vec4(0.0);
           xTexelC${p*2}Ready = 0;
           xTexelC${p*2+1} = vec4(0.0);
           xTexelC${p*2+1}Ready = 0;
           xC${p} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let p=0;p<(h+1)/2;p++){const g=p*2;if(d+=`
           xC = xCCorner + ${g*l};
           `,a===1){if(g<c&&(o%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }
               `,l===1&&g>0?d+=`
                 xC${g} = vec4(xTexelC${g-2}.zw, xTexelC${g}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${g} = vec4(previous.zw, xTexelC${g}.xy);
                   } else {
                     xC${g} = vec4(0.0, 0.0, xTexelC${g}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xC${g} = xTexelC${g};
                 `,g+1<c)){const y=o%2===0?bw(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${y};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                     xTexelC${g+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${g+1}.zw = vec2(0.0);
                     }
                     xTexelC${g+1}Ready = 1;
                   }
                   `,l>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${g+1} = vec4(previous.zw, xTexelC${g+1}.xy);
                     } else {
                      xC${g+1} = vec4(0.0, 0.0, xTexelC${g+1}.xy);
                     }
                     `:d+=`
                     xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.xy);
                     `):y===1?d+=`
                     xC${g+1} = xTexelC${g};
                     `:d+=`
                     xCOffset = xC + ${y};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                       xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${g+1}.zw = vec2(0.0);
                       }
                       xTexelC${g+1}Ready = 1;
                     }

                     xC${g+1} = xTexelC${g+1};
                     `}}else g<c&&(o%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.0);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
               `,g+1<c&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${g+1} = vec4(xTexelC${g+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(
                   xTexelC${g}.xy, xTexelC${g+1}.xy);
               `,g+1<c&&(d+=`
                   xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
                 `)));g<c&&(d+=`
             wTexel = getW(r, ${g}, d1, d2);
             dotProd += xC${g}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${g}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,g+1<c&&(d+=`
               wTexel = getW(r, ${g+1}, d1, d2);
               dotProd += xC${g+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${g+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let f="",m="";r&&(s?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:i?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:f=`vec4 activation(vec4 x) {
           ${r}
         }`,m="result = activation(result);");const v=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${v}
         ${m}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ice{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=xr(this.outputShape.length);const{dataFormat:r}=n,s=Rr(),i=r==="channelsLast",o=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let h=0;h<=1;h++)u+=`
          blockIndex = rc.z + ${h};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+h}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+h}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vg(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function lP({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=t.shape,u=r.texData.get(t.dataId),c=n.inChannels,h=l[0]*l[1]*l[2],d=n.outChannels,f=n.dataFormat==="channelsLast",m=!1,v=!1;let p;const g=[];if(i!=null){const x=vg(i.shape,f);x!=null&&(i=Be({inputs:{x:i},backend:r,attrs:{shape:x}}),g.push(i))}if(s!=null){const x=vg(s.shape,f);x!=null&&(s=Be({inputs:{x:s},backend:r,attrs:{shape:x}}),g.push(s))}if(!((h===1||d===1)&&c>eP)&&u.isPacked&&f&&u.texture!=null&&l[2]%2!==0&&Nt(u.shape.slice(-3),l.slice(-3))){const x=l[0]*l[1]*(l[2]+1),w={dataId:t.dataId,shape:[1,x,n.inChannels],dtype:t.dtype},C=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,F(mg(u.shape,w.shape),()=>`packed reshape ${u.shape} to ${w.shape} isn't free`);const S=Be({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});g.push(S);const E=gg({a:w,b:S,backend:r,transposeA:m,transposeB:v,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),T=r.texData.get(E.dataId);F(T.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=C,T.shape=n.outShape,p=as({inputs:{x:E},backend:r}),p.shape=n.outShape,g.push(E)}else{const x=n.outHeight*n.outWidth,w=Be({inputs:{x:t},backend:r,attrs:{shape:f?[n.batchSize,x,n.inChannels]:[n.batchSize,n.inChannels,x]}}),C=Be({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),S=gg({a:f?w:C,b:f?C:w,transposeA:!f,transposeB:v,backend:r,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o});p=Be({inputs:{x:S},backend:r,attrs:{shape:n.outShape}}),g.push(w),g.push(C),g.push(S)}for(const x of g)r.disposeIntermediateTensorInfo(x);return p}function uP({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:h,outHeight:d,dataFormat:f}=n,m=f==="channelsLast",v=l*u*c,p=d*h,g=[n.batchSize,v,p],y=!0,b=!1,x=[];if(i!=null){const D=vg(i.shape,m);D!=null&&(i=Be({inputs:{x:i},backend:r,attrs:{shape:D}}),x.push(i))}if(s!=null){const D=vg(s.shape,m);D!=null&&(s=Be({inputs:{x:s},backend:r,attrs:{shape:D}}),x.push(s))}const w=Be({inputs:{x:e},backend:r,attrs:{shape:[1,v,be(e.shape)/v]}});x.push(w);const C=new Ice(g,n),S=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],E=r.runWebGLProgram(C,[t],"float32",S),T=Be({inputs:{x:E},backend:r,attrs:{shape:g}});x.push(E),x.push(T);const _=s!=null,A=i!=null,L=a==="leakyrelu",W=a?fd(a,!0):null,K=new JL(m?T.shape:w.shape,m?w.shape:T.shape,m?[n.batchSize,p,n.outChannels]:[n.batchSize,n.outChannels,p],y,b,_,W,A,L),R=m?[T,w]:[w,T];if(s&&R.push(s),A&&R.push(i),L){const D=r.makeTensorInfo([],"float32",Ta(o,"float32"));R.push(D),x.push(D)}const M=r.runWebGLProgram(K,R,"float32"),U=Be({inputs:{x:M},backend:r,attrs:{shape:n.outShape}});x.push(M);for(const D of x)r.disposeIntermediateTensorInfo(D);return U}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tce(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r,h=Ao(l),d=ur(s.shape,i.shape,o,u,a,c,!1,h);let f;if(d.filterHeight===1&&d.filterWidth===1&&d.dilationHeight===1&&d.dilationWidth===1&&d.strideHeight===1&&d.strideWidth===1&&(d.padInfo.type==="SAME"||d.padInfo.type==="VALID"))f=lP({x:s,filter:i,convInfo:d,backend:n});else if(d.strideWidth<=2&&h==="channelsLast"&&me().getBool("WEBGL_EXP_CONV")){const v=new aP(d),p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];f=n.runWebGLProgram(v,[s,i],"float32",p)}else if(me().getBool("WEBGL_CONV_IM2COL"))f=uP({x:s,filter:i,convInfo:d,backend:n});else{const v=new oP(d);f=n.runWebGLProgram(v,[s,i],"float32")}const m=Be({inputs:{x:f},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(f),m}const _ce={kernelName:C0,backendName:"webgl",kernelFunc:Tce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nce{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class $ce{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=r-1-e.padInfo.left,u=o?1:2,c=o?2:3,h=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${h}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Dce{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Ace{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,u=r-1-e.padInfo.top,c=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rce(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,h=Ao(l),d=ur(s.shape,c,o,1,a,u,!1,h),f=new Nce(d);return n.runWebGLProgram(f,[s,i],"float32")}const Oce={kernelName:Rw,backendName:"webgl",kernelFunc:Rce};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fce{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=xr(this.outputShape.length);const n=e.filterHeight,r=e.filterWidth,s=n-1-e.padInfo.top,i=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lce(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r,h=Ao(u),d=ur(o,i.shape,a,1,l,c,!1,h);if(me().getBool("WEBGL_PACK")&&h==="channelsLast"){const f=[[d.strideHeight,d.strideWidth]],m=new Fce(d);return n.runWebGLProgram(m,[s,i],"float32",f)}else{const f=new $ce(d);return n.runWebGLProgram(f,[s,i],"float32")}}const Pce={kernelName:S0,backendName:"webgl",kernelFunc:Lce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mce(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r,u=Na(s.shape,i.shape,o,l,a),c=new Ece(u);return n.runWebGLProgram(c,[s,i],"float32")}const Bce={kernelName:k0,backendName:"webgl",kernelFunc:Mce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zce(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:l}=r,u=Na(s.shape,l,o,1,a),c=new Dce(u);return n.runWebGLProgram(c,[s,i],"float32")}const Uce={kernelName:Ow,backendName:"webgl",kernelFunc:zce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vce(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{pad:o,strides:a,inputShape:l}=r,u=Na(l,i.shape,a,1,o),c=new Ace(u);return n.runWebGLProgram(c,[s,i],"float32")}const Wce={kernelName:Fw,backendName:"webgl",kernelFunc:Vce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gce=Rc+`
  return cos(x);
`,jce=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Xl}
  return result;
`,Hce=St({opSnippet:Gce,packedOpSnippet:jce}),qce={kernelName:Xd,backendName:"webgl",kernelFunc:Hce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kce=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Xce=St({opSnippet:Kce}),Yce={kernelName:Yd,backendName:"webgl",kernelFunc:Xce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zce{constructor(e,n,r,s,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,u]=e,[c]=n,[h,d]=r;this.outputShape=[c,h,d,u];const f=s==="bilinear"?1:0,[m,v]=[`${a-1}.0`,`${l-1}.0`],[p,g,y]=h>1?[`${(a-1)/(h-1)}`,"(y2-y1) * height_ratio",`y1*${m} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${m}`],[b,x,w]=d>1?[`${(l-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${v} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${v}`];this.userCode=`
      const float height_ratio = float(${p});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${g};
        float width_scale = ${x};

        float in_y = ${y};
        if( in_y < 0.0 || in_y > ${m} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${w};
        if( in_x < 0.0 || in_x > ${v} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qce=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:u}=r,c=new Zce(s.shape,i.shape,a,l,u);return n.runWebGLProgram(c,[s,i,o],"float32")},Jce={kernelName:Pw,backendName:"webgl",kernelFunc:Qce};var md;(function(t){t.Prod="*",t.Sum="+"})(md||(md={}));class bT{constructor(e,n,r,s){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===md.Prod?"1.0":"0.0",a=r?o:`getX(${wT(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=s?`end != ${l-1}`:"end != 0",c=s?"end + 1":"end - 1"):(u=s?`end + pow2 < ${l}`:"end >= pow2",c=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Ut(i)} coords = getOutputCoords();
        int end = ${CT(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${CT(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${wT(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function wT(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function CT(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cP(t,e,n,r,s,i){const o=e.shape.length,a=hn([r],o);let l=e;a!=null&&(l=$r({inputs:{x:e},backend:n,attrs:{perm:a}}));const u=Cn(1,o)[0];if(u!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let h=as({inputs:{x:l},backend:n});for(let d=0;d<=Math.ceil(Math.log2(c))-1;d++){const f=new bT(t,l.shape,!1,i),m=[[d]],v=h;h=n.runWebGLProgram(f,[h],h.dtype,m),n.disposeIntermediateTensorInfo(v)}if(s){const d=new bT(t,l.shape,s,i),f=h;h=n.runWebGLProgram(d,[h],h.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const d=$a(a),f=$r({inputs:{x:h},backend:n,attrs:{perm:d}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(l),f}return h}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ehe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return cP(md.Prod,s,n,i,o,a)}const the={kernelName:Lw,backendName:"webgl",kernelFunc:ehe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return cP(md.Sum,s,n,i,o,a)}const rhe={kernelName:E0,backendName:"webgl",kernelFunc:nhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function she(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r;if(s.shape.length===1){const l=n.readSync(s.dataId),u=n.readSync(i.dataId),c=GL(l,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}else if(s.shape.length===2){const l=n.bufferSync(s),u=n.bufferSync(i),c=lae(l,u,o,a);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const ihe={kernelName:Mw,backendName:"webgl",kernelFunc:she};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ohe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ahe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:i,dataFormat:o}=r,a=s.shape[0],l=o==="NHWC"?s.shape[1]:s.shape[2],u=o==="NHWC"?s.shape[2]:s.shape[3],c=o==="NHWC"?s.shape[3]:s.shape[1],h=l*i,d=u*i,f=c/(i*i),m=o==="NHWC"?[a,h,d,f]:[a,f,h,d],v=new ohe(m,i,o);return n.runWebGLProgram(v,[s],s.dtype)}const lhe={kernelName:Bw,backendName:"webgl",kernelFunc:ahe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hP{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=xr(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";r&&(s?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const h=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${h}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dP{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=xr(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,h=e.filterWidth,d=h;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<h;g++)f+=`
          vec4 xTexelC${g*2};
          int xTexelC${g*2}Ready;
          vec4 xTexelC${g*2+1};
          int xTexelC${g*2+1}Ready;
          vec4 xC${g};`;f+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let g=0;g<h;g++)f+=`
          xTexelC${g*2} = vec4(0.0);
          xTexelC${g*2}Ready = 0;
          xTexelC${g*2+1} = vec4(0.0);
          xTexelC${g*2+1}Ready = 0;
          xC${g} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let g=0;g<(d+1)/2;g++){const y=g*2;if(f+=`
          xC = xCCorner + ${y*u};
          `,l===1){if(y<h&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }
              `,u===1&&y>0?f+=`
                xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                  } else {
                    xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xC${y} = xTexelC${y};
                `,y+1<h)){const b=a%2===0?bw(u):u;u%2===0&&a%2===1||u%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                    xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${y+1}.zw = vec2(0.0);
                    }
                    xTexelC${y+1}Ready = 1;
                  }
                  `,u>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                    } else {
                     xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                    }
                    `:f+=`
                    xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                    `):b===1?f+=`
                    xC${y+1} = xTexelC${y};
                    `:f+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                      xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${y+1}.zw = vec2(0.0);
                      }
                      xTexelC${y+1}Ready = 1;
                    }

                    xC${y+1} = xTexelC${y+1};
                    `}}else y<h&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.0);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
              `,y+1<h&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(
                  xTexelC${y}.xy, xTexelC${y+1}.xy);
              `,y+1<h&&(f+=`
                  xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                `)));y<h&&(f+=`
            wTexel = getW(r, ${y}, d1, q);
            dotProd += xC${y} * vec4(wTexel.xz, wTexel.xz);
          `,y+1<h&&(f+=`
              wTexel = getW(r, ${y+1}, d1, q);
              dotProd += xC${y+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let m="",v="";r&&(s?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:m=`vec4 activation(vec4 x) {
          ${r}
        }`,v="result = activation(result);");const p=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${m}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${p}
        ${v}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),F(yr(o,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const h=ur(s.shape,i.shape,o,c,a,u,!0);let d;me().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?d=new dP(h):d=new hP(h);const f=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(d,[s,i],"float32",f)}const che={kernelName:I0,backendName:"webgl",kernelFunc:uhe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hhe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class dhe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,a=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r,h=ur(s.shape,c,o,a,l,u,!0),d=new hhe(h);return n.runWebGLProgram(d,[s,i],"float32")}const phe={kernelName:zw,backendName:"webgl",kernelFunc:fhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mhe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r,h=ur(c,i.shape,o,a,l,u,!0),d=new dhe(h);return n.runWebGLProgram(d,[s,i],"float32")}const ghe={kernelName:Uw,backendName:"webgl",kernelFunc:mhe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vhe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yhe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],i=be(r.shape),o=Be({inputs:{x:r},backend:n,attrs:{shape:[i]}}),a=new vhe(i),l=n.runWebGLProgram(a,[o],o.dtype),u=Be({inputs:{x:l},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}const xhe={kernelName:YD,backendName:"webgl",kernelFunc:yhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bhe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:s,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:h,left:d}=s;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${h}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function whe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r,u=Ff(s.shape,i.shape,o,a,"NHWC",l);let c;const h=new bhe(u);c=n.runWebGLProgram(h,[s,i],"float32");const d=Be({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),d}const Che={kernelName:T0,backendName:"webgl",kernelFunc:whe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function She(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:l}=yC(s,i.length);bC(o.length,l,i);const{path:u,steps:c}=wC(a,l),h=c.length;let d=null,f=o.length;const m=[];for(let v=0;v<h;++v){for(const p of c[v]){const{permutationIndices:g,expandDims:y}=xC(f,l[p]);let b;CC(g)?b=i[p]:(b=$r({inputs:{x:i[p]},backend:n,attrs:{perm:g}}),m.push(b));const x=b.shape.slice();for(let w=0;w<y.length;++w)x.splice(y[w],0,1);Nt(b.shape,x)||(b=Be({inputs:{x:b},backend:n,attrs:{shape:x}}),m.push(b)),d===null?d=b:(d=lS({inputs:{a:b,b:d},backend:n}),m.push(d))}v<h-1&&(u[v]>=0&&(d=zv({inputs:{x:d},backend:n,attrs:{axis:u[v]-(o.length-f),keepDims:!1}}),m.push(d)),f--)}for(const v of m)v!==d&&n.disposeIntermediateTensorInfo(v);return d}const khe={kernelName:Vw,backendName:"webgl",kernelFunc:She};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ehe="return (x >= 0.0) ? x : (exp(x) - 1.0);",Ihe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,The=St({opSnippet:Ehe,packedOpSnippet:Ihe}),_he={kernelName:Qd,backendName:"webgl",kernelFunc:The};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nhe="return (b >= 0.0) ? a : a * (b + 1.0);",$he=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,Dhe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,i=me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ac($he,r.shape,s.shape):new Nl(Nhe,r.shape,s.shape);return n.runWebGLProgram(i,[r,s],r.dtype)},Ahe={kernelName:Ww,backendName:"webgl",kernelFunc:Dhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rhe=`
  return vec4(equal(a, b));
`,Ohe="return float(a == b);",Fhe=hr({opSnippet:Ohe,packedOpSnippet:Rhe,dtype:"bool",cpuKernelImpl:fae}),Lhe={kernelName:_0,backendName:"webgl",kernelFunc:Fhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Phe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${hC};
  float a1 = ${dC};
  float a2 = ${fC};
  float a3 = ${pC};
  float a4 = ${mC};
  float a5 = ${gC};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Mhe=St({opSnippet:Phe}),Bhe={kernelName:Jd,backendName:"webgl",kernelFunc:Mhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zhe=Rc+`
  return exp(x);
`,Uhe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,fP=St({opSnippet:zhe,packedOpSnippet:Uhe,cpuKernelImpl:pae,dtype:"float32"}),Vhe={kernelName:ef,backendName:"webgl",kernelFunc:fP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yx(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:i}=e,o=i.shape.length,a=i.shape.slice();let l=s;return s<0&&(F(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+s+1),a.splice(l,0,1),Be({inputs:{x:i},backend:r,attrs:{shape:a}})}const Whe={kernelName:N0,backendName:"webgl",kernelFunc:Yx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ST="return exp(x) - 1.0;",Ghe=St({opSnippet:ST,packedOpSnippet:ST,cpuKernelImpl:mae}),jhe={kernelName:tf,backendName:"webgl",kernelFunc:Ghe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kT{constructor(e,n,r){this.variableNames=["real","imag"];const s=n[1];this.outputShape=n;const i=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${s}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pP(t,e,n){const r=n.texData.get(t.dataId),s=be(t.shape),i=t.shape[t.shape.length-1],o=s/i,a=Be({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),l=a.shape,u=new kT("real",l,e),c=new kT("imag",l,e),h=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],d=n.runWebGLProgram(u,h,"float32"),f=n.runWebGLProgram(c,h,"float32"),m=Fa({inputs:{real:d,imag:f},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f);const v=Be({inputs:{x:m},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(m),v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hhe(t){const{inputs:e,backend:n}=t,{input:r}=e;return pP(r,!1,n)}const qhe={kernelName:Gw,backendName:"webgl",kernelFunc:Hhe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Khe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function np(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:i}=n;if(i=i||xc(s),i==="string"){const o=xn(i,be(r));return o.fill(s),e.makeTensorInfo(r,i,o)}else{const o=new Khe(r,s),a=[[s]];return e.runWebGLProgram(o,[],i,a)}}const Xhe={kernelName:jw,backendName:"webgl",kernelFunc:np};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yhe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zhe={kernelName:Hw,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new Yhe(n.shape);return r.runWebGLProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ET="return floor(x);",Qhe=St({opSnippet:ET,packedOpSnippet:ET,cpuKernelImpl:gae}),Jhe={kernelName:nf,backendName:"webgl",kernelFunc:Qhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ede=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,tde=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,nde=hr({opSnippet:ede,packedOpSnippet:tde,dtype:"int32"}),rde={kernelName:rf,backendName:"webgl",kernelFunc:nde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sde{constructor(e){this.variableNames=["A"];const n=Rr(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ide{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Rr(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ode={kernelName:aG,backendName:"webgl",kernelFunc:ade};let cu,n1=me().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function ade(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:i}=r,o=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[l,u]=o?[s.videoWidth,s.videoHeight]:[s.width,s.height],c=[u,l],h=[u,l,i];if(a||o){const v=me().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(cu==null||v!==n1)&&(n1=v,cu=document.createElement("canvas").getContext("2d",{willReadFrequently:n1})),cu.canvas.width=l,cu.canvas.height=u,cu.drawImage(s,0,0,l,u),s=cu.canvas}const d=n.makeTensorInfo(c,"int32");n.texData.get(d.dataId).usage=ys.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),s);const f=me().getBool("WEBGL_PACK")?new ide(h):new sde(h),m=n.runWebGLProgram(f,[d],"int32");return n.disposeData(d.dataId),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lde(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:m}=r,v=Ao(c),p=ur(s.shape,i.shape,l,h,u,d,!1,v);let g;const y=[],b=o!=null,x=a!=null,w=f==="leakyrelu",C=()=>{const E=[s,i],T=(_,A)=>{if(A==="NCHW"&&_.shape.length===1&&_.shape[0]!==1){const L=Be({inputs:{x:_},backend:n,attrs:{shape:[_.shape[0],1,1]}});return y.push(L),L}return _};if(b&&E.push(T(o,c)),x&&E.push(T(a,c)),w){const _=n.makeTensorInfo([],"float32",Ta(m,"float32"));E.push(_),y.push(_)}return E};if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))g=lP({x:s,filter:i,convInfo:p,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:m});else if(p.strideWidth<=2&&v==="channelsLast"&&me().getBool("WEBGL_EXP_CONV")){const E=f?fd(f,!0):null,T=new aP(p,b,E,x,w),_=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]],A=C();g=n.runWebGLProgram(T,A,"float32",_)}else if(me().getBool("WEBGL_CONV_IM2COL"))g=uP({x:s,filter:i,convInfo:p,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:m});else{const E=f?fd(f,!1):null,T=new oP(p,b,E,x,w),_=C();g=n.runWebGLProgram(T,_,"float32")}const S=Be({inputs:{x:g},backend:n,attrs:{shape:p.outShape}});return y.push(g),y.forEach(E=>n.disposeIntermediateTensorInfo(E)),S}const ude={kernelName:Gm,backendName:"webgl",kernelFunc:lde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cde(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:h,activation:d,leakyreluAlpha:f}=r,m=[];let v=c;v==null&&(v=[1,1]),F(yr(l,v),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${v}'`);const p=ur(s.shape,i.shape,l,v,u,h,!0),g=me().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels===1,y=d?fd(d,g):null,b=[s,i],x=o!=null,w=a!=null,C=d==="leakyrelu";if(x&&b.push(o),w&&b.push(a),C){const _=n.makeTensorInfo([],"float32",Ta(f,"float32"));b.push(_),m.push(_)}let S;g?S=new dP(p,x,y,w,C):S=new hP(p,x,y,w,C);const E=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]],T=n.runWebGLProgram(S,b,"float32",E);return m.forEach(_=>n.disposeIntermediateTensorInfo(_)),T}const hde={kernelName:mA,backendName:"webgl",kernelFunc:cde};class dde{constructor(e,n,r,s){this.sliceDim=e,this.strides=n,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const i=Ut(r.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fde(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,i=s.shape,o=i[i.length-1],a=be(r.shape),[l,u,c,h]=eC(r,s),d=Be({inputs:{x:s},backend:n,attrs:{shape:[u,o]}}),f=Be({inputs:{x:r},backend:n,attrs:{shape:[be(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const g=n.readSync(s.dataId),y=n.bufferSync(r),b=vae(g,y,r.dtype,u,o,c,h,r.shape,a);return n.makeTensorInfo(l,r.dtype,b.values)}const m=new dde(o,h,[u,c],r.shape),v=n.runWebGLProgram(m,[f,d],f.dtype),p=Be({inputs:{x:v},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(v),p}const pde={kernelName:ZD,backendName:"webgl",kernelFunc:fde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mde{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=Ut(this.rank),s=gde(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function gde(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)s===2?r.push("index"):r.push(`${n[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mP(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:i}=e,{axis:o,batchDims:a}=r,l=mt(o,s.shape)[0];if(me().get("DEBUG")){const y=n.readSync(i.dataId),b=s.shape[l];for(let x=0;x<y.length;++x){const w=y[x];F(w<=b-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${b-1}]`)}}const u=kC(s,i,l,a),c=be(i.shape),h=[],d=Be({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),f=Be({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});h.push(d),h.push(f);const m=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([s,i])||s.dtype==="string"){const y=n.bufferSync(f),b=n.bufferSync(d),x=yae(b,y,m);return h.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.makeTensorInfo(u.outputShape,x.dtype,x.values)}const v=new mde(d.shape,m),p=n.runWebGLProgram(v,[d,f],d.dtype);h.push(p);const g=Be({inputs:{x:p},backend:n,attrs:{shape:u.outputShape}});return h.forEach(y=>n.disposeIntermediateTensorInfo(y)),g}const vde={kernelName:D0,backendName:"webgl",kernelFunc:mP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yde="return float(a > b);",xde=`
  return vec4(greaterThan(a, b));
`,bde=hr({opSnippet:yde,packedOpSnippet:xde,cpuKernelImpl:xae,dtype:"bool"}),wde={kernelName:A0,backendName:"webgl",kernelFunc:bde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cde="return float(a >= b);",Sde=`
  return vec4(greaterThanEqual(a, b));
`,kde=hr({opSnippet:Cde,packedOpSnippet:Sde,dtype:"bool",cpuKernelImpl:bae}),Ede={kernelName:sf,backendName:"webgl",kernelFunc:kde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ide(t){const{inputs:e,backend:n}=t,{input:r}=e;return pP(r,!0,n)}const Tde={kernelName:qw,backendName:"webgl",kernelFunc:Ide};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _de="return float(!isnan(x) && !isinf(x));",Nde=St({opSnippet:_de,dtype:"bool"}),$de={kernelName:af,backendName:"webgl",kernelFunc:Nde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dde="return float(isinf(x));",Ade=St({opSnippet:Dde,dtype:"bool"}),Rde={kernelName:lf,backendName:"webgl",kernelFunc:Ade};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ode="return float(isnan(x));",Fde=St({opSnippet:Ode,dtype:"bool"}),Lde={kernelName:uf,backendName:"webgl",kernelFunc:Fde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pde="return float(a < b);",Mde=`
  return vec4(lessThan(a, b));
`,Bde=hr({opSnippet:Pde,packedOpSnippet:Mde,cpuKernelImpl:wae,dtype:"bool"}),zde={kernelName:O0,backendName:"webgl",kernelFunc:Bde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ude="return float(a <= b);",Vde=`
  return vec4(lessThanEqual(a, b));
`,Wde=hr({opSnippet:Ude,packedOpSnippet:Vde,cpuKernelImpl:Cae,dtype:"bool"}),Gde={kernelName:F0,backendName:"webgl",kernelFunc:Wde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jde(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:i}=n,o=Sae(r,s,i);return e.makeTensorInfo([o.length],"float32",o)}const Hde={kernelName:QD,backendName:"webgl",kernelFunc:jde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qde=Rc+`
  return x < 0.0 ? 0./0. : log(x);
`,Kde=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Xde=St({opSnippet:qde,packedOpSnippet:Kde,cpuKernelImpl:kae}),Yde={kernelName:cf,backendName:"webgl",kernelFunc:Xde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zde=Rc+`
  return log(1.0 + x);
`,Qde=St({opSnippet:Zde}),Jde={kernelName:hf,backendName:"webgl",kernelFunc:Qde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const efe="return float(a >= 1.0 && b >= 1.0);",tfe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,nfe=hr({opSnippet:efe,packedOpSnippet:tfe,dtype:"bool"}),rfe={kernelName:L0,backendName:"webgl",kernelFunc:nfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sfe="return float(!(x >= 1.0));",ife=St({opSnippet:sfe}),ofe={kernelName:P0,backendName:"webgl",kernelFunc:ife};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const afe="return float(a >= 1.0 || b >= 1.0);",lfe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,ufe=hr({opSnippet:afe,packedOpSnippet:lfe,dtype:"bool"}),cfe={kernelName:M0,backendName:"webgl",kernelFunc:ufe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hfe{constructor(e,n,r,s,i){this.variableNames=["x"],this.outputShape=[];const o=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dfe{constructor(e,n,r,s,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ffe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=r,u=me().getBool("WEBGL_PACK_NORMALIZATION")?new dfe(s.shape,i,o,a,l):new hfe(s.shape,i,o,a,l);return n.runWebGLProgram(u,[s],s.dtype)},pfe={kernelName:B0,backendName:"webgl",kernelFunc:ffe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mfe{constructor(e,n,r,s,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=s,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gfe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r,h=new mfe(s.shape,a,l,u,c);return n.runWebGLProgram(h,[s,i,o],s.dtype)},vfe={kernelName:Xw,backendName:"webgl",kernelFunc:gfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yfe(t,e,n,r){const s=be(e),o=be(t.shape)/s,a=Be({inputs:{x:t},attrs:{shape:[o,s]},backend:r}),l=Yl(a,t.dtype,"max",r),u=Be({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gP(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:i,keepDims:o}=r,a=s.shape.length,l=mt(i,s.shape);let u=l;const c=hn(u,a),h=c!=null,d=n.shouldExecuteOnCPU([s]);let f=s;if(h){if(d){const b=n.texData.get(f.dataId).values,x=new Array(a);for(let S=0;S<x.length;S++)x[S]=s.shape[c[S]];const w=oS(b,s.shape,s.dtype,c,x);f=n.makeTensorInfo(x,s.dtype);const C=n.texData.get(f.dataId);C.values=w}else f=Bv(s,c,n);u=Cn(u.length,a)}cr("max",u,a);const[m,v]=tr(f.shape,u);let p=m;o&&(p=Fn(m,l));let g;if(d){const b=n.texData.get(f.dataId).values,x=Eae(b,be(v),p,s.dtype);g=n.makeTensorInfo(p,s.dtype);const w=n.texData.get(g.dataId);w.values=x}else g=yfe(f,v,p,n);return h&&n.disposeIntermediateTensorInfo(f),g}const xfe={kernelName:z0,backendName:"webgl",kernelFunc:gP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bfe=aS+`
  return max(a, b);
`,wfe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Xl+`
  return result;
`,Cfe=hr({opSnippet:bfe,packedOpSnippet:wfe,cpuKernelImpl:Iae}),Sfe={kernelName:df,backendName:"webgl",kernelFunc:Cfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Jf(s,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;F(yr(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Qs(s.shape,i,o,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&Nt(c.inShape,c.outShape))return as({inputs:{x:s},backend:n});const h=new pd(c,"max",!1);return n.runWebGLProgram(h,[s],s.dtype)}const Efe={kernelName:U0,backendName:"webgl",kernelFunc:kfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ife(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],h=Do(s.shape,i,o,c,a,u,l),d=new uS(h,"max",!1);return n.runWebGLProgram(d,[s],s.dtype)}const Tfe={kernelName:V0,backendName:"webgl",kernelFunc:Ife};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _fe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,l=o-1-e.padInfo.left,u=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class Nfe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,h=l-1-e.padInfo.front,d=u-1-e.padInfo.top,f=c-1-e.padInfo.left,m=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${h}, ${d}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${m} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $fe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,h=[1,1,1],d=Do(o.shape,a,l,h,u,c),f=new uS(d,"max",!0),m=n.runWebGLProgram(f,[o],o.dtype),v=new Nfe(d),p=n.runWebGLProgram(v,[s,m],o.dtype);return n.disposeIntermediateTensorInfo(m),p}const Dfe={kernelName:Zw,backendName:"webgl",kernelFunc:$fe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Afe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i,output:o}=e,a=i;Jf([i,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:h}=r,d=Qs(a.shape,l,u,1,c,h),f=!0,m=new pd(d,"max",f),v=n.runWebGLProgram(m,[a],a.dtype),p=new _fe(d),g=n.runWebGLProgram(p,[s,v],a.dtype);return n.disposeIntermediateTensorInfo(v),g}const Rfe={kernelName:Yw,backendName:"webgl",kernelFunc:Afe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ofe(t,e,n,r){let s=new pd(n,"max",!1);const i=r.runWebGLProgram(s,[t],"float32");s=new pd(n,"max",!0,!0,e);const o=r.runWebGLProgram(s,[t],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ffe={kernelName:JD,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;F(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];F(yr(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Qs(r.shape,s,i,u,o),[h,d]=Ofe(r,a,c,l);return[h,d]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lfe(t,e,n,r){const s=be(e),o=be(t.shape)/s,a=Be({inputs:{x:t},attrs:{shape:[o,s]},backend:r}),l=Yl(a,"float32","mean",r),u=Be({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pfe={kernelName:W0,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:s,axis:i}=e,o=n,a=r.shape.length,l=mt(i,r.shape);let u=l;const c=hn(u,a),h=c!=null,d=o.shouldExecuteOnCPU([r]),f=[];let m=r;if(h){if(d){const x=o.texData.get(m.dataId).values,w=new Array(a);for(let E=0;E<w.length;E++)w[E]=r.shape[c[E]];const C=oS(x,r.shape,r.dtype,c,w);m=o.makeTensorInfo(w,r.dtype);const S=o.texData.get(m.dataId);S.values=C}else m=Bv(r,c,o);f.push(m),u=Cn(u.length,a)}cr("sum",u,a);const[v,p]=tr(m.shape,u);let g=v;s&&(g=Fn(v,l));const y=Lfe(m,p,g,o);for(const b of f)o.disposeIntermediateTensorInfo(b);return y}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=mt(i,s.shape);let u=l;const c=hn(u,a);let h=s;c!=null&&(h=$r({inputs:{x:s},backend:n,attrs:{perm:c}}),u=Cn(u.length,s.shape.length)),cr("min",u,a);const[d,f]=tr(h.shape,u),m=be(f),v=Be({inputs:{x:h},backend:n,attrs:{shape:[-1,m]}}),p=Yl(v,v.dtype,"min",n);let g;if(o){const y=Fn(d,l);g=Be({inputs:{x:p},backend:n,attrs:{shape:y}})}else g=Be({inputs:{x:p},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(p),c!=null&&n.disposeIntermediateTensorInfo(h),g}const Bfe={kernelName:G0,backendName:"webgl",kernelFunc:Mfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zfe=aS+`
  return min(a, b);
`,Ufe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Xl+`
  return result;
`,Vfe=hr({opSnippet:zfe,packedOpSnippet:Ufe,cpuKernelImpl:Tae}),Wfe={kernelName:ff,backendName:"webgl",kernelFunc:Vfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gfe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((c,h)=>c[0]+e[h]+c[1]);const s=e.length,i=Ut(s),o=n.map(c=>c[0]).join(","),a=n.map((c,h)=>c[0]+e[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),u=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jfe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((m,v)=>m[0]+e[v]+m[1]);const s=e.length,i=Ut(s),o=n.map(m=>m[0]).join(","),a=n.map((m,v)=>m[0]+e[v]).join(","),l=Ir("rc",s),u=Ir("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,h=s===1?"source":`vec2(${u.slice(-2).join()})`,d=r==="reflect"?0:1;let f="";if(s===1){const m=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${u.join()}), ${h});
        ${l[s-1]} += 1;
        if(${c}) {
          ${m}
          result[1] = getChannel(getX(${u.join()}), ${h});
        }
      `}else{const m=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${u.join()}), ${h});
        ${l[s-1]} += 1;
        if(${c}) {
          ${m}
          result[1] = getChannel(getX(${u.join()}), ${h});
        }
        rc = outputLoc;
        ${l[s-2]} += 1;
        if(${l[s-2]} < ${this.outputShape[s-2]}) {
          ${m}
          result[2] = getChannel(getX(${u.join()}), ${h});
          ${l[s-1]} += 1;
          if(${c}) {
            ${m}
            result[3] = getChannel(getX(${u.join()}), ${h});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hfe=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:s,mode:i}=n,o=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new jfe(r.shape,s,i):new Gfe(r.shape,s,i);return e.runWebGLProgram(o,[r],r.dtype)},qfe={kernelName:j0,backendName:"webgl",kernelFunc:Hfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kfe=`if (b == 0.0) return NAN;
  return mod(a, b);`,Xfe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Xl+`
  return result;
`,Yfe=hr({opSnippet:Kfe,packedOpSnippet:Xfe}),Zfe={kernelName:pf,backendName:"webgl",kernelFunc:Yfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qfe{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jfe=`
if (a == b) {
  return 1.0;
};
return a / b;`,epe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,vP=hr({opSnippet:Jfe,packedOpSnippet:epe,checkOutOfBounds:!0}),tpe={kernelName:Zd,backendName:"webgl",kernelFunc:vP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IT="return a - b;",yP=hr({opSnippet:IT,packedOpSnippet:IT,supportsComplex:!0,cpuKernelImpl:Kae}),npe={kernelName:$f,backendName:"webgl",kernelFunc:yP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xP(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:i}=r,o=mt([i],s.shape),a=gP({inputs:{x:s},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=Fn(a.shape,o),u=Be({inputs:{x:a},backend:n,attrs:{shape:l}}),c=yP({inputs:{a:s,b:u},backend:n}),h=fP({inputs:{x:c},backend:n}),d=zv({inputs:{x:h},backend:n,attrs:{axis:o,keepDims:!1}}),f=Be({inputs:{x:d},backend:n,attrs:{shape:l}}),m=vP({inputs:{a:h,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),m}const rpe={kernelName:uv,backendName:"webgl",kernelFunc:xP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function spe(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r,l=a?s:xP({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),u=l.shape[0],c=l.shape[1],h=new Qfe(u,c,i),d=[[o]],f=n.runWebGLProgram(h,[l],"int32",d);return a||n.disposeIntermediateTensorInfo(l),f}const ipe={kernelName:eA,backendName:"webgl",kernelFunc:spe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ope=ei+`
  return -x;
`,ape=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function lpe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId),[o,a]=Nae(i.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,o)}let s;return me().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Zo(r.shape,ape):s=new Ui(r.shape,ope),n.runWebGLProgram(s,[r],r.dtype)}const upe={kernelName:H0,backendName:"webgl",kernelFunc:lpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cpe=K2;function hpe(t){gs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r,u=n.readSync(s.dataId),c=n.readSync(i.dataId),{selectedIndices:h}=cpe(u,c,o,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const dpe={kernelName:Qw,backendName:"webgl",kernelFunc:hpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fpe=X2;function ppe(t){gs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(s.dataId),h=n.readSync(i.dataId),{selectedIndices:d,validOutputs:f}=fpe(c,h,o,a,l,u);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const mpe={kernelName:Jw,backendName:"webgl",kernelFunc:ppe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gpe=Y2;function vpe(t){gs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(s.dataId),h=n.readSync(i.dataId),d=o,f=a,m=l,v=u,{selectedIndices:p,selectedScores:g}=gpe(c,h,d,f,m,v);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const ype={kernelName:e2,backendName:"webgl",kernelFunc:vpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xpe{constructor(e,n,r,s){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bpe=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:l}=r,u=be(s.shape),c=new xpe(u,o,a,l),h=Be({inputs:{x:s},backend:n,attrs:{shape:[u]}}),d=n.runWebGLProgram(c,[h],i);n.disposeIntermediateTensorInfo(h);const f=[...s.shape,o],m=Be({inputs:{x:d},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(d),m},wpe={kernelName:X0,backendName:"webgl",kernelFunc:bpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yg(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=tp({inputs:{input:r},backend:n}),i=yg({inputs:{x:s},backend:n}),o=Uv({inputs:{input:r},backend:n}),a=yg({inputs:{x:o},backend:n}),l=Fa({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return np({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const Cpe={kernelName:dv,backendName:"webgl",kernelFunc:yg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bP(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=tp({inputs:{input:r},backend:n}),i=bP({inputs:{x:s},backend:n}),o=Uv({inputs:{input:r},backend:n}),a=yg({inputs:{x:o},backend:n}),l=Fa({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return np({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const Spe={kernelName:K0,backendName:"webgl",kernelFunc:bP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kpe(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return Yx({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(c=>{ww(i,c.shape,"All tensors passed to stack must have matching shapes"),F(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const h=Yx({inputs:{input:c},backend:n,attrs:{dim:s}});return a.push(h),h}),u=iP({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const Epe={kernelName:Y0,backendName:"webgl",kernelFunc:kpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ipe{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const s=e.length,i=Ut(s),o=n.map(u=>u[0]).join(","),a=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tpe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((v,p)=>v[0]+e[p]+v[1]);const s=e.length,i=Ut(s),o=n.map(v=>v[0]).join(","),a=n.map((v,p)=>v[0]+e[p]).join(","),l=Ir("rc",s),u=Ir("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,h=s===1?"source":`vec2(${u.slice(-2).join()})`,d=[`${i} rc = outputLoc;`,`${l[s-1]} += 1;
       if(${c}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${l[s-2]} += 1;
       if(${l[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${l[s-1]} += 1;
         if(${c}) {`],f=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let m="";for(let v=0,p=s===1?2:4;v<p;v++)m+=`
        ${d[v]}
        if (${f}) {
          result[${v}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${v}] = getChannel(getX(${u.join()}), ${h});
        }
      `;m+=s===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wP=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,constantValue:o}=r;if(be(s.shape)===0){const u=i.map((c,h)=>c[0]+s.shape[h]+c[1]);return np({backend:n,attrs:{shape:u,value:o,dtype:s.dtype}})}const a=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Tpe(s.shape,i,o):new Ipe(s.shape,i,o),l=[[o]];return n.runWebGLProgram(a,[s],s.dtype,l)},_pe={kernelName:Z0,backendName:"webgl",kernelFunc:wP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Npe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,$pe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Xl+`
  return result;
`,Dpe=hr({opSnippet:Npe,packedOpSnippet:$pe}),Ape={kernelName:gf,backendName:"webgl",kernelFunc:Dpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=[],u=mt(i,s.shape);let c=u;const h=hn(c,a);let d=s;h!=null&&(d=$r({inputs:{x:s},backend:n,attrs:{perm:h}}),c=Cn(c.length,a),l.push(d)),cr("prod",c,a);let f;if(n.shouldExecuteOnCPU([d])){const m=n.texData.get(d.dataId).values,{outVals:v,outShape:p,outDtype:g}=Dae(d.shape,d.dtype,m,c);f=n.makeTensorInfo(p,g,v)}else{const[m,v]=tr(d.shape,c),p=be(v),g=Be({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),y=f2(s.dtype),b=Yl(g,y,"prod",n);f=Be({inputs:{x:b},backend:n,attrs:{shape:m}}),l.push(g),l.push(b)}if(o){l.push(f);const m=Fn(f.shape,u);f=Be({inputs:{x:f},backend:n,attrs:{shape:m}})}return l.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}const Ope={kernelName:J0,backendName:"webgl",kernelFunc:Rpe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fpe(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=r,l=s.map(g=>n.readSync(g.dataId)),u=s.map(g=>g.shape),c=n.readSync(i.dataId),h=n.readSync(o.dataId),[d,f,m]=Aae(l,u,c,i.shape,i.dtype,h,o.shape,a),v=d.map(g=>n.makeTensorInfo([g.length],"int32",g)),p=n.makeTensorInfo(m,i.dtype,f);return v.concat([p])}const Lpe={kernelName:tA,backendName:"webgl",kernelFunc:Fpe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ppe(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:i}=e,o=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(i.dataId),[u,c]=Rae(o,r.shape,r.dtype,a,s.shape,l,i.shape),h=n.makeTensorInfo([u.length],"int32",u),d=n.makeTensorInfo([c.length],r.dtype,c);return[h,d]}const Mpe={kernelName:nA,backendName:"webgl",kernelFunc:Ppe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bpe(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=n.readSync(s.dataId),c=n.readSync(i.dataId),h=n.readSync(o.dataId),d=a.map(p=>n.readSync(p.dataId)),f=a.map(p=>p.shape),[m,v]=Oae(u,s.shape,c,i.shape,i.dtype,h,o.shape,d,f,l);return n.makeTensorInfo(m,i.dtype,v)}const zpe={kernelName:rA,backendName:"webgl",kernelFunc:Bpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CP=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:i,dtype:o}=n,a=Fae(r,s,i,o);return e.makeTensorInfo([a.length],o,a)},Upe={kernelName:t2,backendName:"webgl",kernelFunc:CP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vpe="return 1.0 / x;",Wpe=St({opSnippet:Vpe}),Gpe={kernelName:vf,backendName:"webgl",kernelFunc:Wpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jpe=ei+`
  return (x < 0.0) ? 0.0 : x;
`,Hpe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,qpe=St({opSnippet:jpe,packedOpSnippet:Hpe}),Kpe={kernelName:yf,backendName:"webgl",kernelFunc:qpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xpe=ei+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Ype=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Zpe=St({opSnippet:Xpe,packedOpSnippet:Ype}),Qpe={kernelName:xf,backendName:"webgl",kernelFunc:Zpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jpe{constructor(e,n,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],h=[s&&n>1?n-1:n,s&&r>1?r-1:r];let d;i?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/h[0]},
          ${c[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eme{constructor(e,n,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],h=[s&&n>1?n-1:n,s&&r>1?r-1:r];let d;i?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/h[0]},
          ${c[1]/h[1]},
          ${c[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tme(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[l,u]=a,c=me().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new eme(s.shape,l,u,i,o):new Jpe(s.shape,l,u,i,o);return n.runWebGLProgram(c,[s],"float32")}const nme={kernelName:nv,backendName:"webgl",kernelFunc:tme};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rme{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,i]=n,[,o,a]=e,l=[r&&o>1?s-1:s,r&&a>1?i-1:i],u=[r&&o>1?o-1:o,r&&a>1?a-1:a],c=l[0]/u[0],h=l[1]/u[1],d=1/c,f=1/h,m=Math.ceil(d)*2+2,v=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${m});
        const int winWidth = int(${v});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sme(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r,a=new rme(i.shape,s.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const ime={kernelName:s2,backendName:"webgl",kernelFunc:sme};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ome{constructor(e,n,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],h=[s&&n>1?n-1:n,s&&r>1?r-1:r],d=s?"0.5":"0.0";let f;i?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/h[0]},
          ${c[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ame{constructor(e,n,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],h=[s&&n>1?n-1:n,s&&r>1?r-1:r],d=s?"0.5":"0.0";let f;i?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/h[0]},
          ${c[1]/h[1]},
          ${c[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lme(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[l,u]=a,c=me().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new ame(s.shape,l,u,i,o):new ome(s.shape,l,u,i,o);return n.runWebGLProgram(c,[s],s.dtype)}const ume={kernelName:tv,backendName:"webgl",kernelFunc:lme};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cme{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,i]=n,[,o,a]=e,l=[r&&o>1?s-1:s,r&&a>1?i-1:i],u=[r&&o>1?o-1:o,r&&a>1?a-1:a],c=l[0]/u[0],h=l[1]/u[1],d=1/c,f=1/h,m=Math.ceil(d)*2+2,v=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${m});
        const int winWidth = int(${v});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hme(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r,a=new cme(i.shape,s.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const dme={kernelName:r2,backendName:"webgl",kernelFunc:hme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fme{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,l)=>s(l)).join(","),o=Ut(r);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pme{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=Ir("rc",r),i=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,a=Ut(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(s.slice())};
          if(${i}){
            result.g = ${u(s.slice())};
          }
          if(${o}) {
            result.b = ${c(s.slice())};
            if(${i}) {
              result.a = ${h(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(m){return d(m)}function u(m){return m[r-1]="("+m[r-1]+" + 1)",d(m)}function c(m){return m[r-2]="("+m[r-2]+" + 1)",d(m)}function h(m){return m[r-1]="("+m[r-1]+" + 1)",m[r-2]="("+m[r-2]+" + 1)",d(m)}function d(m){const v=e.map((y,b)=>f(b,m)),p=v.join(","),g=v.slice(-2).join(",");return`getChannel(getX(${p}), vec2(${g}))`}function f(m,v){return n.indexOf(m)!==-1&&e[m]!==1?`${e[m]} - ${v[m]} - 1`:`${v[m]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mme(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:i}=r,o=s.shape.length,a=mt(i,s.shape);if(o===0)return as({inputs:{x:s},backend:n});const l=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new pme(s.shape,a):new fme(s.shape,a);return n.runWebGLProgram(l,[s],s.dtype)}const gme={kernelName:rv,backendName:"webgl",kernelFunc:mme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vme{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yme={kernelName:h2,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:i,center:o}=e,a=n,l=new vme(r.shape,i),[u,c]=lC(o,r.shape[1],r.shape[2]),h=[[u,c,Math.sin(s),Math.cos(s)]];return a.runWebGLProgram(l,[r],r.dtype,h)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xme=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,bme=St({opSnippet:xme}),wme={kernelName:bf,backendName:"webgl",kernelFunc:bme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cme="return inversesqrt(x);",Sme=St({opSnippet:Cme,cpuKernelImpl:Lae}),kme={kernelName:wf,backendName:"webgl",kernelFunc:Sme};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cS{constructor(e,n,r,s,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const u=Ut(i.length),c=Ut(o.length);let h="";r===1?h="i":r===2&&(h="i, j");const d=`getIndices(${h})`;let f="";s===1?f="i":s===2&&(f="i, coords[1]");const m=`getUpdates(${f})`;let v="";l&&(v="coords[0], coords[1]");const p=`getDefaultValue(${v})`,g=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${g};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${m};
              found = true;
            }
          }
          setOutput(mix(${p}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eme{constructor(e,n,r,s,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const u=Ut(i.length),c=Ut(o.length);let h="";r===1?h="i":r===2&&(h="i, j");const d=`getIndices(${h})`;let f="";s===1?f="i":s===2&&(f="i, coords[1]");const m=`getUpdates(${f})`;let v="";l&&(v="coords[0], coords[1]");const p=`getDefaultValue(${v})`,g=n>1?"strides[j]":"strides",y=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${g};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${y};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${m};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${p}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ime(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:h}=Gl(i,s,o),d=[h/u,u];if(h===0)return n.makeTensorInfo(o,s.dtype);const f=Be({inputs:{x:s},backend:n,attrs:{shape:[l,a]}}),m=Be({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),v=n.makeTensorInfo([],"float32",new Float32Array([0]));let p;me().getBool("WEBGL_PACK")?p=new Eme(l,a,f.shape.length,m.shape.length,c,d):p=new cS(l,a,f.shape.length,m.shape.length,c,d);const g=n.runWebGLProgram(p,[m,f,v],m.dtype),y=Be({inputs:{x:g},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),y}const Tme={kernelName:sA,backendName:"webgl",kernelFunc:Ime};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _me{constructor(e,n,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=me().getNumber("WEBGL_VERSION")===2?i:o,l=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nme(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:i}=e,{side:o}=r,a=new _me(s.shape[0],s.shape[1],i.shape[1],o),l=[[s.shape[1]]];return n.runWebGLProgram(a,[s,i],"int32",l)}const $me={kernelName:oA,backendName:"webgl",kernelFunc:Nme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dme{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let s,i;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)i="resRC",s="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${a[c]}`),c<e&&l.push(`${a[c]}`);s=l.join(),i=u.join()}const o=Ut(r);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ame(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:i}=e,o=new Dme(r.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(o,[r,s,i],is(s.dtype,i.dtype))}const Rme={kernelName:sv,backendName:"webgl",kernelFunc:Ame};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ome=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Sv};
  float scale = ${kv};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Fme=St({opSnippet:Ome}),Lme={kernelName:Cf,backendName:"webgl",kernelFunc:Fme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pme=Rc+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,Mme=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Bme=St({opSnippet:Pme,packedOpSnippet:Mme,cpuKernelImpl:Mae}),zme={kernelName:If,backendName:"webgl",kernelFunc:Bme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ume=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Vme=St({opSnippet:Ume}),Wme={kernelName:Ef,backendName:"webgl",kernelFunc:Vme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gme=Rc+`
  return sin(x);
`,jme=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Xl}
  return result;
`,Hme=St({opSnippet:Gme,packedOpSnippet:jme}),qme={kernelName:Sf,backendName:"webgl",kernelFunc:Hme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kme=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Xme=St({opSnippet:Kme}),Yme={kernelName:kf,backendName:"webgl",kernelFunc:Xme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zme=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Qme=St({opSnippet:Zme}),Jme={kernelName:Tf,backendName:"webgl",kernelFunc:Qme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ege=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,paddings:o}=r;F(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((g,y)=>g*y),l=[[0,0]];l.push(...o);for(let g=1+i.length;g<s.shape.length;++g)l.push([0,0]);const u=[],c=wP({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),h=zf(c.shape,i,a,!1),d=Uf(h.length,i.length,!1),f=Vf(c.shape,i,a,!1),m=Be({inputs:{x:c},backend:n,attrs:{shape:h}}),v=$r({inputs:{x:m},backend:n,attrs:{perm:d}}),p=Be({inputs:{x:v},backend:n,attrs:{shape:f}});return u.push(c),u.push(m),u.push(v),u.forEach(g=>n.disposeIntermediateTensorInfo(g)),p},tge={kernelName:av,backendName:"webgl",kernelFunc:ege};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nge(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(r.dataId),l=n.readSync(s.dataId),u=n.readSync(i.dataId),c=n.readSync(o.dataId)[0],[h,d,f,m,v]=zae(a,r.shape,r.dtype,l,s.dtype,u,c);return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],s.dtype,f),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(p=>Number(p)))),n.makeTensorInfo([v.length],r.dtype,new Int32Array(v))]}const rge={kernelName:aA,backendName:"webgl",kernelFunc:nge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sge(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(s.dataId)),a=n.readSync(r.dataId),l=Array.from(n.readSync(i.dataId)),[u,c,h]=Uae(a,r.shape,r.dtype,o,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}const ige={kernelName:lA,backendName:"webgl",kernelFunc:sge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oge(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(i.dataId),[u,c]=HL(o,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const age={kernelName:uA,backendName:"webgl",kernelFunc:oge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lge(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(i.dataId),[u,c]=HL(o,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}const uge={kernelName:cA,backendName:"webgl",kernelFunc:lge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cge(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:h,outputSize:d}=Gl(i,s,a),f=!1;if(i.dtype==="string"){const g=n.bufferSync(s),y=n.bufferSync(i),b=ma(n.readSync(o.dataId)[0]),x=Pae(g,y,a,d,c,u,l,h,b,f);return n.makeTensorInfo(a,x.dtype,x.values)}const m=new cS(u,l,s.shape.length,i.shape.length,h,[d,1],f),v=n.runWebGLProgram(m,[i,s,o],i.dtype),p=Be({inputs:{x:v},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(v),p}const hge={kernelName:hA,backendName:"webgl",kernelFunc:cge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dge(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=mt(o,s.shape)[0],l=SC(s,i,a),u=s.shape.length,c=new Array(u).fill(0),h=s.shape.slice();return l.map(d=>{const f=[...h];f[a]=d;const m=Oc({inputs:{x:s},backend:n,attrs:{begin:c,size:f}});return c[a]+=d,m})}const fge={kernelName:lv,backendName:"webgl",kernelFunc:dge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TT="return sqrt(x);",pge=St({opSnippet:TT,packedOpSnippet:TT,cpuKernelImpl:Vae}),mge={kernelName:_f,backendName:"webgl",kernelFunc:pge};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gge="return x * x;",vge=St({opSnippet:gge}),yge={kernelName:i2,backendName:"webgl",kernelFunc:vge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _T="return (a - b) * (a - b);",xge=hr({opSnippet:_T,packedOpSnippet:_T}),bge={kernelName:Nf,backendName:"webgl",kernelFunc:xge};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wge(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const i=n.readSync(s.dataId),o=Io(i),a=Wae(o,"string",r);return n.makeTensorInfo(s.shape,"string",a)}const Cge={kernelName:o2,backendName:"webgl",kernelFunc:wge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sge({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=ei+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new Ui(r.shape,s);return n.runWebGLProgram(i,[r],r.dtype)}const kge={kernelName:Of,backendName:"webgl",kernelFunc:Sge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ege{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,i=Ut(r.length),o=Ut(r.length);let a="";if(s===1)a="coords * strides + begin";else{let l=0;a=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ige(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:h,shrinkAxisMask:d}=r,{finalShapeSparse:f,finalShape:m,isIdentity:v,sliceDim0:p,isSimpleSlice:g,begin:y,end:b,strides:x}=iC(s.shape,i,o,a,l,u,c,h,d);let w;if(v)w=Be({inputs:{x:s},backend:n,attrs:{shape:m}});else if(p||g){F(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const S=nC(y,b,x),E=Oc({inputs:{x:s},backend:n,attrs:{begin:y,size:S}});w=Be({inputs:{x:E},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(E)}else if(n.shouldExecuteOnCPU([s])){const E=n.readSync(s.dataId),T=pt(s.shape,s.dtype,E),_=Gae(f,T,x,y);w=n.makeTensorInfo(m,s.dtype,_.values)}else{const E=new Ege(y,x,f);w=n.runWebGLProgram(E,[s],s.dtype)}const C=Be({inputs:{x:w},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(w),C}const Tge={kernelName:a2,backendName:"webgl",kernelFunc:Ige};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ge(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:h}=e,d=n.readSync(c.dataId),f=n.readSync(h.dataId),[m,v]=jae(d,f,s,i,o,a,l,u);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(h.shape,"int32",v)]}const Nge={kernelName:dA,backendName:"webgl",kernelFunc:_ge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ge(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[u,c,h]=Hae(a,l,s),d=c.length;return[n.makeTensorInfo([d,2],"int32",u),n.makeTensorInfo([d],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const Dge={kernelName:fA,backendName:"webgl",kernelFunc:$ge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Age(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),a=qae(o,s);return n.makeTensorInfo(i.shape,"int32",a)}const Rge={kernelName:pA,backendName:"webgl",kernelFunc:Age};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oge="return tan(x);",Fge=St({opSnippet:Oge}),Lge={kernelName:Df,backendName:"webgl",kernelFunc:Fge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pge=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,Mge=St({opSnippet:Pge}),Bge={kernelName:Af,backendName:"webgl",kernelFunc:Mge};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zge(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:s,indices:i,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:h}=Gl(o,i,s.shape),d=[h/u,u];if(h===0)return n.makeTensorInfo(s.shape,i.dtype);const f=Be({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),m=Be({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),v=Be({inputs:{x:s},backend:n,attrs:{shape:d}}),p=new cS(l,a,f.shape.length,m.shape.length,c,d,!1,!0),g=n.runWebGLProgram(p,[m,f,v],v.dtype),y=Be({inputs:{x:g},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),y}const Uge={kernelName:iA,backendName:"webgl",kernelFunc:zge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vge{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[o]*n[o];this.outputShape=r,this.rank=r.length;const s=Ut(this.rank),i=Wge(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function Wge(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<t.length;s++)r.push(`imod(${n[s]}, ${t[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SP(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:i}=r;if(s.dtype==="string"||s.shape.length>5){const l=n.readSync(s.dataId),u=s.dtype==="string"?l.map(d=>ma(d)):l,c=pt(s.shape,s.dtype,u),h=Xae(c,i);return n.makeTensorInfo(h.shape,h.dtype,h.values)}const o=new Vge(s.shape,i);return n.runWebGLProgram(o,[s],s.dtype)}const Gge={kernelName:Rf,backendName:"webgl",kernelFunc:SP};class jge{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Hge{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function za(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function NT(t){let e=1;for(;e<t;)e*=2;return e}function qge(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:i,sorted:o}=r,a=me().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=me().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=s.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([s])||c<a||i>l){const _=n.readSync(s.dataId),[A,L]=Yae(_,u,s.dtype,i,o);return[n.makeTensorInfo(A.shape,A.dtype,A.values),n.makeTensorInfo(L.shape,L.dtype,L.values)]}if(i===0)return u[u.length-1]=0,[n.makeTensorInfo(u,s.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[s,np({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const h=n.texData.get(s.dataId),d=h!==null&&h.isPacked,f=d?n.unpackTensor(s):s,v=be(u)/c,p=Be({inputs:{x:f},attrs:{shape:[v,c]},backend:n});d&&za(n,f);const g=NT(i),y=NT(c);let b=null;const x=()=>b===null?[p,p]:[p,b],w=(_,A,L)=>{const W=x(),K=new jge(L),M=[[c],[b===null?1:0],[Number.NEGATIVE_INFINITY],[_],[A]],U=b;b=n.runWebGLProgram(K,W,"int32",M),za(n,U)};for(let _=1;_<g;_*=2){const A=_*2;for(let L=_;L>=1;L/=2)w(A,L,[v,y])}for(let _=y;_>g;_/=2){const A=x(),L=new Hge([v,_/2]),K=[[c],[b===null?1:0],[g]],R=b;b=n.runWebGLProgram(L,A,"int32",K),za(n,R);const M=g/2,U=M*2;for(let D=M;D>=1;D/=2)w(U,D,b.shape)}let C=b;b=Oc({inputs:{x:b},backend:n,attrs:{begin:0,size:[v,i]}}),za(n,C);let S=mP({inputs:{x:p,indices:b},backend:n,attrs:{axis:1,batchDims:1}});za(n,p);const E=u.slice(0,-1);E.push(i),C=b,b=Be({inputs:{x:b},attrs:{shape:E},backend:n}),za(n,C);const T=S;return S=Be({inputs:{x:S},attrs:{shape:E},backend:n}),za(n,T),[S,b]}const Kge={kernelName:l2,backendName:"webgl",kernelFunc:qge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xge{constructor(e,n,r,s,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=r==="nearest"?1:2;let l;switch(s){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yge(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:u}=r,[c,h,d,f]=s.shape,[m,v]=u??[h,d],p=[c,m,v,f],g=new Xge(h,d,o,a,l,p);return n.runWebGLProgram(g,[s,i],"float32")}const Zge={kernelName:u2,backendName:"webgl",kernelFunc:Yge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qge(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:i}=e;Jf(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(i.dataId),{outputValues:a,outputShape:l,indices:u}=Zae(o,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const Jge={kernelName:c2,backendName:"webgl",kernelFunc:Qge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e0e(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s,a=o.shape.length,l=s.shape[i],u=new Array(a-1);let c=0;for(let v=0;v<a;v++)v!==i&&(u[c++]=o.shape[v]);const h=[],d=new Array(a).fill(0),f=o.shape.slice();f[i]=1;const m=new Array(l);for(let v=0;v<m.length;v++){d[i]=v;const p=Oc({inputs:{x:o},backend:n,attrs:{begin:d,size:f}}),g=Be({inputs:{x:p},backend:n,attrs:{shape:u}});m[v]=g,h.push(p)}return h.forEach(v=>n.disposeIntermediateTensorInfo(v)),m}const t0e={kernelName:cv,backendName:"webgl",kernelFunc:e0e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n0e{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/r);this.outputShape=[s,a];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,h=r%4,d=`
        sumValue += dot(values, segFilter);
    `;let f="";i%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let m="";i%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${m}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${c};
        if (${h===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${h===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${h===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:i}=e,{numSegments:o}=r,a=s.shape.length,l=[];let u=0;const c=hn([u],a);let h=s;c!=null&&(h=$r({inputs:{x:s},backend:n,attrs:{perm:c}}),l.push(h),u=Cn(1,a)[0]);const d=oO(h.shape,u,o),f=be([h.shape[u]]),m=Be({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}});l.push(m);const v=f2(s.dtype),p=(x,w,C,S,E)=>{const T=x.shape[0],_=x.shape[1],A=iO(_,E),L={windowSize:A,inSize:_,batchSize:T,numSegments:E},W=new n0e(L,w),K=n.compileAndRun(W,[x,C],S);if(l.push(K),K.shape[1]===E)return K;const R=CP({backend:n,attrs:{start:0,stop:E,step:1,dtype:"float32"}}),M=SP({inputs:{x:R},backend:n,attrs:{reps:[_/A]}});return l.push(R),l.push(M),p(K,w,M,S,E)},g=p(m,"unsortedSegmentSum",i,v,o),y=Be({inputs:{x:g},backend:n,attrs:{shape:d}});let b=y;if(c!=null){l.push(y);const x=$a(c);b=$r({inputs:{x:b},backend:n,attrs:{perm:x}})}return l.forEach(x=>n.disposeIntermediateTensorInfo(x)),b}const s0e={kernelName:hv,backendName:"webgl",kernelFunc:r0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i0e=[Vle,Gle,qle,Yle,Qle,tue,rue,iue,uue,hue,pue,vue,bue,kue,Tue,Nue,Due,Fue,Pue,Bue,Wue,Yue,Que,nce,sce,cce,dce,gce,Ele,xce,kce,_ce,Oce,Pce,Bce,Uce,Wce,qce,Yce,Jce,the,rhe,ihe,lhe,che,phe,ghe,xhe,Che,khe,_he,Ahe,Lhe,Bhe,Vhe,Whe,jhe,qhe,Xhe,Zhe,Jhe,rde,ode,ude,hde,pde,vde,wde,Ede,kle,Tde,Cce,$de,Rde,Lde,Tle,zde,Gde,Hde,Yde,Jde,rfe,ofe,cfe,pfe,vfe,xfe,Sfe,Efe,Tfe,Dfe,Rfe,Ffe,Pfe,Bfe,Wfe,qfe,Zfe,ipe,$le,upe,dpe,mpe,ype,oce,wpe,Spe,Epe,_pe,Ape,Nle,Ope,Lpe,Mpe,zpe,Upe,ace,tpe,Gpe,Kpe,Qpe,Ale,nme,ime,ume,dme,gme,yme,wme,kme,Tme,$me,Rme,Lme,zme,Wme,qme,Yme,Kue,rpe,Jme,tge,rge,ige,age,uge,hge,fge,mge,yge,bge,Cge,kge,Tge,Nge,Dge,Rge,npe,Ble,Lge,Bge,Uge,Gge,Kge,Zge,zle,Jge,t0e,s0e,Cpe];for(const t of i0e)gA(t);async function o0e(){try{const t=await wQ("model/model.json");return console.log("Model successfully loaded!"),t}catch(t){return console.error("Error loading the model:",t),null}}function a0e(t){console.log(t);let e=t.toLowerCase();return e=e.replace(/[^a-zA-Z\s.!?,']/g," "),e=e.replace(/\s+[a-zA-Z]\s+/g," "),e=e.replace(/\s+/g," "),e}function l0e(t,e){const n=new Array(e).fill(0);return t.forEach((r,s)=>{n[s]=r}),n}async function u0e(){try{const e=await(await fetch("model/tokenizer.json")).json();return console.log("Tokenizer data loaded!"),e}catch(t){return console.error("Error loading the tokenizer:",t),null}}function c0e(t,e){if(!e)return console.error("Tokenizer data is not available."),[];const n=t.split(" "),r=[];return n.forEach(s=>{e[s]!==void 0&&r.push(e[s])}),r}function h0e(t,e){const n=t.slice(),r=[];for(;n.length>e;)r.push(n.splice(0,e));return r.push(n),r}function d0e(t,e){if(t.length!==e.length)throw new Error("Arrays must have the same length.");const n=[];for(let r=0;r<t.length;r++)n.push(t[r]+e[r]);return n}async function f0e(t,e,n){if(!e)return console.error("Model is not available."),null;if(!n)return console.error("Tokenizer data is not available."),null;const r=["joy","anger","sadness","fear","neutral"],s=100;t=a0e(t);const i=c0e(t,n);console.log(i,"tokenizedTexts");const o=h0e(i,s);console.log(o);const a=o[o.length-1],l=l0e(a,s);o[o.length-1]=l;let u=[0,0,0,0,0];for(let h=0;h<o.length;h++){const d=o[h],f=om([d],[1,s]),m=e.predict(f),v=Array.from(m.dataSync());u=d0e(u,v)}console.log("totalEmotionProbability :>> ",u);const c=u.indexOf(Math.max(...u));return r[c]}function kP(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=kP(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function Qo(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=kP(t))&&(r&&(r+=" "),r+=e);return r}const Rh=t=>typeof t=="number"&&!isNaN(t),$l=t=>typeof t=="string",ts=t=>typeof t=="function",lm=t=>$l(t)||ts(t)?t:null,r1=t=>Ce.isValidElement(t)||$l(t)||ts(t)||Rh(t);function p0e(t,e,n){n===void 0&&(n=300);const{scrollHeight:r,style:s}=t;requestAnimationFrame(()=>{s.minHeight="initial",s.height=r+"px",s.transition=`all ${n}ms`,requestAnimationFrame(()=>{s.height="0",s.padding="0",s.margin="0",setTimeout(e,n)})})}function Vv(t){let{enter:e,exit:n,appendPosition:r=!1,collapse:s=!0,collapseDuration:i=300}=t;return function(o){let{children:a,position:l,preventExitTransition:u,done:c,nodeRef:h,isIn:d}=o;const f=r?`${e}--${l}`:e,m=r?`${n}--${l}`:n,v=Ce.useRef(0);return Ce.useLayoutEffect(()=>{const p=h.current,g=f.split(" "),y=b=>{b.target===h.current&&(p.dispatchEvent(new Event("d")),p.removeEventListener("animationend",y),p.removeEventListener("animationcancel",y),v.current===0&&b.type!=="animationcancel"&&p.classList.remove(...g))};p.classList.add(...g),p.addEventListener("animationend",y),p.addEventListener("animationcancel",y)},[]),Ce.useEffect(()=>{const p=h.current,g=()=>{p.removeEventListener("animationend",g),s?p0e(p,c,i):c()};d||(u?g():(v.current=1,p.className+=` ${m}`,p.addEventListener("animationend",g)))},[d]),Ht.createElement(Ht.Fragment,null,a)}}function $T(t,e){return t!=null?{content:t.content,containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,status:e}:{}}const Ps={list:new Map,emitQueue:new Map,on(t,e){return this.list.has(t)||this.list.set(t,[]),this.list.get(t).push(e),this},off(t,e){if(e){const n=this.list.get(t).filter(r=>r!==e);return this.list.set(t,n),this}return this.list.delete(t),this},cancelEmit(t){const e=this.emitQueue.get(t);return e&&(e.forEach(clearTimeout),this.emitQueue.delete(t)),this},emit(t){this.list.has(t)&&this.list.get(t).forEach(e=>{const n=setTimeout(()=>{e(...[].slice.call(arguments,1))},0);this.emitQueue.has(t)||this.emitQueue.set(t,[]),this.emitQueue.get(t).push(n)})}},Wp=t=>{let{theme:e,type:n,...r}=t;return Ht.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${n})`,...r})},s1={info:function(t){return Ht.createElement(Wp,{...t},Ht.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(t){return Ht.createElement(Wp,{...t},Ht.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(t){return Ht.createElement(Wp,{...t},Ht.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(t){return Ht.createElement(Wp,{...t},Ht.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return Ht.createElement("div",{className:"Toastify__spinner"})}};function m0e(t){const[,e]=Ce.useReducer(f=>f+1,0),[n,r]=Ce.useState([]),s=Ce.useRef(null),i=Ce.useRef(new Map).current,o=f=>n.indexOf(f)!==-1,a=Ce.useRef({toastKey:1,displayedToast:0,count:0,queue:[],props:t,containerId:null,isToastActive:o,getToast:f=>i.get(f)}).current;function l(f){let{containerId:m}=f;const{limit:v}=a.props;!v||m&&a.containerId!==m||(a.count-=a.queue.length,a.queue=[])}function u(f){r(m=>f==null?[]:m.filter(v=>v!==f))}function c(){const{toastContent:f,toastProps:m,staleId:v}=a.queue.shift();d(f,m,v)}function h(f,m){let{delay:v,staleId:p,...g}=m;if(!r1(f)||function(L){return!s.current||a.props.enableMultiContainer&&L.containerId!==a.props.containerId||i.has(L.toastId)&&L.updateId==null}(g))return;const{toastId:y,updateId:b,data:x}=g,{props:w}=a,C=()=>u(y),S=b==null;S&&a.count++;const E={...w,style:w.toastStyle,key:a.toastKey++,...Object.fromEntries(Object.entries(g).filter(L=>{let[W,K]=L;return K!=null})),toastId:y,updateId:b,data:x,closeToast:C,isIn:!1,className:lm(g.className||w.toastClassName),bodyClassName:lm(g.bodyClassName||w.bodyClassName),progressClassName:lm(g.progressClassName||w.progressClassName),autoClose:!g.isLoading&&(T=g.autoClose,_=w.autoClose,T===!1||Rh(T)&&T>0?T:_),deleteToast(){const L=$T(i.get(y),"removed");i.delete(y),Ps.emit(4,L);const W=a.queue.length;if(a.count=y==null?a.count-a.displayedToast:a.count-1,a.count<0&&(a.count=0),W>0){const K=y==null?a.props.limit:1;if(W===1||K===1)a.displayedToast++,c();else{const R=K>W?W:K;a.displayedToast=R;for(let M=0;M<R;M++)c()}}else e()}};var T,_;E.iconOut=function(L){let{theme:W,type:K,isLoading:R,icon:M}=L,U=null;const D={theme:W,type:K};return M===!1||(ts(M)?U=M(D):Ce.isValidElement(M)?U=Ce.cloneElement(M,D):$l(M)||Rh(M)?U=M:R?U=s1.spinner():(B=>B in s1)(K)&&(U=s1[K](D))),U}(E),ts(g.onOpen)&&(E.onOpen=g.onOpen),ts(g.onClose)&&(E.onClose=g.onClose),E.closeButton=w.closeButton,g.closeButton===!1||r1(g.closeButton)?E.closeButton=g.closeButton:g.closeButton===!0&&(E.closeButton=!r1(w.closeButton)||w.closeButton);let A=f;Ce.isValidElement(f)&&!$l(f.type)?A=Ce.cloneElement(f,{closeToast:C,toastProps:E,data:x}):ts(f)&&(A=f({closeToast:C,toastProps:E,data:x})),w.limit&&w.limit>0&&a.count>w.limit&&S?a.queue.push({toastContent:A,toastProps:E,staleId:p}):Rh(v)?setTimeout(()=>{d(A,E,p)},v):d(A,E,p)}function d(f,m,v){const{toastId:p}=m;v&&i.delete(v);const g={content:f,props:m};i.set(p,g),r(y=>[...y,p].filter(b=>b!==v)),Ps.emit(4,$T(g,g.props.updateId==null?"added":"updated"))}return Ce.useEffect(()=>(a.containerId=t.containerId,Ps.cancelEmit(3).on(0,h).on(1,f=>s.current&&u(f)).on(5,l).emit(2,a),()=>{i.clear(),Ps.emit(3,a)}),[]),Ce.useEffect(()=>{a.props=t,a.isToastActive=o,a.displayedToast=n.length}),{getToastToRender:function(f){const m=new Map,v=Array.from(i.values());return t.newestOnTop&&v.reverse(),v.forEach(p=>{const{position:g}=p.props;m.has(g)||m.set(g,[]),m.get(g).push(p)}),Array.from(m,p=>f(p[0],p[1]))},containerRef:s,isToastActive:o}}function DT(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientX:t.clientX}function AT(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientY:t.clientY}function g0e(t){const[e,n]=Ce.useState(!1),[r,s]=Ce.useState(!1),i=Ce.useRef(null),o=Ce.useRef({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,a=Ce.useRef(t),{autoClose:l,pauseOnHover:u,closeToast:c,onClick:h,closeOnClick:d}=t;function f(x){if(t.draggable){x.nativeEvent.type==="touchstart"&&x.nativeEvent.preventDefault(),o.didMove=!1,document.addEventListener("mousemove",g),document.addEventListener("mouseup",y),document.addEventListener("touchmove",g),document.addEventListener("touchend",y);const w=i.current;o.canCloseOnClick=!0,o.canDrag=!0,o.boundingRect=w.getBoundingClientRect(),w.style.transition="",o.x=DT(x.nativeEvent),o.y=AT(x.nativeEvent),t.draggableDirection==="x"?(o.start=o.x,o.removalDistance=w.offsetWidth*(t.draggablePercent/100)):(o.start=o.y,o.removalDistance=w.offsetHeight*(t.draggablePercent===80?1.5*t.draggablePercent:t.draggablePercent/100))}}function m(x){if(o.boundingRect){const{top:w,bottom:C,left:S,right:E}=o.boundingRect;x.nativeEvent.type!=="touchend"&&t.pauseOnHover&&o.x>=S&&o.x<=E&&o.y>=w&&o.y<=C?p():v()}}function v(){n(!0)}function p(){n(!1)}function g(x){const w=i.current;o.canDrag&&w&&(o.didMove=!0,e&&p(),o.x=DT(x),o.y=AT(x),o.delta=t.draggableDirection==="x"?o.x-o.start:o.y-o.start,o.start!==o.x&&(o.canCloseOnClick=!1),w.style.transform=`translate${t.draggableDirection}(${o.delta}px)`,w.style.opacity=""+(1-Math.abs(o.delta/o.removalDistance)))}function y(){document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",g),document.removeEventListener("touchend",y);const x=i.current;if(o.canDrag&&o.didMove&&x){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance)return s(!0),void t.closeToast();x.style.transition="transform 0.2s, opacity 0.2s",x.style.transform=`translate${t.draggableDirection}(0)`,x.style.opacity="1"}}Ce.useEffect(()=>{a.current=t}),Ce.useEffect(()=>(i.current&&i.current.addEventListener("d",v,{once:!0}),ts(t.onOpen)&&t.onOpen(Ce.isValidElement(t.children)&&t.children.props),()=>{const x=a.current;ts(x.onClose)&&x.onClose(Ce.isValidElement(x.children)&&x.children.props)}),[]),Ce.useEffect(()=>(t.pauseOnFocusLoss&&(document.hasFocus()||p(),window.addEventListener("focus",v),window.addEventListener("blur",p)),()=>{t.pauseOnFocusLoss&&(window.removeEventListener("focus",v),window.removeEventListener("blur",p))}),[t.pauseOnFocusLoss]);const b={onMouseDown:f,onTouchStart:f,onMouseUp:m,onTouchEnd:m};return l&&u&&(b.onMouseEnter=p,b.onMouseLeave=v),d&&(b.onClick=x=>{h&&h(x),o.canCloseOnClick&&c()}),{playToast:v,pauseToast:p,isRunning:e,preventExitTransition:r,toastRef:i,eventHandlers:b}}function EP(t){let{closeToast:e,theme:n,ariaLabel:r="close"}=t;return Ht.createElement("button",{className:`Toastify__close-button Toastify__close-button--${n}`,type:"button",onClick:s=>{s.stopPropagation(),e(s)},"aria-label":r},Ht.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Ht.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function v0e(t){let{delay:e,isRunning:n,closeToast:r,type:s="default",hide:i,className:o,style:a,controlledProgress:l,progress:u,rtl:c,isIn:h,theme:d}=t;const f=i||l&&u===0,m={...a,animationDuration:`${e}ms`,animationPlayState:n?"running":"paused",opacity:f?0:1};l&&(m.transform=`scaleX(${u})`);const v=Qo("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${d}`,`Toastify__progress-bar--${s}`,{"Toastify__progress-bar--rtl":c}),p=ts(o)?o({rtl:c,type:s,defaultClassName:v}):Qo(v,o);return Ht.createElement("div",{role:"progressbar","aria-hidden":f?"true":"false","aria-label":"notification timer",className:p,style:m,[l&&u>=1?"onTransitionEnd":"onAnimationEnd"]:l&&u<1?null:()=>{h&&r()}})}const y0e=t=>{const{isRunning:e,preventExitTransition:n,toastRef:r,eventHandlers:s}=g0e(t),{closeButton:i,children:o,autoClose:a,onClick:l,type:u,hideProgressBar:c,closeToast:h,transition:d,position:f,className:m,style:v,bodyClassName:p,bodyStyle:g,progressClassName:y,progressStyle:b,updateId:x,role:w,progress:C,rtl:S,toastId:E,deleteToast:T,isIn:_,isLoading:A,iconOut:L,closeOnClick:W,theme:K}=t,R=Qo("Toastify__toast",`Toastify__toast-theme--${K}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":S},{"Toastify__toast--close-on-click":W}),M=ts(m)?m({rtl:S,position:f,type:u,defaultClassName:R}):Qo(R,m),U=!!C||!a,D={closeToast:h,type:u,theme:K};let B=null;return i===!1||(B=ts(i)?i(D):Ce.isValidElement(i)?Ce.cloneElement(i,D):EP(D)),Ht.createElement(d,{isIn:_,done:T,position:f,preventExitTransition:n,nodeRef:r},Ht.createElement("div",{id:E,onClick:l,className:M,...s,style:v,ref:r},Ht.createElement("div",{..._&&{role:w},className:ts(p)?p({type:u}):Qo("Toastify__toast-body",p),style:g},L!=null&&Ht.createElement("div",{className:Qo("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!A})},L),Ht.createElement("div",null,o)),B,Ht.createElement(v0e,{...x&&!U?{key:`pb-${x}`}:{},rtl:S,theme:K,delay:a,isRunning:e,isIn:_,closeToast:h,hide:c,type:u,style:b,className:y,controlledProgress:U,progress:C||0})))},Wv=function(t,e){return e===void 0&&(e=!1),{enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}},x0e=Vv(Wv("bounce",!0));Vv(Wv("slide",!0));Vv(Wv("zoom"));Vv(Wv("flip"));const Zx=Ce.forwardRef((t,e)=>{const{getToastToRender:n,containerRef:r,isToastActive:s}=m0e(t),{className:i,style:o,rtl:a,containerId:l}=t;function u(c){const h=Qo("Toastify__toast-container",`Toastify__toast-container--${c}`,{"Toastify__toast-container--rtl":a});return ts(i)?i({position:c,rtl:a,defaultClassName:h}):Qo(h,lm(i))}return Ce.useEffect(()=>{e&&(e.current=r.current)},[]),Ht.createElement("div",{ref:r,className:"Toastify",id:l},n((c,h)=>{const d=h.length?{...o}:{...o,pointerEvents:"none"};return Ht.createElement("div",{className:u(c),style:d,key:`container-${c}`},h.map((f,m)=>{let{content:v,props:p}=f;return Ht.createElement(y0e,{...p,isIn:s(p.toastId),style:{...p.style,"--nth":m+1,"--len":h.length},key:`toast-${p.key}`},v)}))}))});Zx.displayName="ToastContainer",Zx.defaultProps={position:"top-right",transition:x0e,autoClose:5e3,closeButton:EP,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};let i1,Ga=new Map,vh=[],b0e=1;function IP(){return""+b0e++}function w0e(t){return t&&($l(t.toastId)||Rh(t.toastId))?t.toastId:IP()}function Oh(t,e){return Ga.size>0?Ps.emit(0,t,e):vh.push({content:t,options:e}),e.toastId}function xg(t,e){return{...e,type:e&&e.type||t,toastId:w0e(e)}}function Gp(t){return(e,n)=>Oh(e,xg(t,n))}function ln(t,e){return Oh(t,xg("default",e))}ln.loading=(t,e)=>Oh(t,xg("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e})),ln.promise=function(t,e,n){let r,{pending:s,error:i,success:o}=e;s&&(r=$l(s)?ln.loading(s,n):ln.loading(s.render,{...n,...s}));const a={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(c,h,d)=>{if(h==null)return void ln.dismiss(r);const f={type:c,...a,...n,data:d},m=$l(h)?{render:h}:h;return r?ln.update(r,{...f,...m}):ln(m.render,{...f,...m}),d},u=ts(t)?t():t;return u.then(c=>l("success",o,c)).catch(c=>l("error",i,c)),u},ln.success=Gp("success"),ln.info=Gp("info"),ln.error=Gp("error"),ln.warning=Gp("warning"),ln.warn=ln.warning,ln.dark=(t,e)=>Oh(t,xg("default",{theme:"dark",...e})),ln.dismiss=t=>{Ga.size>0?Ps.emit(1,t):vh=vh.filter(e=>t!=null&&e.options.toastId!==t)},ln.clearWaitingQueue=function(t){return t===void 0&&(t={}),Ps.emit(5,t)},ln.isActive=t=>{let e=!1;return Ga.forEach(n=>{n.isToastActive&&n.isToastActive(t)&&(e=!0)}),e},ln.update=function(t,e){e===void 0&&(e={}),setTimeout(()=>{const n=function(r,s){let{containerId:i}=s;const o=Ga.get(i||i1);return o&&o.getToast(r)}(t,e);if(n){const{props:r,content:s}=n,i={delay:100,...r,...e,toastId:e.toastId||t,updateId:IP()};i.toastId!==t&&(i.staleId=t);const o=i.render||s;delete i.render,Oh(o,i)}},0)},ln.done=t=>{ln.update(t,{progress:1})},ln.onChange=t=>(Ps.on(4,t),()=>{Ps.off(4,t)}),ln.POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},ln.TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},Ps.on(2,t=>{i1=t.containerId||t,Ga.set(i1,t),vh.forEach(e=>{Ps.emit(0,e.content,e.options)}),vh=[]}).on(3,t=>{Ga.delete(t.containerId||t),Ga.size===0&&Ps.off(0).off(1).off(5)});function C0e(t){var e="";switch(t){case"joy":e="0ra1sgdNkKatWh3LOMEGCa";break;case"sadness":e="2hi47ni1BUFQMoDKACjgTZ";break;case"fear":e="5EbEfrwJPJEe4gLneh6onP";break;case"anger":e="6QZnHBnKUjL1TCxzDk2V5o";break}return`https://open.spotify.com/embed/playlist/${e}?utm_source=generator`}function S0e({storyText:t,setIsLoading:e}){const[n,r]=Ce.useState(""),[s,i]=Ce.useState(!1);Ce.useEffect(()=>{if(!t.trim()){e(!1),i(!0);return}e(!0);async function l(){const u=await o0e(),c=await u0e(),h=await f0e(t,u,c);r(h),i(!1),e(!1),console.log(h,"prediction"),o(h)}l()},[t,e]);const o=a=>{ln.info(`Dominant Emotion: ${a}`,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light",icon:!1})};return lt.jsxs("div",{className:"spotify-embed",children:[lt.jsx(Zx,{style:{backgroundColor:"white",fontFamily:"Playpen Sans"},position:"top-right",autoClose:2e3,limit:1,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),n===""||n==="neutral"?lt.jsx("p",{style:{fontSize:"2rem",marginBottom:"10px",color:"black",margin:"auto 0",textAlign:"center"},children:n===""?"No Emotion":"Neutral"}):lt.jsx("iframe",{id:"spotifyPlaylist",style:{borderRadius:"12px",width:"100%",height:"100%"},src:C0e(n),frameBorder:"0",allowFullScreen:"",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",onError:()=>alert("Error loading Spotify iframe. Please refresh the page. Sorry")},n)]})}var TP={exports:{}};(function(t,e){(function(r,s){t.exports=s()})(typeof self<"u"?self:yn,function(){return function(n){var r={};function s(i){if(r[i])return r[i].exports;var o=r[i]={i,l:!1,exports:{}};return n[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=n,s.c=r,s.d=function(i,o,a){s.o(i,o)||Object.defineProperty(i,o,{configurable:!1,enumerable:!0,get:a})},s.n=function(i){var o=i&&i.__esModule?function(){return i.default}:function(){return i};return s.d(o,"a",o),o},s.o=function(i,o){return Object.prototype.hasOwnProperty.call(i,o)},s.p="/",s(s.s=7)}([function(n,r,s){function i(o,a,l,u,c,h,d,f){if(!o){var m;if(a===void 0)m=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var v=[l,u,c,h,d,f],p=0;m=new Error(a.replace(/%s/g,function(){return v[p++]})),m.name="Invariant Violation"}throw m.framesToPop=1,m}}n.exports=i},function(n,r,s){function i(a){return function(){return a}}var o=function(){};o.thatReturns=i,o.thatReturnsFalse=i(!1),o.thatReturnsTrue=i(!0),o.thatReturnsNull=i(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(a){return a},n.exports=o},function(n,r,s){/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function l(c){if(c==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(c)}function u(){try{if(!Object.assign)return!1;var c=new String("abc");if(c[5]="de",Object.getOwnPropertyNames(c)[0]==="5")return!1;for(var h={},d=0;d<10;d++)h["_"+String.fromCharCode(d)]=d;var f=Object.getOwnPropertyNames(h).map(function(v){return h[v]});if(f.join("")!=="0123456789")return!1;var m={};return"abcdefghijklmnopqrst".split("").forEach(function(v){m[v]=v}),Object.keys(Object.assign({},m)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}n.exports=u()?Object.assign:function(c,h){for(var d,f=l(c),m,v=1;v<arguments.length;v++){d=Object(arguments[v]);for(var p in d)o.call(d,p)&&(f[p]=d[p]);if(i){m=i(d);for(var g=0;g<m.length;g++)a.call(d,m[g])&&(f[m[g]]=d[m[g]])}}return f}},function(n,r,s){var i=s(1),o=i;n.exports=o},function(n,r,s){var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";n.exports=i},function(n,r,s){var i={};n.exports=i},function(n,r,s){function i(o,a,l,u,c){}n.exports=i},function(n,r,s){Object.defineProperty(r,"__esModule",{value:!0});var i=Object.assign||function(x){for(var w=1;w<arguments.length;w++){var C=arguments[w];for(var S in C)Object.prototype.hasOwnProperty.call(C,S)&&(x[S]=C[S])}return x},o=function(){function x(w,C){for(var S=0;S<C.length;S++){var E=C[S];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(w,E.key,E)}}return function(w,C,S){return C&&x(w.prototype,C),S&&x(w,S),w}}(),a=s(8),l=m(a),u=s(11),c=m(u),h=s(14),d=f(h);function f(x){if(x&&x.__esModule)return x;var w={};if(x!=null)for(var C in x)Object.prototype.hasOwnProperty.call(x,C)&&(w[C]=x[C]);return w.default=x,w}function m(x){return x&&x.__esModule?x:{default:x}}function v(x,w){var C={};for(var S in x)w.indexOf(S)>=0||Object.prototype.hasOwnProperty.call(x,S)&&(C[S]=x[S]);return C}function p(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")}function g(x,w){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:x}function y(x,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);x.prototype=Object.create(w&&w.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(x,w):x.__proto__=w)}var b=function(x){y(w,x);function w(){var C,S,E,T;p(this,w);for(var _=arguments.length,A=Array(_),L=0;L<_;L++)A[L]=arguments[L];return T=(S=(E=g(this,(C=w.__proto__||Object.getPrototypeOf(w)).call.apply(C,[this].concat(A))),E),E.state={delayed:E.props.delay>0},S),g(E,T)}return o(w,[{key:"componentDidMount",value:function(){var S=this,E=this.props.delay,T=this.state.delayed;T&&(this.timeout=setTimeout(function(){S.setState({delayed:!1})},E))}},{key:"componentWillUnmount",value:function(){var S=this.timeout;S&&clearTimeout(S)}},{key:"render",value:function(){var S=this.props,E=S.color;S.delay;var T=S.type,_=S.height,A=S.width,L=v(S,["color","delay","type","height","width"]),W=this.state.delayed?"blank":T,K=d[W],R={fill:E,height:_,width:A};return l.default.createElement("div",i({style:R,dangerouslySetInnerHTML:{__html:K}},L))}}]),w}(a.Component);b.propTypes={color:c.default.string,delay:c.default.number,type:c.default.string,height:c.default.oneOfType([c.default.string,c.default.number]),width:c.default.oneOfType([c.default.string,c.default.number])},b.defaultProps={color:"#fff",delay:0,type:"balls",height:64,width:64},r.default=b},function(n,r,s){n.exports=s(9)},function(n,r,s){/** @license React v16.3.2
 * react.production.min.js
 *
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i=s(2),o=s(0),a=s(5),l=s(1),u=typeof Symbol=="function"&&Symbol.for,c=u?Symbol.for("react.element"):60103,h=u?Symbol.for("react.portal"):60106,d=u?Symbol.for("react.fragment"):60107,f=u?Symbol.for("react.strict_mode"):60108,m=u?Symbol.for("react.provider"):60109,v=u?Symbol.for("react.context"):60110,p=u?Symbol.for("react.async_mode"):60111,g=u?Symbol.for("react.forward_ref"):60112,y=typeof Symbol=="function"&&Symbol.iterator;function b(j){for(var J=arguments.length-1,fe="http://reactjs.org/docs/error-decoder.html?invariant="+j,ve=0;ve<J;ve++)fe+="&args[]="+encodeURIComponent(arguments[ve+1]);o(!1,"Minified React error #"+j+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",fe)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}};function w(j,J,fe){this.props=j,this.context=J,this.refs=a,this.updater=fe||x}w.prototype.isReactComponent={},w.prototype.setState=function(j,J){typeof j!="object"&&typeof j!="function"&&j!=null&&b("85"),this.updater.enqueueSetState(this,j,J,"setState")},w.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function C(){}C.prototype=w.prototype;function S(j,J,fe){this.props=j,this.context=J,this.refs=a,this.updater=fe||x}var E=S.prototype=new C;E.constructor=S,i(E,w.prototype),E.isPureReactComponent=!0;var T={current:null},_=Object.prototype.hasOwnProperty,A={key:!0,ref:!0,__self:!0,__source:!0};function L(j,J,fe){var ve=void 0,we={},De=null,Pe=null;if(J!=null)for(ve in J.ref!==void 0&&(Pe=J.ref),J.key!==void 0&&(De=""+J.key),J)_.call(J,ve)&&!A.hasOwnProperty(ve)&&(we[ve]=J[ve]);var Ge=arguments.length-2;if(Ge===1)we.children=fe;else if(1<Ge){for(var Xe=Array(Ge),Je=0;Je<Ge;Je++)Xe[Je]=arguments[Je+2];we.children=Xe}if(j&&j.defaultProps)for(ve in Ge=j.defaultProps,Ge)we[ve]===void 0&&(we[ve]=Ge[ve]);return{$$typeof:c,type:j,key:De,ref:Pe,props:we,_owner:T.current}}function W(j){return typeof j=="object"&&j!==null&&j.$$typeof===c}function K(j){var J={"=":"=0",":":"=2"};return"$"+(""+j).replace(/[=:]/g,function(fe){return J[fe]})}var R=/\/+/g,M=[];function U(j,J,fe,ve){if(M.length){var we=M.pop();return we.result=j,we.keyPrefix=J,we.func=fe,we.context=ve,we.count=0,we}return{result:j,keyPrefix:J,func:fe,context:ve,count:0}}function D(j){j.result=null,j.keyPrefix=null,j.func=null,j.context=null,j.count=0,10>M.length&&M.push(j)}function B(j,J,fe,ve){var we=typeof j;(we==="undefined"||we==="boolean")&&(j=null);var De=!1;if(j===null)De=!0;else switch(we){case"string":case"number":De=!0;break;case"object":switch(j.$$typeof){case c:case h:De=!0}}if(De)return fe(ve,j,J===""?"."+X(j,0):J),1;if(De=0,J=J===""?".":J+":",Array.isArray(j))for(var Pe=0;Pe<j.length;Pe++){we=j[Pe];var Ge=J+X(we,Pe);De+=B(we,Ge,fe,ve)}else if(j===null||typeof j>"u"?Ge=null:(Ge=y&&j[y]||j["@@iterator"],Ge=typeof Ge=="function"?Ge:null),typeof Ge=="function")for(j=Ge.call(j),Pe=0;!(we=j.next()).done;)we=we.value,Ge=J+X(we,Pe++),De+=B(we,Ge,fe,ve);else we==="object"&&(fe=""+j,b("31",fe==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":fe,""));return De}function X(j,J){return typeof j=="object"&&j!==null&&j.key!=null?K(j.key):J.toString(36)}function ie(j,J){j.func.call(j.context,J,j.count++)}function G(j,J,fe){var ve=j.result,we=j.keyPrefix;j=j.func.call(j.context,J,j.count++),Array.isArray(j)?Z(j,ve,fe,l.thatReturnsArgument):j!=null&&(W(j)&&(J=we+(!j.key||J&&J.key===j.key?"":(""+j.key).replace(R,"$&/")+"/")+fe,j={$$typeof:c,type:j.type,key:J,ref:j.ref,props:j.props,_owner:j._owner}),ve.push(j))}function Z(j,J,fe,ve,we){var De="";fe!=null&&(De=(""+fe).replace(R,"$&/")+"/"),J=U(J,De,ve,we),j==null||B(j,"",G,J),D(J)}var de={Children:{map:function(j,J,fe){if(j==null)return j;var ve=[];return Z(j,ve,null,J,fe),ve},forEach:function(j,J,fe){if(j==null)return j;J=U(null,null,J,fe),j==null||B(j,"",ie,J),D(J)},count:function(j){return j==null?0:B(j,"",l.thatReturnsNull,null)},toArray:function(j){var J=[];return Z(j,J,null,l.thatReturnsArgument),J},only:function(j){return W(j)||b("143"),j}},createRef:function(){return{current:null}},Component:w,PureComponent:S,createContext:function(j,J){return J===void 0&&(J=null),j={$$typeof:v,_calculateChangedBits:J,_defaultValue:j,_currentValue:j,_changedBits:0,Provider:null,Consumer:null},j.Provider={$$typeof:m,_context:j},j.Consumer=j},forwardRef:function(j){return{$$typeof:g,render:j}},Fragment:d,StrictMode:f,unstable_AsyncMode:p,createElement:L,cloneElement:function(j,J,fe){j==null&&b("267",j);var ve=void 0,we=i({},j.props),De=j.key,Pe=j.ref,Ge=j._owner;if(J!=null){J.ref!==void 0&&(Pe=J.ref,Ge=T.current),J.key!==void 0&&(De=""+J.key);var Xe=void 0;j.type&&j.type.defaultProps&&(Xe=j.type.defaultProps);for(ve in J)_.call(J,ve)&&!A.hasOwnProperty(ve)&&(we[ve]=J[ve]===void 0&&Xe!==void 0?Xe[ve]:J[ve])}if(ve=arguments.length-2,ve===1)we.children=fe;else if(1<ve){Xe=Array(ve);for(var Je=0;Je<ve;Je++)Xe[Je]=arguments[Je+2];we.children=Xe}return{$$typeof:c,type:j.type,key:De,ref:Pe,props:we,_owner:Ge}},createFactory:function(j){var J=L.bind(null,j);return J.type=j,J},isValidElement:W,version:"16.3.2",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:T,assign:i}},ge=Object.freeze({default:de}),ye=ge&&de||ge;n.exports=ye.default?ye.default:ye},function(n,r,s){},function(n,r,s){n.exports=s(13)()},function(n,r,s){var i=s(1),o=s(0),a=s(3),l=s(2),u=s(4),c=s(6);n.exports=function(h,d){var f=typeof Symbol=="function"&&Symbol.iterator,m="@@iterator";function v(G){var Z=G&&(f&&G[f]||G[m]);if(typeof Z=="function")return Z}var p="<<anonymous>>",g={array:w("array"),bool:w("boolean"),func:w("function"),number:w("number"),object:w("object"),string:w("string"),symbol:w("symbol"),any:C(),arrayOf:S,element:E(),instanceOf:T,node:W(),objectOf:A,oneOf:_,oneOfType:L,shape:K,exact:R};function y(G,Z){return G===Z?G!==0||1/G===1/Z:G!==G&&Z!==Z}function b(G){this.message=G,this.stack=""}b.prototype=Error.prototype;function x(G){function Z(ge,ye,j,J,fe,ve,we){return J=J||p,ve=ve||j,we!==u&&d&&o(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types"),ye[j]==null?ge?ye[j]===null?new b("The "+fe+" `"+ve+"` is marked as required "+("in `"+J+"`, but its value is `null`.")):new b("The "+fe+" `"+ve+"` is marked as required in "+("`"+J+"`, but its value is `undefined`.")):null:G(ye,j,J,fe,ve)}var de=Z.bind(null,!1);return de.isRequired=Z.bind(null,!0),de}function w(G){function Z(de,ge,ye,j,J,fe){var ve=de[ge],we=D(ve);if(we!==G){var De=B(ve);return new b("Invalid "+j+" `"+J+"` of type "+("`"+De+"` supplied to `"+ye+"`, expected ")+("`"+G+"`."))}return null}return x(Z)}function C(){return x(i.thatReturnsNull)}function S(G){function Z(de,ge,ye,j,J){if(typeof G!="function")return new b("Property `"+J+"` of component `"+ye+"` has invalid PropType notation inside arrayOf.");var fe=de[ge];if(!Array.isArray(fe)){var ve=D(fe);return new b("Invalid "+j+" `"+J+"` of type "+("`"+ve+"` supplied to `"+ye+"`, expected an array."))}for(var we=0;we<fe.length;we++){var De=G(fe,we,ye,j,J+"["+we+"]",u);if(De instanceof Error)return De}return null}return x(Z)}function E(){function G(Z,de,ge,ye,j){var J=Z[de];if(!h(J)){var fe=D(J);return new b("Invalid "+ye+" `"+j+"` of type "+("`"+fe+"` supplied to `"+ge+"`, expected a single ReactElement."))}return null}return x(G)}function T(G){function Z(de,ge,ye,j,J){if(!(de[ge]instanceof G)){var fe=G.name||p,ve=ie(de[ge]);return new b("Invalid "+j+" `"+J+"` of type "+("`"+ve+"` supplied to `"+ye+"`, expected ")+("instance of `"+fe+"`."))}return null}return x(Z)}function _(G){if(!Array.isArray(G))return i.thatReturnsNull;function Z(de,ge,ye,j,J){for(var fe=de[ge],ve=0;ve<G.length;ve++)if(y(fe,G[ve]))return null;var we=JSON.stringify(G);return new b("Invalid "+j+" `"+J+"` of value `"+fe+"` "+("supplied to `"+ye+"`, expected one of "+we+"."))}return x(Z)}function A(G){function Z(de,ge,ye,j,J){if(typeof G!="function")return new b("Property `"+J+"` of component `"+ye+"` has invalid PropType notation inside objectOf.");var fe=de[ge],ve=D(fe);if(ve!=="object")return new b("Invalid "+j+" `"+J+"` of type "+("`"+ve+"` supplied to `"+ye+"`, expected an object."));for(var we in fe)if(fe.hasOwnProperty(we)){var De=G(fe,we,ye,j,J+"."+we,u);if(De instanceof Error)return De}return null}return x(Z)}function L(G){if(!Array.isArray(G))return i.thatReturnsNull;for(var Z=0;Z<G.length;Z++){var de=G[Z];if(typeof de!="function")return a(!1,"Invalid argument supplied to oneOfType. Expected an array of check functions, but received %s at index %s.",X(de),Z),i.thatReturnsNull}function ge(ye,j,J,fe,ve){for(var we=0;we<G.length;we++){var De=G[we];if(De(ye,j,J,fe,ve,u)==null)return null}return new b("Invalid "+fe+" `"+ve+"` supplied to "+("`"+J+"`."))}return x(ge)}function W(){function G(Z,de,ge,ye,j){return M(Z[de])?null:new b("Invalid "+ye+" `"+j+"` supplied to "+("`"+ge+"`, expected a ReactNode."))}return x(G)}function K(G){function Z(de,ge,ye,j,J){var fe=de[ge],ve=D(fe);if(ve!=="object")return new b("Invalid "+j+" `"+J+"` of type `"+ve+"` "+("supplied to `"+ye+"`, expected `object`."));for(var we in G){var De=G[we];if(De){var Pe=De(fe,we,ye,j,J+"."+we,u);if(Pe)return Pe}}return null}return x(Z)}function R(G){function Z(de,ge,ye,j,J){var fe=de[ge],ve=D(fe);if(ve!=="object")return new b("Invalid "+j+" `"+J+"` of type `"+ve+"` "+("supplied to `"+ye+"`, expected `object`."));var we=l({},de[ge],G);for(var De in we){var Pe=G[De];if(!Pe)return new b("Invalid "+j+" `"+J+"` key `"+De+"` supplied to `"+ye+"`.\nBad object: "+JSON.stringify(de[ge],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(G),null,"  "));var Ge=Pe(fe,De,ye,j,J+"."+De,u);if(Ge)return Ge}return null}return x(Z)}function M(G){switch(typeof G){case"number":case"string":case"undefined":return!0;case"boolean":return!G;case"object":if(Array.isArray(G))return G.every(M);if(G===null||h(G))return!0;var Z=v(G);if(Z){var de=Z.call(G),ge;if(Z!==G.entries){for(;!(ge=de.next()).done;)if(!M(ge.value))return!1}else for(;!(ge=de.next()).done;){var ye=ge.value;if(ye&&!M(ye[1]))return!1}}else return!1;return!0;default:return!1}}function U(G,Z){return G==="symbol"||Z["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&Z instanceof Symbol}function D(G){var Z=typeof G;return Array.isArray(G)?"array":G instanceof RegExp?"object":U(Z,G)?"symbol":Z}function B(G){if(typeof G>"u"||G===null)return""+G;var Z=D(G);if(Z==="object"){if(G instanceof Date)return"date";if(G instanceof RegExp)return"regexp"}return Z}function X(G){var Z=B(G);switch(Z){case"array":case"object":return"an "+Z;case"boolean":case"date":case"regexp":return"a "+Z;default:return Z}}function ie(G){return!G.constructor||!G.constructor.name?p:G.constructor.name}return g.checkPropTypes=c,g.PropTypes=g,g}},function(n,r,s){var i=s(1),o=s(0),a=s(4);n.exports=function(){function l(h,d,f,m,v,p){p!==a&&o(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}l.isRequired=l;function u(){return l}var c={array:l,bool:l,func:l,number:l,object:l,string:l,symbol:l,any:l,arrayOf:u,element:l,instanceOf:u,node:l,objectOf:u,oneOf:u,oneOfType:u,shape:u,exact:u};return c.checkPropTypes=i,c.PropTypes=c,c}},function(n,r,s){Object.defineProperty(r,"__esModule",{value:!0});var i=s(15);Object.defineProperty(r,"blank",{enumerable:!0,get:function(){return m(i).default}});var o=s(16);Object.defineProperty(r,"balls",{enumerable:!0,get:function(){return m(o).default}});var a=s(17);Object.defineProperty(r,"bars",{enumerable:!0,get:function(){return m(a).default}});var l=s(18);Object.defineProperty(r,"bubbles",{enumerable:!0,get:function(){return m(l).default}});var u=s(19);Object.defineProperty(r,"cubes",{enumerable:!0,get:function(){return m(u).default}});var c=s(20);Object.defineProperty(r,"cylon",{enumerable:!0,get:function(){return m(c).default}});var h=s(21);Object.defineProperty(r,"spin",{enumerable:!0,get:function(){return m(h).default}});var d=s(22);Object.defineProperty(r,"spinningBubbles",{enumerable:!0,get:function(){return m(d).default}});var f=s(23);Object.defineProperty(r,"spokes",{enumerable:!0,get:function(){return m(f).default}});function m(v){return v&&v.__esModule?v:{default:v}}},function(n,r){n.exports=`<svg class="icon-blank" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"></svg>
`},function(n,r){n.exports=`<svg class="icon-loading" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path transform="translate(-8 0)" d="M4 12 A4 4 0 0 0 4 20 A4 4 0 0 0 4 12"> 
    <animateTransform attributeName="transform" type="translate" values="-8 0; 2 0; 2 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.25;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(2 0)" d="M4 12 A4 4 0 0 0 4 20 A4 4 0 0 0 4 12"> 
    <animateTransform attributeName="transform" type="translate" values="2 0; 12 0; 12 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.35;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(12 0)" d="M4 12 A4 4 0 0 0 4 20 A4 4 0 0 0 4 12"> 
    <animateTransform attributeName="transform" type="translate" values="12 0; 22 0; 22 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.45;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(24 0)" d="M4 12 A4 4 0 0 0 4 20 A4 4 0 0 0 4 12"> 
    <animateTransform attributeName="transform" type="translate" values="22 0; 32 0; 32 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.55;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
</svg>
`},function(n,r){n.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path transform="translate(2)" d="M0 12 V20 H4 V12z"> 
    <animate attributeName="d" values="M0 12 V20 H4 V12z; M0 4 V28 H4 V4z; M0 12 V20 H4 V12z; M0 12 V20 H4 V12z" dur="1.2s" repeatCount="indefinite" begin="0" keytimes="0;.2;.5;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.8 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(8)" d="M0 12 V20 H4 V12z">
    <animate attributeName="d" values="M0 12 V20 H4 V12z; M0 4 V28 H4 V4z; M0 12 V20 H4 V12z; M0 12 V20 H4 V12z" dur="1.2s" repeatCount="indefinite" begin="0.2" keytimes="0;.2;.5;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.8 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(14)" d="M0 12 V20 H4 V12z">
    <animate attributeName="d" values="M0 12 V20 H4 V12z; M0 4 V28 H4 V4z; M0 12 V20 H4 V12z; M0 12 V20 H4 V12z" dur="1.2s" repeatCount="indefinite" begin="0.4" keytimes="0;.2;.5;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.8 0.4 0.8" calcMode="spline" />
  </path>
  <path transform="translate(20)" d="M0 12 V20 H4 V12z">
    <animate attributeName="d" values="M0 12 V20 H4 V12z; M0 4 V28 H4 V4z; M0 12 V20 H4 V12z; M0 12 V20 H4 V12z" dur="1.2s" repeatCount="indefinite" begin="0.6" keytimes="0;.2;.5;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.8 0.4 0.8" calcMode="spline" />
  </path>
  <path transform="translate(26)" d="M0 12 V20 H4 V12z">
    <animate attributeName="d" values="M0 12 V20 H4 V12z; M0 4 V28 H4 V4z; M0 12 V20 H4 V12z; M0 12 V20 H4 V12z" dur="1.2s" repeatCount="indefinite" begin="0.8" keytimes="0;.2;.5;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.8 0.4 0.8" calcMode="spline" />
  </path>
</svg>
`},function(n,r){n.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <circle transform="translate(8 0)" cx="0" cy="16" r="0"> 
    <animate attributeName="r" values="0; 4; 0; 0" dur="1.2s" repeatCount="indefinite" begin="0"
      keytimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="translate(16 0)" cx="0" cy="16" r="0"> 
    <animate attributeName="r" values="0; 4; 0; 0" dur="1.2s" repeatCount="indefinite" begin="0.3"
      keytimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="translate(24 0)" cx="0" cy="16" r="0"> 
    <animate attributeName="r" values="0; 4; 0; 0" dur="1.2s" repeatCount="indefinite" begin="0.6"
      keytimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" />
  </circle>
</svg>
`},function(n,r){n.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path transform="translate(-8 0)" d="M0 12 V20 H8 V12z"> 
    <animateTransform attributeName="transform" type="translate" values="-8 0; 2 0; 2 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.25;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(2 0)" d="M0 12 V20 H8 V12z"> 
    <animateTransform attributeName="transform" type="translate" values="2 0; 12 0; 12 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.35;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(12 0)" d="M0 12 V20 H8 V12z"> 
    <animateTransform attributeName="transform" type="translate" values="12 0; 22 0; 22 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.45;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
  <path transform="translate(24 0)" d="M0 12 V20 H8 V12z"> 
    <animateTransform attributeName="transform" type="translate" values="22 0; 32 0; 32 0;" dur="0.8s" repeatCount="indefinite" begin="0" keytimes="0;.55;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline"  />
  </path>
</svg>
`},function(n,r){n.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path transform="translate(0 0)" d="M0 12 V20 H4 V12z">
    <animateTransform attributeName="transform" type="translate" values="0 0; 28 0; 0 0; 0 0" dur="1.5s" begin="0" repeatCount="indefinite" keytimes="0;0.3;0.6;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </path>
  <path opacity="0.5" transform="translate(0 0)" d="M0 12 V20 H4 V12z">
    <animateTransform attributeName="transform" type="translate" values="0 0; 28 0; 0 0; 0 0" dur="1.5s" begin="0.1s" repeatCount="indefinite" keytimes="0;0.3;0.6;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </path>
  <path opacity="0.25" transform="translate(0 0)" d="M0 12 V20 H4 V12z">
    <animateTransform attributeName="transform" type="translate" values="0 0; 28 0; 0 0; 0 0" dur="1.5s" begin="0.2s" repeatCount="indefinite" keytimes="0;0.3;0.6;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </path>
</svg>
`},function(n,r){n.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path opacity=".25" d="M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4"/>
  <path d="M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z">
    <animateTransform attributeName="transform" type="rotate" from="0 16 16" to="360 16 16" dur="0.8s" repeatCount="indefinite" />
  </path>
</svg>
`},function(n,r){n.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <circle cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(45 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.125s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(90 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.25s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(135 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.375s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(180 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.5s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(225 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.625s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(270 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.75s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(315 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.875s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
  <circle transform="rotate(180 16 16)" cx="16" cy="3" r="0">
    <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.5s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" />
  </circle>
</svg>
`},function(n,r){n.exports=`<svg id="loading" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(0 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0"/>
  </path>
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(45 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.125s"/>
  </path>
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(90 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.25s"/>
  </path>
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(135 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.375s"/>
  </path>
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(180 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.5s"/>
  </path>
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(225 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.675s"/>
  </path>
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(270 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.75s"/>
  </path>
  <path opacity=".1" d="M14 0 H18 V8 H14 z" transform="rotate(315 16 16)">
    <animate attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.875s"/>
  </path>
</svg>
`}])})})(TP);var k0e=TP.exports;const E0e=Qx(k0e),I0e=()=>{const[t,e]=Ce.useState(localStorage.getItem("epub-location")),[n,r]=Ce.useState(!0),[s,i]=Ce.useState(""),o=Ce.useRef(null),a=Ce.useRef(null),l=u$(),c=Yb().state.book,h=v=>{if(console.log(v),typeof v=="string"){const p=v.match(/\/\d+\/\d+/);if(p)return p[0]}return null},d=v=>v.current?v.current.book:null,f=async v=>{const p=await v.loaded.spine;return new Promise((g,y)=>{p.each(async b=>{if(b.cfiBase===h(t))try{const w=(await b.load(v.load.bind(v))).querySelector("body");w?g(w.textContent):y(new Error("No body element found in the chapter."))}catch(x){y(x)}})})};Ce.useEffect(()=>{const v=h(t);if(v!==o.current){o.current=v;const p=d(a);p&&f(p).then(g=>{console.log(g,"asd"),i(g)}).catch(g=>{console.error(g)})}},[t]);const m=()=>{l("/Emo-chan/")};return lt.jsxs("div",{className:"app-container",children:[lt.jsx("div",{className:"navbar-header",children:lt.jsxs("div",{className:"logo",onClick:m,children:[" ",lt.jsx("span",{role:"img","aria-label":"Emo-chan",className:"default-text",children:"(•ᴗ•❁)Emo-chan"}),lt.jsx("span",{role:"img","aria-label":"Emo-chan",className:"hover-text",children:"(˃̵ᴗ˂̵❁)Emo-chan"})]})}),n&&lt.jsxs("div",{className:"loading",children:[lt.jsx(E0e,{type:"spin",color:"white",height:"auto",width:"10%"}),lt.jsx("div",{className:"loading-text",children:"Emotion Analysis in Progress..."})]}),lt.jsx("div",{className:"reader-container",children:lt.jsx(Bo.ReactReader,{location:t,locationChanged:e,url:c,getRendition:v=>{a.current=v},epubOptions:{allowPopups:!0,allowScriptedContent:!0},readerStyles:{...Bo.ReactReaderStyle,arrow:{...Bo.ReactReaderStyle.arrow,backgroundColor:"white",color:"black",fontWeight:100,fontFamily:"Playpen Sans"},tocArea:{...Bo.ReactReaderStyle.tocArea,backgroundColor:"white",color:"black"},tocAreaButton:{...Bo.ReactReaderStyle.tocAreaButton,backgroundColor:"white",color:"black",fontFamily:"Playpen Sans"},tocButtonBar:{...Bo.ReactReaderStyle.tocButtonBar,backgroundColor:"black"},tocButton:{...Bo.ReactReaderStyle.tocButton,backgroundColor:"white",color:"black"},tocButtonExpanded:{...Bo.ReactReaderStyle.tocButtonExpanded,backgroundColor:"white"}}})},n),lt.jsx(S0e,{storyText:s,setIsLoading:r})]})};const T0e=Iz([{path:"/Emo-chan/",element:lt.jsx(Lz,{})},{path:"/Emo-chan/App",element:lt.jsx(I0e,{})}]);o1.createRoot(document.getElementById("root")).render(lt.jsx(Ht.StrictMode,{children:lt.jsx(Oz,{router:T0e})}));
